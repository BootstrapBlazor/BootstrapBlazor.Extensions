// @univerjs/ui/index
(function(C,f){typeof exports=="object"&&typeof module<"u"?f(exports,require("@univerjs/core"),require("rxjs"),require("react"),require("react/jsx-runtime"),require("@wendellhu/redi/react-bindings"),require("@univerjs/design"),require("rxjs/operators"),require("@univerjs/engine-render"),require("react-dom")):typeof define=="function"&&define.amd?define(["exports","@univerjs/core","rxjs","react","react/jsx-runtime","@wendellhu/redi/react-bindings","@univerjs/design","rxjs/operators","@univerjs/engine-render","react-dom"],f):(C=typeof globalThis<"u"?globalThis:C||self,f(C.UniverUi={},C.UniverCore,C.rxjs,C.React,C.React,C["@wendellhu/redi/react-bindings"],C.UniverDesign,C.rxjs.operators,C.UniverEngineRender,C.ReactDOM))})(this,(function(C,f,B,s,v,V,x,_3,U1,S3){"use strict";var N5=Object.defineProperty;var T5=C=>{throw TypeError(C)};var x5=(C,f,B)=>f in C?N5(C,f,{enumerable:!0,configurable:!0,writable:!0,value:B}):C[f]=B;var j=(C,f,B)=>x5(C,typeof f!="symbol"?f+"":f,B);var M3=(C,f,B)=>f.has(C)?T5("Cannot add the same private member more than once"):f instanceof WeakSet?f.add(C):f.set(C,B);var C3,h3;class ie extends f.Disposable{constructor(){super(...arguments);j(this,"_open$",new B.BehaviorSubject(!1));j(this,"open$",this._open$.pipe(B.distinctUntilChanged()))}get isOpen(){return this._open$.getValue()}dispose(){super.dispose(),this._open$.next(!1),this._open$.complete()}open(){this._open$.next(!0)}close(){this._open$.next(!1)}}const Cn=f.createIdentifier("ui.left-sidebar.service"),x1=f.createIdentifier("ui.sidebar.service"),H3="ShortcutPanel",j1={id:"base-ui.operation.toggle-shortcut-panel",type:f.CommandType.OPERATION,handler:e=>{const n=e.get(ie),t=e.get(x1);return n.isOpen?(n.close(),t.close()):(n.open(),t.open({header:{title:"shortcut-panel.title"},children:{label:H3}})),!0}};function H({ref:e,...n}){const{icon:t,id:r,className:o,extend:i,...l}=n,c=`univerjs-icon univerjs-icon-${r} ${o||""}`.trim(),h=s.useRef(`_${gn()}`);return E3(t,`${r}`,{defIds:t.defIds,idSuffix:h.current},{ref:e,className:c,...l},i)}function E3(e,n,t,r,o){return s.createElement(e.tag,{key:n,...hn(e,t,o),...r},(vn(e,t).children||[]).map((i,l)=>E3(i,`${n}-${e.tag}-${l}`,t,void 0,o)))}function hn(e,n,t){const r={...e.attrs};t!=null&&t.colorChannel1&&r.fill==="colorChannel1"&&(r.fill=t.colorChannel1),e.tag==="mask"&&r.id&&(r.id=r.id+n.idSuffix),Object.entries(r).forEach(([i,l])=>{i==="mask"&&typeof l=="string"&&(r[i]=l.replace(/url\(#(.*)\)/,`url(#$1${n.idSuffix})`))});const{defIds:o}=n;return!o||o.length===0||(e.tag==="use"&&r["xlink:href"]&&(r["xlink:href"]=r["xlink:href"]+n.idSuffix),Object.entries(r).forEach(([i,l])=>{typeof l=="string"&&(r[i]=l.replace(/url\(#(.*)\)/,`url(#$1${n.idSuffix})`))})),r}function vn(e,n){var r;const{defIds:t}=n;return!t||t.length===0?e:e.tag==="defs"&&((r=e.children)!=null&&r.length)?{...e,children:e.children.map(o=>typeof o.attrs.id=="string"&&t&&t.includes(o.attrs.id)?{...o,attrs:{...o.attrs,id:o.attrs.id+n.idSuffix}}:o)}:e}function gn(){return Math.random().toString(36).substring(2,8)}H.displayName="UniverIcon";const pn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.06641 3.49366C4.06641 2.27555 5.14145 1.3916 6.33307 1.3916C7.52469 1.3916 8.59974 2.27555 8.59974 3.49366V6.49777C8.59974 7.71586 7.52469 8.59982 6.33307 8.59982C5.14145 8.59982 4.06641 7.71586 4.06641 6.49777V3.49366ZM6.33307 2.5916C5.68376 2.5916 5.26641 3.05264 5.26641 3.49366V6.49777C5.26641 6.93878 5.68376 7.39982 6.33307 7.39982C6.98239 7.39982 7.39974 6.93878 7.39974 6.49777V3.49366C7.39974 3.05264 6.98239 2.5916 6.33307 2.5916Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.0664 3.49366C10.0664 2.27555 11.1415 1.3916 12.3331 1.3916C13.5247 1.3916 14.5997 2.27555 14.5997 3.49366V6.49777C14.5997 7.71586 13.5247 8.59982 12.3331 8.59982C11.1415 8.59982 10.0664 7.71586 10.0664 6.49777V3.49366ZM12.3331 2.5916C11.6838 2.5916 11.2664 3.05264 11.2664 3.49366V6.49777C11.2664 6.93878 11.6838 7.39982 12.3331 7.39982C12.9824 7.39982 13.3997 6.93878 13.3997 6.49777V3.49366C13.3997 3.05264 12.9824 2.5916 12.3331 2.5916Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M12.4242 9.5417C12.1899 9.30739 11.81 9.30739 11.5756 9.5417C11.3413 9.77602 11.3413 10.1559 11.5756 10.3902L12.5514 11.366H6.3334C6.00203 11.366 5.7334 11.6346 5.7334 11.966C5.7334 12.2973 6.00203 12.566 6.3334 12.566H12.5514L11.5756 13.5417C11.3413 13.776 11.3413 14.1559 11.5756 14.3902C11.81 14.6245 12.1899 14.6245 12.4242 14.3902L14.4159 12.3985C14.5294 12.2893 14.6001 12.1359 14.6001 11.966C14.6001 11.796 14.5294 11.6426 14.4159 11.5334L12.4242 9.5417Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 8.3002C1.3999 7.96882 1.66853 7.7002 1.9999 7.7002H2.33324C2.66461 7.7002 2.93324 7.96882 2.93324 8.3002C2.93324 8.63157 2.66461 8.9002 2.33324 8.9002H1.9999C1.66853 8.9002 1.3999 8.63157 1.3999 8.3002Z"}}]},D3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"add-digits-icon",ref:t,icon:pn}))});D3.displayName="AddDigitsIcon";const mn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.2498 3.65005C2.2498 2.87685 2.87661 2.25005 3.64981 2.25005H7.9998C8.33118 2.25005 8.5998 1.98142 8.5998 1.65005C8.5998 1.31868 8.33118 1.05005 7.9998 1.05005H3.64981C2.21387 1.05005 1.0498 2.21411 1.0498 3.65005V12.35C1.0498 13.786 2.21386 14.95 3.6498 14.95H12.3498C13.7857 14.95 14.9498 13.786 14.9498 12.3501V8.00005C14.9498 7.66868 14.6812 7.40005 14.3498 7.40005C14.0184 7.40005 13.7498 7.66868 13.7498 8.00005V9.23974L12.2385 8.1063C11.7252 7.72129 11.0068 7.7723 10.5531 8.22605L9.00869 9.77041L6.73916 7.8251C6.24387 7.40055 5.5095 7.41278 5.02864 7.85359L2.2498 10.4009V3.65005ZM2.2498 12.0287V12.35C2.2498 13.1232 2.87661 13.75 3.6498 13.75H12.3498C13.123 13.75 13.7498 13.1232 13.7498 12.3501V10.7397L11.5186 9.06631C11.4829 9.03956 11.433 9.04314 11.4016 9.07458L9.92249 10.5537L11.1015 11.5642C11.3531 11.7799 11.3822 12.1587 11.1666 12.4103C10.9509 12.6619 10.5721 12.691 10.3205 12.4753L5.9582 8.7362C5.92384 8.70674 5.87288 8.70758 5.83952 8.73816L2.2498 12.0287Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M11.8097 1.14783C12.1411 1.14783 12.4097 1.41646 12.4097 1.74783V3.297H14.1541C14.4855 3.297 14.7541 3.56563 14.7541 3.897C14.7541 4.22837 14.4855 4.497 14.1541 4.497H12.4097V6.24167C12.4097 6.57304 12.1411 6.84167 11.8097 6.84167C11.4783 6.84167 11.2097 6.57304 11.2097 6.24167V4.497H9.6603C9.32893 4.497 9.0603 4.22837 9.0603 3.897C9.0603 3.56563 9.32893 3.297 9.6603 3.297H11.2097V1.74783C11.2097 1.41646 11.4783 1.14783 11.8097 1.14783Z"}}]},O3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"add-image-icon",ref:t,icon:mn}))});O3.displayName="AddImageIcon";const bn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M11.3606 3.74168C11.6086 3.49373 12.0106 3.49373 12.2585 3.74168C12.5065 3.98963 12.5065 4.39164 12.2585 4.6396L4.63947 12.2586C4.39152 12.5066 3.98951 12.5066 3.74156 12.2586C3.49361 12.0107 3.49361 11.6087 3.74156 11.3607L11.3606 3.74168Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.82544 4.82556H4.19052C3.83986 4.82556 3.5556 5.10982 3.5556 5.46048C3.5556 5.81114 3.83986 6.0954 4.19052 6.0954H4.82544V6.73032C4.82544 7.08098 5.1097 7.36524 5.46036 7.36524C5.81102 7.36524 6.09528 7.08098 6.09528 6.73032V6.0954H6.7302C7.08086 6.0954 7.36512 5.81114 7.36512 5.46048C7.36512 5.10982 7.08086 4.82556 6.7302 4.82556H6.09528V4.19064C6.09528 3.83998 5.81102 3.55572 5.46036 3.55572C5.1097 3.55572 4.82544 3.83998 4.82544 4.19064V4.82556Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M8.3175 10.8573C8.3175 10.5066 8.60176 10.2224 8.95242 10.2224H11.4921C11.8428 10.2224 12.127 10.5066 12.127 10.8573C12.127 11.208 11.8428 11.4922 11.4921 11.4922H8.95242C8.60176 11.4922 8.3175 11.208 8.3175 10.8573Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.33337 2.9208C1.33337 2.04416 2.04403 1.3335 2.92068 1.3335H13.0794C13.9561 1.3335 14.6667 2.04416 14.6667 2.9208V13.0795C14.6667 13.9562 13.9561 14.6668 13.0794 14.6668H2.92068C2.04404 14.6668 1.33337 13.9562 1.33337 13.0795V2.9208ZM2.92068 2.60334C2.74535 2.60334 2.60322 2.74547 2.60322 2.9208V13.0795C2.60322 13.2549 2.74534 13.397 2.92068 13.397H13.0794C13.2547 13.397 13.3969 13.2549 13.3969 13.0795V2.9208C13.3969 2.74546 13.2547 2.60334 13.0794 2.60334H2.92068Z",fillRule:"evenodd",clipRule:"evenodd"}}]},R3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"addition-and-subtraction-icon",ref:t,icon:bn}))});R3.displayName="AdditionAndSubtractionIcon";const Ln={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 13.6999C1.3999 13.3685 1.66853 13.0999 1.9999 13.0999H13.9999C14.3313 13.0999 14.5999 13.3685 14.5999 13.6999C14.5999 14.0312 14.3313 14.2999 13.9999 14.2999H1.9999C1.66853 14.2999 1.3999 14.0312 1.3999 13.6999Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M7.57564 10.3914C7.80995 10.6257 8.18985 10.6257 8.42417 10.3914L10.4242 8.3914C10.6585 8.15709 10.6585 7.77719 10.4242 7.54287C10.1899 7.30856 9.80995 7.30856 9.57564 7.54287L7.9999 9.11861L6.42417 7.54287C6.18985 7.30856 5.80995 7.30856 5.57564 7.54287C5.34132 7.77719 5.34132 8.15709 5.57564 8.3914L7.57564 10.3914Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M7.9999 10.5671C8.33127 10.5671 8.5999 10.2985 8.5999 9.96714V2.30047C8.5999 1.9691 8.33127 1.70047 7.9999 1.70047C7.66853 1.70047 7.3999 1.9691 7.3999 2.30047V9.96714C7.3999 10.2985 7.66853 10.5671 7.9999 10.5671Z",fillRule:"evenodd",clipRule:"evenodd"}}]},V3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"align-bottom-icon",ref:t,icon:Ln}))});V3.displayName="AlignBottomIcon";const wn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 5.56641C1.66853 5.56641 1.3999 5.83504 1.3999 6.16641C1.3999 6.49778 1.66853 6.76641 1.9999 6.76641H13.9999C14.3313 6.76641 14.5999 6.49778 14.5999 6.16641C14.5999 5.83504 14.3313 5.56641 13.9999 5.56641H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 12.9004C1.66853 12.9004 1.3999 13.169 1.3999 13.5004C1.3999 13.8318 1.66853 14.1004 1.9999 14.1004H13.9999C14.3313 14.1004 14.5999 13.8318 14.5999 13.5004C14.5999 13.169 14.3313 12.9004 13.9999 12.9004H1.9999Z"}}]},N3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"align-text-both-icon",ref:t,icon:wn}))});N3.displayName="AlignTextBothIcon";const yn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 2.3002C1.3999 2.63157 1.66853 2.9002 1.9999 2.9002H13.9999C14.3313 2.9002 14.5999 2.63157 14.5999 2.3002C14.5999 1.96882 14.3313 1.7002 13.9999 1.7002H1.9999C1.66853 1.7002 1.3999 1.96882 1.3999 2.3002Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M8.22957 5.47839C8.30034 5.50767 8.36664 5.55107 8.42417 5.6086L10.4242 7.6086C10.6585 7.84291 10.6585 8.22281 10.4242 8.45713C10.1899 8.69144 9.80995 8.69144 9.57564 8.45713L8.5999 7.48139V13.6995C8.5999 14.0309 8.33127 14.2995 7.9999 14.2995C7.66853 14.2995 7.3999 14.0309 7.3999 13.6995V7.48139L6.42417 8.45713C6.18985 8.69144 5.80995 8.69144 5.57564 8.45713C5.34132 8.22281 5.34132 7.84291 5.57564 7.6086L7.57541 5.60882C7.7522 5.43203 8.01209 5.38841 8.22957 5.47839Z"}}]},T3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"align-top-icon",ref:t,icon:yn}))});T3.displayName="AlignTopIcon";const In={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.9999 1.12915C8.03875 1.12915 8.07673 1.13284 8.11352 1.13989H12.2599C13.6958 1.13989 14.8599 2.30395 14.8599 3.73989V7.88619C14.867 7.92301 14.8707 7.96102 14.8707 7.9999C14.8707 8.03878 14.867 8.0768 14.8599 8.11362V12.2599C14.8599 13.6958 13.6958 14.8599 12.2599 14.8599H8.11362C8.0768 14.867 8.03878 14.8707 7.9999 14.8707C7.96102 14.8707 7.92301 14.867 7.88619 14.8599H3.73989C2.30396 14.8599 1.13989 13.6958 1.13989 12.2599V8.11352C1.13284 8.07673 1.12915 8.03875 1.12915 7.9999C1.12915 7.96106 1.13284 7.92308 1.13989 7.88629V3.73989C1.13989 2.30396 2.30395 1.13989 3.73989 1.13989H7.88629C7.92308 1.13284 7.96106 1.12915 7.9999 1.12915ZM2.33989 8.5999V12.2599C2.33989 13.0331 2.9667 13.6599 3.73989 13.6599H7.3999V8.5999H2.33989ZM7.3999 7.3999H2.33989V3.73989C2.33989 2.9667 2.96669 2.33989 3.73989 2.33989H7.3999V7.3999ZM8.5999 8.5999V13.6599H12.2599C13.0331 13.6599 13.6599 13.0331 13.6599 12.2599V8.5999H8.5999ZM13.6599 7.3999H8.5999V2.33989H12.2599C13.0331 2.33989 13.6599 2.96669 13.6599 3.73989V7.3999Z",fillRule:"evenodd",clipRule:"evenodd"}}]},x3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"all-border-icon",ref:t,icon:In}))});x3.displayName="AllBorderIcon";const Mn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.5999 5.9999C8.5999 5.66853 8.33127 5.3999 7.9999 5.3999C7.66853 5.3999 7.3999 5.66853 7.3999 5.9999V7.40329L6.004 7.4051C5.67263 7.40553 5.40435 7.67451 5.40479 8.00588C5.40522 8.33725 5.6742 8.60553 6.00557 8.6051L7.3999 8.60329V9.9999C7.3999 10.3313 7.66853 10.5999 7.9999 10.5999C8.33127 10.5999 8.5999 10.3313 8.5999 9.9999V8.60172L10.0004 8.5999C10.3317 8.59947 10.6 8.33049 10.5996 7.99912C10.5992 7.66775 10.3302 7.39947 9.9988 7.3999L8.5999 7.40172V5.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M7.99958 1.73315C4.53861 1.73315 1.73291 4.53885 1.73291 7.99982C1.73291 11.4608 4.53861 14.2665 7.99958 14.2665C9.51395 14.2665 10.9029 13.7293 11.9862 12.8351L13.2422 14.0908C13.4765 14.3251 13.8564 14.3251 14.0907 14.0907C14.325 13.8564 14.325 13.4765 14.0906 13.2422L12.8347 11.9866C13.729 10.9033 14.2662 9.51428 14.2662 7.99982C14.2662 4.53885 11.4605 1.73315 7.99958 1.73315ZM2.93291 7.99982C2.93291 5.20159 5.20135 2.93315 7.99958 2.93315C10.7978 2.93315 13.0662 5.20159 13.0662 7.99982C13.0662 10.7981 10.7978 13.0665 7.99958 13.0665C5.20135 13.0665 2.93291 10.7981 2.93291 7.99982Z",fillRule:"evenodd",clipRule:"evenodd"}}]},$3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"amplify-icon",ref:t,icon:Mn}))});$3.displayName="AmplifyIcon";const _n={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.5999 2.2001C2.5999 1.86873 2.33127 1.6001 1.9999 1.6001C1.66853 1.6001 1.3999 1.86873 1.3999 2.2001V13.8001C1.3999 14.1315 1.66853 14.4001 1.9999 14.4001C2.33127 14.4001 2.5999 14.1315 2.5999 13.8001V2.2001Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M14.5999 2.2001C14.5999 1.86873 14.3313 1.6001 13.9999 1.6001C13.6685 1.6001 13.3999 1.86873 13.3999 2.2001V13.8001C13.3999 14.1315 13.6685 14.4001 13.9999 14.4001C14.3313 14.4001 14.5999 14.1315 14.5999 13.8001V2.2001Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M6.424 8.24239C6.65832 8.4767 6.65832 8.8566 6.424 9.09091L6.11502 9.3999H9.33307C10.1063 9.3999 10.7331 8.7731 10.7331 7.9999C10.7331 7.22671 10.1063 6.5999 9.33307 6.5999H4.6666L4.66645 5.3999H9.33307C10.769 5.3999 11.9331 6.56396 11.9331 7.9999C11.9331 9.43584 10.769 10.5999 9.33307 10.5999H6.11485L6.424 10.9091C6.65832 11.1434 6.65832 11.5233 6.424 11.7576C6.18969 11.9919 5.80979 11.9919 5.57548 11.7576L4.24214 10.4242C4.00783 10.1899 4.00783 9.81003 4.24214 9.57572L5.57548 8.24239C5.80979 8.00807 6.18969 8.00807 6.424 8.24239Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.6666 6.5999C4.33523 6.5999 4.06641 6.33127 4.06641 5.9999C4.06641 5.66853 4.33508 5.3999 4.66645 5.3999L4.6666 6.5999Z"}}]},Z3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"autowrap-icon",ref:t,icon:_n}))});Z3.displayName="AutowrapIcon";const Sn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.36977 4.66364C2.67525 3.75535 3.95995 3.75535 4.26543 4.66364L6.0261 9.89866C6.13173 10.2127 5.96275 10.553 5.64867 10.6586C5.33459 10.7643 4.99434 10.5953 4.8887 10.2812L3.3176 5.60982L1.7465 10.2812C1.64086 10.5953 1.30062 10.7643 0.986532 10.6586C0.672449 10.553 0.503468 10.2127 0.609102 9.89866L2.36977 4.66364Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.6333 7.87051C1.6333 7.53914 1.90193 7.27051 2.2333 7.27051H4.52594C4.85732 7.27051 5.12594 7.53914 5.12594 7.87051C5.12594 8.20188 4.85732 8.47051 4.52594 8.47051H2.2333C1.90193 8.47051 1.6333 8.20188 1.6333 7.87051Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M9.26385 10.0162C8.9281 10.853 7.74343 10.853 7.40768 10.0162L6.02978 6.58181C5.90639 6.27427 6.05568 5.92493 6.36322 5.80154C6.67076 5.67815 7.0201 5.82744 7.14349 6.13498L8.33577 9.10668L9.52805 6.13498C9.65143 5.82744 10.0008 5.67815 10.3083 5.80154C10.6159 5.92493 10.7651 6.27427 10.6418 6.58181L9.26385 10.0162Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M14.8178 5.68628C15.1491 5.68628 15.4178 5.95491 15.4178 6.28628L15.4178 10.845C15.4178 11.9648 14.51 12.8726 13.3901 12.8726H12.8888C11.8122 12.8726 10.9395 11.9999 10.9395 10.9233C10.9395 10.5919 11.2081 10.3233 11.5395 10.3233C11.8708 10.3233 12.1395 10.5919 12.1395 10.9233C12.1395 11.3371 12.4749 11.6726 12.8888 11.6726H13.3901C13.8472 11.6726 14.2178 11.3021 14.2178 10.845L14.2178 6.28628C14.2178 5.95491 14.4864 5.68628 14.8178 5.68628Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.9395 7.82632C10.9395 6.58966 11.942 5.58716 13.1786 5.58716C14.4153 5.58716 15.4178 6.58966 15.4178 7.82632C15.4178 9.06297 14.4153 10.0655 13.1786 10.0655C11.942 10.0655 10.9395 9.06297 10.9395 7.82632ZM13.1786 6.78716C12.6047 6.78716 12.1395 7.2524 12.1395 7.82632C12.1395 8.40023 12.6047 8.86547 13.1786 8.86547C13.7525 8.86547 14.2178 8.40023 14.2178 7.82632C14.2178 7.2524 13.7525 6.78716 13.1786 6.78716Z",fillRule:"evenodd",clipRule:"evenodd"}}]},A3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"avg-icon",ref:t,icon:Sn}))});A3.displayName="AvgIcon";const Hn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.65791 1.30005C3.77355 1.30005 3.05664 2.01696 3.05664 2.90132V12.8588C3.05664 13.8755 3.88086 14.6998 4.89759 14.6998H9.1016C11.2233 14.6998 12.9433 12.9798 12.9433 10.8581C12.9433 9.13925 11.8145 7.68407 10.2578 7.1934C10.8806 6.56856 11.2655 5.70659 11.2655 4.75472C11.2655 2.84676 9.71883 1.30005 7.81087 1.30005H4.65791ZM4.25664 2.90132C4.25664 2.6797 4.4363 2.50005 4.65791 2.50005H7.81087C9.05609 2.50005 10.0655 3.5095 10.0655 4.75472C10.0655 5.99993 9.05609 7.00938 7.81087 7.00938H4.25664V2.90132ZM4.25664 12.8588V8.21636H9.1016C10.5606 8.21636 11.7433 9.39909 11.7433 10.8581C11.7433 12.317 10.5606 13.4998 9.1016 13.4998H4.89759C4.5436 13.4998 4.25664 13.2128 4.25664 12.8588Z",fillRule:"evenodd",clipRule:"evenodd"}}]},P3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"bold-icon",ref:t,icon:Hn}))});P3.displayName="BoldIcon";const En={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.59219 1.3667C1.70853 1.3667 0.992188 2.08304 0.992188 2.9667V4.9667C0.992188 5.85036 1.70853 6.5667 2.59219 6.5667H11.2694C12.1531 6.5667 12.8694 5.85036 12.8694 4.9667V4.79985H13.8075V8.18642C13.8075 8.38777 13.6579 8.55773 13.4581 8.58321L7.10511 9.39341C6.30618 9.4953 5.70752 10.1752 5.70752 10.9806V14.0332C5.70752 14.3646 5.97615 14.6332 6.30752 14.6332C6.63889 14.6332 6.90752 14.3646 6.90752 14.0332V10.9806C6.90752 10.7792 7.05718 10.6092 7.25692 10.5838L13.6099 9.77356C14.4089 9.67168 15.0075 8.99182 15.0075 8.18642V4.19985C15.0075 3.86848 14.7389 3.59985 14.4075 3.59985H12.8694V2.9667C12.8694 2.08304 12.1531 1.3667 11.2694 1.3667H2.59219ZM2.19219 2.9667C2.19219 2.74579 2.37127 2.5667 2.59219 2.5667H11.2694C11.4903 2.5667 11.6694 2.74579 11.6694 2.9667V4.9667C11.6694 5.18761 11.4903 5.3667 11.2694 5.3667H2.59219C2.37127 5.3667 2.19219 5.18761 2.19219 4.9667V2.9667Z",fillRule:"evenodd",clipRule:"evenodd"}}]},F3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"brush-icon",ref:t,icon:En}))});F3.displayName="BrushIcon";const Dn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.14014 3.73989C1.14014 2.30396 2.3042 1.13989 3.74014 1.13989H12.2601C13.6961 1.13989 14.8601 2.30395 14.8601 3.73989V4.86989C14.8601 5.20126 14.5915 5.46989 14.2601 5.46989C13.9288 5.46989 13.6601 5.20126 13.6601 4.86989V3.73989C13.6601 2.96669 13.0333 2.33989 12.2601 2.33989H8.34014V3.20284C8.34014 3.20446 8.34014 3.20608 8.34014 3.2077V6.73989C8.34014 7.62355 7.62379 8.33989 6.74014 8.33989H2.70277C2.70112 8.3399 2.69947 8.3399 2.69781 8.33989H2.34014V12.2599C2.34014 13.0331 2.96694 13.6599 3.74014 13.6599H12.2601C13.0333 13.6599 13.6601 13.0331 13.6601 12.2599V11.7299C13.6601 11.3985 13.9288 11.1299 14.2601 11.1299C14.5915 11.1299 14.8601 11.3985 14.8601 11.7299V12.2599C14.8601 13.6958 13.6961 14.8599 12.2601 14.8599H3.74014C2.3042 14.8599 1.14014 13.6958 1.14014 12.2599V3.73989ZM4.26409 7.13989H6.74014C6.96105 7.13989 7.14014 6.96081 7.14014 6.73989V4.55237L4.26409 7.13989ZM7.14014 2.93819V2.33989H6.28159L2.34044 5.614L2.34056 7.13989H2.46992L7.14014 2.93819ZM2.34032 4.05403L4.40368 2.33989H3.74029C2.96705 2.33989 2.34023 2.96676 2.34029 3.74L2.34032 4.05403Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M8.73877 9.00298C8.73877 9.55526 9.18649 10.003 9.73877 10.003H11.7792C12.1106 10.003 12.3792 9.73435 12.3792 9.40298C12.3792 9.07161 12.1106 8.80298 11.7792 8.80298H10.7874L12.2304 7.36157C12.7051 6.88734 13.4743 6.88754 13.9488 7.36202C14.4234 7.83667 14.4234 8.60624 13.9488 9.0809L13.2095 9.82016C12.9752 10.0545 12.9752 10.4344 13.2095 10.6687C13.4439 10.903 13.8238 10.903 14.0581 10.6687L14.7973 9.92943C15.7406 8.98614 15.7406 7.45678 14.7973 6.51349C13.8544 5.57056 12.3257 5.57015 11.3823 6.51259L9.93877 7.95459V6.96255C9.93877 6.63118 9.67014 6.36255 9.33877 6.36255C9.0074 6.36255 8.73877 6.63118 8.73877 6.96255V9.00298Z"}}]},k3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"cancel-freeze-icon",ref:t,icon:Dn}))});k3.displayName="CancelFreezeIcon";const On={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M12.5939 1.13916L10.6607 1.1392C9.55628 1.13922 8.66093 2.03448 8.66077 3.13893L8.66063 4.19191C8.66059 4.52328 8.92918 4.79194 9.26055 4.79199C9.59192 4.79204 9.86059 4.52344 9.86063 4.19207L9.86077 3.13909C9.86084 2.69731 10.219 2.33921 10.6608 2.3392L12.594 2.33916C13.0358 2.33915 13.394 2.69732 13.394 3.13916L13.394 12.8612C13.394 13.303 13.0358 13.6612 12.594 13.6612H10.6606C10.2188 13.6612 9.86063 13.303 9.86063 12.8612V11.8084C9.86063 11.4771 9.592 11.2084 9.26063 11.2084C8.92926 11.2084 8.66063 11.4771 8.66063 11.8084V12.8612C8.66063 13.9658 9.55606 14.8612 10.6606 14.8612H12.594C13.6986 14.8612 14.594 13.9658 14.594 12.8612L14.594 3.13915C14.594 2.03457 13.6985 1.13914 12.5939 1.13916Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M5.33888 1.13919L3.40568 1.13926C2.30114 1.13931 1.40575 2.03474 1.40576 3.13928L1.40586 12.8612C1.40587 13.9658 2.3013 14.8612 3.40586 14.8612H5.33896C6.44353 14.8612 7.33896 13.9658 7.33896 12.8612V11.8084C7.33896 11.4771 7.07033 11.2084 6.73896 11.2084C6.40759 11.2084 6.13896 11.4771 6.13896 11.8084V12.8612C6.13896 13.303 5.78079 13.6612 5.33896 13.6612H3.40586C2.96403 13.6612 2.60586 13.303 2.60586 12.8612L2.60576 3.13927C2.60576 2.69745 2.96391 2.33928 3.40573 2.33926L5.33893 2.33919C5.78077 2.33917 6.13896 2.69735 6.13896 3.13919V4.192C6.13896 4.52337 6.40759 4.792 6.73896 4.792C7.07033 4.792 7.33896 4.52337 7.33896 4.192V3.13919C7.33896 2.03459 6.44348 1.13914 5.33888 1.13919Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M9.20731 5.99993C8.973 6.23424 8.973 6.61414 9.20731 6.84845L10.0912 7.73235C10.2474 7.88856 10.2474 8.14182 10.0912 8.29803L9.20731 9.18192C8.973 9.41624 8.973 9.79614 9.20731 10.0305C9.44163 10.2648 9.82153 10.2648 10.0558 10.0305L10.9397 9.14654C11.5646 8.52171 11.5646 7.50867 10.9397 6.88384L10.0558 5.99993C9.82153 5.76561 9.44163 5.76561 9.20731 5.99993Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M5.94379 5.99993C6.1781 5.76561 6.558 5.76561 6.79232 5.99993C7.02663 6.23424 7.02663 6.61414 6.79232 6.84845L5.90842 7.73235C5.75221 7.88856 5.75221 8.14182 5.90842 8.29803L6.79232 9.18193C7.02663 9.41624 7.02663 9.79614 6.79232 10.0305C6.558 10.2648 6.1781 10.2648 5.94379 10.0305L5.0599 9.14656C4.43506 8.52172 4.43506 7.50866 5.0599 6.88382L5.94379 5.99993Z"}}]},B3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"cancel-merge-icon",ref:t,icon:On}))});B3.displayName="CancelMergeIcon";const Rn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M14.1544 3.75557C14.3887 3.98988 14.3887 4.36978 14.1544 4.6041L6.51409 12.2444C6.40157 12.3569 6.24896 12.4201 6.08983 12.4201C5.9307 12.4201 5.77808 12.3569 5.66556 12.2444L1.84541 8.42425C1.6111 8.18993 1.6111 7.81003 1.84541 7.57572C2.07973 7.34141 2.45963 7.34141 2.69394 7.57572L6.08983 10.9716L13.3059 3.75557C13.5402 3.52126 13.9201 3.52126 14.1544 3.75557Z",fillRule:"evenodd",clipRule:"evenodd"}}]},De=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"check-mark-icon",ref:t,icon:Rn}))});De.displayName="CheckMarkIcon";const Vn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.71274 2.86421C3.47843 2.6299 3.09853 2.6299 2.86421 2.86421C2.6299 3.09853 2.6299 3.47843 2.86421 3.71274L7.15154 8.00007L2.86421 12.2874C2.6299 12.5217 2.6299 12.9016 2.86421 13.1359C3.09853 13.3702 3.47843 13.3702 3.71274 13.1359L8.00007 8.84859L12.2874 13.1359C12.5217 13.3702 12.9016 13.3702 13.1359 13.1359C13.3702 12.9016 13.3702 12.5217 13.1359 12.2874L8.84859 8.00007L13.1359 3.71274C13.3702 3.47843 13.3702 3.09853 13.1359 2.86421C12.9016 2.6299 12.5217 2.6299 12.2874 2.86421L8.00007 7.15154L3.71274 2.86421Z"}}]},Oe=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"close-icon",ref:t,icon:Vn}))});Oe.displayName="CloseIcon";const Nn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M0.361328 7.79626C0.361328 6.0459 1.78028 4.62695 3.53064 4.62695C4.18424 4.62695 4.80612 4.90867 5.23714 5.40001L5.30149 5.47337C5.52001 5.72247 5.49522 6.10156 5.24612 6.32009C4.99701 6.53861 4.61792 6.51382 4.3994 6.26471L4.33504 6.19135C4.13187 5.95975 3.83873 5.82695 3.53064 5.82695C2.44302 5.82695 1.56133 6.70864 1.56133 7.79626V8.21416C1.56133 9.29594 2.43828 10.1729 3.52006 10.1729C3.83123 10.1729 4.12678 10.0366 4.32877 9.79988L4.39405 9.72339C4.60916 9.47133 4.98788 9.44138 5.23994 9.65649C5.492 9.8716 5.52195 10.2503 5.30684 10.5024L5.24156 10.5789C4.81157 11.0827 4.18244 11.3729 3.52006 11.3729C1.77554 11.3729 0.361328 9.95868 0.361328 8.21416V7.79626Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.2084 4.92822C13.5398 4.92822 13.8084 5.19685 13.8084 5.52822V9.97297C13.8084 10.0834 13.8979 10.173 14.0084 10.173H15.0384C15.3698 10.173 15.6384 10.4416 15.6384 10.773C15.6384 11.1043 15.3698 11.373 15.0384 11.373H14.0084C13.2352 11.373 12.6084 10.7462 12.6084 9.97297V5.52822C12.6084 5.19685 12.877 4.92822 13.2084 4.92822Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.9893 7.42715C10.9893 7.09578 11.2579 6.82715 11.5893 6.82715H14.9428C15.2742 6.82715 15.5428 7.09578 15.5428 7.42715C15.5428 7.75852 15.2742 8.02715 14.9428 8.02715H11.5893C11.2579 8.02715 10.9893 7.75852 10.9893 7.42715Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M9.46366 8.71622C9.46366 8.18879 8.9622 7.80569 8.45332 7.94436L8.12019 8.03514C7.68503 8.15373 7.38311 8.54894 7.38311 8.99996V10.7731C7.38311 11.1044 7.11448 11.3731 6.78311 11.3731C6.45173 11.3731 6.18311 11.1044 6.18311 10.7731V8.99996C6.18311 8.0077 6.84733 7.13825 7.80469 6.87736L8.13782 6.78658C9.41001 6.43991 10.6637 7.39764 10.6637 8.71622V10.7731C10.6637 11.1044 10.395 11.3731 10.0637 11.3731C9.73229 11.3731 9.46366 11.1044 9.46366 10.7731V8.71622Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M6.79079 6.75531C7.12216 6.75528 7.39081 7.02389 7.39084 7.35526L7.39109 10.773C7.39112 11.1043 7.12251 11.373 6.79114 11.373C6.45977 11.373 6.19112 11.1044 6.19109 10.7731L6.19084 7.35535C6.19081 7.02398 6.45942 6.75533 6.79079 6.75531Z",fillRule:"evenodd",clipRule:"evenodd"}}]},U3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"cnt-icon",ref:t,icon:Nn}))});U3.displayName="CntIcon";const Tn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M9.92206 2.45064C9.98634 2.12556 9.77492 1.80992 9.44984 1.74564C9.12477 1.68136 8.80913 1.89278 8.74485 2.21785L6.41152 14.0179C6.34724 14.3429 6.55865 14.6586 6.88373 14.7228C7.20881 14.7871 7.52444 14.5757 7.58872 14.2506L9.92206 2.45064Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M5.14972 3.90157C5.38815 4.1317 5.39487 4.51154 5.16473 4.74996L2.55461 7.45409C2.01739 8.01066 2.03336 8.89745 2.59029 9.43431L5.14944 11.9013C5.38802 12.1313 5.39498 12.5111 5.165 12.7497C4.93502 12.9883 4.55519 12.9952 4.31662 12.7652L1.75746 10.2983C0.723174 9.30122 0.693506 7.65434 1.69121 6.6207L4.30133 3.91657C4.53146 3.67815 4.9113 3.67143 5.14972 3.90157Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.8505 3.90157C11.0889 3.67143 11.4688 3.67815 11.6989 3.91657L14.309 6.6207C15.3067 7.65434 15.2771 9.30122 14.2428 10.2983L11.6836 12.7652C11.4451 12.9952 11.0652 12.9883 10.8352 12.7497C10.6053 12.5111 10.6122 12.1313 10.8508 11.9013L13.41 9.43431C13.9669 8.89745 13.9829 8.01066 13.4456 7.45409L10.8355 4.74996C10.6054 4.51154 10.6121 4.1317 10.8505 3.90157Z"}}]},j3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"code-icon",ref:t,icon:Tn}))});j3.displayName="CodeIcon";const xn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.50095 1.84399C2.73322 1.60765 3.11311 1.60435 3.34945 1.83662L8.00012 6.40726L12.6508 1.83662C12.8871 1.60435 13.267 1.60765 13.4993 1.84399C13.7316 2.08032 13.7283 2.46021 13.4919 2.69248L8.85611 7.24852L10.8941 9.25146C11.1382 9.17563 11.3976 9.13477 11.6667 9.13477C13.1026 9.13477 14.2667 10.2988 14.2667 11.7348C14.2667 13.1707 13.1026 14.3348 11.6667 14.3348C10.2307 14.3348 9.06665 13.1707 9.06665 11.7348C9.06665 11.0143 9.35973 10.3622 9.83319 9.89129L8.00012 8.08978L6.16708 9.89127C6.64055 10.3622 6.93364 11.0142 6.93364 11.7348C6.93364 13.1707 5.76958 14.3348 4.33364 14.3348C2.8977 14.3348 1.73364 13.1707 1.73364 11.7348C1.73364 10.2988 2.8977 9.13477 4.33364 9.13477C4.60263 9.13477 4.86208 9.17562 5.10612 9.25145L7.14413 7.24852L2.50831 2.69248C2.27197 2.46021 2.26868 2.08032 2.50095 1.84399ZM2.93364 11.7348C2.93364 10.9616 3.56044 10.3348 4.33364 10.3348C5.10684 10.3348 5.73364 10.9616 5.73364 11.7348C5.73364 12.508 5.10684 13.1348 4.33364 13.1348C3.56044 13.1348 2.93364 12.508 2.93364 11.7348ZM10.2667 11.7348C10.2667 10.9616 10.8935 10.3348 11.6667 10.3348C12.4398 10.3348 13.0667 10.9616 13.0667 11.7348C13.0667 12.508 12.4398 13.1348 11.6667 13.1348C10.8935 13.1348 10.2667 12.508 10.2667 11.7348Z",fillRule:"evenodd",clipRule:"evenodd"}}]},z3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"cut-icon",ref:t,icon:xn}))});z3.displayName="CutIcon";const $n={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8 0.866961C5.018 0.866961 2 1.78296 2 3.53363V12.3675C2 14.1182 5.018 15.0342 8 15.0342C10.982 15.0342 14 14.1182 14 12.3675V3.53363C14 1.78296 10.982 0.866961 8 0.866961ZM12.6667 12.3675C12.6667 12.7542 11.0313 13.7008 8 13.7008C4.96867 13.7008 3.33333 12.7542 3.33333 12.3675V9.86434C4.49067 10.4797 6.24933 10.7977 8 10.7977C9.75067 10.7977 11.5093 10.4797 12.6667 9.86434V12.3675ZM12.6667 8.131C12.6667 8.51767 11.0313 9.46434 8 9.46434C4.96867 9.46434 3.33333 8.51767 3.33333 8.131L3.33333 5.26696C4.49067 5.88229 6.24933 6.20029 8 6.20029C9.75067 6.20029 11.5093 5.88229 12.6667 5.26696V8.131ZM8 4.86696C4.96867 4.86696 3.33333 3.92029 3.33333 3.53363C3.33333 3.14696 4.96867 2.20029 8 2.20029C11.0313 2.20029 12.6667 3.14696 12.6667 3.53363C12.6667 3.92029 11.0313 4.86696 8 4.86696Z"}}]},W3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"database-icon",ref:t,icon:$n}))});W3.displayName="DatabaseIcon";const Zn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.00004 1.3335C2.07957 1.3335 1.33337 2.07969 1.33337 3.00016V13.0002C1.33337 13.9143 2.06935 14.6566 2.98108 14.6667C2.99252 14.6671 3.00399 14.6671 3.01547 14.6668H13C13.9205 14.6668 14.6667 13.9207 14.6667 13.0002V11.8335C14.6667 11.4653 14.3682 11.1668 14 11.1668C13.6319 11.1668 13.3334 11.4653 13.3334 11.8335V13.0002C13.3334 13.1843 13.1842 13.3335 13 13.3335H5.25636C5.61522 13.016 5.95119 12.6637 6.25105 12.2868C7.06748 11.2609 7.66671 9.98799 7.66671 8.66683V2.66683H13C13.1841 2.66683 13.3334 2.81606 13.3334 3.00016V4.66683C13.3334 5.03502 13.6319 5.3335 14 5.3335C14.3682 5.3335 14.6667 5.03502 14.6667 4.66683V3.00016C14.6667 2.0797 13.9205 1.3335 13 1.3335H3.00004ZM6.33337 2.66683H3.00004C2.81595 2.66683 2.66671 2.81607 2.66671 3.00016V13.0002C2.66671 13.1484 2.76345 13.274 2.89725 13.3173C3.70845 12.9437 4.55406 12.2781 5.20773 11.4566C5.90507 10.5803 6.33337 9.59203 6.33337 8.66683V2.66683Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M12.4714 5.86209C12.2111 5.60174 11.789 5.60174 11.5286 5.86209C11.2683 6.12244 11.2683 6.54455 11.5286 6.8049L12.3906 7.66683H10C9.63185 7.66683 9.33337 7.96531 9.33337 8.3335C9.33337 8.70169 9.63185 9.00016 10 9.00016H12.3906L11.5286 9.86209C11.2683 10.1224 11.2683 10.5446 11.5286 10.8049C11.789 11.0653 12.2111 11.0653 12.4714 10.8049L14.4714 8.8049C14.5935 8.68286 14.6583 8.52528 14.6659 8.36548C14.6665 8.35482 14.6667 8.34416 14.6667 8.3335L12.4714 5.86209Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M12.4714 5.86209L14.4714 7.86209C14.6001 7.9907 14.6651 8.15878 14.6667 8.32734L12.4714 5.86209Z"}}]},G3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"direct-export-icon",ref:t,icon:Zn}))});G3.displayName="DirectExportIcon";const An={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.3999 2.8999V1.6C7.3999 1.26863 7.66853 1 7.9999 1C8.33127 1 8.5999 1.26863 8.5999 1.6V2.8999H10.2044C11.6655 2.8999 12.8499 4.08431 12.8499 5.54536C12.8499 5.87673 12.5813 6.14536 12.2499 6.14536C11.9185 6.14536 11.6499 5.87673 11.6499 5.54536C11.6499 4.74705 11.0028 4.0999 10.2044 4.0999H5.7384C4.97155 4.0999 4.3499 4.72155 4.3499 5.4884C4.3499 6.14439 4.80899 6.71087 5.45074 6.84677L10.7977 7.97906C11.994 8.23242 12.8499 9.28849 12.8499 10.5114C12.8499 11.941 11.691 13.0999 10.2614 13.0999H8.5999V14.4C8.5999 14.7314 8.33127 15 7.9999 15C7.66853 15 7.3999 14.7314 7.3999 14.4V13.0999H5.79536C4.33431 13.0999 3.1499 11.9155 3.1499 10.4544C3.1499 10.1231 3.41853 9.85445 3.7499 9.85445C4.08127 9.85445 4.3499 10.1231 4.3499 10.4544C4.3499 11.2527 4.99705 11.8999 5.79536 11.8999H10.2614C11.0283 11.8999 11.6499 11.2782 11.6499 10.5114C11.6499 9.85542 11.1908 9.28893 10.5491 9.15303L5.20214 8.02074C4.00575 7.76739 3.1499 6.71132 3.1499 5.4884C3.1499 4.05881 4.30881 2.8999 5.7384 2.8999H7.3999Z"}}]},Y3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"dollar-icon",ref:t,icon:An}))});Y3.displayName="DollarIcon";const Pn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.35381 3.65517C2.35381 2.88198 2.98061 2.25518 3.75381 2.25518H8.10381C8.43518 2.25518 8.70381 1.98655 8.70381 1.65518C8.70381 1.3238 8.43518 1.05518 8.10381 1.05518H3.75381C2.31787 1.05518 1.15381 2.21923 1.15381 3.65517V12.3552C1.15381 13.7911 2.31787 14.9552 3.75381 14.9552H12.4538C13.8897 14.9552 15.0538 13.7911 15.0538 12.3552V8.00518C15.0538 7.6738 14.7852 7.40518 14.4538 7.40518C14.1224 7.40518 13.8538 7.6738 13.8538 8.00518V9.24469L12.3428 8.11143C11.8294 7.72642 11.1111 7.77744 10.6573 8.23119L9.11281 9.77567L6.84342 7.83047C6.34812 7.40592 5.61375 7.41815 5.13289 7.85896L2.35381 10.4064V3.65517ZM2.35381 12.0343V12.3552C2.35381 13.1284 2.98061 13.7552 3.75381 13.7552H12.4538C13.227 13.7552 13.8538 13.1284 13.8538 12.3552V10.7447L11.6228 9.07144C11.5871 9.04469 11.5373 9.04827 11.5058 9.07971L10.0266 10.5589L11.2057 11.5696C11.4573 11.7853 11.4865 12.164 11.2708 12.4156C11.0552 12.6672 10.6764 12.6964 10.4248 12.4807L6.06245 8.74157C6.02809 8.71212 5.97713 8.71296 5.94377 8.74353L2.35381 12.0343Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.3911 3.84419C10.6254 3.60988 11.0053 3.60988 11.2396 3.84419L11.8818 4.48643V1.93496C11.8818 1.60359 12.1505 1.33496 12.4818 1.33496C12.8132 1.33496 13.0818 1.60359 13.0818 1.93496V4.48676L13.7244 3.84419C13.9587 3.60988 14.3386 3.60988 14.5729 3.84419C14.8072 4.07851 14.8072 4.45841 14.5729 4.69272L12.9063 6.35939C12.6719 6.5937 12.292 6.5937 12.0577 6.35939L10.3911 4.69272C10.1568 4.45841 10.1568 4.07851 10.3911 3.84419Z"}}]},X3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"download-image-icon",ref:t,icon:Pn}))});X3.displayName="DownloadImageIcon";const Fn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.84964 5.80918C6.71946 3.63548 8.84516 2.2 11.3295 2.2C11.8324 2.2 12.3198 2.26279 12.7846 2.38065C13.1058 2.46209 13.4322 2.26773 13.5137 1.94652C13.5951 1.62532 13.4008 1.2989 13.0795 1.21746C12.5191 1.07535 11.9327 1 11.3295 1C8.17278 1 5.49724 2.96009 4.57394 5.80918H3.06582C2.73445 5.80918 2.46582 6.07781 2.46582 6.40918C2.46582 6.74055 2.73445 7.00918 3.06582 7.00918H4.29808C4.25287 7.33297 4.22949 7.66376 4.22949 8C4.22949 8.33608 4.25284 8.6667 4.29801 8.99033H3.06582C2.73445 8.99033 2.46582 9.25896 2.46582 9.59033C2.46582 9.9217 2.73445 10.1903 3.06582 10.1903H4.57378C5.49693 13.0397 8.1726 15 11.3295 15C11.9336 15 12.5209 14.9244 13.0821 14.7819C13.4033 14.7003 13.5975 14.3738 13.5159 14.0527C13.4344 13.7315 13.1079 13.5373 12.7867 13.6188C12.3213 13.737 11.8332 13.8 11.3295 13.8C8.84497 13.8 6.71914 12.3643 5.84944 10.1903H11.4291C11.7605 10.1903 12.0291 9.9217 12.0291 9.59033C12.0291 9.25896 11.7605 8.99033 11.4291 8.99033H5.51225C5.45783 8.66834 5.42949 8.33748 5.42949 8C5.42949 7.66235 5.45786 7.33133 5.51233 7.00918H11.4291C11.7605 7.00918 12.0291 6.74055 12.0291 6.40918C12.0291 6.07781 11.7605 5.80918 11.4291 5.80918H5.84964Z"}}]},q3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"euro-icon",ref:t,icon:Fn}))});q3.displayName="EuroIcon";const kn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.65005 1.05005C2.21411 1.05005 1.05005 2.21411 1.05005 3.65005V12.35C1.05005 13.7859 2.21411 14.95 3.65005 14.95H14.35C14.6813 14.95 14.95 14.6813 14.95 14.35C14.95 14.0186 14.6813 13.75 14.35 13.75H3.65005C2.87685 13.75 2.25005 13.1232 2.25005 12.35V3.65005C2.25005 2.87685 2.87685 2.25005 3.65005 2.25005H14.35C14.6813 2.25005 14.95 1.98142 14.95 1.65005C14.95 1.31868 14.6813 1.05005 14.35 1.05005H3.65005Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M11.6167 5.26668C11.851 5.03236 12.2309 5.03236 12.4652 5.26668L14.7743 7.57575C15.0086 7.81007 15.0086 8.18997 14.7743 8.42428L12.4652 10.7334C12.2309 10.9677 11.851 10.9677 11.6167 10.7334C11.3823 10.499 11.3823 10.1191 11.6167 9.88483L12.9015 8.60002H6.63784C6.30647 8.60002 6.03784 8.3314 6.03784 8.00002C6.03784 7.66865 6.30647 7.40002 6.63784 7.40002H12.9015L11.6167 6.11521C11.3823 5.88089 11.3823 5.50099 11.6167 5.26668Z"}}]},J3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"export-icon",ref:t,icon:kn}))});J3.displayName="ExportIcon";const Bn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.46613 5.2614C7.99641 5.15377 8.54607 5.209 9.04566 5.42016C9.54527 5.63133 9.9725 5.98902 10.2732 6.44821C10.5739 6.90741 10.7345 7.44742 10.7345 7.99994C10.7345 8.74088 10.446 9.45122 9.93293 9.97475C9.41991 10.4982 8.72439 10.7921 7.99945 10.7921C7.45882 10.7921 6.93021 10.6285 6.48047 10.3219C6.03072 10.0152 5.67998 9.57922 5.47282 9.06887C5.26565 8.55852 5.21142 7.99686 5.31705 7.45498C5.42268 6.9131 5.68338 6.41554 6.06598 6.02513C6.44856 5.63474 6.93584 5.36903 7.46613 5.2614ZM7.99945 6.50637C7.70941 6.50637 7.42599 6.59414 7.18504 6.75842C6.94411 6.92269 6.75652 7.15604 6.64579 7.4288C6.53508 7.70156 6.50613 8.00161 6.56255 8.29108C6.61898 8.58055 6.7583 8.84663 6.96308 9.05559C7.16788 9.26456 7.42896 9.40703 7.7134 9.46476C7.99784 9.5225 8.29266 9.49286 8.56052 9.37964C8.82836 9.26643 9.05707 9.07481 9.21789 8.82922C9.3787 8.58364 9.46445 8.29505 9.46445 7.99994C9.46445 7.60424 9.31042 7.22449 9.03583 6.94429C8.76119 6.66405 8.38842 6.50637 7.99945 6.50637Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.06445 7.99994C1.06445 7.86432 1.111 7.68433 1.20506 7.46997C1.29865 7.25669 1.43723 7.01393 1.61634 6.75416C1.97451 6.23466 2.49209 5.65088 3.12753 5.10347C4.3995 4.00771 6.13495 3.06494 7.99945 3.06494C9.86395 3.06494 11.5994 4.00771 12.8714 5.10347C13.5068 5.65088 14.0244 6.23466 14.3826 6.75416C14.5617 7.01393 14.7003 7.25669 14.7938 7.46997C14.8879 7.68433 14.9345 7.86432 14.9345 7.99994C14.9345 8.29406 14.7859 8.75016 14.4847 9.27371C14.1847 9.79497 13.7374 10.3759 13.1495 10.9188C11.974 12.0042 10.2392 12.9349 7.99945 12.9349C5.75972 12.9349 4.02489 12.0042 2.84937 10.9188C2.26147 10.3759 1.81418 9.79497 1.51423 9.27371C1.21296 8.75016 1.06445 8.29406 1.06445 7.99994ZM7.99945 4.36351C6.48933 4.36351 5.14092 5.09788 4.14125 5.91406C3.64087 6.32258 3.22616 6.75295 2.92026 7.12521C2.61595 7.49554 2.415 7.81359 2.34753 7.99756L2.33827 8.0228L2.34954 8.0472C2.85275 9.13669 3.65354 10.055 4.65594 10.6918C5.65805 11.3283 6.81899 11.6563 7.99945 11.6364C9.17991 11.6563 10.3409 11.3283 11.343 10.6918C12.3454 10.055 13.1462 9.13669 13.6494 8.0472L13.6606 8.0228L13.6514 7.99756C13.5839 7.81359 13.383 7.49554 13.0786 7.12521C12.7727 6.75295 12.358 6.32258 11.8577 5.91406C10.858 5.09788 9.50957 4.36351 7.99945 4.36351Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Q3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"eye-icon",ref:t,icon:Bn}))});Q3.displayName="EyeIcon";const Un={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.99967 10.6663C7.47226 10.6663 6.95669 10.5099 6.51815 10.2169C6.07962 9.92391 5.73783 9.50743 5.536 9.02016C5.33416 8.53289 5.28135 7.99672 5.38425 7.47943C5.48714 6.96215 5.74112 6.487 6.11406 6.11406C6.487 5.74112 6.96215 5.48714 7.47943 5.38425C7.99672 5.28135 8.53289 5.33416 9.02016 5.536C9.50743 5.73783 9.92391 6.07962 10.2169 6.51815C10.5099 6.95669 10.6663 7.47226 10.6663 7.99967C10.6663 8.70692 10.3854 9.3852 9.88529 9.88529C9.3852 10.3854 8.70692 10.6663 7.99967 10.6663ZM7.99967 6.66634C7.73597 6.66634 7.47818 6.74454 7.25891 6.89105C7.03965 7.03756 6.86875 7.2458 6.76784 7.48943C6.66692 7.73306 6.64051 8.00115 6.69196 8.25979C6.74341 8.51844 6.8704 8.75601 7.05687 8.94248C7.24334 9.12895 7.48091 9.25594 7.73955 9.30739C7.9982 9.35883 8.26628 9.33243 8.50992 9.23151C8.75355 9.1306 8.96179 8.9597 9.1083 8.74043C9.25481 8.52117 9.33301 8.26338 9.33301 7.99967C9.33301 7.64605 9.19253 7.30691 8.94248 7.05687C8.69243 6.80682 8.3533 6.66634 7.99967 6.66634Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M7.99967 12.6663C3.69701 12.6663 1.33301 9.16101 1.33301 7.99967C1.33301 6.89034 4.40767 3.33301 7.99967 3.33301C11.5917 3.33301 14.6663 6.89034 14.6663 7.99967C14.6663 9.16101 12.3023 12.6663 7.99967 12.6663ZM2.67501 8.01834C3.14932 9.02475 3.90405 9.87286 4.84857 10.4608C5.79309 11.0488 6.88725 11.3517 7.99967 11.333C9.1121 11.3517 10.2063 11.0488 11.1508 10.4608C12.0953 9.87286 12.85 9.02475 13.3243 8.01834C13.0823 7.37167 10.8363 4.66634 7.99967 4.66634C5.16301 4.66634 2.91701 7.37167 2.67501 8.01834Z"}}]},K3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"eye-outline-icon",ref:t,icon:Un}))});K3.displayName="EyeOutlineIcon";const jn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M0.571533 12.0016V4.69797C0.571533 3.37249 1.64605 2.29797 2.97153 2.29797H5.00397C5.90947 2.29797 6.77882 2.65328 7.42511 3.2875C7.84704 3.70155 8.4146 3.93351 9.00576 3.93351H11.6938C12.8536 3.93351 13.7938 4.87372 13.7938 6.03351V6.83533H13.8982C15.064 6.83533 15.8384 8.04207 15.3527 9.10188L13.6724 12.7686C13.4118 13.3374 12.8435 13.702 12.2179 13.702H2.17045C1.20587 13.702 0.515561 12.8793 0.571533 12.0016ZM1.77153 4.69797C1.77153 4.03523 2.30879 3.49797 2.97153 3.49797H5.00397C5.59513 3.49797 6.16269 3.72993 6.58462 4.14399C7.23091 4.77821 8.10026 5.13351 9.00576 5.13351H11.6938C12.1909 5.13351 12.5938 5.53646 12.5938 6.03351V6.83533H4.64069C3.6604 6.83533 2.76344 7.38669 2.32081 8.26136L1.77153 9.34679V4.69797ZM1.77153 12.1373V12.0664C1.77594 12.0179 1.78952 11.9689 1.81355 11.9214L3.39152 8.80319C3.62986 8.33222 4.11284 8.03533 4.64069 8.03533H13.8982C14.1896 8.03533 14.3832 8.33701 14.2618 8.60197L12.5815 12.2687C12.5164 12.4109 12.3743 12.502 12.2179 12.502H2.17045C1.95161 12.502 1.78924 12.3326 1.77153 12.1373Z",fillRule:"evenodd",clipRule:"evenodd"}}]},et=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"folder-icon",ref:t,icon:jn}))});et.displayName="FolderIcon";const zn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.92494 2.4224C5.37364 1.19807 7.10523 1.19807 7.55394 2.4224L11.7284 13.8128C11.8425 14.124 11.6827 14.4686 11.3716 14.5827C11.0604 14.6967 10.7158 14.5369 10.6017 14.2258L9.02773 9.93099C9.02555 9.93101 9.02338 9.93102 9.0212 9.93102H3.74372C3.6469 9.93102 3.55544 9.90809 3.47447 9.86736L1.87714 14.2258C1.76312 14.5369 1.41845 14.6967 1.10732 14.5827C0.796186 14.4686 0.636401 14.124 0.750429 13.8128L4.92494 2.4224ZM3.89093 8.73102H8.58795L6.42722 2.83533C6.36312 2.66043 6.11576 2.66042 6.05165 2.83533L3.89093 8.73102Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.0504 2.47954C13.0504 2.14817 12.7818 1.87954 12.4504 1.87954C12.1191 1.87954 11.8504 2.14817 11.8504 2.47954V4.11554H10.2144C9.88305 4.11554 9.61442 4.38417 9.61442 4.71554C9.61442 5.04691 9.88305 5.31554 10.2144 5.31554H11.8504V6.95155C11.8504 7.28292 12.1191 7.55155 12.4504 7.55155C12.7818 7.55155 13.0504 7.28292 13.0504 6.95155V5.31554H14.6864C15.0178 5.31554 15.2864 5.04691 15.2864 4.71554C15.2864 4.38417 15.0178 4.11554 14.6864 4.11554H13.0504V2.47954Z"}}]},tt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"font-size-increase-icon",ref:t,icon:zn}))});tt.displayName="FontSizeIncreaseIcon";const Wn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.92469 2.4224C5.3734 1.19807 7.10499 1.19807 7.5537 2.4224L11.7282 13.8128C11.8422 14.124 11.6824 14.4686 11.3713 14.5827C11.0602 14.6967 10.7155 14.5369 10.6015 14.2258L9.02748 9.93099C9.02539 9.93101 9.0233 9.93102 9.0212 9.93102H3.74372C3.64682 9.93102 3.55528 9.90805 3.47426 9.86726L1.8769 14.2258C1.76287 14.5369 1.41821 14.6967 1.10708 14.5827C0.795942 14.4686 0.636156 14.124 0.750185 13.8128L4.92469 2.4224ZM3.89068 8.73102H8.58771L6.42698 2.83533C6.36288 2.66043 6.11551 2.66042 6.05141 2.83533L3.89068 8.73102Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M9.61442 4.71554C9.61442 4.38417 9.88305 4.11554 10.2144 4.11554H14.6864C15.0178 4.11554 15.2864 4.38417 15.2864 4.71554C15.2864 5.04691 15.0178 5.31554 14.6864 5.31554H10.2144C9.88305 5.31554 9.61442 5.04691 9.61442 4.71554Z"}}]},nt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"font-size-reduce-icon",ref:t,icon:Wn}))});nt.displayName="FontSizeReduceIcon";const Gn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.14014 12.2599C1.14014 13.6958 2.3042 14.8599 3.74014 14.8599H12.2601C13.6961 14.8599 14.8601 13.6958 14.8601 12.2599V3.73989C14.8601 2.30395 13.6961 1.13989 12.2601 1.13989H3.74014C2.3042 1.13989 1.14014 2.30396 1.14014 3.73989V12.2599ZM2.68766 13.1831C2.47131 12.9367 2.34014 12.6136 2.34014 12.2599V11.9756L5.68213 8.21656V9.69237L2.68766 13.1831ZM3.85969 13.6599H5.68213V11.5354L3.85969 13.6599ZM6.88213 13.6599H12.2601C13.0333 13.6599 13.6601 13.0331 13.6601 12.2599V3.73989C13.6601 2.96669 13.0333 2.33989 12.2601 2.33989H6.88213V13.6599ZM5.68213 2.33989H5.10563L2.34014 5.5448V6.99379L5.68213 3.23472V2.33989ZM2.34014 8.79985V10.1696L5.68213 6.4105V5.04078L2.34014 8.79985ZM2.3405 3.70754L3.50344 2.35982C2.85328 2.47053 2.35588 3.02952 2.3405 3.70754Z",fillRule:"evenodd",clipRule:"evenodd"}}]},rt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"freeze-column-icon",ref:t,icon:Gn}))});rt.displayName="FreezeColumnIcon";const Yn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.74015 1.13989C2.30421 1.13989 1.14015 2.30396 1.14015 3.73989V5.32866C1.14013 5.33155 1.14013 5.33444 1.14015 5.33732V12.2599C1.14015 13.6958 2.30421 14.8599 3.74015 14.8599H12.2602C13.6961 14.8599 14.8602 13.6958 14.8602 12.2599V3.73989C14.8602 2.46491 13.9424 1.40427 12.7315 1.18251C12.6397 1.14703 12.5407 1.13477 12.4436 1.14626C12.383 1.14204 12.3218 1.13989 12.2602 1.13989H3.74015ZM10.9392 2.33989H9.5695L5.81042 5.68188H7.18015L10.9392 2.33989ZM7.76344 2.33989H6.2816L2.34015 5.61425V5.68188H4.00437L7.76344 2.33989ZM2.34015 6.88188V12.2599C2.34015 13.0331 2.96695 13.6599 3.74015 13.6599H12.2602C13.0334 13.6599 13.6602 13.0331 13.6602 12.2599V6.88188H2.34015ZM13.6602 5.68188V4.48357L12.2714 5.68188H13.6602ZM13.4806 3.05349C13.3067 2.745 13.0193 2.50905 12.675 2.40238L8.98621 5.68188H10.4346L13.4806 3.05349ZM2.34015 4.05418L4.4037 2.33989H3.74015C2.96695 2.33989 2.34015 2.9667 2.34015 3.73989V4.05418Z",fillRule:"evenodd",clipRule:"evenodd"}}]},ot=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"freeze-row-icon",ref:t,icon:Yn}))});ot.displayName="FreezeRowIcon";const Xn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.14014 3.73989C1.14014 2.30396 2.3042 1.13989 3.74014 1.13989H12.2601C12.3218 1.13989 12.383 1.14204 12.4436 1.14627C12.5406 1.13479 12.6397 1.14699 12.7315 1.18252C13.9424 1.4043 14.8601 2.46492 14.8601 3.73989V12.2599C14.8601 13.6905 13.7047 14.8513 12.2761 14.8598L12.2572 14.8599L3.74014 14.8599C2.3042 14.8599 1.14014 13.6958 1.14014 12.2599V3.73989ZM12.2677 13.6599L12.2601 13.6599H7.99297L7.99256 8.10687C7.99254 7.88594 8.17163 7.70684 8.39256 7.70684H13.6572V12.2599C13.6572 13.0296 13.0361 13.6542 12.2677 13.6599ZM8.39256 6.50684H9.82177L13.4929 3.07581C13.3217 2.75868 13.0317 2.51513 12.6826 2.40475L8.25499 6.51267C8.30033 6.50881 8.34621 6.50684 8.39256 6.50684ZM13.6601 4.56202L11.5792 6.50684H13.6601V4.56202ZM6.81297 7.85057C6.79953 7.93405 6.79255 8.01969 6.79256 8.10696L6.79265 9.36615L2.72441 13.2234C2.48625 12.9724 2.34014 12.6332 2.34014 12.2599V12.0005L6.81297 7.85057ZM4.00811 13.6599H6.79297L6.79277 11.0197L4.00811 13.6599ZM9.57168 2.33989H10.9882L2.34014 10.3635V8.8534L9.57168 2.33989ZM7.77864 2.33989L2.34014 7.2384V5.61425L6.28159 2.33989H7.77864ZM4.40368 2.33989L2.34014 4.05418V3.73989C2.34014 2.9667 2.96694 2.33989 3.74014 2.33989H4.40368Z",fillRule:"evenodd",clipRule:"evenodd"}}]},it=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"freeze-to-selected-icon",ref:t,icon:Xn}))});it.displayName="FreezeToSelectedIcon";const qn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.09318 3.78608C2.21639 2.9026 2.84219 1.3999 4.08689 1.3999H11.2079C11.7676 1.3999 12.3041 1.62335 12.6984 2.02063L13.2584 2.58488C13.4918 2.82009 13.4904 3.19998 13.2552 3.4334C13.02 3.66683 12.6401 3.66538 12.4066 3.43018L11.8467 2.86593C11.6777 2.69566 11.4477 2.5999 11.2079 2.5999H4.08689C3.90907 2.5999 3.81967 2.81458 3.94493 2.94079L8.24218 7.27082C8.66782 7.69971 8.66782 8.39164 8.24218 8.82053L3.94493 13.1506C3.81967 13.2768 3.90907 13.4915 4.08689 13.4915H11.2079C11.4477 13.4915 11.6777 13.3957 11.8467 13.2254L12.4066 12.6612C12.6401 12.426 13.02 12.4245 13.2552 12.658C13.4904 12.8914 13.4918 13.2713 13.2584 13.5065L12.6984 14.0707C12.3041 14.468 11.7676 14.6915 11.2079 14.6915H4.08689C2.84218 14.6915 2.2164 13.1888 3.09318 12.3053L7.32053 8.04568L3.09318 3.78608Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Re=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"function-icon",ref:t,icon:qn}))});Re.displayName="FunctionIcon";const Jn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.33325 2.60309C1.33325 1.90178 1.90178 1.33325 2.60309 1.33325H13.3967C14.0981 1.33325 14.6666 1.90178 14.6666 2.60309V13.3967C14.6666 14.0981 14.0981 14.6666 13.3967 14.6666H2.60309C1.90178 14.6666 1.33325 14.0981 1.33325 13.3967V2.60309ZM10.5396 13.3967H13.3967V10.5396H10.5396V13.3967ZM9.26976 10.5396V13.3967H6.41262V10.5396H9.26976ZM10.5396 9.26976H13.3967V6.73008H10.5396V9.26976ZM9.26976 6.73008V9.26976H6.41262V6.73008H9.26976ZM10.5396 5.46024H13.3967V2.60309H10.5396V5.46024ZM9.26976 2.60309V5.46024H6.41262V2.60309H9.26976ZM2.60309 2.60309H5.14278V5.46024H2.60309V2.60309ZM2.60309 6.73008H5.14278V9.26976H2.60309V6.73008ZM2.60309 10.5396H5.14278V13.3967H2.60309V10.5396Z",fillRule:"evenodd",clipRule:"evenodd"}}]},lt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"grid-icon",ref:t,icon:Jn}))});lt.displayName="GridIcon";const Qn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.9999 3.90137C4.66853 3.90137 4.3999 4.17 4.3999 4.50137C4.3999 4.83274 4.66853 5.10137 4.9999 5.10137H10.9999C11.3313 5.10137 11.5999 4.83274 11.5999 4.50137C11.5999 4.17 11.3313 3.90137 10.9999 3.90137H4.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.9999 10.8987C4.66853 10.8987 4.3999 11.1673 4.3999 11.4987C4.3999 11.8301 4.66853 12.0987 4.9999 12.0987H10.9999C11.3313 12.0987 11.5999 11.8301 11.5999 11.4987C11.5999 11.1673 11.3313 10.8987 10.9999 10.8987H4.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M12.7 2.0999H3.30005C2.85822 2.0999 2.50005 2.45807 2.50005 2.8999V13.0999C2.50005 13.5417 2.85822 13.8999 3.30005 13.8999H12.7C13.1419 13.8999 13.5 13.5417 13.5 13.0999V2.8999C13.5 2.45808 13.1419 2.0999 12.7 2.0999ZM3.30005 0.899902C2.19548 0.899902 1.30005 1.79533 1.30005 2.8999V13.0999C1.30005 14.2045 2.19548 15.0999 3.30005 15.0999H12.7C13.8046 15.0999 14.7 14.2045 14.7 13.0999V2.8999C14.7 1.79533 13.8046 0.899902 12.7 0.899902H3.30005Z",fillRule:"evenodd",clipRule:"evenodd"}}]},st=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"header-footer-icon",ref:t,icon:Qn}))});st.displayName="HeaderFooterIcon";const Kn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M0.811013 7.27739C0.533711 7.51821 0.50413 7.93822 0.744942 8.21552C0.985753 8.49283 1.40577 8.52241 1.68307 8.28159L1.89249 8.09973V13.0201C1.89249 13.9397 2.63793 14.6851 3.55749 14.6851H5.32136C6.24091 14.6851 6.98636 13.9397 6.98636 13.0201V9.84218C6.98636 9.65717 7.13634 9.50718 7.32136 9.50718H8.67823C8.86325 9.50718 9.01323 9.65716 9.01323 9.84218V13.0201C9.01323 13.9397 9.75868 14.6851 10.6782 14.6851H12.4421C13.3617 14.6851 14.1071 13.9397 14.1071 13.0201V8.09963L14.3165 8.28148C14.5938 8.52229 15.0138 8.49271 15.2546 8.21541C15.4954 7.93811 15.4659 7.51809 15.1886 7.27728L8.567 1.52707C8.24167 1.24456 7.75801 1.24455 7.43267 1.52708L0.811013 7.27739ZM12.7771 6.94465L7.99984 2.79605L3.22249 6.94475V13.0201C3.22249 13.2051 3.37247 13.3551 3.55749 13.3551H5.32136C5.50637 13.3551 5.65636 13.2051 5.65636 13.0201V9.84218C5.65636 8.92263 6.4018 8.17718 7.32136 8.17718H8.67823C9.59779 8.17718 10.3432 8.92263 10.3432 9.84218V13.0201C10.3432 13.2051 10.4932 13.3551 10.6782 13.3551H12.4421C12.6271 13.3551 12.7771 13.2051 12.7771 13.0201V6.94465Z",fillRule:"evenodd",clipRule:"evenodd"}}]},at=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"home-icon",ref:t,icon:Kn}))});at.displayName="HomeIcon";const er={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.91296 6.82256L5.89774 6.82237L2.83868 6.8223C1.89982 6.82228 1.13874 6.06119 1.13872 5.12234L1.13867 3.32265C1.13865 2.38375 1.89977 1.62261 2.83866 1.62261L5.90639 1.62259L5.91296 1.62256L5.91953 1.62259L10.0821 1.62258L10.0868 1.62256L10.0914 1.62258L13.1607 1.62256C14.0996 1.62256 14.8607 2.38368 14.8607 3.32256V5.12253C14.8607 6.06143 14.0996 6.82256 13.1607 6.82253L10.0975 6.82246L10.0868 6.82256L10.076 6.82246L5.92815 6.82237L5.91296 6.82256ZM10.6868 5.62248L13.1607 5.62253C13.4368 5.62254 13.6607 5.39868 13.6607 5.12253V3.32256C13.6607 3.04642 13.4368 2.82256 13.1607 2.82256L10.6868 2.82257V5.62248ZM9.48679 2.82258V5.62245L6.51296 5.62238V2.82259L9.48679 2.82258ZM5.31296 2.8226V5.62236L2.8387 5.6223C2.56257 5.62229 2.33872 5.39845 2.33872 5.12231L2.33867 3.32262C2.33867 3.04647 2.56252 2.82261 2.83867 2.82261L5.31296 2.8226Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.1387 10.8773L1.13878 12.6773C1.13883 13.6162 1.89994 14.3772 2.8388 14.3772L5.90638 14.3772L5.91296 14.3772L5.91955 14.3772L10.0775 14.3772C10.0806 14.3772 10.0837 14.3772 10.0868 14.3772C10.0899 14.3772 10.093 14.3772 10.0961 14.3772L13.1607 14.3772C14.0996 14.3771 14.8607 13.616 14.8607 12.6772V10.8772C14.8607 9.93836 14.0996 9.17725 13.1607 9.17725H2.8387C1.89978 9.17725 1.13865 9.93841 1.1387 10.8773ZM9.48679 10.3772H6.51296V13.1772L9.48679 13.1772V10.3772ZM10.6868 13.1772V10.3772H13.1607C13.4369 10.3772 13.6607 10.6011 13.6607 10.8772V12.6772C13.6607 12.9533 13.4369 13.1771 13.1607 13.1772L10.6868 13.1772ZM5.31296 13.1772V10.3772H2.8387C2.56254 10.3772 2.33868 10.6011 2.3387 10.8773L2.33878 12.6773C2.33879 12.9534 2.56265 13.1772 2.83879 13.1772L5.31296 13.1772Z",fillRule:"evenodd",clipRule:"evenodd"}}]},ct=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"horizontal-merge-icon",ref:t,icon:er}))});ct.displayName="HorizontalMergeIcon";const tr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M3.33315 5.56641C3.00178 5.56641 2.73315 5.83504 2.73315 6.16641C2.73315 6.49778 3.00178 6.76641 3.33315 6.76641H12.6665C12.9979 6.76641 13.2665 6.49778 13.2665 6.16641C13.2665 5.83504 12.9979 5.56641 12.6665 5.56641H3.33315Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M3.33315 12.9004C3.00178 12.9004 2.73315 13.169 2.73315 13.5004C2.73315 13.8318 3.00178 14.1004 3.33315 14.1004H12.6665C12.9979 14.1004 13.2665 13.8318 13.2665 13.5004C13.2665 13.169 12.9979 12.9004 12.6665 12.9004H3.33315Z"}}]},ut=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"horizontally-icon",ref:t,icon:tr}))});ut.displayName="HorizontallyIcon";const nr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.6 1.99991C8.60001 1.66854 8.33138 1.39991 8.00001 1.3999C7.66864 1.3999 7.40001 1.66853 7.4 1.9999L7.39996 7.3999H1.9999C1.66853 7.3999 1.3999 7.66853 1.3999 7.9999C1.3999 8.33127 1.66853 8.5999 1.9999 8.5999H7.39995L7.3999 13.9999C7.3999 14.3313 7.66853 14.5999 7.9999 14.5999C8.33127 14.5999 8.5999 14.3313 8.5999 13.9999L8.59995 8.5999H13.9999C14.3313 8.5999 14.5999 8.33127 14.5999 7.9999C14.5999 7.66853 14.3313 7.3999 13.9999 7.3999H8.59996L8.6 1.99991Z"}}]},dt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"increase-icon",ref:t,icon:nr}))});dt.displayName="IncreaseIcon";const rr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.00016 1.33203C6.68162 1.33203 5.39269 1.72302 4.29636 2.45557C3.20004 3.18811 2.34555 4.2293 1.84097 5.44747C1.33638 6.66565 1.20436 8.00609 1.4616 9.2993C1.71883 10.5925 2.35377 11.7804 3.28612 12.7127C4.21847 13.6451 5.40636 14.28 6.69956 14.5373C7.99277 14.7945 9.33321 14.6625 10.5514 14.1579C11.7696 13.6533 12.8108 12.7988 13.5433 11.7025C14.2758 10.6062 14.6668 9.31724 14.6668 7.9987C14.6649 6.23118 13.9619 4.53662 12.7121 3.2868C11.4622 2.03697 9.76768 1.33397 8.00016 1.33203ZM7.66683 3.9987C7.86461 3.9987 8.05795 4.05735 8.2224 4.16723C8.38685 4.27711 8.51502 4.43329 8.59071 4.61601C8.6664 4.79874 8.6862 4.99981 8.64762 5.19379C8.60903 5.38777 8.51379 5.56595 8.37394 5.7058C8.23409 5.84566 8.0559 5.9409 7.86192 5.97948C7.66794 6.01807 7.46687 5.99826 7.28415 5.92258C7.10142 5.84689 6.94524 5.71872 6.83536 5.55427C6.72548 5.38982 6.66683 5.19648 6.66683 4.9987C6.66683 4.73348 6.77219 4.47913 6.95972 4.29159C7.14726 4.10405 7.40162 3.9987 7.66683 3.9987ZM9.3335 11.332H6.66683C6.49002 11.332 6.32045 11.2618 6.19543 11.1368C6.0704 11.0117 6.00016 10.8422 6.00016 10.6654C6.00016 10.4886 6.0704 10.319 6.19543 10.194C6.32045 10.0689 6.49002 9.9987 6.66683 9.9987H7.3335V7.9987H6.66683C6.49002 7.9987 6.32045 7.92846 6.19543 7.80343C6.0704 7.67841 6.00016 7.50884 6.00016 7.33203C6.00016 7.15522 6.0704 6.98565 6.19543 6.86063C6.32045 6.7356 6.49002 6.66536 6.66683 6.66536H8.00016C8.17698 6.66536 8.34655 6.7356 8.47157 6.86063C8.59659 6.98565 8.66683 7.15522 8.66683 7.33203V9.9987H9.3335C9.51031 9.9987 9.67988 10.0689 9.8049 10.194C9.92993 10.319 10.0002 10.4886 10.0002 10.6654C10.0002 10.8422 9.92993 11.0117 9.8049 11.1368C9.67988 11.2618 9.51031 11.332 9.3335 11.332Z"}}]},ft=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"info-icon",ref:t,icon:rr}))});ft.displayName="InfoIcon";const or={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.3667C1.66853 1.3667 1.3999 1.63533 1.3999 1.9667C1.3999 2.29807 1.66853 2.5667 1.9999 2.5667H13.9999C14.3313 2.5667 14.5999 2.29807 14.5999 1.9667C14.5999 1.63533 14.3313 1.3667 13.9999 1.3667H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 13.4334C1.66853 13.4334 1.3999 13.7021 1.3999 14.0334C1.3999 14.3648 1.66853 14.6334 1.9999 14.6334H13.9999C14.3313 14.6334 14.5999 14.3648 14.5999 14.0334C14.5999 13.7021 14.3313 13.4334 13.9999 13.4334H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M9.49336 10.4244C9.25905 10.19 9.25905 9.81015 9.49336 9.57583L10.4691 8.6001L4.08291 8.6001C3.75154 8.6001 3.48291 8.33147 3.48291 8.0001C3.48291 7.66873 3.75154 7.4001 4.08291 7.4001L10.4691 7.4001L9.49336 6.42436C9.25905 6.19005 9.25905 5.81015 9.49336 5.57583C9.72767 5.34152 10.1076 5.34152 10.3419 5.57583L12.3419 7.57583C12.5762 7.81015 12.5762 8.19005 12.3419 8.42436L10.3419 10.4244C10.1076 10.6587 9.72767 10.6587 9.49336 10.4244Z"}}]},Ct=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"insert-icon",ref:t,icon:or}))});Ct.displayName="InsertIcon";const ir={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M9.80385 1.40005H11.9997C12.3311 1.40005 12.5997 1.66868 12.5997 2.00005C12.5997 2.33143 12.3311 2.60005 11.9997 2.60005H10.1185L7.12251 13.4001H9.33324C9.66461 13.4001 9.93324 13.6687 9.93324 14.0001C9.93324 14.3314 9.66461 14.6001 9.33324 14.6001H6.34785C6.33847 14.6003 6.32905 14.6003 6.31962 14.6001H3.9999C3.66853 14.6001 3.3999 14.3314 3.3999 14.0001C3.3999 13.6687 3.66853 13.4001 3.9999 13.4001H5.87719L8.87322 2.60005H6.66641C6.33504 2.60005 6.06641 2.33143 6.06641 2.00005C6.06641 1.66868 6.33504 1.40005 6.66641 1.40005H9.52916C9.61698 1.37929 9.71064 1.3781 9.80385 1.40005Z"}}]},ht=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"italic-icon",ref:t,icon:ir}))});ht.displayName="ItalicIcon";const lr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.39986 6.33339C3.39986 6.00202 3.66849 5.73339 3.99986 5.73339H4.66652C4.99789 5.73339 5.26652 6.00202 5.26652 6.33339C5.26652 6.66476 4.99789 6.93339 4.66652 6.93339H3.99986C3.66849 6.93339 3.39986 6.66476 3.39986 6.33339Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M6.99986 5.73339C6.66849 5.73339 6.39986 6.00202 6.39986 6.33339C6.39986 6.66476 6.66849 6.93339 6.99986 6.93339H7.66652C7.99789 6.93339 8.26652 6.66476 8.26652 6.33339C8.26652 6.00202 7.99789 5.73339 7.66652 5.73339H6.99986Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M9.06636 6.33339C9.06636 6.00202 9.33499 5.73339 9.66636 5.73339H11.9997C12.3311 5.73339 12.5997 6.00202 12.5997 6.33339C12.5997 6.66476 12.3311 6.93339 11.9997 6.93339H9.66636C9.33499 6.93339 9.06636 6.66476 9.06636 6.33339Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M3.99986 8.73339C3.66849 8.73339 3.39986 9.00202 3.39986 9.33339C3.39986 9.66476 3.66849 9.93339 3.99986 9.93339H11.9999C12.3312 9.93339 12.5999 9.66476 12.5999 9.33339C12.5999 9.00202 12.3312 8.73339 11.9999 8.73339H3.99986Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M3.33338 1.73345L12.6667 1.7334C14.1026 1.73339 15.2667 2.89745 15.2667 4.3334V11C15.2667 12.4359 14.1027 13.6 12.6667 13.6H3.33355C1.89763 13.6 0.733583 12.4359 0.73355 11L0.733398 4.33351C0.733366 2.89755 1.89742 1.73346 3.33338 1.73345ZM12.6667 2.9334L3.33339 2.93345C2.56018 2.93346 1.93338 3.56028 1.9334 4.33348L1.93355 11C1.93357 11.7732 2.56036 12.4 3.33355 12.4H12.6667C13.4399 12.4 14.0667 11.7732 14.0667 11V4.3334C14.0667 3.5602 13.4399 2.93339 12.6667 2.9334Z",fillRule:"evenodd",clipRule:"evenodd"}}]},vt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"keyboard-icon",ref:t,icon:lr}))});vt.displayName="KeyboardIcon";const sr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 5.56641C1.66853 5.56641 1.3999 5.83504 1.3999 6.16641C1.3999 6.49778 1.66853 6.76641 1.9999 6.76641H11.3332C11.6646 6.76641 11.9332 6.49778 11.9332 6.16641C11.9332 5.83504 11.6646 5.56641 11.3332 5.56641H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 12.9004C1.66853 12.9004 1.3999 13.169 1.3999 13.5004C1.3999 13.8318 1.66853 14.1004 1.9999 14.1004H11.3332C11.6646 14.1004 11.9332 13.8318 11.9332 13.5004C11.9332 13.169 11.6646 12.9004 11.3332 12.9004H1.9999Z"}}]},gt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"left-justifying-icon",ref:t,icon:sr}))});gt.displayName="LeftJustifyingIcon";const ar={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.3732 3.94019C0.82475 2.75718 2.04917 1.53276 3.23218 2.0812L10.0657 5.24921C10.3663 5.38859 10.497 5.74529 10.3576 6.04592C10.2183 6.34656 9.86157 6.47728 9.56094 6.33791L6.86664 5.08883L4.42613 7.52934C4.41111 7.54436 4.3955 7.55841 4.37936 7.5715L5.6299 10.2689C5.76928 10.5696 5.63855 10.9263 5.33791 11.0656C5.03728 11.205 4.68058 11.0743 4.54121 10.7737L1.3732 3.94019ZM2.72746 3.1699L5.70713 4.55128L3.84327 6.41514L2.46189 3.43547C2.38354 3.26647 2.55846 3.09155 2.72746 3.1699Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.56311 13.7359C4.32879 13.9702 4.32879 14.3501 4.56311 14.5844C4.79742 14.8188 5.17732 14.8188 5.41163 14.5844L13.3083 6.68776L13.3842 8.21165C13.4006 8.54261 13.6823 8.79755 14.0133 8.78108C14.3442 8.76461 14.5992 8.48295 14.5827 8.15199L14.4844 6.17786C14.4413 5.3118 13.3917 4.90732 12.7786 5.52046L4.56311 13.7359Z"}}]},pt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"left-rotation-forty-five-degrees-icon",ref:t,icon:ar}))});pt.displayName="LeftRotationFortyFiveDegreesIcon";const cr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M11.4046 13.9395C11.4046 14.2708 11.6732 14.5395 12.0046 14.5395C12.336 14.5395 12.6046 14.2708 12.6046 13.9395V2.77186L13.7358 3.79578C13.9815 4.01815 14.3609 3.99927 14.5833 3.75359C14.8057 3.50792 14.7868 3.12849 14.5411 2.90612L13.0757 1.57967C12.4328 0.997761 11.4046 1.45394 11.4046 2.32106V13.9395Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.22244 9.26836C0.998116 8.81966 0.998119 7.08807 2.22245 6.63936L9.29456 4.04749C9.60569 3.93346 9.95036 4.09325 10.0644 4.40438C10.1784 4.71551 10.0186 5.06018 9.70749 5.1742L6.91911 6.19613V9.64753C6.91911 9.66877 6.918 9.68974 6.91585 9.71041L9.70749 10.7335C10.0186 10.8476 10.1784 11.1922 10.0644 11.5033C9.95036 11.8145 9.60569 11.9743 9.29456 11.8602L2.22244 9.26836ZM2.63538 7.76608L5.71911 6.63592V9.27181L2.63538 8.14165C2.46047 8.07755 2.46047 7.83018 2.63538 7.76608Z",fillRule:"evenodd",clipRule:"evenodd"}}]},mt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"left-rotation-ninety-degrees-icon",ref:t,icon:cr}))});mt.displayName="LeftRotationNinetyDegreesIcon";const ur={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.96708 8.23432V11.6842C4.96708 12.0156 5.2357 12.2842 5.56708 12.2842C5.89845 12.2842 6.16708 12.0156 6.16708 11.6842V5.62199C6.16708 4.70621 4.87775 4.5088 4.60373 5.38261L3.2564 9.67905L1.90905 5.3826C1.64268 4.53318 0.345703 4.6789 0.345703 5.62021V11.6842C0.345703 12.0156 0.614332 12.2842 0.945703 12.2842C1.27707 12.2842 1.5457 12.0156 1.5457 11.6842V8.23428L2.49305 11.2552C2.72747 12.0027 3.78534 12.0027 4.01975 11.2552L4.96708 8.23432Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M9.59409 8.3393C9.59409 7.86618 9.18572 7.49641 8.71492 7.54323L7.64429 7.64971C7.31454 7.6825 7.02065 7.44178 6.98785 7.11203C6.95506 6.78229 7.19578 6.48839 7.52553 6.4556L8.59616 6.34912C9.77317 6.23206 10.7941 7.15649 10.7941 8.3393V11.684C10.7941 12.0154 10.5255 12.284 10.1941 12.284C9.86272 12.284 9.59409 12.0154 9.59409 11.684V8.3393Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M6.79541 10.2064C6.79541 9.10233 7.69047 8.20728 8.79458 8.20728C9.89869 8.20728 10.7938 9.10233 10.7938 10.2064C10.7938 11.3106 9.89869 12.2056 8.79458 12.2056C7.69047 12.2056 6.79541 11.3106 6.79541 10.2064ZM8.79458 9.40728C8.35321 9.40728 7.99541 9.76508 7.99541 10.2064C7.99541 10.6478 8.35321 11.0056 8.79458 11.0056C9.23595 11.0056 9.59375 10.6478 9.59375 10.2064C9.59375 9.76508 9.23595 9.40728 8.79458 9.40728Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M15.386 6.62139C15.6666 6.79764 15.7454 7.16426 15.562 7.44024L12.5296 12.0032C12.3462 12.2791 11.9701 12.36 11.6894 12.1837C11.4088 12.0075 11.33 11.6409 11.5135 11.3649L14.5458 6.80196C14.7292 6.52598 15.1054 6.44513 15.386 6.62139Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M11.6892 6.62139C11.4086 6.79764 11.3298 7.16426 11.5132 7.44024L14.5456 12.0032C14.729 12.2791 15.1051 12.36 15.3857 12.1837C15.6664 12.0075 15.7451 11.6409 15.5617 11.3649L12.5294 6.80196C12.3459 6.52598 11.9698 6.44513 11.6892 6.62139Z",fillRule:"evenodd",clipRule:"evenodd"}}]},bt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"max-icon",ref:t,icon:ur}))});bt.displayName="MaxIcon";const dr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.66504 2.8666C1.66504 2.53523 1.93367 2.2666 2.26504 2.2666H13.735C14.0664 2.2666 14.335 2.53523 14.335 2.8666C14.335 3.19797 14.0664 3.4666 13.735 3.4666H2.26504C1.93367 3.4666 1.66504 3.19797 1.66504 2.8666Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.66504 8.00002C1.66504 7.66865 1.93367 7.40002 2.26504 7.40002H13.735C14.0664 7.40002 14.335 7.66865 14.335 8.00002C14.335 8.3314 14.0664 8.60002 13.735 8.60002H2.26504C1.93367 8.60002 1.66504 8.3314 1.66504 8.00002Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.26504 12.5334C1.93367 12.5334 1.66504 12.8021 1.66504 13.1334C1.66504 13.4648 1.93367 13.7334 2.26504 13.7334H13.735C14.0664 13.7334 14.335 13.4648 14.335 13.1334C14.335 12.8021 14.0664 12.5334 13.735 12.5334H2.26504Z"}}]},Lt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"menu-icon",ref:t,icon:dr}))});Lt.displayName="MenuIcon";const fr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M12.5939 1.13916L10.6607 1.1392C9.5563 1.13922 8.66094 2.03448 8.66079 3.13893L8.66064 4.19191C8.6606 4.52328 8.92919 4.79194 9.26056 4.79199C9.59193 4.79204 9.8606 4.52344 9.86064 4.19207L9.86079 3.13909C9.86085 2.69731 10.219 2.33921 10.6608 2.3392L12.594 2.33916C13.0358 2.33915 13.394 2.69732 13.394 3.13916L13.394 7.40012H10.4947L11.0464 6.84845C11.2807 6.61414 11.2807 6.23424 11.0464 5.99993C10.8121 5.76561 10.4322 5.76561 10.1979 5.99993L9.31395 6.88384C8.68914 7.50867 8.68914 8.52171 9.31396 9.14654L10.1979 10.0305C10.4322 10.2648 10.8121 10.2648 11.0464 10.0305C11.2807 9.79614 11.2807 9.41624 11.0464 9.18192L10.4646 8.60012H13.394L13.394 12.8612C13.394 13.303 13.0359 13.6612 12.594 13.6612H10.6606C10.2188 13.6612 9.86064 13.303 9.86064 12.8612V11.8084C9.86064 11.4771 9.59202 11.2084 9.26064 11.2084C8.92927 11.2084 8.66064 11.4771 8.66064 11.8084V12.8612C8.66064 13.9658 9.55607 14.8612 10.6606 14.8612H12.594C13.6986 14.8612 14.594 13.9658 14.594 12.8612L14.594 8.0066L14.594 8.00012L14.594 7.99363L14.594 3.13915C14.594 2.03457 13.6985 1.13914 12.5939 1.13916Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M5.33889 1.13919L3.4057 1.13926C2.30115 1.13931 1.40576 2.03474 1.40578 3.13928L1.40582 7.99139L1.40576 8.00012L1.40582 8.00886L1.40587 12.8612C1.40588 13.9658 2.30131 14.8612 3.40587 14.8612H5.33897C6.44354 14.8612 7.33897 13.9658 7.33897 12.8612V11.8084C7.33897 11.4771 7.07034 11.2084 6.73897 11.2084C6.4076 11.2084 6.13897 11.4771 6.13897 11.8084V12.8612C6.13897 13.303 5.7808 13.6612 5.33897 13.6612H3.40587C2.96405 13.6612 2.60588 13.303 2.60587 12.8612L2.60583 8.60012H5.53538L4.95357 9.18193C4.71925 9.41624 4.71925 9.79614 4.95357 10.0305C5.18788 10.2648 5.56778 10.2648 5.8021 10.0305L6.68599 9.14656C7.31083 8.52172 7.31083 7.50866 6.68599 6.88382L5.8021 5.99993C5.56778 5.76561 5.18788 5.76561 4.95357 5.99993C4.71925 6.23424 4.71925 6.61414 4.95357 6.84845L5.50523 7.40012H2.60582L2.60578 3.13927C2.60577 2.69745 2.96393 2.33928 3.40574 2.33926L5.33894 2.33919C5.78078 2.33917 6.13897 2.69735 6.13897 3.13919V4.192C6.13897 4.52337 6.4076 4.792 6.73897 4.792C7.07034 4.792 7.33897 4.52337 7.33897 4.192V3.13919C7.33897 2.03459 6.44349 1.13914 5.33889 1.13919Z"}}]},wt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"merge-all-icon",ref:t,icon:fr}))});wt.displayName="MergeAllIcon";const Cr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.6707 7.03525C9.0573 7.03525 9.3707 6.72185 9.3707 6.33525C9.3707 5.94866 9.0573 5.63525 8.6707 5.63525C8.28411 5.63525 7.9707 5.94866 7.9707 6.33525C7.9707 6.72185 8.28411 7.03525 8.6707 7.03525Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M8.671 12.2842C8.33963 12.2842 8.071 12.0156 8.071 11.6842L8.071 8.20615C8.071 7.87478 8.33962 7.60615 8.671 7.60615C9.00237 7.60615 9.271 7.87478 9.271 8.20615L9.271 11.6842C9.271 12.0156 9.00237 12.2842 8.671 12.2842Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.5105 9.62735C13.5105 9.09992 13.0091 8.71683 12.5002 8.8555L12.1671 8.94628C11.7319 9.06486 11.43 9.46007 11.43 9.9111V11.6842C11.43 12.0156 11.1614 12.2842 10.83 12.2842C10.4986 12.2842 10.23 12.0156 10.23 11.6842V9.9111C10.23 8.91884 10.8942 8.04938 11.8516 7.7885L12.1847 7.69771C13.4569 7.35104 14.7105 8.30878 14.7105 9.62735V11.6842C14.7105 12.0156 14.4419 12.2842 14.1105 12.2842C13.7792 12.2842 13.5105 12.0156 13.5105 11.6842V9.62735Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.8377 7.66644C11.169 7.66642 11.4377 7.93503 11.4377 8.2664L11.438 11.6841C11.438 12.0155 11.1694 12.2841 10.838 12.2842C10.5066 12.2842 10.238 12.0156 10.238 11.6842L10.2377 8.26649C10.2377 7.93512 10.5063 7.66647 10.8377 7.66644Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M5.91043 8.23408V11.684C5.91043 12.0154 6.17906 12.284 6.51043 12.284C6.84181 12.284 7.11043 12.0154 7.11043 11.684V5.62174C7.11043 4.70597 5.82111 4.50856 5.54709 5.38237L4.19976 9.67881L2.85241 5.38235C2.58604 4.53293 1.28906 4.67865 1.28906 5.61997V11.684C1.28906 12.0154 1.55769 12.284 1.88906 12.284C2.22043 12.284 2.48906 12.0154 2.48906 11.684V8.23404L3.43641 11.255C3.67082 12.0025 4.7287 12.0025 4.9631 11.255L5.91043 8.23408Z",fillRule:"evenodd",clipRule:"evenodd"}}]},yt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"min-icon",ref:t,icon:Cr}))});yt.displayName="MinIcon";const hr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M11.3536 6.14645C11.5488 6.34171 11.5488 6.65829 11.3536 6.85355L8.35355 9.85355C8.15829 10.0488 7.84171 10.0488 7.64645 9.85355L4.64645 6.85355C4.45118 6.65829 4.45118 6.34171 4.64645 6.14645C4.84171 5.95118 5.15829 5.95118 5.35355 6.14645L8 8.79289L10.6464 6.14645C10.8417 5.95118 11.1583 5.95118 11.3536 6.14645Z",fillRule:"evenodd",clipRule:"evenodd"}}]},z1=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"more-down-icon",ref:t,icon:hr}))});z1.displayName="MoreDownIcon";const vr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8 3.30078C8.55228 3.30078 9 2.85307 9 2.30078C9 1.7485 8.55228 1.30078 8 1.30078C7.44772 1.30078 7 1.7485 7 2.30078C7 2.85307 7.44772 3.30078 8 3.30078Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M8 9.00012C8.55228 9.00012 9 8.55241 9 8.00012C9 7.44784 8.55228 7.00012 8 7.00012C7.44772 7.00012 7 7.44784 7 8.00012C7 8.55241 7.44772 9.00012 8 9.00012Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M9 13.6995C9 14.2517 8.55228 14.6995 8 14.6995C7.44772 14.6995 7 14.2517 7 13.6995C7 13.1472 7.44772 12.6995 8 12.6995C8.55228 12.6995 9 13.1472 9 13.6995Z"}}]},Ve=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"more-function-icon",ref:t,icon:vr}))});Ve.displayName="MoreFunctionIcon";const gr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.90913 3.57564C6.14345 3.34132 6.52335 3.34132 6.75766 3.57564L10.7577 7.57564C10.992 7.80995 10.992 8.18985 10.7577 8.42417L6.75766 12.4242C6.52335 12.6585 6.14345 12.6585 5.90913 12.4242C5.67482 12.1899 5.67482 11.81 5.90913 11.5756L9.48487 7.9999L5.90913 4.42417C5.67482 4.18985 5.67482 3.80995 5.90913 3.57564Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Ne=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"more-icon",ref:t,icon:gr}))});Ne.displayName="MoreIcon";const pr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.1349 1.3999C6.80353 1.3999 6.5349 1.66853 6.5349 1.9999C6.5349 2.33127 6.80353 2.5999 7.1349 2.5999H7.67993V4.55065C7.67993 4.88203 7.94856 5.15065 8.27993 5.15065C8.6113 5.15065 8.87993 4.88203 8.87993 4.55065V2.5999H9.4049C9.73627 2.5999 10.0049 2.33127 10.0049 1.9999C10.0049 1.66853 9.73627 1.3999 9.4049 1.3999H7.1349Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.5999 7.1349C2.5999 6.80353 2.33127 6.5349 1.9999 6.5349C1.66853 6.5349 1.3999 6.80353 1.3999 7.1349V9.4049C1.3999 9.73627 1.66853 10.0049 1.9999 10.0049C2.33127 10.0049 2.5999 9.73627 2.5999 9.4049V8.86968H4.54992C4.88129 8.86968 5.14992 8.60105 5.14992 8.26968C5.14992 7.93831 4.88129 7.66968 4.54992 7.66968H2.5999V7.1349Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M15.1399 7.1349C15.1399 6.80353 14.8713 6.5349 14.5399 6.5349C14.2085 6.5349 13.9399 6.80353 13.9399 7.1349V7.66968H12.0099C11.6786 7.66968 11.4099 7.93831 11.4099 8.26968C11.4099 8.60105 11.6786 8.86968 12.0099 8.86968H13.9399V9.4049C13.9399 9.73627 14.2085 10.0049 14.5399 10.0049C14.8713 10.0049 15.1399 9.73627 15.1399 9.4049V8.27463L15.1399 8.26968L15.1399 8.26472V7.1349Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M7.1349 13.9399C6.80353 13.9399 6.5349 14.2085 6.5349 14.5399C6.5349 14.8713 6.80353 15.1399 7.1349 15.1399H8.24962C8.25966 15.1404 8.26977 15.1407 8.27993 15.1407C8.2901 15.1407 8.3002 15.1404 8.31024 15.1399H9.4049C9.73627 15.1399 10.0049 14.8713 10.0049 14.5399C10.0049 14.2085 9.73627 13.9399 9.4049 13.9399H8.87993V12.0107C8.87993 11.6793 8.6113 11.4107 8.27993 11.4107C7.94856 11.4107 7.67993 11.6793 7.67993 12.0107V13.9399H7.1349Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.60991 4.00967C2.60991 3.23647 3.23671 2.60967 4.00991 2.60967H4.33991C4.67128 2.60967 4.93991 2.34104 4.93991 2.00967C4.93991 1.6783 4.67128 1.40967 4.33991 1.40967H4.00991C2.57397 1.40967 1.40991 2.57373 1.40991 4.00967V4.33967C1.40991 4.67104 1.67854 4.93967 2.00991 4.93967C2.34128 4.93967 2.60991 4.67104 2.60991 4.33967V4.00967Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M12.1999 1.40967C11.8685 1.40967 11.5999 1.6783 11.5999 2.00967C11.5999 2.34104 11.8685 2.60967 12.1999 2.60967H12.5299C13.3031 2.60967 13.9299 3.23647 13.9299 4.00967V4.33967C13.9299 4.67104 14.1985 4.93967 14.5299 4.93967C14.8613 4.93967 15.1299 4.67104 15.1299 4.33967V4.00967C15.1299 2.57373 13.9659 1.40967 12.5299 1.40967H12.1999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.60991 12.1997C2.60991 11.8683 2.34128 11.5997 2.00991 11.5997C1.67854 11.5997 1.40991 11.8683 1.40991 12.1997V12.5297C1.40991 13.9656 2.57397 15.1297 4.00991 15.1297H4.33991C4.67128 15.1297 4.93991 14.861 4.93991 14.5297C4.93991 14.1983 4.67128 13.9297 4.33991 13.9297H4.00991C3.23671 13.9297 2.60991 13.3029 2.60991 12.5297V12.1997Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M15.1299 12.1997C15.1299 11.8683 14.8613 11.5997 14.5299 11.5997C14.1985 11.5997 13.9299 11.8683 13.9299 12.1997V12.5297C13.9299 13.3029 13.3031 13.9297 12.5299 13.9297H12.1999C11.8685 13.9297 11.5999 14.1983 11.5999 14.5297C11.5999 14.861 11.8685 15.1297 12.1999 15.1297H12.5299C13.9659 15.1297 15.1299 13.9656 15.1299 12.5297V12.1997Z"}}]},It=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"no-border-icon",ref:t,icon:pr}))});It.displayName="NoBorderIcon";const mr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M6.671 2.24246C7.1197 1.01814 8.85129 1.01814 9.3 2.24246L11.8919 9.31458C12.0059 9.62571 11.8461 9.97038 11.535 10.0844C11.2238 10.1984 10.8792 10.0386 10.7652 9.72751L9.74324 6.93913H6.29183C6.2706 6.93913 6.24962 6.93802 6.22895 6.93587L5.20584 9.72751C5.09181 10.0386 4.74715 10.1984 4.43601 10.0844C4.12488 9.97038 3.96509 9.62571 4.07912 9.31458L6.671 2.24246ZM8.17328 2.6554L9.30345 5.73913H6.66755L7.79771 2.6554C7.86181 2.48049 8.10918 2.48049 8.17328 2.6554Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 11.4246C1.66853 11.4246 1.3999 11.6933 1.3999 12.0246C1.3999 12.356 1.66853 12.6246 1.9999 12.6246H13.1675L12.1436 13.7558C11.9212 14.0015 11.9401 14.3809 12.1858 14.6033C12.4314 14.8257 12.8109 14.8068 13.0332 14.5611L14.3597 13.0957C14.9416 12.4528 14.4854 11.4246 13.6183 11.4246H1.9999Z"}}]},Mt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"no-rotation-icon",ref:t,icon:mr}))});Mt.displayName="NoRotationIcon";const br={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.65465 3.96697V2.9942C1.65465 2.9188 1.64353 2.86563 1.62465 2.83387C1.61052 2.81011 1.58943 2.79243 1.53852 2.79243H1.44483C1.23836 2.79243 1.07099 2.62506 1.07099 2.41859C1.07099 2.23956 1.19714 2.09152 1.36369 2.04728C1.4425 2.02634 1.51336 2.00423 1.57642 1.98104C1.65529 1.94986 1.73286 1.91381 1.80913 1.87285C1.8974 1.82544 1.99768 1.79517 2.10303 1.79517C2.41692 1.79517 2.67137 2.04962 2.67137 2.36351V4.02047C2.67137 4.12385 2.75517 4.20765 2.85855 4.20765C3.0614 4.20765 3.22585 4.3721 3.22585 4.57495V4.63332C3.22585 4.86842 3.03527 5.059 2.80018 5.059H1.41884C1.1829 5.059 0.993164 4.86511 0.993164 4.63087C0.993164 4.39932 1.18072 4.20765 1.41398 4.20765C1.5469 4.20765 1.65465 4.09989 1.65465 3.96697Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M0.949709 9.2145C1.14957 9.02907 1.33226 8.85497 1.49677 8.69321C1.6914 8.50496 1.84244 8.33306 1.95136 8.17747C2.05826 8.02476 2.10492 7.89219 2.10492 7.77781C2.10492 7.65255 2.07293 7.57986 2.02759 7.53865L2.0245 7.5357C1.97641 7.48761 1.9103 7.46013 1.81635 7.46013C1.71986 7.46013 1.6383 7.47348 1.5822 7.51611L1.58034 7.51749C1.42279 7.63092 1.19425 7.67086 1.03149 7.50811L1.02187 7.49849C0.868433 7.34505 0.852261 7.07998 1.03819 6.93364C1.12802 6.86293 1.21897 6.8051 1.31109 6.76081C1.48788 6.67257 1.69616 6.63037 1.93278 6.63037C2.15191 6.63037 2.34929 6.67491 2.52246 6.76665C2.69563 6.85514 2.83257 6.98323 2.93172 7.14966C3.03175 7.31758 3.08022 7.51184 3.08022 7.72929C3.08022 7.91104 3.03028 8.09333 2.93429 8.27521C2.84374 8.45283 2.72797 8.62691 2.58859 8.79616C2.51109 8.88842 2.43304 8.97759 2.35442 9.06369C2.34919 9.06941 2.34388 9.07573 2.33892 9.08228C2.34542 9.08201 2.35268 9.08151 2.36075 9.08073C2.46266 9.07087 2.54985 9.06576 2.62168 9.06576H2.78662C3.02915 9.06576 3.22576 9.26237 3.22576 9.5049C3.22576 9.74742 3.02915 9.94403 2.78662 9.94403H1.23472C1.00261 9.94403 0.814453 9.75587 0.814453 9.52376C0.814453 9.40615 0.86379 9.29421 0.949709 9.2145Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.2579 14.674C1.45109 14.7553 1.67487 14.7946 1.92711 14.7946C2.1451 14.7946 2.34841 14.7599 2.53619 14.6895L2.53746 14.689C2.7264 14.6148 2.88145 14.5071 2.99952 14.3647L3.00018 14.3639C3.12167 14.2138 3.18089 14.0326 3.18089 13.8252C3.18089 13.6181 3.12169 13.4411 2.99737 13.3022C2.91596 13.2112 2.81864 13.1388 2.70642 13.0846C2.80611 13.023 2.88805 12.9505 2.95017 12.8661C3.04138 12.7422 3.08609 12.5977 3.08609 12.4365C3.08609 12.1403 2.97594 11.9041 2.7521 11.7404C2.53645 11.5772 2.25212 11.5002 1.90815 11.5002C1.7136 11.5002 1.52963 11.5372 1.35712 11.6115C1.28512 11.6418 1.21426 11.6776 1.14456 11.7188C0.938688 11.8404 0.928034 12.1099 1.06649 12.2774C1.21291 12.4544 1.46028 12.4561 1.63989 12.363C1.70891 12.3286 1.78521 12.3109 1.87023 12.3109C1.96356 12.3109 2.01717 12.3317 2.04691 12.3578C2.07449 12.3821 2.09529 12.4231 2.09529 12.4981C2.09529 12.5709 2.0658 12.6284 1.99667 12.6764C1.96042 12.6999 1.8978 12.7216 1.80025 12.7355C1.61051 12.7625 1.44118 12.9145 1.44118 13.1237C1.44118 13.3319 1.60937 13.4885 1.80489 13.5068C1.87785 13.5136 1.93575 13.5234 1.97985 13.5355C2.07997 13.562 2.12905 13.596 2.14927 13.6246C2.17519 13.6614 2.19008 13.7078 2.19008 13.7684C2.19008 13.8334 2.16583 13.8754 2.1142 13.9064C2.05357 13.9428 1.96521 13.965 1.84179 13.965C1.749 13.965 1.6547 13.9433 1.55817 13.8981C1.363 13.7983 1.08846 13.8083 0.942801 14.01L0.936366 14.0189C0.827321 14.1699 0.821861 14.401 0.994678 14.5262C1.07406 14.5836 1.16225 14.633 1.2579 14.674Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M5.13037 2.827C4.799 2.827 4.53037 3.09563 4.53037 3.427C4.53037 3.75837 4.799 4.027 5.13037 4.027H15.1489C15.4803 4.027 15.7489 3.75837 15.7489 3.427C15.7489 3.09563 15.4803 2.827 15.1489 2.827H5.13037Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.53037 8.28711C4.53037 7.95574 4.799 7.68711 5.13037 7.68711H15.1489C15.4803 7.68711 15.7489 7.95574 15.7489 8.28711C15.7489 8.61848 15.4803 8.88711 15.1489 8.88711H5.13037C4.799 8.88711 4.53037 8.61848 4.53037 8.28711Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M5.13037 12.5475C4.799 12.5475 4.53037 12.8161 4.53037 13.1475C4.53037 13.4788 4.799 13.7475 5.13037 13.7475H15.1489C15.4803 13.7475 15.7489 13.4788 15.7489 13.1475C15.7489 12.8161 15.4803 12.5475 15.1489 12.5475H5.13037Z"}}]},_t=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"order-icon",ref:t,icon:br}))});_t.displayName="OrderIcon";const Lr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.9999 0.733154C8.33127 0.733154 8.5999 1.00178 8.5999 1.33315V5.33315C8.5999 5.66453 8.33127 5.93315 7.9999 5.93315C7.66853 5.93315 7.3999 5.66453 7.3999 5.33315V1.33315C7.3999 1.00178 7.66853 0.733154 7.9999 0.733154Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.46621 2.73315C2.79758 2.73315 3.06621 3.00178 3.06621 3.33315V12.6665C3.06621 12.9979 2.79758 13.2665 2.46621 13.2665C2.13484 13.2665 1.86621 12.9979 1.86621 12.6665V3.33315C1.86621 3.00178 2.13484 2.73315 2.46621 2.73315Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M5.3334 7.3999C5.00203 7.3999 4.7334 7.66853 4.7334 7.9999C4.7334 8.33127 5.00203 8.5999 5.3334 8.5999H12.603L11.9252 9.28591C11.6922 9.52163 11.6945 9.90152 11.9302 10.1344C12.166 10.3673 12.5458 10.3651 12.7788 10.1293L14.4577 8.43018C14.69 8.19509 14.6884 7.81641 14.4542 7.58324L12.7753 5.91184C12.5404 5.67806 12.1605 5.67891 11.9267 5.91375C11.6929 6.14859 11.6938 6.52849 11.9286 6.76228L12.5691 7.3999H5.3334Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M8.5999 10.6667C8.5999 10.3353 8.33127 10.0667 7.9999 10.0667C7.66853 10.0667 7.3999 10.3353 7.3999 10.6667V14.6667C7.3999 14.998 7.66853 15.2667 7.9999 15.2667C8.33127 15.2667 8.5999 14.998 8.5999 14.6667V10.6667Z"}}]},St=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"overflow-icon",ref:t,icon:Lr}))});St.displayName="OverflowIcon";const wr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.85059 4.06725C1.85059 2.84302 2.84302 1.85059 4.06725 1.85059C5.29148 1.85059 6.28392 2.84302 6.28392 4.06725C6.28392 5.29148 5.29148 6.28392 4.06725 6.28392C2.84302 6.28392 1.85059 5.29148 1.85059 4.06725ZM4.06725 2.95059C3.45053 2.95059 2.95059 3.45053 2.95059 4.06725C2.95059 4.68397 3.45053 5.18392 4.06725 5.18392C4.68397 5.18392 5.18392 4.68397 5.18392 4.06725C5.18392 3.45053 4.68397 2.95059 4.06725 2.95059Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M9.7168 11.933C9.7168 10.7087 10.7092 9.71631 11.9335 9.71631C13.1577 9.71631 14.1501 10.7087 14.1501 11.933C14.1501 13.1572 13.1577 14.1496 11.9335 14.1496C10.7092 14.1496 9.7168 13.1572 9.7168 11.933ZM11.9335 10.8163C11.3167 10.8163 10.8168 11.3163 10.8168 11.933C10.8168 12.5497 11.3167 13.0496 11.9335 13.0496C12.5502 13.0496 13.0501 12.5497 13.0501 11.933C13.0501 11.3163 12.5502 10.8163 11.9335 10.8163Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.5241 3.32407C13.7584 3.08975 13.7584 2.70986 13.5241 2.47554C13.2898 2.24123 12.9099 2.24123 12.6755 2.47554L2.47554 12.6755C2.24123 12.9099 2.24123 13.2898 2.47554 13.5241C2.70986 13.7584 3.08975 13.7584 3.32407 13.5241L13.5241 3.32407Z"}}]},Ht=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"percent-icon",ref:t,icon:wr}))});Ht.displayName="PercentIcon";const yr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.35928 2.57764C3.61338 1.77872 4.36128 1.19995 5.24437 1.19995C6.12746 1.19995 6.87537 1.77872 7.12947 2.57764H11.7885C13.4928 2.57764 14.7999 3.8461 14.7997 5.5888C14.7995 7.33129 13.4929 8.59984 11.7885 8.59984H6.63121L6.6224 8.5999H4.21143C3.16019 8.5999 2.4001 9.34071 2.4002 10.4109C2.40029 11.4814 3.16029 12.2221 4.21143 12.2221H8.87045C9.12449 11.4231 9.87245 10.8442 10.7556 10.8442C11.6388 10.8442 12.3868 11.4231 12.6408 12.2222H14.1999C14.5312 12.2222 14.7999 12.4908 14.7999 12.8222C14.7999 13.1535 14.5312 13.4222 14.1999 13.4222H12.6407C12.3866 14.221 11.6387 14.7998 10.7556 14.7998C9.87252 14.7998 9.12461 14.221 8.87051 13.4221H4.21143C2.50701 13.4221 1.20035 12.1536 1.2002 10.4111C1.20004 8.66836 2.50712 7.3999 4.21143 7.3999H6.61326L6.62208 7.39984H11.7885C12.8396 7.39984 13.5996 6.65912 13.5997 5.58868C13.5998 4.51844 12.8397 3.77764 11.7885 3.77764H7.12952C6.87548 4.57664 6.12753 5.1555 5.24437 5.1555C4.36122 5.1555 3.61327 4.57664 3.35922 3.77764H1.8002C1.46882 3.77764 1.2002 3.50901 1.2002 3.17764C1.2002 2.84627 1.46882 2.57764 1.8002 2.57764H3.35928ZM4.46671 3.16449C4.47377 2.74105 4.81924 2.39995 5.24437 2.39995C5.67026 2.39995 6.0162 2.74226 6.02207 3.16675L6.02197 3.17764L6.02207 3.1886C6.01625 3.61314 5.67029 3.95549 5.24437 3.95549C4.81921 3.95549 4.47372 3.61435 4.46671 3.19085L4.46685 3.17764L4.46671 3.16449ZM9.97788 12.8307C9.98254 13.2562 10.329 13.5998 10.7556 13.5998C11.1815 13.5998 11.5274 13.2575 11.5333 12.8331C11.5332 12.8294 11.5332 12.8258 11.5332 12.8222C11.5332 12.8185 11.5332 12.8148 11.5333 12.8111C11.5275 12.3866 11.1815 12.0442 10.7556 12.0442C10.3289 12.0442 9.98248 12.3878 9.97788 12.8134C9.97792 12.8163 9.97794 12.8192 9.97794 12.8221C9.97794 12.825 9.97792 12.8278 9.97788 12.8307Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Et=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"piping-icon",ref:t,icon:yr}))});Et.displayName="PipingIcon";const Ir={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M11.273 2.72206C11.0214 2.50641 10.9922 2.12763 11.2079 1.87603C11.4235 1.62444 11.8023 1.59531 12.0539 1.81097L14.3833 3.80761C14.5134 3.91733 14.5962 4.08137 14.5967 4.26477L14.5967 4.2665C14.5967 4.41745 14.541 4.55538 14.4489 4.66083C14.44 4.67109 14.4307 4.68108 14.421 4.69077L12.0877 7.02411C11.8534 7.25842 11.4735 7.25843 11.2392 7.02412C11.0049 6.78981 11.0049 6.40991 11.2392 6.17559L12.5482 4.8665H6.63324C4.40569 4.8665 2.5999 6.67229 2.5999 8.89984C2.5999 11.1274 4.40569 12.9332 6.63324 12.9332H11.9972C12.3286 12.9332 12.5972 13.2018 12.5972 13.5332C12.5972 13.8645 12.3286 14.1332 11.9972 14.1332H6.63324C3.74295 14.1332 1.3999 11.7901 1.3999 8.89984C1.3999 6.00955 3.74295 3.6665 6.63324 3.6665H12.3748L11.273 2.72206Z"}}]},Dt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"redo-icon",ref:t,icon:Ir}))});Dt.displayName="RedoIcon";const Mr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M6.33307 1.3916C5.14145 1.3916 4.06641 2.27555 4.06641 3.49366V6.49777C4.06641 7.71586 5.14145 8.59982 6.33307 8.59982C7.52469 8.59982 8.59974 7.71586 8.59974 6.49777V3.49366C8.59974 2.27555 7.52469 1.3916 6.33307 1.3916ZM5.26641 3.49366C5.26641 3.05264 5.68376 2.5916 6.33307 2.5916C6.98239 2.5916 7.39974 3.05264 7.39974 3.49366V6.49777C7.39974 6.93878 6.98239 7.39982 6.33307 7.39982C5.68376 7.39982 5.26641 6.93878 5.26641 6.49777V3.49366Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M7.90913 9.5417C8.14345 9.30739 8.52335 9.30739 8.75766 9.5417C8.99198 9.77602 8.99198 10.1559 8.75766 10.3902L7.78193 11.366H13.9999C14.3313 11.366 14.5999 11.6346 14.5999 11.966C14.5999 12.2973 14.3313 12.566 13.9999 12.566H7.78193L8.75766 13.5417C8.99198 13.776 8.99198 14.1559 8.75766 14.3902C8.52335 14.6245 8.14345 14.6245 7.90913 14.3902L5.91739 12.3985C5.80388 12.2893 5.73324 12.1359 5.73324 11.966C5.73324 11.796 5.80388 11.6426 5.91739 11.5334L7.90913 9.5417Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 8.3002C1.3999 7.96882 1.66853 7.7002 1.9999 7.7002H2.33324C2.66461 7.7002 2.93324 7.96882 2.93324 8.3002C2.93324 8.63157 2.66461 8.9002 2.33324 8.9002H1.9999C1.66853 8.9002 1.3999 8.63157 1.3999 8.3002Z"}}]},Ot=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"reduce-digits-icon",ref:t,icon:Mr}))});Ot.displayName="ReduceDigitsIcon";const _r={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 7.9999C1.3999 7.66853 1.66853 7.3999 1.9999 7.3999H13.9999C14.3313 7.3999 14.5999 7.66853 14.5999 7.9999C14.5999 8.33127 14.3313 8.5999 13.9999 8.5999H1.9999C1.66853 8.5999 1.3999 8.33127 1.3999 7.9999Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Te=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"reduce-icon",ref:t,icon:_r}))});Te.displayName="ReduceIcon";const Sr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.66665 5.56641C4.33528 5.56641 4.06665 5.83504 4.06665 6.16641C4.06665 6.49778 4.33528 6.76641 4.66665 6.76641H14C14.3314 6.76641 14.6 6.49778 14.6 6.16641C14.6 5.83504 14.3314 5.56641 14 5.56641H4.66665Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.66665 12.9004C4.33528 12.9004 4.06665 13.169 4.06665 13.5004C4.06665 13.8318 4.33528 14.1004 4.66665 14.1004H14C14.3314 14.1004 14.6 13.8318 14.6 13.5004C14.6 13.169 14.3314 12.9004 14 12.9004H4.66665Z"}}]},Rt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"right-justifying-icon",ref:t,icon:Sr}))});Rt.displayName="RightJustifyingIcon";const Hr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M12.1994 1.49307C13.3824 0.944623 14.6068 2.16904 14.0584 3.35206L10.8904 10.1855C10.751 10.4862 10.3943 10.6169 10.0937 10.4775C9.79302 10.3381 9.66229 9.98144 9.80166 9.68081L11.0507 6.98651L8.61023 4.546C8.59522 4.53098 8.58116 4.51537 8.56807 4.49924L5.87063 5.74977C5.57 5.88915 5.2133 5.75842 5.07392 5.45779C4.93455 5.15715 5.06528 4.80045 5.36591 4.66108L12.1994 1.49307ZM12.9697 2.84734L11.5883 5.82701L9.72443 3.96315L12.7041 2.58177C12.8731 2.50342 13.048 2.67833 12.9697 2.84734Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.40366 4.68273C2.16934 4.44842 1.78945 4.44842 1.55513 4.68273C1.32082 4.91705 1.32082 5.29695 1.55513 5.53126L9.45182 13.4279L7.92792 13.5038C7.59696 13.5203 7.34202 13.8019 7.35849 14.1329C7.37497 14.4639 7.65662 14.7188 7.98758 14.7023L9.96172 14.6041C10.8278 14.5609 11.2323 13.5113 10.6191 12.8982L2.40366 4.68273Z"}}]},Vt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"right-rotation-forty-five-degrees-icon",ref:t,icon:Hr}))});Vt.displayName="RightRotationFortyFiveDegreesIcon";const Er={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"g",attrs:{fill:"currentColor",clipPath:"url(#right-rotation-ninety-degrees-icon_clip0_927_166)"},children:[{tag:"path",attrs:{d:"M3.11339 1.41934C3.11339 1.08797 2.84476 0.819336 2.51339 0.819336C2.18201 0.819336 1.91338 1.08797 1.91338 1.41934V12.5869L0.782193 11.563C0.53652 11.3406 0.157091 11.3595 -0.0652855 11.6052C-0.287662 11.8509 -0.268776 12.2303 -0.0231021 12.4527L1.44231 13.7791C2.08518 14.361 3.11338 13.9049 3.11338 13.0377L3.11339 1.41934Z"}},{tag:"path",attrs:{d:"M12.2955 9.26826C13.5199 8.81955 13.5199 7.08797 12.2955 6.63926L5.22343 4.04738C4.9123 3.93336 4.56763 4.09314 4.45361 4.40428C4.33958 4.71541 4.49936 5.06007 4.8105 5.1741L7.59888 6.19602V9.64743C7.59888 9.66866 7.59999 9.68964 7.60214 9.71031L4.8105 10.7334C4.49936 10.8474 4.33958 11.1921 4.45361 11.5032C4.56763 11.8144 4.9123 11.9742 5.22343 11.8601L12.2955 9.26826ZM11.8826 7.76597L8.79888 6.63581V9.27171L11.8826 8.14155C12.0575 8.07745 12.0575 7.83008 11.8826 7.76597Z",fillRule:"evenodd",clipRule:"evenodd"}}]},{tag:"defs",attrs:{},children:[{tag:"clipPath",attrs:{id:"right-rotation-ninety-degrees-icon_clip0_927_166"},children:[{tag:"path",attrs:{fill:"white",d:"M0 0H16V16H0z"}}]}]}],defIds:["right-rotation-ninety-degrees-icon_clip0_927_166"]},Nt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"right-rotation-ninety-degrees-icon",ref:t,icon:Er}))});Nt.displayName="RightRotationNinetyDegreesIcon";const Dr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M11.9445 1.55649C12.2184 1.744 12.2895 2.11755 12.1033 2.39085L9.24342 6.58659H12.8001C13.1315 6.58659 13.4001 6.85522 13.4001 7.18659C13.4001 7.51796 13.1315 7.78659 12.8001 7.78659H8.5999V9.91276H13.2221C13.5534 9.91276 13.8221 10.1814 13.8221 10.5128C13.8221 10.8441 13.5534 11.1128 13.2221 11.1128H8.5999V14.0877C8.5999 14.4191 8.33127 14.6877 7.9999 14.6877C7.66853 14.6877 7.3999 14.4191 7.3999 14.0877V11.1128H2.77773C2.44636 11.1128 2.17773 10.8441 2.17773 10.5128C2.17773 10.1814 2.44636 9.91276 2.77773 9.91276H7.3999V7.78659H3.2001C2.86873 7.78659 2.6001 7.51796 2.6001 7.18659C2.6001 6.85522 2.86873 6.58659 3.2001 6.58659H6.75736L3.89753 2.39085C3.71125 2.11755 3.78234 1.744 4.05631 1.55649C4.33029 1.36899 4.7034 1.43854 4.88968 1.71184L7.94595 6.19577C7.96752 6.22741 7.98564 6.2604 8.00039 6.29429C8.01514 6.2604 8.03326 6.22741 8.05483 6.19577L11.1111 1.71184C11.2974 1.43854 11.6705 1.36899 11.9445 1.55649Z"}}]},Tt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"rmb-icon",ref:t,icon:Dr}))});Tt.displayName="RmbIcon";const Or={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M9.72502 1.02051H6.07803C4.97346 1.02051 4.07803 1.91594 4.07803 3.02051V7.57046H3.00039C2.66902 7.57046 2.40039 7.83909 2.40039 8.17046C2.40039 8.50183 2.66902 8.77046 3.00039 8.77046H4.07803V10.4854H3.00039C2.66902 10.4854 2.40039 10.754 2.40039 11.0854C2.40039 11.4167 2.66902 11.6854 3.00039 11.6854H4.07803V14.3795C4.07803 14.7108 4.34666 14.9795 4.67803 14.9795C5.0094 14.9795 5.27803 14.7108 5.27803 14.3795V11.6854H10.3637C10.695 11.6854 10.9637 11.4167 10.9637 11.0854C10.9637 10.754 10.695 10.4854 10.3637 10.4854H5.27803V8.77046H9.72503C11.8651 8.77046 13.6 7.03557 13.6 4.89548C13.6 2.75539 11.8651 1.02051 9.72502 1.02051ZM9.72503 7.57046H5.27803V3.12051C5.27803 2.62345 5.68097 2.22051 6.17803 2.22051H9.72502C11.2024 2.22051 12.4 3.41814 12.4 4.89548C12.4 6.37283 11.2024 7.57046 9.72503 7.57046Z",fillRule:"evenodd",clipRule:"evenodd"}}]},xt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"rouble-icon",ref:t,icon:Or}))});xt.displayName="RoubleIcon";const Rr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.66628 8.66683C5.03447 8.66683 5.33294 8.36835 5.33294 8.00016C5.33294 7.63197 5.03447 7.3335 4.66628 7.3335C4.29809 7.3335 3.99961 7.63197 3.99961 8.00016C3.99961 8.36835 4.29809 8.66683 4.66628 8.66683Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M5.99935 10.0002C5.99935 10.3684 5.70087 10.6668 5.33268 10.6668C4.96449 10.6668 4.66602 10.3684 4.66602 10.0002C4.66602 9.63197 4.96449 9.3335 5.33268 9.3335C5.70087 9.3335 5.99935 9.63197 5.99935 10.0002Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M3.33268 10.6668C3.70087 10.6668 3.99935 10.3684 3.99935 10.0002C3.99935 9.63197 3.70087 9.3335 3.33268 9.3335C2.96449 9.3335 2.66602 9.63197 2.66602 10.0002C2.66602 10.3684 2.96449 10.6668 3.33268 10.6668Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M7.33294 8.00016C7.33294 8.36835 7.03447 8.66683 6.66628 8.66683C6.29809 8.66683 5.99961 8.36835 5.99961 8.00016C5.99961 7.63197 6.29809 7.3335 6.66628 7.3335C7.03447 7.3335 7.33294 7.63197 7.33294 8.00016Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M7.33268 10.6668C7.70087 10.6668 7.99935 10.3684 7.99935 10.0002C7.99935 9.63197 7.70087 9.3335 7.33268 9.3335C6.96449 9.3335 6.66602 9.63197 6.66602 10.0002C6.66602 10.3684 6.96449 10.6668 7.33268 10.6668Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M9.33294 8.00016C9.33294 8.36835 9.03447 8.66683 8.66628 8.66683C8.29809 8.66683 7.99961 8.36835 7.99961 8.00016C7.99961 7.63197 8.29809 7.3335 8.66628 7.3335C9.03447 7.3335 9.33294 7.63197 9.33294 8.00016Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M9.33268 10.6668C9.70087 10.6668 9.99935 10.3684 9.99935 10.0002C9.99935 9.63197 9.70087 9.3335 9.33268 9.3335C8.96449 9.3335 8.66602 9.63197 8.66602 10.0002C8.66602 10.3684 8.96449 10.6668 9.33268 10.6668Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M11.3329 8.00016C11.3329 8.36835 11.0345 8.66683 10.6663 8.66683C10.2981 8.66683 9.99961 8.36835 9.99961 8.00016C9.99961 7.63197 10.2981 7.3335 10.6663 7.3335C11.0345 7.3335 11.3329 7.63197 11.3329 8.00016Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M11.3327 10.6668C11.7009 10.6668 11.9993 10.3684 11.9993 10.0002C11.9993 9.63197 11.7009 9.3335 11.3327 9.3335C10.9645 9.3335 10.666 9.63197 10.666 10.0002C10.666 10.3684 10.9645 10.6668 11.3327 10.6668Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.3329 8.00016C13.3329 8.36835 13.0345 8.66683 12.6663 8.66683C12.2981 8.66683 11.9996 8.36835 11.9996 8.00016C11.9996 7.63197 12.2981 7.3335 12.6663 7.3335C13.0345 7.3335 13.3329 7.63197 13.3329 8.00016Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.99961 12.0002C4.99961 11.632 5.29809 11.3335 5.66628 11.3335H10.3329C10.7011 11.3335 10.9996 11.632 10.9996 12.0002C10.9996 12.3684 10.7011 12.6668 10.3329 12.6668H5.66628C5.29809 12.6668 4.99961 12.3684 4.99961 12.0002Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.9999 2.00016C13.9999 1.63197 13.7014 1.3335 13.3332 1.3335C12.965 1.3335 12.6665 1.63197 12.6665 2.00016V3.37516H11.3332C10.7809 3.37516 10.3332 3.82287 10.3332 4.37516V5.3335H1.99935C1.26297 5.3335 0.666016 5.93045 0.666016 6.66683V13.3335C0.666016 14.0699 1.26297 14.6668 1.99935 14.6668H13.9993C14.7357 14.6668 15.3327 14.0699 15.3327 13.3335V6.66683C15.3327 5.93045 14.7357 5.3335 13.9993 5.3335H11.6665V4.7085H12.9999C13.5522 4.7085 13.9999 4.26079 13.9999 3.7085V2.00016ZM1.99935 6.66683V13.3335H13.9993V6.66683H1.99935Z",fillRule:"evenodd",clipRule:"evenodd"}}]},$t=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"shortcut-icon",ref:t,icon:Rr}))});$t.displayName="ShortcutIcon";const Vr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.00033 1.20996C6.43345 1.20996 5.23596 1.88077 4.64804 2.94304C4.06338 3.99943 4.15123 5.32084 4.90099 6.47062C5.08199 6.7482 5.45374 6.82648 5.73131 6.64548C6.00888 6.46448 6.08716 6.09273 5.90616 5.81516C5.36418 4.98402 5.35768 4.13897 5.69797 3.52412C6.035 2.91515 6.78176 2.40996 8.00033 2.40996C9.19423 2.40996 10.0017 2.93409 10.5236 3.46755C10.7871 3.73682 10.9756 4.00712 11.0974 4.20903C11.158 4.30951 11.2013 4.39164 11.2284 4.44625C11.2419 4.47351 11.2514 4.49377 11.2568 4.50588L11.2621 4.51771C11.3901 4.82216 11.7407 4.96686 12.046 4.83992C12.3519 4.71267 12.4968 4.36149 12.3695 4.05552L11.8231 4.28278C12.3695 4.05552 12.3697 4.0558 12.3695 4.05552L12.3691 4.05437L12.3685 4.05298L12.367 4.04953L12.3629 4.03993L12.3498 4.01036C12.3388 3.98619 12.3234 3.95326 12.3033 3.91282C12.2632 3.83203 12.2043 3.72072 12.1249 3.58908C11.9666 3.32674 11.7235 2.97805 11.3814 2.62834C10.6921 1.92381 9.59192 1.20996 8.00033 1.20996Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.11953 8.5999H7.88935C10.1109 9.46549 10.5895 10.7649 10.4268 11.6869C10.2475 12.703 9.26939 13.5898 8.00009 13.5898C6.63323 13.5898 5.77631 13.0502 5.25534 12.528C4.99021 12.2623 4.80823 11.9965 4.69365 11.7993C4.63659 11.7011 4.59698 11.6211 4.5727 11.5686C4.56059 11.5424 4.55236 11.5231 4.54774 11.512L4.54352 11.5016C4.4267 11.193 4.0823 11.0363 3.77279 11.1516C3.46228 11.2673 3.30438 11.6129 3.4201 11.9234L3.9649 11.7203C3.4201 11.9234 3.41998 11.9231 3.4201 11.9234L3.4206 11.9247L3.42118 11.9263L3.42262 11.9301L3.42661 11.9403C3.42977 11.9484 3.43394 11.9588 3.43914 11.9713C3.44956 11.9965 3.46418 12.0304 3.48334 12.0719C3.52161 12.1547 3.57828 12.2682 3.65608 12.4021C3.81124 12.6692 4.0534 13.0223 4.40584 13.3756C5.12 14.0914 6.27196 14.7898 8.00009 14.7898C9.82574 14.7898 11.3236 13.5101 11.6085 11.8955C11.812 10.7422 11.3901 9.55402 10.2665 8.5999H13.8804C14.2117 8.5999 14.4803 8.33127 14.4803 7.9999C14.4803 7.66853 14.2117 7.3999 13.8804 7.3999H8.01411C8.0048 7.39968 7.99551 7.39969 7.98625 7.3999H2.11953C1.78816 7.3999 1.51953 7.66853 1.51953 7.9999C1.51953 8.33127 1.78816 8.5999 2.11953 8.5999Z"}}]},Zt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"strikethrough-icon",ref:t,icon:Vr}))});Zt.displayName="StrikethroughIcon";const Nr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{stroke:"currentColor",d:"M2.08596 14.1387L10.3379 2.66873",strokeLinecap:"round",strokeWidth:1.2}},{tag:"path",attrs:{stroke:"currentColor",d:"M10.3379 14.1387L2.08596 2.66873",strokeLinecap:"round",strokeWidth:1.2}},{tag:"path",attrs:{stroke:"currentColor",d:"M12.8098 10.0174C13.4565 9.45285 14.781 9.44507 15.0272 10.5759C15.2798 11.736 13.8101 13.2515 12.7376 14.1033C12.7227 14.1151 12.7315 14.1389 12.7505 14.1388L15.2251 14.1388",strokeLinecap:"round",strokeWidth:1.2}}]},At=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"subscript-icon",ref:t,icon:Nr}))});At.displayName="SubscriptIcon";const Tr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M0.394135 6.52121C0.394135 5.4474 1.26463 4.5769 2.33844 4.5769H3.90929C4.24066 4.5769 4.50929 4.84553 4.50929 5.1769C4.50929 5.50828 4.24066 5.7769 3.90929 5.7769H2.33844C1.92737 5.7769 1.59414 6.11014 1.59414 6.52121C1.59414 6.93228 1.92737 7.26552 2.33844 7.26552H2.45171C3.59368 7.26552 4.50929 8.20288 4.50929 9.33362C4.50929 10.4761 3.58419 11.4231 2.43051 11.4231H0.893457C0.562086 11.4231 0.293457 11.1544 0.293457 10.8231C0.293457 10.4917 0.562086 10.2231 0.893457 10.2231H2.43051C2.91024 10.2231 3.30929 9.82458 3.30929 9.33362C3.30929 8.85437 2.91974 8.46552 2.45171 8.46552H2.33844C1.26463 8.46552 0.394135 7.59502 0.394135 6.52121Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M15.1061 11.4231C14.7747 11.4231 14.5061 11.1545 14.5061 10.8231L14.5061 8.31006C14.5061 7.97762 14.2366 7.70812 13.9041 7.70812C13.5717 7.70812 13.3022 7.97762 13.3022 8.31006L13.3022 10.8231C13.3022 11.1545 13.0335 11.4231 12.7022 11.4231C12.3708 11.4231 12.1022 11.1545 12.1022 10.8231L12.1022 8.31006C12.1022 7.31488 12.9089 6.50812 13.9041 6.50812C14.8993 6.50812 15.7061 7.31488 15.7061 8.31006L15.7061 10.8231C15.7061 11.1545 15.4374 11.4231 15.1061 11.4231Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M12.7022 11.4231C12.3709 11.4231 12.1022 11.1545 12.1022 10.8231L12.1022 8.31006C12.1022 7.97762 11.8327 7.70812 11.5003 7.70812C11.1679 7.70812 10.8984 7.97762 10.8984 8.31006L10.8984 10.8231C10.8984 11.1545 10.6297 11.4231 10.2984 11.4231C9.967 11.4231 9.69837 11.1545 9.69837 10.8231L9.69837 8.31006C9.69837 7.31488 10.5051 6.50812 11.5003 6.50812C12.4955 6.50812 13.3022 7.31488 13.3022 8.31006L13.3022 10.8231C13.3022 11.1545 13.0336 11.4231 12.7022 11.4231Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M5.58193 6.69556C5.9133 6.69556 6.18193 6.96419 6.18193 7.29556L6.18193 9.43683C6.18193 9.87101 6.53391 10.223 6.96809 10.223C7.40228 10.223 7.75425 9.87101 7.75425 9.43683L7.75425 7.29556C7.75425 6.96419 8.02288 6.69556 8.35425 6.69556C8.68563 6.69556 8.95425 6.96419 8.95425 7.29556L8.95425 9.43683C8.95425 10.5338 8.06502 11.423 6.96809 11.423C5.87117 11.423 4.98193 10.5338 4.98193 9.43683L4.98193 7.29556C4.98193 6.96419 5.25056 6.69556 5.58193 6.69556Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Pt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"sum-icon",ref:t,icon:Tr}))});Pt.displayName="SumIcon";const xr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{stroke:"currentColor",d:"M2.10904 14.4537L10.299 3.06987",strokeLinecap:"round",strokeWidth:1.2}},{tag:"path",attrs:{stroke:"currentColor",d:"M10.2989 14.4537L2.10899 3.06987",strokeLinecap:"round",strokeWidth:1.2}},{tag:"path",attrs:{stroke:"currentColor",d:"M12.7525 3.35933C13.3943 2.79901 14.7089 2.79129 14.9533 3.91363C15.204 5.06487 13.7456 6.56876 12.6812 7.41429C12.6663 7.4261 12.6751 7.44982 12.6941 7.44982L15.1497 7.44977",strokeLinecap:"round",strokeWidth:1.2}}]},Ft=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"superscript-icon",ref:t,icon:xr}))});Ft.displayName="SuperscriptIcon";const $r={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.21572 1.80029C2.54709 1.80029 2.81572 2.06892 2.81572 2.40029V14.0003C2.81572 14.3317 2.54709 14.6003 2.21572 14.6003C1.88435 14.6003 1.61572 14.3317 1.61572 14.0003V2.40029C1.61572 2.06892 1.88435 1.80029 2.21572 1.80029Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.7841 1.80029C14.1155 1.80029 14.3841 2.06892 14.3841 2.40029V14.0003C14.3841 14.3317 14.1155 14.6003 13.7841 14.6003C13.4527 14.6003 13.1841 14.3317 13.1841 14.0003V8.60259H7.13467C6.8033 8.60259 6.53467 8.33396 6.53467 8.00259C6.53467 7.67122 6.8033 7.40259 7.13467 7.40259H13.1841V2.40029C13.1841 2.06892 13.4527 1.80029 13.7841 1.80029Z"}}]},kt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"truncation-icon",ref:t,icon:$r}))});kt.displayName="TruncationIcon";const Zr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.46416 2.03237C4.46416 1.701 4.19553 1.43237 3.86416 1.43237C3.53279 1.43237 3.26416 1.701 3.26416 2.03237V7.33338C3.26416 10.0313 5.35834 12.2667 7.9999 12.2667C10.6415 12.2667 12.7356 10.0313 12.7356 7.33338V2.03237C12.7356 1.701 12.467 1.43237 12.1356 1.43237C11.8043 1.43237 11.5356 1.701 11.5356 2.03237V7.33338C11.5356 9.42194 9.92656 11.0667 7.9999 11.0667C6.07325 11.0667 4.46416 9.42194 4.46416 7.33338V2.03237Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.66641 13.4663C2.33504 13.4663 2.06641 13.7349 2.06641 14.0663C2.06641 14.3977 2.33504 14.6663 2.66641 14.6663H13.3331C13.6644 14.6663 13.9331 14.3977 13.9331 14.0663C13.9331 13.7349 13.6644 13.4663 13.3331 13.4663H2.66641Z"}}]},Bt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"underline-icon",ref:t,icon:Zr}))});Bt.displayName="UnderlineIcon";const Ar={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.72365 2.72206C4.97524 2.50641 5.00437 2.12763 4.78872 1.87603C4.57306 1.62444 4.19428 1.59531 3.94269 1.81097L1.61333 3.80761C1.48281 3.91768 1.3999 4.08241 1.3999 4.2665C1.3999 4.41745 1.45564 4.55538 1.54766 4.66083C1.55661 4.67109 1.56594 4.68108 1.57563 4.69077L3.9089 7.02411C4.14321 7.25842 4.52311 7.25843 4.75743 7.02412C4.99175 6.78981 4.99175 6.40991 4.75744 6.17559L3.44839 4.8665H9.36337C11.5909 4.8665 13.3967 6.67229 13.3967 8.89984C13.3967 11.1274 11.5909 12.9332 9.36337 12.9332H3.99937C3.668 12.9332 3.39937 13.2018 3.39937 13.5332C3.39937 13.8645 3.668 14.1332 3.99937 14.1332H9.36337C12.2537 14.1332 14.5967 11.7901 14.5967 8.89984C14.5967 6.00955 12.2537 3.6665 9.36337 3.6665H3.62183L4.72365 2.72206Z"}}]},Ut=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"undo-icon",ref:t,icon:Ar}))});Ut.displayName="UndoIcon";const Pr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.03012 3.14006C3.03012 3.59845 2.65851 3.97006 2.20012 3.97006C1.74172 3.97006 1.37012 3.59845 1.37012 3.14006C1.37012 2.68166 1.74172 2.31006 2.20012 2.31006C2.65851 2.31006 3.03012 2.68166 3.03012 3.14006Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.53027 2.54014C4.1989 2.54014 3.93027 2.80877 3.93027 3.14014C3.93027 3.47151 4.1989 3.74014 4.53027 3.74014H14.5488C14.8802 3.74014 15.1488 3.47151 15.1488 3.14014C15.1488 2.80877 14.8802 2.54014 14.5488 2.54014H4.53027Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.20012 8.82992C2.65851 8.82992 3.03012 8.45832 3.03012 7.99992C3.03012 7.54153 2.65851 7.16992 2.20012 7.16992C1.74172 7.16992 1.37012 7.54153 1.37012 7.99992C1.37012 8.45832 1.74172 8.82992 2.20012 8.82992Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.53027 7.4C4.1989 7.4 3.93027 7.66863 3.93027 8C3.93027 8.33137 4.1989 8.6 4.53027 8.6H14.5488C14.8802 8.6 15.1488 8.33137 15.1488 8C15.1488 7.66863 14.8802 7.4 14.5488 7.4H4.53027Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.20012 13.6905C2.65851 13.6905 3.03012 13.3189 3.03012 12.8605C3.03012 12.4021 2.65851 12.0305 2.20012 12.0305C1.74172 12.0305 1.37012 12.4021 1.37012 12.8605C1.37012 13.3189 1.74172 13.6905 2.20012 13.6905Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.53027 12.2604C4.1989 12.2604 3.93027 12.529 3.93027 12.8604C3.93027 13.1917 4.1989 13.4604 4.53027 13.4604H14.5488C14.8802 13.4604 15.1488 13.1917 15.1488 12.8604C15.1488 12.529 14.8802 12.2604 14.5488 12.2604H4.53027Z"}}]},jt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"unorder-icon",ref:t,icon:Pr}))});jt.displayName="UnorderIcon";const Fr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.9999 0.733398C8.33127 0.733398 8.5999 1.00203 8.5999 1.3334V4.55137L9.57564 3.57564C9.80995 3.34132 10.1899 3.34132 10.4242 3.57564C10.6585 3.80995 10.6585 4.18985 10.4242 4.42417L8.42417 6.42417C8.18985 6.65848 7.80995 6.65848 7.57564 6.42417L5.57564 4.42417C5.34132 4.18985 5.34132 3.80995 5.57564 3.57564C5.80995 3.34132 6.18985 3.34132 6.42417 3.57564L7.3999 4.55137V1.3334C7.3999 1.00203 7.66853 0.733398 7.9999 0.733398Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M5.57564 11.5756L7.57564 9.57564C7.80995 9.34132 8.18985 9.34132 8.42417 9.57564L10.4242 11.5756C10.6585 11.81 10.6585 12.1899 10.4242 12.4242C10.1899 12.6585 9.80995 12.6585 9.57564 12.4242L8.5999 11.4484V14.6665C8.5999 14.9979 8.33127 15.2665 7.9999 15.2665C7.66853 15.2665 7.3999 14.9979 7.3999 14.6665V11.4484L6.42417 12.4242C6.18985 12.6585 5.80995 12.6585 5.57564 12.4242C5.34132 12.1899 5.34132 11.81 5.57564 11.5756Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 7.40015C1.66853 7.40015 1.3999 7.66878 1.3999 8.00015C1.3999 8.33152 1.66853 8.60015 1.9999 8.60015H13.9999C14.3313 8.60015 14.5999 8.33152 14.5999 8.00015C14.5999 7.66878 14.3313 7.40015 13.9999 7.40015H1.9999Z"}}]},zt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"vertical-center-icon",ref:t,icon:Fr}))});zt.displayName="VerticalCenterIcon";const kr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.2157 2.90265C2.2157 2.16628 2.81264 1.56934 3.54901 1.56934H6.21565C6.95202 1.56934 7.54896 2.16628 7.54896 2.90265V13.5692C7.54896 14.3056 6.95202 14.9025 6.21565 14.9025H3.54901C2.81264 14.9025 2.2157 14.3056 2.2157 13.5692V2.90265ZM3.54901 2.90265H6.21565V5.5622H3.54901V2.90265ZM3.54901 6.89552V9.57631H6.21565V6.89552H3.54901ZM3.54901 13.5692V10.9096H6.21565V13.5692H3.54901Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.2156 2.90265C10.2156 2.16628 10.8125 1.56934 11.5489 1.56934H14.2155C14.9519 1.56934 15.5489 2.16628 15.5489 2.90265V13.5692C15.5489 14.3056 14.9519 14.9025 14.2155 14.9025H11.5489C10.8125 14.9025 10.2156 14.3056 10.2156 13.5692V2.90265ZM11.5489 2.90265H14.2155V5.5622H11.5489V2.90265ZM11.5489 6.89552V9.57631H14.2155V6.89552H11.5489ZM11.5489 13.5692V10.9096H14.2155V13.5692H11.5489Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Wt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"vertical-integration-icon",ref:t,icon:kr}))});Wt.displayName="VerticalIntegrationIcon";const Br={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.55504 2.73208C4.55504 2.40071 4.28641 2.13208 3.95504 2.13208C3.62367 2.13208 3.35504 2.40071 3.35504 2.73208V12.5172L2.21439 11.5276C1.96409 11.3104 1.58515 11.3373 1.36799 11.5876C1.15084 11.8379 1.17771 12.2169 1.42801 12.434L2.89972 13.7108C3.54718 14.2726 4.55504 13.8127 4.55504 12.9555L4.55504 2.73208Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M9.00725 4.01095C9.45595 2.78663 11.1875 2.78662 11.6362 4.01095L14.743 12.488C14.8571 12.7992 14.6973 13.1438 14.3861 13.2578C14.075 13.3719 13.7303 13.2121 13.6163 12.9009L12.4148 9.62242H8.36729C8.32154 9.62242 8.27699 9.6173 8.23417 9.6076L7.02719 12.9009C6.91316 13.2121 6.5685 13.3719 6.25736 13.2578C5.94623 13.1438 5.78644 12.7992 5.90047 12.488L9.00725 4.01095ZM10.5095 4.42388L11.975 8.42242H8.66853L10.134 4.42389C10.1981 4.24898 10.4454 4.24898 10.5095 4.42388Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Gt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"vertical-text-icon",ref:t,icon:Br}))});Gt.displayName="VerticalTextIcon";const Ur={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M8.60231 5.77597L9.38125 6.55432C9.61658 6.78947 9.99797 6.78932 10.2331 6.554C10.4683 6.31867 10.4681 5.93728 10.2328 5.70214L8.44939 3.92009C8.33908 3.79657 8.1786 3.7188 7.99995 3.7188C7.84562 3.71861 7.6906 3.77736 7.57281 3.89506L5.76712 5.69933C5.5318 5.93447 5.53165 6.31587 5.76679 6.55119C6.00193 6.78652 6.38332 6.78667 6.61865 6.55153L7.3976 5.77319L7.3976 10.2246L6.61865 9.44621C6.38333 9.21107 6.00194 9.21121 5.76679 9.44654C5.53165 9.68186 5.53179 10.0633 5.76712 10.2984L7.55051 12.0804C7.66082 12.204 7.82131 12.2817 7.99995 12.2817L8.00089 12.2817C8.15512 12.2819 8.30939 12.2231 8.4271 12.1055L10.2328 10.3012C10.4681 10.0661 10.4683 9.68467 10.2331 9.44934C9.99798 9.21402 9.61659 9.21387 9.38126 9.44901L8.60231 10.2274L8.60231 5.77597Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.7039 3.24701C14.0539 3.24701 14.3377 2.96327 14.3377 2.61325C14.3377 2.26324 14.0539 1.97949 13.7039 1.97949L2.29627 1.97949C1.94625 1.97949 1.66251 2.26324 1.66251 2.61325C1.66251 2.96327 1.94625 3.24701 2.29627 3.24701L13.7039 3.24701Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.7039 14.0209C14.0539 14.0209 14.3377 13.7372 14.3377 13.3872C14.3377 13.0371 14.0539 12.7534 13.7039 12.7534L2.29627 12.7534C1.94625 12.7534 1.66251 13.0371 1.66251 13.3872C1.66251 13.7372 1.94625 14.0209 2.29627 14.0209L13.7039 14.0209Z"}}]},Yt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"adjust-height-double-icon",ref:t,icon:Ur}))});Yt.displayName="AdjustHeightDoubleIcon";const jr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M5.77574 7.3974L6.5541 6.61846C6.78924 6.38313 6.78909 6.00174 6.55377 5.7666C6.31844 5.53145 5.93705 5.5316 5.70191 5.76692L3.91987 7.55032C3.79634 7.66063 3.71857 7.82111 3.71857 7.99976C3.71838 8.15409 3.77713 8.30912 3.89483 8.42691L5.6991 10.2326C5.93425 10.4679 6.31564 10.4681 6.55096 10.2329C6.78629 9.99778 6.78644 9.61639 6.5513 9.38106L5.77296 8.60211L10.2243 8.60211L9.44598 9.38106C9.21084 9.61638 9.21099 9.99777 9.44631 10.2329C9.68164 10.4681 10.063 10.4679 10.2982 10.2326L12.0802 8.4492C12.2037 8.33889 12.2815 8.1784 12.2815 7.99976L12.2815 7.99882C12.2816 7.84459 12.2229 7.69032 12.1052 7.57261L10.301 5.76693C10.0658 5.5316 9.68444 5.53145 9.44911 5.76659C9.21379 6.00173 9.21364 6.38312 9.44878 6.61845L10.2271 7.3974L5.77574 7.3974Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M3.24683 2.29598C3.24683 1.94596 2.96308 1.66222 2.61307 1.66222C2.26305 1.66222 1.97931 1.94596 1.97931 2.29598L1.97931 13.7036C1.97931 14.0537 2.26305 14.3374 2.61307 14.3374C2.96308 14.3374 3.24683 14.0537 3.24683 13.7036L3.24683 2.29598Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M14.0207 2.29598C14.0207 1.94596 13.737 1.66222 13.387 1.66222C13.037 1.66222 12.7532 1.94596 12.7532 2.29598L12.7532 13.7036C12.7532 14.0537 13.037 14.3374 13.387 14.3374C13.737 14.3374 14.0207 14.0537 14.0207 13.7036L14.0207 2.29598Z"}}]},Xt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"adjust-width-double-icon",ref:t,icon:jr}))});Xt.displayName="AdjustWidthDoubleIcon";const zr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.29713 1.98047C1.94717 1.98047 1.66348 2.26416 1.66348 2.61412C1.66348 2.96408 1.94717 3.24777 2.29713 3.24777H13.7028C14.0528 3.24777 14.3365 2.96408 14.3365 2.61412C14.3365 2.26416 14.0528 1.98047 13.7028 1.98047H2.29713Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.29713 12.7525C1.94717 12.7525 1.66348 13.0362 1.66348 13.3862C1.66348 13.7361 1.94717 14.0198 2.29713 14.0198H13.7028C14.0528 14.0198 14.3365 13.7361 14.3365 13.3862C14.3365 13.0362 14.0528 12.7525 13.7028 12.7525H2.29713Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M7.42163 4.25588L4.25471 11.2231C4.10989 11.5417 4.25077 11.9174 4.56935 12.0622C4.88794 12.207 5.2636 12.0661 5.40841 11.7475L6.24766 9.90119H9.75197L10.5912 11.7475C10.736 12.0661 11.1117 12.207 11.4303 12.0622C11.7489 11.9174 11.8897 11.5417 11.7449 11.2231L8.578 4.25589C8.5675 4.23244 8.55557 4.20961 8.54227 4.18755C8.49012 4.10102 8.41688 4.0262 8.32579 3.97171C8.301 3.95688 8.27527 3.94377 8.24878 3.93246C8.16764 3.89775 8.08309 3.8813 7.99981 3.88135C7.88457 3.88142 7.77177 3.91309 7.67384 3.97171C7.58714 4.02361 7.5121 4.09664 7.45735 4.18755C7.44406 4.20961 7.43213 4.23244 7.42163 4.25588ZM9.17592 8.63388L7.99981 6.04644L6.8237 8.63388H9.17592Z",fillRule:"evenodd",clipRule:"evenodd"}}]},qt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"auto-height-double-icon",ref:t,icon:zr}))});qt.displayName="AutoHeightDoubleIcon";const Wr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.98032 13.7028C1.98032 14.0527 2.26401 14.3364 2.61397 14.3364C2.96392 14.3364 3.24762 14.0527 3.24762 13.7028L3.24762 2.29706C3.24762 1.9471 2.96392 1.66341 2.61397 1.66341C2.26401 1.66341 1.98032 1.9471 1.98032 2.29706L1.98032 13.7028Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M12.7524 13.7028C12.7524 14.0527 13.0361 14.3364 13.386 14.3364C13.736 14.3364 14.0197 14.0527 14.0197 13.7028L14.0197 2.29706C14.0197 1.9471 13.736 1.66341 13.386 1.66341C13.0361 1.66341 12.7524 1.9471 12.7524 2.29706L12.7524 13.7028Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M7.42187 4.25588L4.25495 11.2231C4.11014 11.5417 4.25101 11.9174 4.5696 12.0622C4.88819 12.207 5.26385 12.0661 5.40866 11.7475L6.2479 9.90119H9.75222L10.5915 11.7475C10.7363 12.0661 11.1119 12.207 11.4305 12.0622C11.7491 11.9174 11.89 11.5417 11.7452 11.2231L8.57825 4.25589C8.56775 4.23244 8.55582 4.20961 8.54252 4.18755C8.49037 4.10102 8.41713 4.0262 8.32603 3.97171C8.30125 3.95688 8.27551 3.94377 8.24902 3.93246C8.16788 3.89775 8.08333 3.8813 8.00006 3.88135C7.88481 3.88142 7.77201 3.91309 7.67409 3.97171C7.58739 4.02361 7.51235 4.09664 7.4576 4.18755C7.4443 4.20961 7.43237 4.23244 7.42187 4.25588ZM9.17617 8.63388L8.00006 6.04644L6.82395 8.63388H9.17617Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Jt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"auto-width-double-icon",ref:t,icon:Wr}))});Jt.displayName="AutoWidthDoubleIcon";const Gr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M13.5853 14.7987L2.27159 3.485L3.12012 2.63647L14.4338 13.9502L13.5853 14.7987Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M1.69629 12.8102L1.69629 14.1743C1.69629 14.8371 2.23355 15.3743 2.89629 15.3743L4.26042 15.3743L4.26042 14.0443L3.02629 14.0443L3.02629 12.8102L1.69629 12.8102ZM4.26042 2.06128L2.89629 2.06128C2.23355 2.06128 1.69629 2.59854 1.69629 3.26128L1.69629 4.62541L3.02629 4.62541L3.02629 3.39128L4.26042 3.39128L4.26042 2.06128ZM1.69629 10.0819L3.02629 10.0819L3.02629 7.35367L1.69629 7.35367L1.69629 10.0819ZM6.98868 2.06128L6.98868 3.39128L9.71693 3.39128L9.71693 2.06128L6.98868 2.06128ZM12.4452 2.06128L12.4452 3.39128L13.6793 3.39128L13.6793 4.62541L15.0093 4.62541L15.0093 3.26128C15.0093 2.59854 14.4721 2.06128 13.8093 2.06128L12.4452 2.06128ZM15.0093 7.35367L13.6793 7.35367L13.6793 10.0819L15.0093 10.0819L15.0093 7.35367ZM15.0093 12.8102L13.6793 12.8102L13.6793 14.0443L12.4452 14.0443L12.4452 15.3743L13.8093 15.3743C14.4721 15.3743 15.0093 14.8371 15.0093 14.1743L15.0093 12.8102ZM9.71693 15.3743L9.71693 14.0443L6.98868 14.0443L6.98868 15.3743L9.71693 15.3743Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Qt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"back-slash-double-icon",ref:t,icon:Gr}))});Qt.displayName="BackSlashDoubleIcon";const Yr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M5.36831 3.22148C5.36831 1.94497 6.40313 0.910156 7.67964 0.910156C8.95615 0.910156 9.99097 1.94497 9.99097 3.22149V6.74754H8.72649V3.22149C8.72649 2.64333 8.2578 2.17464 7.67964 2.17464C7.10148 2.17464 6.63279 2.64333 6.63279 3.22148V6.74754H5.36831V3.22148Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M5.00091 5.47314C3.33644 5.47314 1.9499 6.74914 1.81192 8.40788L1.54428 11.6254C1.38911 13.4909 2.86133 15.0906 4.73327 15.0906H13.6667C14.175 15.0906 14.5544 14.6228 14.4495 14.1255L13.0262 7.37781C12.792 6.26766 11.8125 5.47314 10.6779 5.47314H5.00091ZM10.6779 6.75314H5.00091C4.00223 6.75314 3.1703 7.51874 3.08751 8.51399L2.81988 11.7315C2.72677 12.8508 3.61011 13.8106 4.73327 13.8106H5.7695C5.26362 13.0554 5.05585 12.0527 5.31224 11.047C5.40861 10.6689 5.76242 10.4493 6.10249 10.5564C6.44256 10.6636 6.64012 11.0569 6.54374 11.4349C6.27517 12.4885 6.92898 13.6738 7.87916 13.8106H9.01412C8.50824 13.0554 8.30047 12.0527 8.55686 11.047C8.65324 10.6689 9.00704 10.4493 9.34711 10.5564C9.68719 10.6636 9.88474 11.0569 9.78837 11.4349C9.51979 12.4885 10.1736 13.6738 11.1238 13.8106H13.0749L11.7738 7.64199C11.6645 7.12392 11.2073 6.75314 10.6779 6.75314Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Kt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"clear-format-double-icon",ref:t,icon:Yr}))});Kt.displayName="ClearFormatDoubleIcon";const Xr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M5.59 1.51H10.46V14.46H5.59z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.34863 2.53325C1.34863 1.87051 1.88589 1.33325 2.54863 1.33325H13.482C14.1447 1.33325 14.682 1.87051 14.682 2.53325V13.4666C14.682 14.1294 14.1447 14.6666 13.482 14.6666H2.54863C1.88589 14.6666 1.34863 14.1294 1.34863 13.4666V2.53325ZM13.082 2.63325C13.2477 2.63325 13.382 2.76757 13.382 2.93325V5.09946C13.382 5.26515 13.2477 5.39946 13.082 5.39946H10.9708C10.8052 5.39946 10.6708 5.26515 10.6708 5.09946V2.93325C10.6708 2.76757 10.8052 2.63325 10.9708 2.63325H13.082ZM9.37085 2.93325C9.37085 2.76757 9.23653 2.63325 9.07085 2.63325H6.95974C6.79406 2.63325 6.65974 2.76757 6.65974 2.93325V5.09946C6.65974 5.26515 6.79406 5.39946 6.95974 5.39946L9.07085 5.39946C9.23654 5.39946 9.37085 5.26515 9.37085 5.09946V2.93325ZM5.35974 2.93325C5.35974 2.76757 5.22543 2.63325 5.05974 2.63325H2.94863C2.78295 2.63325 2.64863 2.76757 2.64863 2.93325V5.09946C2.64863 5.26515 2.78295 5.39946 2.94863 5.39946H5.05974C5.22543 5.39946 5.35974 5.26515 5.35974 5.09946V2.93325ZM2.94863 6.69946C2.78295 6.69946 2.64863 6.83378 2.64863 6.99946V9.11045C2.64863 9.27613 2.78295 9.41045 2.94863 9.41045H5.05974C5.22543 9.41045 5.35974 9.27613 5.35974 9.11045V6.99946C5.35974 6.83378 5.22543 6.69946 5.05974 6.69946H2.94863ZM2.94863 10.7104C2.78295 10.7104 2.64863 10.8448 2.64863 11.0104V13.0666C2.64863 13.2323 2.78295 13.3666 2.94863 13.3666H5.05974C5.22543 13.3666 5.35974 13.2323 5.35974 13.0666V11.0104C5.35974 10.8448 5.22543 10.7104 5.05974 10.7104H2.94863ZM6.65974 13.0666C6.65974 13.2323 6.79406 13.3666 6.95974 13.3666H9.07085C9.23653 13.3666 9.37085 13.2323 9.37085 13.0666V11.0104C9.37085 10.8448 9.23653 10.7104 9.07085 10.7104L6.95974 10.7104C6.79406 10.7104 6.65974 10.8448 6.65974 11.0104V13.0666ZM10.6708 13.0666C10.6708 13.2323 10.8052 13.3666 10.9708 13.3666H13.082C13.2477 13.3666 13.382 13.2323 13.382 13.0666V11.0104C13.382 10.8448 13.2477 10.7104 13.082 10.7104H10.9708C10.8052 10.7104 10.6708 10.8448 10.6708 11.0104V13.0666ZM13.082 9.41045C13.2477 9.41045 13.382 9.27613 13.382 9.11045V6.99946C13.382 6.83378 13.2477 6.69946 13.082 6.69946H10.9708C10.8052 6.69946 10.6708 6.83378 10.6708 6.99946V9.11045C10.6708 9.27613 10.8052 9.41045 10.9708 9.41045H13.082ZM6.95974 9.41045C6.79406 9.41045 6.65974 9.27613 6.65974 9.11045V6.99946C6.65974 6.83378 6.79406 6.69946 6.95974 6.69946L9.07085 6.69946C9.23653 6.69946 9.37085 6.83378 9.37085 6.99946V9.11045C9.37085 9.27613 9.23653 9.41045 9.07085 9.41045H6.95974Z",fillRule:"evenodd",clipRule:"evenodd"}}]},e9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"conditions-double-icon",ref:t,icon:Xr}))});e9.displayName="ConditionsDoubleIcon";const qr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M5.4004 2.60213C5.25792 2.60213 5.14241 2.71763 5.14241 2.86011V4.32679C5.14241 4.67752 4.85809 4.96184 4.50736 4.96184C4.15663 4.96184 3.87231 4.67752 3.87231 4.32679V2.86011C3.87231 2.01618 4.55646 1.33203 5.4004 1.33203H13.14C13.984 1.33203 14.6681 2.01618 14.6681 2.86011V10.5998C14.6681 11.4437 13.984 12.1278 13.14 12.1278H11.6568C11.3061 12.1278 11.0218 11.8435 11.0218 11.4928C11.0218 11.1421 11.3061 10.8577 11.6568 10.8577H13.14C13.2825 10.8577 13.398 10.7422 13.398 10.5998V2.86011C13.398 2.71763 13.2825 2.60213 13.14 2.60213H5.4004Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.33203 5.40015C1.33203 4.55622 2.01618 3.87207 2.86011 3.87207H10.5998C11.4437 3.87207 12.1278 4.55622 12.1278 5.40015V13.1398C12.1278 13.9837 11.4437 14.6679 10.5998 14.6679H2.86011C2.01618 14.6679 1.33203 13.9837 1.33203 13.1398V5.40015ZM2.86011 5.14217C2.71763 5.14217 2.60213 5.25767 2.60213 5.40015V13.1398C2.60213 13.2823 2.71763 13.3978 2.86011 13.3978H10.5998C10.7422 13.3978 10.8577 13.2823 10.8577 13.1398V5.40015C10.8577 5.25767 10.7422 5.14217 10.5998 5.14217H2.86011Z",fillRule:"evenodd",clipRule:"evenodd"}}]},t9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"copy-double-icon",ref:t,icon:qr}))});t9.displayName="CopyDoubleIcon";const Jr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.69148 5.44796C7.69148 5.07977 7.393 4.7813 7.02481 4.7813H3.25445C2.88626 4.7813 2.58779 5.07977 2.58779 5.44796V10.5516C2.58779 10.9198 2.88626 11.2183 3.25445 11.2183H7.02481C7.393 11.2183 7.69148 10.9198 7.69148 10.5516V5.44796ZM2.58779 3.50537C1.88311 3.50537 1.31186 4.07662 1.31186 4.7813V11.2183C1.31186 11.923 1.88311 12.4942 2.58779 12.4942H7.69148C8.39613 12.4942 8.96739 11.923 8.96739 11.2183V4.7813C8.96739 4.07662 8.39613 3.50537 7.69148 3.50537H2.58779Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M11.8919 10.4557C11.9671 10.4869 12.0496 10.5041 12.1361 10.5041C12.2226 10.5041 12.3051 10.4869 12.3803 10.4557C12.4555 10.4246 12.526 10.3784 12.5872 10.3172L14.5011 8.40335C14.7502 8.15421 14.7502 7.75028 14.5011 7.50114C14.2519 7.252 13.848 7.252 13.5989 7.50114L12.774 8.32595V6.13406C12.774 5.78172 12.4884 5.49609 12.1361 5.49609C11.7837 5.49609 11.4981 5.78172 11.4981 6.13406V8.32595L10.6733 7.50114C10.4241 7.252 10.0202 7.252 9.77106 7.50114C9.52192 7.75028 9.52192 8.15421 9.77106 8.40335L11.6847 10.3169M6.97288 9.84189C6.69858 10.1235 6.25386 10.1235 5.97956 9.84189L5.17866 9.01974L4.37769 9.84195C4.1034 10.1235 3.65867 10.1235 3.38437 9.84195C3.11008 9.56038 3.11008 9.10385 3.38437 8.82228L4.18534 8.00007L3.38439 7.17787C3.11009 6.8963 3.11009 6.43977 3.38439 6.1582C3.65869 5.87663 4.10341 5.87663 4.37771 6.1582L5.17866 6.9804L5.97954 6.15826C6.25384 5.87669 6.69857 5.87669 6.97287 6.15826C7.24716 6.43984 7.24716 6.89636 6.97286 7.17793L6.17198 8.00007L6.97288 8.82222C7.24718 9.10379 7.24718 9.56031 6.97288 9.84189Z",fillRule:"evenodd",clipRule:"evenodd"}}]},n9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"delete-cell-move-down-double-icon",ref:t,icon:Jr}))});n9.displayName="DeleteCellMoveDownDoubleIcon";const Qr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.29012 10.552C8.29012 10.9202 8.5886 11.2187 8.95679 11.2187L12.7271 11.2187C13.0953 11.2187 13.3938 10.9202 13.3938 10.552L13.3938 5.44836C13.3938 5.08016 13.0953 4.7817 12.7271 4.7817L8.95678 4.7817C8.5886 4.7817 8.29012 5.08016 8.29012 5.44836L8.29012 10.552ZM13.3938 12.4946C14.0985 12.4946 14.6697 11.9234 14.6697 11.2187L14.6697 4.7817C14.6697 4.07703 14.0985 3.50576 13.3938 3.50576L8.29012 3.50576C7.58547 3.50576 7.0142 4.07703 7.0142 4.7817L7.0142 11.2187C7.0142 11.9234 7.58547 12.4946 8.29012 12.4946L13.3938 12.4946Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M1.37899 7.7562C1.34779 7.83142 1.33053 7.9139 1.33053 8.0004C1.33053 8.0869 1.34779 8.16938 1.37899 8.2446C1.41013 8.31985 1.45626 8.39034 1.51739 8.45151L3.43133 10.3654C3.68046 10.6145 4.08439 10.6145 4.33353 10.3654C4.58266 10.1163 4.58266 9.71232 4.33353 9.46318L3.50873 8.63836L5.70059 8.63836C6.05293 8.63836 6.33855 8.35273 6.33855 8.0004C6.33855 7.64806 6.05293 7.36244 5.70059 7.36244L3.50873 7.36244L4.33353 6.53762C4.58266 6.28848 4.58266 5.88455 4.33353 5.63541C4.08439 5.38627 3.68046 5.38627 3.43133 5.63541L1.51773 7.54899M9.00896 6.15858C9.28326 5.87701 9.72798 5.87701 10.0023 6.15858L10.8032 6.98073L11.6042 6.15852C11.8784 5.87695 12.3232 5.87695 12.5975 6.15852C12.8718 6.44009 12.8718 6.89661 12.5975 7.17819L11.7965 8.00041L12.5975 8.8226C12.8718 9.10417 12.8718 9.56069 12.5975 9.84227C12.3232 10.1238 11.8784 10.1238 11.6041 9.84227L10.8032 9.02007L10.0023 9.84221C9.728 10.1238 9.28327 10.1238 9.00897 9.84221C8.73468 9.56063 8.73468 9.10411 9.00898 8.82254L9.80987 8.00041L9.00896 7.17825C8.73466 6.89668 8.73466 6.44016 9.00896 6.15858Z",fillRule:"evenodd",clipRule:"evenodd"}}]},r9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"delete-cell-shift-left-double-icon",ref:t,icon:Qr}))});r9.displayName="DeleteCellShiftLeftDoubleIcon";const Kr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.70985 5.44796C7.70985 5.07977 7.41137 4.7813 7.04318 4.7813H3.27282C2.90463 4.7813 2.60616 5.07977 2.60616 5.44796V10.5516C2.60616 10.9198 2.90463 11.2183 3.27282 11.2183H7.04318C7.41137 11.2183 7.70985 10.9198 7.70985 10.5516V5.44796ZM2.60616 3.50537C1.90148 3.50537 1.33023 4.07662 1.33023 4.7813V11.2183C1.33023 11.923 1.90148 12.4942 2.60616 12.4942H7.70985C8.4145 12.4942 8.98576 11.923 8.98576 11.2183V4.7813C8.98576 4.07662 8.4145 3.50537 7.70985 3.50537H2.60616Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M14.621 8.2438C14.6522 8.16858 14.6695 8.0861 14.6695 7.9996C14.6695 7.9131 14.6522 7.83062 14.621 7.7554C14.5899 7.68015 14.5438 7.60966 14.4826 7.54849L12.5687 5.63461C12.3196 5.38547 11.9156 5.38547 11.6665 5.63461C11.4174 5.88375 11.4174 6.28768 11.6665 6.53682L12.4913 7.36164H10.2994C9.94711 7.36164 9.66148 7.64727 9.66148 7.9996C9.66148 8.35194 9.94711 8.63756 10.2994 8.63756H12.4913L11.6665 9.46238C11.4174 9.71152 11.4174 10.1155 11.6665 10.3646C11.9156 10.6137 12.3196 10.6137 12.5687 10.3646L14.4823 8.45101M6.99107 9.84142C6.71677 10.123 6.27205 10.123 5.99775 9.84142L5.19685 9.01927L4.39588 9.84148C4.12159 10.1231 3.67686 10.1231 3.40256 9.84148C3.12826 9.55991 3.12826 9.10339 3.40256 8.82181L4.20353 7.99959L3.40258 7.1774C3.12828 6.89583 3.12828 6.43931 3.40258 6.15773C3.67688 5.87616 4.1216 5.87616 4.3959 6.15773L5.19685 6.97993L5.99773 6.15779C6.27203 5.87622 6.71676 5.87622 6.99106 6.15779C7.26535 6.43937 7.26535 6.89589 6.99105 7.17746L6.19017 7.99959L6.99107 8.82175C7.26537 9.10332 7.26537 9.55984 6.99107 9.84142Z",fillRule:"evenodd",clipRule:"evenodd"}}]},o9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"delete-cell-shift-right-double-icon",ref:t,icon:Kr}))});o9.displayName="DeleteCellShiftRightDoubleIcon";const e2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.69172 10.552C7.69172 10.9202 7.39324 11.2187 7.02506 11.2187H3.2547C2.8865 11.2187 2.58803 10.9202 2.58803 10.552V5.44836C2.58803 5.08016 2.8865 4.7817 3.2547 4.7817H7.02506C7.39324 4.7817 7.69172 5.08016 7.69172 5.44836V10.552ZM2.58803 12.4946C1.88335 12.4946 1.3121 11.9234 1.3121 11.2187V4.7817C1.3121 4.07703 1.88335 3.50576 2.58803 3.50576H7.69172C8.39637 3.50576 8.96764 4.07703 8.96764 4.7817V11.2187C8.96764 11.9234 8.39637 12.4946 7.69172 12.4946H2.58803Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M11.892 5.54431C11.9672 5.51312 12.0497 5.49591 12.1362 5.49591C12.2227 5.49591 12.3052 5.51312 12.3804 5.54431C12.4557 5.57545 12.5261 5.62159 12.5873 5.68276L14.5012 7.59665C14.7503 7.84579 14.7503 8.24972 14.5012 8.49886C14.2521 8.748 13.8481 8.748 13.599 8.49886L12.7741 7.67405V9.86594C12.7741 10.2183 12.4885 10.5039 12.1362 10.5039C11.7839 10.5039 11.4983 10.2183 11.4983 9.86594V7.67405L10.6734 8.49886C10.4243 8.748 10.0203 8.748 9.77121 8.49886C9.52207 8.24972 9.52207 7.84579 9.77121 7.59665L11.6848 5.68305M6.97304 6.15811C6.69874 5.87653 6.25401 5.87654 5.97972 6.15811L5.17881 6.98026L4.37784 6.15805C4.10355 5.87647 3.65882 5.87647 3.38453 6.15805C3.11023 6.43962 3.11023 6.89615 3.38453 7.17772L4.18549 7.99993L3.38454 8.82213C3.11024 9.1037 3.11024 9.56023 3.38454 9.8418C3.65884 10.1234 4.10356 10.1234 4.37786 9.8418L5.17881 9.0196L5.9797 9.84174C6.254 10.1233 6.69872 10.1233 6.97302 9.84174C7.24732 9.56016 7.24732 9.10364 6.97302 8.82207L6.17213 7.99993L6.97304 7.17778C7.24734 6.89621 7.24734 6.43969 6.97304 6.15811Z",fillRule:"evenodd",clipRule:"evenodd"}}]},i9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"delete-cell-shift-up-double-icon",ref:t,icon:e2}))});i9.displayName="DeleteCellShiftUpDoubleIcon";const t2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M11.9503 1.33317C12.6866 1.33317 13.2836 1.9301 13.2836 2.6665V13.3332C13.2836 14.0695 12.6866 14.6665 11.9503 14.6665H9.28359C8.54721 14.6665 7.95026 14.0696 7.95026 13.3332L7.95026 2.6665C7.95026 1.9301 8.54721 1.33317 9.28359 1.33317H11.9503ZM11.9503 2.6665V13.3332H9.28359V2.6665H11.9503Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M3.8542 6.29716C3.59385 6.03681 3.17174 6.03681 2.91139 6.29716C2.65104 6.55751 2.65104 6.97962 2.91139 7.23997L3.67157 8.00014L2.9114 8.76031C2.65105 9.02066 2.65105 9.44277 2.9114 9.70312C3.17175 9.96347 3.59387 9.96347 3.85421 9.70312L4.61437 8.94296L5.37459 9.70318C5.63494 9.96352 6.05705 9.96353 6.31741 9.70318C6.57775 9.44283 6.57775 9.02072 6.31741 8.76036L5.55718 8.00014L6.31742 7.23991C6.57777 6.97956 6.57777 6.55745 6.31742 6.2971C6.05707 6.03675 5.63496 6.03675 5.37461 6.2971L4.61437 7.05734L3.8542 6.29716Z",fillRule:"evenodd",clipRule:"evenodd"}}]},l9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"delete-column-double-icon",ref:t,icon:t2}))});l9.displayName="DeleteColumnDoubleIcon";const n2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M14.6666 11.9502C14.6666 12.6866 14.0697 13.2835 13.3333 13.2835H2.66665C1.93027 13.2835 1.33331 12.6866 1.33331 11.9502V9.28353C1.33331 8.54715 1.93027 7.9502 2.66665 7.9502L13.3333 7.9502C14.0697 7.9502 14.6666 8.54715 14.6666 9.28353V11.9502ZM13.3333 11.9502H2.66665V9.28353H13.3333V11.9502Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M9.60134 3.85438C9.86169 3.59403 9.86169 3.17192 9.60134 2.91157C9.34099 2.65122 8.91888 2.65122 8.65853 2.91157L7.89835 3.67175L7.13819 2.91159C6.87784 2.65124 6.45573 2.65124 6.19538 2.91159C5.93503 3.17194 5.93503 3.59405 6.19538 3.8544L6.95554 4.61456L6.19532 5.37478C5.93497 5.63513 5.93497 6.05724 6.19532 6.31759C6.45567 6.57794 6.87778 6.57794 7.13813 6.31759L7.89835 5.55737L8.65859 6.3176C8.91893 6.57796 9.34105 6.57796 9.60139 6.3176C9.86175 6.05726 9.86175 5.63514 9.60139 5.3748L8.84116 4.61456L9.60134 3.85438Z",fillRule:"evenodd",clipRule:"evenodd"}}]},s9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"delete-row-double-icon",ref:t,icon:n2}))});s9.displayName="DeleteRowDoubleIcon";const r2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M3.99992 1.33301H2.66659C1.93021 1.33301 1.33325 1.92996 1.33325 2.66634V3.99967H2.66659V2.66634L3.99992 2.66634V1.33301Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M1.33325 9.33301H2.66659V6.66634H1.33325V9.33301Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M6.66659 1.33301V2.66634H7.33325V5.33301H8.66659V2.66634H9.33325V1.33301H6.66659Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M11.9999 1.33301V2.66634H13.3333V3.99967H14.6666V2.66634C14.6666 1.92996 14.0696 1.33301 13.3333 1.33301H11.9999Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M14.6666 6.66634H13.3333V7.33301H10.6666V8.66634H13.3333V9.33301H14.6666V6.66634Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M7.33325 13.333V10.6663H8.66659V13.333H7.33325Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M5.33325 7.33301H2.66659V8.66634H5.33325V7.33301Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.33325 13.3333V12H2.66659L2.66659 13.3333H13.3333V12H14.6666V13.3333C14.6666 14.0697 14.0696 14.6667 13.3333 14.6667H2.66659C1.93021 14.6667 1.33325 14.0697 1.33325 13.3333Z"}}]},a9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"down-border-double-icon",ref:t,icon:r2}))});a9.displayName="DownBorderDoubleIcon";const o2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M1.98682 13.4992C1.98682 12.5603 2.74793 11.7992 3.68682 11.7992H14.2868C15.2257 11.7992 15.9868 12.5603 15.9868 13.4992V13.4992C15.9868 14.4381 15.2257 15.1992 14.2868 15.1992H3.68682C2.74793 15.1992 1.98682 14.4381 1.98682 13.4992V13.4992Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.3014 1.70389C9.85268 0.479568 8.12109 0.479557 7.67238 1.70389L4.72235 9.75326C4.60832 10.0644 4.76811 10.4091 5.07924 10.5231C5.39038 10.6371 5.73504 10.4773 5.84907 10.1662L6.99975 7.02646C7.03588 7.03324 7.07314 7.03679 7.11123 7.03679H10.9778L12.1247 10.1662C12.2387 10.4773 12.5834 10.6371 12.8945 10.5231C13.2057 10.4091 13.3654 10.0644 13.2514 9.75326L10.3014 1.70389ZM10.538 5.83679L9.17467 2.11682C9.11057 1.94192 8.8632 1.94192 8.7991 2.11682L7.43576 5.83679H10.538Z",fillRule:"evenodd",clipRule:"evenodd"}}]},c9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"font-color-double-icon",ref:t,icon:o2}))});c9.displayName="FontColorDoubleIcon";const i2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.01519 4.9156C7.65059 4.9156 7.29055 4.96431 6.93757 5.05194C6.6062 5.1342 6.2709 4.93226 6.18864 4.60089C6.10638 4.26953 6.30831 3.93422 6.63968 3.85196C7.0796 3.74275 7.53991 3.6792 8.01519 3.6792C9.93752 3.6792 11.6225 4.71575 12.781 5.67605C13.3691 6.16346 13.8434 6.64946 14.171 7.01358C14.3351 7.19604 14.4633 7.34895 14.5515 7.45755C14.5956 7.51187 14.6298 7.5552 14.6535 7.58568C14.6653 7.60092 14.6745 7.61296 14.6811 7.62157L14.6889 7.63188L14.6913 7.63506L14.6921 7.63614C14.6921 7.63614 14.6927 7.63689 14.1972 8.0066C14.6927 8.37631 14.6925 8.37646 14.6925 8.37646L14.6921 8.37705L14.6913 8.37814L14.6889 8.38131L14.6811 8.39163C14.6745 8.40023 14.6653 8.41227 14.6535 8.42752C14.6298 8.458 14.5956 8.50132 14.5515 8.55565C14.4633 8.66425 14.3351 8.81715 14.171 8.99961C13.8434 9.36373 13.3691 9.84973 12.781 10.3371C12.5182 10.555 12.1284 10.5186 11.9106 10.2557C11.6927 9.99285 11.7291 9.60313 11.992 9.38524C12.5227 8.94536 12.9537 8.50406 13.2518 8.1727C13.3051 8.11347 13.354 8.05788 13.3984 8.0066C13.354 7.95531 13.3051 7.89972 13.2518 7.84049C12.9537 7.50913 12.5227 7.06783 11.992 6.62795C10.9131 5.73365 9.50709 4.9156 8.01519 4.9156ZM14.1972 8.0066L14.6925 8.37646C14.8562 8.15715 14.8563 7.8562 14.6927 7.63689L14.1972 8.0066ZM4.11981 5.75748C4.3377 6.02035 4.30123 6.41007 4.03837 6.62795C3.50769 7.06783 3.07669 7.50913 2.7786 7.84049C2.72531 7.89972 2.67639 7.95531 2.63203 8.0066C2.67639 8.05788 2.72531 8.11347 2.7786 8.17271C3.07669 8.50406 3.50769 8.94536 4.03837 9.38524C5.11729 10.2795 6.5233 11.0976 8.01519 11.0976C8.38283 11.0976 8.74582 11.0481 9.10157 10.9591C9.43279 10.8762 9.76846 11.0776 9.85131 11.4088C9.93417 11.74 9.73283 12.0757 9.40162 12.1585C8.95841 12.2694 8.49443 12.334 8.01519 12.334C6.09287 12.334 4.40788 11.2974 3.24935 10.3371C2.66132 9.84973 2.18698 9.36373 1.85941 8.99961C1.69527 8.81715 1.56704 8.66425 1.47887 8.55565C1.43476 8.50132 1.4006 8.458 1.37692 8.42752C1.36508 8.41227 1.35585 8.40023 1.3493 8.39162L1.34149 8.38131L1.3391 8.37813L1.33829 8.37705C1.33829 8.37705 1.33773 8.37631 1.8332 8.0066C1.33773 7.63689 1.33785 7.63673 1.33785 7.63673L1.3391 7.63506L1.34149 7.63188L1.3493 7.62157C1.35585 7.61296 1.36508 7.60092 1.37692 7.58568C1.4006 7.5552 1.43476 7.51187 1.47887 7.45755C1.56704 7.34895 1.69527 7.19604 1.85941 7.01358C2.18698 6.64946 2.66132 6.16346 3.24935 5.67605C3.51221 5.45816 3.90193 5.49462 4.11981 5.75748ZM1.8332 8.0066L1.33785 7.63673C1.1742 7.85604 1.17464 8.15774 1.33829 8.37705L1.8332 8.0066Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M3.8775 2.99454C3.63608 2.75312 3.24466 2.75312 3.00323 2.99454C2.76181 3.23596 2.76181 3.62739 3.00323 3.86881L6.11167 6.97725C5.94588 7.28339 5.85153 7.63423 5.85153 8.00647C5.85153 9.20144 6.82025 10.1702 8.01523 10.1702C8.38756 10.1702 8.73834 10.0758 9.04444 9.91001L12.1095 12.9751C12.3509 13.2165 12.7424 13.2165 12.9838 12.9751C13.2252 12.7337 13.2252 12.3422 12.9838 12.1008L3.8775 2.99454ZM8.0668 8.93237L7.08932 7.9549C7.0884 7.97197 7.08793 7.98916 7.08793 8.00647C7.08793 8.5186 7.5031 8.93377 8.01523 8.93377C8.03254 8.93377 8.04973 8.9333 8.0668 8.93237Z",fillRule:"evenodd",clipRule:"evenodd"}}]},u9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"hide-double-icon",ref:t,icon:i2}))});u9.displayName="HideDoubleIcon";const l2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M1.33325 13.333V11.9997H2.66659L2.66659 13.333H3.99992V14.6663H2.66659C1.93021 14.6663 1.33325 14.0694 1.33325 13.333Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M2.66659 1.33301H3.99992V2.66634L2.66659 2.66634V3.99967H1.33325V2.66634C1.33325 1.92996 1.93021 1.33301 2.66659 1.33301Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M2.66659 9.33301H1.33325V6.66634H2.66659V9.33301Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M6.66659 2.66634V1.33301H9.33325V2.66634H8.66496V3.9855H7.33496V2.66634H6.66659Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M11.9999 2.66634V1.33301H13.3333C14.0696 1.33301 14.6666 1.92996 14.6666 2.66634V3.99967H13.3333V2.66634H11.9999Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M13.3333 6.66634H14.6666V9.33301H13.3333V6.66634Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M13.3333 11.9997H14.6666V13.333C14.6666 14.0694 14.0696 14.6663 13.3333 14.6663H11.9999V13.333H13.3333V11.9997Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M9.33325 13.333V14.6663H6.66659V13.333H7.33496V12.0138H8.66496V13.333H9.33325Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M7.33496 6.66159L7.33496 9.33768H8.66496V6.66159H7.33496Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M8.66687 7.33423H7.33354L2.66687 7.33431V8.66764H7.33354L8.66687 8.66756L13.3335 8.66764V7.33431L8.66687 7.33423Z"}}]},d9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"horizontal-border-double-icon",ref:t,icon:l2}))});d9.displayName="HorizontalBorderDoubleIcon";const s2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M1.33325 11.9997V13.333C1.33325 14.0694 1.93021 14.6663 2.66659 14.6663H3.99992V13.333H2.66659L2.66659 11.9997H1.33325ZM3.99992 1.33301H2.66659C1.93021 1.33301 1.33325 1.92996 1.33325 2.66634V3.99967H2.66659V2.66634L3.99992 2.66634V1.33301ZM1.33325 9.33301H2.66659V6.66634H1.33325V9.33301ZM6.66659 1.33301V2.66634H9.33325V1.33301H6.66659ZM11.9999 1.33301V2.66634H13.3333V3.99967H14.6666V2.66634C14.6666 1.92996 14.0696 1.33301 13.3333 1.33301H11.9999ZM14.6666 6.66634H13.3333V9.33301H14.6666V6.66634ZM14.6666 11.9997H13.3333V13.333H11.9999V14.6663H13.3333C14.0696 14.6663 14.6666 14.0694 14.6666 13.333V11.9997ZM9.33325 14.6663V13.333H6.66659V14.6663H9.33325Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M8.66693 7.33415V2.66748H7.3336V7.33415H2.66693V8.66748H7.3336V13.3341H8.66693V8.66748H13.3336V7.33415H8.66693Z"}}]},f9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"inner-border-double-icon",ref:t,icon:s2}))});f9.displayName="InnerBorderDoubleIcon";const a2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.66105 5.44796C7.66105 5.07977 7.36257 4.7813 6.99439 4.7813H3.22403C2.85583 4.7813 2.55736 5.07977 2.55736 5.44796V10.5516C2.55736 10.9198 2.85583 11.2183 3.22403 11.2183H6.99439C7.36257 11.2183 7.66105 10.9198 7.66105 10.5516V5.44796ZM2.55736 3.50537C1.85268 3.50537 1.28143 4.07662 1.28143 4.7813V11.2183C1.28143 11.923 1.85268 12.4942 2.55736 12.4942H7.66105C8.3657 12.4942 8.93697 11.923 8.93697 11.2183V4.7813C8.93697 4.07662 8.3657 3.50537 7.66105 3.50537H2.55736Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M11.9225 10.465C11.9977 10.4962 12.0802 10.5134 12.1667 10.5134C12.2532 10.5134 12.3357 10.4962 12.4109 10.465C12.4862 10.4338 12.5567 10.3877 12.6178 10.3265L14.5317 8.41263C14.7808 8.16349 14.7808 7.75956 14.5317 7.51042C14.2826 7.26128 13.8786 7.26128 13.6295 7.51042L12.8047 8.33523V6.14333C12.8047 5.791 12.5191 5.50537 12.1667 5.50537C11.8144 5.50537 11.5288 5.791 11.5288 6.14333V8.33523L10.7039 7.51042C10.4548 7.26128 10.0509 7.26128 9.80172 7.51042C9.55258 7.75956 9.55258 8.16349 9.80172 8.41263L11.7153 10.3262",fillRule:"evenodd",clipRule:"evenodd"}}]},C9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"insert-cell-down-double-icon",ref:t,icon:a2}))});C9.displayName="InsertCellDownDoubleIcon";const c2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.56614 5.44796C7.56614 5.07977 7.26766 4.7813 6.89948 4.7813H3.12912C2.76092 4.7813 2.46245 5.07977 2.46245 5.44796V10.5516C2.46245 10.9198 2.76092 11.2183 3.12912 11.2183H6.89948C7.26766 11.2183 7.56614 10.9198 7.56614 10.5516V5.44796ZM2.46245 3.50537C1.75777 3.50537 1.18652 4.07662 1.18652 4.7813V11.2183C1.18652 11.923 1.75777 12.4942 2.46245 12.4942H7.56614C8.27079 12.4942 8.84206 11.923 8.84206 11.2183V4.7813C8.84206 4.07662 8.27079 3.50537 7.56614 3.50537H2.46245Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M14.7651 8.2438C14.7963 8.16858 14.8135 8.0861 14.8135 7.9996C14.8135 7.9131 14.7963 7.83062 14.7651 7.7554C14.7339 7.68015 14.6878 7.60966 14.6266 7.54849L12.7127 5.63461C12.4636 5.38547 12.0597 5.38547 11.8105 5.63461C11.5614 5.88375 11.5614 6.28768 11.8105 6.53682L12.6353 7.36164H10.4434C10.0911 7.36164 9.80548 7.64727 9.80548 7.9996C9.80548 8.35194 10.0911 8.63756 10.4434 8.63756H12.6353L11.8105 9.46238C11.5614 9.71152 11.5614 10.1155 11.8105 10.3646C12.0597 10.6137 12.4636 10.6137 12.7127 10.3646L14.6263 8.45101",fillRule:"evenodd",clipRule:"evenodd"}}]},h9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"insert-cell-shift-right-double-icon",ref:t,icon:c2}))});h9.displayName="InsertCellShiftRightDoubleIcon";const u2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.53337 14C2.35658 14 2.18704 13.9297 2.06203 13.8047C1.93703 13.6797 1.86681 13.5101 1.86681 13.3333C1.86681 13.1565 1.93703 12.987 2.06203 12.862C2.18704 12.7369 2.35658 12.6667 2.53337 12.6667L13.4667 12.6667C13.6435 12.6667 13.813 12.7369 13.938 12.862C14.063 12.987 14.1333 13.1565 14.1333 13.3333C14.1333 13.5101 14.063 13.6797 13.938 13.8047C13.813 13.9297 13.6435 14 13.4667 14L2.53337 14ZM2.53337 3.33333C2.35658 3.33331 2.18703 3.26306 2.06203 3.13804C1.93703 3.01301 1.86681 2.84346 1.86681 2.66667C1.86681 2.48987 1.93703 2.32032 2.06203 2.1953C2.18703 2.07028 2.35658 2.00003 2.53337 2L13.4667 2C13.6435 2.00003 13.813 2.07028 13.938 2.1953C14.063 2.32032 14.1333 2.48987 14.1333 2.66667C14.1333 2.84346 14.063 3.01301 13.938 3.13803C13.813 3.26306 13.6435 3.33331 13.4667 3.33333L2.53337 3.33333Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M11.0573 7.33327L10.1953 6.47127C10.0703 6.34627 10.0001 6.17672 10.0001 5.99994C10.0001 5.82315 10.0703 5.65361 10.1953 5.52861C10.3203 5.4036 10.4899 5.33337 10.6667 5.33337C10.8434 5.33337 11.013 5.4036 11.138 5.52861L13.138 7.5286C13.2 7.59046 13.2491 7.66393 13.2827 7.74481C13.3162 7.82569 13.3335 7.91238 13.3335 7.99994C13.3335 8.08749 13.3162 8.17419 13.2827 8.25507C13.2491 8.33594 13.2 8.40941 13.138 8.47127L11.138 10.4713C11.0761 10.5332 11.0026 10.5823 10.9217 10.6158C10.8409 10.6493 10.7542 10.6665 10.6667 10.6665C10.5791 10.6665 10.4925 10.6493 10.4116 10.6158C10.3307 10.5823 10.2572 10.5332 10.1953 10.4713C10.1334 10.4094 10.0843 10.3359 10.0508 10.255C10.0173 10.1742 10.0001 10.0875 10.0001 9.99994C10.0001 9.9124 10.0173 9.82573 10.0508 9.74486C10.0843 9.66398 10.1334 9.5905 10.1953 9.52861L11.0573 8.6666L3.33333 8.66661C3.15652 8.66661 2.98695 8.59637 2.86193 8.47134C2.7369 8.34632 2.66666 8.17675 2.66666 7.99994C2.66666 7.82313 2.7369 7.65356 2.86193 7.52853C2.98695 7.40351 3.15652 7.33327 3.33333 7.33327L11.0573 7.33327Z"}}]},v9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"insert-double-icon",ref:t,icon:u2}))});v9.displayName="InsertDoubleIcon";const d2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M13.3333 13.4087C14.0697 13.4087 14.6666 12.8117 14.6666 12.0754L14.6666 9.40869C14.6666 8.67231 14.0697 8.07536 13.3333 8.07536L2.66663 8.07536C1.93023 8.07536 1.33329 8.67231 1.33329 9.40869L1.33329 12.0754C1.33329 12.8117 1.93023 13.4087 2.66663 13.4087L13.3333 13.4087ZM2.66663 12.0754L13.3333 12.0754L13.3333 9.40869L2.66663 9.40869L2.66663 12.0754Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M7.74168 2.59137C8.10987 2.59137 8.40835 2.88984 8.40835 3.25804L8.40835 4.33309L9.48348 4.33309C9.85167 4.33309 10.1501 4.63156 10.1501 4.99976C10.1501 5.36794 9.85167 5.66642 9.48348 5.66642L8.40835 5.66642L8.40835 6.74154C8.40835 7.10973 8.10987 7.4082 7.74168 7.4082C7.37349 7.4082 7.07501 7.10973 7.07501 6.74154L7.07501 5.66642L5.99998 5.66642C5.63179 5.66642 5.33331 5.36794 5.33331 4.99976C5.33331 4.63156 5.63179 4.33309 5.99998 4.33309L7.07501 4.33309L7.07501 3.25804C7.07501 2.88984 7.37349 2.59137 7.74168 2.59137Z",fillRule:"evenodd",clipRule:"evenodd"}}]},g9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"insert-row-above-double-icon",ref:t,icon:d2}))});g9.displayName="InsertRowAboveDoubleIcon";const f2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.66671 2.59131C1.93033 2.59131 1.33337 3.18826 1.33337 3.92464L1.33337 6.59131C1.33337 7.32769 1.93033 7.92464 2.66671 7.92464L13.3334 7.92464C14.0698 7.92464 14.6667 7.32769 14.6667 6.59131L14.6667 3.92464C14.6667 3.18826 14.0698 2.59131 13.3334 2.59131L2.66671 2.59131ZM13.3334 3.92464L2.66671 3.92464L2.66671 6.59131L13.3334 6.59131L13.3334 3.92464Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M8.25838 13.4086C7.8902 13.4086 7.59172 13.1102 7.59172 12.742L7.59172 11.6669L6.51658 11.6669C6.14839 11.6669 5.84992 11.3684 5.84991 11.0002C5.84991 10.6321 6.14839 10.3336 6.51658 10.3336L7.59172 10.3336L7.59171 9.25846C7.59171 8.89027 7.89019 8.5918 8.25838 8.5918C8.62657 8.5918 8.92505 8.89027 8.92505 9.25846L8.92505 10.3336L10.0001 10.3336C10.3683 10.3336 10.6667 10.6321 10.6667 11.0002C10.6667 11.3684 10.3683 11.6669 10.0001 11.6669L8.92505 11.6669L8.92505 12.742C8.92505 13.1102 8.62658 13.4086 8.25838 13.4086Z",fillRule:"evenodd",clipRule:"evenodd"}}]},p9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"insert-row-below-double-icon",ref:t,icon:f2}))});p9.displayName="InsertRowBelowDoubleIcon";const C2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M14.6664 3.99967L14.6664 2.66634C14.6664 1.92996 14.0694 1.33301 13.333 1.33301L11.9997 1.33301L11.9997 2.66634L13.333 2.66634L13.333 3.99967L14.6664 3.99967Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M6.66638 1.33301L6.66638 2.66634L9.33305 2.66634L9.33305 1.33301L6.66638 1.33301Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M14.6664 6.66634L13.333 6.66634L13.333 7.33301L10.6664 7.33301L10.6664 8.66634L13.333 8.66634L13.333 9.33301L14.6664 9.33301L14.6664 6.66634Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M14.6664 11.9997L13.333 11.9997L13.333 13.333L11.9997 13.333L11.9997 14.6663L13.333 14.6663C14.0694 14.6663 14.6664 14.0694 14.6664 13.333L14.6664 11.9997Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M9.33305 14.6663L9.33305 13.333L8.66638 13.333L8.66638 10.6663L7.33305 10.6663L7.33305 13.333L6.66638 13.333L6.66638 14.6663L9.33305 14.6663Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M2.66638 7.33301L5.33305 7.33301L5.33305 8.66634L2.66638 8.66634L2.66638 7.33301Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M8.66638 5.33301L8.66638 2.66634L7.33305 2.66634L7.33305 5.33301L8.66638 5.33301Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.66667 1.33301L4 1.33301L4 2.66634L2.66667 2.66634L2.66667 13.333L4 13.333L4 14.6663L2.66667 14.6663C1.93029 14.6663 1.33333 14.0694 1.33333 13.333L1.33333 2.66634C1.33333 1.92996 1.93029 1.33301 2.66667 1.33301Z"}}]},m9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"left-border-double-icon",ref:t,icon:C2}))});m9.displayName="LeftBorderDoubleIcon";const h2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.2987 2.39556L14.424 7.49259L13.9241 8.58354L4.06409 4.06617L8.58147 13.9262L7.49051 14.426L2.39348 3.30078L2.08524 3.15956L2.20701 2.89377L2.06653 2.58713L2.42214 2.42421L2.58506 2.0686L2.89169 2.20909L3.15748 2.08732L3.2987 2.39556Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M1.34351 12.0924L1.34351 13.4565C1.34351 14.1193 1.88077 14.6565 2.54351 14.6565L3.90764 14.6565L3.90764 13.3265L2.67351 13.3265L2.67351 12.0924L1.34351 12.0924ZM3.90763 1.34351L2.54351 1.34351C1.88076 1.34351 1.34351 1.88076 1.34351 2.54351L1.34351 3.90764L2.67351 3.90764L2.67351 2.67351L3.90763 2.67351L3.90763 1.34351ZM1.34351 9.36415L2.67351 9.36415L2.67351 6.63589L1.34351 6.63589L1.34351 9.36415ZM6.63589 1.34351L6.63589 2.67351L9.36415 2.67351L9.36415 1.34351L6.63589 1.34351ZM12.0924 1.34351L12.0924 2.67351L13.3265 2.67351L13.3265 3.90763L14.6565 3.90763L14.6565 2.54351C14.6565 1.88076 14.1193 1.34351 13.4565 1.34351L12.0924 1.34351ZM14.6565 6.63589L13.3265 6.63589L13.3265 9.36415L14.6565 9.36415L14.6565 6.63589ZM14.6565 12.0924L13.3265 12.0924L13.3265 13.3265L12.0924 13.3265L12.0924 14.6565L13.4565 14.6565C14.1193 14.6565 14.6565 14.1193 14.6565 13.4565L14.6565 12.0924ZM9.36415 14.6565L9.36415 13.3265L6.63589 13.3265L6.63589 14.6565L9.36415 14.6565Z",fillRule:"evenodd",clipRule:"evenodd"}}]},b9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"left-double-diagonal-double-icon",ref:t,icon:h2}))});b9.displayName="LeftDoubleDiagonalDoubleIcon";const v2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M13.4322 2.66683C13.4322 1.93045 12.8352 1.3335 12.0989 1.3335H9.43219C8.69581 1.3335 8.09886 1.93045 8.09886 2.66683V13.3335C8.09886 14.0699 8.69581 14.6668 9.43219 14.6668H12.0989C12.8352 14.6668 13.4322 14.0699 13.4322 13.3335V2.66683ZM12.0989 13.3335V2.66683H9.43219V13.3335H12.0989Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M2.56769 7.99978C2.56769 7.63159 2.86616 7.33311 3.23435 7.33311H4.30941V6.25798C4.30941 5.88979 4.60788 5.59131 4.97607 5.59131C5.34426 5.59131 5.64274 5.88979 5.64274 6.25798V7.33311H6.71785C7.08604 7.33311 7.38452 7.63159 7.38452 7.99978C7.38452 8.36797 7.08604 8.66644 6.71785 8.66644H5.64274V9.74148C5.64274 10.1097 5.34426 10.4081 4.97607 10.4081C4.60788 10.4081 4.30941 10.1097 4.30941 9.74148V8.66644H3.23435C2.86616 8.66644 2.56769 8.36797 2.56769 7.99978Z",fillRule:"evenodd",clipRule:"evenodd"}}]},L9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"left-insert-column-double-icon",ref:t,icon:v2}))});L9.displayName="LeftInsertColumnDoubleIcon";const g2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.33875 3.57255L2.23657 3.79614L2.72883 4.0211L7.58275 14.6428L8.67419 14.144L5.10931 6.34311L13.5649 14.7987L14.4134 13.9502L5.96172 5.49847L13.7573 9.0609L14.2561 7.96947L3.63438 3.11555L3.40942 2.62329L3.18782 2.72456L3.09973 2.63647L2.93861 2.7976L2.73534 2.70471L2.60444 2.99116L2.31799 3.12206L2.41088 3.32533L2.2512 3.485L2.33875 3.57255Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M1.6759 12.8102L1.6759 14.1743C1.6759 14.8371 2.21316 15.3743 2.8759 15.3743L4.24003 15.3743L4.24003 14.0443L3.0059 14.0443L3.0059 12.8102L1.6759 12.8102ZM4.24003 2.06128L2.8759 2.06128C2.21316 2.06128 1.6759 2.59854 1.6759 3.26128L1.6759 4.62541L3.0059 4.62541L3.0059 3.39128L4.24003 3.39128L4.24003 2.06128ZM1.6759 10.0819L3.0059 10.0819L3.0059 7.35367L1.6759 7.35367L1.6759 10.0819ZM6.96829 2.06128L6.96829 3.39128L9.69655 3.39128L9.69655 2.06128L6.96829 2.06128ZM12.4248 2.06128L12.4248 3.39128L13.6589 3.39128L13.6589 4.62541L14.9889 4.62541L14.9889 3.26128C14.9889 2.59854 14.4517 2.06128 13.7889 2.06128L12.4248 2.06128ZM14.9889 7.35367L13.6589 7.35367L13.6589 10.0819L14.9889 10.0819L14.9889 7.35367ZM14.9889 12.8102L13.6589 12.8102L13.6589 14.0443L12.4248 14.0443L12.4248 15.3743L13.7889 15.3743C14.4517 15.3743 14.9889 14.8371 14.9889 14.1743L14.9889 12.8102ZM9.69655 15.3743L9.69655 14.0443L6.96829 14.0443L6.96829 15.3743L9.69655 15.3743Z",fillRule:"evenodd",clipRule:"evenodd"}}]},w9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"left-tridiagonal-double-icon",ref:t,icon:g2}))});w9.displayName="LeftTridiagonalDoubleIcon";const p2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M12.665 2.66496H3.33496C2.96493 2.66496 2.66496 2.96493 2.66496 3.33496V12.665C2.66496 13.035 2.96493 13.335 3.33496 13.335H12.665C13.035 13.335 13.335 13.035 13.335 12.665V3.33496C13.335 2.96493 13.035 2.66496 12.665 2.66496ZM3.33496 1.33496C2.23039 1.33496 1.33496 2.23039 1.33496 3.33496V12.665C1.33496 13.7695 2.23039 14.665 3.33496 14.665H12.665C13.7695 14.665 14.665 13.7695 14.665 12.665V3.33496C14.665 2.23039 13.7695 1.33496 12.665 1.33496H3.33496Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M13.2559 14.1963L1.64941 2.58984L2.58987 1.64939L14.1963 13.2558L13.2559 14.1963Z",fillRule:"evenodd",clipRule:"evenodd"}}]},y9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"no-color-double-icon",ref:t,icon:p2}))});y9.displayName="NoColorDoubleIcon";const m2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M13.3333 2.66634H2.66659V13.333H13.3333V2.66634ZM2.66659 1.33301C1.93021 1.33301 1.33325 1.92996 1.33325 2.66634V13.333C1.33325 14.0694 1.93021 14.6663 2.66659 14.6663H13.3333C14.0696 14.6663 14.6666 14.0694 14.6666 13.333V2.66634C14.6666 1.92996 14.0696 1.33301 13.3333 1.33301H2.66659Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M7.33311 2.66748V5.33415H8.66644V2.66748H7.33311Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M7.33311 10.6675V13.3341H8.66644V10.6675H7.33311Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M13.3331 7.33415H10.6664V8.66748H13.3331V7.33415Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M5.33311 7.33415H2.66644V8.66748H5.33311V7.33415Z"}}]},I9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"outer-border-double-icon",ref:t,icon:m2}))});I9.displayName="OuterBorderDoubleIcon";const b2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.01281 1.36643C8.79386 0.585377 10.0602 0.585378 10.8412 1.36643L12.9223 3.44752C13.7034 4.22857 13.7034 5.4949 12.9223 6.27595L9.36445 9.83383C8.5834 10.6149 7.31707 10.6149 6.53602 9.83383L4.45493 7.75273C3.67388 6.97168 3.67388 5.70535 4.45493 4.9243L8.01281 1.36643ZM9.9927 2.21495C9.68028 1.90253 9.17375 1.90253 8.86133 2.21495L5.30346 5.77283L5.29671 5.77966L10.839 6.66224L12.0738 5.42742C12.3862 5.115 12.3862 4.60847 12.0738 4.29605L9.9927 2.21495Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M14.5179 9.48875C14.5179 9.99175 14.1101 10.3995 13.607 10.3995C13.1041 10.3995 12.6963 9.99175 12.6963 9.48875C12.6963 9.1773 13.0455 8.59966 13.3114 8.20487C13.4549 7.99177 13.7591 7.99177 13.9027 8.20486C14.1687 8.59965 14.5179 9.1773 14.5179 9.48875Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M1.98682 13.4992C1.98682 12.5603 2.74793 11.7992 3.68682 11.7992H14.2868C15.2257 11.7992 15.9868 12.5603 15.9868 13.4992V13.4992C15.9868 14.4381 15.2257 15.1992 14.2868 15.1992H3.68682C2.74793 15.1992 1.98682 14.4381 1.98682 13.4992V13.4992Z"}}]},M9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"paint-bucket-double-icon",ref:t,icon:b2}))});M9.displayName="PaintBucketDoubleIcon";const L2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M7.74692 9.12463C7.74692 9.46018 8.01893 9.73219 8.35448 9.73219H11.4933C11.8288 9.73219 12.1009 9.46018 12.1009 9.12463C12.1009 8.78909 11.8288 8.51707 11.4933 8.51707H8.35448C8.01893 8.51707 7.74692 8.78909 7.74692 9.12463Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M10.8636 10.8523C10.8636 11.1879 10.5915 11.4599 10.256 11.4599H8.35448C8.01893 11.4599 7.74692 11.1879 7.74692 10.8523C7.74692 10.5168 8.01893 10.2447 8.35448 10.2447H10.256C10.5915 10.2447 10.8636 10.5168 10.8636 10.8523Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M5.4791 1.98268C5.47913 1.71529 5.87912 1.49854 6.37252 1.49854C6.86593 1.49854 7.26592 1.71529 7.26595 1.98268H7.62187C8.22277 1.98268 8.72459 2.39534 8.84412 2.9452H9.39563C10.0856 2.9452 10.6449 3.48923 10.6449 4.16032V6.00569H12.1261C13.161 6.00569 14 6.82174 14 7.82838V11.334C14 11.8174 13.8025 12.281 13.4511 12.6228L12.0693 13.9647C11.7179 14.3065 11.2412 14.4985 10.7442 14.4985H7.91116C7.05024 14.4985 6.32492 14.0431 6.10535 13.2737H3.34925C2.6593 13.2737 2.09998 12.7297 2.09998 12.0586V4.16032C2.09998 3.48923 2.6593 2.9452 3.34925 2.9452H3.90107C4.0206 2.39534 4.52241 1.98268 5.12332 1.98268H5.4791ZM3.97249 4.16032H3.24925L3.24925 12.0586H6.03725V7.82838C6.03725 6.82174 6.87623 6.00569 7.91116 6.00569H9.49563V4.16032H8.7727C8.58289 4.59611 8.13909 4.90183 7.62187 4.90183H5.12332C4.6061 4.90183 4.1623 4.59611 3.97249 4.16032ZM5.12332 2.89403H7.62187C7.79436 2.89403 7.93419 3.03003 7.93419 3.19781V3.68671C7.93419 3.85448 7.79436 3.99049 7.62187 3.99049H5.12332C4.95083 3.99049 4.811 3.85448 4.811 3.68671V3.19781C4.811 3.03003 4.95083 2.89403 5.12332 2.89403ZM7.91116 7.11157C7.56618 7.11157 7.28652 7.38359 7.28652 7.71913V12.7851C7.28652 13.1206 7.56618 13.3927 7.91116 13.3927H10.7442C10.8401 13.3927 10.9337 13.3712 11.0182 13.3311C11.1373 13.2746 11.1859 13.1423 11.1859 13.0134V12.0066C11.1859 11.8724 11.2978 11.7636 11.4358 11.7636H12.4709C12.6034 11.7636 12.7394 11.7163 12.7975 11.6004C12.8388 11.5182 12.8608 11.4272 12.8608 11.334V7.71913C12.8608 7.38359 12.5811 7.11157 12.2362 7.11157H7.91116Z",fillRule:"evenodd",clipRule:"evenodd"}}]},_9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"paste-special-double-icon",ref:t,icon:L2}))});_9.displayName="PasteSpecialDoubleIcon";const w2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.53331 14C2.35652 14 2.18697 13.9297 2.06197 13.8047C1.93697 13.6797 1.86675 13.5101 1.86675 13.3333C1.86675 13.1565 1.93697 12.987 2.06197 12.862C2.18697 12.7369 2.35652 12.6667 2.53331 12.6667L13.4666 12.6667C13.6434 12.6667 13.813 12.7369 13.938 12.862C14.063 12.987 14.1332 13.1565 14.1332 13.3333C14.1332 13.5101 14.063 13.6797 13.938 13.8047C13.813 13.9297 13.6434 14 13.4666 14L2.53331 14ZM2.53331 3.33333C2.35652 3.33331 2.18697 3.26306 2.06197 3.13804C1.93697 3.01301 1.86675 2.84346 1.86675 2.66667C1.86675 2.48987 1.93697 2.32032 2.06197 2.1953C2.18697 2.07028 2.35652 2.00003 2.53331 2L13.4666 2C13.6434 2.00003 13.813 2.07028 13.938 2.1953C14.063 2.32032 14.1332 2.48987 14.1332 2.66667C14.1332 2.84346 14.063 3.01301 13.938 3.13803C13.813 3.26306 13.6434 3.33331 13.4666 3.33333L2.53331 3.33333Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M10.8142 10.8141C10.5588 11.0695 10.1447 11.0695 9.88929 10.8141L7.97868 8.90354L6.14021 10.742C5.89652 10.9857 5.50142 10.9857 5.25774 10.742C5.01405 10.4983 5.01405 10.1032 5.25774 9.85955L7.09621 8.02107L5.18561 6.11047C4.93021 5.85507 4.93021 5.44098 5.18561 5.18557C5.44101 4.93017 5.8551 4.93017 6.11051 5.18557L8.02111 7.09618L9.85959 5.2577C10.1033 5.01401 10.4984 5.01401 10.7421 5.2577C10.9857 5.50139 10.9857 5.89648 10.7421 6.14017L8.90358 7.97865L10.8142 9.88925C11.0696 10.1447 11.0696 10.5587 10.8142 10.8141Z"}}]},S9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"reduce-double-icon",ref:t,icon:w2}))});S9.displayName="ReduceDoubleIcon";const y2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M1.33325 3.99992L1.33325 2.66659C1.33325 1.93021 1.93021 1.33325 2.66659 1.33325L3.99992 1.33325L3.99992 2.66659L2.66659 2.66659L2.66659 3.99992L1.33325 3.99992Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M9.33325 1.33325L9.33325 2.66658L6.66659 2.66659L6.66659 1.33325L9.33325 1.33325Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M1.33325 6.66659L2.66659 6.66659L2.66659 7.33325L5.33325 7.33325L5.33325 8.66659L2.66659 8.66659L2.66659 9.33325L1.33325 9.33325L1.33325 6.66659Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M1.33325 11.9999L2.66659 11.9999L2.66659 13.3333L3.99992 13.3333L3.99992 14.6666L2.66659 14.6666C1.93021 14.6666 1.33325 14.0696 1.33325 13.3333L1.33325 11.9999Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M6.66659 14.6666L6.66659 13.3333L7.33325 13.3333L7.33325 10.6666L8.66659 10.6666L8.66659 13.3333L9.33325 13.3333L9.33325 14.6666L6.66659 14.6666Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M13.3333 7.33325L10.6666 7.33325L10.6666 8.66659L13.3333 8.66658L13.3333 7.33325Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M7.33325 5.33325L7.33325 2.66659L8.66659 2.66659L8.66659 5.33325L7.33325 5.33325Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.3333 1.33325L12 1.33325L12 2.66659L13.3333 2.66659L13.3333 13.3333L12 13.3333L12 14.6666L13.3333 14.6666C14.0697 14.6666 14.6667 14.0696 14.6667 13.3333L14.6667 2.66659C14.6667 1.93021 14.0697 1.33325 13.3333 1.33325Z"}}]},H9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"right-border-double-icon",ref:t,icon:y2}))});H9.displayName="RightBorderDoubleIcon";const I2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M13.2368 2.87507L2.11162 7.97208L2.61144 9.06304L12.4714 4.54568L7.95409 14.4057L9.04505 14.9055L14.1421 3.78029L14.4503 3.63905L14.3286 3.37322L14.469 3.0666L14.1134 2.90369L13.9505 2.5481L13.6439 2.68857L13.3781 2.56678L13.2368 2.87507Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M4.44524 1.82495L3.08111 1.82495C2.41837 1.82495 1.88111 2.36221 1.88111 3.02495L1.88111 4.38908L3.21111 4.38908L3.21111 3.15495L4.44524 3.15495L4.44524 1.82495ZM15.1941 4.38908L15.1941 3.02495C15.1941 2.36221 14.6569 1.82495 13.9941 1.82495L12.63 1.82495L12.63 3.15495L13.8641 3.15495L13.8641 4.38908L15.1941 4.38908ZM7.17349 1.82495L7.17349 3.15495L9.90175 3.15495L9.90175 1.82495L7.17349 1.82495ZM15.1941 7.11734L13.8641 7.11734L13.8641 9.84559L15.1941 9.84559L15.1941 7.11734ZM15.1941 12.5739L13.8641 12.5739L13.8641 13.808L12.63 13.808L12.63 15.138L13.9941 15.138C14.6569 15.138 15.1941 14.6007 15.1941 13.938L15.1941 12.5739ZM9.90175 15.138L9.90175 13.808L7.17349 13.808L7.17349 15.138L9.90175 15.138ZM4.44524 15.138L4.44524 13.808L3.21111 13.808L3.21111 12.5739L1.88111 12.5739L1.88111 13.938C1.88111 14.6007 2.41837 15.138 3.08111 15.138L4.44524 15.138ZM1.88111 9.8456L3.21111 9.8456L3.21111 7.11734L1.88111 7.11734L1.88111 9.8456Z",fillRule:"evenodd",clipRule:"evenodd"}}]},E9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"right-double-diagonal-double-icon",ref:t,icon:I2}))});E9.displayName="RightDoubleDiagonalDoubleIcon";const M2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.56781 13.3332C2.56781 14.0695 3.16476 14.6665 3.90114 14.6665L6.56781 14.6665C7.30419 14.6665 7.90114 14.0695 7.90114 13.3332L7.90114 2.6665C7.90114 1.9301 7.30419 1.33317 6.56781 1.33317L3.90114 1.33317C3.16476 1.33317 2.56781 1.9301 2.56781 2.6665L2.56781 13.3332ZM3.90114 2.6665L3.90114 13.3332L6.56781 13.3332L6.56781 2.6665L3.90114 2.6665Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M13.4323 8.00022C13.4323 8.36841 13.1338 8.66689 12.7656 8.66689L11.6906 8.66689L11.6906 9.74202C11.6906 10.1102 11.3921 10.4087 11.0239 10.4087C10.6557 10.4087 10.3573 10.1102 10.3573 9.74202L10.3573 8.66689L9.28215 8.66689C8.91396 8.66689 8.61548 8.36841 8.61548 8.00022C8.61548 7.63203 8.91396 7.33356 9.28214 7.33356L10.3573 7.33356L10.3573 6.25852C10.3573 5.89033 10.6557 5.59186 11.0239 5.59186C11.3921 5.59186 11.6906 5.89033 11.6906 6.25852L11.6906 7.33356L12.7656 7.33356C13.1338 7.33356 13.4323 7.63203 13.4323 8.00022Z",fillRule:"evenodd",clipRule:"evenodd"}}]},D9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"right-insert-column-double-icon",ref:t,icon:M2}))});D9.displayName="RightInsertColumnDoubleIcon";const _2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.27177 13.714L13.5855 2.40025L14.434 3.24878L3.1203 14.5625L2.27177 13.714Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M4.2603 1.82495L2.89617 1.82495C2.23343 1.82495 1.69617 2.36221 1.69617 3.02495L1.69617 4.38908L3.02617 4.38908L3.02617 3.15495L4.2603 3.15495L4.2603 1.82495ZM15.0092 4.38908L15.0092 3.02495C15.0092 2.36221 14.4719 1.82495 13.8092 1.82495L12.4451 1.82495L12.4451 3.15495L13.6792 3.15495L13.6792 4.38908L15.0092 4.38908ZM6.98856 1.82495L6.98856 3.15495L9.71681 3.15495L9.71681 1.82495L6.98856 1.82495ZM15.0092 7.11734L13.6792 7.11734L13.6792 9.84559L15.0092 9.84559L15.0092 7.11734ZM15.0092 12.5739L13.6792 12.5739L13.6792 13.808L12.4451 13.808L12.4451 15.138L13.8092 15.138C14.4719 15.138 15.0092 14.6007 15.0092 13.938L15.0092 12.5739ZM9.71681 15.138L9.71681 13.808L6.98856 13.808L6.98856 15.138L9.71681 15.138ZM4.2603 15.138L4.2603 13.808L3.02617 13.808L3.02617 12.5739L1.69617 12.5739L1.69617 13.938C1.69617 14.6007 2.23343 15.138 2.89617 15.138L4.2603 15.138ZM1.69617 9.8456L3.02617 9.8456L3.02617 7.11734L1.69617 7.11734L1.69617 9.8456Z",fillRule:"evenodd",clipRule:"evenodd"}}]},O9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"slash-double-icon",ref:t,icon:_2}))});O9.displayName="SlashDoubleIcon";const S2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M4.0001 14.667H2.66677C1.93039 14.667 1.33344 14.07 1.33344 13.3337V12.0003H2.66677V13.3337L4.0001 13.3337V14.667Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M1.33344 6.66699H2.66677V9.33366H1.33344V6.66699Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M6.66677 14.667V13.3337H7.33344V10.667H8.66677V13.3337H9.33344V14.667H6.66677Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M12.0001 14.667V13.3337H13.3334V12.0003H14.6668V13.3337C14.6668 14.07 14.0698 14.667 13.3334 14.667H12.0001Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M14.6668 9.33366H13.3334V8.66699H10.6668V7.33366H13.3334V6.66699H14.6668V9.33366Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M7.33344 2.66699V5.33366H8.66677V2.66699H7.33344Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M5.33344 8.66699H2.66677V7.33366H5.33344V8.66699Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.33344 2.66789V4.00122H2.66677L2.66677 2.66789H13.3334V4.00122H14.6668V2.66789C14.6668 1.93151 14.0698 1.33455 13.3334 1.33455H2.66677C1.93039 1.33455 1.33344 1.93151 1.33344 2.66789Z"}}]},R9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"up-border-double-icon",ref:t,icon:S2}))});R9.displayName="UpBorderDoubleIcon";const H2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M2.66699 1.33325L4.00033 1.33325L4.00033 2.66658L2.66699 2.66659L2.66699 3.99992L1.33366 3.99992L1.33366 2.66659C1.33366 1.93021 1.93061 1.33325 2.66699 1.33325Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M14.667 2.66659L14.667 3.99992L13.3337 3.99992L13.3337 2.66659L12.0003 2.66659L12.0003 1.33325L13.3337 1.33325C14.07 1.33325 14.667 1.93021 14.667 2.66659Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M6.66699 2.66658L6.66699 1.33325L9.33366 1.33325L9.33366 2.66659L6.66699 2.66658Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M13.3337 6.66659L14.667 6.66659L14.667 9.33325L13.3337 9.33325L13.3337 8.66496L12.0145 8.66496L12.0145 7.33496L13.3337 7.33496L13.3337 6.66659Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M13.3337 11.9999L14.667 11.9999L14.667 13.3333C14.667 14.0696 14.07 14.6666 13.3337 14.6666L12.0003 14.6666L12.0003 13.3333L13.3337 13.3333L13.3337 11.9999Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M9.33366 13.3333L9.33366 14.6666L6.66699 14.6666L6.66699 13.3333L9.33366 13.3333Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M4.00032 13.3333L4.00032 14.6666L2.66699 14.6666C1.93061 14.6666 1.33366 14.0696 1.33366 13.3333L1.33366 11.9999L2.66699 11.9999L2.66699 13.3333L4.00032 13.3333Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M2.66699 9.33325L1.33366 9.33325L1.33366 6.66658L2.66699 6.66658L2.66699 7.33496L3.98624 7.33496L3.98624 8.66496L2.66699 8.66496L2.66699 9.33325Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M9.33841 7.33496L6.66232 7.33496L6.66232 8.66496L9.33841 8.66496L9.33841 7.33496Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M8.66577 8.66675L8.66577 7.33342L8.66569 2.66675L7.33236 2.66675L7.33236 7.33341L7.33244 8.66675L7.33236 13.3334L8.66569 13.3334L8.66577 8.66675Z"}}]},V9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"vertical-border-double-icon",ref:t,icon:H2}))});V9.displayName="VerticalBorderDoubleIcon";const le={AddDigitsIcon:D3,AddImageIcon:O3,AdditionAndSubtractionIcon:R3,AdjustHeightDoubleIcon:Yt,AdjustWidthDoubleIcon:Xt,AlignBottomIcon:V3,AlignTextBothIcon:N3,AlignTopIcon:T3,AllBorderIcon:x3,AmplifyIcon:$3,AutoHeightDoubleIcon:qt,AutoWidthDoubleIcon:Jt,AutowrapIcon:Z3,AvgIcon:A3,BackSlashDoubleIcon:Qt,BoldIcon:P3,BrushIcon:F3,CancelFreezeIcon:k3,CancelMergeIcon:B3,ClearFormatDoubleIcon:Kt,CntIcon:U3,CodeIcon:j3,ConditionsDoubleIcon:e9,CopyDoubleIcon:t9,CutIcon:z3,DeleteCellMoveDownDoubleIcon:n9,DeleteCellShiftLeftDoubleIcon:r9,DeleteCellShiftRightDoubleIcon:o9,DeleteCellShiftUpDoubleIcon:i9,DeleteColumnDoubleIcon:l9,DeleteRowDoubleIcon:s9,DirectExportIcon:G3,DollarIcon:Y3,DownBorderDoubleIcon:a9,DownloadImageIcon:X3,EuroIcon:q3,ExportIcon:J3,EyeOutlineIcon:K3,FolderIcon:et,FontColorDoubleIcon:c9,FontSizeIncreaseIcon:tt,FontSizeReduceIcon:nt,FreezeColumnIcon:rt,FreezeRowIcon:ot,FreezeToSelectedIcon:it,FunctionIcon:Re,GridIcon:lt,HeaderFooterIcon:st,HideDoubleIcon:u9,HorizontalBorderDoubleIcon:d9,HorizontallyIcon:ut,HorizontalMergeIcon:ct,InnerBorderDoubleIcon:f9,InsertCellDownDoubleIcon:C9,InsertCellShiftRightDoubleIcon:h9,InsertDoubleIcon:v9,InsertRowAboveDoubleIcon:g9,InsertRowBelowDoubleIcon:p9,ItalicIcon:ht,KeyboardIcon:vt,LeftBorderDoubleIcon:m9,LeftDoubleDiagonalDoubleIcon:b9,LeftInsertColumnDoubleIcon:L9,LeftJustifyingIcon:gt,LeftRotationFortyFiveDegreesIcon:pt,LeftRotationNinetyDegreesIcon:mt,LeftTridiagonalDoubleIcon:w9,MaxIcon:bt,MenuIcon:Lt,MergeAllIcon:wt,MinIcon:yt,MoreDownIcon:z1,NoBorderIcon:It,NoColorDoubleIcon:y9,NoRotationIcon:Mt,OrderIcon:_t,OuterBorderDoubleIcon:I9,OverflowIcon:St,PaintBucketDoubleIcon:M9,PasteSpecialDoubleIcon:_9,PercentIcon:Ht,PipingIcon:Et,RedoIcon:Dt,ReduceDigitsIcon:Ot,ReduceDoubleIcon:S9,ReduceIcon:Te,RightBorderDoubleIcon:H9,RightDoubleDiagonalDoubleIcon:E9,RightInsertColumnDoubleIcon:D9,RightJustifyingIcon:Rt,RightRotationFortyFiveDegreesIcon:Vt,RightRotationNinetyDegreesIcon:Nt,RmbIcon:Tt,RoubleIcon:xt,ShortcutIcon:$t,SlashDoubleIcon:O9,StrikethroughIcon:Zt,SubscriptIcon:At,SumIcon:Pt,SuperscriptIcon:Ft,TruncationIcon:kt,UnderlineIcon:Bt,UndoIcon:Ut,UnorderIcon:jt,UpBorderDoubleIcon:R9,VerticalBorderDoubleIcon:V9,VerticalCenterIcon:zt,VerticalIntegrationIcon:Wt,VerticalTextIcon:Gt};class v1 extends f.Disposable{constructor(){super();j(this,"_components",new Map);j(this,"_componentsReverse",new Map);j(this,"reactUtils",{createElement:s.createElement,useEffect:s.useEffect,useRef:s.useRef});j(this,"_handler",{react:t=>t});for(const t in le)this.register(t,le[t]);this.disposeWithMe(f.toDisposable(()=>{for(const t in le)this._components.delete(t),this._componentsReverse.delete(le[t])}))}register(t,r,o){const{framework:i="react"}=o||{};if(i==="vue3"&&!this._handler.vue3)throw new Error("[ComponentManager] Vue3 support is no longer built-in since v0.9.0, please install @univerjs/ui-adapter-vue3 plugin.");return this._components.has(t)&&console.warn(`Component ${t} already exists.`),this._components.set(t,{framework:i,component:r}),this._componentsReverse.set(r,t),f.toDisposable(()=>{this._components.delete(t),this._componentsReverse.delete(r)})}getKey(t){return this._componentsReverse.get(t)}setHandler(t,r){this._handler[t]=r}get(t){if(!t)return;const r=this._components.get(t);if(!r)return;const o=this._handler[r.framework];if(!o)throw new Error(`[ComponentManager] No handler found for framework: ${r.framework}`);return o(r.component,t)}delete(t){this._components.delete(t)}}class W1{constructor(){j(this,"_list",new Map)}setIndex(n,t){this._list.set(n,t)}getIndex(n){return this._list.get(n)}removeIndex(n){this._list.delete(n)}getMaxIndex(){let n=-9999999;return this._list.forEach(t=>{+t>n&&(n=+t)}),n}}C3=new WeakMap,h3=new WeakMap,M3(W1,C3,2147483647),M3(W1,h3,-2147483647);function E2(e,n,t,r){const o=e.get(f.IUniverInstanceService);return new B.Observable(i=>{const l=o.focused$.subscribe(p=>{if(p==null||t&&t!==p||r&&(Array.isArray(r)?r.includes(p):r===p))return i.next(!0);const b=o.getUnitType(p);i.next(b!==n)}),c=o.getFocusedUnit();if(c==null)return i.next(!0);const h=o.getUnitType(c.getUnitId());return i.next(h!==n),()=>l.unsubscribe()})}function D2(e){const n=e.get(f.IUniverInstanceService);return new B.Observable(t=>{const r=n.focused$.subscribe(l=>{if(l==null)return t.next(!0);const c=n.getUniverDocInstance(l),h=c==null?void 0:c.getSnapshot().documentStyle.documentFlavor;t.next(h!==f.DocumentFlavor.TRADITIONAL)}),o=n.getCurrentUniverDocInstance();if(o==null)return t.next(!0);const i=o==null?void 0:o.getSnapshot().documentStyle.documentFlavor;return t.next(i!==f.DocumentFlavor.TRADITIONAL),()=>r.unsubscribe()})}function N9(e,n){return!n||!e||(["type","icon","title","tooltip"].forEach(o=>{n[o]!==void 0&&(e[o]=n[o])}),["hidden","disabled","activated"].forEach(o=>{O2(e,`${o}$`,n[o])})),e}function O2(e,n,t){if(t!==void 0)if(e[n]){const r=e[n].pipe(B.switchMap(()=>new B.BehaviorSubject(t)));e[n]=r}else e[n]=new B.Observable(r=>{r.next(t)})}function R2(e){return typeof e=="function"?e():e}function T9(e,n){const t=s.useRef(n);return s.useEffect(()=>{if(e){const r=R2(e).subscribe(o=>{t.current=o});return()=>r.unsubscribe()}},[e]),t}const x9=e=>{const{value:n,selections:t}=e,r=V.useDependency(f.LocaleService),o=s.useMemo(()=>{var i,l;return n==null?"":r.t((l=(i=t.find(c=>c.value===n))==null?void 0:i.label)!=null?l:"")},[n,t]);return v.jsx("div",{className:"univer-truncate univer-text-sm",children:o})},$9="UI_PLUGIN_COMMON_LABEL_COMPONENT";function f1(e){const{className:n,title:t,icon:r,label:o,value:i,value$:l}=e,c=V.useDependency(f.LocaleService),h=V.useDependency(v1),[p,b]=s.useState(i),[d,w]=s.useState(""),I=[];let _=0;s.useEffect(()=>{if(l){const S=l.subscribe(A=>{b(A)});return()=>{S.unsubscribe()}}},[l]);const T=s.useMemo(()=>i!=null?i:p,[p,i]);s.useEffect(()=>{let S=null;return B.isObservable(r)?S=r.subscribe(A=>{w(A)}):w(r!=null?r:""),()=>{S==null||S.unsubscribe()}},[r]);const O=s.useMemo(()=>T&&typeof T=="string"?new f.ColorKit(T).isValid:!1,[T]);if(r){const S=h.get(d!=null?d:"");S&&I.push(v.jsx(S,{className:"univer-text-base",extend:{colorChannel1:O?T:"var(--univer-primary-600)"}},_++))}if(o){const S=typeof o=="string",A=S?{...e}:{...o==null?void 0:o.props,...e},R=S?o:o==null?void 0:o.name,k=h.get(R);k?I.push(v.jsx(k,{...A,className:n,value:T},_++)):I.push(v.jsx("span",{className:n,children:c.t(R)},_++))}return t&&I.push(v.jsx("span",{className:n,children:typeof t=="string"?c.t(t):t},_++)),v.jsx(v.Fragment,{children:I})}const Z9=e=>{var i,l;const{value:n,text:t}=e,r=f.NAMED_STYLE_MAP[n],o=V.useDependency(f.LocaleService);return v.jsx("span",{className:x.clsx("univer-text-sm",{"univer-font-bold":r==null?void 0:r.bl}),style:{fontSize:r==null?void 0:r.fs,color:(l=(i=r==null?void 0:r.cl)==null?void 0:i.rgb)!=null?l:void 0},children:o.t(t)})},A9="UI_COMPONENT_HEADING_ITEM";function R1(e){const n=s.useRef(e);return n.current=e,s.useCallback(((...t)=>{var r;return(r=n.current)==null?void 0:r.call(n,...t)}),[])}function P9(e,n){const t=R1(()=>{if(!e||!n)return;const r=e.style,o=e.getBoundingClientRect(),{y:i,height:l}=o,c=n.getBoundingClientRect(),h=e.scrollHeight>l,p=i<0||i+l>c.height;if(!p&&!h){r.overflowY="",r.maxHeight="";return}p&&(r.overflowY="auto",r.maxHeight=i<0?`${e.scrollHeight+i}px`:`${c.height-i}px`)});s.useEffect(()=>{if(!x.isBrowser()||!e||!n)return;t();const r=x.resizeObserverCtor(t);return r.observe(e),()=>{r.unobserve(e)}},[e,n])}function F9(e){const n=V.useDependency(f.IConfigService);return V.useObservable(s.useMemo(()=>n.subscribeConfigValue$(e),[n]),n.getConfig(e))}const se=116;function V2(e){V.useDependency(f.LocaleService);const{value:n,min:t=0,max:r=400,disabled:o=!1,resetPoint:i=100,shortcuts:l,onChange:c}=e,h=s.useRef(null),[p,b]=s.useState(!1);function d(){o||c&&c(i)}function w(S){if(o)return;let A=n+S;n+S<=t?A=t:n+S>=r&&(A=r),c&&c(A)}const I=s.useMemo(()=>{if(n<=i){const S=50/(i-t);return(n-t)*S}if(n<=r)return i*.5+(n-i)/(r-i)*50},[t,r,i,n]);function _(S){if(o)return;S.preventDefault();const A=h.current;let R=!0;function k(D){if(R){let W=D.clientX-A.getBoundingClientRect().x;W<=0?W=0:W>=se&&(W=se);const Y=W/se;let q=0;Y<=.5?q=t+Y*(i-t)*2:q=i+(Y-.5)*(r-i)*2,c&&c(Math.ceil(q))}}function M(){R=!1,document.removeEventListener("pointermove",k),window.removeEventListener("pointerup",M)}function $(D){D.relatedTarget===null&&M()}window.addEventListener("pointermove",k),window.addEventListener("pointerup",M),window.addEventListener("pointerout",$)}function T(S){o||(b(!1),c&&c(S))}const O=[{type:"radio",value:n.toString(),options:l.map(S=>({value:S.toString(),label:`${S}%`})),onSelect:S=>T(+S)}];return v.jsxs("div",{className:x.clsx("univer-flex univer-select-none univer-items-center univer-gap-1",{"univer-cursor-not-allowed":o}),children:[v.jsx(x.Button,{className:"univer-size-6 univer-p-0",size:"small",variant:"text",disabled:n<=t||o,onClick:()=>w(-10),children:v.jsx(Te,{})}),v.jsx("div",{className:"univer-relative univer-hidden univer-h-0.5 univer-rounded-2xl univer-bg-gray-400 univer-px-1.5 sm:!univer-block",style:{width:`${se}px`},children:v.jsxs("div",{ref:h,role:"track",className:"univer-relative univer-h-0.5",children:[v.jsx("a",{className:"univer-absolute univer-left-1/2 univer-top-1/2 univer-box-border univer-block univer-h-0.5 univer-w-0.5 -univer-translate-x-1/2 -univer-translate-y-1/2 univer-cursor-pointer univer-rounded-full univer-bg-white",role:"button",onClick:d},"reset-button"),v.jsx("button",{className:x.clsx("univer-absolute univer-top-[calc(50%-6px)] univer-size-3 -univer-translate-x-1/2 univer-rounded-full univer-border-none univer-bg-white univer-shadow univer-transition-colors",{"hover:univer-gray-200 univer-cursor-pointer":!o,"univer-cursor-not-allowed":o}),role:"handle",type:"button",style:{left:`${I}%`},onPointerDown:_})]})}),v.jsx(x.Button,{className:"univer-size-6 univer-p-0",size:"small",variant:"text",disabled:n>=r||o,onClick:()=>w(10),children:v.jsx(dt,{})}),v.jsx(x.DropdownMenu,{align:"end",items:O,open:p,onOpenChange:b,children:v.jsxs(x.Button,{size:"small",variant:"text",children:[n,"%"]})})]})}const k9="UI_COLOR_PICKER_COMPONENT",B9=e=>{const{value:n}=e,t=V.useDependency(f.LocaleService),r=s.useMemo(()=>{if(n==null)return"";let o=t.t(`fontFamily.${`${n!=null?n:""}`.replace(/\s/g,"")}`);return o.startsWith("fontFamily.")&&typeof n=="string"&&(o=n.split(",")[0]),o},[n]);return v.jsx("div",{className:"univer-w-32 univer-truncate univer-text-sm",style:{fontFamily:n},children:r})},V1="ui.config",ae={};var N2=Object.getOwnPropertyDescriptor,T2=(e,n,t,r)=>{for(var o=r>1?void 0:r?N2(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},x2=(e,n)=>(t,r)=>n(t,r,e);const xe=f.createIdentifier("univer.font-service"),U9=[{value:"Arial",label:"fontFamily.arial",category:"sans-serif"},{value:"Times New Roman",label:"fontFamily.times-new-roman",category:"serif"},{value:"Tahoma",label:"fontFamily.tahoma",category:"sans-serif"},{value:"Verdana",label:"fontFamily.verdana",category:"sans-serif"},{value:"Microsoft YaHei",label:"fontFamily.microsoft-yahei",category:"sans-serif"},{value:"SimSun",label:"fontFamily.simsun",category:"serif"},{value:"SimHei",label:"fontFamily.simhei",category:"sans-serif"},{value:"Kaiti",label:"fontFamily.kaiti",category:"serif"},{value:"FangSong",label:"fontFamily.fangsong",category:"serif"},{value:"NSimSun",label:"fontFamily.nsimsun",category:"serif"},{value:"STXinwei",label:"fontFamily.stxinwei",category:"serif"},{value:"STXingkai",label:"fontFamily.stxingkai",category:"serif"},{value:"STLiti",label:"fontFamily.stliti",category:"serif"}];let $e=class{constructor(e){j(this,"fonts$",new B.BehaviorSubject([...U9]));this._configService=e;const n=this._configService.getConfig(V1),{customFontFamily:t=[]}=n!=null?n:{};t.length&&t.forEach(r=>this.addFont({...r,isCustom:!0}))}dispose(){this.resetToDefaults(),this.fonts$.complete()}getFonts(){return this.fonts$.getValue()}getFontByValue(e){return this.getFonts().find(n=>n.value===e)}isFontSupported(e){const t=document.createElement("canvas").getContext("2d");if(!t)return!1;const r="abcdefghijklmnopqrstuvwxyz0123456789";t.font="12px monospace";const o=t.measureText(r).width;return t.font=`12px "${e}", monospace`,t.measureText(r).width!==o}addFont(e){if(this.getFontByValue(e.value))throw new Error(`[FontService]: Font with value "${e.value}" already exists.`);const t=[...this.getFonts(),e].sort();this.fonts$.next(t)}updateFont(e,n){const t=this.getFonts(),r=t.findIndex(l=>l.value===e);if(r===-1)throw new Error(`Font with value "${e}" not found.`);const o={...t[r],...n},i=[...t];i[r]=o,this.fonts$.next(i)}removeFont(e){const n=this.getFonts(),t=n.findIndex(i=>i.value===e);if(t===-1||!n[t].isCustom)return!1;const o=n.filter(i=>i.value!==e);return this.fonts$.next(o),!0}resetToDefaults(){this.fonts$.next([...U9])}};$e=T2([x2(0,f.IConfigService)],$e);const j9=({id:e,value:n})=>{const t=V.useDependency(f.ICommandService),r=V.useDependency(xe),[o,i]=s.useState([]);s.useEffect(()=>{const h=r.fonts$.subscribe(p=>{i(p)});return()=>{h.unsubscribe()}},[]);const l=V.useDependency(f.LocaleService);function c(h){t.executeCommand(e,{value:h})}return v.jsx("ul",{className:"univer-m-0 univer-list-none univer-p-0 univer-text-sm",style:{fontFamily:n},children:o.map(h=>v.jsx("li",{children:v.jsxs("button",{className:"univer-flex univer-h-7 univer-w-full univer-appearance-none univer-items-center univer-justify-between univer-gap-6 univer-rounded univer-border-none univer-bg-transparent univer-px-2 hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-700",style:{fontFamily:h.value},type:"button",onClick:()=>c(h.value),children:[l.t(h.label),!r.isFontSupported(h.value)&&v.jsx(x.Tooltip,{title:l.t("fontFamily.not-supported"),children:v.jsx(ft,{className:"univer-text-gray-300 dark:univer-text-gray-700"})})]})},h.value))})},z9="UI_FONT_FAMILY_COMPONENT",W9="UI_FONT_FAMILY_ITEM_COMPONENT",G9=e=>{const{value:n,min:t,max:r,onChange:o,disabled$:i}=e,l=V.useObservable(i),[c,h]=s.useState(Number(n!=null?n:0)),p=s.useMemo(()=>Number(n!=null?n:c),[n]);function b(w){w!==null&&h(w)}function d(w){w.stopPropagation(),w.code==="Enter"&&o(c.toString())}return v.jsx("div",{className:"univer-h-6 univer-w-7 univer-text-sm",children:v.jsx(x.InputNumber,{className:"univer-block univer-h-6 univer-border-none univer-bg-transparent univer-leading-6 [&_input:focus]:!univer-ring-0 [&_input]:univer-h-6 [&_input]:univer-w-7 [&_input]:univer-border-none [&_input]:!univer-bg-transparent [&_input]:univer-p-0 [&_input]:univer-text-sm",value:p,controls:!1,min:t,max:r,onKeyDown:d,onChange:b,disabled:l})})},$2=[{label:"9",value:9},{label:"10",value:10},{label:"11",value:11},{label:"12",value:12},{label:"14",value:14},{label:"16",value:16},{label:"18",value:18},{label:"20",value:20},{label:"22",value:22},{label:"24",value:24},{label:"26",value:26},{label:"28",value:28},{label:"36",value:36},{label:"48",value:48},{label:"72",value:72}],Z2=[{label:"toolbar.heading.normal",value:f.NamedStyleType.NORMAL_TEXT},{label:"toolbar.heading.title",value:f.NamedStyleType.TITLE},{label:"toolbar.heading.subTitle",value:f.NamedStyleType.SUBTITLE},{label:"toolbar.heading.1",value:f.NamedStyleType.HEADING_1},{label:"toolbar.heading.2",value:f.NamedStyleType.HEADING_2},{label:"toolbar.heading.3",value:f.NamedStyleType.HEADING_3},{label:"toolbar.heading.4",value:f.NamedStyleType.HEADING_4},{label:"toolbar.heading.5",value:f.NamedStyleType.HEADING_5}],Y9="UI_FONT_SIZE_COMPONENT",A2=(e,n)=>{const t=s.useRef(!1);s.useEffect(()=>{if(t.current)return e();t.current=!0},n)};function P2(e,n){const t=R1(n.handler);s.useEffect(()=>{const r=o=>{e.current&&o.target&&!e.current.contains(o.target)&&t()};return document.addEventListener("mousedown",r),()=>{document.removeEventListener("mousedown",r)}},[t,e])}function F2(e,n=300){const t=s.useRef(null);return s.useCallback((...r)=>{t.current&&clearTimeout(t.current),t.current=setTimeout(()=>{e(...r)},n)},[e,n])}const X9=e=>typeof e=="number";function k2(e){const n=s.useRef(e);return n.current=e,n}const B2=(e,n)=>{const{containerTarget:t,itemHeight:r,overscan:o=5}=n,i=k2(r),[l,c]=s.useState(null),h=s.useRef(!1),[p,b]=s.useState([]),[d,w]=s.useState({height:void 0,marginTop:void 0}),I=(R,k)=>{if(typeof i.current=="number")return Math.ceil(R/i.current);let M=0,$=0;for(let D=k;D<e.length;D++){const U=i.current(D,e[D]);if(M+=U,$=D,M>=R)break}return $-k},_=R=>{if(X9(i.current))return Math.floor(R/i.current);let k=0,M=0;for(let $=0;$<e.length;$++){const D=i.current($,e[$]);if(k+=D,k>=R){M=$;break}}return M+1},T=R=>typeof i.current=="number"?R*i.current:e.slice(0,R).reduce((M,$,D)=>M+i.current(D,e[D]),0),O=s.useMemo(()=>X9(i.current)?e.length*i.current:e.reduce((R,k,M)=>R+i.current(M,e[M]),0),[e]),S=()=>{const R=t.current;if(R){const{scrollTop:k,clientHeight:M}=R,$=_(k),D=I(M,$),U=Math.max(0,$-o),W=Math.min(e.length,$+D+o),Y=T(U);w({height:`${O-Y}px`,marginTop:`${Y}px`}),b(e.slice(U,W).map((q,G)=>({data:q,index:G+U})))}};return s.useEffect(()=>{if(t.current){const R=()=>{const M=t.current.clientWidth,$=t.current.clientHeight;(M!==(l==null?void 0:l.width)||$!==(l==null?void 0:l.height))&&c({width:M,height:$})};R();const k=new ResizeObserver(R);return k.observe(t.current),()=>{k.disconnect()}}},[]),s.useEffect(()=>{!(l!=null&&l.width)||!(l!=null&&l.height)||S()},[l==null?void 0:l.width,l==null?void 0:l.height,e]),[p,{wrapperStyle:d,scrollTo:R1(R=>{const k=t.current;k&&(h.current=!0,k.scrollTop=T(R),S())}),containerProps:{onScroll:R=>{if(h.current){h.current=!1;return}R.preventDefault(),S()}}}]};function U2(e,n,...t){return e.t(n)}var j2=Object.getOwnPropertyDescriptor,z2=(e,n,t,r)=>{for(var o=r>1?void 0:r?j2(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},q9=(e,n)=>(t,r)=>n(t,r,e);const W2="FOCUSING_UNIVER",G2=["app-layout","button","sheet-bar-append-button","render-canvas","workbench-layout"],M1=f.createIdentifier("ui.layout-service");C.DesktopLayoutService=class extends f.Disposable{constructor(t,r){super();j(this,"_rootContainerElement",null);j(this,"_isFocused",!1);j(this,"_focusHandlers",new Map);j(this,"_contentElements",[]);j(this,"_allContainers",[]);this._contextService=t,this._univerInstanceService=r,this._initUniverFocusListener(),this._initEditorStatus()}get isFocused(){return this._isFocused}get rootContainerElement(){return this._rootContainerElement}focus(){const t=this._univerInstanceService.getFocusedUnit();if(!t)return;let r;t instanceof f.Workbook?r=this._focusHandlers.get(f.UniverInstanceType.UNIVER_SHEET):t instanceof f.DocumentDataModel?r=this._focusHandlers.get(f.UniverInstanceType.UNIVER_DOC):t instanceof f.SlideDataModel&&(r=this._focusHandlers.get(f.UniverInstanceType.UNIVER_SLIDE)),r&&r(t.getUnitId())}registerFocusHandler(t,r){if(this._focusHandlers.has(t))throw new Error(`[DesktopLayoutService]: handler of type ${t} bas been registered!`);return this._focusHandlers.set(t,r),f.toDisposable(()=>this._focusHandlers.delete(t))}registerContentElement(t){if(this._contentElements.indexOf(t)===-1)return this._contentElements.push(t),f.toDisposable(()=>f.remove(this._contentElements,t));throw new Error("[DesktopLayoutService]: content container already registered!")}getContentElement(){return this._contentElements[0]}registerRootContainerElement(t){if(this._rootContainerElement)throw new Error("[DesktopLayoutService]: root container already registered!");this._rootContainerElement=t;const r=this.registerContainerElement(t);return f.toDisposable(()=>{this._rootContainerElement=null,r.dispose()})}registerContainerElement(t){if(this._allContainers.indexOf(t)===-1)return this._allContainers.push(t),f.toDisposable(()=>f.remove(this._allContainers,t));throw new Error("[LayoutService]: container already registered!")}checkElementInCurrentContainers(t){return this._allContainers.some(r=>r.contains(t))}checkContentIsFocused(){return this._contentElements.some(t=>t===document.activeElement||t.contains(document.activeElement))}_initUniverFocusListener(){this.disposeWithMe(B.fromEvent(window,"focusin").subscribe(t=>{var o;const r=t.target;if((o=this._rootContainerElement)!=null&&o.contains(r)&&G2.some(i=>r.dataset.uComp===i)){queueMicrotask(()=>this.focus());return}r&&this.checkElementInCurrentContainers(r)?this._isFocused=!0:this._isFocused=!1,this._contextService.setContextValue(W2,this._isFocused),this._contextService.setContextValue(f.FOCUSING_UNIVER_EDITOR,J9())}))}_initEditorStatus(){this._contextService.setContextValue(f.FOCUSING_UNIVER_EDITOR,J9())}},C.DesktopLayoutService=z2([q9(0,f.IContextService),q9(1,f.IUniverInstanceService)],C.DesktopLayoutService);function J9(){var e;return((e=document.activeElement)==null?void 0:e.dataset.uComp)==="editor"}var g1=(e=>(e[e.BUTTON=0]="BUTTON",e[e.SELECTOR=1]="SELECTOR",e[e.BUTTON_SELECTOR=2]="BUTTON_SELECTOR",e[e.SUBITEMS=3]="SUBITEMS",e))(g1||{}),G1=(e=>(e.RIBBON="ribbon",e.CONTEXT_MENU="contextMenu",e))(G1||{}),C1=(e=>(e.START="ribbon.start",e.INSERT="ribbon.insert",e.FORMULAS="ribbon.formulas",e.DATA="ribbon.data",e.VIEW="ribbon.view",e.OTHERS="ribbon.others",e))(C1||{}),_1=(e=>(e.HISTORY="ribbon.start.history",e.FORMAT="ribbon.start.format",e.LAYOUT="ribbon.start.layout",e.OTHERS="ribbon.start.others",e))(_1||{}),Y1=(e=>(e.EDIT="ribbon.insert.edit",e.MEDIA="ribbon.insert.media",e.OTHERS="ribbon.insert.others",e))(Y1||{}),ce=(e=>(e.BASIC="ribbon.formulas.basic",e.OTHERS="ribbon.formulas.others",e))(ce||{}),$1=(e=>(e.FORMULAS="ribbon.data.formulas",e.RULES="ribbon.data.rules",e.ORGANIZATION="ribbon.data.organization",e.OTHERS="ribbon.data.others",e))($1||{}),X1=(e=>(e.DISPLAY="ribbon.view.display",e.VISIBILITY="ribbon.view.Visibility",e.OTHERS="ribbon.view.others",e))(X1||{}),Ze=(e=>(e.OTHERS="ribbon.others.others",e))(Ze||{}),S1=(e=>(e.MAIN_AREA="contextMenu.mainArea",e.COL_HEADER="contextMenu.colHeader",e.ROW_HEADER="contextMenu.rowHeader",e.FOOTER_TABS="contextMenu.footerTabs",e.FOOTER_MENU="contextMenu.footerMenu",e.PARAGRAPH="contextMenu.paragraph",e))(S1||{}),o1=(e=>(e.QUICK="contextMenu.quick",e.FORMAT="contextMenu.format",e.LAYOUT="contextMenu.layout",e.DATA="contextMenu.data",e.OTHERS="contextMenu.others",e))(o1||{}),Y2=Object.getOwnPropertyDescriptor,X2=(e,n,t,r)=>{for(var o=r>1?void 0:r?Y2(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},Q9=(e,n)=>(t,r)=>n(t,r,e);const I1=f.createIdentifier("univer.menu-manager-service");C.MenuManagerService=class extends f.Disposable{constructor(t,r){super();j(this,"menuChanged$",new B.Subject);j(this,"_menu",{[G1.RIBBON]:{[C1.START]:{order:0,[_1.HISTORY]:{order:0},[_1.FORMAT]:{order:1},[_1.LAYOUT]:{order:2},[_1.OTHERS]:{order:3}},[C1.INSERT]:{order:1,[Y1.EDIT]:{order:0},[Y1.MEDIA]:{order:1},[Y1.OTHERS]:{order:2}},[C1.FORMULAS]:{order:2,[ce.BASIC]:{order:0},[ce.OTHERS]:{order:1}},[C1.DATA]:{order:3,[$1.FORMULAS]:{order:0},[$1.RULES]:{order:1},[$1.ORGANIZATION]:{order:2},[$1.OTHERS]:{order:3}},[C1.VIEW]:{order:4,[X1.DISPLAY]:{order:0},[X1.VISIBILITY]:{order:0},[X1.OTHERS]:{order:0}},[C1.OTHERS]:{order:5,[Ze.OTHERS]:{order:0}}},[G1.CONTEXT_MENU]:{[S1.MAIN_AREA]:{order:0,[o1.QUICK]:{order:-1},[o1.FORMAT]:{order:0},[o1.LAYOUT]:{order:1},[o1.DATA]:{order:2},[o1.OTHERS]:{order:3}},[S1.PARAGRAPH]:{order:0,[o1.QUICK]:{order:-1},[o1.FORMAT]:{order:0},[o1.LAYOUT]:{order:1},[o1.DATA]:{order:2},[o1.OTHERS]:{order:3}},[S1.COL_HEADER]:{order:1,[o1.FORMAT]:{order:0},[o1.LAYOUT]:{order:1},[o1.DATA]:{order:2},[o1.OTHERS]:{order:3}},[S1.ROW_HEADER]:{order:2,[o1.FORMAT]:{order:0},[o1.LAYOUT]:{order:1},[o1.DATA]:{order:2},[o1.OTHERS]:{order:3}},[S1.FOOTER_TABS]:{order:3,[o1.FORMAT]:{order:0},[o1.LAYOUT]:{order:1},[o1.DATA]:{order:2},[o1.OTHERS]:{order:3}},[S1.FOOTER_MENU]:{order:4,[o1.OTHERS]:{order:3}}}});this._injector=t,this._configService=r}dispose(){this.menuChanged$.complete()}mergeMenu(t,r){const o=r!=null?r:this._menu;for(const[i,l]of Object.entries(o))if(i in t){const c=i;o[c]=f.merge({},o[c],t[c]),this.menuChanged$.next()}else typeof l=="object"&&this.mergeMenu(t,l)}appendRootMenu(t){this._menu=f.merge({},this._menu,t),this.menuChanged$.next()}_buildMenuSchema(t){const r=[];for(const[o,i]of Object.entries(t)){const l={key:o,order:i.order,title:i.title};if(i.menuItemFactory){const c=this._injector.invoke(i.menuItemFactory);if(c){const h=this._configService.getConfig("menu");if(h&&c.id in h){const p=c.id;l.item=N9(c,h[p])}else l.item=c}}if(typeof i=="object"){const c=this._buildMenuSchema(i);c.length>0&&(l.children=c.sort((h,p)=>h.order-p.order)),(l.item||l.children)&&r.push(l)}}return r}getMenuByPositionKey(t){const r=o=>{if(t in o)return this._buildMenuSchema(o[t]);for(const i in o){if(i===t)return this._buildMenuSchema(o[i]);if(typeof o[i]=="object"){const l=r(o[i]);if(l)return l}}};return r(this._menu)}getFlatMenuByPositionKey(t){const r=this.getMenuByPositionKey(t);function o(i){return i.reduce((l,c)=>c.children?[...l,c,...o(c.children)]:[...l,c],[])}return o(r)}},C.MenuManagerService=X2([Q9(0,f.Inject(f.Injector)),Q9(1,f.IConfigService)],C.MenuManagerService);function q2(e){const{item:n,onOptionSelect:t}=e,[r,o]=s.useState([]),i=V.useDependency(v1),l=V.useDependency(f.LocaleService);return s.useEffect(()=>{if(!n.children)return;const c=n.children.map(p=>{var b,d;return f.convertObservableToBehaviorSubject((d=(b=p.item)==null?void 0:b.activated$)!=null?d:B.of(!1),!1)}),h=B.combineLatest(c).subscribe(p=>{const b=p.map((d,w)=>({actived:d,item:n.children[w].item.id})).filter(d=>d.actived);b.length===0?o([]):o(b.map(d=>d.item))});return()=>{h.unsubscribe(),c.forEach(p=>{p.complete()})}},[n]),n.children?v.jsx(x.TinyMenuGroup,{items:n.children.map(c=>{var h,p;return{key:c.key,onClick:()=>{var b,d,w,I;t==null||t({value:"",label:c.key,commandId:(b=c.item)==null?void 0:b.commandId,id:(d=c.item)==null?void 0:d.id,tooltip:((w=c.item)==null?void 0:w.tooltip)&&l.t((I=c.item)==null?void 0:I.tooltip)})},className:"",Icon:i.get(c.item.icon),active:r.includes((p=(h=c.item)==null?void 0:h.id)!=null?p:"")}})}):null}const q1="univer-inline-flex univer-gap-2 univer-items-center",K9="univer-size-3.5 univer-text-gray-900 dark:!univer-text-white";function e6(e){const{menuType:n,onOptionSelect:t}=e,r=V.useDependency(f.LocaleService),o=V.useDependency(I1),i=s.useMemo(()=>n?o.getMenuByPositionKey(n):[],[n,o]),[l,c]=s.useState({}),h=s.useMemo(()=>i.filter(p=>{var d;if(!p.children)return p;const b=((d=p.key)==null?void 0:d.toString())||"";return!l[b]}),[i,l]);return s.useEffect(()=>{const p=i.map(b=>{if(!b.children)return null;const d=b.children.map(w=>{var I,_;return(_=(I=w.item)==null?void 0:I.hidden$)!=null?_:B.of(!1)});return B.combineLatest(d).subscribe(w=>{const I=w.every(_=>_===!0);c(_=>({..._,[b.key]:I}))})});return()=>{p.forEach(b=>b==null?void 0:b.unsubscribe()),c({})}},[i]),n?h&&h.map(p=>{var b;return p.item?v.jsx(n6,{menuItem:p.item,onClick:d=>{t==null||t({value:"",label:p.key,...d})}},p.key):(b=p.children)!=null&&b.length?p.key===o1.QUICK?v.jsx(q2,{item:p,onOptionSelect:t},p.key):v.jsx(x.MenuItemGroup,{eventKey:p.key,title:p.title?r.t(p.title):void 0,children:p.children.map(d=>d.item&&v.jsx(n6,{menuItem:d.item,onClick:w=>{t==null||t({value:"",label:d.key,...w})}},d.key))},p.key):null}):null}function t6(e){var i;const{options:n,value:t,onOptionSelect:r,parentKey:o}=e;return(i=n==null?void 0:n.map((l,c)=>{var w,I,_;const h=`${o}-${(w=l.label)!=null?w:l.id}-${c}`,p=T=>{r==null||r({value:T,label:l==null?void 0:l.label,commandId:l==null?void 0:l.commandId})},b=()=>{typeof l.value>"u"||r==null||r({...l})},d=x.clsx({"univer-bg-none":typeof l.label!="string"&&!((I=l.label)!=null&&I.hoverable)});return v.jsx(x.MenuItem,{disabled:l.disabled,eventKey:h,className:d,onClick:b,children:v.jsxs("span",{className:x.clsx(q1,{"univer-relative univer-pl-5":!(typeof l.label!="string"&&!((_=l.label)!=null&&_.hoverable))}),children:[typeof t<"u"&&String(t)===String(l.value)&&v.jsx("span",{className:"univer-absolute univer-left-0 univer-inline-flex univer-items-center",children:v.jsx(De,{className:"univer-text-primary-600"})}),v.jsx(f1,{value$:l.value$,value:l.value,label:l.label,icon:l.icon,onChange:p})]})},h)}))!=null?i:null}const Ae=e=>{const{overViewport:n,style:t,...r}=e,[o,i]=s.useState(),l=V.useDependency(M1);P9(n==="scroll"?o:null,l.rootContainerElement);function c(h){h&&i(h.list)}return v.jsxs(x.Menu,{style:t,ref:c,selectable:!1,children:[v.jsx(t6,{...r}),v.jsx(e6,{...r})]})};function n6({menuItem:e,onClick:n}){const t=V.useDependency(I1),r=V.useObservable(e.disabled$,!1),o=V.useObservable(e.activated$,!1),i=V.useObservable(e.hidden$,!1),l=V.useObservable(e.value$),c=e,h=V.useObservable(B.isObservable(c.selections)?c.selections:void 0),[p,b]=s.useState(l);if(s.useEffect(()=>{b(l)},[l]),i)return null;const d=O=>{const S=f.isRealNum(O)&&typeof O=="string"?Number.parseInt(O):O;b(S)},w=()=>{const O=e,{title:S,label:A}=O;return v.jsx(x.MenuItem,{eventKey:O.id,disabled:r,className:x.clsx({"univer-bg-gray-200":o}),onClick:()=>{n({commandId:O.commandId,value:p,id:O.id})},children:v.jsx("span",{className:q1,children:v.jsx(f1,{value:l,title:S,label:A,icon:O.icon,onChange:d})})},O.id)},I=()=>{var S;const O=(S=h!=null?h:c.selections)!=null?S:[];return O.length>0?v.jsx(x.SubMenu,{eventKey:c.id,popupOffset:[18,0],title:v.jsxs("span",{className:q1,children:[v.jsx(f1,{title:c.title,value:p,onChange:d,icon:c.icon,label:c.label}),c.shortcut&&` (${c.shortcut})`]}),expandIcon:v.jsx(Ne,{className:K9}),children:v.jsx(x.MenuItemGroup,{children:O.length>0&&v.jsx(t6,{parentKey:c.id,menuType:c.id,options:O,onOptionSelect:A=>{n({value:A.value,id:c.id,commandId:A.commandId})}})})},c.id):v.jsx(x.MenuItem,{eventKey:c.id,children:v.jsxs("span",{className:q1,children:[v.jsx(f1,{title:c.title,value:p,icon:c.icon,label:c.label,onChange:d}),c.shortcut&&` (${c.shortcut})`]})},c.id)},_=e.id?t.getMenuByPositionKey(e.id):[],T=()=>{const O=e;return v.jsx(x.SubMenu,{eventKey:O.id,popupOffset:[18,0],title:v.jsx("span",{className:q1,children:v.jsx(f1,{title:O.title,icon:O.icon,label:O.label,onChange:d})}),expandIcon:v.jsx(Ne,{className:K9}),children:v.jsx(x.MenuItemGroup,{children:_.length&&v.jsx(e6,{menuType:O.id,parentKey:O.id,onOptionSelect:n})})},O.id)};return v.jsxs(v.Fragment,{children:[e.type===g1.SELECTOR&&I(),e.type===g1.SUBITEMS&&T(),e.type===g1.BUTTON&&w()]})}function J2(e){const{barColor:n,progress:t,onTerminate:r,onClearProgress:o}=e,{count:i,done:l,label:c=""}=t,h=s.useRef(null),[p,b]=s.useState(!1);return s.useEffect(()=>{const d=h.current;if(i===0&&l===0){b(!1),d.style.width="0%";return}else if(i>0){b(!0);const I=Math.floor(l/i*100);l===i?requestAnimationFrame(()=>{d.style.width=`${I-1}%`,requestAnimationFrame(()=>{d.style.width=`${I}%`})}):d.style.width=`${I}%`}const w=()=>{l===i&&(b(!1),o&&o())};return d.addEventListener("transitionend",w),()=>{d.removeEventListener("transitionend",w)}},[i,l]),v.jsxs("div",{className:x.clsx("univer-mx-2 univer-flex univer-items-center univer-gap-2",{"univer-flex":p,"univer-hidden univer-w-0":!p}),children:[v.jsx(x.Tooltip,{showIfEllipsis:!0,title:c,children:v.jsx("span",{className:"univer-w-24 univer-truncate univer-text-right univer-text-xs",children:c})}),v.jsx("div",{className:"univer-h-1 univer-w-40 univer-overflow-hidden univer-rounded-lg univer-bg-gray-200",children:v.jsx("div",{ref:h,className:"univer-h-full univer-bg-primary-600 univer-transition-[width]",style:{backgroundColor:n}})}),v.jsx("button",{className:"univer-flex univer-size-4 univer-cursor-pointer univer-items-center univer-justify-center univer-border-none univer-bg-transparent univer-p-0 hover:univer-opacity-50",type:"button",onClick:r,children:v.jsx(Oe,{className:"univer-size-3.5 dark:!univer-text-white"})})]})}const Q2="UNI_DISABLE_CHANGING_FOCUS",ue=f.createIdentifier("ui.message.service");var K2=Object.getOwnPropertyDescriptor,e4=(e,n,t,r)=>{for(var o=r>1?void 0:r?K2(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},r6=(e,n)=>(t,r)=>n(t,r,e);C.ErrorController=class extends f.Disposable{constructor(n,t){super(),this._errorService=n,this._messageService=t,this.disposeWithMe(this._errorService.error$.subscribe(r=>{this._messageService.show({content:r.errorKey,type:x.MessageType.Error})}))}},C.ErrorController=e4([r6(0,f.Inject(f.ErrorService)),r6(1,ue)],C.ErrorController);function t4(){return{id:j1.id,title:"toggle-shortcut-panel",tooltip:"toggle-shortcut-panel",icon:"ShortcutIcon",type:g1.BUTTON}}const o6=(e,n)=>{const t=e.get(f.IUndoRedoService),r=e.get(f.IContextService);return B.combineLatest([t.undoRedoStatus$.pipe(_3.map(o=>n?o.undos<=0:o.redos<=0)),B.merge([B.of({}),r.contextChanged$])]).pipe(_3.map(([o])=>o||r.getContextValue(f.EDITOR_ACTIVATED)||r.getContextValue(f.FOCUSING_FX_BAR_EDITOR)))};function n4(e){return{id:f.UndoCommand.id,type:g1.BUTTON,icon:"UndoIcon",title:"Undo",tooltip:"toolbar.undo",disabled$:o6(e,!0)}}function r4(e){return{id:f.RedoCommand.id,type:g1.BUTTON,icon:"RedoIcon",title:"Redo",tooltip:"toolbar.redo",disabled$:o6(e,!1)}}const i6={[_1.HISTORY]:{[f.UndoCommand.id]:{order:0,menuItemFactory:n4},[f.RedoCommand.id]:{order:1,menuItemFactory:r4}},[_1.OTHERS]:{[j1.id]:{order:1,menuItemFactory:t4}}},l6="univer.command.copy",Pe={id:l6,name:l6,multi:!0,priority:0,type:f.CommandType.COMMAND,preconditions:()=>!1,handler:()=>!0},s6="univer.command.cut",Fe={id:s6,name:s6,multi:!0,priority:0,type:f.CommandType.COMMAND,preconditions:()=>!1,handler:async()=>!0},a6="univer.command.paste",ke={id:a6,name:a6,multi:!0,priority:0,type:f.CommandType.COMMAND,preconditions:()=>!1,handler:()=>!0},o4="sheet.command.paste-by-short-key";var H1=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL=17]="CTRL",e[e.ESC=27]="ESC",e[e.SPACE=32]="SPACE",e[e.ARROW_LEFT=37]="ARROW_LEFT",e[e.ARROW_UP=38]="ARROW_UP",e[e.ARROW_RIGHT=39]="ARROW_RIGHT",e[e.ARROW_DOWN=40]="ARROW_DOWN",e[e.INSERT=45]="INSERT",e[e.DELETE=46]="DELETE",e[e.Digit0=48]="Digit0",e[e.Digit1=49]="Digit1",e[e.Digit2=50]="Digit2",e[e.Digit3=51]="Digit3",e[e.Digit4=52]="Digit4",e[e.Digit5=53]="Digit5",e[e.Digit6=54]="Digit6",e[e.Digit7=55]="Digit7",e[e.Digit8=56]="Digit8",e[e.Digit9=57]="Digit9",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NUM_LOCK=144]="NUM_LOCK",e[e.SCROLL_LOCK=145]="SCROLL_LOCK",e[e.EQUAL=187]="EQUAL",e[e.COMMA=188]="COMMA",e[e.MINUS=189]="MINUS",e[e.PERIOD=190]="PERIOD",e[e.BACK_SLASH=220]="BACK_SLASH",e))(H1||{});const i4={8:"Backspace",9:"Tab",13:"Enter",46:"Del",27:"Esc",32:"Space",37:"",39:"",38:"",40:"",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",189:"-",187:"=",190:".",188:",",220:"\\"};var h1=(e=>(e[e.SHIFT=1024]="SHIFT",e[e.ALT=2048]="ALT",e[e.CTRL_COMMAND=4096]="CTRL_COMMAND",e[e.MAC_CTRL=8192]="MAC_CTRL",e))(h1||{});function l4(e,n,t){return window.addEventListener(e,n,t),f.toDisposable(()=>window.removeEventListener(e,n,t))}const de=f.createIdentifier("ui.platform.service");class Be{get isMac(){return/Mac/.test(navigator.appVersion)}get isWindows(){return/Windows/.test(navigator.appVersion)}get isLinux(){return/Linux/.test(navigator.appVersion)}}var s4=Object.getOwnPropertyDescriptor,a4=(e,n,t,r)=>{for(var o=r>1?void 0:r?s4(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},fe=(e,n)=>(t,r)=>n(t,r,e);const Z1=f.createIdentifier("ui.shortcut.service");C.ShortcutService=class extends f.Disposable{constructor(t,r,o,i){super();j(this,"_shortCutMapping",new Map);j(this,"_commandIDMapping",new Map);j(this,"_shortcutChanged$",new B.Subject);j(this,"shortcutChanged$",this._shortcutChanged$.asObservable());j(this,"_forceEscaped",!1);j(this,"_forceDisabled",!1);this._commandService=t,this._platformService=r,this._contextService=o,this._layoutService=i,this.disposeWithMe(l4("keydown",l=>{this._resolveKeyboardEvent(l)},{capture:!0}))}getAllShortcuts(){return Array.from(this._shortCutMapping.values()).map(t=>Array.from(t.values())).flat()}registerShortcut(t){const r=this._getBindingFromItem(t);if(!r)return f.toDisposable(()=>{});const o=this._shortCutMapping.get(r);o?o.add(t):this._shortCutMapping.set(r,new Set([t]));const i=t.id,l=this._commandIDMapping.get(i);return l?l.add(t):this._commandIDMapping.set(i,new Set([t])),this._emitShortcutChanged(),f.toDisposable(()=>{var c,h,p,b;(c=this._shortCutMapping.get(r))==null||c.delete(t),((h=this._shortCutMapping.get(r))==null?void 0:h.size)===0&&this._shortCutMapping.delete(r),(p=this._commandIDMapping.get(i))==null||p.delete(t),((b=this._commandIDMapping.get(i))==null?void 0:b.size)===0&&this._commandIDMapping.delete(i),this._emitShortcutChanged()})}getShortcutDisplayOfCommand(t){const r=this._commandIDMapping.get(t);if(!r)return null;const o=r.values().next().value;return o?this.getShortcutDisplay(o):null}getShortcutDisplay(t){var p;const r=this._getBindingFromItem(t);if(!r)return null;const o=r&h1.CTRL_COMMAND,i=r&h1.SHIFT,l=r&h1.ALT,c=r&h1.MAC_CTRL,h=(p=i4[r&255])!=null?p:"<->";return this._platformService.isMac?`${o?"+":""}${i?"+":""}${l?"+":""}${c?"+":""}${h}`:`${o?"Ctrl+":""}${i?"Shift+":""}${l?"Alt+":""}${h}`}_emitShortcutChanged(){this._shortcutChanged$.next()}forceEscape(){return this._forceEscaped=!0,f.toDisposable(()=>this._forceEscaped=!1)}forceDisable(){return this._forceDisabled=!0,f.toDisposable(()=>{this._forceDisabled=!1})}_resolveKeyboardEvent(t){const r=this.dispatch(t);r&&(this._commandService.executeCommand(r.id,r.staticParameters),t.preventDefault())}dispatch(t){if(this._forceEscaped||this._forceDisabled||this._layoutService&&!this._layoutService.checkElementInCurrentContainers(t.target))return;const r=this._deriveBindingFromEvent(t);if(r===null)return;const o=this._shortCutMapping.get(r);return o===void 0?void 0:Array.from(o).sort((l,c)=>{var h,p;return((h=c.priority)!=null?h:0)-((p=l.priority)!=null?p:0)}).find(l=>{var c,h;return(h=(c=l.preconditions)==null?void 0:c.call(l,this._contextService))!=null?h:!0})}_getBindingFromItem(t){return this._platformService.isMac&&t.mac?t.mac:this._platformService.isWindows&&t.win?t.win:this._platformService.isLinux&&t.linux?t.linux:t.binding}_deriveBindingFromEvent(t){const{shiftKey:r,metaKey:o,altKey:i,keyCode:l}=t;let c=l;return r&&(c|=h1.SHIFT),i&&(c|=h1.ALT),(this._platformService.isMac?o:t.ctrlKey)&&(c|=h1.CTRL_COMMAND),this._platformService.isMac&&t.ctrlKey&&(c|=h1.MAC_CTRL),c}},C.ShortcutService=a4([fe(0,f.ICommandService),fe(1,de),fe(2,f.IContextService),fe(3,f.Optional(M1))],C.ShortcutService);var c4=Object.getOwnPropertyDescriptor,u4=(e,n,t,r)=>{for(var o=r>1?void 0:r?c4(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},c6=(e,n)=>(t,r)=>n(t,r,e);function u6(e){return e.getContextValue(f.FOCUSING_UNIVER_EDITOR)}function d6(e){return e.getContextValue(f.FOCUSING_UNIVER_EDITOR)&&!(e.getContextValue(f.EDITOR_ACTIVATED)||e.getContextValue(f.FOCUSING_FX_BAR_EDITOR))}const f6={id:Pe.id,description:"shortcut.copy",group:"1_common-edit",binding:H1.C|h1.CTRL_COMMAND,preconditions:u6},C6={id:Fe.id,description:"shortcut.cut",group:"1_common-edit",binding:H1.X|h1.CTRL_COMMAND,preconditions:u6},d4={id:ke.id,description:"shortcut.paste",group:"1_common-edit",binding:H1.V|h1.CTRL_COMMAND,preconditions:()=>!1},h6={id:f.UndoCommand.id,description:"shortcut.undo",group:"1_common-edit",binding:H1.Z|h1.CTRL_COMMAND,preconditions:d6},v6={id:f.RedoCommand.id,description:"shortcut.redo",group:"1_common-edit",binding:H1.Y|h1.CTRL_COMMAND,preconditions:d6};C.SharedController=class extends f.Disposable{constructor(n,t){super(),this._shortcutService=n,this._commandService=t,this.initialize()}initialize(){this._registerCommands(),this._registerShortcuts()}_registerCommands(){[Fe,Pe,ke].forEach(n=>this.disposeWithMe(this._commandService.registerMultipleCommand(n)))}_registerShortcuts(){const n=[h6,v6];n.push(C6,f6,d4),n.forEach(t=>this.disposeWithMe(this._shortcutService.registerShortcut(t)))}},C.SharedController=u4([c6(0,Z1),c6(1,f.ICommandService)],C.SharedController);function f4(){const e=V.useDependency(Z1),n=V.useDependency(f.LocaleService),t=V.useObservable(n.currentLocale$),[r,o]=s.useState([]),i=s.useCallback(()=>{var p;const l=new Map,c=e.getAllShortcuts().filter(b=>!!b.group);for(const b of c){const d=b.group,w={title:n.t((p=b.description)!=null?p:b.id),shortcut:e.getShortcutDisplay(b)};if(!/\d+_[a-zA-Z0-9]/.test(d))throw new Error(`[ShortcutPanel]: Invalid shortcut group: ${d}!`);l.has(d)||l.set(d,[]),l.get(d).push(w)}const h=Array.from(l.entries()).map(([b,d])=>{const w=b.split("_")[0],I=b.slice(w.length+1);return{sequence:+w,name:n.t(I),items:f.dedupeBy(d,_=>_.title+_.shortcut)}}).sort((b,d)=>b.sequence-d.sequence);o(h)},[e,n,t]);return s.useEffect(()=>{i();const l=e.shortcutChanged$.subscribe(()=>i());return()=>l.unsubscribe()},[e,i]),v.jsx("ul",{className:"univer-m-0 univer-list-none univer-p-0 univer-text-gray-900 dark:!univer-text-white",children:r.map(l=>v.jsxs("li",{children:[v.jsx("div",{className:"univer-flex univer-h-10 univer-items-center univer-text-sm univer-font-semibold",children:l.name}),v.jsx("ul",{className:x.clsx("univer-list-none univer-p-0",x.divideYClassName),children:l.items.map(c=>v.jsxs("li",{className:"univer-flex univer-h-10 univer-items-center univer-justify-between univer-py-0.5 univer-text-sm last:univer-border-b-0",children:[v.jsx("span",{className:"univer-line-clamp-2",children:c.title}),c.shortcut&&v.jsx(x.KBD,{keyboard:c.shortcut})]},`${c.title}-${c.shortcut}`))})]},l.name))})}var C4=Object.getOwnPropertyDescriptor,h4=(e,n,t,r)=>{for(var o=r>1?void 0:r?C4(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},J1=(e,n)=>(t,r)=>n(t,r,e);const v4={id:j1.id,binding:h1.CTRL_COMMAND|H1.BACK_SLASH,description:"shortcut.shortcut-panel",group:"10_global-shortcut"};C.ShortcutPanelController=class extends f.Disposable{constructor(n,t,r,o,i){super(),this._menuManagerService=o,this.disposeWithMe(t.register(H3,f4)),this.disposeWithMe(i.registerCommand(j1)),this.disposeWithMe(r.registerShortcut(v4))}},C.ShortcutPanelController=h4([J1(0,f.Inject(f.Injector)),J1(1,f.Inject(v1)),J1(2,Z1),J1(3,I1),J1(4,f.ICommandService)],C.ShortcutPanelController);var i1=(e=>(e.GLOBAL="global",e.HEADER="header",e.HEADER_MENU="header-menu",e.CONTENT="content",e.FOOTER="footer",e.LEFT_SIDEBAR="left-sidebar",e.FLOATING="floating",e.UNIT="unit",e.CUSTOM_HEADER="custom-header",e.CUSTOM_LEFT="custom-left",e.CUSTOM_RIGHT="custom-right",e.CUSTOM_FOOTER="custom-footer",e.TOOLBAR="toolbar",e))(i1||{});const w1=f.createIdentifier("ui.parts.service");class Ue extends f.Disposable{constructor(){super(...arguments);j(this,"_componentsByPart",new Map);j(this,"_componentRegistered$",new B.Subject);j(this,"componentRegistered$",this._componentRegistered$.asObservable());j(this,"_uiVisible",new Map);j(this,"_uiVisibleChange$",new B.Subject);j(this,"uiVisibleChange$",this._uiVisibleChange$.asObservable())}dispose(){super.dispose(),this._componentsByPart.clear(),this._uiVisible.clear(),this._componentRegistered$.complete(),this._uiVisibleChange$.complete()}setUIVisible(t,r){this._uiVisible.set(t,r),this._uiVisibleChange$.next({ui:t,visible:r})}isUIVisible(t){var r;return(r=this._uiVisible.get(t))!=null?r:!0}registerComponent(t,r){const o=r(),i=(this._componentsByPart.get(t)||this._componentsByPart.set(t,new Set).get(t)).add(o);return this._componentRegistered$.next(t),f.toDisposable(()=>{i.delete(o),i.size===0&&this._componentsByPart.delete(t),this._componentRegistered$.next(t)})}getComponents(t){return new Set([...this._componentsByPart.get(t)||new Set])}}class Ce{constructor(){j(this,"_domLayerMap",new Map);j(this,"_domLayers$",new B.BehaviorSubject([]));j(this,"domLayers$",this._domLayers$.asObservable())}get domLayers(){return Array.from(this._domLayerMap.entries())}_notice(){this._domLayers$.next(Array.from(this._domLayerMap.entries()))}updateFloatDom(n,t){const r=this._domLayerMap.get(n);r&&(this._domLayerMap.set(n,{...r,...t}),this._notice())}addFloatDom(n){this._domLayerMap.set(n.id,n),this._notice()}removeFloatDom(n){this._domLayerMap.delete(n)&&this._notice()}removeAll(){this._domLayerMap.clear(),this._notice()}}const g6=s.memo(e=>{var S,A;const{layer:n,id:t}=e,r=s.useMemo(()=>n.position$.pipe(B.distinctUntilChanged((R,k)=>R.absolute.left===k.absolute.left&&R.absolute.top===k.absolute.top&&R.endX-R.startX===k.endX-k.startX&&R.endY-R.startY===k.endY-k.startY)),[n.position$]),o=V.useDependency(f.IUniverInstanceService),i=V.useObservable(s.useMemo(()=>n.position$.pipe(B.first()),[n.position$])),l=s.useRef(null),c=s.useRef(null),h=s.useRef(`transform: rotate(${i==null?void 0:i.rotate}deg) translate(${i==null?void 0:i.startX}px, ${i==null?void 0:i.startY}px)`),p=s.useRef((S=i==null?void 0:i.startY)!=null?S:0),b=s.useRef((A=i==null?void 0:i.startX)!=null?A:0),d=s.useRef({}),w=typeof n.componentKey=="string"?V.useDependency(v1).get(n.componentKey):n.componentKey,I=s.useMemo(()=>({data:n.data,...n.props}),[n.data,n.props]);s.useEffect(()=>{const R=n.position$.subscribe(M=>{var $;h.current=`rotate(${M.rotate}deg)`,p.current=M.startY,b.current=M.startX,l.current&&(l.current.style.transform=h.current,l.current.style.top=`${p.current}px`,l.current.style.left=`${b.current}px`,l.current.style.opacity=`${($=M.opacity)!=null?$:1}`)}),k=r.subscribe(M=>{if(l.current&&(l.current.style.width=`${Math.max(M.endX-M.startX-2,0)}px`,l.current.style.height=`${Math.max(M.endY-M.startY-2,0)}px`),c.current){const $={width:`${M.width-4}px`,height:`${M.height-4}px`,left:`${M.absolute.left?0:"auto"}`,top:`${M.absolute.top?0:"auto"}`,right:`${M.absolute.left?"auto":0}`,bottom:`${M.absolute.top?"auto":0}`};c.current.style.width=$.width,c.current.style.height=$.height,c.current.style.left=$.left,c.current.style.top=$.top,c.current.style.right=$.right,c.current.style.bottom=$.bottom,d.current=$}});return()=>{R.unsubscribe(),k.unsubscribe()}},[n.position$,r]);const _=o.getUnit(n.unitId),T=_ instanceof f.DocumentDataModel?_.getDisabled():void 0,O=s.useMemo(()=>w?v.jsx(w,{...I,unitId:n.unitId,unit:_,floatDomId:n.id,context:{docDisabled:T,root:c}}):null,[w,I]);return i?v.jsx("div",{ref:l,className:"univer-z-10",style:{position:"absolute",top:p.current,left:b.current,width:Math.max(i.endX-i.startX-2,0),height:Math.max(i.endY-i.startY-2,0),transform:h.current,overflow:"hidden",transformOrigin:"center center"},onPointerMove:R=>{n.onPointerMove(R.nativeEvent)},onPointerDown:R=>{n.onPointerDown(R.nativeEvent)},onPointerUp:R=>{n.onPointerUp(R.nativeEvent)},onWheel:R=>{n.onWheel(R.nativeEvent)},children:v.jsx("div",{id:t,ref:c,className:"univer-absolute univer-overflow-hidden",style:{...d.current},children:O})}):null}),je=({unitId:e})=>{var l;const n=V.useDependency(f.IUniverInstanceService),t=V.useDependency(Ce),r=V.useObservable(t.domLayers$),o=V.useObservable(n.focused$),i=e||o;return(l=r==null?void 0:r.filter(c=>c[1].unitId===i))==null?void 0:l.map(c=>{var h;return v.jsx(g6,{id:(h=c[1].domId)!=null?h:c[0],layer:c[1]},c[0])})},he=f.createIdentifier("ui.popup.service");class ze extends f.Disposable{constructor(){super(...arguments);j(this,"_popupMap",new Map);j(this,"_popups$",new B.BehaviorSubject([]));j(this,"popups$",this._popups$.asObservable());j(this,"_activePopupId",null)}get popups(){return Array.from(this._popupMap.entries())}get activePopupId(){return this._activePopupId}_update(){this._popups$.next(Array.from(this._popupMap.entries()))}dispose(){super.dispose(),this._popups$.next([]),this._popups$.complete(),this._popupMap.clear()}addPopup(t){const r=f.generateRandomId();return this._popupMap.set(r,{...t,onActiveChange:o=>{o?this._activePopupId=r:this._activePopupId===r&&(this._activePopupId=null)}}),this._update(),r}removePopup(t){this._popupMap.delete(t)&&this._update()}removeAll(){this._popupMap.clear(),this._update()}}const p6=s.createContext({current:void 0}),A1=8;function m6(e){const{position:n,width:t,height:r,containerHeight:o,containerWidth:i,direction:l="vertical",noPushMinimumGap:c=!1}=e,h=c?-1/0:A1,p=c?1/0:o-r-A1,b=c?-1/0:A1,d=c?1/0:i-t-A1;if(l==="vertical"||l.indexOf("top")===0||l.indexOf("bottom")===0){const{left:A,top:R,right:k,bottom:M}=n,$=l==="vertical"&&M>p||l.indexOf("top")>-1?{top:Math.max(R-r,h)}:{top:Math.min(M,p)};let D;if(l.includes("center")){const W=(k-A-t)/2;D=Math.max(A+W,b)+t>i?{left:Math.max(Math.min(d,k-t-W),b)}:{left:Math.max(b,Math.min(A+W,d))}}else l.includes("right")?D={left:Math.max(k-t,b)}:l.includes("left")?D={left:Math.min(A,d)}:D=A+t>i?Math.max(k-t,b)<A1?{left:Math.min(A,d)}:{left:Math.max(k-t,b)}:{left:Math.min(A,d)};return{...$,...D}}const{left:w,top:I,right:_,bottom:T}=n,O=l.includes("left")?{left:Math.max(w-t,b)}:{left:Math.min(_,d)};let S;if(l.includes("center")){const R=(T-I-r)/2;S=Math.max(I+R,h)+r>o?{top:Math.max(Math.min(p,T-r-R),h)}:{top:Math.max(h,Math.min(I+R,p))}}else l.includes("top")?S={top:Math.min(I,p)}:l.includes("bottom")?S={top:Math.max(T-r,h)}:S=I+r>o?Math.max(T-r,h)<A1?{top:Math.min(I,p)}:{top:Math.max(T-r,h)}:{top:Math.min(I,p)};return{...S,...O}}function ve(e){var J;const{mask:n,portal:t,children:r,anchorRect$:o,direction:i="vertical",onClickOutside:l,excludeOutside:c,excludeRects:h,onPointerEnter:p,onPointerLeave:b,onClick:d,hidden:w,onContextMenu:I,zIndex:_=1020,maskZIndex:T=100,onMaskClick:O,noPushMinimumGap:S,autoRelayout:A=!0}=e,R=s.useRef(null),k=R1(l!=null?l:(()=>{})),M=R1(I!=null?I:(()=>{})),$=s.useRef({top:-9999,left:-9999}),D=h,U=V.useDependency(f.IConfigService),W=s.useRef(void 0),Y=U.getConfig(V1),q=(J=Y==null?void 0:Y.popupRootId)!=null?J:"univer-popup-portal",G=R1(X=>{requestAnimationFrame(()=>{if(!R.current)return;const{clientWidth:n1,clientHeight:s1}=R.current,d1=window.innerWidth,b1=window.innerHeight;$.current=m6({position:X,width:n1,height:s1,containerWidth:d1,containerHeight:b1,direction:i,noPushMinimumGap:S}),R.current.style.top=`${$.current.top}px`,R.current.style.left=`${$.current.left}px`})});s.useEffect(()=>{let X;return R.current&&(X=new ResizeObserver(()=>{A&&W.current&&G(W.current)}),X.observe(R.current)),()=>{X==null||X.disconnect()}},[R.current,A]),s.useEffect(()=>{const X=o.subscribe(n1=>{W.current=n1,G(n1)});return()=>X.unsubscribe()},[o,i]),s.useEffect(()=>{const X=n1=>{var l1;if(c&&(c.indexOf(n1.target)>-1||c.some(K=>K.contains(n1.target))))return;const s1=n1.clientX,d1=n1.clientY,b1=[...(l1=D==null?void 0:D.current)!=null?l1:[]];W.current&&b1.push(W.current);for(const K of b1)if(s1<=K.right&&s1>=K.left&&d1<=K.bottom&&d1>=K.top)return;k(n1)};return window.addEventListener("pointerdown",X),()=>{window.removeEventListener("pointerdown",X)}},[k,c,D]),s.useEffect(()=>{const X=n1=>{n1.ctrlKey&&n1.button===0||M()};return window.addEventListener("contextmenu",X),()=>{window.removeEventListener("contextmenu",X)}},[M]);const t1=v.jsxs(v.Fragment,{children:[n&&v.jsx("div",{"data-u-comp":"rect-popup-mask",className:"univer-fixed univer-bottom-0 univer-left-0 univer-right-0 univer-top-0 univer-z-[100]",style:{zIndex:T},onClick:O}),v.jsx("section",{"data-u-comp":"rect-popup",ref:R,className:x.clsx("univer-pointer-events-auto univer-fixed univer-left-[-9999px] univer-top-[-9999px] univer-z-[1020]",{"univer-hidden":w,"univer-animate-in univer-fade-in-70":!w}),style:{...$.current,zIndex:_},onPointerDown:X=>X.stopPropagation(),onClick:d,onPointerEnter:p,onPointerLeave:b,children:v.jsx(p6.Provider,{value:W,children:r})})]});return t?document.getElementById(q)?S3.createPortal(t1,document.getElementById(q)):null:t1}ve.calcPopupPosition=m6,ve.useContext=()=>s.useContext(p6);const b6=({popup:e,children:n})=>{const[t,r]=s.useState(!1),o=s.useMemo(()=>e.anchorRect$.pipe(B.throttleTime(0,B.animationFrameScheduler),B.map(d=>{var A;const{bottom:w,left:I,right:_,top:T}=d,[O=0,S=0]=(A=e.offset)!=null?A:[];return{left:I-O,right:_+O,top:T-S,bottom:w+S}})),[e.anchorRect$,e.offset]),i=s.useMemo(()=>{var d,w;return(w=(d=e.hiddenRects$)==null?void 0:d.pipe(B.throttleTime(0,B.animationFrameScheduler)))!=null?w:B.of([])},[e.hiddenRects$]),l=s.useMemo(()=>{var d;return(d=e.excludeRects$)==null?void 0:d.pipe(B.throttleTime(0,B.animationFrameScheduler))},[e.excludeRects$]),c=T9(l,e.excludeRects),{canvasElement:h,hideOnInvisible:p=!0,hiddenType:b="destroy"}=e;return s.useEffect(()=>{if(!p)return;const d=B.combineLatest([o,i]).subscribe(([w,I])=>{const _=h.getBoundingClientRect(),{top:T,left:O,bottom:S,right:A}=_,R=w.bottom-w.top,k=w.right-w.left,M=I.some($=>w.top>=$.top-.5*R&&w.bottom<=$.bottom+.5*R&&w.left>=$.left-.5*k&&w.right<=$.right+.5*k);w.bottom<T||w.top>S||w.right<O||w.left>A||M?r(!0):r(!1)});return()=>d.unsubscribe()},[h,p,o,i]),t&&b==="destroy"?null:v.jsx(ve,{...e,hidden:t,anchorRect$:o,direction:e.direction,onClickOutside:e.onClickOutside,excludeOutside:e.excludeOutside,excludeRects:c,...e.customActive?null:{onPointerEnter:()=>{var d;return(d=e.onActiveChange)==null?void 0:d.call(e,!0)},onPointerLeave:()=>{var d;return(d=e.onActiveChange)==null?void 0:d.call(e,!1)}},onClick:e.onClick,onContextMenu:e.onContextMenu,children:n})};function We(){const e=V.useDependency(he),n=V.useDependency(v1);return V.useObservable(e.popups$,void 0,!0).map(r=>{const[o,i]=r,l=n.get(i.componentKey);return v.jsx(b6,{popup:i,children:l?v.jsx(l,{popup:i}):null},o)})}function p1(e){const{components:n,fallback:t,sharedProps:r}=e;return!n||n.size===0?t!=null?t:null:Array.from(n.values()).map((o,i)=>{var l;return s.createElement(o,{key:`${(l=o.displayName)!=null?l:i}`,...r})})}function m1(e,n){var c;const t=(c=n==null?void 0:n.get(w1))!=null?c:V.useDependency(w1),r=s.useMemo(()=>t.uiVisibleChange$.pipe(B.filter(h=>h.ui===e)),[e,t]),o=V.useObservable(r),i=s.useRef(0),l=V.useObservable(()=>t.componentRegistered$.pipe(B.filter(h=>h===e),B.debounceTime(200),B.map(()=>i.current+=1),B.startWith(i.current+=1)),void 0,void 0,[t,e,o]);return s.useMemo(()=>t.isUIVisible(e)?t.getComponents(e):new Set,[l])}function g4({ribbon:e,activatedTab:n,onSelectTab:t}){const r=V.useDependency(f.LocaleService);return v.jsx("div",{className:"univer-flex univer-h-full univer-w-full univer-items-center univer-justify-center univer-gap-1 univer-overflow-x-auto univer-rounded-md univer-bg-gray-50 univer-px-3 dark:!univer-bg-gray-900",role:"tablist","aria-label":r.t("ribbon.menu"),children:e.map(o=>{const i=n===o.key;return v.jsx("button",{type:"button",role:"tab","aria-selected":i,title:r.t(o.key),onClick:()=>t(o),className:x.clsx("univer-focus:outline-none univer-focus:ring-2 univer-focus:ring-primary-500 dark:!univer-focus:ring-primary-300 univer-flex univer-cursor-pointer univer-appearance-none univer-items-center univer-gap-1 univer-rounded-sm univer-border-none univer-px-2 univer-py-1 univer-text-sm univer-transition-colors",i?`
                              univer-bg-primary-50 univer-font-semibold univer-text-primary-600 univer-shadow-sm
                              dark:!univer-bg-primary-900 dark:!univer-text-primary-300
                            `:`
                              univer-hover:bg-gray-100
                              dark:!univer-hover:bg-gray-700
                              univer-bg-transparent univer-text-gray-700
                              dark:!univer-text-gray-200
                            `),children:r.t(o.key)},o.key)})})}const p4={[C1.START]:at,[C1.INSERT]:Ct,[C1.FORMULAS]:Re,[C1.DATA]:W3,[C1.VIEW]:Q3,[C1.OTHERS]:Ve};function m4({ribbon:e,activatedTab:n,onSelectTab:t}){const r=V.useDependency(f.LocaleService),[o,i]=s.useState(!1);function l(c){t(c),i(!1)}return v.jsx(x.HoverCard,{className:"univer-max-w-96 !univer-rounded-xl",align:"start",open:o,overlay:v.jsx("div",{className:"univer-grid univer-gap-1 univer-px-2 univer-py-1",children:e.map(c=>{const h=p4[c.key];return v.jsxs("a",{"data-u-comp":"ribbon-group-btn",className:"univer-box-border univer-flex univer-cursor-pointer univer-items-center univer-gap-2.5 univer-rounded-lg univer-px-2 univer-py-1.5 hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-700",role:"button",onClick:()=>l(c),children:[v.jsx("span",{className:x.clsx("univer-box-border univer-flex univer-size-9 univer-flex-shrink-0 univer-items-center univer-justify-center univer-rounded-lg",x.borderClassName),children:v.jsx(h,{className:"univer-text-gray-500 dark:!univer-text-gray-300"})}),v.jsxs("span",{className:"univer-flex univer-flex-col",children:[v.jsx("strong",{className:"univer-text-sm univer-font-semibold univer-text-gray-800 dark:!univer-text-gray-200",children:r.t(c.key)}),v.jsx("span",{className:"univer-text-xs univer-text-gray-400",children:r.t(`${c.key}Desc`)})]})]},c.key)})}),onOpenChange:i,children:v.jsxs("a",{className:"univer-mr-2 univer-flex univer-h-7 univer-cursor-pointer univer-items-center univer-gap-1.5 univer-whitespace-nowrap !univer-rounded-full univer-bg-gray-700 univer-pl-3 univer-pr-2 univer-text-sm univer-text-white dark:!univer-bg-gray-200 dark:!univer-text-gray-800",onClick:()=>i(!0),children:[r.t(n),v.jsx(z1,{className:"univer-text-gray-200 dark:!univer-text-gray-500"})]})})}const L6=`
univer-box-border univer-flex univer-h-6 univer-min-w-6 univer-cursor-pointer univer-items-center
univer-justify-center univer-rounded univer-border-none univer-bg-transparent univer-p-0
univer-text-gray-900 univer-outline-none univer-transition-colors univer-animate-in univer-fade-in
dark:!univer-text-white dark:hover:!univer-bg-gray-700 dark:disabled:!univer-text-gray-600
disabled:univer-cursor-not-allowed disabled:univer-text-gray-300 disabled:hover:univer-bg-transparent
hover:univer-bg-gray-100 whitespace-nowrap univer-w-max
`;function w6(e){const{children:n,className:t,style:r,disabled:o=!1,active:i=!1,noIcon:l,onClick:c,onDoubleClick:h,...p}=e,b=w=>{if(o){w.preventDefault();return}c&&c(w)},d=w=>{if(o){w.preventDefault();return}h&&h(w)};return v.jsx("button",{type:"button",className:x.clsx(L6,{"univer-px-2":l,"!univer-bg-gray-200 dark:!univer-bg-gray-500":i}),style:r,disabled:o,onClick:b,onDoubleClick:d,...p,children:n})}function y6(e){const{disabled$:n,hidden$:t,activated$:r,value$:o}=e,[i,l]=s.useState(),[c,h]=s.useState(!1),[p,b]=s.useState(!1),[d,w]=s.useState(!1);return s.useEffect(()=>{const I=[];return n&&I.push(n.subscribe(_=>h(_))),t&&I.push(t.subscribe(_=>w(_))),r&&I.push(r.subscribe(_=>b(_))),o&&I.push(o.subscribe(_=>l(_))),()=>I.forEach(_=>_.unsubscribe())},[r,n,t,o]),{disabled:c,value:i,activated:p,hidden:d}}const Ge=s.createContext({dropdownVisible:!1,setDropdownVisible:e=>{}}),b4=s.forwardRef((e,n)=>{const{children:t,...r}=e,o=s.useRef(null),[i,l]=s.useState(!1),[c,h]=s.useState(!1);function p(w){l(c?!1:w)}function b(w){h(w),l(!1)}const d=s.useMemo(()=>({dropdownVisible:c,setDropdownVisible:b}),[c]);return s.useImperativeHandle(n,()=>({el:o.current})),r.title?v.jsx(x.Tooltip,{visible:i,onVisibleChange:p,...r,children:v.jsx("span",{ref:o,children:v.jsx(Ge.Provider,{value:d,children:t})})}):v.jsx("span",{ref:o,children:t})});function L4(e){const{children:n,overlay:t,disabled:r,align:o="start"}=e,{dropdownVisible:i,setDropdownVisible:l}=s.useContext(Ge);function c(h){l(h)}return v.jsx(x.Dropdown,{align:o,overlay:v.jsx("div",{className:"univer-grid univer-gap-2",children:t}),disabled:r,open:i,onOpenChange:c,children:v.jsx("div",{className:"univer-h-full",onClick:h=>h.stopPropagation(),children:n})})}function ge({icon:e,value:n,option:t,onOptionSelect:r}){var l;const o=c=>{r==null||r({value:c,label:t==null?void 0:t.label,commandId:t==null?void 0:t.commandId})},i=typeof t.label=="string"||typeof t.label=="object"&&((l=t.label)==null?void 0:l.selectable)!==!1;return v.jsxs("div",{className:x.clsx("univer-relative univer-flex univer-items-center univer-gap-2",{"univer-pl-6":i}),children:[i&&String(n)===String(t.value)&&v.jsx(De,{className:"univer-absolute univer-left-1 univer-top-0.5 univer-text-primary-600"}),v.jsx(f1,{className:"univer-text-sm",icon:e,value$:t.value$,value:t.value,label:t.label,onChange:o})]})}function I6({menuId:e,slot:n,value:t,options:r,children:o,disabled:i,onOptionSelect:l}){var T;const{dropdownVisible:c,setDropdownVisible:h}=s.useContext(Ge),p=V.useDependency(I1),[b,d]=s.useState({}),w=s.useMemo(()=>e?p.getMenuByPositionKey(e):[],[e]),I=s.useMemo(()=>w.filter(O=>{var A;if(!O.children)return!b[O.key];const S=((A=O.key)==null?void 0:A.toString())||"";return!b[S]}),[w,b]);function _(O){h(O)}if(s.useEffect(()=>{const O=[];return w.forEach(S=>{var A;if(S.children){const R=S.children.map(M=>{var $,D;return(D=($=M.item)==null?void 0:$.hidden$)!=null?D:B.of(!1)}),k=B.combineLatest(R).subscribe(M=>{const $=M.every(D=>D===!0);d(D=>({...D,[S.key]:$}))});O.push(k)}else if((A=S.item)!=null&&A.hidden$){const R=S.item.hidden$.subscribe(k=>{d(M=>({...M,[S.key]:k}))});O.push(R)}}),()=>{O.forEach(S=>S==null?void 0:S.unsubscribe()),d({})}},[w]),n)return v.jsx(L4,{disabled:i,overlay:r.map((O,S)=>v.jsx(ge,{value:t,option:O,onOptionSelect:l},S)),children:o});if(r!=null&&r.length){const O=r.map(S=>{var A;return{type:"item",className:x.clsx({"focus:univer-bg-white":typeof S.label!="string"&&((A=S.label)==null?void 0:A.hoverable)===!1}),children:v.jsx(ge,{icon:S.icon,value:t,option:S,onOptionSelect:l}),disabled:S.disabled,onSelect:()=>{typeof S.value>"u"||l==null||l({...S})}}});for(const S of I){if(!S.item)continue;const{title:A,id:R,commandId:k,icon:M}=S.item;if(!A)throw new Error("Menu item title is required");O.push({type:"item",children:v.jsx(ge,{icon:M,value:t,option:{label:{name:A,selectable:!1}}}),onSelect:()=>{l==null||l({commandId:k,id:R})}})}return v.jsx(x.DropdownMenu,{align:"start",items:O,disabled:i,open:c,onOpenChange:_,children:o})}else{const O=[];for(const S of I)if(S.item){const{title:A,id:R,commandId:k,icon:M}=S.item;if(!A)throw new Error("Menu item title is required");O.push({type:"item",children:v.jsx(ge,{icon:M,value:t,option:{label:{name:A,selectable:!1}}}),onSelect:()=>{l==null||l({commandId:k,id:R})}})}else(T=S.children)!=null&&T.length;return v.jsx(x.DropdownMenu,{align:"start",items:O,disabled:i,open:c,onOpenChange:_,children:o})}}const Q1=s.forwardRef((e,n)=>{const t=V.useDependency(f.LocaleService),r=V.useDependency(f.ICommandService),o=V.useDependency(M1),i=V.useDependency(v1),{value:l,hidden:c,disabled:h,activated:p}=y6(e),b=(J,X)=>{o.focus(),r.executeCommand(J,X)},{tooltip:d,shortcut:w,icon:I,title:_,label:T,id:O,commandId:S,type:A,slot:R,params:k}=e,M=t.t(d!=null?d:"")+(w?` (${w})`:""),{selections:$}=e,D=s.useMemo(()=>B.isObservable($)?$:new B.Observable(J=>{J.next($)}),[$]),U=V.useObservable(D),W=s.useMemo(()=>B.isObservable(I)?I:new B.Observable(J=>{var n1,s1;const X=(s1=(n1=U==null?void 0:U.find(d1=>d1.value===l))==null?void 0:n1.icon)!=null?s1:I;J.next(X)}),[I,U,l]),Y=V.useObservable(W,void 0,!0);function q(J){var K;const X=e.selectionsCommandId,n1=S!=null?S:O,s1=(K=X!=null?X:S)!=null?K:O;function d1(c1){if(h)return;let L1=s1;c1.id&&(L1=c1.id),b(L1,{value:c1.value})}function b1(c1){h||b(s1,{value:c1})}function l1(){h||J===g1.BUTTON_SELECTOR&&b(n1,{value:l})}return J===g1.BUTTON_SELECTOR?v.jsxs("div",{"data-u-command":O,"data-disabled":h,className:x.clsx("univer-animate-in univer-fade-in univer-group univer-relative univer-flex univer-h-6 univer-cursor-pointer univer-items-center univer-rounded univer-pr-5 univer-text-sm univer-transition-colors hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-700",{"univer-text-gray-900 dark:!univer-text-white":!h,"univer-pointer-events-none univer-cursor-not-allowed univer-text-gray-300 dark:!univer-text-gray-600":h}),children:[v.jsx("div",{className:x.clsx("univer-relative univer-z-[1] univer-flex univer-h-full univer-items-center univer-rounded-l univer-px-1 univer-transition-colors hover:univer-bg-gray-200 dark:hover:!univer-bg-gray-600",{"univer-bg-gray-200 dark:!univer-bg-gray-500":p,"univer-bg-gray-100":p&&h}),onClick:l1,children:v.jsx(f1,{icon:Y,title:_,value:l,label:T,onChange:b1})}),v.jsx(I6,{menuId:O,slot:R,value:l,options:U,disabled:h,onOptionSelect:d1,children:v.jsx("div",{className:x.clsx("univer-absolute univer-right-0 univer-top-0 univer-box-border univer-flex univer-h-6 univer-w-5 univer-items-center univer-justify-center univer-rounded-r univer-transition-colors hover:univer-bg-gray-200 dark:hover:!univer-bg-gray-600",{"univer-pointer-events-none univer-cursor-not-allowed univer-text-gray-300 dark:!univer-text-gray-600":h,"univer-bg-gray-200 dark:!univer-bg-gray-500":p,"univer-bg-gray-100":p&&h}),"data-disabled":h,children:v.jsx(z1,{})})})]}):v.jsx(I6,{menuId:O,slot:R,value:l,options:U,disabled:h,onOptionSelect:d1,children:v.jsxs("div",{"data-u-command":O,className:x.clsx("univer-animate-in univer-fade-in univer-relative univer-flex univer-h-6 univer-cursor-pointer univer-items-center univer-gap-2 univer-whitespace-nowrap univer-rounded univer-px-1 univer-transition-colors hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-700",{"univer-text-gray-900 dark:!univer-text-white":!h,"univer-pointer-events-none univer-cursor-not-allowed univer-text-gray-300 dark:!univer-text-gray-600":h,"univer-bg-gray-200":p,"univer-bg-gray-100":p&&h}),children:[v.jsx(f1,{icon:Y,title:_,value:l,label:T,onChange:b1}),v.jsx("div",{className:x.clsx("univer-flex univer-h-full univer-items-center",{"univer-pointer-events-none univer-cursor-not-allowed univer-text-gray-300 dark:!univer-text-gray-600":h}),children:v.jsx(z1,{})})]})})}function G(){var n1;const J=i.get(typeof T=="string"?T:(n1=T==null?void 0:T.name)!=null?n1:""),X=(l!=null?l:typeof k=="function")?k():k;return v.jsx(w6,{"data-u-command":O,className:"univer-text-sm",noIcon:!I,active:p,disabled:h,onClick:()=>{var s1;return b((s1=e.commandId)!=null?s1:e.id,X)},onDoubleClick:()=>e.subId&&b(e.subId),children:J?v.jsx(f1,{title:_,value:l,label:T}):I?v.jsx(f1,{icon:I}):v.jsx(f1,{title:_})})}function t1(){switch(A){case g1.BUTTON_SELECTOR:case g1.SELECTOR:case g1.SUBITEMS:return q(A);case g1.BUTTON:default:return G()}}return!c&&v.jsx(b4,{ref:n,title:M,placement:"bottom",children:t1()})});function M6(e){const{ribbonType:n,headerMenuComponents:t,headerMenu:r=!0}=e,o=V.useDependency(I1),i=V.useDependency(f.IUniverInstanceService),l=V.useDependency(f.LocaleService),[c,h]=s.useState(0),p=V.useObservable(i.focused$);s.useEffect(()=>{const D=o.menuChanged$.subscribe(()=>{h(U=>U+1)});return()=>{D.unsubscribe()}},[]);const b=s.useRef(null),d=s.useRef({}),[w,I]=s.useState([]),[_,T]=s.useState(C1.START),[O,S]=s.useState([]),[A,R]=s.useState(!1),k=s.useCallback(D=>{d.current={},T(D.key)},[]);s.useEffect(()=>{var Y;const D=o.getMenuByPositionKey(G1.RIBBON),U=[],W=[];for(const q of D)if(q.children){for(const G of q.children)if(G.children)for(const t1 of G.children)(Y=t1.item)!=null&&Y.hidden$&&(U.push(t1.item.hidden$),W.push(`${q.key}/${G.key}/${t1.key}`))}B.combineLatest(U).subscribe(q=>{var J,X,n1,s1,d1,b1;const G=[],t1=q.map((l1,K)=>l1?W[K]:null).filter(l1=>!!l1);for(const l1 of D){const K={...l1,children:[]};if((J=l1.children)!=null&&J.length)for(const c1 of l1.children){const L1={...c1,children:[]};let T1=!0;if((X=c1.children)!=null&&X.length){for(const F1 of c1.children){const k1=`${l1.key}/${c1.key}/${F1.key}`;t1.includes(k1)||(n1=L1.children)==null||n1.push(F1)}(s1=L1.children)!=null&&s1.every(F1=>{var k1;return((k1=F1.children)==null?void 0:k1.length)===0})&&(T1=!1)}T1&&((d1=K.children)==null||d1.push(L1))}(b1=K.children)!=null&&b1.length&&K.children.every(c1=>{var L1;return(L1=c1.children)==null?void 0:L1.length})&&G.push(K)}if(n==="simple"){const l1=[{key:C1.START,children:[],order:0}];G.forEach(K=>{var c1;(c1=K.children)==null||c1.forEach(L1=>{var T1;(T1=l1[0].children)==null||T1.push(L1)})}),I(l1)}else I(G)}).unsubscribe()},[c,p]);const M=s.useMemo(()=>{var Y,q;const D=(q=(Y=w.find(G=>G.key===_))==null?void 0:Y.children)!=null?q:[],U=[],W=[];for(const G of D)if(G.children){const t1=G.children.filter(J=>!O.includes(J.key));t1.length>0&&U.push({...G,children:t1}),t1.length<G.children.length&&W.push({...G,children:G.children.filter(J=>O.includes(J.key))})}return{allGroups:D,visibleGroups:U,hiddenGroups:W}},[O,w,_]);s.useEffect(()=>{let D=null;const U=new ResizeObserver(f.throttle(W=>{for(const Y of W)R(!0),D=requestAnimationFrame(()=>{var d1,b1;const{width:q}=Y.contentRect,t1=Object.values(d.current).sort((l1,K)=>l1.order-K.order||l1.groupOrder-K.groupOrder||l1.itemOrder-K.itemOrder),J=[];let X=32;const s1=(((b1=(d1=w.find(l1=>l1.key===_))==null?void 0:d1.children)!=null?b1:[]).length-1)*8;X+=s1;for(const{el:l1,key:K}of t1){const{width:c1}=l1.getBoundingClientRect();X+=c1+8,X>q&&J.push(K)}S(J),R(!1)})},100));return U.observe(b.current),()=>{D&&cancelAnimationFrame(D),U.disconnect()}},[w,_]);const $=s.useMemo(()=>v.jsx("div",{"aria-hidden":"true",className:x.clsx("univer-invisible univer-absolute -univer-left-[99999] -univer-top-[99999] univer-box-border univer-flex univer-h-10 univer-min-w-min univer-items-center univer-px-3 univer-opacity-0",{"univer-hidden":!A},x.divideXClassName,x.borderBottomClassName),children:M.allGroups.map((D,U)=>{var W,Y;return(((W=D.children)==null?void 0:W.length)||D.item)&&v.jsx(s.Fragment,{children:v.jsx("div",{className:"univer-grid univer-shrink-0 univer-grid-flow-col univer-gap-2 univer-px-2",children:D.children&&((Y=D.children)==null?void 0:Y.map(q=>q.item&&v.jsx(Q1,{...q.item,ref:G=>{G!=null&&G.el&&(d.current[q.key]={el:G.el,key:q.key,order:U,groupOrder:D.order,itemOrder:q.order})}},q.key)))})},D.key)})}),[M.allGroups,A]);return v.jsxs(v.Fragment,{children:[v.jsxs("div",{"data-u-comp":"ribbon-header-menu",className:x.clsx("univer-relative univer-select-none",{"univer-h-9":n==="classic"||t&&t.size>0}),children:[n==="classic"&&w.length>1&&v.jsx(g4,{ribbon:w,activatedTab:_,onSelectTab:k}),r&&t&&t.size>0&&v.jsx("div",{className:"univer-absolute univer-right-2 univer-top-0 univer-flex univer-h-full univer-items-center univer-gap-2 [&>*]:univer-inline-flex [&>*]:univer-h-6 [&>*]:univer-items-center [&>*]:univer-rounded [&>*]:univer-px-1 [&>*]:univer-transition-colors hover:[&>*]:univer-bg-gray-100",children:v.jsx(p1,{components:t})})]}),v.jsxs("div",{className:x.clsx("univer-box-border univer-grid univer-h-10 univer-grid-flow-col univer-items-center univer-px-3",{"univer-grid-cols-[1fr] univer-justify-center":n==="classic","univer-grid-cols-[auto,1fr]":w.length>1&&n!=="classic","univer-grid-cols-none":w.length===1},x.borderBottomClassName),children:[n==="default"&&w.length>1&&v.jsx(m4,{ribbon:w,activatedTab:_,onSelectTab:k}),v.jsxs("div",{"data-u-comp":"ribbon-toolbar",ref:b,className:x.clsx("univer-flex univer-overflow-hidden",x.divideXClassName,{"univer-justify-center":n==="classic"}),role:"toolbar","aria-label":l.t(_),children:[M.visibleGroups.map(D=>{var U,W;return(((U=D.children)==null?void 0:U.length)||D.item)&&v.jsx(s.Fragment,{children:v.jsx("div",{className:"univer-grid univer-shrink-0 univer-grid-flow-col univer-gap-2 univer-px-2",children:D.children&&((W=D.children)==null?void 0:W.map(Y=>Y.item&&v.jsx(Q1,{...Y.item},Y.key)))})},D.key)}),O.length>0&&v.jsx("div",{"data-u-comp":"ribbon-toolbar-more",className:"univer-pl-2 rtl:univer-pr-2",children:v.jsx(x.Dropdown,{collisionPadding:{right:12,left:12},overlay:v.jsx("div",{className:"univer-box-border univer-grid univer-max-w-[var(--radix-popper-available-width)] univer-gap-2 univer-p-2",children:M.hiddenGroups.map(D=>{var U;return v.jsx("div",{className:"univer-flex univer-items-center univer-gap-2",children:v.jsx("div",{className:"univer-flex univer-flex-wrap univer-gap-2",children:D.children?(U=D.children)==null?void 0:U.map(W=>W.item&&v.jsx(Q1,{...W.item},W.key)):D.item&&v.jsx(Q1,{...D.item},D.key)})},D.key)})}),children:v.jsx("button",{type:"button",className:L6,"aria-label":l.t("ribbon.more"),"aria-haspopup":"true",children:v.jsx(Ve,{})})})})]})]}),$]})}class K1 extends f.Disposable{constructor(){super(...arguments);j(this,"_styleSheetId","univer-theme-css-variables")}injectThemeToHead(t){function r(c,h="--univer"){const p=[];function b(d,w=""){for(const I in d){const _=d[I],T=w?`${w}-${I}`:I;typeof _=="object"&&_!==null?b(_,T):p.push(`${h}-${T}: ${_};`)}}return b(c),p.join(`
`)}const o=r(t),i=document.getElementById(this._styleSheetId);i&&i.remove();const l=document.createElement("style");l.setAttribute("id",this._styleSheetId),l.innerHTML=`:root {
${o}
}`,document.head.appendChild(l)}dispose(){super.dispose()}}const ee=f.createIdentifier("ui.contextmenu.service");class Ye extends f.Disposable{constructor(){super(...arguments);j(this,"_currentHandler",null);j(this,"disabled",!1)}get visible(){var t,r;return(r=(t=this._currentHandler)==null?void 0:t.visible)!=null?r:!1}disable(){this.disabled=!0}enable(){this.disabled=!1}triggerContextMenu(t,r){var o;t.stopPropagation(),!this.disabled&&((o=this._currentHandler)==null||o.handleContextMenu(t,r))}hideContextMenu(){var t;(t=this._currentHandler)==null||t.hideContextMenu()}registerContextMenuHandler(t){if(this._currentHandler)throw new Error("There is already a context menu handler!");return this._currentHandler=t,f.toDisposable(()=>this._currentHandler=null)}}function _6(){const e=s.useRef(null),[n,t]=s.useState(!1),[r,o]=s.useState(""),[i,l]=s.useState([0,0]),c=s.useRef(n),h=V.useDependency(ee),p=V.useDependency(f.ICommandService),b=V.useInjector();c.current=n,s.useEffect(()=>{const I=h.registerContextMenuHandler({handleContextMenu:d,hideContextMenu(){t(!1)},get visible(){return c.current}});function _(T){e.current&&!e.current.contains(T.target)&&w()}return document.addEventListener("pointerdown",_),document.addEventListener("wheel",w),()=>{document.removeEventListener("pointerdown",_),document.removeEventListener("wheel",w),I.dispose()}},[h]);function d(I,_){t(!1),requestAnimationFrame(()=>{o(_),l([I.clientX,I.clientY]),t(!0)})}function w(){t(!1)}return v.jsx(x.Popup,{visible:n,offset:i,children:v.jsx("section",{ref:e,children:r&&v.jsx(Ae,{menuType:r,onOptionSelect:I=>{const{label:_,commandId:T,value:O}=I;p&&p.executeCommand(T!=null?T:_,{value:O}),b.get(M1).focus(),t(!1)}})})})}const pe=f.createIdentifier("univer.global-zone-service");function Xe(){const e=V.useDependency(pe),[n,t]=s.useState(!1),r=V.useObservable(e.componentKey$,e.componentKey),o=V.useDependency(v1),i=s.useMemo(()=>{const l=o.get(r!=null?r:"");if(l)return l},[r,o]);return s.useEffect(()=>{const l=e.visible$.subscribe(c=>{t(c)});return()=>{l.unsubscribe()}},[e.visible$]),n?v.jsx("section",{className:x.clsx("univer-absolute univer-bg-gray-100",{"univer-hidden":!n,"univer-inset-0 univer-z-[100] univer-block univer-size-full":n}),children:i&&v.jsx(i,{})}):null}function qe(){const e=V.useDependency(x1),n=V.useObservable(e.sidebarOptions$),t=s.useRef(null),r=s.useMemo(()=>{if(!n)return null;const l={...n};for(const c of["children","header","footer"]){const h=c;if(n[h]){const{key:p,...b}=n[h];b&&(l[h]=v.jsx(f1,{...b},p))}}return l},[n]);s.useEffect(()=>(t.current&&e.setContainer(t.current),()=>{e.setContainer(void 0)}),[e]),s.useEffect(()=>{const l=h=>{e.scrollEvent$.next(h)},c=t.current;return c&&c.addEventListener("scroll",l),()=>{c==null||c.removeEventListener("scroll",l)}},[e]);const o=s.useMemo(()=>r!=null&&r.visible?typeof r.width=="number"?`${r.width}px`:r.width:0,[r]);function i(){var c;const l={...n,visible:!1};e.options.visible=!1,e.sidebarOptions$.next(l),(c=l==null?void 0:l.onClose)==null||c.call(l)}return v.jsx("section",{"data-u-comp":"sidebar",className:x.clsx("univer-relative univer-h-full univer-bg-white univer-text-gray-900 dark:!univer-bg-gray-900 dark:!univer-text-white",{"univer-w-96 univer-translate-x-0":r==null?void 0:r.visible,"univer-w-0 univer-translate-x-full":!(r!=null&&r.visible)}),style:{width:o},children:v.jsxs("section",{ref:t,className:x.clsx("univer-box-border univer-grid univer-h-0 univer-min-h-full univer-grid-rows-[auto_1fr_auto] univer-overflow-y-auto",x.borderLeftBottomClassName,x.scrollbarClassName),children:[v.jsxs("header",{className:"univer-sticky univer-top-0 univer-z-10 univer-box-border univer-flex univer-items-center univer-justify-between univer-bg-white univer-p-4 univer-pb-2 univer-text-base univer-font-medium univer-text-gray-800 dark:!univer-bg-gray-900 dark:!univer-text-white",children:[r==null?void 0:r.header,v.jsx("a",{className:"univer-cursor-pointer univer-text-gray-500 dark:!univer-text-gray-300",onClick:i,children:v.jsx(Oe,{})})]}),v.jsx("section",{className:"univer-box-border univer-px-4",style:r==null?void 0:r.bodyStyle,children:r==null?void 0:r.children}),(r==null?void 0:r.footer)&&v.jsx("footer",{className:"univer-sticky univer-bottom-0 univer-box-border univer-bg-white univer-p-4 dark:!univer-bg-gray-900",children:r.footer})]})})}const me=f.createIdentifier("univer.zen-zone-service");function Je(){const e=V.useDependency(me),[n,t]=s.useState(!1),[r,o]=s.useState(),i=V.useObservable(e.temporaryHidden$),l=V.useDependency(v1);s.useEffect(()=>{const h=[e.visible$.subscribe(p=>{t(p)}),e.componentKey$.subscribe(p=>{o(p)})];return()=>{h.forEach(p=>{p.unsubscribe()})}},[]);const c=s.useMemo(()=>{const h=l.get(r!=null?r:"");if(h)return h},[r]);return v.jsx("section",{className:x.clsx("univer-absolute univer-z-[-1] univer-flex",{"univer-animate-in univer-fade-in univer-inset-0 univer-z-[100] univer-bg-gray-100":n,"univer-hidden":i}),children:v.jsx("div",{className:"univer-relative univer-flex-1",children:c&&v.jsx(c,{})})})}function w4(e){const n=F9(V1);return v.jsx(y4,{...e,...n})}function y4(e){var t1;const{header:n=!0,toolbar:t=!0,footer:r=!0,headerMenu:o=!0,contextMenu:i=!0,ribbonType:l="default",mountContainer:c,onRendered:h}=e,p=V.useDependency(f.LocaleService),b=V.useDependency(f.ThemeService),d=V.useDependency(K1),w=s.useRef(null),_=V.useDependency(f.IConfigService).getConfig(V1),T=m1(i1.CUSTOM_HEADER),O=m1(i1.FOOTER),S=m1(i1.HEADER),A=m1(i1.HEADER_MENU),R=m1(i1.CONTENT),k=m1(i1.LEFT_SIDEBAR),M=m1(i1.GLOBAL),$=m1(i1.TOOLBAR),D=(t1=_==null?void 0:_.popupRootId)!=null?t1:"univer-popup-portal";s.useLayoutEffect(()=>{const J=b.currentTheme$.subscribe(X=>{d.injectThemeToHead(X)});return()=>{J.unsubscribe()}},[]);const[U,W]=s.useState(!1);s.useLayoutEffect(()=>{const J=b.darkMode$.subscribe(X=>{W(X),X?document.documentElement.classList.add("univer-dark"):document.documentElement.classList.remove("univer-dark")});return()=>{J.unsubscribe()}},[]),s.useEffect(()=>{w.current&&(h==null||h(w.current))},[h]);const[Y,q]=s.useState(p.getLocales()),G=s.useMemo(()=>document.createElement("div"),[]);return s.useEffect(()=>{document.body.appendChild(G);const J=[p.localeChanged$.subscribe(()=>{q(p.getLocales())})];return()=>{J.forEach(X=>X.unsubscribe()),document.body.removeChild(G)}},[p,c,G]),v.jsxs(x.ConfigProvider,{locale:Y==null?void 0:Y.design,mountContainer:G,children:[v.jsxs("div",{"data-u-comp":"workbench-layout",className:x.clsx("univer-flex univer-h-full univer-min-h-0 univer-flex-col univer-bg-white dark:!univer-bg-gray-800",{"univer-dark":U}),tabIndex:-1,onBlur:J=>J.stopPropagation(),onContextMenu:J=>J.preventDefault(),children:[v.jsx("div",{className:"univer-relative univer-flex univer-min-h-0 univer-flex-col univer-bg-white dark:!univer-bg-gray-800",children:v.jsx(p1,{components:T},"custom-header")}),n&&t&&v.jsx("header",{"data-u-comp":"headerbar",className:"univer-relative univer-z-10 univer-w-full univer-overflow-hidden",children:v.jsx(p1,{components:$,sharedProps:{ribbonType:l,headerMenuComponents:A,headerMenu:o}},"toolbar")}),v.jsxs("section",{className:"univer-relative univer-flex univer-min-h-0 univer-flex-1 univer-flex-col",children:[v.jsxs("div",{className:"univer-grid univer-h-full univer-grid-cols-[auto_1fr_auto] univer-grid-rows-[100%] univer-overflow-hidden",children:[v.jsx("aside",{"data-u-comp":"left-sidebar",className:"univer-h-full",children:v.jsx(p1,{components:k},"left-sidebar")}),v.jsxs("section",{className:x.clsx("univer-relative univer-grid univer-flex-1 univer-grid-rows-[auto_1fr] univer-overflow-hidden univer-bg-white dark:!univer-bg-gray-800",x.borderBottomClassName),children:[v.jsx("header",{children:n&&v.jsx(p1,{components:S},"header")}),v.jsx("section",{className:"univer-relative univer-overflow-hidden dark:!univer-bg-gray-900",ref:w,"data-range-selector":!0,onContextMenu:J=>J.preventDefault(),children:v.jsx(p1,{components:R},"content")})]}),v.jsx("aside",{"data-u-comp":"right-sidebar",className:"univer-h-full",children:v.jsx(qe,{})})]}),r&&v.jsx("footer",{children:v.jsx(p1,{components:O,sharedProps:{contextMenu:i}},"footer")}),v.jsx(Je,{})]})]}),v.jsx(p1,{components:M},"global"),v.jsx(Xe,{}),i&&v.jsx(_6,{}),v.jsx(I4,{}),v.jsx("div",{id:D})]})}function I4(){const{mountContainer:e}=s.useContext(x.ConfigContext),n=m1(i1.FLOATING);return S3.createPortal(v.jsx(p1,{components:n},"floating"),e)}const M4=3e3;class Qe extends f.Disposable{constructor(t,r,o,i,l){super();j(this,"_steadyTimeout");j(this,"_renderTimeout");j(this,"_currentRenderId",null);this._injector=t,this._instanceService=r,this._layoutService=o,this._lifecycleService=i,this._renderManagerService=l}dispose(){super.dispose(),clearTimeout(this._steadyTimeout),clearTimeout(this._renderTimeout),delete this._instanceService,delete this._layoutService,delete this._lifecycleService,delete this._renderManagerService}_bootstrapWorkbench(){this.disposeWithMe(this.bootstrap(async(t,r)=>{this._layoutService&&(this.disposeWithMe(this._layoutService.registerRootContainerElement(r)),this.disposeWithMe(this._layoutService.registerContentElement(t)));try{await this._lifecycleService.onStage(f.LifecycleStages.Ready),this._renderTimeout=window.setTimeout(()=>{const o=this._renderManagerService.getRenderAll();for(const[i]of o)if(this._changeRenderUnit(i,t))break;this.disposeWithMe(this._instanceService.focused$.subscribe(i=>{i&&this._changeRenderUnit(i,t)})),this.disposeWithMe(this._renderManagerService.created$.subscribe(i=>{var l;i.unitId===((l=this._instanceService.getFocusedUnit())==null?void 0:l.getUnitId())&&this._changeRenderUnit(i.unitId,t)})),this.disposeWithMe(this._renderManagerService.disposed$.subscribe(i=>{this._currentRenderId===i&&(this._currentRenderId=null)})),this._lifecycleService.stage=f.LifecycleStages.Rendered,this._steadyTimeout=window.setTimeout(()=>{this._lifecycleService.stage=f.LifecycleStages.Steady},M4)},300)}catch(o){if(o instanceof f.LifecycleUnreachableError)return;throw o}}))}_changeRenderUnit(t,r){if(this._currentRenderId===t)return!1;const o=this._renderManagerService.getRenderById(t);if(!o||!o.unitId||f.isInternalEditorID(o.unitId))return!1;const i=this._currentRenderId?this._renderManagerService.getRenderById(this._currentRenderId):null;return i==null||i.deactivate(),i==null||i.engine.unmount(),o.engine.mount(r),o.activate(),this._currentRenderId=t,!0}}var _4=Object.getOwnPropertyDescriptor,S4=(e,n,t,r)=>{for(var o=r>1?void 0:r?_4(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},E1=(e,n)=>(t,r)=>n(t,r,e);C.DesktopUIController=class extends Qe{constructor(n,t,r,o,i,l,c,h,p){super(t,l,i,r,o),this._config=n,this._componentManager=p,c.mergeMenu(i6),this._initBuiltinComponents(h),this._registerComponents(),this._bootstrapWorkbench()}_registerComponents(){[[$9,x9],[A9,Z9],[z9,B9],[W9,j9],[Y9,G9],[k9,x.ColorPicker]].forEach(([n,t])=>{this.disposeWithMe(this._componentManager.register(n,t))})}dispose(){super.dispose(),this._componentManager.dispose()}bootstrap(n){return H4(this._injector,this._config,n)}_initBuiltinComponents(n){this.disposeWithMe(n.registerComponent(i1.FLOATING,()=>V.connectInjector(We,this._injector))),this.disposeWithMe(n.registerComponent(i1.CONTENT,()=>V.connectInjector(je,this._injector))),this.disposeWithMe(n.registerComponent(i1.TOOLBAR,()=>V.connectInjector(M6,this._injector)))}},C.DesktopUIController=S4([E1(1,f.Inject(f.Injector)),E1(2,f.Inject(f.LifecycleService)),E1(3,U1.IRenderManagerService),E1(4,M1),E1(5,f.IUniverInstanceService),E1(6,I1),E1(7,w1),E1(8,f.Inject(v1))],C.DesktopUIController);function H4(e,n,t){let r;const o=n.container;if(typeof o=="string"){const h=document.getElementById(o);h?r=h:r=S6(o)}else o instanceof HTMLElement?r=o:r=S6("univer");const i=V.connectInjector(w4,e),l=h=>t(h,r);function c(){x.render(v.jsx(i,{...n,mountContainer:r,onRendered:l}),r)}return c(),f.toDisposable(()=>{x.render(v.jsx("div",{}),r),setTimeout(()=>x.render(v.jsx("div",{}),r),200),setTimeout(()=>x.unmount(r),500)})}function S6(e){const n=document.createElement("div");return n.id=e,n}const te=f.createIdentifier("univer.ui.ui-controller");function E4(e){const{menuType:n,onOptionSelect:t}=e,r=V.useDependency(I1);if(!n)return null;const o=s.useMemo(()=>{const i=r.getMenuByPositionKey(n);function l(c){return c.reduce((h,p)=>p.children?[...h,...l(p.children)]:[...h,p],[])}return l(i)},[n]);return v.jsx("div",{className:"univer-box-border univer-grid univer-min-w-8 univer-max-w-52 univer-gap-1 univer-rounded univer-bg-gray-900 univer-px-2 univer-py-1",style:{gridTemplateColumns:`repeat(${Math.min(2,o.length)},  72px)`},children:o.map(i=>i.item&&v.jsx(D4,{menuItem:i.item,onClick:l=>t==null?void 0:t({value:"",label:i.key,...l})},i.key))})}function D4(e){const{menuItem:n,onClick:t}=e,{id:r,type:o,title:i,label:l,icon:c}=n;if(o!==g1.BUTTON)throw new Error(`[MobileMenuItem]: on mobile devices only "BUTTON" type menu items are supported. Please check "${r}".`);const h=V.useObservable(n.disabled$,!1),p=V.useObservable(n.value$);return v.jsx("button",{type:"button",className:x.clsx("univer-w-18 univer-flex univer-flex-col univer-items-center univer-justify-center univer-border-none univer-bg-transparent univer-text-white [&>span]:univer-mt-0.5 [&>span]:univer-w-full [&>span]:univer-truncate [&>span]:univer-text-sm [&>svg]:univer-size-[18px] [&>svg]:univer-text-lg"),disabled:h,onClick:()=>t({id:r}),children:v.jsx(f1,{value:p,title:i,label:l,icon:c})},r)}function H6(){const[e,n]=s.useState(!1),[t,r]=s.useState(""),[o,i]=s.useState([0,0]),l=s.useRef(e),c=V.useDependency(ee),h=V.useDependency(f.ICommandService);l.current=e,s.useEffect(()=>{const d=c.registerContextMenuHandler({handleContextMenu:p,hideContextMenu(){n(!1)},get visible(){return l.current}});return document.addEventListener("pointerdown",b),document.addEventListener("wheel",b),()=>{document.removeEventListener("pointerdown",b),document.removeEventListener("wheel",b),d.dispose()}},[c]);function p(d,w){r(w),i([d.clientX,d.clientY]),n(!0)}function b(){n(!1)}return v.jsx(x.Popup,{visible:e,offset:o,children:v.jsx("section",{onPointerDown:d=>d.stopPropagation(),children:t&&v.jsx(E4,{menuType:t,onOptionSelect:d=>{const{label:w,value:I,commandId:_}=d;h&&h.executeCommand(_!=null?_:w,{value:I}),n(!1)}})})})}function O4(e){const{header:n=!0,footer:t=!0,contextMenu:r=!0,mountContainer:o,onRendered:i}=e,l=V.useDependency(f.LocaleService),c=V.useDependency(f.ThemeService),h=V.useDependency(K1),p=s.useRef(null),b=m1(i1.FOOTER),d=m1(i1.HEADER),w=m1(i1.CONTENT),I=m1(i1.LEFT_SIDEBAR),_=m1(i1.GLOBAL),[T,O]=s.useState(!1);s.useEffect(()=>{const k=c.darkMode$.subscribe(M=>{O(M)});return()=>{k.unsubscribe()}},[]),s.useEffect(()=>{p.current&&(i==null||i(p.current))},[i]);const[S,A]=s.useState(l.getLocales()),R=s.useMemo(()=>document.createElement("div"),[]);return s.useLayoutEffect(()=>{const k=c.currentTheme$.subscribe(M=>{h.injectThemeToHead(M)});return()=>{k.unsubscribe()}},[]),s.useEffect(()=>{document.body.appendChild(R);const k=[l.localeChanged$.subscribe(()=>{A(l.getLocales())})];return()=>{k.forEach(M=>M.unsubscribe()),document.body.removeChild(R)}},[l,o,R]),v.jsxs(x.ConfigProvider,{locale:S==null?void 0:S.design,mountContainer:R,children:[v.jsxs("div",{"data-u-comp":"app-layout",className:x.clsx("univer-relative univer-flex univer-h-full univer-min-h-0 univer-flex-col univer-bg-white dark:!univer-bg-gray-800",{"univer-dark":T}),tabIndex:-1,onBlur:k=>k.stopPropagation(),children:[n&&v.jsx("header",{className:"univer-relative univer-z-10 univer-w-full"}),v.jsxs("section",{className:"univer-relative univer-flex univer-min-h-0 univer-flex-1 univer-flex-col",children:[v.jsxs("div",{className:"univer-grid univer-h-full univer-grid-cols-[auto_1fr_auto] univer-grid-rows-[100%] univer-overflow-hidden",children:[v.jsx("aside",{className:"univer-h-full",children:v.jsx(p1,{components:I},"left-sidebar")}),v.jsxs("section",{className:x.clsx("univer-relative univer-grid univer-flex-1 univer-grid-rows-[auto_1fr] univer-overflow-hidden univer-bg-white dark:!univer-bg-gray-800",x.borderBottomClassName),children:[v.jsx("header",{className:"univer-w-screen",children:n&&v.jsx(p1,{components:d},"header")}),v.jsx("section",{ref:p,className:"univer-relative univer-overflow-hidden","data-range-selector":!0,onContextMenu:k=>k.preventDefault(),children:v.jsx(p1,{components:w},"content")})]}),v.jsx("aside",{className:"univer-h-full",children:v.jsx(qe,{})})]}),t&&v.jsx("footer",{children:v.jsx(p1,{components:b},"footer")}),v.jsx(Xe,{}),v.jsx(Je,{})]})]}),v.jsx(p1,{components:_},"global"),r&&v.jsx(H6,{})]})}var R4=Object.getOwnPropertyDescriptor,V4=(e,n,t,r)=>{for(var o=r>1?void 0:r?R4(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},P1=(e,n)=>(t,r)=>n(t,r,e);let Ke=class extends Qe{constructor(e,n,t,r,o,i,l){super(n,i,o,t,r),this._config=e,this._initBuiltinComponents(l),this._bootstrapWorkbench()}bootstrap(e){return N4(this._injector,this._config,e)}_initBuiltinComponents(e){this.disposeWithMe(e.registerComponent(i1.CONTENT,()=>V.connectInjector(We,this._injector))),this.disposeWithMe(e.registerComponent(i1.CONTENT,()=>V.connectInjector(je,this._injector)))}};Ke=V4([P1(1,f.Inject(f.Injector)),P1(2,f.Inject(f.LifecycleService)),P1(3,U1.IRenderManagerService),P1(4,M1),P1(5,f.IUniverInstanceService),P1(6,w1)],Ke);function N4(e,n,t){let r;const o=n.container;if(typeof o=="string"){const h=document.getElementById(o);h?r=h:r=E6(o)}else o instanceof HTMLElement?r=o:r=E6("univer");const i=V.connectInjector(O4,e),l=h=>t(h,r);function c(){x.render(v.jsx(i,{...n,mountContainer:r,onRendered:l}),r)}return c(),f.toDisposable(()=>{x.unmount(r)})}function E6(e){const n=document.createElement("div");return n.id=e,n}const ne=f.createIdentifier("ui.notification.service");var T4=Object.getOwnPropertyDescriptor,x4=(e,n,t,r)=>{for(var o=r>1?void 0:r?T4(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},$4=(e,n)=>(t,r)=>n(t,r,e);const e3=f.createIdentifier("univer.ui.before-close-service");C.DesktopBeforeCloseService=class{constructor(n){j(this,"_beforeUnloadCallbacks",[]);j(this,"_onCloseCallbacks",[]);this._notificationService=n,this._init()}registerBeforeClose(n){return this._beforeUnloadCallbacks.push(n),{dispose:()=>{this._beforeUnloadCallbacks=this._beforeUnloadCallbacks.filter(t=>t!==n)}}}registerOnClose(n){return this._onCloseCallbacks.push(n),{dispose:()=>{this._onCloseCallbacks=this._onCloseCallbacks.filter(t=>t!==n)}}}_init(){window.addEventListener("beforeunload",n=>{let t=n;const r=this._beforeUnloadCallbacks.map(o=>o()).filter(o=>!!o).join(`
`);if(r)return this._notificationService.show({type:"error",title:"Some changes are not saved",content:r}),typeof t>"u"&&(t=window.event),t.returnValue=r,r}),window.addEventListener("unload",()=>{this._onCloseCallbacks.forEach(n=>n())})}},C.DesktopBeforeCloseService=x4([$4(0,ne)],C.DesktopBeforeCloseService);function D6(){return typeof navigator.clipboard<"u"&&typeof navigator.clipboard.readText<"u"}var Z4=Object.getOwnPropertyDescriptor,A4=(e,n,t,r)=>{for(var o=r>1?void 0:r?Z4(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},t3=(e,n)=>(t,r)=>n(t,r,e);const n3="text/plain",r3="text/html",O6="image/png",R6="image/jpeg",V6="image/bmp",N6="image/webp",P4="image/svg+xml",F4=new Set([V6,R6,N6,O6]),o3=f.createIdentifier("univer.clipboard-interface-service");C.BrowserClipboardService=class extends f.Disposable{constructor(n,t,r){super(),this._localeService=n,this._logService=t,this._notificationService=r}get supportClipboard(){return D6()}async write(n,t){if(!this.supportClipboard)return this._legacyCopyHtml(t);try{return await navigator.clipboard.write([new ClipboardItem({[n3]:new Blob([n],{type:n3}),[r3]:new Blob([t],{type:r3})})])}catch(r){this._logService.error("[BrowserClipboardService]",r),this._showClipboardAuthenticationNotification()}}async writeText(n){if(!this.supportClipboard)return this._legacyCopyText(n);try{return await navigator.clipboard.writeText(n)}catch(t){this._logService.error("[BrowserClipboardService]",t),this._showClipboardAuthenticationNotification()}}async read(){if(!this.supportClipboard)throw new Error("[BrowserClipboardService] read() is not supported on this platform.");try{return navigator.clipboard.read()}catch(n){return this._logService.error("[BrowserClipboardService]",n),this._showClipboardAuthenticationNotification(),[]}}async readText(){if(!this.supportClipboard)throw new Error("[BrowserClipboardService] read() is not supported on this platform.");try{return await navigator.clipboard.readText()}catch(n){return this._logService.error("[BrowserClipboardService]",n),this._showClipboardAuthenticationNotification(),""}}_legacyCopyHtml(n){const t=document.activeElement,r=B4();document.body.appendChild(r),r.innerHTML=n;try{T6(r),document.execCommand("copy")}finally{t instanceof HTMLElement&&t.focus(),document.body.removeChild(r)}}_legacyCopyText(n){const t=document.activeElement,r=k4();document.body.appendChild(r),r.value=n;try{T6(r),document.execCommand("copy")}finally{t instanceof HTMLElement&&t.focus(),document.body.removeChild(r)}}_showClipboardAuthenticationNotification(){var n;(n=this._notificationService)==null||n.show({type:"warning",title:this._localeService.t("clipboard.authentication.title"),content:this._localeService.t("clipboard.authentication.content")})}},C.BrowserClipboardService=A4([t3(0,f.Inject(f.LocaleService)),t3(1,f.ILogService),t3(2,f.Optional(ne))],C.BrowserClipboardService);function k4(){const e=document.createElement("textarea");return e.style.position="absolute",e.style.height="1px",e.style.width="1px",e.style.opacity="0",e.readOnly=!0,e}function B4(){const e=document.createElement("div");return e.contentEditable="true",e.style.position="absolute",e.style.opacity="0",e.style.height="1px",e.style.width="1px",e}function T6(e){if(e instanceof HTMLTextAreaElement){const r=e.hasAttribute("readonly");return r||e.setAttribute("readonly",""),e.select(),e.setSelectionRange(0,e.value.length),r||e.removeAttribute("readonly"),e.value}e.hasAttribute("contenteditable")&&e.focus();const n=document.createRange();n.selectNodeContents(e);const t=window.getSelection();if(!t)throw new Error;return t.removeAllRanges(),t.addRange(n),t.toString()}const be=f.createIdentifier("univer.confirm-service");class U4{constructor(){j(this,"confirmOptions$",new B.Subject)}dispose(){this.confirmOptions$.complete()}open(n){throw new Error("This is not implemented in the test service!")}confirm(n){return Promise.resolve(!0)}close(n){throw new Error("This is not implemented in the test service!")}}const j4=e=>{const{children:n,onClose:t,onConfirm:r}=e,[o]=s.useState({}),i=n?s.cloneElement(n,{hooks:o}):null;return v.jsx(x.Confirm,{...e,children:i,onClose:()=>{const l=o.beforeClose;if(l){const c=l();if(c.cancel)return;t==null||t(c);return}t==null||t()},onConfirm:()=>{const l=o.beforeConfirm;if(l){const c=l();if(c.cancel)return;r==null||r(c);return}r==null||r()}})};function z4(){const e=V.useDependency(be),[n,t]=s.useState([]);s.useEffect(()=>{const o=e.confirmOptions$.subscribe(i=>{t(i)});return()=>{o.unsubscribe()}},[]);const r=n.map(o=>{const{children:i,title:l,...c}=o,h=c;for(const p of["children","title"]){const b=p,d=o[b];d&&(h[b]=v.jsx(f1,{...d}))}return h});return r==null?void 0:r.map((o,i)=>v.jsx(j4,{...o,children:o.children},i))}var W4=Object.getOwnPropertyDescriptor,G4=(e,n,t,r)=>{for(var o=r>1?void 0:r?W4(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},x6=(e,n)=>(t,r)=>n(t,r,e);C.DesktopConfirmService=class extends f.Disposable{constructor(t,r){super();j(this,"_confirmOptions",[]);j(this,"confirmOptions$",new B.BehaviorSubject([]));this._injector=t,this._uiPartsService=r,this._initUIPart()}open(t){return this._confirmOptions.find(r=>r.id===t.id)?this._confirmOptions=this._confirmOptions.map(r=>({...r.id===t.id?t:r,visible:r.id===t.id?!0:r.visible})):this._confirmOptions.push({...t,visible:!0}),this.confirmOptions$.next(this._confirmOptions),f.toDisposable(()=>{this._confirmOptions=[],this.confirmOptions$.next([])})}confirm(t){return new Promise(r=>{const o=this.open({...t,onConfirm:()=>{o.dispose(),r(!0)},onClose:()=>{o.dispose(),r(!1)}})})}close(t){this._confirmOptions=this._confirmOptions.map(r=>({...r,visible:r.id===t?!1:r.visible})),this.confirmOptions$.next([...this._confirmOptions])}_initUIPart(){this.disposeWithMe(this._uiPartsService.registerComponent(i1.GLOBAL,()=>V.connectInjector(z4,this._injector)))}},C.DesktopConfirmService=G4([x6(0,f.Inject(f.Injector)),x6(1,w1)],C.DesktopConfirmService);const Le=f.createIdentifier("univer.ui.dialog-service");function Y4(){const e=V.useDependency(Le),[n,t]=s.useState([]);s.useEffect(()=>{const i=e.getDialogs$().subscribe(l=>{t(l)});return()=>i.unsubscribe()},[]);const r=s.useMemo(()=>n.map(o=>{const{children:i,title:l,footer:c,...h}=o,p=h;for(const b of["children","title","footer"]){const d=b,w=o[d];w&&(p[d]=v.jsx(f1,{...w}))}return p}),[n]);return r==null?void 0:r.map(o=>v.jsx(x.Dialog,{...o},o.id))}var X4=Object.getOwnPropertyDescriptor,q4=(e,n,t,r)=>{for(var o=r>1?void 0:r?X4(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},$6=(e,n)=>(t,r)=>n(t,r,e);C.DesktopDialogService=class extends f.Disposable{constructor(t,r){super();j(this,"_dialogOptions",[]);j(this,"_dialogOptions$",new B.Subject);this._injector=t,this._uiPartsService=r,this._initUIPart()}dispose(){super.dispose(),this._dialogOptions=[],this._dialogOptions$.complete()}open(t){return this._dialogOptions.find(r=>r.id===t.id)?this._dialogOptions=this._dialogOptions.map(r=>({...r.id===t.id?t:r,open:r.id===t.id?!0:r.open})):this._dialogOptions.push({...t,open:!0}),this._dialogOptions$.next(this._dialogOptions),f.toDisposable(()=>{this._dialogOptions=[],this._dialogOptions$.next([])})}close(t){this._dialogOptions=this._dialogOptions.map(r=>({...r,open:r.id===t?!1:r.open})),this._dialogOptions$.next([...this._dialogOptions])}closeAll(t){const r=new Set(t);this._dialogOptions=this._dialogOptions.map(o=>({...o,open:r.has(o.id)?o.open:!1})),this._dialogOptions$.next([...this._dialogOptions])}getDialogs$(){return this._dialogOptions$.asObservable()}_initUIPart(){this.disposeWithMe(this._uiPartsService.registerComponent(i1.GLOBAL,()=>V.connectInjector(Y4,this._injector)))}},C.DesktopDialogService=q4([$6(0,f.Inject(f.Injector)),$6(1,w1)],C.DesktopDialogService);const we=f.createIdentifier("univer.ui.gallery-service");function J4(){const e=V.useDependency(we),n=V.useObservable(e.gallery$);return n?v.jsx(x.Gallery,{...n}):null}var Q4=Object.getOwnPropertyDescriptor,K4=(e,n,t,r)=>{for(var o=r>1?void 0:r?Q4(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},Z6=(e,n)=>(t,r)=>n(t,r,e);C.DesktopGalleryService=class extends f.Disposable{constructor(t,r){super();j(this,"gallery$",new B.Subject);this._injector=t,this._uiPartsService=r,this._initUIPart()}dispose(){super.dispose()}open(t){return this.gallery$.next({open:!0,...t}),f.toDisposable(()=>{this.gallery$.complete()})}close(){this.gallery$.next({open:!1,images:[]})}_initUIPart(){this.disposeWithMe(this._uiPartsService.registerComponent(i1.GLOBAL,()=>V.connectInjector(J4,this._injector)))}},C.DesktopGalleryService=K4([Z6(0,f.Inject(f.Injector)),Z6(1,w1)],C.DesktopGalleryService);var e0=Object.getOwnPropertyDescriptor,t0=(e,n,t,r)=>{for(var o=r>1?void 0:r?e0(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},n0=(e,n)=>(t,r)=>n(t,r,e);C.DesktopGlobalZoneService=class{constructor(n){j(this,"visible$",new B.Subject);j(this,"componentKey$",new B.Subject);j(this,"_componentKey","");this._componentManager=n}get componentKey(){return this._componentKey}set(n,t){return this._componentManager.register(n,t),this.componentKey$.next(n),this._componentKey=n,f.toDisposable(()=>{this._componentManager.delete(n),this.visible$.complete(),this.componentKey$.complete()})}open(){this.visible$.next(!0)}close(){this.visible$.next(!1)}},C.DesktopGlobalZoneService=t0([n0(0,f.Inject(v1))],C.DesktopGlobalZoneService);class i3 extends f.Disposable{openFile(n){return new Promise(t=>{var o,i;const r=document.createElement("input");r.type="file",r.accept=(o=n==null?void 0:n.accept)!=null?o:"",r.multiple=(i=n==null?void 0:n.multiple)!=null?i:!1,r.onchange=l=>{const c=l.target.files;c&&t(Array.from(c))},r.click()})}downloadFile(n,t){const r=document.createElement("a");r.download=t,r.href=window.URL.createObjectURL(n),r.click()}}const l3=f.createIdentifier("univer-ui.local-file.service");var ye=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function r0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Ie(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var s3={exports:{}};var A6;function o0(){return A6||(A6=1,(function(e,n){(function(t){e.exports=t()})(function(){return(function t(r,o,i){function l(p,b){if(!o[p]){if(!r[p]){var d=typeof Ie=="function"&&Ie;if(!b&&d)return d(p,!0);if(c)return c(p,!0);var w=new Error("Cannot find module '"+p+"'");throw w.code="MODULE_NOT_FOUND",w}var I=o[p]={exports:{}};r[p][0].call(I.exports,function(_){var T=r[p][1][_];return l(T||_)},I,I.exports,t,r,o,i)}return o[p].exports}for(var c=typeof Ie=="function"&&Ie,h=0;h<i.length;h++)l(i[h]);return l})({1:[function(t,r,o){(function(i){var l=i.MutationObserver||i.WebKitMutationObserver,c;if(l){var h=0,p=new l(_),b=i.document.createTextNode("");p.observe(b,{characterData:!0}),c=function(){b.data=h=++h%2}}else if(!i.setImmediate&&typeof i.MessageChannel<"u"){var d=new i.MessageChannel;d.port1.onmessage=_,c=function(){d.port2.postMessage(0)}}else"document"in i&&"onreadystatechange"in i.document.createElement("script")?c=function(){var O=i.document.createElement("script");O.onreadystatechange=function(){_(),O.onreadystatechange=null,O.parentNode.removeChild(O),O=null},i.document.documentElement.appendChild(O)}:c=function(){setTimeout(_,0)};var w,I=[];function _(){w=!0;for(var O,S,A=I.length;A;){for(S=I,I=[],O=-1;++O<A;)S[O]();A=I.length}w=!1}r.exports=T;function T(O){I.push(O)===1&&!w&&c()}}).call(this,typeof ye<"u"?ye:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(t,r,o){var i=t(1);function l(){}var c={},h=["REJECTED"],p=["FULFILLED"],b=["PENDING"];r.exports=d;function d(M){if(typeof M!="function")throw new TypeError("resolver must be a function");this.state=b,this.queue=[],this.outcome=void 0,M!==l&&T(this,M)}d.prototype.catch=function(M){return this.then(null,M)},d.prototype.then=function(M,$){if(typeof M!="function"&&this.state===p||typeof $!="function"&&this.state===h)return this;var D=new this.constructor(l);if(this.state!==b){var U=this.state===p?M:$;I(D,U,this.outcome)}else this.queue.push(new w(D,M,$));return D};function w(M,$,D){this.promise=M,typeof $=="function"&&(this.onFulfilled=$,this.callFulfilled=this.otherCallFulfilled),typeof D=="function"&&(this.onRejected=D,this.callRejected=this.otherCallRejected)}w.prototype.callFulfilled=function(M){c.resolve(this.promise,M)},w.prototype.otherCallFulfilled=function(M){I(this.promise,this.onFulfilled,M)},w.prototype.callRejected=function(M){c.reject(this.promise,M)},w.prototype.otherCallRejected=function(M){I(this.promise,this.onRejected,M)};function I(M,$,D){i(function(){var U;try{U=$(D)}catch(W){return c.reject(M,W)}U===M?c.reject(M,new TypeError("Cannot resolve promise with itself")):c.resolve(M,U)})}c.resolve=function(M,$){var D=O(_,$);if(D.status==="error")return c.reject(M,D.value);var U=D.value;if(U)T(M,U);else{M.state=p,M.outcome=$;for(var W=-1,Y=M.queue.length;++W<Y;)M.queue[W].callFulfilled($)}return M},c.reject=function(M,$){M.state=h,M.outcome=$;for(var D=-1,U=M.queue.length;++D<U;)M.queue[D].callRejected($);return M};function _(M){var $=M&&M.then;if(M&&(typeof M=="object"||typeof M=="function")&&typeof $=="function")return function(){$.apply(M,arguments)}}function T(M,$){var D=!1;function U(G){D||(D=!0,c.reject(M,G))}function W(G){D||(D=!0,c.resolve(M,G))}function Y(){$(W,U)}var q=O(Y);q.status==="error"&&U(q.value)}function O(M,$){var D={};try{D.value=M($),D.status="success"}catch(U){D.status="error",D.value=U}return D}d.resolve=S;function S(M){return M instanceof this?M:c.resolve(new this(l),M)}d.reject=A;function A(M){var $=new this(l);return c.reject($,M)}d.all=R;function R(M){var $=this;if(Object.prototype.toString.call(M)!=="[object Array]")return this.reject(new TypeError("must be an array"));var D=M.length,U=!1;if(!D)return this.resolve([]);for(var W=new Array(D),Y=0,q=-1,G=new this(l);++q<D;)t1(M[q],q);return G;function t1(J,X){$.resolve(J).then(n1,function(s1){U||(U=!0,c.reject(G,s1))});function n1(s1){W[X]=s1,++Y===D&&!U&&(U=!0,c.resolve(G,W))}}}d.race=k;function k(M){var $=this;if(Object.prototype.toString.call(M)!=="[object Array]")return this.reject(new TypeError("must be an array"));var D=M.length,U=!1;if(!D)return this.resolve([]);for(var W=-1,Y=new this(l);++W<D;)q(M[W]);return Y;function q(G){$.resolve(G).then(function(t1){U||(U=!0,c.resolve(Y,t1))},function(t1){U||(U=!0,c.reject(Y,t1))})}}},{1:1}],3:[function(t,r,o){(function(i){typeof i.Promise!="function"&&(i.Promise=t(2))}).call(this,typeof ye<"u"?ye:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(t,r,o){var i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};function l(a,g){if(!(a instanceof g))throw new TypeError("Cannot call a class as a function")}function c(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var h=c();function p(){try{if(!h||!h.open)return!1;var a=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),g=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!a||g)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function b(a,g){a=a||[],g=g||{};try{return new Blob(a,g)}catch(m){if(m.name!=="TypeError")throw m;for(var u=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,L=new u,y=0;y<a.length;y+=1)L.append(a[y]);return L.getBlob(g.type)}}typeof Promise>"u"&&t(3);var d=Promise;function w(a,g){g&&a.then(function(u){g(null,u)},function(u){g(u)})}function I(a,g,u){typeof g=="function"&&a.then(g),typeof u=="function"&&a.catch(u)}function _(a){return typeof a!="string"&&(console.warn(a+" used as a key, but it is not a string."),a=String(a)),a}function T(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var O="local-forage-detect-blob-support",S=void 0,A={},R=Object.prototype.toString,k="readonly",M="readwrite";function $(a){for(var g=a.length,u=new ArrayBuffer(g),L=new Uint8Array(u),y=0;y<g;y++)L[y]=a.charCodeAt(y);return u}function D(a){return new d(function(g){var u=a.transaction(O,M),L=b([""]);u.objectStore(O).put(L,"key"),u.onabort=function(y){y.preventDefault(),y.stopPropagation(),g(!1)},u.oncomplete=function(){var y=navigator.userAgent.match(/Chrome\/(\d+)/),m=navigator.userAgent.match(/Edge\//);g(m||!y||parseInt(y[1],10)>=43)}}).catch(function(){return!1})}function U(a){return typeof S=="boolean"?d.resolve(S):D(a).then(function(g){return S=g,S})}function W(a){var g=A[a.name],u={};u.promise=new d(function(L,y){u.resolve=L,u.reject=y}),g.deferredOperations.push(u),g.dbReady?g.dbReady=g.dbReady.then(function(){return u.promise}):g.dbReady=u.promise}function Y(a){var g=A[a.name],u=g.deferredOperations.pop();if(u)return u.resolve(),u.promise}function q(a,g){var u=A[a.name],L=u.deferredOperations.pop();if(L)return L.reject(g),L.promise}function G(a,g){return new d(function(u,L){if(A[a.name]=A[a.name]||c1(),a.db)if(g)W(a),a.db.close();else return u(a.db);var y=[a.name];g&&y.push(a.version);var m=h.open.apply(h,y);g&&(m.onupgradeneeded=function(E){var N=m.result;try{N.createObjectStore(a.storeName),E.oldVersion<=1&&N.createObjectStore(O)}catch(Z){if(Z.name==="ConstraintError")console.warn('The database "'+a.name+'" has been upgraded from version '+E.oldVersion+" to version "+E.newVersion+', but the storage "'+a.storeName+'" already exists.');else throw Z}}),m.onerror=function(E){E.preventDefault(),L(m.error)},m.onsuccess=function(){var E=m.result;E.onversionchange=function(N){N.target.close()},u(E),Y(a)}})}function t1(a){return G(a,!1)}function J(a){return G(a,!0)}function X(a,g){if(!a.db)return!0;var u=!a.db.objectStoreNames.contains(a.storeName),L=a.version<a.db.version,y=a.version>a.db.version;if(L&&(a.version!==g&&console.warn('The database "'+a.name+`" can't be downgraded from version `+a.db.version+" to version "+a.version+"."),a.version=a.db.version),y||u){if(u){var m=a.db.version+1;m>a.version&&(a.version=m)}return!0}return!1}function n1(a){return new d(function(g,u){var L=new FileReader;L.onerror=u,L.onloadend=function(y){var m=btoa(y.target.result||"");g({__local_forage_encoded_blob:!0,data:m,type:a.type})},L.readAsBinaryString(a)})}function s1(a){var g=$(atob(a.data));return b([g],{type:a.type})}function d1(a){return a&&a.__local_forage_encoded_blob}function b1(a){var g=this,u=g._initReady().then(function(){var L=A[g._dbInfo.name];if(L&&L.dbReady)return L.dbReady});return I(u,a,a),u}function l1(a){W(a);for(var g=A[a.name],u=g.forages,L=0;L<u.length;L++){var y=u[L];y._dbInfo.db&&(y._dbInfo.db.close(),y._dbInfo.db=null)}return a.db=null,t1(a).then(function(m){return a.db=m,X(a)?J(a):m}).then(function(m){a.db=g.db=m;for(var E=0;E<u.length;E++)u[E]._dbInfo.db=m}).catch(function(m){throw q(a,m),m})}function K(a,g,u,L){L===void 0&&(L=1);try{var y=a.db.transaction(a.storeName,g);u(null,y)}catch(m){if(L>0&&(!a.db||m.name==="InvalidStateError"||m.name==="NotFoundError"))return d.resolve().then(function(){if(!a.db||m.name==="NotFoundError"&&!a.db.objectStoreNames.contains(a.storeName)&&a.version<=a.db.version)return a.db&&(a.version=a.db.version+1),J(a)}).then(function(){return l1(a).then(function(){K(a,g,u,L-1)})}).catch(u);u(m)}}function c1(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function L1(a){var g=this,u={db:null};if(a)for(var L in a)u[L]=a[L];var y=A[u.name];y||(y=c1(),A[u.name]=y),y.forages.push(g),g._initReady||(g._initReady=g.ready,g.ready=b1);var m=[];function E(){return d.resolve()}for(var N=0;N<y.forages.length;N++){var Z=y.forages[N];Z!==g&&m.push(Z._initReady().catch(E))}var P=y.forages.slice(0);return d.all(m).then(function(){return u.db=y.db,t1(u)}).then(function(F){return u.db=F,X(u,g._defaultConfig.version)?J(u):F}).then(function(F){u.db=y.db=F,g._dbInfo=u;for(var z=0;z<P.length;z++){var Q=P[z];Q!==g&&(Q._dbInfo.db=u.db,Q._dbInfo.version=u.version)}})}function T1(a,g){var u=this;a=_(a);var L=new d(function(y,m){u.ready().then(function(){K(u._dbInfo,k,function(E,N){if(E)return m(E);try{var Z=N.objectStore(u._dbInfo.storeName),P=Z.get(a);P.onsuccess=function(){var F=P.result;F===void 0&&(F=null),d1(F)&&(F=s1(F)),y(F)},P.onerror=function(){m(P.error)}}catch(F){m(F)}})}).catch(m)});return w(L,g),L}function F1(a,g){var u=this,L=new d(function(y,m){u.ready().then(function(){K(u._dbInfo,k,function(E,N){if(E)return m(E);try{var Z=N.objectStore(u._dbInfo.storeName),P=Z.openCursor(),F=1;P.onsuccess=function(){var z=P.result;if(z){var Q=z.value;d1(Q)&&(Q=s1(Q));var e1=a(Q,z.key,F++);e1!==void 0?y(e1):z.continue()}else y()},P.onerror=function(){m(P.error)}}catch(z){m(z)}})}).catch(m)});return w(L,g),L}function k1(a,g,u){var L=this;a=_(a);var y=new d(function(m,E){var N;L.ready().then(function(){return N=L._dbInfo,R.call(g)==="[object Blob]"?U(N.db).then(function(Z){return Z?g:n1(g)}):g}).then(function(Z){K(L._dbInfo,M,function(P,F){if(P)return E(P);try{var z=F.objectStore(L._dbInfo.storeName);Z===null&&(Z=void 0);var Q=z.put(Z,a);F.oncomplete=function(){Z===void 0&&(Z=null),m(Z)},F.onabort=F.onerror=function(){var e1=Q.error?Q.error:Q.transaction.error;E(e1)}}catch(e1){E(e1)}})}).catch(E)});return w(y,u),y}function F0(a,g){var u=this;a=_(a);var L=new d(function(y,m){u.ready().then(function(){K(u._dbInfo,M,function(E,N){if(E)return m(E);try{var Z=N.objectStore(u._dbInfo.storeName),P=Z.delete(a);N.oncomplete=function(){y()},N.onerror=function(){m(P.error)},N.onabort=function(){var F=P.error?P.error:P.transaction.error;m(F)}}catch(F){m(F)}})}).catch(m)});return w(L,g),L}function k0(a){var g=this,u=new d(function(L,y){g.ready().then(function(){K(g._dbInfo,M,function(m,E){if(m)return y(m);try{var N=E.objectStore(g._dbInfo.storeName),Z=N.clear();E.oncomplete=function(){L()},E.onabort=E.onerror=function(){var P=Z.error?Z.error:Z.transaction.error;y(P)}}catch(P){y(P)}})}).catch(y)});return w(u,a),u}function B0(a){var g=this,u=new d(function(L,y){g.ready().then(function(){K(g._dbInfo,k,function(m,E){if(m)return y(m);try{var N=E.objectStore(g._dbInfo.storeName),Z=N.count();Z.onsuccess=function(){L(Z.result)},Z.onerror=function(){y(Z.error)}}catch(P){y(P)}})}).catch(y)});return w(u,a),u}function U0(a,g){var u=this,L=new d(function(y,m){if(a<0){y(null);return}u.ready().then(function(){K(u._dbInfo,k,function(E,N){if(E)return m(E);try{var Z=N.objectStore(u._dbInfo.storeName),P=!1,F=Z.openKeyCursor();F.onsuccess=function(){var z=F.result;if(!z){y(null);return}a===0||P?y(z.key):(P=!0,z.advance(a))},F.onerror=function(){m(F.error)}}catch(z){m(z)}})}).catch(m)});return w(L,g),L}function j0(a){var g=this,u=new d(function(L,y){g.ready().then(function(){K(g._dbInfo,k,function(m,E){if(m)return y(m);try{var N=E.objectStore(g._dbInfo.storeName),Z=N.openKeyCursor(),P=[];Z.onsuccess=function(){var F=Z.result;if(!F){L(P);return}P.push(F.key),F.continue()},Z.onerror=function(){y(Z.error)}}catch(F){y(F)}})}).catch(y)});return w(u,a),u}function z0(a,g){g=T.apply(this,arguments);var u=this.config();a=typeof a!="function"&&a||{},a.name||(a.name=a.name||u.name,a.storeName=a.storeName||u.storeName);var L=this,y;if(!a.name)y=d.reject("Invalid arguments");else{var m=a.name===u.name&&L._dbInfo.db,E=m?d.resolve(L._dbInfo.db):t1(a).then(function(N){var Z=A[a.name],P=Z.forages;Z.db=N;for(var F=0;F<P.length;F++)P[F]._dbInfo.db=N;return N});a.storeName?y=E.then(function(N){if(N.objectStoreNames.contains(a.storeName)){var Z=N.version+1;W(a);var P=A[a.name],F=P.forages;N.close();for(var z=0;z<F.length;z++){var Q=F[z];Q._dbInfo.db=null,Q._dbInfo.version=Z}var e1=new d(function(r1,u1){var a1=h.open(a.name,Z);a1.onerror=function(y1){var oe=a1.result;oe.close(),u1(y1)},a1.onupgradeneeded=function(){var y1=a1.result;y1.deleteObjectStore(a.storeName)},a1.onsuccess=function(){var y1=a1.result;y1.close(),r1(y1)}});return e1.then(function(r1){P.db=r1;for(var u1=0;u1<F.length;u1++){var a1=F[u1];a1._dbInfo.db=r1,Y(a1._dbInfo)}}).catch(function(r1){throw(q(a,r1)||d.resolve()).catch(function(){}),r1})}}):y=E.then(function(N){W(a);var Z=A[a.name],P=Z.forages;N.close();for(var F=0;F<P.length;F++){var z=P[F];z._dbInfo.db=null}var Q=new d(function(e1,r1){var u1=h.deleteDatabase(a.name);u1.onerror=function(){var a1=u1.result;a1&&a1.close(),r1(u1.error)},u1.onblocked=function(){console.warn('dropInstance blocked for database "'+a.name+'" until all open connections are closed')},u1.onsuccess=function(){var a1=u1.result;a1&&a1.close(),e1(a1)}});return Q.then(function(e1){Z.db=e1;for(var r1=0;r1<P.length;r1++){var u1=P[r1];Y(u1._dbInfo)}}).catch(function(e1){throw(q(a,e1)||d.resolve()).catch(function(){}),e1})})}return w(y,g),y}var W0={_driver:"asyncStorage",_initStorage:L1,_support:p(),iterate:F1,getItem:T1,setItem:k1,removeItem:F0,clear:k0,length:B0,key:U0,keys:j0,dropInstance:z0};function G0(){return typeof openDatabase=="function"}var D1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Y0="~~local_forage_type~",G6=/^~~local_forage_type~([^~]+)~/,He="__lfsc__:",v3=He.length,g3="arbf",p3="blob",Y6="si08",X6="ui08",q6="uic8",J6="si16",Q6="si32",K6="ur16",en="ui32",tn="fl32",nn="fl64",rn=v3+g3.length,on=Object.prototype.toString;function ln(a){var g=a.length*.75,u=a.length,L,y=0,m,E,N,Z;a[a.length-1]==="="&&(g--,a[a.length-2]==="="&&g--);var P=new ArrayBuffer(g),F=new Uint8Array(P);for(L=0;L<u;L+=4)m=D1.indexOf(a[L]),E=D1.indexOf(a[L+1]),N=D1.indexOf(a[L+2]),Z=D1.indexOf(a[L+3]),F[y++]=m<<2|E>>4,F[y++]=(E&15)<<4|N>>2,F[y++]=(N&3)<<6|Z&63;return P}function m3(a){var g=new Uint8Array(a),u="",L;for(L=0;L<g.length;L+=3)u+=D1[g[L]>>2],u+=D1[(g[L]&3)<<4|g[L+1]>>4],u+=D1[(g[L+1]&15)<<2|g[L+2]>>6],u+=D1[g[L+2]&63];return g.length%3===2?u=u.substring(0,u.length-1)+"=":g.length%3===1&&(u=u.substring(0,u.length-2)+"=="),u}function X0(a,g){var u="";if(a&&(u=on.call(a)),a&&(u==="[object ArrayBuffer]"||a.buffer&&on.call(a.buffer)==="[object ArrayBuffer]")){var L,y=He;a instanceof ArrayBuffer?(L=a,y+=g3):(L=a.buffer,u==="[object Int8Array]"?y+=Y6:u==="[object Uint8Array]"?y+=X6:u==="[object Uint8ClampedArray]"?y+=q6:u==="[object Int16Array]"?y+=J6:u==="[object Uint16Array]"?y+=K6:u==="[object Int32Array]"?y+=Q6:u==="[object Uint32Array]"?y+=en:u==="[object Float32Array]"?y+=tn:u==="[object Float64Array]"?y+=nn:g(new Error("Failed to get type for BinaryArray"))),g(y+m3(L))}else if(u==="[object Blob]"){var m=new FileReader;m.onload=function(){var E=Y0+a.type+"~"+m3(this.result);g(He+p3+E)},m.readAsArrayBuffer(a)}else try{g(JSON.stringify(a))}catch(E){console.error("Couldn't convert value into a JSON string: ",a),g(null,E)}}function q0(a){if(a.substring(0,v3)!==He)return JSON.parse(a);var g=a.substring(rn),u=a.substring(v3,rn),L;if(u===p3&&G6.test(g)){var y=g.match(G6);L=y[1],g=g.substring(y[0].length)}var m=ln(g);switch(u){case g3:return m;case p3:return b([m],{type:L});case Y6:return new Int8Array(m);case X6:return new Uint8Array(m);case q6:return new Uint8ClampedArray(m);case J6:return new Int16Array(m);case K6:return new Uint16Array(m);case Q6:return new Int32Array(m);case en:return new Uint32Array(m);case tn:return new Float32Array(m);case nn:return new Float64Array(m);default:throw new Error("Unkown type: "+u)}}var b3={serialize:X0,deserialize:q0,stringToBuffer:ln,bufferToString:m3};function sn(a,g,u,L){a.executeSql("CREATE TABLE IF NOT EXISTS "+g.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],u,L)}function J0(a){var g=this,u={db:null};if(a)for(var L in a)u[L]=typeof a[L]!="string"?a[L].toString():a[L];var y=new d(function(m,E){try{u.db=openDatabase(u.name,String(u.version),u.description,u.size)}catch(N){return E(N)}u.db.transaction(function(N){sn(N,u,function(){g._dbInfo=u,m()},function(Z,P){E(P)})},E)});return u.serializer=b3,y}function O1(a,g,u,L,y,m){a.executeSql(u,L,y,function(E,N){N.code===N.SYNTAX_ERR?E.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[g.storeName],function(Z,P){P.rows.length?m(Z,N):sn(Z,g,function(){Z.executeSql(u,L,y,m)},m)},m):m(E,N)},m)}function Q0(a,g){var u=this;a=_(a);var L=new d(function(y,m){u.ready().then(function(){var E=u._dbInfo;E.db.transaction(function(N){O1(N,E,"SELECT * FROM "+E.storeName+" WHERE key = ? LIMIT 1",[a],function(Z,P){var F=P.rows.length?P.rows.item(0).value:null;F&&(F=E.serializer.deserialize(F)),y(F)},function(Z,P){m(P)})})}).catch(m)});return w(L,g),L}function K0(a,g){var u=this,L=new d(function(y,m){u.ready().then(function(){var E=u._dbInfo;E.db.transaction(function(N){O1(N,E,"SELECT * FROM "+E.storeName,[],function(Z,P){for(var F=P.rows,z=F.length,Q=0;Q<z;Q++){var e1=F.item(Q),r1=e1.value;if(r1&&(r1=E.serializer.deserialize(r1)),r1=a(r1,e1.key,Q+1),r1!==void 0){y(r1);return}}y()},function(Z,P){m(P)})})}).catch(m)});return w(L,g),L}function an(a,g,u,L){var y=this;a=_(a);var m=new d(function(E,N){y.ready().then(function(){g===void 0&&(g=null);var Z=g,P=y._dbInfo;P.serializer.serialize(g,function(F,z){z?N(z):P.db.transaction(function(Q){O1(Q,P,"INSERT OR REPLACE INTO "+P.storeName+" (key, value) VALUES (?, ?)",[a,F],function(){E(Z)},function(e1,r1){N(r1)})},function(Q){if(Q.code===Q.QUOTA_ERR){if(L>0){E(an.apply(y,[a,Z,u,L-1]));return}N(Q)}})})}).catch(N)});return w(m,u),m}function e5(a,g,u){return an.apply(this,[a,g,u,1])}function t5(a,g){var u=this;a=_(a);var L=new d(function(y,m){u.ready().then(function(){var E=u._dbInfo;E.db.transaction(function(N){O1(N,E,"DELETE FROM "+E.storeName+" WHERE key = ?",[a],function(){y()},function(Z,P){m(P)})})}).catch(m)});return w(L,g),L}function n5(a){var g=this,u=new d(function(L,y){g.ready().then(function(){var m=g._dbInfo;m.db.transaction(function(E){O1(E,m,"DELETE FROM "+m.storeName,[],function(){L()},function(N,Z){y(Z)})})}).catch(y)});return w(u,a),u}function r5(a){var g=this,u=new d(function(L,y){g.ready().then(function(){var m=g._dbInfo;m.db.transaction(function(E){O1(E,m,"SELECT COUNT(key) as c FROM "+m.storeName,[],function(N,Z){var P=Z.rows.item(0).c;L(P)},function(N,Z){y(Z)})})}).catch(y)});return w(u,a),u}function o5(a,g){var u=this,L=new d(function(y,m){u.ready().then(function(){var E=u._dbInfo;E.db.transaction(function(N){O1(N,E,"SELECT key FROM "+E.storeName+" WHERE id = ? LIMIT 1",[a+1],function(Z,P){var F=P.rows.length?P.rows.item(0).key:null;y(F)},function(Z,P){m(P)})})}).catch(m)});return w(L,g),L}function i5(a){var g=this,u=new d(function(L,y){g.ready().then(function(){var m=g._dbInfo;m.db.transaction(function(E){O1(E,m,"SELECT key FROM "+m.storeName,[],function(N,Z){for(var P=[],F=0;F<Z.rows.length;F++)P.push(Z.rows.item(F).key);L(P)},function(N,Z){y(Z)})})}).catch(y)});return w(u,a),u}function l5(a){return new d(function(g,u){a.transaction(function(L){L.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(y,m){for(var E=[],N=0;N<m.rows.length;N++)E.push(m.rows.item(N).name);g({db:a,storeNames:E})},function(y,m){u(m)})},function(L){u(L)})})}function s5(a,g){g=T.apply(this,arguments);var u=this.config();a=typeof a!="function"&&a||{},a.name||(a.name=a.name||u.name,a.storeName=a.storeName||u.storeName);var L=this,y;return a.name?y=new d(function(m){var E;a.name===u.name?E=L._dbInfo.db:E=openDatabase(a.name,"","",0),a.storeName?m({db:E,storeNames:[a.storeName]}):m(l5(E))}).then(function(m){return new d(function(E,N){m.db.transaction(function(Z){function P(e1){return new d(function(r1,u1){Z.executeSql("DROP TABLE IF EXISTS "+e1,[],function(){r1()},function(a1,y1){u1(y1)})})}for(var F=[],z=0,Q=m.storeNames.length;z<Q;z++)F.push(P(m.storeNames[z]));d.all(F).then(function(){E()}).catch(function(e1){N(e1)})},function(Z){N(Z)})})}):y=d.reject("Invalid arguments"),w(y,g),y}var a5={_driver:"webSQLStorage",_initStorage:J0,_support:G0(),iterate:K0,getItem:Q0,setItem:e5,removeItem:t5,clear:n5,length:r5,key:o5,keys:i5,dropInstance:s5};function c5(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function cn(a,g){var u=a.name+"/";return a.storeName!==g.storeName&&(u+=a.storeName+"/"),u}function u5(){var a="_localforage_support_test";try{return localStorage.setItem(a,!0),localStorage.removeItem(a),!1}catch{return!0}}function d5(){return!u5()||localStorage.length>0}function f5(a){var g=this,u={};if(a)for(var L in a)u[L]=a[L];return u.keyPrefix=cn(a,g._defaultConfig),d5()?(g._dbInfo=u,u.serializer=b3,d.resolve()):d.reject()}function C5(a){var g=this,u=g.ready().then(function(){for(var L=g._dbInfo.keyPrefix,y=localStorage.length-1;y>=0;y--){var m=localStorage.key(y);m.indexOf(L)===0&&localStorage.removeItem(m)}});return w(u,a),u}function h5(a,g){var u=this;a=_(a);var L=u.ready().then(function(){var y=u._dbInfo,m=localStorage.getItem(y.keyPrefix+a);return m&&(m=y.serializer.deserialize(m)),m});return w(L,g),L}function v5(a,g){var u=this,L=u.ready().then(function(){for(var y=u._dbInfo,m=y.keyPrefix,E=m.length,N=localStorage.length,Z=1,P=0;P<N;P++){var F=localStorage.key(P);if(F.indexOf(m)===0){var z=localStorage.getItem(F);if(z&&(z=y.serializer.deserialize(z)),z=a(z,F.substring(E),Z++),z!==void 0)return z}}});return w(L,g),L}function g5(a,g){var u=this,L=u.ready().then(function(){var y=u._dbInfo,m;try{m=localStorage.key(a)}catch{m=null}return m&&(m=m.substring(y.keyPrefix.length)),m});return w(L,g),L}function p5(a){var g=this,u=g.ready().then(function(){for(var L=g._dbInfo,y=localStorage.length,m=[],E=0;E<y;E++){var N=localStorage.key(E);N.indexOf(L.keyPrefix)===0&&m.push(N.substring(L.keyPrefix.length))}return m});return w(u,a),u}function m5(a){var g=this,u=g.keys().then(function(L){return L.length});return w(u,a),u}function b5(a,g){var u=this;a=_(a);var L=u.ready().then(function(){var y=u._dbInfo;localStorage.removeItem(y.keyPrefix+a)});return w(L,g),L}function L5(a,g,u){var L=this;a=_(a);var y=L.ready().then(function(){g===void 0&&(g=null);var m=g;return new d(function(E,N){var Z=L._dbInfo;Z.serializer.serialize(g,function(P,F){if(F)N(F);else try{localStorage.setItem(Z.keyPrefix+a,P),E(m)}catch(z){(z.name==="QuotaExceededError"||z.name==="NS_ERROR_DOM_QUOTA_REACHED")&&N(z),N(z)}})})});return w(y,u),y}function w5(a,g){if(g=T.apply(this,arguments),a=typeof a!="function"&&a||{},!a.name){var u=this.config();a.name=a.name||u.name,a.storeName=a.storeName||u.storeName}var L=this,y;return a.name?y=new d(function(m){a.storeName?m(cn(a,L._defaultConfig)):m(a.name+"/")}).then(function(m){for(var E=localStorage.length-1;E>=0;E--){var N=localStorage.key(E);N.indexOf(m)===0&&localStorage.removeItem(N)}}):y=d.reject("Invalid arguments"),w(y,g),y}var y5={_driver:"localStorageWrapper",_initStorage:f5,_support:c5(),iterate:v5,getItem:h5,setItem:L5,removeItem:b5,clear:C5,length:m5,key:g5,keys:p5,dropInstance:w5},I5=function(g,u){return g===u||typeof g=="number"&&typeof u=="number"&&isNaN(g)&&isNaN(u)},M5=function(g,u){for(var L=g.length,y=0;y<L;){if(I5(g[y],u))return!0;y++}return!1},un=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"},re={},dn={},B1={INDEXEDDB:W0,WEBSQL:a5,LOCALSTORAGE:y5},_5=[B1.INDEXEDDB._driver,B1.WEBSQL._driver,B1.LOCALSTORAGE._driver],Ee=["dropInstance"],L3=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Ee),S5={description:"",driver:_5.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function H5(a,g){a[g]=function(){var u=arguments;return a.ready().then(function(){return a[g].apply(a,u)})}}function w3(){for(var a=1;a<arguments.length;a++){var g=arguments[a];if(g)for(var u in g)g.hasOwnProperty(u)&&(un(g[u])?arguments[0][u]=g[u].slice():arguments[0][u]=g[u])}return arguments[0]}var E5=(function(){function a(g){l(this,a);for(var u in B1)if(B1.hasOwnProperty(u)){var L=B1[u],y=L._driver;this[u]=y,re[y]||this.defineDriver(L)}this._defaultConfig=w3({},S5),this._config=w3({},this._defaultConfig,g),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return a.prototype.config=function(u){if((typeof u>"u"?"undefined":i(u))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var L in u){if(L==="storeName"&&(u[L]=u[L].replace(/\W/g,"_")),L==="version"&&typeof u[L]!="number")return new Error("Database version must be a number.");this._config[L]=u[L]}return"driver"in u&&u.driver?this.setDriver(this._config.driver):!0}else return typeof u=="string"?this._config[u]:this._config},a.prototype.defineDriver=function(u,L,y){var m=new d(function(E,N){try{var Z=u._driver,P=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!u._driver){N(P);return}for(var F=L3.concat("_initStorage"),z=0,Q=F.length;z<Q;z++){var e1=F[z],r1=!M5(Ee,e1);if((r1||u[e1])&&typeof u[e1]!="function"){N(P);return}}var u1=function(){for(var oe=function(R5){return function(){var V5=new Error("Method "+R5+" is not implemented by the current driver"),fn=d.reject(V5);return w(fn,arguments[arguments.length-1]),fn}},y3=0,O5=Ee.length;y3<O5;y3++){var I3=Ee[y3];u[I3]||(u[I3]=oe(I3))}};u1();var a1=function(oe){re[Z]&&console.info("Redefining LocalForage driver: "+Z),re[Z]=u,dn[Z]=oe,E()};"_support"in u?u._support&&typeof u._support=="function"?u._support().then(a1,N):a1(!!u._support):a1(!0)}catch(y1){N(y1)}});return I(m,L,y),m},a.prototype.driver=function(){return this._driver||null},a.prototype.getDriver=function(u,L,y){var m=re[u]?d.resolve(re[u]):d.reject(new Error("Driver not found."));return I(m,L,y),m},a.prototype.getSerializer=function(u){var L=d.resolve(b3);return I(L,u),L},a.prototype.ready=function(u){var L=this,y=L._driverSet.then(function(){return L._ready===null&&(L._ready=L._initDriver()),L._ready});return I(y,u,u),y},a.prototype.setDriver=function(u,L,y){var m=this;un(u)||(u=[u]);var E=this._getSupportedDrivers(u);function N(){m._config.driver=m.driver()}function Z(z){return m._extend(z),N(),m._ready=m._initStorage(m._config),m._ready}function P(z){return function(){var Q=0;function e1(){for(;Q<z.length;){var r1=z[Q];return Q++,m._dbInfo=null,m._ready=null,m.getDriver(r1).then(Z).catch(e1)}N();var u1=new Error("No available storage method found.");return m._driverSet=d.reject(u1),m._driverSet}return e1()}}var F=this._driverSet!==null?this._driverSet.catch(function(){return d.resolve()}):d.resolve();return this._driverSet=F.then(function(){var z=E[0];return m._dbInfo=null,m._ready=null,m.getDriver(z).then(function(Q){m._driver=Q._driver,N(),m._wrapLibraryMethodsWithReady(),m._initDriver=P(E)})}).catch(function(){N();var z=new Error("No available storage method found.");return m._driverSet=d.reject(z),m._driverSet}),I(this._driverSet,L,y),this._driverSet},a.prototype.supports=function(u){return!!dn[u]},a.prototype._extend=function(u){w3(this,u)},a.prototype._getSupportedDrivers=function(u){for(var L=[],y=0,m=u.length;y<m;y++){var E=u[y];this.supports(E)&&L.push(E)}return L},a.prototype._wrapLibraryMethodsWithReady=function(){for(var u=0,L=L3.length;u<L;u++)H5(this,L3[u])},a.prototype.createInstance=function(u){return new a(u)},a})(),D5=new E5;r.exports=D5},{3:3}]},{},[4])(4)})})(s3)),s3.exports}var i0=o0();const N1=r0(i0);class a3{getItem(n){return N1.getItem(n)}setItem(n,t){return N1.setItem(n,t)}removeItem(n){return N1.removeItem(n)}clear(){return N1.clear()}key(n){return N1.key(n)}keys(){return N1.keys()}iterate(n){return N1.iterate(n)}}var l0=Object.getOwnPropertyDescriptor,s0=(e,n,t,r)=>{for(var o=r>1?void 0:r?l0(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},P6=(e,n)=>(t,r)=>n(t,r,e);C.DesktopMessageService=class extends f.Disposable{constructor(n,t){super(),this._injector=n,this._uiPartsService=t,this._initUIPart()}_initUIPart(){this.disposeWithMe(this._uiPartsService.registerComponent(i1.GLOBAL,()=>V.connectInjector(x.Messager,this._injector)))}dispose(){x.removeMessage()}show(n){let t=n;return typeof n.id>"u"&&(t=Object.assign({},n,{id:`message-${Date.now()}`})),x.message(t),f.toDisposable(()=>x.removeMessage(t.id))}remove(n){x.removeMessage(n)}removeAll(){x.removeMessage()}},C.DesktopMessageService=s0([P6(0,f.Inject(f.Injector)),P6(1,w1)],C.DesktopMessageService);function a0(){const e=V.useDependency(f.ThemeService),n=V.useObservable(e.darkMode$);return v.jsx(x.Toaster,{theme:n?"dark":"light"})}const c0={show:e=>{const{type:n="message",title:t,content:r,duration:o,closable:i=!0,position:l="top-right"}=e;x.toast[n](t,{position:l,description:r,duration:o,closeButton:i})}};var u0=Object.getOwnPropertyDescriptor,d0=(e,n,t,r)=>{for(var o=r>1?void 0:r?u0(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},F6=(e,n)=>(t,r)=>n(t,r,e);C.DesktopNotificationService=class extends f.Disposable{constructor(n,t){super(),this._injector=n,this._uiPartsService=t,this._initUIPart()}show(n){return c0.show(n),f.toDisposable(()=>{})}_initUIPart(){this.disposeWithMe(this._uiPartsService.registerComponent(i1.GLOBAL,()=>V.connectInjector(a0,this._injector)))}},C.DesktopNotificationService=d0([F6(0,f.Inject(f.Injector)),F6(1,w1)],C.DesktopNotificationService);class c3{constructor(){j(this,"_sidebarOptions",{});j(this,"sidebarOptions$",new B.Subject);j(this,"scrollEvent$",new B.Subject);j(this,"_container")}get visible(){return this._sidebarOptions.visible||!1}get options(){return this._sidebarOptions}open(n){return this._sidebarOptions={...n,id:n.id,visible:!0},this.sidebarOptions$.next(this._sidebarOptions),f.toDisposable(()=>{this.close()})}close(n){n&&this._sidebarOptions.id!==n||(this._sidebarOptions={...this._sidebarOptions,visible:!1},this.sidebarOptions$.next(this._sidebarOptions),this._sidebarOptions.onClose&&this._sidebarOptions.onClose())}getContainer(){return this._container}setContainer(n){this._container=n}}var f0=Object.getOwnPropertyDescriptor,C0=(e,n,t,r)=>{for(var o=r>1?void 0:r?f0(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},h0=(e,n)=>(t,r)=>n(t,r,e);C.DesktopZenZoneService=class{constructor(n){j(this,"visible$",new B.BehaviorSubject(!1));j(this,"componentKey$",new B.ReplaySubject);j(this,"_temporaryHidden$",new B.BehaviorSubject(!1));j(this,"temporaryHidden$",this._temporaryHidden$.asObservable());j(this,"_visible",!1);this._componentManager=n}get visible(){return this._visible}get temporaryHidden(){return this._temporaryHidden$.getValue()}dispose(){this.visible$.next(!1),this.visible$.complete(),this.componentKey$.complete()}hide(){this._temporaryHidden$.next(!0)}show(){this._temporaryHidden$.next(!1)}set(n,t){return this._componentManager.register(n,t),this.componentKey$.next(n),f.toDisposable(()=>{this._componentManager.delete(n),this.visible$.complete(),this.componentKey$.complete()})}open(){this._visible=!0,this.visible$.next(!0)}close(){this._visible=!1,this.visible$.next(!1)}},C.DesktopZenZoneService=C0([h0(0,f.Inject(v1))],C.DesktopZenZoneService);var v0=Object.defineProperty,g0=Object.getOwnPropertyDescriptor,p0=(e,n,t)=>n in e?v0(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,m0=(e,n,t,r)=>{for(var o=r>1?void 0:r?g0(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},u3=(e,n)=>(t,r)=>n(t,r,e),b0=(e,n,t)=>p0(e,n+"",t);const L0="UNIVER_MOBILE_UI_PLUGIN",w0="DISABLE_AUTO_FOCUS";C.UniverMobileUIPlugin=class extends f.Plugin{constructor(n=ae,t,r,o){super(),this._config=n,this._contextService=t,this._injector=r,this._configService=o;const{menu:i,...l}=f.merge({popupRootId:`univer-popup-portal-${f.generateRandomId(6)}`},ae,this._config);l.disableAutoFocus&&this._contextService.setContextValue(w0,!0),i&&this._configService.setConfig("menu",i,{merge:!0}),this._configService.setConfig(V1,l)}onStarting(){f.registerDependencies(this._injector,f.mergeOverrideWithDependencies([[v1],[K1],[W1],[ie],[w1,{useClass:Ue}],[M1,{useClass:C.DesktopLayoutService}],[Z1,{useClass:C.ShortcutService}],[de,{useClass:Be}],[I1,{useClass:C.MenuManagerService}],[ee,{useClass:Ye}],[o3,{useClass:C.BrowserClipboardService,lazy:!0}],[ne,{useClass:C.DesktopNotificationService,lazy:!0}],[we,{useClass:C.DesktopGalleryService,lazy:!0}],[Le,{useClass:C.DesktopDialogService,lazy:!0}],[be,{useClass:C.DesktopConfirmService,lazy:!0}],[x1,{useClass:c3,lazy:!0}],[me,{useClass:C.DesktopZenZoneService,lazy:!0}],[pe,{useClass:C.DesktopGlobalZoneService,lazy:!0}],[ue,{useClass:C.DesktopMessageService,lazy:!0}],[f.ILocalStorageService,{useClass:a3,lazy:!0}],[e3,{useClass:C.DesktopBeforeCloseService}],[l3,{useClass:i3}],[he,{useClass:ze}],[Ce],[te,{useFactory:n=>n.createInstance(Ke,this._config),deps:[f.Injector]}],[C.SharedController],[C.ErrorController],[C.ShortcutPanelController]],this._config.override)),f.touchDependencies(this._injector,[[te],[C.ErrorController]])}onReady(){f.touchDependencies(this._injector,[[C.SharedController]])}onSteady(){f.touchDependencies(this._injector,[[C.ShortcutPanelController]])}},b0(C.UniverMobileUIPlugin,"pluginName",L0),C.UniverMobileUIPlugin=m0([f.DependentOn(U1.UniverRenderEnginePlugin),u3(1,f.IContextService),u3(2,f.Inject(f.Injector)),u3(3,f.IConfigService)],C.UniverMobileUIPlugin);var y0=Object.defineProperty,I0=Object.getOwnPropertyDescriptor,M0=(e,n,t)=>n in e?y0(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,_0=(e,n,t,r)=>{for(var o=r>1?void 0:r?I0(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},d3=(e,n)=>(t,r)=>n(t,r,e),S0=(e,n,t)=>M0(e,n+"",t);const k6="UNIVER_UI_PLUGIN",B6="DISABLE_AUTO_FOCUS";C.UniverUIPlugin=class extends f.Plugin{constructor(n=ae,t,r,o){super(),this._config=n,this._contextService=t,this._injector=r,this._configService=o;const{menu:i,...l}=f.merge({popupRootId:`univer-popup-portal-${f.generateRandomId(6)}`},ae,this._config);l.disableAutoFocus&&this._contextService.setContextValue(B6,!0),i&&this._configService.setConfig("menu",i,{merge:!0}),this._configService.setConfig(V1,l)}onStarting(){f.registerDependencies(this._injector,f.mergeOverrideWithDependencies([[v1],[K1],[W1],[ie],[w1,{useClass:Ue}],[M1,{useClass:C.DesktopLayoutService}],[Z1,{useClass:C.ShortcutService}],[de,{useClass:Be}],[I1,{useClass:C.MenuManagerService}],[ee,{useClass:Ye}],[o3,{useClass:C.BrowserClipboardService,lazy:!0}],[ne,{useClass:C.DesktopNotificationService,lazy:!0}],[we,{useClass:C.DesktopGalleryService,lazy:!0}],[Le,{useClass:C.DesktopDialogService,lazy:!0}],[be,{useClass:C.DesktopConfirmService,lazy:!0}],[x1,{useClass:c3,lazy:!0}],[me,{useClass:C.DesktopZenZoneService,lazy:!0}],[pe,{useClass:C.DesktopGlobalZoneService,lazy:!0}],[ue,{useClass:C.DesktopMessageService,lazy:!0}],[f.ILocalStorageService,{useClass:a3,lazy:!0}],[e3,{useClass:C.DesktopBeforeCloseService}],[l3,{useClass:i3}],[he,{useClass:ze}],[xe,{useClass:$e}],[Ce],[te,{useFactory:n=>n.createInstance(C.DesktopUIController,this._config),deps:[f.Injector]}],[C.SharedController],[C.ErrorController],[C.ShortcutPanelController]],this._config.override)),f.touchDependencies(this._injector,[[te],[C.ErrorController]])}onReady(){f.touchDependencies(this._injector,[[C.SharedController]])}onSteady(){f.touchDependencies(this._injector,[[C.ShortcutPanelController]])}},S0(C.UniverUIPlugin,"pluginName",k6),C.UniverUIPlugin=_0([f.DependentOn(U1.UniverRenderEnginePlugin),d3(1,f.IContextService),d3(2,f.Inject(f.Injector)),d3(3,f.IConfigService)],C.UniverUIPlugin);class H0{show(n){return f.toDisposable(()=>{})}remove(n){}removeAll(){}setContainer(){}getContainer(){}}const E0=e=>{const t=V.useDependency(x1).getContainer();s.useEffect(()=>{if(t)return t.addEventListener("mousedown",e),()=>{t.removeEventListener("mousedown",e)}},[e,t])};function Me(e){return e.length===0?e:e.replace(/^\s+|\s+$/gm,"")}const D0=.75,U6=78,j6=9;function f3(e){var c;let n=e.childNodes;if(n.length===0)return e.textContent;if(n[0].nodeName==="DIV"&&(n=n[0].childNodes),n.length===1&&n[0].nodeName==="#text")return n[0].textContent;const t=[];let r=0,o=0,i=e.textContent||"";i+=`\r
`;for(let h=0;h<n.length;h++){let p=n[`${h}`],b;p.nodeName==="#text"?(b=(c=p.textContent)!=null?c:"",p=p.parentElement):b=p.innerText;const d=_e(p);W6(b).forEach(I=>{const _=I.length;o+=_,r=o-_;const T=f.generateRandomId(6);t.push({sId:T,st:r,ed:o-1,ts:d})})}return{id:f.generateRandomId(6),body:{dataStream:i,textRuns:t},documentStyle:{}}}function _e(e,n=""){var l,c;let t=(c=(l=e==null?void 0:e.style)==null?void 0:l.cssText)!=null?c:"";if(t+=n,t=t.replace(/[\r\n]+/g,""),t.length===0)return{};const r=t.split(";"),o={},i={t:"",r:"",b:"",l:""};return r.forEach(h=>{var w;const p=h.toLowerCase(),b=Me(p.substr(0,p.indexOf(":"))),d=Me(p.substr(p.indexOf(":")+1));if(b==="font-weight")d==="bold"||d==="700"?o.bl=1:o.bl=0;else if(b==="font-style")d==="italic"?o.it=1:o.it=0;else if(b==="font-family"){const I=Me(h),_=A0(I);o.ff=_}else if(b==="font-size"){let I=Number.parseInt(d);t.indexOf("vertical-align")>-1&&(t.indexOf("sub")>-1||t.indexOf("sup")>-1)&&(I*=2),d.indexOf("px")!==-1&&(I=Z0(Number.parseInt(d,10))),o.fs=I}else if(b==="color"){const I=new f.ColorKit(d);o.cl={rgb:I.isValid?I.toRgbString():"rgb(0,0,0)"}}else if(b==="background"||b==="background-color"){const I=new f.ColorKit(d);I.isValid&&(o.bg={rgb:I.toRgbString()})}else if(b==="text-decoration-line")d==="underline"?(o.ul||(o.ul={s:1}),o.ul.s=1):d==="line-through"?(o.st||(o.st={s:1}),o.st.s=1):d==="overline"&&(o.ol||(o.ol={s:1}),o.ol.s=1);else if(b==="text-decoration-color")o.hasOwnProperty("ul")&&(o.ul||(o.ul={s:1,cl:{rgb:d}}),o.ul.cl={rgb:d}),o.hasOwnProperty("st")&&(o.st||(o.st={s:1,cl:{rgb:d}}),o.st.cl={rgb:d}),o.hasOwnProperty("ol")&&(o.ol||(o.ol={s:1,cl:{rgb:d}}),o.ol.cl={rgb:d});else if(b==="text-decoration-style")o.hasOwnProperty("ul")&&(o.ul||(o.ul={s:1,t:Number(d)}),o.ul.t=Number(d)),o.hasOwnProperty("st")&&(o.st||(o.st={s:1,t:Number(d)}),o.st.t=Number(d)),o.hasOwnProperty("ol")&&(o.ol||(o.ol={s:1,t:Number(d)}),o.ol.t=Number(d));else if(b==="text-decoration"||b==="univer-strike"){const I=(w=d.split(" "))==null?void 0:w[0];I==="underline"?(o.ul||(o.ul={s:1}),o.ul.s=1):I==="line-through"?(o.st||(o.st={s:1}),o.st.s=1):I==="overline"&&(o.ol||(o.ol={s:1}),o.ol.s=1)}if(b==="univer-underline"&&(o.ul={s:1}),b==="vertical-align"&&(d==="sub"?o.va=f.BaselineOffset.SUBSCRIPT:d==="super"?o.va=f.BaselineOffset.SUPERSCRIPT:d==="top"?o.vt=1:d==="middle"?o.vt=2:d==="bottom"?o.vt=3:o.va=f.BaselineOffset.NORMAL),b==="transform"){const I=d.split(")"),_=I.findIndex(T=>T.includes("rotate"));if(_>-1){const T=I[_].match(/\d+/g);let O=0,S=0;T!=null&&T.length&&(O=+T[0]),e!=null&&e.dataset.vertical&&(S=+e.dataset.vertical),o.tr={a:O,v:S}}}if(b==="text-align"&&(d==="left"?o.ht=1:d==="center"?o.ht=2:d==="right"?o.ht=3:d==="justify"?o.ht=4:o.ht=0),o.tb!==1&&(b==="overflow-wrap"||b==="word-wrap"?d==="break-word"&&(o.tb=3):b==="text-overflow"?d==="clip"&&(o.tb=2):b==="text-break"&&d==="overflow"&&(o.tb=1)),b==="white-space"&&(d==="nowrap"?o.tb=1:d==="normal"?o.tb=3:d==="clip"&&(o.tb=2)),b==="border-color"){const I=z6(d,")");if(o.bd)for(const _ in I)o.bd[_].cl.rgb=I[_];else{o.bd={b:{cl:{rgb:"#000"},s:0},t:{cl:{rgb:"#000"},s:0},l:{cl:{rgb:"#000"},s:0},r:{cl:{rgb:"#000"},s:0}};for(const _ in I)o.bd[_].cl.rgb=I[_]}}if(b==="border-width"||b==="border-style"){const I=z6(d," ");for(const _ in I)i[_]+=` ${I[_]}`;o.bd?(o.bd.b.s=f.getBorderStyleType(i.b),o.bd.t.s=f.getBorderStyleType(i.t),o.bd.l.s=f.getBorderStyleType(i.l),o.bd.r.s=f.getBorderStyleType(i.r)):o.bd={b:{cl:{rgb:"#000"},s:f.getBorderStyleType(i.b)},t:{cl:{rgb:"#000"},s:f.getBorderStyleType(i.t)},l:{cl:{rgb:"#000"},s:f.getBorderStyleType(i.l)},r:{cl:{rgb:"#000"},s:f.getBorderStyleType(i.r)}}}if(b==="border-bottom"||b==="border-top"||b==="border-left"||b==="border-right"||b==="border"){o.bd||(o.bd={});const I=d.split(" "),_=`${I[0]} ${I[1]}`;I.splice(0,2);const T=I.join("");if(f.getBorderStyleType(_)!==f.BorderStyleTypes.NONE&&T){const S={cl:{rgb:T},s:f.getBorderStyleType(_)};b==="border-bottom"?o.bd.b=d==="none"?null:S:b==="border-top"?o.bd.t=d==="none"?null:S:b==="border-left"?o.bd.l=d==="none"?null:S:b==="border-right"?o.bd.r=d==="none"?null:S:b==="border"&&(o.bd={r:d==="none"?null:S,t:d==="none"?null:S,b:d==="none"?null:S,l:d==="none"?null:S})}}else if(b==="--data-rotate"){const I=/[+-]?\d+/,_=d.match(I);d==="(0deg ,1)"?o.tr={a:0,v:1}:_&&(o.tr={a:Number(_[0])})}}),Object.keys(o).forEach(h=>{typeof o[h]=="object"&&!Object.keys(o[h]).length&&delete o[h]}),o}function z6(e,n){let t;n===" "?t=e.trim().split(n):t=e.trim().split(n).slice(0,-1),t.forEach(o=>`${o.trim()})`);let r={};return t.length===1?r={t:t[0],r:t[0],b:t[0],l:t[0]}:t.length===2?r={t:t[0],r:t[1],b:t[0],l:t[1]}:t.length===3?r={t:t[0],r:t[1],b:t[2],l:t[1]}:t.length===4&&(r={t:t[0],r:t[1],b:t[2],l:t[3]}),r}function W6(e){if(e==="")return[e];const n=/(?:(\n+.+)|(.+))/g;return e.match(n).map(o=>o.replace(/\n/g,`\r
`))}function O0(e){const n=document.createElement("DIV"),t=[];n.innerHTML=e;const r=n.querySelectorAll("table col");if(!r.length)return[];for(let o=0;o<r.length;o++){const i=r[o],l=i.getAttribute("span");if(l&&+l>1)for(let c=0;c<+l;c++){const h=Se(i.getAttribute("width"),72);t.push(h)}else{const c=Se(i.getAttribute("width"),72);t.push(c)}}return t}function Se(e,n){if(!e)return n;let t;return e.includes("pt")?t=U1.ptToPx(Number.parseFloat(e)):e.includes("px")?t=Number.parseFloat(e):t=Number.parseFloat(e)*72/96,t}function R0(e){const n=document.createElement("DIV"),t=[];n.innerHTML=e;const r=n.querySelectorAll("table tr");if(!r.length)return[];for(let o=0;o<r.length;o++){const l=r[o].querySelectorAll("td");let c=Se(l[0].style.height,19);for(let h=0;h<l.length;h++){const p=l[h].getAttribute("rowSpan");if(!(p&&+p>1)){c=Se(l[h].style.height,19);break}}t.push(c)}return t}function V0(e){let n=[];const t=document.createElement("DIV");if(t.innerHTML=e,n=new Array(t.querySelectorAll("table tr").length),!n.length)return[];let r=0;const o=t.querySelectorAll("table tr");o[0].querySelectorAll("td").forEach(c=>{let h=0;const p=c.getAttribute("colSpan");p!==null?h=+p:h=1,r+=h});for(let c=0;c<n.length;c++)n[c]=new Array(r);let l=0;return o.forEach(c=>{let h=0;c.querySelectorAll("td").forEach(p=>{var I,_;const b={};if(p.querySelectorAll("span").length||p.querySelectorAll("font").length){const T=f3(p);typeof T!="string"&&(b.p=T)}const d=p.innerText;d.trim().length===0?b.v="":b.v=d;const w=_e(p);for(f.Tools.isPlainObject(w)&&(b.s=w);h<r&&n[l][h]!=null;)h++;if(h!==r){if(n[l][h]==null){n[l][h]=b;const T=(I=Number(p.getAttribute("rowSpan")))!=null?I:1,O=(_=Number(p.getAttribute("colSpan")))!=null?_:1;if(T>1||O>1){const S={rs:+T-1,cs:+O-1,r:l,c:h};n[l][h].mc=S;for(let A=0;A<T;A++)for(let R=0;R<O;R++)A===0&&R===0||(n[l+A][h+R]={mc:null})}}h++}}),l++}),n}function N0(e){const n=[],t=document.createElement("DIV");t.innerHTML=e;const o=e.replace(/\r/g,"").split(`
`),i=o[0].split("	").length;for(let l=0;l<o.length;l++)o[l].split("	").length<i||n.push(o[l].split("	"));for(let l=0;l<n.length;l++)for(let c=0;c<n[l].length;c++)n[l][c].length?n[l][c]={v:n[l][c]||"",m:n[l][c]||""}:n[l][c]=null;return n}function T0(e,n){e.length,e[0].length;let t=0,r=0;n&&(t=n.startRow,r=n.startColumn);const o=[];for(let i=0;i<e.length;i++)for(let l=0;l<e[i].length;l++)if(e[i][l]&&typeof e[i][l]=="object"&&"mc"in e[i][l])if(e[i][l].mc){const c=e[i][l].mc,h=c.r+t,p=h+c.rs,b=c.c+r,d=b+c.cs;o.push({startRow:h,endRow:p,startColumn:b,endColumn:d}),delete e[i][l].mc}else e[i][l]=null;return{data:e,mergeData:o}}function x0(e){var p;let n=[];const t=document.createElement("html");t.innerHTML=e;const r=(p=t.querySelector("style"))==null?void 0:p.innerText;if(!r)return;const o=$0(r);if(n=new Array(t.querySelectorAll("table tr").length),!n.length)return[];let i=0;const l=t.querySelectorAll("table tr");l[0].querySelectorAll("td").forEach(b=>{let d=0;const w=b.getAttribute("colSpan");w!==null?d=+w:d=1,i+=d});for(let b=0;b<n.length;b++)n[b]=new Array(i);let h=0;return l.forEach(b=>{let d=0;b.querySelectorAll("td").forEach(w=>{var S,A;const I={};if(w.querySelectorAll("span").length||w.querySelectorAll("font").length){const R=f3(w);typeof R!="string"&&(I.p=R)}const _=w.innerText;_.trim().length===0?I.v="":I.v=_;let T="";for(const R in o)w.classList.contains(R)&&(T+=o[R]);const O=_e(w,T);for(f.Tools.isPlainObject(O)&&(I.s=O);d<i&&n[h][d]!=null;)d++;if(d!==i){if(n[h][d]==null){n[h][d]=I;const R=(S=Number(w.getAttribute("rowSpan")))!=null?S:1,k=(A=Number(w.getAttribute("colSpan")))!=null?A:1;if(R>1||k>1){const M={rs:+R-1,cs:+k-1,r:h,c:d};n[h][d].mc=M;for(let $=0;$<R;$++)for(let D=0;D<k;D++)$===0&&D===0||(n[h+$][d+D]={mc:null})}}d++}}),h++}),n}function $0(e){const n={},t=e.replaceAll("<!--","").replaceAll("-->","").trim(),r=t==null?void 0:t.replaceAll("	","").replaceAll(`
`,"").split("}");for(let o=0;o<r.length;o++){if(!r[o])continue;let i=r[o].split("{")[0].trim();i.includes(".")&&(i=i.slice(1));const l=r[o].split("{")[1].trim();n[i]=l}return n}function Z0(e){const n=Math.round(e*D0);return n<j6?j6:n>U6?U6:n}function A0(e){const n=/font-family:\s*(?:"([^"]+)"|'([^']+)'|([^;]+))/i,t=e.match(n);return t?(t[1]||t[2]||t[3]).trim():null}const P0=s.memo(e=>{var T,O;const{layer:n,id:t,position:r}=e,o=V.useDependency(f.IUniverInstanceService),i=s.useRef(null),l=s.useRef(null),c=s.useRef(`transform: rotate(${r==null?void 0:r.rotate}deg) translate(${r==null?void 0:r.startX}px, ${r==null?void 0:r.startY}px)`),h=s.useRef((T=r==null?void 0:r.startY)!=null?T:0),p=s.useRef((O=r==null?void 0:r.startX)!=null?O:0),b=typeof n.componentKey=="string"?V.useDependency(v1).get(n.componentKey):n.componentKey,d=s.useMemo(()=>({data:n.data,...n.props}),[n.data,n.props]),w={width:`${r.width-4}px`,height:`${r.height-4}px`,left:`${r.absolute.left?0:"auto"}`,top:`${r.absolute.top?0:"auto"}`,right:`${r.absolute.left?"auto":0}`,bottom:`${r.absolute.top?"auto":0}`};c.current=`rotate(${r.rotate}deg)`,h.current=r.startY,p.current=r.startX;const I=o.getUnit(n.unitId),_=s.useMemo(()=>b?v.jsx(b,{...d,unitId:n.unitId,unit:I,floatDomId:n.id,context:{root:l}}):null,[b,d]);return r?v.jsx("div",{ref:i,className:"univer-absolute univer-z-10 univer-origin-center univer-overflow-hidden",style:{top:h.current,left:p.current,width:Math.max(r.endX-r.startX-2,0),height:Math.max(r.endY-r.startY-2,0),transform:c.current},onPointerMove:S=>{n.onPointerMove(S.nativeEvent)},onPointerDown:S=>{n.onPointerDown(S.nativeEvent)},onPointerUp:S=>{n.onPointerUp(S.nativeEvent)},onWheel:S=>{n.onWheel(S.nativeEvent)},children:v.jsx("div",{ref:l,id:t,className:"univer-absolute univer-overflow-hidden",style:{...w},children:_})}):null});C.BuiltInUIPart=i1,C.COLOR_PICKER_COMPONENT=k9,C.COMMON_LABEL_COMPONENT=$9,C.CanvasFloatDomService=Ce,C.CanvasPopup=We,C.CanvasPopupService=ze,C.CommonLabel=x9,C.ComponentContainer=p1,C.ComponentManager=v1,C.ContextMenu=_6,C.ContextMenuGroup=o1,C.ContextMenuPosition=S1,C.ContextMenuService=Ye,C.CopyCommand=Pe,C.CopyShortcutItem=f6,C.CustomLabel=f1,C.CutCommand=Fe,C.CutShortcutItem=C6,C.DISABLE_AUTO_FOCUS_KEY=B6,C.DesktopLocalFileService=i3,C.DesktopLocalStorageService=a3,C.DesktopMenu=Ae,C.DesktopSidebarService=c3,C.FILE_PNG_CLIPBOARD_MIME_TYPE=O6,C.FILE_SVG_XML_CLIPBOARD_MIME_TYPE=P4,C.FILE__BMP_CLIPBOARD_MIME_TYPE=V6,C.FILE__JPEG_CLIPBOARD_MIME_TYPE=R6,C.FILE__WEBP_CLIPBOARD_MIME_TYPE=N6,C.FONT_FAMILY_COMPONENT=z9,C.FONT_FAMILY_ITEM_COMPONENT=W9,C.FONT_SIZE_COMPONENT=Y9,C.FONT_SIZE_LIST=$2,C.FloatDom=je,C.FloatDomSingle=g6,C.FontFamily=B9,C.FontFamilyItem=j9,C.FontSize=G9,C.GlobalZone=Xe,C.HEADING_ITEM_COMPONENT=A9,C.HEADING_LIST=Z2,C.HTML_CLIPBOARD_MIME_TYPE=r3,C.HeadingItem=Z9,C.IBeforeCloseService=e3,C.ICanvasPopupService=he,C.IClipboardInterfaceService=o3,C.IConfirmService=be,C.IContextMenuService=ee,C.IDialogService=Le,C.IFontService=xe,C.IGalleryService=we,C.IGlobalZoneService=pe,C.ILayoutService=M1,C.ILeftSidebarService=Cn,C.ILocalFileService=l3,C.IMenuManagerService=I1,C.IMessageService=ue,C.INotificationService=ne,C.IPlatformService=de,C.IShortcutService=Z1,C.ISidebarService=x1,C.IUIController=te,C.IUIPartsService=w1,C.IZenZoneService=me,C.KeyCode=H1,C.MenuItemType=g1,C.MenuManagerPosition=G1,C.MetaKeys=h1,C.MobileContextMenu=H6,C.MockMessageService=H0,C.PLAIN_TEXT_CLIPBOARD_MIME_TYPE=n3,C.PasteCommand=ke,C.PlatformService=Be,C.PrintFloatDomSingle=P0,C.ProgressBar=J2,C.RectPopup=ve,C.RedoShortcutItem=v6,C.Ribbon=M6,C.RibbonDataGroup=$1,C.RibbonFormulasGroup=ce,C.RibbonInsertGroup=Y1,C.RibbonOthersGroup=Ze,C.RibbonPosition=C1,C.RibbonStartGroup=_1,C.RibbonViewGroup=X1,C.SheetPasteShortKeyCommandName=o4,C.ShortcutPanelService=ie,C.Sidebar=qe,C.SingleCanvasPopup=b6,C.SingleUnitUIController=Qe,C.Slider=V2,C.TestConfirmService=U4,C.ThemeSwitcherService=K1,C.ToggleShortcutPanelOperation=j1,C.ToolbarButton=w6,C.ToolbarItem=Q1,C.UIMenu=Ae,C.UIMenuSchema=i6,C.UIPartsService=Ue,C.UI_PLUGIN_CONFIG_KEY=V1,C.UNIVER_UI_PLUGIN_NAME=k6,C.UNI_DISABLE_CHANGING_FOCUS_KEY=Q2,C.UndoShortcutItem=h6,C.ZIndexManager=W1,C.ZenZone=Je,C.getHeaderFooterMenuHiddenObservable=D2,C.getMenuHiddenObservable=E2,C.handelExcelToJson=x0,C.handelTableToJson=V0,C.handleDomToJson=f3,C.handlePlainToJson=N0,C.handleStringToStyle=_e,C.handleTableColgroup=O0,C.handleTableMergeData=T0,C.handleTableRowGroup=R0,C.imageMimeTypeSet=F4,C.mergeMenuConfigs=N9,C.splitSpanText=W6,C.supportClipboardAPI=D6,C.t=U2,C.textTrim=Me,C.useClickOutSide=P2,C.useComponentsOfPart=m1,C.useConfigValue=F9,C.useDebounceFn=F2,C.useEvent=R1,C.useObservableRef=T9,C.useScrollYOverContainer=P9,C.useSidebarClick=E0,C.useToolbarItemStatus=y6,C.useUpdateEffect=A2,C.useVirtualList=B2,Object.keys(V).forEach(e=>{e!=="default"&&!Object.prototype.hasOwnProperty.call(C,e)&&Object.defineProperty(C,e,{enumerable:!0,get:()=>V[e]})}),Object.defineProperty(C,Symbol.toStringTag,{value:"Module"})}));


// @univerjs/ui/facade
(function(s,d){typeof exports=="object"&&typeof module<"u"?d(require("@univerjs/core/facade"),require("@univerjs/engine-render"),require("@univerjs/ui"),require("@univerjs/core")):typeof define=="function"&&define.amd?define(["@univerjs/core/facade","@univerjs/engine-render","@univerjs/ui","@univerjs/core"],d):(s=typeof globalThis<"u"?globalThis:s||self,d(s.UniverCoreFacade,s.UniverEngineRender,s.UniverUi,s.UniverCore))})(this,(function(s,d,r,c){"use strict";var F=Object.defineProperty;var E=(s,d,r)=>d in s?F(s,d,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[d]=r;var u=(s,d,r)=>E(s,typeof d!="symbol"?d+"":d,r);var v;var f=Object.getOwnPropertyDescriptor,I=(a,e,t,n)=>{for(var i=n>1?void 0:n?f(e,t):e,o=a.length-1,h;o>=0;o--)(h=a[o])&&(i=h(i)||i);return i},m=(a,e)=>(t,n)=>e(t,n,a);class b extends s.FBase{appendTo(e){const t=typeof e=="string"?e.split("|"):e,n=t.length,i={};let o=i;const h=this.__getSchema();t.forEach((l,P)=>{P===n-1?o[l]=h:o[l]={},o=o[l]}),this._menuManagerService.mergeMenu(i)}}let g=(v=class extends b{constructor(e,t,n,i){super();u(this,"_commandToRegister",new Map);u(this,"_buildingSchema");this._item=e,this._injector=t,this._commandService=n,this._menuManagerService=i;const o=typeof e.action=="string"?e.action:c.generateRandomId(12);o!==e.action&&this._commandToRegister.set(o,e.action),this._buildingSchema={menuItemFactory:()=>({id:e.id,type:r.MenuItemType.BUTTON,icon:e.icon,title:e.title,tooltip:e.tooltip,commandId:o})},typeof e.order<"u"&&(this._buildingSchema.order=e.order)}__getSchema(){return this._commandToRegister.forEach((e,t)=>{this._commandService.hasCommand(t)||this._commandService.registerCommand({id:t,type:c.CommandType.COMMAND,handler:e})}),{[this._item.id]:this._buildingSchema}}},u(v,"RibbonStartGroup",r.RibbonStartGroup),u(v,"RibbonPosition",r.RibbonPosition),u(v,"MenuManagerPosition",r.MenuManagerPosition),v);g=I([m(1,c.Inject(c.Injector)),m(2,c.ICommandService),m(3,r.IMenuManagerService)],g);let p=class extends b{constructor(e,t,n){super();u(this,"_menuByGroups",[]);u(this,"_submenus",[]);u(this,"_buildingSchema");this._item=e,this._injector=t,this._menuManagerService=n,this._buildingSchema={menuItemFactory:()=>({id:e.id,type:r.MenuItemType.SUBITEMS,icon:e.icon,title:e.title,tooltip:e.tooltip})},typeof e.order<"u"&&(this._buildingSchema.order=e.order)}addSubmenu(e){return this._submenus.push(e),this}addSeparator(){return this._menuByGroups.push(this._submenus),this._submenus=[],this}__getSchema(){const e={};return this.addSeparator(),this._menuByGroups.forEach((t,n)=>{const i={};t.forEach(o=>{Object.assign(i,o.__getSchema())}),e[`${this._item.id}-group-${n}`]=i}),{[this._item.id]:Object.assign(this._buildingSchema,e)}}};p=I([m(1,c.Inject(c.Injector)),m(2,r.IMenuManagerService)],p);var C=Object.getOwnPropertyDescriptor,j=(a,e,t,n)=>{for(var i=n>1?void 0:n?C(e,t):e,o=a.length-1,h;o>=0;o--)(h=a[o])&&(i=h(i)||i);return i},S=(a,e)=>(t,n)=>e(t,n,a);let _=class extends s.FBase{constructor(e,t,n,i){super();u(this,"_forceDisableDisposable",null);this._injector=e,this._renderManagerService=t,this._univerInstanceService=n,this._shortcutService=i}enableShortcut(){var e;return(e=this._forceDisableDisposable)==null||e.dispose(),this._forceDisableDisposable=null,this}disableShortcut(){return this._forceDisableDisposable||(this._forceDisableDisposable=this._shortcutService.forceDisable()),this}triggerShortcut(e){const t=this._univerInstanceService.getCurrentUnitForType(c.UniverInstanceType.UNIVER_SHEET);if(!t)return;const n=this._renderManagerService.getRenderById(t.getUnitId());return n?(n.engine.getCanvasElement().dispatchEvent(e),this._shortcutService.dispatch(e)):void 0}dispatchShortcutEvent(e){return this._shortcutService.dispatch(e)}};_=j([S(0,c.Inject(c.Injector)),S(1,c.Inject(d.IRenderManagerService)),S(2,c.IUniverInstanceService),S(3,r.IShortcutService)],_);class M extends s.FUniver{getURL(){return new URL(window.location.href)}getShortcut(){return this._injector.createInstance(_)}copy(){return this._commandService.executeCommand(r.CopyCommand.id)}paste(){return this._commandService.executeCommand(r.PasteCommand.id)}createMenu(e){return this._injector.createInstance(g,e)}createSubmenu(e){return this._injector.createInstance(p,e)}openSiderbar(e){return this._injector.get(r.ISidebarService).open(e)}openSidebar(e){return this.openSiderbar(e)}openDialog(e){const n=this._injector.get(r.IDialogService).open({...e,onClose:()=>{n.dispose()}});return n}getComponentManager(){return this._injector.get(r.ComponentManager)}showMessage(e){return this._injector.get(r.IMessageService).show(e),this}setUIVisible(e,t){return this._injector.get(r.IUIPartsService).setUIVisible(e,t),this}isUIVisible(e){return this._injector.get(r.IUIPartsService).isUIVisible(e)}registerUIPart(e,t){return this._injector.get(r.IUIPartsService).registerComponent(e,()=>r.connectInjector(t,this._injector))}registerComponent(e,t,n){const i=this._injector.get(r.ComponentManager);return this.disposeWithMe(i.register(e,t,n))}setCurrent(e){if(!this._injector.get(d.IRenderManagerService).getRenderById(e))throw new Error("Unit not found");this._univerInstanceService.setCurrentUnitForType(e)}addFonts(e){const t=this._injector.get(r.IFontService);e.forEach(n=>{t.addFont({...n,isCustom:!0})})}}s.FUniver.extend(M);class U extends s.FHooks{onBeforeCopy(e){return this._injector.get(c.ICommandService).beforeCommandExecuted(n=>{n.id===r.CopyCommand.id&&e()})}onCopy(e){return this._injector.get(c.ICommandService).onCommandExecuted(n=>{n.id===r.CopyCommand.id&&e()})}onBeforePaste(e){return this._injector.get(c.ICommandService).beforeCommandExecuted(n=>{n.id===r.PasteCommand.id&&e()})}onPaste(e){return this._injector.get(c.ICommandService).onCommandExecuted(n=>{(n.id===r.PasteCommand.id||n.id===r.SheetPasteShortKeyCommandName)&&e()})}}s.FHooks.extend(U);class y extends s.FEnum{get BuiltInUIPart(){return r.BuiltInUIPart}get KeyCode(){return r.KeyCode}}s.FEnum.extend(y)}));


// @univerjs/docs/index
(function(l,r){typeof exports=="object"&&typeof module<"u"?r(exports,require("@univerjs/core"),require("@univerjs/engine-render"),require("rxjs")):typeof define=="function"&&define.amd?define(["exports","@univerjs/core","@univerjs/engine-render","rxjs"],r):(l=typeof globalThis<"u"?globalThis:l||self,r(l.UniverDocs={},l.UniverCore,l.UniverEngineRender,l.rxjs))})(this,(function(l,r,v,p){"use strict";var de=Object.defineProperty;var ge=(l,r,v)=>r in l?de(l,r,{enumerable:!0,configurable:!0,writable:!0,value:v}):l[r]=v;var g=(l,r,v)=>ge(l,typeof r!="symbol"?r+"":r,v);var w;const M={id:"doc.operation.set-selections",type:r.CommandType.OPERATION,handler:()=>!0};var L=Object.getOwnPropertyDescriptor,G=(c,s,e,t)=>{for(var n=t>1?void 0:t?L(s,e):s,i=c.length-1,o;i>=0;i--)(o=c[i])&&(n=o(n)||n);return n},N=(c,s)=>(e,t)=>s(e,t,c);l.DocSelectionManagerService=class extends r.RxDisposable{constructor(e,t){super();g(this,"_currentSelection",null);g(this,"_textSelectionInfo",new Map);g(this,"_textSelection$",new p.Subject);g(this,"textSelection$",this._textSelection$.asObservable());g(this,"_refreshSelection$",new p.BehaviorSubject(null));g(this,"refreshSelection$",this._refreshSelection$.asObservable());this._commandService=e,this._univerInstanceService=t,this._listenCurrentUnit()}_listenCurrentUnit(){this._univerInstanceService.getCurrentTypeOfUnit$(r.UniverInstanceType.UNIVER_DOC).pipe(p.takeUntil(this.dispose$)).subscribe(e=>{if(e==null)return;const t=e.getUnitId();this._setCurrentSelectionNotRefresh({unitId:t,subUnitId:t})})}__getCurrentSelection(){return this._currentSelection}getSelectionInfo(e=this._currentSelection){return this._getTextRanges(e)}refreshSelection(e=this._currentSelection){e!=null&&this._refresh(e)}__TEST_ONLY_setCurrentSelection(e){this._currentSelection=e,this._refresh(e)}getTextRanges(e=this._currentSelection){var t;return(t=this._getTextRanges(e))==null?void 0:t.textRanges}getRectRanges(e=this._currentSelection){var t;return(t=this._getTextRanges(e))==null?void 0:t.rectRanges}getDocRanges(e=this._currentSelection){var o,a;const t=(o=this.getTextRanges(e))!=null?o:[],n=(a=this.getRectRanges(e))!=null?a:[];return[...t,...n].filter(u=>u.startOffset!=null&&u.endOffset!=null).sort((u,d)=>u.startOffset>d.startOffset?1:u.startOffset<d.startOffset?-1:0)}getActiveTextRange(){const e=this._getTextRanges(this._currentSelection);if(e==null)return;const{textRanges:t}=e;return t.find(n=>n.isActive)}getActiveRectRange(){const e=this._getTextRanges(this._currentSelection);if(e==null)return;const{rectRanges:t}=e;return t.find(n=>n.isActive)}__TEST_ONLY_add(e,t=!0){this._currentSelection!=null&&this._addByParam({...this._currentSelection,textRanges:e,rectRanges:[],segmentId:"",segmentPage:-1,isEditing:t,style:v.NORMAL_TEXT_SELECTION_PLUGIN_STYLE})}replaceTextRanges(e,t=!0,n){return this.replaceDocRanges(e,this._currentSelection,t,n)}replaceDocRanges(e,t=this._currentSelection,n=!0,i){if(t==null)return;const{unitId:o,subUnitId:a}=t;this._refreshSelection$.next({unitId:o,subUnitId:a,docRanges:e,isEditing:n,options:i})}__replaceTextRangesWithNoRefresh(e,t){if(this._currentSelection==null)return;const n={...e,...t};this._replaceByParam(n),this._textSelection$.next(n);const{unitId:i,subUnitId:o,segmentId:a,style:u,textRanges:d,rectRanges:h,isEditing:S}=n,I=[...d,...h].filter(_=>_.startOffset!=null&&_.endOffset!=null).sort((_,f)=>_.startOffset>f.startOffset?1:_.startOffset<f.startOffset?-1:0);this._commandService.executeCommand(M.id,{unitId:i,subUnitId:o,segmentId:a,style:u,isEditing:S,ranges:I})}dispose(){this._textSelection$.complete(),this._refreshSelection$.complete()}_setCurrentSelectionNotRefresh(e){this._currentSelection=e}_getTextRanges(e){var i;if(e==null)return;const{unitId:t,subUnitId:n=""}=e;return(i=this._textSelectionInfo.get(t))==null?void 0:i.get(n)}_refresh(e){const t=this._getTextRanges(e);if(t==null)return;const{textRanges:n,rectRanges:i}=t,o=[...n,...i],{unitId:a,subUnitId:u}=e;this._refreshSelection$.next({unitId:a,subUnitId:u,docRanges:o,isEditing:!1})}_replaceByParam(e){const{unitId:t,subUnitId:n,...i}=e;this._textSelectionInfo.has(t)||this._textSelectionInfo.set(t,new Map),this._textSelectionInfo.get(t).set(n,{...i})}_addByParam(e){const{unitId:t,subUnitId:n,...i}=e;this._textSelectionInfo.has(t)||this._textSelectionInfo.set(t,new Map);const o=this._textSelectionInfo.get(t);o.has(n)?o.get(n).textRanges.push(...e.textRanges):o.set(n,{...i})}},l.DocSelectionManagerService=G([N(0,r.ICommandService),N(1,r.IUniverInstanceService)],l.DocSelectionManagerService);var z=Object.getOwnPropertyDescriptor,W=(c,s,e,t)=>{for(var n=t>1?void 0:t?z(s,e):s,i=c.length-1,o;i>=0;i--)(o=c[i])&&(n=o(n)||n);return n},$=(c,s)=>(e,t)=>s(e,t,c);l.DocSkeletonManagerService=class extends r.RxDisposable{constructor(e,t,n){super();g(this,"_skeleton");g(this,"_docViewModel");g(this,"_currentSkeleton$",new p.BehaviorSubject(null));g(this,"currentSkeleton$",this._currentSkeleton$.asObservable());g(this,"_currentSkeletonBefore$",new p.BehaviorSubject(null));g(this,"currentSkeletonBefore$",this._currentSkeletonBefore$.asObservable());g(this,"_currentViewModel$",new p.BehaviorSubject(null));g(this,"currentViewModel$",this._currentViewModel$.asObservable());this._context=e,this._localeService=t,this._univerInstanceService=n,this._init(),this._univerInstanceService.getCurrentTypeOfUnit$(r.UniverInstanceType.UNIVER_DOC).pipe(p.takeUntil(this.dispose$)).subscribe(i=>{i&&i.getUnitId()===this._context.unitId&&this._update(i)})}dispose(){super.dispose(),this._currentSkeletonBefore$.complete(),this._currentSkeleton$.complete()}getSkeleton(){return this._skeleton}getViewModel(){return this._docViewModel}_init(){const e=this._context.unit;this._update(e)}_update(e){const t=this._context.unitId;if(e.getBody()==null)return;this._docViewModel&&r.isInternalEditorID(t)?(this._docViewModel.reset(e),this._context.unit=e):this._docViewModel||(this._docViewModel=this._buildDocViewModel(e)),this._skeleton||(this._skeleton=this._buildSkeleton(this._docViewModel));const n=this._skeleton;n.calculate(),this._currentSkeletonBefore$.next(n),this._currentSkeleton$.next(n),this._currentViewModel$.next(this._docViewModel)}_buildSkeleton(e){return v.DocumentSkeleton.create(e,this._localeService)}_buildDocViewModel(e){return new v.DocumentViewModel(e)}},l.DocSkeletonManagerService=W([$(1,r.Inject(r.LocaleService)),$(2,r.IUniverInstanceService)],l.DocSkeletonManagerService);class y extends r.RxDisposable{constructor(){super();g(this,"_docStateChangeParams$",new p.BehaviorSubject(null));g(this,"docStateChangeParams$",this._docStateChangeParams$.asObservable())}emitStateChangeInfo(e){this._docStateChangeParams$.next(e)}dispose(){super.dispose(),this._docStateChangeParams$.complete()}}const P="doc.mutation.rich-text-editing",O={id:P,type:r.CommandType.MUTATION,handler:(c,s)=>{var X,F;const{unitId:e,segmentId:t="",actions:n,textRanges:i,prevTextRanges:o,trigger:a,noHistory:u,isCompositionEnd:d,noNeedSetTextRange:h,debounce:S,isEditing:I=!0,isSync:_,syncer:f}=s,D=c.get(r.IUniverInstanceService),R=c.get(v.IRenderManagerService),C=c.get(y),m=D.getUniverDocInstance(e),V=(X=R.getRenderById(e))==null?void 0:X.with(l.DocSkeletonManagerService).getViewModel();if(m==null||V==null)throw new Error(`DocumentDataModel or documentViewModel not found for unitId: ${e}`);const j=c.get(l.DocSelectionManagerService),E=(F=j.getDocRanges())!=null?F:[],le=!!m.getSnapshot().disabled;if(r.JSONX.isNoop(n)||n&&n.length===0||le)return{unitId:e,actions:[],textRanges:E};const A=r.JSONX.invertWithDoc(n,m.getSnapshot());m.apply(n),V.reset(m),!h&&i&&a!=null&&!_&&queueMicrotask(()=>{j.replaceDocRanges(i,{unitId:e,subUnitId:e},I,s.options)});const ue={commandId:P,unitId:e,segmentId:t,trigger:a,noHistory:u,debounce:S,redoState:{actions:n,textRanges:i},undoState:{actions:A,textRanges:o!=null?o:E},isCompositionEnd:d,isSync:_,syncer:f};return C.emitStateChangeInfo(ue),{unitId:e,actions:A,textRanges:E}}},J={id:"doc.mutation.rename-doc",type:r.CommandType.MUTATION,handler:(c,s)=>{const t=c.get(r.IUniverInstanceService).getUnit(s.unitId,r.UniverInstanceType.UNIVER_DOC);return t?(t.setName(s.name),!0):!1}},Y="docs.config",B={};var K=Object.getOwnPropertyDescriptor,q=(c,s,e,t)=>{for(var n=t>1?void 0:t?K(s,e):s,i=c.length-1,o;i>=0;i--)(o=c[i])&&(n=o(n)||n);return n},U=(c,s)=>(e,t)=>s(e,t,c);let T=class extends r.Disposable{constructor(c,s,e){super(),this._commandService=c,this._textSelectionManagerService=s,this._univerInstanceService=e,this._initSelectionChange()}_transformCustomRange(c,s){var o;const{startOffset:e,endOffset:t,collapsed:n}=s,i=(o=c.getCustomRanges())==null?void 0:o.filter(a=>!a.wholeEntity||e<=a.startIndex&&t>a.endIndex?!1:n?a.startIndex<e&&a.endIndex>=t:r.BuildTextUtils.range.isIntersects(e,t-1,a.startIndex,a.endIndex));if(i!=null&&i.length){let a=e,u=t;return i.forEach(d=>{a=Math.min(d.startIndex,a),u=Math.max(d.endIndex+1,u)}),{...s,startOffset:a,endOffset:u,collapsed:a===u}}return s}_initSelectionChange(){this.disposeWithMe(this._commandService.onCommandExecuted(c=>{if(c.id===M.id){const s=c.params,{unitId:e,ranges:t,isEditing:n}=s,i=this._univerInstanceService.getUnit(e);if(!i)return;const o=t.map(a=>this._transformCustomRange(i,a));o.some((a,u)=>t[u]!==a)&&this._textSelectionManagerService.replaceTextRanges(o,n)}}))}};T=q([U(0,r.ICommandService),U(1,r.Inject(l.DocSelectionManagerService)),U(2,r.IUniverInstanceService)],T);var H=Object.getOwnPropertyDescriptor,Q=(c,s,e,t)=>{for(var n=t>1?void 0:t?H(s,e):s,i=c.length-1,o;i>=0;i--)(o=c[i])&&(n=o(n)||n);return n},k=(c,s)=>(e,t)=>s(e,t,c);const Z="DOCS_PLUGIN";l.UniverDocsPlugin=(w=class extends r.Plugin{constructor(s=B,e,t){super(),this._config=s,this._injector=e,this._configService=t;const{...n}=r.merge({},B,this._config);this._configService.setConfig(Y,n)}onStarting(){this._initializeDependencies(),this._initializeCommands()}_initializeCommands(){[O,J,M].forEach(s=>{this._injector.get(r.ICommandService).registerCommand(s)})}_initializeDependencies(){[[l.DocSelectionManagerService],[y],[T]].forEach(s=>this._injector.add(s))}onReady(){this._injector.get(T)}},g(w,"pluginName",Z),w),l.UniverDocsPlugin=Q([k(1,r.Inject(r.Injector)),k(2,r.IConfigService)],l.UniverDocsPlugin);const ee=r.createInterceptorKey("CUSTOM_RANGE"),te=r.createInterceptorKey("CUSTOM_DECORATION"),x={CUSTOM_RANGE:ee,CUSTOM_DECORATION:te};var ne=Object.getOwnPropertyDescriptor,ie=(c,s,e,t)=>{for(var n=t>1?void 0:t?ne(s,e):s,i=c.length-1,o;i>=0;i--)(o=c[i])&&(n=o(n)||n);return n},se=(c,s)=>(e,t)=>s(e,t,c);l.DocInterceptorService=class extends r.Disposable{constructor(e,t){super();g(this,"_interceptorsByName",new Map);this._context=e,this._docSkeletonManagerService=t;const n=this._docSkeletonManagerService.getViewModel(),i=n.getDataModel().getUnitId();if(i===r.DOCS_NORMAL_EDITOR_UNIT_ID_KEY||i===r.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY)return;this.disposeWithMe(this.interceptDocumentViewModel(n)),this.disposeWithMe(this.intercept(x.CUSTOM_RANGE,{priority:-1,handler:(a,u,d)=>d(a)}));let o=new r.DisposableCollection;n.segmentViewModels$.subscribe(a=>{o.dispose(),o=new r.DisposableCollection,a.forEach(u=>{o.add(this.interceptDocumentViewModel(u))})}),this.disposeWithMe(o)}intercept(e,t){const n=e;this._interceptorsByName.has(n)||this._interceptorsByName.set(n,[]);const i=this._interceptorsByName.get(n);return i.push(t),this._interceptorsByName.set(n,i.sort((o,a)=>{var u,d;return((u=a.priority)!=null?u:0)-((d=o.priority)!=null?d:0)})),this.disposeWithMe(r.toDisposable(()=>r.remove(this._interceptorsByName.get(n),t)))}fetchThroughInterceptors(e){const t=e,n=this._interceptorsByName.get(t);return r.composeInterceptors(n||[])}interceptDocumentViewModel(e){const t=new r.DisposableCollection;return t.add(e.registerCustomRangeInterceptor({getCustomRange:n=>{var i;return this.fetchThroughInterceptors(x.CUSTOM_RANGE)(e.getCustomRangeRaw(n),{index:n,unitId:e.getDataModel().getUnitId(),customRanges:(i=e.getDataModel().getCustomRanges())!=null?i:[]})},getCustomDecoration:n=>{var i;return this.fetchThroughInterceptors(x.CUSTOM_DECORATION)(e.getCustomDecorationRaw(n),{index:n,unitId:e.getDataModel().getUnitId(),customDecorations:(i=e.getDataModel().getCustomDecorations())!=null?i:[]})}})),t}},l.DocInterceptorService=ie([se(1,r.Inject(l.DocSkeletonManagerService))],l.DocInterceptorService);function b(c,s=""){if(!s)return["body"];const{headers:e,footers:t}=c.getSnapshot();if(e==null&&t==null)throw new Error("Document data model must have headers or footers when update by segment id");if((e==null?void 0:e[s])!=null)return["headers",s,"body"];if((t==null?void 0:t[s])!=null)return["footers",s,"body"];throw new Error("Segment id not found in headers or footers")}function re(c,s,e){const{unitId:t,segmentId:n}=s,o=c.get(r.IUniverInstanceService).getUnit(t);if(!o)return!1;const a={id:O.id,params:{unitId:s.unitId,actions:[],textRanges:void 0}},u=r.JSONX.getInstance(),d=r.BuildTextUtils.customRange.add({...s,body:e});if(!d)return!1;const h=b(o,n);return a.params.actions=u.editOp(d.serialize(),h),a}function oe(c,s){var m;const{rangeId:e,rangeType:t,wholeEntity:n,properties:i,unitId:o,selections:a}=s,u=c.get(l.DocSelectionManagerService),d=c.get(r.IUniverInstanceService),h=a!=null?a:u.getTextRanges({unitId:o,subUnitId:o}),S=(m=h==null?void 0:h[0])==null?void 0:m.segmentId;if(!(h!=null&&h.length))return!1;const I=d.getUnit(o,r.UniverInstanceType.UNIVER_DOC);if(!I)return!1;const _=I.getSelfOrHeaderFooterModel(S).getBody();if(!_)return!1;const f=r.BuildTextUtils.customRange.add({ranges:h,rangeId:e,rangeType:t,segmentId:S,wholeEntity:n,properties:i,body:_});if(!f)return!1;const D=r.JSONX.getInstance(),R={id:O.id,params:{unitId:o,actions:[],textRanges:f.selections,segmentId:S},textX:f},C=b(I,S);return R.params.actions=D.editOp(f.serialize(),C),R}function ce(c,s){const{unitId:e,segmentId:t,insert:n}=s,o=c.get(r.IUniverInstanceService).getUnit(e);if(!o)return!1;const a={id:O.id,params:{unitId:s.unitId,actions:[],textRanges:void 0,segmentId:t}},u=r.JSONX.getInstance(),d=r.BuildTextUtils.customRange.delete({documentDataModel:o,rangeId:s.rangeId,insert:n,segmentId:t});if(!d)return!1;const h=b(o,t);return a.params.actions=u.editOp(d.serialize(),h),a.params.textRanges=d.selections,a}function ae(c,s){var f,D,R,C;const{unitId:e,body:t,doc:n}=s;let i=n;if(i||(i=c.get(r.IUniverInstanceService).getUnit(e)),!i)return!1;const o=(f=s.selection)==null?void 0:f.segmentId,a=(D=i.getSelfOrHeaderFooterModel(o))==null?void 0:D.getBody();if(!a)return!1;const u=c.get(l.DocSelectionManagerService),d=(R=s.selection)!=null?R:u.getActiveTextRange();if(!d||!a)return!1;const h=(C=s.textRanges)!=null?C:[{startOffset:d.startOffset+t.dataStream.length,endOffset:d.startOffset+t.dataStream.length,collapsed:!0,segmentId:o}],S=r.BuildTextUtils.selection.replace({selection:d,body:t,doc:i});if(!S)return!1;const I={id:O.id,params:{unitId:e,actions:[],textRanges:h,debounce:!0,segmentId:o},textX:S},_=r.JSONX.getInstance();return I.params.actions=_.editOp(S.serialize()),I}l.DOC_INTERCEPTOR_POINT=x,l.DocStateEmitService=y,l.RichTextEditingMutation=O,l.SetTextSelectionsOperation=M,l.addCustomRangeBySelectionFactory=oe,l.addCustomRangeFactory=re,l.deleteCustomRangeFactory=ce,l.replaceSelectionFactory=ae,Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})}));


// @univerjs/docs-ui/index
(function(y,s){typeof exports=="object"&&typeof module<"u"?s(exports,require("@univerjs/core"),require("@univerjs/docs"),require("@univerjs/engine-render"),require("@univerjs/ui"),require("@univerjs/drawing"),require("rxjs"),require("react"),require("rxjs/operators"),require("react/jsx-runtime"),require("@univerjs/design")):typeof define=="function"&&define.amd?define(["exports","@univerjs/core","@univerjs/docs","@univerjs/engine-render","@univerjs/ui","@univerjs/drawing","rxjs","react","rxjs/operators","react/jsx-runtime","@univerjs/design"],s):(y=typeof globalThis<"u"?globalThis:y||self,s(y.UniverDocsUi={},y.UniverCore,y.UniverDocs,y.UniverEngineRender,y.UniverUi,y.UniverDrawing,y.rxjs,y.React,y.rxjs.operators,y.React,y.UniverDesign))})(this,(function(y,s,D,_,I,Mn,L,U,lt,P,J){"use strict";var OA=Object.defineProperty;var RA=(y,s,D)=>s in y?OA(y,s,{enumerable:!0,configurable:!0,writable:!0,value:D}):y[s]=D;var B=(y,s,D)=>RA(y,typeof s!="symbol"?s+"":s,D);var ha=Object.getOwnPropertyDescriptor,ga=(o,t,e,n)=>{for(var i=n>1?void 0:n?ha(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},ni=(o,t)=>(e,n)=>t(e,n,o);y.DocAutoFormatService=class extends s.Disposable{constructor(e,n){super();B(this,"_matches",new Map);this._univerInstanceService=e,this._textSelectionManagerService=n}registerAutoFormat(e){const n=this._matches.get(e.id);return n?(n.push(e),n.sort((i,a)=>{var r,c;return((r=a.priority)!=null?r:0)-((c=i.priority)!=null?c:0)})):this._matches.set(e.id,[e]),s.toDisposable(()=>{const i=this._matches.get(e.id);if(i){const a=i.findIndex(r=>r===e);a>=0&&i.splice(a,1)}})}onAutoFormat(e,n){var l,A,d,u,m,h,g,p,f;const i=(l=this._matches.get(e))!=null?l:[],a=this._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),r=this._textSelectionManagerService.getDocRanges(),c=(A=r.find(S=>S.isActive))!=null?A:r[0];if(a&&c){const S=a.getSelfOrHeaderFooterModel(c.segmentId),E={unit:S,selection:c,isBody:!c.segmentId,paragraphs:s.BuildTextUtils.range.getParagraphsInRange(c,(u=(d=S.getBody())==null?void 0:d.paragraphs)!=null?u:[],(h=(m=S.getBody())==null?void 0:m.dataStream)!=null?h:""),customRanges:s.BuildTextUtils.customRange.getCustomRangesInterestsWithSelection(c,(p=(g=S.getBody())==null?void 0:g.customRanges)!=null?p:[]),commandId:e,commandParams:n},C=i.find(T=>T.match(E));return(f=C==null?void 0:C.getMutations(E))!=null?f:[]}return[]}},y.DocAutoFormatService=ga([ni(0,s.IUniverInstanceService),ni(1,s.Inject(D.DocSelectionManagerService))],y.DocAutoFormatService);const oi={undo:!0,redo:!0,font:!0,fontSize:!0,bold:!0,italic:!0,strikethrough:!0,underline:!0,textColor:!0,fillColor:!0,horizontalAlignMode:!0,verticalAlignMode:!0,textWrapMode:!0,textRotateMode:!0},ii={outerLeft:!1,outerRight:!1,header:!0,footer:!0,innerLeft:!1,innerRight:!1,frozenHeaderLT:!1,frozenHeaderRT:!1,frozenHeaderLM:!1,frozenContent:!1,infoBar:!0,toolbar:!0},si="DOC_UI_PLUGIN";var de=(o=>(o.MAIN="__Document_Render_Main__",o.BACKGROUND="__Document_Render_Background__",o))(de||{}),ae=(o=>(o.VIEW_MAIN="viewMain",o.VIEW_TOP="viewTop",o.VIEW_LEFT="viewLeft",o.VIEW_LEFT_TOP="viewLeftTop",o))(ae||{});const ai=0,Ut=2,ri=4,xn=10,ma="normalTextSelectionPluginName";function Ie(o){const{mainComponent:t,scene:e,engine:n,components:i}=o,a=t,r=i.get(de.BACKGROUND);return{document:a,docBackground:r,scene:e,engine:n}}function ci(o,t){const e=o.getCurrentUnitOfType(s.UniverInstanceType.UNIVER_DOC);if(!e)return null;const n=e.getUnitId(),i=t.getRenderById(n);if(i==null)return;const{mainComponent:a,scene:r,engine:c,components:l}=i,A=a,d=l.get(de.BACKGROUND);return{document:A,docBackground:d,scene:r,engine:c}}function pa(o,t){const e=t.getRenderById(o);if(e==null)return;const{mainComponent:n,scene:i,engine:a,components:r}=e,c=n,l=r.get(de.BACKGROUND);return{document:c,docBackground:l,scene:i,engine:a}}function li(o){const{unitId:t,ranges:e,id:n,type:i,segmentId:a}=o,r={id:D.RichTextEditingMutation.id,params:{unitId:t,actions:[],textRanges:void 0,segmentId:a}},c=s.JSONX.getInstance(),l=s.BuildTextUtils.customDecoration.add({ranges:e,id:n,type:i});return r.params.actions=c.editOp(l.serialize()),r}function fa(o,t){const{segmentId:e,id:n,type:i,unitId:a}=t,r=o.get(D.DocSelectionManagerService),c=o.get(s.IUniverInstanceService),l=a?c.getUnit(a,s.UniverInstanceType.UNIVER_DOC):c.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);if(!l)return!1;const A=l.getUnitId(),d=r.getTextRanges({unitId:A,subUnitId:A});return!d||!l.getBody()?!1:li({unitId:A,ranges:d,id:n,type:i,segmentId:e})}function Sa(o,t){const{unitId:e,id:n,segmentId:i}=t,r=o.get(s.IUniverInstanceService).getUnit(e);if(!r)return!1;const c={id:D.RichTextEditingMutation.id,params:{unitId:e,actions:[],textRanges:void 0,segmentId:i}},l=s.BuildTextUtils.customDecoration.delete({id:n,segmentId:i,documentDataModel:r});if(!l)return!1;const A=s.JSONX.getInstance();return c.params.actions=A.editOp(l.serialize()),c}function Ia(o,t){return t.some(e=>o.startIndex>e.startIndex&&o.startIndex<e.endIndex)}function wt(o,t,e,n,i){const{textRuns:a=[],dataStream:r}=o,c=i&&r.startsWith("="),l={st:0,ed:0,ts:{}};if(c)return l;for(let A=a.length-1;A>=0;A--){const d=a[A],{st:u,ed:m}=d;t>u&&t<=m&&(l.st=u,l.ed=m,l.ts={...l.ts,...d.ts})}if(t===0){const A=a==null?void 0:a[0];A&&A.st===0&&(l.ts={...l.ts,...A.ts})}return n&&(l.ts={...l.ts,...n}),l}function Dn(o,t,e){if(e){const i=o.find(a=>t>=a.startIndex&&t<=a.endIndex+1);return i!=null&&i.wholeEntity?null:i}const n=o.find(i=>t>i.startIndex&&t<=i.endIndex);return n!=null&&n.wholeEntity?null:n}function Bn(o,t){return o.filter(e=>t>e.startIndex&&t<=e.endIndex)}function va(o){return{left:o.positionH.posOffset,top:o.positionV.posOffset,width:o.size.width,height:o.size.height}}function Ea(o,t=0,e=0){return{size:{width:o.width,height:o.height},positionH:{relativeFrom:s.ObjectRelativeFromH.MARGIN,posOffset:(o.left||0)-t},positionV:{relativeFrom:s.ObjectRelativeFromV.PAGE,posOffset:(o.top||0)-e},angle:o.angle||0}}const ke={id:"doc.command.tab",type:s.CommandType.COMMAND,async handler(o,t){const n=o.get(y.DocAutoFormatService).onAutoFormat(ke.id,t);return(await s.sequenceExecuteAsync(n,o.get(s.ICommandService))).result}},dt={id:"doc.command.after-space",type:s.CommandType.COMMAND,async handler(o){const e=o.get(y.DocAutoFormatService).onAutoFormat(dt.id);return(await s.sequenceExecuteAsync(e,o.get(s.ICommandService))).result}},ze={id:"doc.command.enter",type:s.CommandType.COMMAND,async handler(o){const e=o.get(y.DocAutoFormatService).onAutoFormat(ze.id);return(await s.sequenceExecuteAsync(e,o.get(s.ICommandService))).result}};var Ca=Object.getOwnPropertyDescriptor,Ta=(o,t,e,n)=>{for(var i=n>1?void 0:n?Ca(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},_n=(o,t)=>(e,n)=>t(e,n,o);const ya=11,ba=9,Lt={ff:"Arial",fs:ya};let ve=class extends s.Disposable{constructor(t,e,n){super();B(this,"_cacheStyle",null);this._textSelectionManagerService=t,this._univerInstanceService=e,this._renderManagerService=n,this._init()}_init(){this._listenDocRangeChange()}_listenDocRangeChange(){this.disposeWithMe(this._textSelectionManagerService.textSelection$.subscribe(()=>{this._clearStyleCache()}))}getStyleCache(){return this._cacheStyle}getDefaultStyle(){var r;const t=this._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);if(t==null)return{...Lt};const e=t==null?void 0:t.getUnitId(),n=(r=this._renderManagerService.getRenderById(e))==null?void 0:r.with(D.DocSkeletonManagerService),i=n==null?void 0:n.getViewModel();return i==null?{...Lt}:i.getEditArea()===_.DocumentEditArea.BODY?{...Lt}:{...Lt,fs:ba}}setStyleCache(t){this._cacheStyle={...this._cacheStyle,...t}}_clearStyleCache(){this._cacheStyle=null}};ve=Ta([_n(0,s.Inject(D.DocSelectionManagerService)),_n(1,s.IUniverInstanceService),_n(2,_.IRenderManagerService)],ve);function re(o,t){var n;return(n=o.get(_.IRenderManagerService).getRenderById(t))==null?void 0:n.with(D.DocSkeletonManagerService)}function Z(o,t=""){if(!t)return["body"];const{headers:e,footers:n}=o.getSnapshot();if(e==null&&n==null)throw new Error("Document data model must have headers or footers when update by segment id");if((e==null?void 0:e[t])!=null)return["headers",t,"body"];if((n==null?void 0:n[t])!=null)return["footers",t,"body"];throw new Error("Segment id not found in headers or footers")}function Nn(o,t,e){const n=[];for(let i=0,a=o.length;i<a;i++)o[i]===s.DataStreamTreeTokenType.PARAGRAPH&&n.push({startIndex:i});if(t)for(const i of n)t.bullet&&(i.bullet=s.Tools.deepClone(t.bullet)),t.paragraphStyle&&(i.paragraphStyle=s.Tools.deepClone(t.paragraphStyle),delete i.paragraphStyle.borderBottom,t.paragraphStyle.headingId&&(i.paragraphStyle.headingId=s.generateRandomId(6)));if(e)for(const i of n)i.paragraphStyle||(i.paragraphStyle={}),i.paragraphStyle.borderBottom=e;return n}const Qt={id:"doc.command.break-line",type:s.CommandType.COMMAND,handler:(o,t)=>{var Q,j,X,k,W;const e=o.get(D.DocSelectionManagerService),n=o.get(s.IUniverInstanceService),i=o.get(s.ICommandService),a=o.get(ve),r=(Q=t==null?void 0:t.textRange)!=null?Q:e.getActiveTextRange(),c=e.getRectRanges();if(r==null)return!1;if(c&&c.length){const{startOffset:G}=r;return e.replaceDocRanges([{startOffset:G,endOffset:G}]),!0}const{horizontalLine:l}=t!=null?t:{},{segmentId:A}=r,d=n.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),u=d==null?void 0:d.getSelfOrHeaderFooterModel(A!=null?A:"").getBody();if(d==null||u==null)return!1;const m=d.getUnitId(),{startOffset:h,endOffset:g}=r,f=((j=u.paragraphs)!=null?j:[]).find(G=>G.startIndex>=h);if(!f)return!1;const S=h===f.startIndex,E=f.startIndex,C=a.getDefaultStyle(),T=a.getStyleCache(),R=wt(u,g,C,T),v={dataStream:s.DataStreamTreeTokenType.PARAGRAPH,paragraphs:Nn(s.DataStreamTreeTokenType.PARAGRAPH,f,l),textRuns:[{st:0,ed:1,ts:{...R.ts}}]};if(d==null)return!1;const O=e.getActiveTextRange();if(u==null)return!1;const{collapsed:M}=r,b=v.dataStream.length,N=[{startOffset:h+b,endOffset:h+b,style:O==null?void 0:O.style,collapsed:M}],x={id:D.RichTextEditingMutation.id,params:{unitId:m,actions:[],textRanges:N,debounce:!0}},w=new s.TextX,F=s.JSONX.getInstance();if(M)h>0&&w.push({t:s.TextXActionType.RETAIN,len:h}),w.push({t:s.TextXActionType.INSERT,body:v,len:v.dataStream.length});else{const G=s.BuildTextUtils.selection.delete([r],u,0,v);w.push(...G)}(((X=f.bullet)==null?void 0:X.listType)===s.PresetListType.CHECK_LIST_CHECKED||(k=f.paragraphStyle)!=null&&k.headingId)&&(r.endOffset<E&&w.push({t:s.TextXActionType.RETAIN,len:E-r.endOffset}),w.push({t:s.TextXActionType.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...f,paragraphStyle:{...f.paragraphStyle,...S?{headingId:void 0,namedStyleType:void 0}:null},startIndex:0,bullet:(W=f.paragraphStyle)!=null&&W.headingId?void 0:{...f.bullet,listType:s.PresetListType.CHECK_LIST}}]},coverType:s.UpdateDocsAttributeType.REPLACE})),x.params.textRanges=[{startOffset:h+b,endOffset:h+b,collapsed:M}];const V=Z(d,A);return x.params.actions=F.editOp(w.serialize(),V),!!i.syncExecuteCommand(x.id,x.params)}};var Ft=(o=>(o[o.ABOVE=0]="ABOVE",o[o.BELLOW=1]="BELLOW",o))(Ft||{}),Pn=(o=>(o[o.LEFT=0]="LEFT",o[o.RIGHT=1]="RIGHT",o))(Pn||{});function Oa(o,t){let e=s.DataStreamTreeTokenType.TABLE_START;const n=[],i=[];for(let a=0;a<o;a++){e+=s.DataStreamTreeTokenType.TABLE_ROW_START;for(let r=0;r<t;r++)e+=`${s.DataStreamTreeTokenType.TABLE_CELL_START}\r
${s.DataStreamTreeTokenType.TABLE_CELL_END}`,n.push({startIndex:e.length-3,paragraphStyle:{spaceAbove:{v:3},lineSpacing:2,spaceBelow:{v:0}}}),i.push({startIndex:e.length-2});e+=s.DataStreamTreeTokenType.TABLE_ROW_END}return e+=s.DataStreamTreeTokenType.TABLE_END,{dataStream:e,paragraphs:n,sectionBreaks:i}}function Ht(){return{margin:{start:{v:10},end:{v:10},top:{v:5},bottom:{v:5}}}}function kt(o){const t=Ht();return{tableCells:[...new Array(o).fill(null).map(()=>s.Tools.deepClone(t))],trHeight:{val:{v:30},hRule:s.TableRowHeightRule.AUTO}}}function Vt(o){return{size:{type:s.TableSizeType.SPECIFIED,width:{v:o}}}}function Un(o,t,e){const n=Vt(e/t),i=kt(t),a=[...new Array(o).fill(null).map(()=>s.Tools.deepClone(i))],r=[...new Array(t).fill(null).map(()=>s.Tools.deepClone(n))],c=s.generateRandomId(6);return{tableRows:a,tableColumns:r,tableId:c,align:s.TableAlignmentType.START,indent:{v:0},textWrap:s.TableTextWrapType.NONE,position:{positionH:{relativeFrom:s.ObjectRelativeFromH.PAGE,posOffset:0},positionV:{relativeFrom:s.ObjectRelativeFromV.PAGE,posOffset:0}},dist:{distB:0,distL:0,distR:0,distT:0},cellMargin:{start:{v:10},end:{v:10},top:{v:5},bottom:{v:5}},size:{type:s.TableSizeType.UNSPECIFIED,width:{v:e}}}}function At(o,t){if(!o&&!t)return null;if(t&&t.length>0){let e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;const i="";for(const a of t){const{startOffset:r,endOffset:c,segmentId:l}=a;r==null||c==null||l==null||(e=Math.min(e,r),n=Math.max(n,c))}if(Number.isFinite(e)&&Number.isFinite(n))return{startOffset:e,endOffset:n,segmentId:i}}else if(o){const{startOffset:e,endOffset:n,segmentId:i}=o;return e==null||n==null||i==null?null:{startOffset:e,endOffset:n,segmentId:i}}}function Ra(o){let t=s.DataStreamTreeTokenType.TABLE_ROW_START;const e=[],n=[];for(let i=0;i<o;i++)t+=`${s.DataStreamTreeTokenType.TABLE_CELL_START}\r
${s.DataStreamTreeTokenType.TABLE_CELL_END}`,e.push({startIndex:t.length-3,paragraphStyle:{spaceAbove:{v:3},lineSpacing:2,spaceBelow:{v:0}}}),n.push({startIndex:t.length-2});return t+=s.DataStreamTreeTokenType.TABLE_ROW_END,{dataStream:t,paragraphs:e,sectionBreaks:n}}function Ma(){const o=`${s.DataStreamTreeTokenType.TABLE_CELL_START}\r
${s.DataStreamTreeTokenType.TABLE_CELL_END}`,t=[],e=[];return t.push({startIndex:1,paragraphStyle:{spaceAbove:{v:3},lineSpacing:2,spaceBelow:{v:0}}}),e.push({startIndex:2}),{dataStream:o,paragraphs:t,sectionBreaks:e}}function xa(o,t,e){var u,m,h;const{startOffset:n,endOffset:i,segmentId:a}=o,r=e.getSelfOrHeaderFooterViewModel(a),c=t===0?n:i;let l=null;const A=(h=(m=(u=e.getBody())==null?void 0:u.tables)==null?void 0:m.find(g=>c>=g.startIndex&&c<=g.endIndex))==null?void 0:h.tableId;let d=0;for(const g of r.getChildren()){for(const p of g.children){const{children:f}=p,S=f[0];if(S){for(const E of S.children)if(E.startIndex<=c&&c<=E.endIndex){d=S.children.indexOf(E),l=E;break}}if(l)break}if(l)break}return l==null||A==null?null:{offset:t===0?l.startIndex:l.endIndex+1,colCount:l.children.length,tableId:A,insertRowIndex:t===0?d:d+1}}function Da(o,t,e){var h,g,p;const{startOffset:n,endOffset:i,segmentId:a}=o,r=e.getSelfOrHeaderFooterViewModel(a),c=t===0?n:i,l=(p=(g=(h=e.getBody())==null?void 0:h.tables)==null?void 0:g.find(f=>c>=f.startIndex&&c<=f.endIndex))==null?void 0:p.tableId,A=[];let d=null,u=-1;for(const f of r.getChildren()){for(const S of f.children){const{children:E}=S,C=E[0];if(C){if(c<C.startIndex||c>C.endIndex)continue;d=C;for(const T of C.children){for(const R of T.children){const v=T.children.indexOf(R);if(c>=R.startIndex&&c<=R.endIndex){u=v;break}}if(u!==-1)break}}if(d)break}if(d)break}if(d==null||l==null||u===-1)return null;let m=0;for(const f of d.children){const S=f.children[u],E=t===0?S.startIndex:S.endIndex+1;A.push(E-m),m=E}return{offsets:A,tableId:l,columnIndex:u,rowCount:d.children.length}}function Ba(o,t,e){const n=[];let i=t[e].size.width.v,a=0;for(let r=0;r<t.length;r++)a+=t[r].size.width.v;a+=i;for(let r=0;r<t.length;r++)n.push(t[r].size.width.v/a*o);return i=i/a*o,{widths:n,newColWidth:i}}function di(o,t){var m,h,g;const{startOffset:e,endOffset:n,segmentId:i}=o,a=t.getSelfOrHeaderFooterViewModel(i),r=(g=(h=(m=t.getBody())==null?void 0:m.tables)==null?void 0:h.find(p=>e>=p.startIndex&&n<=p.endIndex))==null?void 0:g.tableId,c=[];let l=-1,A=0,d=-1,u=!1;for(const p of a.getChildren()){for(const f of p.children){const{children:S}=f,E=S[0];if(E){if(e<E.startIndex||n>E.endIndex)continue;d=E.startIndex+3;for(const C of E.children){const T=E.children.indexOf(C),{startIndex:R,endIndex:v}=C;e>=R&&e<=v?(l=R,c.push(T),A+=v-R+1):(R>e&&v<n||n>=R&&n<=v)&&(c.push(T),A+=v-R+1),c.length===E.children.length&&(u=!0)}}if(c.length)break}if(c.length)break}return r==null||c.length===0?null:{tableId:r,rowIndexes:c,offset:l,len:A,cursor:d,selectWholeTable:u}}function _a(o,t){var g,p,f;const{startOffset:e,endOffset:n,segmentId:i}=o,a=t.getSelfOrHeaderFooterViewModel(i),r=(f=(p=(g=t.getBody())==null?void 0:g.tables)==null?void 0:p.find(S=>e>=S.startIndex&&n<=S.endIndex))==null?void 0:f.tableId,c=[];let l=null;const A=[];let d=-1,u=-1,m=-1;for(const S of a.getChildren()){for(const E of S.children){const{children:C}=E,T=C[0];if(T){if(e<T.startIndex||n>T.endIndex)continue;l=T;for(const R of T.children)for(const v of R.children){const O=R.children.indexOf(v);e>=v.startIndex&&e<=v.endIndex&&(u=O),n>=v.startIndex&&n<=v.endIndex&&(m=O)}}if(l)break}if(l)break}if(l==null||r==null)return null;for(let S=u;S<=m;S++)A.push(S);let h=0;for(const S of l.children){const E=S.children[u],C=S.children[m];c.push({retain:E.startIndex-h,delete:C.endIndex-E.startIndex+1}),h=C.endIndex+1}return d=l.startIndex+3,{offsets:c,tableId:r,columnIndexes:A,cursor:d,selectWholeTable:A.length===l.children[0].children.length,rowCount:l.children.length}}function Ai(o,t){var d,u,m;const{startOffset:e,endOffset:n,segmentId:i}=o,a=t.getSelfOrHeaderFooterViewModel(i),r=(m=(u=(d=t.getBody())==null?void 0:d.tables)==null?void 0:u.find(h=>e>=h.startIndex&&n<=h.endIndex))==null?void 0:m.tableId;let c=-1,l=0,A=-1;for(const h of a.getChildren()){for(const g of h.children){const{children:p}=g,f=p[0];if(f){if(e<f.startIndex||n>f.endIndex)continue;c=f.startIndex,l=f.endIndex-f.startIndex+1,A=f.startIndex}if(f)break}if(l>0)break}return r==null?null:{tableId:r,offset:c,len:l,cursor:A}}function Na(o,t){var g,p,f;const{startOffset:e,endOffset:n,segmentId:i}=o,a=t.getSelfOrHeaderFooterViewModel(i),r=(f=(p=(g=t.getBody())==null?void 0:g.tables)==null?void 0:p.find(S=>e>=S.startIndex&&n<=S.endIndex))==null?void 0:f.tableId,c=[];let l=null,A=-1,d=-1,u=-1,m=-1;for(const S of a.getChildren()){for(const E of S.children){const{children:C}=E,T=C[0];if(T){if(e<T.startIndex||n>T.endIndex)continue;l=T;for(const R of T.children){const v=T.children.indexOf(R);for(const O of R.children){const M=R.children.indexOf(O);e>=O.startIndex&&e<=O.endIndex&&(d=v,u=M),n>=O.startIndex&&n<=O.endIndex&&(m=M)}}}if(l)break}if(l)break}if(l==null||r==null||d===-1)return null;const h=l.children[d];for(let S=u;S<=m;S++){const E=h.children[S];c.push({retain:E.startIndex+1,delete:E.endIndex-E.startIndex-3})}return A=l.startIndex+3,{offsets:c,tableId:r,cursor:A,rowCount:l.children.length}}var wn=(o=>(o[o.NEXT=0]="NEXT",o[o.PREV=1]="PREV",o))(wn||{});function ui(o,t,e){const{startOffset:n}=t;let i=null;for(const A of o.getChildren()){for(const d of A.children){const u=d.children[0];if(u&&n>u.startIndex&&n<u.endIndex){i=u;break}}if(i)break}if(i==null)return null;let a=-1,r=-1,c=null;for(const A of i.children){for(const d of A.children)if(n>d.startIndex&&n<d.endIndex){a=A.children.indexOf(d),r=i.children.indexOf(A),c=A;break}if(a>-1)break}if(a===-1||r===-1||c==null)return null;let l=null;if(e===0){if(l=c.children[a+1],!l){const A=i.children[r+1];A&&(l=A.children[0])}}else if(l=c.children[a-1],!l){const A=i.children[r-1];A&&(l=A.children[A.children.length-1])}if(l){const{startIndex:A,endIndex:d}=l;return{startOffset:A+1,endOffset:d-2}}}function hi(o,t){const e=[],{customBlocks:n=[]}=o;for(const i of t){const{startOffset:a,endOffset:r}=i;if(!(a==null||r==null))for(const c of n){const{startIndex:l}=c;l>=a&&l<r&&e.push(c.blockId)}}return e}function Pa(o){return o.some(t=>{const{startNodePosition:e}=t;return e?(e==null?void 0:e.path.indexOf("cells"))>-1:!1})}const Ua=s.SHEET_EDITOR_UNITS,Ln={id:"doc.command.inner-paste",type:s.CommandType.COMMAND,handler:async(o,t)=>{var b,N,x,w,F,V;const{segmentId:e,textRanges:n,doc:i}=t,a=o.get(s.ICommandService),r=o.get(D.DocSelectionManagerService),c=o.get(s.IUniverInstanceService),l=r.getTextRanges(),A=r.getRectRanges(),{body:d,tableSource:u,drawings:m}=i;if(!Array.isArray(l)||l.length===0||d==null)return!1;const h=c.getCurrentUniverDocInstance(),g=h==null?void 0:h.getSelfOrHeaderFooterModel(e).getBody();if(h==null||g==null)return!1;const p=h.getUnitId(),f={id:D.RichTextEditingMutation.id,params:{unitId:p,actions:[],textRanges:n,segmentId:e}},S=new s.MemoryCursor;S.reset();const E=new s.TextX,C=s.JSONX.getInstance(),T=[],R=!!((b=d.tables)!=null&&b.length),v=!!((N=d.customBlocks)!=null&&N.length);if(R&&e||R&&Pa(l)||l.length&&(A!=null&&A.length))return!1;for(let H=0;H<l.length;H++){const Q=l[H],{startOffset:j,endOffset:X,collapsed:k}=Q,W=j-S.cursor,G=s.Tools.deepClone(d);if(R)for(const q of G.tables){const{tableId:z}=q,$=s.generateRandomId(6);q.tableId=$;const ie=s.Tools.deepClone(u[z]);ie.tableId=$;const fe=C.insertOp(["tableSource",$],ie);T.push(fe)}if(v&&m){const q=(w=(x=h.getSnapshot().drawingsOrder)==null?void 0:x.length)!=null?w:0;for(const z of G.customBlocks){const{blockId:$}=z,ie=s.generateRandomId(6);z.blockId=ie;const fe=s.Tools.deepClone(m[$]);fe.drawingId=ie;const He=C.insertOp(["drawings",ie],fe),Se=C.insertOp(["drawingsOrder",q],ie);T.push(He),T.push(Se)}}const K=Dn((F=g.customRanges)!=null?F:[],X,Ua.includes(p)),Y=Bn((V=g.customDecorations)!=null?V:[],X);if(K&&(G.customRanges=[{...K,startIndex:0,endIndex:d.dataStream.length-1}]),Y.length&&(G.customDecorations=Y.map(q=>({...q,startIndex:0,endIndex:d.dataStream.length-1}))),k)E.push({t:s.TextXActionType.RETAIN,len:W}),E.push({t:s.TextXActionType.INSERT,body:G,len:d.dataStream.length});else{const q=s.BuildTextUtils.selection.delete([Q],d,S.cursor,G,l.length===1);E.push(...q)}S.reset(),S.moveCursor(X)}const O=Z(h,e);return T.push(C.editOp(E.serialize(),O)),f.params.actions=T.reduce((H,Q)=>s.JSONX.compose(H,Q),null),!!a.syncExecuteCommand(f.id,f.params)}};function wa(o,t){const{startOffset:e,endOffset:n}=o,i=t.some(r=>r.startIndex===n),a=Math.max(e,i?n-1:n);return{...o,endOffset:a,collapsed:e===a}}function La(o,t,e){var g,p;const n=t.getSelfOrHeaderFooterModel(e).getBody(),i=new s.TextX,a=s.JSONX.getInstance(),r=[];if(n==null)return r;const{tables:c=[]}=n,l=new s.MemoryCursor;l.reset();for(let f=0;f<o.length;f++){const S=wa(o[f],c),{startOffset:E,endOffset:C,collapsed:T}=S,R=E-l.cursor;T?i.push({t:s.TextXActionType.RETAIN,len:R}):i.push(...s.BuildTextUtils.selection.delete([S],n,l.cursor,null,!1)),l.reset(),l.moveCursor(C)}const A=Z(t,e);r.push(a.editOp(i.serialize(),A));const d=hi(n,o),u=(g=t.getDrawings())!=null?g:{},m=(p=t.getDrawingsOrder())!=null?p:[],h=d.sort((f,S)=>m.indexOf(f)>m.indexOf(S)?-1:m.indexOf(f)<m.indexOf(S)?1:0);if(h.length>0)for(const f of h){const S=u[f],E=m.indexOf(f);if(S==null||E<0)continue;const C=a.removeOp(["drawings",f],S),T=a.removeOp(["drawingsOrder",E],f);r.push(C),r.push(T)}return r.reduce((f,S)=>s.JSONX.compose(f,S),null)}function Qa(o,t,e,n){const i=[];if(t.getSelfOrHeaderFooterModel(n).getBody()==null)return i;const r=new s.TextX,c=s.JSONX.getInstance(),l=new s.MemoryCursor;l.reset();for(const d of o){const{startOffset:u,endOffset:m,spanEntireRow:h,spanEntireTable:g}=d;if(!(u==null||m==null))if(g){const p=Ai({startOffset:u,endOffset:m,segmentId:n},e);if(p==null)continue;const{offset:f,len:S,tableId:E}=p;f-l.cursor>0&&r.push({t:s.TextXActionType.RETAIN,len:f-l.cursor}),r.push({t:s.TextXActionType.DELETE,len:S});const C=c.removeOp(["tableSource",E]);i.push(C),l.moveCursorTo(f+S)}else if(h){const p=di({startOffset:u,endOffset:m,segmentId:n},e);if(p==null)continue;const{offset:f,rowIndexes:S,len:E,tableId:C}=p;f-l.cursor>0&&r.push({t:s.TextXActionType.RETAIN,len:f-l.cursor}),r.push({t:s.TextXActionType.DELETE,len:E});for(const T of S.reverse()){const R=c.removeOp(["tableSource",C,"tableRows",T]);i.push(R)}l.moveCursorTo(f+E)}else{const p=Na({startOffset:u,endOffset:m,segmentId:n},e);if(p==null)continue;const{offsets:f}=p;for(const S of f){const{retain:E,delete:C}=S;E-l.cursor>0&&r.push({t:s.TextXActionType.RETAIN,len:E-l.cursor}),r.push({t:s.TextXActionType.DELETE,len:C}),l.moveCursorTo(E+C)}}}const A=Z(t,n);return i.push(c.editOp(r.serialize(),A)),i.reduce((d,u)=>s.JSONX.compose(d,u),null)}function gi(o,t,e,n,i){let a=[];if(Array.isArray(o)&&(o==null?void 0:o.length)!==0&&(a=La(o,e,i)),Array.isArray(t)&&(t==null?void 0:t.length)!==0){const r=Qa(t,e,n,i);a==null||a.length===0?a=r:a=s.JSONX.compose(a,s.JSONX.transform(r,a,"right"))}return a}const Ve={id:"doc.command.inner-cut",type:s.CommandType.COMMAND,handler:(o,t)=>{var p;const e=o.get(D.DocSelectionManagerService),n=o.get(s.ICommandService),i=o.get(s.IUniverInstanceService),{segmentId:a,textRanges:r,selections:c=e.getTextRanges(),rectRanges:l=e.getRectRanges()}=t;if((!Array.isArray(c)||c.length===0)&&(!Array.isArray(l)||l.length===0))return!1;const A=(p=i.getCurrentUniverDocInstance())==null?void 0:p.getUnitId();if(!A)return!1;const d=i.getUniverDocInstance(A);if(d==null)return!1;const u=re(o,A);if(u==null)return!1;const m=u.getViewModel(),h={id:D.RichTextEditingMutation.id,params:{unitId:A,actions:[],textRanges:r}};return h.params.actions=gi(c,l,d,m,a),!!n.syncExecuteCommand(h.id,h.params)}};var oe=(o=>(o[o.LEFT=0]="LEFT",o[o.RIGHT=1]="RIGHT",o))(oe||{});const mi="doc.command.insert-text",Qn={id:mi,type:s.CommandType.COMMAND,handler:async(o,t)=>{var v;const e=o.get(s.ICommandService),{range:n,segmentId:i,body:a,unitId:r,cursorOffset:c}=t,l=o.get(D.DocSelectionManagerService),d=o.get(s.IUniverInstanceService).getUnit(r,s.UniverInstanceType.UNIVER_DOC);if(d==null)return!1;const u=l.getActiveTextRange(),m=d.getSelfOrHeaderFooterModel((v=u==null?void 0:u.segmentId)!=null?v:"").getBody();if(m==null)return!1;const{startOffset:h,collapsed:g}=n,p=c!=null?c:a.dataStream.length,f=[{startOffset:h+p,endOffset:h+p,style:u==null?void 0:u.style,collapsed:g}],S={id:D.RichTextEditingMutation.id,params:{unitId:r,actions:[],textRanges:f,debounce:!0}},E=new s.TextX,C=s.JSONX.getInstance();if(g)h>0&&E.push({t:s.TextXActionType.RETAIN,len:h}),E.push({t:s.TextXActionType.INSERT,body:a,len:a.dataStream.length});else{const O=s.BuildTextUtils.selection.delete([n],m,0,a);E.push(...O)}S.params.textRanges=[{startOffset:h+p,endOffset:h+p,collapsed:g}];const T=Z(d,i);return S.params.actions=C.editOp(E.serialize(),T),!!e.syncExecuteCommand(S.id,S.params)}},Ye={id:"doc.command.delete-text",type:s.CommandType.COMMAND,handler:async(o,t)=>{var R;const e=o.get(s.ICommandService),n=o.get(s.IUniverInstanceService),{range:i,segmentId:a,unitId:r,direction:c,len:l=1}=t,A=n.getUnit(r,s.UniverInstanceType.UNIVER_DOC),d=A==null?void 0:A.getSelfOrHeaderFooterModel(a).getBody();if(A==null||d==null)return!1;const{startOffset:u}=i;let m=c===oe.LEFT?u-l:u,h=c===oe.LEFT?u-1:u+l-1;const g=(R=d.customRanges)==null?void 0:R.find(v=>v.startIndex<=m&&v.endIndex>=h);g!=null&&g.wholeEntity&&(m=g.startIndex,h=Math.max(h,g.endIndex));const p={id:D.RichTextEditingMutation.id,params:{unitId:r,actions:[],textRanges:[{startOffset:m,endOffset:m,collapsed:!0}],debounce:!0}},f=new s.TextX,S=s.JSONX.getInstance();f.push({t:s.TextXActionType.RETAIN,len:m-0}),f.push({t:s.TextXActionType.DELETE,len:h-m+1});const C=Z(A,a);return p.params.actions=S.editOp(f.serialize(),C),!!e.syncExecuteCommand(p.id,p.params)}},Fn={id:"doc.command.update-text",type:s.CommandType.COMMAND,handler:async(o,t)=>{const{range:e,segmentId:n,updateBody:i,coverType:a,unitId:r,textRanges:c}=t,l=o.get(s.ICommandService),d=o.get(s.IUniverInstanceService).getCurrentUniverDocInstance();if(d==null)return!1;const u={id:D.RichTextEditingMutation.id,params:{unitId:r,actions:[],textRanges:c}},m=new s.TextX,h=s.JSONX.getInstance(),{startOffset:g,endOffset:p}=e;m.push({t:s.TextXActionType.RETAIN,len:g}),m.push({t:s.TextXActionType.RETAIN,body:i,len:p-g,coverType:a});const f=Z(d,n);return u.params.actions=h.editOp(m.serialize(),f),!!l.syncExecuteCommand(u.id,u.params)}};function ut(o){var r,c,l,A;const t=o.get(s.IUniverInstanceService),n=o.get(D.DocSelectionManagerService).getActiveTextRange(),i=t.getCurrentUnitOfType(s.UniverInstanceType.UNIVER_DOC);return!n||!n.collapsed||!i||n.segmentId?!1:s.BuildTextUtils.range.getParagraphsInRange(n,(c=(r=i.getBody())==null?void 0:r.paragraphs)!=null?c:[],(A=(l=i.getBody())==null?void 0:l.dataStream)!=null?A:"")[0]}const Wt={id:"doc.command.delete-custom-block",type:s.CommandType.COMMAND,handler:async(o,t)=>{var x;const e=o.get(D.DocSelectionManagerService),n=o.get(s.IUniverInstanceService),i=o.get(s.ICommandService),a=e.getActiveTextRange(),r=n.getCurrentUniverDocInstance();if(a==null||r==null)return!1;const{direction:c,range:l,unitId:A,drawingId:d}=t,{startOffset:u,segmentId:m,style:h}=a,g=c===oe.LEFT?u-1:u,p=[{startOffset:g,endOffset:g,style:h}],f={id:D.RichTextEditingMutation.id,params:{unitId:A,actions:[],textRanges:p,prevTextRanges:[l]}},S=new s.TextX,E=s.JSONX.getInstance(),C=[];u>0&&S.push({t:s.TextXActionType.RETAIN,len:c===oe.LEFT?u-1:u}),S.push({t:s.TextXActionType.DELETE,len:1});const T=Z(r,m);C.push(E.editOp(S.serialize(),T));const R=((x=r.getDrawings())!=null?x:{})[d],O=r.getDrawingsOrder().indexOf(d),M=E.removeOp(["drawings",d],R),b=E.removeOp(["drawingsOrder",O],d);return C.push(M),C.push(b),f.params.actions=C.reduce((w,F)=>s.JSONX.compose(w,F),null),!!i.syncExecuteCommand(f.id,f.params)}},Gt={id:"doc.command.merge-two-paragraph",type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(D.DocSelectionManagerService),n=o.get(s.IUniverInstanceService),i=o.get(s.ICommandService),{direction:a,range:r}=t,c=e.getActiveTextRange(),l=e.getTextRanges();if(c==null||l==null)return!1;const{segmentId:A,style:d}=c,u=n.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),m=u==null?void 0:u.getSelfOrHeaderFooterModel(A).getBody();if(u==null||m==null)return!1;const h=m.dataStream,g=c,p=u.getUnitId(),{startOffset:f,collapsed:S}=g;if(!S)return!1;const E=a===oe.LEFT?f:f+1;let C,T;for(const V of m.paragraphs){if(V.startIndex>=E){T=V;break}C=V}if(C==null||T==null)return!1;const R=a===oe.LEFT?f-1:f,v=[{startOffset:R,endOffset:R,style:d}],O={id:D.RichTextEditingMutation.id,params:{unitId:p,actions:[],textRanges:v,prevTextRanges:[r]}},M=new s.TextX,b=s.JSONX.getInstance();C.startIndex>0&&M.push({t:s.TextXActionType.RETAIN,len:C.startIndex}),M.push({t:s.TextXActionType.DELETE,len:1}),T.startIndex>C.startIndex+1&&M.push({t:s.TextXActionType.RETAIN,len:T.startIndex-C.startIndex-1});const N=Object.values(s.DataStreamTreeTokenType),x=h[C.startIndex-1];(x&&!N.includes(x)||x===" ")&&M.push({t:s.TextXActionType.RETAIN,len:1,coverType:s.UpdateDocsAttributeType.REPLACE,body:{dataStream:"",paragraphs:[{...s.Tools.deepClone(C),startIndex:0}]}});const w=Z(u,A);return O.params.actions=b.editOp(M.serialize(),w),!!i.syncExecuteCommand(O.id,O.params)}},pi={id:"doc.command.remove-horizontal-line",type:s.CommandType.COMMAND,handler:async o=>{var R;const t=o.get(D.DocSelectionManagerService),e=o.get(s.IUniverInstanceService),n=o.get(s.ICommandService),i=t.getActiveTextRange(),a=t.getTextRanges();if(i==null||a==null)return!1;const{segmentId:r,style:c}=i,l=e.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),A=l==null?void 0:l.getSelfOrHeaderFooterModel(r).getBody();if(l==null||A==null)return!1;const d=i,u=l.getUnitId(),{startOffset:m,collapsed:h}=d;if(!h)return!1;const g=(R=A.paragraphs)==null?void 0:R.find(v=>v.startIndex===m-1);if(g==null)return!1;const p=[{startOffset:m,endOffset:m,style:c}],f={id:D.RichTextEditingMutation.id,params:{unitId:u,actions:[],textRanges:p}},S=new s.TextX,E=s.JSONX.getInstance();g.startIndex>0&&S.push({t:s.TextXActionType.RETAIN,len:g.startIndex}),S.push({t:s.TextXActionType.RETAIN,len:1,coverType:s.UpdateDocsAttributeType.REPLACE,body:{dataStream:"",paragraphs:[{...s.Tools.deepClone({...g,paragraphStyle:{...g.paragraphStyle,borderBottom:void 0}}),startIndex:0}]}});const C=Z(l,r);return f.params.actions=E.editOp(S.serialize(),C),!!n.syncExecuteCommand(f.id,f.params)}};function Xt(o,t){let e=0;if(o==null||o.length===0){if(typeof t[0].startOffset=="number"){const n=t[0],{spanEntireRow:i,spanEntireTable:a}=n;a?e=n.startOffset-3:i?n.startRow>0?e=n.startOffset-6:e=n.startOffset:e=t[0].startOffset}}else if(o.length>0&&t.length>0){const n=o[0],i=t[0];if(n.startOffset!=null&&i.startOffset!=null){if(n.startOffset<i.startOffset)e=n.startOffset;else if(n.startOffset>=i.startOffset){const{spanEntireRow:a,spanEntireTable:r}=i;r?e=i.startOffset-3:a&&(e=i.startOffset-6)}}}return e}const ht={id:"doc.command.delete-left",type:s.CommandType.COMMAND,handler:async o=>{var b,N,x,w,F,V;const t=o.get(D.DocSelectionManagerService),e=o.get(s.IUniverInstanceService),n=o.get(s.ICommandService);let i=!0;const a=e.getCurrentUniverDocInstance();if(a==null)return!1;const r=a.getUnitId(),c=re(o,r),l=t.getActiveTextRange(),A=t.getRectRanges(),d=t.getTextRanges(),u=c==null?void 0:c.getSkeleton();if(u==null)return!1;if(A!=null&&A.length){const H=Xt(d,A),Q=A[0].segmentId,j=[{startOffset:H,endOffset:H}];return n.executeCommand(Ve.id,{segmentId:Q,textRanges:j})}if(l==null||d==null)return!1;const{segmentId:m,style:h,segmentPage:g}=l,p=a.getSelfOrHeaderFooterModel(m).getBody();if(p==null)return!1;const f=l,{startOffset:S,collapsed:E}=f,C=u.findNodeByCharIndex(S,m,g),T=_.hasListGlyph(C),R=_.isIndentByGlyph(C,p);let v=S;const O=u.findNodeByCharIndex(S-1,m,g);if(_.isFirstGlyph(C)&&O!==C&&(T===!0||R===!0)&&E){const H=_.getParagraphByGlyph(C,p);if(H==null)return!1;const Q=H==null?void 0:H.startIndex,j={startIndex:0},X=H.paragraphStyle;if(T===!0){const W=H.paragraphStyle;if(W){j.paragraphStyle=W;const{hanging:G}=W;G&&(j.paragraphStyle.indentStart=G,j.paragraphStyle.hanging=void 0)}}else if(R===!0){const W=H.bullet;W&&(j.bullet=W),X!=null&&(j.paragraphStyle={...X},delete j.paragraphStyle.hanging,delete j.paragraphStyle.indentStart)}const k=[{startOffset:v,endOffset:v,style:h}];i=await n.executeCommand(Fn.id,{unitId:a.getUnitId(),updateBody:{dataStream:"",paragraphs:[{...j}]},range:{startOffset:Q,endOffset:Q+1},textRanges:k,coverType:s.UpdateDocsAttributeType.REPLACE,segmentId:m})}else if(E===!0){if(O==null)return!0;if(O.content==="\r"){const H=(b=p.paragraphs)==null?void 0:b.find(Q=>Q.startIndex===S-1);(N=H==null?void 0:H.paragraphStyle)!=null&&N.borderBottom?i=await n.executeCommand(pi.id):i=await n.executeCommand(Gt.id,{direction:oe.LEFT,range:f})}else if(O.streamType==="\b"){const H=(w=a.getSnapshot().drawings)==null?void 0:w[(x=O.drawingId)!=null?x:""];if(H==null)return!0;const Q=(V=(F=a.getBody())==null?void 0:F.customBlocks)==null?void 0:V.find(X=>X.blockId===O.drawingId);if(H.layoutType===s.PositionedObjectLayoutType.INLINE||(Q==null?void 0:Q.blockType)===s.BlockType.CUSTOM){const X=a.getUnitId();i=await n.executeCommand(Wt.id,{direction:oe.LEFT,range:l,unitId:X,drawingId:O.drawingId})}else{const X=u.findNodeByCharIndex(S-2);if(X==null)return!0;v-=O.count,v-=X.count;const k=[{startOffset:v,endOffset:v,style:h}];i=await n.executeCommand(Ye.id,{unitId:a.getUnitId(),range:{...l,startOffset:l.startOffset-1,endOffset:l.endOffset-1},segmentId:m,direction:oe.LEFT,len:X.count,textRanges:k})}}else v-=O.count,i=await n.executeCommand(Ye.id,{unitId:a.getUnitId(),range:f,segmentId:m,direction:oe.LEFT,len:O.count})}else{const H=fi(f,[f]);i=await n.executeCommand(Ve.id,{segmentId:m,textRanges:H,selections:[f]})}return i}},Hn={id:"doc.command.delete-right",type:s.CommandType.COMMAND,handler:async o=>{var C,T;const t=o.get(D.DocSelectionManagerService),n=o.get(s.IUniverInstanceService).getCurrentUniverDocInstance();if(!n)return!1;const i=re(o,n.getUnitId()),a=o.get(s.ICommandService),r=t.getActiveTextRange(),c=t.getRectRanges(),l=t.getTextRanges(),A=i==null?void 0:i.getSkeleton();if(c!=null&&c.length){const R=Xt(l,c),v=c[0].segmentId,O=[{startOffset:R,endOffset:R}];return a.executeCommand(Ve.id,{segmentId:v,textRanges:O})}if(r==null||A==null||l==null)return!1;const{segmentId:d,style:u,segmentPage:m}=r,h=n==null?void 0:n.getSelfOrHeaderFooterModel(d).getBody();if(!n||!h)return!1;const g=r,{startOffset:p,endOffset:f,collapsed:S}=g;if(p===h.dataStream.length-2&&S)return!0;let E=!1;if(S===!0){const R=A.findNodeByCharIndex(p,d,m),v=A.findNodeByCharIndex(p+1);if(R.streamType===s.DataStreamTreeTokenType.PARAGRAPH&&(v==null?void 0:v.streamType)===s.DataStreamTreeTokenType.SECTION_BREAK)return!1;if(R.content==="\r")E=await a.executeCommand(Gt.id,{direction:oe.RIGHT,range:r});else if(R.streamType==="\b"){const O=(T=n.getSnapshot().drawings)==null?void 0:T[(C=R.drawingId)!=null?C:""];if(O==null)return!0;if(O.layoutType===s.PositionedObjectLayoutType.INLINE){const b=n.getUnitId();E=await a.executeCommand(Wt.id,{direction:oe.RIGHT,range:r,unitId:b,drawingId:R.drawingId})}else{if(v==null)return!0;const b=[{startOffset:p+1,endOffset:p+1,style:u}];E=await a.executeCommand(Ye.id,{unitId:n.getUnitId(),range:{...r,startOffset:p+1,endOffset:f+1},segmentId:d,direction:oe.RIGHT,textRanges:b,len:v.count})}}else{const O=[{startOffset:p,endOffset:p,style:u}];E=await a.executeCommand(Ye.id,{unitId:n.getUnitId(),range:g,segmentId:d,direction:oe.RIGHT,textRanges:O,len:R.count})}}else{const R=fi(g,[g]);E=await a.executeCommand(Ve.id,{segmentId:d,textRanges:R,selections:[g]})}return E}};function fi(o,t){let e=o.endOffset;for(const i of t){const{startOffset:a,endOffset:r}=i;a==null||r==null||r<=o.endOffset&&(e-=r-a)}return[{startOffset:e,endOffset:e,style:o.style}]}const kn={id:"doc.command.delete-current-paragraph",type:s.CommandType.COMMAND,handler:async o=>{var A,d;const t=o.get(s.IUniverInstanceService),e=o.get(s.ICommandService),n=t.getCurrentUnitOfType(s.UniverInstanceType.UNIVER_DOC);if(!n)return!1;const i=(d=(A=n.getBody())==null?void 0:A.dataStream)!=null?d:"",a=ut(o);if(!a)return!1;const r=s.BuildTextUtils.selection.delete([{startOffset:a.paragraphStart,endOffset:i[a.paragraphEnd+1]===`
`?a.paragraphEnd:a.paragraphEnd+1,collapsed:!1}],n.getBody(),0,void 0,!0),c=Z(n),l={unitId:n.getUnitId(),actions:s.JSONX.getInstance().editOp(r,c),textRanges:[{startOffset:a.paragraphStart,endOffset:a.paragraphStart,collapsed:!0}]};return e.syncExecuteCommand(D.RichTextEditingMutation.id,l)}},Fa=10,Ha=6;function ka(){return s.generateRandomId(Ha)}function Va(o){const t=o.match(/data-copy-id="([^\s]+)"/);return t&&t[1]?t[1]:null}class Wa{constructor(){B(this,"_cache",new s.LRUMap(Fa))}set(t,e){this._cache.set(t,e)}get(t){return this._cache.get(t)}clear(){this._cache.clear()}}const Vn=new Wa;function Wn(o){const t=o.style,e={},n=o.tagName.toLowerCase();switch(n){case"b":case"em":case"strong":{e.bl=s.BooleanNumber.TRUE;break}case"s":{e.st={s:s.BooleanNumber.TRUE};break}case"u":{e.ul={s:s.BooleanNumber.TRUE};break}case"i":{e.it=s.BooleanNumber.TRUE;break}case"sub":case"sup":{e.va=n==="sup"?s.BaselineOffset.SUPERSCRIPT:s.BaselineOffset.SUBSCRIPT;break}}for(let i=0;i<t.length;i++){const a=t[i],r=t.getPropertyValue(a);switch(a){case"font-family":{e.ff=r.replace(/^"/g,"").replace(/"$/g,"");break}case"font-size":{const c=Number.parseInt(r);Number.isNaN(c)||(r.endsWith("pt")?e.fs=c:r.endsWith("px")&&(e.fs=_.pixelToPt(c)));break}case"font-style":{r==="italic"&&(e.it=s.BooleanNumber.TRUE);break}case"font-weight":{(Number(r)>400||String(r)==="bold")&&(e.bl=s.BooleanNumber.TRUE);break}case"text-decoration":{/underline/.test(r)?e.ul={s:s.BooleanNumber.TRUE}:/overline/.test(r)?e.ol={s:s.BooleanNumber.TRUE}:/line-through/.test(r)&&(e.st={s:s.BooleanNumber.TRUE});break}case"color":{try{const c=new s.ColorKit(r);c.isValid&&(e.cl={rgb:c.toRgbString()})}catch{}break}case"background-color":{const c=new s.ColorKit(r);c.isValid&&(e.bg={rgb:c.toRgbString()});break}}}return e}function Ga(o){const t=new DOMParser,e=`<x-univer id="univer-root">${o}</x-univer>`;return t.parseFromString(e,"text/html").querySelector("#univer-root")}function Si(o,t){const e=o.tagName.toLowerCase();return typeof t=="string"?e===t:Array.isArray(t)?t.some(n=>n===e):t(o)}const Ii=660,Rn=class Rn{constructor(){B(this,"_tableCache",[]);B(this,"_styleCache",new Map);B(this,"_styleRules",[]);B(this,"_afterProcessRules",[])}static use(t){if(this._pluginList.includes(t))throw new Error(`Univer paste plugin ${t.name} already added`);this._pluginList.push(t)}convert(t,e={}){var c;const n=Rn._pluginList.find(l=>l.checkPasteType(t)),i=Ga(t),r={body:{dataStream:"",paragraphs:[],sectionBreaks:[],tables:[],textRuns:[],customBlocks:[]},tableSource:{},id:(c=e==null?void 0:e.unitId)!=null?c:""};return n&&(this._styleRules=[...n.stylesRules],this._afterProcessRules=[...n.afterProcessRules]),this._tableCache=[],this._styleCache.clear(),this._process(null,i.childNodes,r),this._styleCache.clear(),this._styleRules=[],this._afterProcessRules=[],r}_process(t,e,n){var a,r,c,l;const i=n.body;for(const A of e)if(A.nodeType===Node.TEXT_NODE){if(((a=A.nodeValue)==null?void 0:a.trim())==="")continue;const d=(r=A.nodeValue)==null?void 0:r.replace(/[\r\n]/g,"");let u;t&&this._styleCache.has(t)&&(u=this._styleCache.get(t)),i.dataStream+=d,u&&Object.getOwnPropertyNames(u).length&&i.textRuns.push({st:i.dataStream.length-d.length,ed:i.dataStream.length,ts:u})}else if(A.nodeName==="IMG"){const d=A,u=d.dataset.imageSourceType,m=u===Mn.ImageSourceType.UUID?d.dataset.source:d.src;if(m&&u){const h=Number(d.dataset.width||100),g=Number(d.dataset.height||100),p=Number(d.dataset.docTransformWidth||h),f=Number(d.dataset.docTransformHeight||g),S=s.generateRandomId(6);(l=(c=n.body)==null?void 0:c.customBlocks)==null||l.push({startIndex:i.dataStream.length,blockId:S}),i.dataStream+="\b",n.drawings||(n.drawings={}),n.drawings[S]={drawingId:S,title:"",description:"",imageSourceType:u,source:m,transform:{width:h,height:g,left:0},docTransform:{size:{width:p,height:f},angle:0,positionH:{relativeFrom:s.ObjectRelativeFromH.PAGE,posOffset:0},positionV:{relativeFrom:s.ObjectRelativeFromV.PARAGRAPH,posOffset:0}},layoutType:s.PositionedObjectLayoutType.INLINE,drawingType:s.DrawingTypeEnum.DRAWING_IMAGE,unitId:n.id||"",subUnitId:n.id||""}}}else{if(s.skipParseTagNames.includes(A.nodeName.toLowerCase()))continue;if(A.nodeType===Node.ELEMENT_NODE){const d=A,u=this._processBeforeLink(d,n),m=t?this._styleCache.get(t):{},h=this._styleRules.find(({filter:S})=>Si(A,S)),g=h?h.getStyle(A):Wn(A);this._styleCache.set(A,{...m,...g});const{childNodes:p}=A;this._processBeforeTable(A,n),this._process(A,p,n),this._processAfterTable(A,n);const f=this._afterProcessRules.find(({filter:S})=>Si(A,S));f&&f.handler(n,A),this._processAfterLink(d,n,u)}}}_processBeforeTable(t,e){var a;const n=t.tagName.toUpperCase(),i=e.body;switch(n){case"TABLE":{i.dataStream[i.dataStream.length-1]!=="\r"&&(i.dataStream+="\r",i.paragraphs==null&&(i.paragraphs=[]),(a=i.paragraphs)==null||a.push({startIndex:i.dataStream.length-1}));const r=Un(0,0,Ii);this._tableCache.push({table:r,startIndex:i.dataStream.length}),i.dataStream+=s.DataStreamTreeTokenType.TABLE_START;break}case"TR":{const r=kt(0);this._tableCache[this._tableCache.length-1].table.tableRows.push(r),i.dataStream+=s.DataStreamTreeTokenType.TABLE_ROW_START;break}case"TD":{const r=Ht(),c=this._tableCache[this._tableCache.length-1].table;c.tableRows[c.tableRows.length-1].tableCells.push(r),i.dataStream+=s.DataStreamTreeTokenType.TABLE_CELL_START;break}}}_processAfterTable(t,e){var r,c;const n=t.tagName.toUpperCase(),i=e.body;e.tableSource==null&&(e.tableSource={}),i.tables==null&&(i.tables=[]),i.sectionBreaks==null&&(i.sectionBreaks=[]);const{tableSource:a}=e;switch(n){case"TABLE":{const l=this._tableCache.pop(),{startIndex:A,table:d}=l,u=d.tableRows[0].tableCells.length,m=Vt(Ii/u),h=[...new Array(u).fill(null).map(()=>s.Tools.deepClone(m))];d.tableColumns=h,a[d.tableId]=d,i.dataStream+=s.DataStreamTreeTokenType.TABLE_END,i.tables.push({startIndex:A,endIndex:i.dataStream.length,tableId:d.tableId});break}case"TR":{i.dataStream+=s.DataStreamTreeTokenType.TABLE_ROW_END;break}case"TD":{i.dataStream[i.dataStream.length-1]!=="\r"&&((r=i.paragraphs)==null||r.push({startIndex:i.dataStream.length}),i.dataStream+="\r"),(c=i.sectionBreaks)==null||c.push({startIndex:i.dataStream.length}),i.dataStream+=`
${s.DataStreamTreeTokenType.TABLE_CELL_END}`;break}}}_processBeforeLink(t,e){return e.body.dataStream.length}_processAfterLink(t,e,n){var r,c;const i=e.body,a=t;a.tagName.toUpperCase()==="A"&&(i.customRanges=(r=i.customRanges)!=null?r:[],i.customRanges.push({startIndex:n,endIndex:i.dataStream.length-1,rangeId:(c=a.dataset.rangeid)!=null?c:s.generateRandomId(),rangeType:s.CustomRangeType.HYPERLINK,properties:{url:a.href}}))}};B(Rn,"_pluginList",[]);let qe=Rn;const vi={name:"univer-doc-paste-plugin-lark",checkPasteType(o){return/lark-record-clipboard/i.test(o)},stylesRules:[{filter:["s"],getStyle(o){const t=Wn(o);return{st:{s:s.BooleanNumber.TRUE},...t}}}],afterProcessRules:[{filter(o){return o.tagName==="DIV"&&/ace-line/i.test(o.className)},handler(o){const t=o.body;t.paragraphs==null&&(t.paragraphs=[]),t.paragraphs.push({startIndex:t.dataStream.length}),t.dataStream+="\r"}}]};function Ei(o){const t=o.style,e={};for(let n=0;n<t.length;n++){const i=t[n],a=t.getPropertyValue(i);switch(i){case"margin-top":{const r=Number.parseInt(a);e.spaceAbove={v:/pt/.test(a)?_.ptToPixel(r):r};break}case"margin-bottom":{const r=Number.parseInt(a);e.spaceBelow={v:/pt/.test(a)?_.ptToPixel(r):r};break}case"line-height":{let r=Number.parseFloat(a);a.endsWith("%")&&(r/=100),e.lineSpacing=r;break}}}return Object.getOwnPropertyNames(e).length?e:null}const Ci={name:"univer-doc-paste-plugin-univer",checkPasteType(o){return/UniverNormal/i.test(o)},stylesRules:[],afterProcessRules:[{filter(o){return o.tagName==="P"&&/UniverNormal/i.test(o.className)},handler(o,t){const e=o.body;e.paragraphs==null&&(e.paragraphs=[]);const n={startIndex:e.dataStream.length},i=Ei(t);i&&(n.paragraphStyle=i),e.paragraphs.push(n),e.dataStream+="\r"}}]},Ti={name:"univer-doc-paste-plugin-word",checkPasteType(o){return/word|mso/i.test(o)},stylesRules:[{filter:["b"],getStyle(o){const t=Wn(o);return{bl:s.BooleanNumber.TRUE,...t}}}],afterProcessRules:[{filter(o){return o.tagName==="P"},handler(o,t){const e=o.body;e.paragraphs==null&&(e.paragraphs=[]);const n={startIndex:e.dataStream.length},i=Ei(t);i&&(n.paragraphStyle=i),e.paragraphs.push(n),e.dataStream+="\r"}}]};function Xa(o){var n,i;const t=a=>{let r="";return Object.keys(a).forEach(c=>{a[c]!==void 0&&(r+=` ${c}=${a[c]}`)}),r},e={"data-doc-transform-height":o.docTransform.size.height,"data-doc-transform-width":o.docTransform.size.width,"data-width":(n=o.transform)==null?void 0:n.width,"data-height":(i=o.transform)==null?void 0:i.height,"data-image-source-type":o.imageSourceType,"data-source":o.imageSourceType===Mn.ImageSourceType.UUID?o.source:void 0,src:o.source};return`<img  ${t(e)}></img>`}function yi(o,t){const{st:e,ed:n,ts:i={}}=t,{ff:a,fs:r,it:c,bl:l,ul:A,st:d,ol:u,bg:m,cl:h,va:g}=i;let p=o.slice(e,n);const f=[];return c===s.BooleanNumber.TRUE&&(p=`<i>${p}</i>`),g===s.BaselineOffset.SUPERSCRIPT?p=`<sup>${p}</sup>`:g===s.BaselineOffset.SUBSCRIPT&&(p=`<sub>${p}</sub>`),(A==null?void 0:A.s)===s.BooleanNumber.TRUE&&(p=`<u>${p}</u>`),(d==null?void 0:d.s)===s.BooleanNumber.TRUE&&(p=`<s>${p}</s>`),l===s.BooleanNumber.TRUE&&(p=`<strong>${p}</strong>`),a&&f.push(`font-family: ${a}`),h&&f.push(`color: ${h.rgb}`),r&&f.push(`font-size: ${r}pt`),u&&f.push("text-decoration: overline"),m&&f.push(`background: ${m.rgb}`),f.length?`<span style="${f.join("; ")};">${p}</span>`:p}function Gn(o,t,e){const{dataStream:n,textRuns:i=[]}=o;if(t===e)return"";let a=t;const r=[];for(const c of i){const{st:l,ed:A}=c;s.Tools.hasIntersectionBetweenTwoRanges(t,e,l,A)&&(l>a?(r.push(n.slice(a,l)),r.push(yi(n,{...c,ed:Math.min(A,e)}))):r.push(yi(n,{...c,st:a,ed:Math.min(A,e)}))),a=Math.max(t,Math.min(A,e))}return a!==e&&r.push(n.slice(a,e)),r.join("")}function ja(o,t,e){const n=o.body,i=o.drawings||{},{customRanges:a=[],customBlocks:r=[]}=n||{},c=[...r],l=a.filter(h=>h.startIndex>=t&&h.endIndex<=e);let A=t,d="";const u=(h,g)=>{let p="",f=0,S=h,E=c.findIndex(C=>h<=C.startIndex&&g>=C.startIndex);if(E===-1)return p=Gn(n,h,g),{sliceHtml:p,customBlockLength:f};for(;E!==-1;){const C=c[E];c.splice(E,1),p+=Gn(n,S,C.startIndex);const T=i[C.blockId];if(T)switch(T.drawingType){case s.DrawingTypeEnum.DRAWING_IMAGE:{p+=Xa(T),f++;break}}S=C.startIndex+1,E=c.findIndex(R=>S<=R.startIndex&&g>=R.startIndex)}return p=p+Gn(n,S,g+1),{sliceHtml:p,customBlockLength:f}};l.forEach(h=>{var T,R;const{startIndex:g,endIndex:p,rangeType:f,rangeId:S}=h,E=u(A,g);d+=E.sliceHtml;const C=u(g,p+1);switch(f){case s.CustomRangeType.HYPERLINK:{d+=`<a data-rangeid="${S}" href="${(R=(T=h.properties)==null?void 0:T.url)!=null?R:""}">${C.sliceHtml}</a>`;break}default:{d+=C.sliceHtml;break}}A=p+1+(E.customBlockLength+C.customBlockLength)});const m=u(A,e);return d+=m.sliceHtml,d}function bi(o){const t=o.body||{},{paragraphs:e=[],sectionBreaks:n=[]}=t;let{dataStream:i=""}=t;i.endsWith(`\r
`)||(i+=`\r
`,e.push({startIndex:i.length-2}),n.push({startIndex:i.length-1}),t.dataStream=i,t.paragraphs=e,t.sectionBreaks=n);const a={html:""},r=_.parseDataStreamToTree(i).sectionList;for(const c of r)Je(c,o,a);return a.html}function Je(o,t,e){var n,i;switch(o.nodeType){case s.DataStreamTreeNodeType.SECTION_BREAK:{for(const a of o.children)Je(a,t,e);break}case s.DataStreamTreeNodeType.PARAGRAPH:{const{children:a,startIndex:r,endIndex:c}=o,l=(i=(n=t.body)==null?void 0:n.paragraphs.find(g=>g.startIndex===c))!=null?i:{},{paragraphStyle:A={}}=l,{spaceAbove:d,spaceBelow:u,lineSpacing:m}=A,h=[];if(d!=null&&(typeof d=="number"?h.push(`margin-top: ${d}px`):h.push(`margin-top: ${d.v}px`)),u!=null&&(typeof u=="number"?h.push(`margin-bottom: ${u}px`):h.push(`margin-bottom: ${u.v}px`)),m!=null&&h.push(`line-height: ${m}`),e.html+=`<p class="UniverNormal" ${h.length?`style="${h.join("; ")};"`:""}>`,a.length)for(const g of a)Je(g,t,e);e.html+=`${ja(t,r,c)}</p>`;break}case s.DataStreamTreeNodeType.TABLE:{const{children:a}=o;e.html+='<table class="UniverTable" style="width: 100%; border-collapse: collapse;"><tbody>';for(const r of a)Je(r,t,e);e.html+="</tbody></table>";break}case s.DataStreamTreeNodeType.TABLE_ROW:{const{children:a}=o;e.html+='<tr class="UniverTableRow">';for(const r of a)Je(r,t,e);e.html+="</tr>";break}case s.DataStreamTreeNodeType.TABLE_CELL:{const{children:a}=o;e.html+='<td class="UniverTableCell">';for(const r of a)Je(r,t,e);e.html+="</td>";break}default:throw new Error(`Unknown node type: ${o.nodeType}`)}}class Ka{convert(t){if(t.length===0)throw new Error("The bodyList length at least to be 1");let e="";for(const n of s.Tools.deepClone(t))e+=bi(n);return e}}var za=Object.getOwnPropertyDescriptor,Ya=(o,t,e,n)=>{for(var i=n>1?void 0:n?za(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},gt=(o,t)=>(e,n)=>t(e,n,o);qe.use(Ti),qe.use(vi),qe.use(Ci);function Oi(o,t,e){var a,r,c;const n=s.getBodySlice(o,t,e+2),i=s.DataStreamTreeTokenType.TABLE_START+s.DataStreamTreeTokenType.TABLE_ROW_START+s.DataStreamTreeTokenType.TABLE_CELL_START+n.dataStream+s.DataStreamTreeTokenType.TABLE_CELL_END+s.DataStreamTreeTokenType.TABLE_ROW_END+s.DataStreamTreeTokenType.TABLE_END;return n.dataStream=i,(a=n.textRuns)==null||a.forEach(l=>{const{st:A,ed:d}=l;l.st=A+3,l.ed=d+3}),(r=n.tables)==null||r.forEach(l=>{const{startIndex:A,endIndex:d}=l;l.startIndex=A+3,l.endIndex=d+3}),(c=n.paragraphs)==null||c.forEach(l=>{const{startIndex:A}=l;l.startIndex=A+3}),n}const De=s.createIdentifier("doc.clipboard-service");let Xn=class extends s.Disposable{constructor(t,e,n,i,a){super();B(this,"_clipboardHooks",[]);B(this,"_htmlToUDM",new qe);B(this,"_umdToHtml",new Ka);this._univerInstanceService=t,this._logService=e,this._commandService=n,this._clipboardInterfaceService=i,this._docSelectionManagerService=a}async copy(t=s.SliceBodyType.copy,e){var c,l;const{newSnapshotList:n=[],needCache:i=!1,snapshot:a,ranges:r}=(c=this._getDocumentBodyInRanges(t,e))!=null?c:{};if(n.length===0||a==null)return!1;try{const A=!!((l=r==null?void 0:r[0])!=null&&l.segmentId);this._setClipboardData(n,!A&&i)}catch(A){return this._logService.error("[DocClipboardService] copy failed",A),!1}return!0}async cut(t){return this._cut(t)}async paste(t){const e=await this._genDocDataFromClipboardItems(t);return this._paste(e)}async legacyPaste(t){let{html:e,text:n,files:i}=t;const a=this._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),r=(a==null?void 0:a.getUnitId())||"";if(!e&&!n&&i.length&&(e=await this._createImagePasteHtml(i)),!e&&!n)return this._logService.warn("[DocClipboardController] html and text cannot be both empty!"),!1;const c=this._genDocDataFromHtmlAndText(e,n,r);if(r===s.DOCS_NORMAL_EDITOR_UNIT_ID_KEY)if(n){const l=s.BuildTextUtils.transform.fromPlainText(n);return this._paste({body:l})}else c.body.textRuns=[];return this._paste(c)}async _cut(t){var c,l,A,d,u;const e=(l=(c=t==null?void 0:t.filter(m=>m.rangeType===s.DOC_RANGE_TYPE.TEXT))!=null?c:this._docSelectionManagerService.getTextRanges())!=null?l:[],n=(d=(A=t==null?void 0:t.filter(m=>m.rangeType===s.DOC_RANGE_TYPE.RECT))!=null?A:this._docSelectionManagerService.getRectRanges())!=null?d:[],{segmentId:i,endOffset:a,style:r}=(u=e[0])!=null?u:{};if(i==null&&this._logService.error("[DocClipboardController] segmentId is not existed"),e.length===0&&n.length===0)return!1;this.copy(s.SliceBodyType.cut,t);try{let m=0;if(n.length>0)m=Xt(e,n);else if(a!=null){m=a;for(const g of e){const{startOffset:p,endOffset:f}=g;p==null||f==null||f<=a&&(m-=f-p)}}const h=[{startOffset:m,endOffset:m,style:r}];return this._commandService.executeCommand(Ve.id,{segmentId:i,textRanges:h,rectRanges:n,selections:e})}catch{return this._logService.error("[DocClipboardController] cut content failed"),!1}}async _paste(t){var d,u,m;const{body:e}=t;if(e==null)return!1;let n=s.normalizeBody(e);if(!((d=this._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC))==null?void 0:d.getUnitId()))return!1;this._clipboardHooks.forEach(h=>{h.onBeforePaste&&(n=h.onBeforePaste(n))}),n.customRanges=(u=n.customRanges)==null?void 0:u.map(s.BuildTextUtils.customRange.copyCustomRange),(m=n.paragraphs)==null||m.forEach(h=>{var g;(g=h.paragraphStyle)!=null&&g.headingId&&(h.paragraphStyle.headingId=s.generateRandomId(6))});const a=this._docSelectionManagerService.getActiveTextRange(),{segmentId:r,endOffset:c,style:l}=a||{},A=this._docSelectionManagerService.getTextRanges();if(r==null&&this._logService.error("[DocClipboardController] segmentId does not exist!"),c==null||A==null)return!1;try{let h=c;for(const p of A){const{startOffset:f,endOffset:S}=p;f==null||S==null||S<=c&&(h+=n.dataStream.length-(S-f))}const g=[{startOffset:h,endOffset:h,style:l}];return this._commandService.executeCommand(Ln.id,{doc:{...t,body:n},segmentId:r,textRanges:g})}catch{return this._logService.error("[DocClipboardController]","clipboard is empty."),!1}}async _setClipboardData(t,e=!0){var r,c,l,A;const n=ka(),i=(t.length>1?t.map(d=>{var u;return((u=d.body)==null?void 0:u.dataStream)||""}).join(`
`):((r=t[0].body)==null?void 0:r.dataStream)||"").replaceAll(s.DataStreamTreeTokenType.TABLE_START,"").replaceAll(s.DataStreamTreeTokenType.TABLE_END,"").replaceAll(s.DataStreamTreeTokenType.TABLE_ROW_START,"").replaceAll(s.DataStreamTreeTokenType.TABLE_ROW_END,"").replaceAll(s.DataStreamTreeTokenType.TABLE_CELL_START,"").replaceAll(s.DataStreamTreeTokenType.TABLE_CELL_END,"").replaceAll(`\r
`," ");let a=this._umdToHtml.convert(t);if(t.length===1&&e){a=a.replace(/(<[a-z]+)/,(m,h)=>`${h} data-copy-id="${n}"`);const d=t[0],u={body:d.body};if((l=(c=d.body)==null?void 0:c.customBlocks)!=null&&l.length){u.drawings={};for(const m of d.body.customBlocks){const{blockId:h}=m,g=(A=d.drawings)==null?void 0:A[h];if(g){const p=s.generateRandomId(6);m.blockId=p,u.drawings[p]={...s.Tools.deepClone(g),drawingId:p}}}}Vn.set(n,u)}return this._clipboardInterfaceService.write(i,a)}addClipboardHook(t){return this._clipboardHooks.push(t),s.toDisposable(()=>{const e=this._clipboardHooks.indexOf(t);e>-1&&this._clipboardHooks.splice(e,1)})}_getDocumentBodyInRanges(t,e){var d;const n=this._univerInstanceService.getCurrentUniverDocInstance(),i=e!=null?e:this._docSelectionManagerService.getDocRanges(),a=[];let r=!0;if(n==null||i.length===0)return;const c=i[0].segmentId,l=(d=n==null?void 0:n.getSelfOrHeaderFooterModel(c))==null?void 0:d.getBody(),A=n.getSnapshot();if(l!=null){for(const u of i){const{startOffset:m,endOffset:h,collapsed:g,rangeType:p}=u;if(g||m==null||h==null)continue;if(p===s.DOC_RANGE_TYPE.RECT){r=!1;const{spanEntireRow:E}=u;let C;C=Oi(l,m,h),a.push(C);continue}const f={startOffset:m,endOffset:h},S=n.getSelfOrHeaderFooterModel(c).sliceBody(f.startOffset,f.endOffset,t);S!=null&&a.push(S)}return{newSnapshotList:a.map(u=>({...A,body:u})),needCache:r,snapshot:A,ranges:i}}}async _genDocDataFromClipboardItems(t){try{let e="",n="";const i=[];for(const a of t)for(const r of a.types)switch(r){case I.PLAIN_TEXT_CLIPBOARD_MIME_TYPE:{n=await a.getType(r).then(c=>c&&c.text());break}case I.HTML_CLIPBOARD_MIME_TYPE:{e=await a.getType(r).then(c=>c&&c.text());break}case I.FILE__BMP_CLIPBOARD_MIME_TYPE:case I.FILE__JPEG_CLIPBOARD_MIME_TYPE:case I.FILE__WEBP_CLIPBOARD_MIME_TYPE:case I.FILE_PNG_CLIPBOARD_MIME_TYPE:{const c=await a.getType(r),l=new File([c],`pasted_image.${r.split("/")[1]}`,{type:r});i.push(l);break}}return!e&&!n&&i.length&&(e=await this._createImagePasteHtml(i)),this._genDocDataFromHtmlAndText(e,n)}catch(e){return Promise.reject(e)}}_genDocDataFromHtmlAndText(t,e,n){if(!t){if(e)return{body:s.BuildTextUtils.transform.fromPlainText(e)};throw new Error("[DocClipboardService] html and text cannot be both empty!")}const i=Va(t);if(i){const r=Vn.get(i);if(r)return r}if(!n){const r=this._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);n=(r==null?void 0:r.getUnitId())||""}const a=this._htmlToUDM.convert(t,{unitId:n});return i&&Vn.set(i,a),a}async _createImagePasteHtml(t){var c,l;const e={id:"",documentStyle:{},body:{dataStream:"",customBlocks:[]},drawings:{}},n=async A=>{const d=new FileReader;return new Promise(u=>{d.onloadend=function(){u({source:d.result,imageSourceType:Mn.ImageSourceType.BASE64})},d.readAsDataURL(A)})},i=A=>{const d=new Image,u=500;return new Promise(m=>{d.src=typeof A=="string"?A:URL.createObjectURL(A),d.onload=()=>{const h=Math.min(u,d.naturalWidth),g=d.naturalHeight/d.naturalWidth;m({width:h,height:h*g})}})},a=(l=(c=this._clipboardHooks.find(A=>A.onBeforePasteImage))==null?void 0:c.onBeforePasteImage)!=null?l:n;return await Promise.all(t.map(async(A,d)=>{var S;const u=await a(A);if(!u)return Promise.resolve();const{width:m=100,height:h=100}=await i(A),g=`paste_image_id_${d}`,p=e.body,f=e.drawings;p.dataStream+="\b",(S=p.customBlocks)==null||S.push({startIndex:d,blockId:g}),f[g]={drawingId:g,unitId:"",subUnitId:"",imageSourceType:u.imageSourceType,title:"",source:u.source,description:"",layoutType:s.PositionedObjectLayoutType.INLINE,drawingType:s.DrawingTypeEnum.DRAWING_IMAGE,transform:{width:m,height:h,angle:0},docTransform:{angle:0,size:{width:m,height:h},positionH:{relativeFrom:s.ObjectRelativeFromH.CHARACTER,posOffset:0},positionV:{relativeFrom:s.ObjectRelativeFromV.LINE,posOffset:0}}}})),this._umdToHtml.convert([e])}};Xn=Ya([gt(0,s.IUniverInstanceService),gt(1,s.ILogService),gt(2,s.ICommandService),gt(3,I.IClipboardInterfaceService),gt(4,s.Inject(D.DocSelectionManagerService))],Xn);function jt(o){return o.getContextValue(s.FOCUSING_DOC)||o.getContextValue(s.EDITOR_ACTIVATED)}const jn=999,mt={id:I.CopyCommand.id,name:"doc.command.copy",type:s.CommandType.COMMAND,multi:!0,priority:jn,preconditions:jt,handler:async o=>o.get(De).copy()},Kn={id:"doc.command.copy-current-paragraph",type:s.CommandType.COMMAND,handler:async o=>{const t=o.get(De),e=ut(o);return e?t.copy(s.SliceBodyType.copy,[{startOffset:e.paragraphStart,endOffset:e.paragraphEnd+1,collapsed:!1}]):!1}},Kt={id:I.CutCommand.id,name:"doc.command.cut",type:s.CommandType.COMMAND,multi:!0,priority:jn,preconditions:jt,handler:async o=>o.get(De).cut()},zn={id:"doc.command.cut-current-paragraph",type:s.CommandType.COMMAND,handler:async o=>{const t=o.get(De),e=ut(o);return e?t.cut([{startOffset:e.paragraphStart,endOffset:e.paragraphEnd+1,collapsed:!1,rangeType:s.DOC_RANGE_TYPE.TEXT}]):!1}},zt={id:I.PasteCommand.id,name:"doc.command.paste",type:s.CommandType.COMMAND,multi:!0,priority:jn,preconditions:jt,handler:async o=>{const t=o.get(De),n=await o.get(I.IClipboardInterfaceService).read();return n.length===0?!1:t.paste(n)}},pt={id:"doc.command.horizontal-line",type:s.CommandType.COMMAND,handler:(o,t)=>o.get(s.ICommandService).syncExecuteCommand(Qt.id,{horizontalLine:{padding:5,color:{rgb:"#CDD0D8"},width:1,dashStyle:s.DashStyleType.SOLID},textRange:t==null?void 0:t.insertRange})},Yn={id:"doc.command.insert-horizontal-line-bellow",type:s.CommandType.COMMAND,handler:o=>{const t=o.get(s.ICommandService),e=ut(o);return e?t.syncExecuteCommand(pt.id,{insertRange:{startOffset:e.startIndex+1,endOffset:e.startIndex+1}}):!1}},qn={id:"doc.command.select-all",type:s.CommandType.COMMAND,handler:async o=>{var h;const t=o.get(s.IUniverInstanceService),e=o.get(D.DocSelectionManagerService),n=t.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),i=e.getDocRanges(),a=(h=i.find(g=>g.isActive))!=null?h:i[0];if(n==null||a==null)return!1;const{segmentId:r}=a,c=n.getUnitId(),l=n.getSelfOrHeaderFooterModel(r).getSnapshot().body;if(l==null)return!1;const{tables:A=[],dataStream:d}=l;if(d===`\r
`)return!0;const u=[];let m=0;for(const g of A){const{startIndex:p,endIndex:f}=g;m!==p&&u.push({startOffset:m,endOffset:p-1,rangeType:s.DOC_RANGE_TYPE.TEXT}),u.push({startOffset:p+3,endOffset:f-5,rangeType:s.DOC_RANGE_TYPE.RECT}),m=f}return m!==l.dataStream.length-2&&u.push({startOffset:m,endOffset:l.dataStream.length-2,rangeType:s.DOC_RANGE_TYPE.TEXT}),e.replaceDocRanges(u,{unitId:c,subUnitId:c},!1),!0}};class ft extends s.RxDisposable{constructor(e){super();B(this,"_previousActiveRange",null);B(this,"_undoMutationParamsCache",[]);B(this,"_redoMutationParamsCache",[]);this._context=e}clearUndoRedoMutationParamsCache(){this._undoMutationParamsCache=[],this._redoMutationParamsCache=[]}getUndoRedoMutationParamsCache(){return{undoCache:this._undoMutationParamsCache,redoCache:this._redoMutationParamsCache}}setUndoRedoMutationParamsCache({undoCache:e=[],redoCache:n=[]}){this._undoMutationParamsCache=e,this._redoMutationParamsCache=n}getActiveRange(){return this._previousActiveRange}setActiveRange(e){this._previousActiveRange=e}pushUndoRedoMutationParams(e,n){this._undoMutationParamsCache.push(e),this._redoMutationParamsCache.push(n)}fetchComposedUndoRedoMutationParams(){if(this._undoMutationParamsCache.length===0||this._previousActiveRange==null||this._redoMutationParamsCache.length===0)return null;const{unitId:e}=this._undoMutationParamsCache[0],n={unitId:e,actions:this._undoMutationParamsCache.reverse().reduce((a,r)=>s.JSONX.compose(a,r.actions),null),textRanges:[]};return{redoMutationParams:{unitId:e,actions:this._redoMutationParamsCache.reduce((a,r)=>s.JSONX.compose(a,r.actions),null),textRanges:[]},undoMutationParams:n,previousActiveRange:this._previousActiveRange}}dispose(){this._undoMutationParamsCache=[],this._redoMutationParamsCache=[],this._previousActiveRange=null}}const Jn={id:"doc.command.ime-input",type:s.CommandType.COMMAND,handler:async(o,t)=>{var Q,j,X;const{unitId:e,newText:n,oldTextLen:i,isCompositionEnd:a,isCompositionStart:r}=t,c=o.get(s.ICommandService),l=o.get(_.IRenderManagerService),A=o.get(s.IUniverInstanceService),d=o.get(ve),u=(Q=l.getRenderById(e))==null?void 0:Q.with(ft),m=A.getUnit(e,s.UniverInstanceType.UNIVER_DOC);if(m==null||u==null)return!1;const h=u.getActiveRange();if(h==null)return!1;const{style:g,segmentId:p}=h,f=m.getSelfOrHeaderFooterModel(p).getBody();if(f==null)return!1;Object.assign(h,h);const{startOffset:E,endOffset:C}=h,T=n.length,R=[{startOffset:E+T,endOffset:E+T,collapsed:!0,style:g}],v={id:D.RichTextEditingMutation.id,params:{unitId:e,actions:[],textRanges:R}},O=d.getDefaultStyle(),M=d.getStyleCache(),b=Dn((j=f.customRanges)!=null?j:[],E+i,s.SHEET_EDITOR_UNITS.includes(e)),N=wt(f,r?C:E+i,O,M,s.SHEET_EDITOR_UNITS.includes(e)),x=Bn((X=f.customDecorations)!=null?X:[],E+i),w=new s.TextX,F=s.JSONX.getInstance();if(!h.collapsed&&r){const k=s.BuildTextUtils.selection.delete([h],f,0,null,!1);w.push(...k),v.params.textRanges=[{startOffset:E+T,endOffset:E+T,collapsed:!0}]}else w.push({t:s.TextXActionType.RETAIN,len:E});i>0&&w.push({t:s.TextXActionType.DELETE,len:i}),w.push({t:s.TextXActionType.INSERT,body:{dataStream:n,textRuns:N?[{...N,st:0,ed:n.length}]:[],customRanges:b?[{...b,startIndex:0,endIndex:n.length-1}]:[],customDecorations:x.map(k=>({...k,startIndex:0,endIndex:n.length-1}))},len:n.length});const V=Z(m,p);v.params.actions=F.editOp(w.serialize(),V),v.params.noHistory=!a,v.params.isCompositionEnd=a;const H=c.syncExecuteCommand(v.id,v.params);return u.pushUndoRedoMutationParams(H,v.params),!!H}};function Ae(o,t,e){return e.executeCommand(ye.id,{preCommandId:o,...t!=null?t:{}})}const Ri="doc.command.set-inline-format-bold",Be={id:Ri,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(Ri,t,e)}},Mi="doc.command.set-inline-format-italic",_e={id:Mi,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(Mi,t,e)}},xi="doc.command.set-inline-format-underline",Ne={id:xi,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(xi,t,e)}},Di="doc.command.set-inline-format-strikethrough",Pe={id:Di,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(Di,t,e)}},Bi="doc.command.set-inline-format-subscript",Ee={id:Bi,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(Bi,t,e)}},_i="doc.command.set-inline-format-superscript",Ue={id:_i,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(_i,t,e)}},Ni="doc.command.set-inline-format-fontsize",he={id:Ni,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(Ni,t,e)}},Pi="doc.command.set-inline-format-font-family",we={id:Pi,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(Pi,t,e)}},Ui="doc.command.set-inline-format-text-color",Ce={id:Ui,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(Ui,t,e)}},wi="doc.command.set-inline-format-text-background-color",Te={id:wi,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(wi,t,e)}},Li="doc.command.reset-inline-format-text-background-color",Ze={id:Li,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(Li,t,e)}},Zn={[Be.id]:"bl",[_e.id]:"it",[Ne.id]:"ul",[Pe.id]:"st",[he.id]:"fs",[we.id]:"ff",[Ce.id]:"cl",[Te.id]:"bg",[Ze.id]:"bg",[Ee.id]:"va",[Ue.id]:"va"},ye={id:"doc.command.set-inline-format",type:s.CommandType.COMMAND,handler:async(o,t)=>{var R;const{value:e,preCommandId:n}=t,i=o.get(s.ICommandService),a=o.get(D.DocSelectionManagerService),r=o.get(s.IUniverInstanceService),c=o.get(ve),l=a.getDocRanges(),A=(R=l.find(v=>v.isActive))!=null?R:l[0];if(l.length===0)return!1;const{segmentId:d}=l[0],u=r.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);if(u==null)return!1;const m=u.getSelfOrHeaderFooterModel(d).getBody();if(m==null)return!1;const h=u.getUnitId();let g;switch(n){case Be.id:case _e.id:case Ne.id:case Pe.id:case Ee.id:case Ue.id:{const v=c.getDefaultStyle(),O=Fi(m,A,v);g=Ja(O,n);break}case he.id:case we.id:{g=e;break}case Ce.id:case Te.id:{g={rgb:e};break}case Ze.id:{g={rgb:null};break}default:throw new Error(`Unknown command: ${n} in handleInlineFormat`)}const p={id:D.RichTextEditingMutation.id,params:{unitId:h,actions:[],textRanges:l}},f=new s.TextX,S=s.JSONX.getInstance(),E=new s.MemoryCursor;E.reset();for(const v of l){let{startOffset:O,endOffset:M,rangeType:b}=v;if(O==null||M==null)continue;if(b===s.DOC_RANGE_TYPE.RECT&&(O=O-1),O===M){const w=c.getStyleCache(),F=Zn[n];c.setStyleCache({[F]:(w==null?void 0:w[F])!==void 0?Qi(w,F,n):g});continue}const N={dataStream:"",textRuns:[{st:0,ed:M-O,ts:{[Zn[n]]:g}}]},x=O-E.cursor;x!==0&&f.push({t:s.TextXActionType.RETAIN,len:x}),f.push({t:s.TextXActionType.RETAIN,body:N,len:M-O}),E.reset(),E.moveCursor(M)}const C=Z(u,d);return p.params.actions=S.editOp(f.serialize(),C),!!i.syncExecuteCommand(p.id,p.params)}};function qa(o){return o!==null&&typeof o=="object"}function Qi(o,t,e){if(/bl|it/.test(t))return(o==null?void 0:o[t])===s.BooleanNumber.TRUE?s.BooleanNumber.FALSE:s.BooleanNumber.TRUE;if(/ul|st/.test(t))return qa(o==null?void 0:o[t])&&(o==null?void 0:o[t]).s===s.BooleanNumber.TRUE?{s:s.BooleanNumber.FALSE}:{s:s.BooleanNumber.TRUE};if(/va/.test(t))return e===Ee.id?(o==null?void 0:o[t])===s.BaselineOffset.SUBSCRIPT?s.BaselineOffset.NORMAL:s.BaselineOffset.SUBSCRIPT:(o==null?void 0:o[t])===s.BaselineOffset.SUPERSCRIPT?s.BaselineOffset.NORMAL:s.BaselineOffset.SUPERSCRIPT}function Fi(o,t,e){var d,u,m,h,g,p,f,S,E,C,T,R,v,O;const{startOffset:n,endOffset:i,collapsed:a}=t;if(a){const M=(d=o.textRuns)!=null?d:[];let b=null;for(let N=M.length-1;N>=0;N--){const x=M[N];if(x.st<n&&n<=x.ed){b=x;break}}return b!=null&&b.ts?{...e,...b.ts}:e}const{textRuns:r=[]}=s.getBodySlice(o,n,i),c=s.Tools.deepClone(e),l=r.map(M=>{var b;return(b=M==null?void 0:M.ts)==null?void 0:b.fs}).filter(Boolean);c.fs=c.fs?Math.max(c.fs,...l):l.length?Math.max(...l):void 0,c.fs=!c.fs||Number.isNaN(c.fs)?void 0:c.fs,c.ff=(h=(m=(u=r.find(M=>{var b;return((b=M.ts)==null?void 0:b.ff)!=null}))==null?void 0:u.ts)==null?void 0:m.ff)!=null?h:c.ff,c.it=r.length&&r.every(M=>{var b;return((b=M.ts)==null?void 0:b.it)===s.BooleanNumber.TRUE})?s.BooleanNumber.TRUE:s.BooleanNumber.FALSE,c.bl=r.length&&r.every(M=>{var b;return((b=M.ts)==null?void 0:b.bl)===s.BooleanNumber.TRUE})?s.BooleanNumber.TRUE:s.BooleanNumber.FALSE,c.ul=r.length&&r.every(M=>{var b,N;return((N=(b=M.ts)==null?void 0:b.ul)==null?void 0:N.s)===s.BooleanNumber.TRUE})?(g=r[0].ts)==null?void 0:g.ul:c.ul,c.st=r.length&&r.every(M=>{var b,N;return((N=(b=M.ts)==null?void 0:b.st)==null?void 0:N.s)===s.BooleanNumber.TRUE})?(p=r[0].ts)==null?void 0:p.st:c.st,c.bg=(E=(S=(f=r.find(M=>{var b;return((b=M.ts)==null?void 0:b.bg)!=null}))==null?void 0:f.ts)==null?void 0:S.bg)!=null?E:c.bg,c.cl=(R=(T=(C=r.find(M=>{var b;return((b=M.ts)==null?void 0:b.cl)!=null}))==null?void 0:C.ts)==null?void 0:T.cl)!=null?R:c.cl;const A=r.filter(M=>{var b;return((b=M==null?void 0:M.ts)==null?void 0:b.va)!=null});if(A.length>0&&A.length===r.length){const M=(v=A[0].ts)==null?void 0:v.va;let b=!0;for(let N=1;N<A.length;N++)if(((O=A[N].ts)==null?void 0:O.va)!==M){b=!1;break}b&&(c.va=M)}return c}function Ja(o,t){const e=Zn[t];return Qi(o,e,t)}const $n={id:"doc.command-replace-snapshot",type:s.CommandType.COMMAND,handler:(o,t)=>{const{unitId:e,snapshot:n,textRanges:i,segmentId:a="",options:r}=t,c=o.get(s.IUniverInstanceService),l=o.get(s.ICommandService),A=o.get(D.DocSelectionManagerService),d=c.getUnit(e,s.UniverInstanceType.UNIVER_DOC),u=d==null?void 0:d.getSelfOrHeaderFooterModel(a).getSnapshot();if(d==null||u==null)return!1;const{body:m,tableSource:h,footers:g,headers:p,lists:f,drawings:S,drawingsOrder:E,documentStyle:C}=s.Tools.deepClone(n),{body:T,tableSource:R,footers:v,headers:O,lists:M,drawings:b,drawingsOrder:N,documentStyle:x}=u;if(m==null||T==null)return!1;if(s.Tools.diffValue(m,T)&&i)return A.replaceDocRanges(i,{unitId:e,subUnitId:e},!1),!0;const w={id:D.RichTextEditingMutation.id,params:{unitId:e,actions:[],textRanges:i}};r&&(w.params.options=r);const F=[],V=s.JSONX.getInstance();if(!s.Tools.diffValue(x,C)){const Q=V.replaceOp(["documentStyle"],x,C);Q!=null&&F.push(Q)}if(!s.Tools.diffValue(m,T)){const Q=V.replaceOp(["body"],T,m);Q!=null&&F.push(Q)}if(!s.Tools.diffValue(h,R)){const Q=V.replaceOp(["tableSource"],R,h);Q!=null&&F.push(Q)}if(!s.Tools.diffValue(g,v)){const Q=V.replaceOp(["footers"],v,g);Q!=null&&F.push(Q)}if(!s.Tools.diffValue(p,O)){const Q=V.replaceOp(["headers"],O,p);Q!=null&&F.push(Q)}if(!s.Tools.diffValue(f,M)){const Q=V.replaceOp(["lists"],M,f);Q!=null&&F.push(Q)}if(!s.Tools.diffValue(S,b)){const Q=V.replaceOp(["drawings"],b,S);Q!=null&&F.push(Q)}if(!s.Tools.diffValue(E,N)){const Q=V.replaceOp(["drawingsOrder"],N,E);Q!=null&&F.push(Q)}return w.params.actions=F.reduce((Q,j)=>s.JSONX.compose(Q,j),null),!!l.syncExecuteCommand(w.id,w.params)}},Hi={id:"doc.command-replace-content",type:s.CommandType.COMMAND,handler:async(o,t)=>{const{unitId:e,body:n,textRanges:i,segmentId:a="",options:r}=t,c=o.get(s.IUniverInstanceService),l=o.get(s.ICommandService),A=o.get(D.DocSelectionManagerService),d=c.getUnit(e,s.UniverInstanceType.UNIVER_DOC),u=d==null?void 0:d.getSelfOrHeaderFooterModel(a).getSnapshot().body;if(d==null||u==null)return!1;const m=Vi(e,a,d,u,n);return m.params.textRanges=i,r&&(m.params.options=r),m.params.actions==null&&i?(A.replaceDocRanges(i,{unitId:e,subUnitId:e},!1),!0):!!l.syncExecuteCommand(m.id,m.params)}},ki={id:"doc.command-cover-content",type:s.CommandType.COMMAND,handler:(o,t)=>{const{unitId:e,body:n,segmentId:i="",textRanges:a}=t,r=o.get(s.IUniverInstanceService),c=o.get(s.ICommandService),l=o.get(s.IUndoRedoService),A=r.getUniverDocInstance(e),d=A==null?void 0:A.getSnapshot().body;if(A==null||d==null)return!1;const u=Vi(e,i,A,d,n);return u.params.noNeedSetTextRange=!0,u.params.noHistory=!0,u.params.textRanges=a,c.syncExecuteCommand(u.id,u.params),l.clearUndoRedo(e),!0}};function Za(o,t,e,n){const i=new s.TextX,a=s.JSONX.getInstance(),r=(e==null?void 0:e.dataStream.length)-2;r>0&&i.push({t:s.TextXActionType.DELETE,len:r}),n.dataStream.length>0&&i.push({t:s.TextXActionType.INSERT,body:n,len:n.dataStream.length});const c=Z(t,o);return a.editOp(i.serialize(),c)}function Vi(o,t,e,n,i){const a={id:D.RichTextEditingMutation.id,params:{unitId:o,actions:[],textRanges:[]}},r=Za(t,e,n,i);return a.params.actions=r,a}const eo={id:"doc.command.replace-selection",type:s.CommandType.COMMAND,handler(o,t){var g;if(!t)return!1;const e=o.get(s.ICommandService),{unitId:n,body:i,textRanges:a}=t,c=o.get(s.IUniverInstanceService).getUnit(n),l=o.get(D.DocSelectionManagerService);if(!c)return!1;const A=c.getBody(),d=(g=t.selection)!=null?g:l.getActiveTextRange();if(!d||!A)return!1;const u={id:D.RichTextEditingMutation.id,params:{unitId:n,actions:[],textRanges:a,debounce:!0}},m=new s.TextX,h=s.JSONX.getInstance();return m.push(...s.BuildTextUtils.selection.delete([d],A,0,i)),u.params.actions=h.editOp(m.serialize()),e.syncExecuteCommand(u.id,u.params)}},Wi={id:"doc.command.replace-text-runs",type:s.CommandType.COMMAND,handler:(o,t)=>{const{unitId:e,body:n,textRanges:i,segmentId:a="",options:r}=t,c=o.get(s.IUniverInstanceService),l=o.get(s.ICommandService),A=o.get(s.ThemeService),d=c.getUnit(e,s.UniverInstanceType.UNIVER_DOC),u=d==null?void 0:d.getSelfOrHeaderFooterModel(a).getSnapshot().body;if(d==null||u==null)return!1;const m=s.BuildTextUtils.selection.replaceTextRuns({doc:d,body:n,selection:{startOffset:0,endOffset:u.dataStream.length-2,collapsed:!1},themeService:A});if(!m)return!1;const h={id:D.RichTextEditingMutation.id,params:{unitId:e,actions:[],textRanges:i,noHistory:!0}},g=s.JSONX.getInstance(),p=Z(d,a);return h.params.actions=g.editOp(m.serialize(),p),h.params.textRanges=i,r&&(h.params.options=r),!!l.syncExecuteCommand(h.id,h.params)}},Gi={id:"doc.command.insert-custom-range",type:s.CommandType.COMMAND,handler:(o,t)=>{if(!t)return!1;const e=o.get(s.ICommandService),{unitId:n,rangeId:i=s.generateRandomId(),textRanges:a,properties:r,text:c,wholeEntity:l}=t,A={unitId:n,textRanges:a,body:{dataStream:c,customRanges:[{startIndex:0,endIndex:c.length-1,rangeId:i,rangeType:s.CustomRangeType.CUSTOM,properties:r,wholeEntity:l}]}};return e.syncExecuteCommand(eo.id,A)}},$e={id:"doc.command.list-operation",type:s.CommandType.COMMAND,handler:(o,t)=>{var T,R,v,O,M,b;const e=o.get(D.DocSelectionManagerService),n=o.get(s.IUniverInstanceService),i=o.get(s.ICommandService),a=t.listType,r=n.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),c=(R=(T=t.docRange)!=null?T:e.getDocRanges())!=null?R:[];if(r==null||c.length===0)return!1;const l=c[0].segmentId,A=r.getSelfOrHeaderFooterModel(l),d=(O=(v=A.getBody())==null?void 0:v.paragraphs)!=null?O:[],u=(b=(M=A.getBody())==null?void 0:M.dataStream)!=null?b:"";if(!d.length)return!1;const m=s.BuildTextUtils.range.getParagraphsInRanges(c,d,u),h=r.getUnitId(),g={id:D.RichTextEditingMutation.id,params:{unitId:h,actions:[],textRanges:c,isEditing:!1}};new s.MemoryCursor().reset();const f=s.BuildTextUtils.paragraph.bullet.switch({paragraphs:m,listType:a,document:r,segmentId:l}),S=s.JSONX.getInstance(),E=Z(r,l);return g.params.actions=S.editOp(f.serialize(),E),!!i.syncExecuteCommand(g.id,g.params)}},St={id:"doc.command.change-list-type",type:s.CommandType.COMMAND,handler:(o,t)=>{var C,T,R,v,O;const e=o.get(D.DocSelectionManagerService),n=o.get(s.IUniverInstanceService),i=o.get(s.ICommandService),{listType:a}=t,r=n.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),c=(C=t.docRange)!=null?C:e.getDocRanges();if(r==null||c==null||!c.length)return!1;const{segmentId:l}=c[0],A=r.getSelfOrHeaderFooterModel(l),d=(R=(T=A.getBody())==null?void 0:T.paragraphs)!=null?R:[],u=(O=(v=A.getBody())==null?void 0:v.dataStream)!=null?O:"";if(!d.length)return!1;const m=s.BuildTextUtils.range.getParagraphsInRanges(c,d,u),h=r.getUnitId(),g=s.BuildTextUtils.paragraph.bullet.set({paragraphs:m,listType:a,segmentId:l,document:r});if(!g)return!1;const p=s.JSONX.getInstance(),f={id:D.RichTextEditingMutation.id,params:{unitId:h,actions:[],textRanges:c,isEditing:!1}},S=Z(r,l);return f.params.actions=p.editOp(g.serialize(),S),!!i.syncExecuteCommand(f.id,f.params)}};var It=(o=>(o[o.increase=1]="increase",o[o.decrease=-1]="decrease",o))(It||{});const Yt={id:"doc.command.change-list-nesting-level",type:s.CommandType.COMMAND,handler:(o,t)=>{var T,R,v,O,M;if(!t)return!1;const{type:e}=t,n=o.get(D.DocSelectionManagerService),i=o.get(s.IUniverInstanceService),a=o.get(s.ICommandService),r=i.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),c=n.getActiveTextRange();if(r==null||c==null)return!1;const{segmentId:l}=c,A=(T=n.getDocRanges())!=null?T:[],d=r.getSelfOrHeaderFooterModel(l),u=(v=(R=d.getBody())==null?void 0:R.paragraphs)!=null?v:[],m=(M=(O=d.getBody())==null?void 0:O.dataStream)!=null?M:"";if(!u.length)return!1;const h=s.BuildTextUtils.range.getParagraphsInRange(c,u,m),g=r.getUnitId(),p=s.JSONX.getInstance(),f=s.BuildTextUtils.paragraph.bullet.changeNestLevel({paragraphs:h,type:e,segmentId:l,document:r}),S={id:D.RichTextEditingMutation.id,params:{unitId:g,actions:[],textRanges:A,isEditing:!1}},E=Z(r,l);return S.params.actions=p.editOp(f.serialize(),E),!!a.syncExecuteCommand(S.id,S.params)}},et={id:"doc.command.bullet-list",type:s.CommandType.COMMAND,handler:(o,t)=>{const e=o.get(s.ICommandService);return t!=null&&t.value?e.syncExecuteCommand(St.id,{listType:t.value,docRange:t.docRange}):e.syncExecuteCommand($e.id,{listType:s.PresetListType.BULLET_LIST,docRange:t==null?void 0:t.docRange})}},vt={id:"doc.command.check-list",type:s.CommandType.COMMAND,handler:(o,t)=>{const e=o.get(s.ICommandService);return t!=null&&t.value?e.syncExecuteCommand(St.id,{listType:t.value,docRange:t.docRange}):e.syncExecuteCommand($e.id,{listType:s.PresetListType.CHECK_LIST,docRange:t==null?void 0:t.docRange})}},to={id:"doc.command.toggle-check-list",type:s.CommandType.COMMAND,handler:(o,t)=>{var p;if(!t)return!1;const e=o.get(s.IUniverInstanceService),n=o.get(s.ICommandService),{index:i,segmentId:a,textRanges:r}=t,c=e.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);if(c==null||((p=c.getSelfOrHeaderFooterModel(a).getBody())==null?void 0:p.paragraphs)==null)return!1;const A=c.getUnitId(),d={id:D.RichTextEditingMutation.id,params:{unitId:A,actions:[],textRanges:r!=null?r:[],segmentId:a,isEditing:!1}},u=s.BuildTextUtils.paragraph.bullet.toggleChecklist({document:c,paragraphIndex:i,segmentId:a});if(!u)return!1;const m=s.JSONX.getInstance(),h=Z(c,a);return d.params.actions=m.editOp(u.serialize(),h),!!n.syncExecuteCommand(d.id,d.params)}},tt={id:"doc.command.order-list",type:s.CommandType.COMMAND,handler:(o,t)=>{const e=o.get(s.ICommandService);return t!=null&&t.value?e.syncExecuteCommand(St.id,{listType:t.value}):e.syncExecuteCommand($e.id,{listType:s.PresetListType.ORDER_LIST})}},no={id:"doc.command.quick-list",type:s.CommandType.COMMAND,handler(o,t){var x,w,F;if(!t)return!1;const e=o.get(D.DocSelectionManagerService),n=o.get(s.IUniverInstanceService),i=o.get(s.ICommandService),a=n.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),r=e.getActiveTextRange();if(a==null||r==null)return!1;const{segmentId:c,startOffset:l}=r,{listType:A,paragraph:d}=t,{paragraphStart:u,paragraphEnd:m}=d,h=new s.TextX,g=s.JSONX.getInstance(),{paragraphStyle:p={}}=d,S=(s.PRESET_LIST_TYPE[A].nestingLevel[0].paragraphProperties||{}).textStyle;let C=s.generateRandomId(6);const T=(w=(x=a.getBody())==null?void 0:x.paragraphs)!=null?w:[],R=T.findIndex(V=>V.startIndex===d.startIndex),v=T[R-1],O=T[R+1];v&&v.bullet&&v.bullet.listType.indexOf(A)===0?C=v.bullet.listId:O&&O.bullet&&O.bullet.listType.indexOf(A)===0&&(C=O.bullet.listId);const M={id:D.RichTextEditingMutation.id,params:{unitId:a.getUnitId(),actions:[],textRanges:[{startOffset:u,endOffset:u,collapsed:!0}],isEditing:!1}};h.push({t:s.TextXActionType.RETAIN,len:u}),h.push({t:s.TextXActionType.DELETE,len:l-u}),m>l&&h.push({t:s.TextXActionType.RETAIN,len:m-l}),h.push({t:s.TextXActionType.RETAIN,len:1,body:{dataStream:"",paragraphs:[{startIndex:0,paragraphStyle:{...p,textStyle:{...p.textStyle,...S},indentFirstLine:void 0},bullet:{...(F=d.bullet)!=null?F:{nestingLevel:0,textStyle:{fs:20}},listType:A,listId:C}}]}});const b=Z(a,c);return M.params.actions=g.editOp(h.serialize(),b),!!i.syncExecuteCommand(M.id,M.params)}};function oo(o,t){var d,u;const e=o.get(s.ICommandService),n=ut(o);if(!n)return!1;const i=o.get(s.IUniverInstanceService).getCurrentUnitOfType(s.UniverInstanceType.UNIVER_DOC);if(!i)return!1;const a=s.BuildTextUtils.selection.replace({doc:i,selection:{startOffset:n.startIndex+1,endOffset:n.startIndex+1,collapsed:!0},body:{dataStream:"\r",paragraphs:[{startIndex:0,paragraphStyle:{...n.paragraphStyle},bullet:{listType:t,listId:((d=n.bullet)==null?void 0:d.listType)===t?n.bullet.listId:s.generateRandomId(6),nestingLevel:((u=n.bullet)==null?void 0:u.listType)===t?n.bullet.nestingLevel:0}}]}});if(!a)return!1;const r={id:D.RichTextEditingMutation.id,params:{unitId:i.getUnitId(),actions:[],textRanges:[{startOffset:n.startIndex+1,endOffset:n.startIndex+1,collapsed:!0}],isEditing:!1}},c=s.JSONX.getInstance(),l=Z(i);return r.params.actions=c.editOp(a.serialize(),l),!!e.syncExecuteCommand(r.id,r.params)}const io={id:"doc.command.insert-bullet-list-bellow",type:s.CommandType.COMMAND,handler:o=>oo(o,s.PresetListType.BULLET_LIST)},so={id:"doc.command.insert-order-list-bellow",type:s.CommandType.COMMAND,handler:o=>oo(o,s.PresetListType.ORDER_LIST)},ao={id:"doc.command.insert-check-list-bellow",type:s.CommandType.COMMAND,handler:o=>oo(o,s.PresetListType.CHECK_LIST)},ge={id:"doc.command.align-action",type:s.CommandType.COMMAND,handler:(o,t)=>{var R,v,O,M;const e=o.get(D.DocSelectionManagerService),n=o.get(s.IUniverInstanceService),i=o.get(s.ICommandService),{alignType:a}=t,r=n.getCurrentUniverDocInstance();if(r==null)return!1;const c=e.getDocRanges();if(c.length===0)return!1;const l=c[0].segmentId,A=r.getSelfOrHeaderFooterModel(l),d=(v=(R=A.getBody())==null?void 0:R.paragraphs)!=null?v:[],u=(M=(O=A.getBody())==null?void 0:O.dataStream)!=null?M:"";if(d==null)return!1;const m=s.BuildTextUtils.range.getParagraphsInRanges(c,d,u),h=r.getUnitId(),g=m.every(b=>{var N;return((N=b.paragraphStyle)==null?void 0:N.horizontalAlign)===a}),p={id:D.RichTextEditingMutation.id,params:{unitId:h,actions:[],textRanges:c}},f=new s.MemoryCursor;f.reset();const S=new s.TextX,E=s.JSONX.getInstance();for(const b of m){const{startIndex:N}=b;S.push({t:s.TextXActionType.RETAIN,len:N-f.cursor});const x={...b.paragraphStyle,horizontalAlign:g?s.HorizontalAlign.UNSPECIFIED:a};S.push({t:s.TextXActionType.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...b,paragraphStyle:x,startIndex:0}]},coverType:s.UpdateDocsAttributeType.REPLACE}),f.moveCursorTo(N+1)}const C=Z(r,l);return p.params.actions=E.editOp(S.serialize(),C),!!i.syncExecuteCommand(p.id,p.params)}},Et={id:"doc.command.align-left",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ge.id,{alignType:s.HorizontalAlign.LEFT})},Ct={id:"doc.command.align-center",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ge.id,{alignType:s.HorizontalAlign.CENTER})},Tt={id:"doc.command.align-right",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ge.id,{alignType:s.HorizontalAlign.RIGHT})},yt={id:"doc.command.align-justify",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ge.id,{alignType:s.HorizontalAlign.JUSTIFIED})},$a=(o,t)=>{const n=o.get(s.IUniverInstanceService).getUnit(t.unitId,s.UniverInstanceType.UNIVER_DOC);return n==null||n.setZoomRatio(t.zoomRatio),{...t}},ue={id:"doc.operation.set-zoom-ratio",type:s.CommandType.OPERATION,handler:(o,t)=>{const n=o.get(s.IUniverInstanceService).getUnit(t.unitId,s.UniverInstanceType.UNIVER_DOC);return n?(n.setZoomRatio(t.zoomRatio),!0):!1}},bt={type:s.CommandType.COMMAND,id:"doc.command.set-zoom-ratio",handler:async(o,t)=>{var u,m,h;const e=o.get(s.ICommandService),n=o.get(s.IUndoRedoService),i=o.get(s.IUniverInstanceService);let a=(u=i.getCurrentUniverDocInstance())==null?void 0:u.getUnitId();if(!a)return!1;let r=1;if(t&&(a=(m=t.documentId)!=null?m:a,r=(h=t.zoomRatio)!=null?h:r),!i.getUniverDocInstance(a))return!1;const l={zoomRatio:r,unitId:a},A=$a(o,l);return e.syncExecuteCommand(ue.id,l)?(n.pushUndoRedo({unitID:a,undoMutations:[{id:ue.id,params:A}],redoMutations:[{id:ue.id,params:l}]}),!0):!1}},ce={id:"doc.command.set-paragraph-named-style",type:s.CommandType.COMMAND,handler(o,t){var g;if(!t)return!1;const n=o.get(s.IUniverInstanceService).getCurrentUnitOfType(s.UniverInstanceType.UNIVER_DOC);if(!n)return!1;const i=n.getUnitId(),a=o.get(D.DocSelectionManagerService),r=(g=t.textRanges)!=null?g:a.getTextRanges({unitId:i,subUnitId:i});if(!(r!=null&&r.length))return!1;const c=r[0].segmentId,l=s.BuildTextUtils.paragraph.style.set({document:n.getSelfOrHeaderFooterModel(c),textRanges:r,style:{namedStyleType:t.value,headingId:!t.value||t.value===s.NamedStyleType.NORMAL_TEXT?void 0:s.generateRandomId(6),spaceAbove:void 0,spaceBelow:void 0,lineSpacing:void 0},paragraphTextRun:{}}),A={id:D.RichTextEditingMutation.id,params:{actions:[],textRanges:r,unitId:i,segmentId:c}},d=s.JSONX.getInstance(),u=Z(n,c);return A.params.actions=d.editOp(l.serialize(),u),!!o.get(s.ICommandService).syncExecuteCommand(A.id,A.params)}},Xi={id:"doc.command.quick-heading",type:s.CommandType.COMMAND,handler(o,t){var R,v,O,M;if(!t)return!1;const{value:e}=t,n=o.get(D.DocSelectionManagerService),i=o.get(s.IUniverInstanceService),a=o.get(s.ICommandService),r=i.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),c=n.getActiveTextRange();if(r==null||c==null||!c.collapsed)return!1;const{segmentId:l,startOffset:A}=c,d=r.getSelfOrHeaderFooterModel(l),u=(v=(R=d.getBody())==null?void 0:R.paragraphs)!=null?v:[],m=(M=(O=d.getBody())==null?void 0:O.dataStream)!=null?M:"",h=s.BuildTextUtils.paragraph.util.getParagraphsInRange(c,u,m)[0];if(!h)return!1;const{paragraphStart:g}=h,p=new s.TextX,f=s.JSONX.getInstance(),{paragraphStyle:S={}}=h,E={id:D.RichTextEditingMutation.id,params:{unitId:r.getUnitId(),actions:[],textRanges:[{startOffset:g,endOffset:g,collapsed:!0}],isEditing:!1}};p.push({t:s.TextXActionType.RETAIN,len:g}),s.BuildTextUtils.paragraph.style.set({textRanges:[c],document:r,style:{...S,headingId:s.generateRandomId(6),namedStyleType:e},cursor:A,deleteLen:A-g,textX:p,paragraphTextRun:{}});const C=Z(r,l);return E.params.actions=f.editOp(p.serialize(),C),!!a.syncExecuteCommand(E.id,E.params)}},ro={"#":s.NamedStyleType.HEADING_1,"##":s.NamedStyleType.HEADING_2,"###":s.NamedStyleType.HEADING_3,"####":s.NamedStyleType.HEADING_4,"#####":s.NamedStyleType.HEADING_5},co={id:"doc.command.h1-heading",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ce.id,{value:s.NamedStyleType.HEADING_1})},lo={id:"doc.command.h2-heading",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ce.id,{value:s.NamedStyleType.HEADING_2})},Ao={id:"doc.command.h3-heading",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ce.id,{value:s.NamedStyleType.HEADING_3})},uo={id:"doc.command.h4-heading",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ce.id,{value:s.NamedStyleType.HEADING_4})},ho={id:"doc.command.h5-heading",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ce.id,{value:s.NamedStyleType.HEADING_5})},qt={id:"doc.command.normal-text-heading",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ce.id,{value:s.NamedStyleType.NORMAL_TEXT})},ji={id:"doc.command.title",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ce.id,{value:s.NamedStyleType.TITLE})},Ki={id:"doc.command.subtitle-heading",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ce.id,{value:s.NamedStyleType.SUBTITLE})};var Jt=(o=>(o[o.page=0]="page",o[o.section=1]="section",o[o.column=2]="column",o[o.line=3]="line",o[o.divide=4]="divide",o[o.glyph=5]="glyph",o))(Jt||{});const nt={page:0,section:1,column:2,line:3,divide:4,glyph:5};function go(o,t){return o.page>t.page?!1:o.page<t.page?!0:o.section>t.section?!1:o.section<t.section?!0:o.column>t.column?!1:o.column<t.column?!0:o.line>t.line?!1:o.line<t.line?!0:o.divide>t.divide?!1:o.divide<t.divide?!0:o.glyph>t.glyph?!1:(o.glyph<t.glyph,!0)}function mo(o,t){return go(o,t)?{start:o,end:t}:{start:t,end:o}}function po(o){const t=o.length;if(t===0)return;const e=o[0],n=o[t-1],i=o.length===1&&e.collapsed;return{startOffset:e.startOffset,endOffset:n.endOffset,collapsed:i}}function er(o,t,e,n){let i=n,a=n;for(let r=0;r<o.length;r++){const l=o[r].count;r<t&&(i+=l),r<e&&(a+=l)}return{startOffset:i,endOffset:a}}function fo(o){const{startX:t,startY:e,endX:n,endY:i}=o,a=[];return a.push({x:t,y:e}),a.push({x:n,y:e}),a.push({x:n,y:i}),a.push({x:t,y:i}),a.push({x:t,y:e}),a}class be{constructor(t,e){B(this,"_liquid",new _.Liquid);B(this,"_currentStartState",{page:0,section:0,column:0,line:0,divide:0,glyph:0});B(this,"_currentEndState",{page:0,section:0,column:0,line:0,divide:0,glyph:0});this._documentOffsetConfig=t,this._docSkeleton=e}getRangePointData(t,e){const n=[],i=[],a=[];if(t==null||e==null)return{borderBoxPointGroup:n,contentBoxPointGroup:i,cursorList:a};if(!this._isValidPosition(t,e))throw new Error(`
                Invalid positions in NodePositionConvertToCursor,
                they are not in the same segment page when in header or footer.`);const{start:c,end:l}=mo(t,e);return this._selectionIterator(c,l,(A,d,u,m,h,g)=>{const{lineHeight:p,asc:f,paddingTop:S,marginTop:E,marginBottom:C}=g,{glyphGroup:T,st:R}=h;if(T.length===0)return;const{x:v,y:O}=this._liquid;let M,b;const N=T[A],x=T[d],w=T[A-1],F=(N==null?void 0:N.left)||0,V=(N==null?void 0:N.width)||0,H=(x==null?void 0:x.left)||0,Q=(x==null?void 0:x.width)||0,j=(N==null?void 0:N.glyphType)===_.GlyphType.LIST,{startOffset:X,endOffset:k}=er(T,A,d,R),W=c.glyph===A&&u?c.isBack:!0,G=l.glyph===d&&m?l.isBack:!1,K=c===l,Y=W&&w!=null?w:N;if(A===0&&d===T.length-1)M={startX:v+F+(j?V:0),startY:O,endX:v+H+(G?0:Q),endY:O+p-E-C},b={startX:v+F+(j?V:0),startY:O+S+f-Y.bBox.ba,endX:v+H+(G?0:Q),endY:O+S+f+Y.bBox.bd};else{const q=W&&!j;M={startX:v+F+(q?0:V),startY:O,endX:v+H+(G?0:Q),endY:O+p-E-C},b={startX:v+F+(q?0:V),startY:O+S+f-Y.bBox.ba,endX:v+H+(G?0:Q),endY:O+S+f+Y.bBox.bd}}n.push(fo(M)),i.push(fo(b)),a.push({startOffset:W?X:X+N.count,endOffset:G?k:k+x.count,collapsed:K})}),{borderBoxPointGroup:n,contentBoxPointGroup:i,cursorList:a}}_isValidPosition(t,e){const{segmentPage:n,pageType:i}=t,{segmentPage:a,pageType:r}=e;return i!==r?!1:i===_.DocumentSkeletonPageType.HEADER||i===_.DocumentSkeletonPageType.FOOTER?n===a:!0}_resetCurrentNodePositionState(){this._currentStartState={page:0,section:0,column:0,line:0,divide:0,glyph:0},this._currentEndState={page:0,section:0,column:0,line:0,divide:0,glyph:0}}_setNodePositionState(t=0,e,n,i){i===e?this._currentStartState[t]=1:this._currentStartState[t]=0,i===n?this._currentEndState[t]=2:this._currentEndState[t]=0}_checkPreviousNodePositionState(t,e=!0){let n=t,i;for(;n>=0;){const a=Jt[n];let r;if(e?r=this._currentStartState[a]:r=this._currentEndState[a],r===void 0)return;if(i===void 0&&(i=r),r!==i)return 0;n--}return i}_getSelectionRuler(t,e,n,i,a){let r=0,c=i;const l=Jt[t],A=Jt[t+1];if(A===null||l===null)return{start_next:r,end_next:c};const d=e[l],u=n[l];this._setNodePositionState(l,d,u,a);const m=this._checkPreviousNodePositionState(t),h=this._checkPreviousNodePositionState(t,!1);return m===1&&(r=e[A]),h===2&&(c=n[A]),{start_next:r,end_next:c}}_selectionIterator(t,e,n){var T,R;const i=this._docSkeleton;if(!i)return[];const{pageType:a,path:r}=t;this._liquid.reset();const c=i.getSkeletonData();if(c==null)return[];const{pages:l,skeHeaders:A,skeFooters:d}=c,{page:u,segmentPage:m}=t,{page:h,segmentPage:g}=e;if(this._resetCurrentNodePositionState(),this._documentOffsetConfig==null)return[];const{pageLayoutType:p,pageMarginLeft:f,pageMarginTop:S}=this._documentOffsetConfig,E=a===_.DocumentSkeletonPageType.BODY||a===_.DocumentSkeletonPageType.CELL?u:m;for(let v=0;v<E;v++){const O=l[v];this._liquid.translatePage(O,p,f,S)}const C=a===_.DocumentSkeletonPageType.BODY||a===_.DocumentSkeletonPageType.CELL?h:g;for(let v=E;v<=C;v++){const O=l[v],{headerId:M,footerId:b,pageWidth:N}=O;let x=O;if(a===_.DocumentSkeletonPageType.HEADER?x=(T=A.get(M))==null?void 0:T.get(N):a===_.DocumentSkeletonPageType.FOOTER?x=(R=d.get(b))==null?void 0:R.get(N):a===_.DocumentSkeletonPageType.CELL&&(x=_.getPageFromPath(c,r)),x==null){this._liquid.translatePage(O,p,f,S);continue}const w=x.sections,{start_next:F,end_next:V}=this._getSelectionRuler(nt.page,t,e,w.length-1,a===_.DocumentSkeletonPageType.BODY||a===_.DocumentSkeletonPageType.CELL?v:0);switch(this._liquid.translateSave(),a){case _.DocumentSkeletonPageType.HEADER:this._liquid.translatePagePadding({...x,marginLeft:O.marginLeft});break;case _.DocumentSkeletonPageType.FOOTER:{const H=O.pageHeight-x.height-x.marginBottom;this._liquid.translate(O.marginLeft,H);break}case _.DocumentSkeletonPageType.CELL:{this._liquid.translatePagePadding(O);const H=x.parent,Q=H.parent,{left:j}=x,{top:X,left:k}=Q,{top:W}=H;this._liquid.translate(k+j,X+W),this._liquid.translatePagePadding(x);break}default:this._liquid.translatePagePadding(O);break}for(let H=F;H<=V;H++){const Q=w[H],j=Q.columns,{start_next:X,end_next:k}=this._getSelectionRuler(nt.section,t,e,j.length-1,H);this._liquid.translateSection(Q);for(let W=X;W<=k;W++){const G=j[W],K=G.lines,{start_next:Y,end_next:q}=this._getSelectionRuler(nt.column,t,e,K.length-1,W);this._liquid.translateColumn(G);for(let z=Y;z<=q;z++){const $=K[z],{divides:ie}=$,{start_next:fe,end_next:He}=this._getSelectionRuler(nt.line,t,e,ie.length-1,z);this._liquid.translateSave(),this._liquid.translateLine($,!0,!1);for(let Se=fe;Se<=He;Se++){const ti=ie[Se];this._liquid.translateSave(),this._liquid.translateDivide(ti);const{glyphGroup:TA}=ti,{start_next:yA,end_next:bA}=this._getSelectionRuler(nt.divide,t,e,TA.length-1,Se);let Aa=!1,ua=!1;v===E&&H===F&&W===X&&z===Y&&Se===fe&&(Aa=!0),v===C&&H===V&&W===k&&z===q&&Se===He&&(ua=!0),n&&n(yA,bA,Aa,ua,ti,$,G,Q,x),this._liquid.translateRestore()}this._liquid.translateRestore()}}}this._liquid.translateRestore(),this._liquid.translatePage(O,p,f,S)}}}function zi(o,t){const{path:e}=o,{path:n}=t;if(e.length!==n.length||e.indexOf("cells")===-1)return!1;const i=e.indexOf("skeTables")+1,a=e.indexOf("rows")+1,r=e.indexOf("cells")+1,{tableId:c,sliceIndex:l}=_.getTableIdAndSliceIndex(e[i]),{tableId:A,sliceIndex:d}=_.getTableIdAndSliceIndex(n[i]);if(c!==A)return!1;const u=e[a],m=n[a],h=e[r],g=n[r];return!(u===m&&h===g&&l===d)}function So(o,t){const{path:e}=o,{path:n}=t;return e.indexOf("cells")===-1||n.indexOf("cells")===-1||e.length!==n.length?!1:s.Tools.diffValue(e,n)}function Yi(o,t,e){var h,g,p,f,S,E,C,T;const{path:n}=t,{path:i}=e;if(n.indexOf("cells")===-1||i.indexOf("cells")===-1)return!1;const a=o.findGlyphByPosition(t),r=o.findGlyphByPosition(e),c=(f=(p=(g=(h=a==null?void 0:a.parent)==null?void 0:h.parent)==null?void 0:g.parent)==null?void 0:p.parent)==null?void 0:f.parent,l=(T=(C=(E=(S=r==null?void 0:r.parent)==null?void 0:S.parent)==null?void 0:E.parent)==null?void 0:C.parent)==null?void 0:T.parent;if(c==null||l==null)return!1;const A=c.parent,d=l.parent,u=A.cells.indexOf(c),m=d.cells.indexOf(l);return u===m&&A.index===d.index}function Io(o,t){if(So(o,t))return go(o,t);const{path:e}=o,{path:n}=t,i=e[e.length-5],a=n[n.length-5];if(i!==a&&typeof i=="string"&&typeof a=="string"){const d=i.split("#-#")[1],u=a.split("#-#")[1];return+d<+u}const r=e[e.length-3],c=n[n.length-3],l=e[e.length-1],A=n[n.length-1];return r<c?!0:r>c?!1:l<=A}function ot(o){return o.sections[0].columns[0].lines.length===0}function tr(o,t,e){let n=t,i=e,a=o[n],r=o[i];for(;n<i&&(ot(a)||ot(r));)ot(a)?(n++,a=o[n]):ot(r)&&(i--,r=o[i]);if(!ot(a)&&!ot(r))return[a,r]}class vo{constructor(t,e){B(this,"_liquid",new _.Liquid);this._documentOffsetConfig=t,this._docSkeleton=e}getRangePointData(t,e){const n=[],a=this._docSkeleton.getSkeletonData();if(a==null)return;const{pages:r}=a,{segmentPage:c,page:l,pageType:A}=t,d=this._getTableRectRangeInfo(t,e);if(d==null)return;const{tableId:u,startRowIndex:m,startColumnIndex:h,endRowIndex:g,endColumnIndex:p}=d;this._liquid.reset();const{pageLayoutType:f,pageMarginLeft:S,pageMarginTop:E}=this._documentOffsetConfig,C=A===_.DocumentSkeletonPageType.BODY||A===_.DocumentSkeletonPageType.CELL?l:c;for(let T=0;T<C;T++){const R=r[T];this._liquid.translatePage(R,f,S,E)}for(let T=C;T<r.length;T++){const R=r[T];this._liquid.translatePagePadding(R);const{skeTables:v}=R;let O=null;for(const[x,w]of v.entries())x.startsWith(u)&&(O=w);if(O==null){this._liquid.restorePagePadding(R),this._liquid.translatePage(R,f,S,E);continue}this._liquid.translateSave(),this._liquid.translate(0,O.top);const{x:M,y:b}=this._liquid,{left:N}=O;for(const x of O.rows)if(x.index>=m&&x.index<=g){const w=tr(x.cells,h,p);if(w==null)continue;const[F,V]=w,H={startX:M+F.left+N,startY:b+x.top,endX:M+V.left+V.pageWidth+N,endY:b+x.top+x.height};n.push(fo(H))}this._liquid.translateRestore(),this._liquid.restorePagePadding(R),this._liquid.translatePage(R,f,S,E)}return{pointGroup:n,startRow:m,startColumn:h,endRow:g,endColumn:p,tableId:u}}getNodePositionGroup(t,e){const n=[],i=this._docSkeleton.findCharIndexByPosition(t),a=this._docSkeleton.findCharIndexByPosition(e);if(i==null||a==null)return;const r=i<a,c=this._getTableRectRangeInfo(t,e);if(c==null)return;const{tableId:l,startRowIndex:A,startColumnIndex:d,endRowIndex:u,endColumnIndex:m}=c,h=this._docSkeleton.getViewModel().findTableNodeById(l);if(h==null)return;const g=h.children[0].children.length;if(d===0&&m===g-1){const f=h.children[A].children[d],S=this._docSkeleton.findNodePositionByCharIndex(f.startIndex+1),E=h.children[u].children[m],C=this._docSkeleton.findNodePositionByCharIndex(E.endIndex-2);if(S==null||C==null)return;n.push({anchor:r?S:C,focus:r?C:S})}else for(let f=A;f<=u;f++){const S=h.children[f],E=S.children[d],C=S.children[m],T=this._docSkeleton.findNodePositionByCharIndex(E.startIndex+1),R=this._docSkeleton.findNodePositionByCharIndex(C.endIndex-2);if(T==null||R==null)return;n.push({anchor:r?T:R,focus:r?R:T})}return n}_getTableRectRangeInfo(t,e){const i=this._docSkeleton.getSkeletonData();if(i==null)return;const{pages:a}=i,{path:r}=t,{path:c}=e,l=_.getPageFromPath(i,r),A=_.getPageFromPath(i,c);if(l==null||A==null)return;const d=l.segmentId,u=l.parent.index,m=l.parent.cells.indexOf(l),h=(A==null?void 0:A.parent).index,g=(A==null?void 0:A.parent).cells.indexOf(A),p=Math.min(u,h),f=Math.max(u,h),S=Math.min(m,g),E=Math.max(m,g);return{pages:a,tableId:d,startRowIndex:p,startColumnIndex:S,endRowIndex:f,endColumnIndex:E}}}const nr="__TestSelectionRange__",or="__TestSelectionAnchor__",qi=6,Eo=500,ir=500,Zt=3;function Ot(o){const t=o[0],e=t[0],n=t[2],{x:i,y:a}=e,{x:r,y:c}=n;return{left:i,top:a,width:r-i,height:c-a}}function $t(o){return o.map(t=>{let e=1/0,n=-1/0,i=1/0,a=-1/0;return t.forEach(r=>{e=Math.min(r.x,e),n=Math.max(r.x,n),a=Math.max(r.y,a),i=Math.min(r.y,i)}),{left:e,right:n,top:i,bottom:a}})}class We{constructor(t,e,n,i,a,r=_.NORMAL_TEXT_SELECTION_PLUGIN_STYLE,c="",l=-1){B(this,"rangeType",s.DOC_RANGE_TYPE.TEXT);B(this,"_current",!1);B(this,"_rangeShape");B(this,"_anchorShape");B(this,"_cursorList",[]);B(this,"_anchorBlinkTimer",null);this._scene=t,this._document=e,this._docSkeleton=n,this.anchorNodePosition=i,this.focusNodePosition=a,this.style=r,this._segmentId=c,this._segmentPage=l,this._anchorBlink(),this.refresh()}_anchorBlink(){setTimeout(()=>{this._anchorShape&&this._anchorShape.visible&&this.deactivateStatic()},Eo),this._anchorBlinkTimer=setInterval(()=>{this._anchorShape&&this._anchorShape.visible&&(this.activeStatic(),setTimeout(()=>{this.deactivateStatic()},Eo))},ir+Eo)}get startOffset(){var i;const{startOffset:t}=(i=po(this._cursorList))!=null?i:{},e=this._docSkeleton.getViewModel().getDataModel().getSelfOrHeaderFooterModel(this._segmentId).getBody();if(t==null||e==null)return t;const n=e.dataStream.length-2;return Math.min(n,t)}get endOffset(){var i;const{endOffset:t}=(i=po(this._cursorList))!=null?i:{},e=this._docSkeleton.getViewModel().getDataModel().getSelfOrHeaderFooterModel(this._segmentId).getBody();if(t==null||e==null)return t;const n=e.dataStream.length-2;return Math.min(t,n)}get collapsed(){const{startOffset:t,endOffset:e}=this;return t!=null&&t===e}get startNodePosition(){if(this.anchorNodePosition==null)return null;if(this.focusNodePosition==null)return this.anchorNodePosition;const{start:t}=mo(this.anchorNodePosition,this.focusNodePosition);return t}get endNodePosition(){if(this.anchorNodePosition==null)return this.focusNodePosition;if(this.focusNodePosition==null)return null;const{end:t}=mo(this.anchorNodePosition,this.focusNodePosition);return t}get direction(){const{collapsed:t,anchorNodePosition:e,focusNodePosition:n}=this;return t||e==null||n==null?s.RANGE_DIRECTION.NONE:go(e,n)?s.RANGE_DIRECTION.FORWARD:s.RANGE_DIRECTION.BACKWARD}get segmentId(){return this._segmentId}get segmentPage(){return this._segmentPage}getAbsolutePosition(){const t=this.anchorNodePosition,e=this.focusNodePosition;if(this._isEmpty())return;const n=this._document.getOffsetConfig(),{docsLeft:i,docsTop:a}=n,r=new be(n,this._docSkeleton);if(this._isCollapsed()){const{contentBoxPointGroup:d,cursorList:u}=r.getRangePointData(t,t);if(this._setCursorList(u),d.length===0)return;const m=Ot(d);return{...m,left:m.left+i,top:m.top+a}}const{borderBoxPointGroup:c,cursorList:l}=r.getRangePointData(t,e);if(this._setCursorList(l),c.length===0)return;const A=Ot(c);return{...A,left:A.left+i,top:A.top+a}}getAnchor(){return this._anchorShape}activeStatic(){var t,e;(e=this._anchorShape)==null||e.setProps({stroke:((t=this.style)==null?void 0:t.strokeActive)||_.getColor(s.COLORS.black,1)})}deactivateStatic(){var t,e;(e=this._anchorShape)==null||e.setProps({stroke:((t=this.style)==null?void 0:t.stroke)||_.getColor(s.COLORS.black,0)})}isActive(){return this._current===!0}activate(){this._current=!0}deactivate(){this._current=!1}dispose(){var t,e;(t=this._rangeShape)==null||t.dispose(),this._rangeShape=null,(e=this._anchorShape)==null||e.dispose(),this._anchorShape=null,this._anchorBlinkTimer&&(clearInterval(this._anchorBlinkTimer),this._anchorBlinkTimer=null)}isIntersection(t){const{startOffset:e,endOffset:n}=this,{startOffset:i,endOffset:a}=t;return e==null||n==null||i==null||a==null?!1:e<=a&&n>=i}refresh(){var u,m;const{_document:t,_docSkeleton:e}=this,n=this.anchorNodePosition,i=this.focusNodePosition;if((u=this._anchorShape)==null||u.hide(),(m=this._rangeShape)==null||m.hide(),this._isEmpty())return;const a=t.getOffsetConfig(),{docsLeft:r,docsTop:c}=a,l=new be(a,e);if(this._isCollapsed()){const{contentBoxPointGroup:h,cursorList:g}=l.getRangePointData(n,n);if(this._setCursorList(g),h.length>0){const p=e.findGlyphByPosition(n);this._createOrUpdateAnchor(h,r,c,p)}return}const{borderBoxPointGroup:A,cursorList:d}=l.getRangePointData(n,i);this._setCursorList(d),A.length>0&&this._createOrUpdateRange(A,r,c)}_isEmpty(){return this.anchorNodePosition==null&&this.focusNodePosition==null}_isCollapsed(){const t=this.anchorNodePosition,e=this.focusNodePosition;if(t!=null&&e==null)return!0;if(t==null||e==null)return!1;const n=Object.keys(nt);for(const i of n){const a=t[i],r=e[i];if(a!==r)return!1}return t.isBack===e.isBack}_createOrUpdateRange(t,e,n){var r;if(this._rangeShape){this._rangeShape.translate(e,n),this._rangeShape.updatePointGroup(t),this._rangeShape.show();return}const i=.3,a=new _.RegularPolygon(nr+s.generateRandomId(qi),{pointsGroup:t,fill:((r=this.style)==null?void 0:r.fill)||_.getColor(s.COLORS.black,i),left:e,top:n,evented:!1,debounceParentDirty:!1});this._rangeShape=a,this._scene.addObject(a,Zt)}_createOrUpdateAnchor(t,e,n,i){var p,f,S;const a=Ot(t),{left:r}=a;let{top:c,height:l}=a;const A=14;l<A&&(c-=A-l,l=A);const d=12;let u=r+e;const m=c+n,h=((p=i==null?void 0:i.ts)==null?void 0:p.it)===s.BooleanNumber.TRUE;if(h&&(u+=l*Math.tan(d*Math.PI/180)/2),this._anchorShape){this._anchorShape.transformByState({left:u,top:m,height:l}),this._anchorShape.show(),h?this._anchorShape.skew(-d,0):this._anchorShape.skew(0,0);return}const g=new _.Rect(or+s.generateRandomId(qi),{left:u,top:m,height:l,strokeWidth:((f=this.style)==null?void 0:f.strokeWidth)||1,stroke:((S=this.style)==null?void 0:S.strokeActive)||_.getColor(s.COLORS.black,1),evented:!1});h&&g.skew(-d,0),this._anchorShape=g,this._scene.addObject(g,Zt),this.activeStatic()}_setCursorList(t){t.length!==0&&(this._cursorList=t)}}const sr="__DocTableRectRange__",ar=6;function en(o,t,e,n,i,a=_.NORMAL_TEXT_SELECTION_PLUGIN_STYLE,r="",c=-1){const l=t.getOffsetConfig(),d=new vo(l,e).getNodePositionGroup(n,i);return(d!=null?d:[]).map(u=>new Co(o,t,e,u.anchor,u.focus,a,r,c))}class Co{constructor(t,e,n,i,a,r=_.NORMAL_TEXT_SELECTION_PLUGIN_STYLE,c="",l=-1){B(this,"rangeType",s.DOC_RANGE_TYPE.RECT);B(this,"_rangeShape");B(this,"_current",!1);B(this,"_startRow");B(this,"_startCol");B(this,"_endRow");B(this,"_endCol");B(this,"_tableId");this._scene=t,this._document=e,this._docSkeleton=n,this.anchorNodePosition=i,this.focusNodePosition=a,this.style=r,this._segmentId=c,this._segmentPage=l,this.refresh()}get startOffset(){const{startNodePosition:t}=this;return this._docSkeleton.findCharIndexByPosition(t)}get endOffset(){const{endNodePosition:t}=this;return this._docSkeleton.findCharIndexByPosition(t)}get collapsed(){return!1}get startRow(){return this._startRow}get startColumn(){return this._startCol}get endRow(){return this._endRow}get endColumn(){return this._endCol}get tableId(){return this._tableId}get segmentId(){return this._segmentId}get segmentPage(){return this._segmentPage}get spanEntireRow(){var r;const e=(r=this._docSkeleton.getViewModel().getSnapshot().tableSource)==null?void 0:r[this._tableId],{_startCol:n,_endCol:i}=this;if(e==null)throw new Error("Table is not found.");const{tableColumns:a}=e;return n===0&&i===a.length-1}get spanEntireColumn(){var r;const e=(r=this._docSkeleton.getViewModel().getSnapshot().tableSource)==null?void 0:r[this._tableId],{_startRow:n,_endRow:i}=this;if(e==null)throw new Error("Table is not found.");const{tableRows:a}=e;return n===0&&i===a.length-1}get spanEntireTable(){return this.spanEntireRow&&this.spanEntireColumn}get startNodePosition(){const{anchorNodePosition:t,focusNodePosition:e}=this;return Io(t,e)?t:e}get endNodePosition(){const{anchorNodePosition:t,focusNodePosition:e}=this;return Io(t,e)?e:t}get direction(){const{anchorNodePosition:t,focusNodePosition:e}=this;return Io(t,e)?s.RANGE_DIRECTION.FORWARD:s.RANGE_DIRECTION.BACKWARD}isActive(){return this._current===!0}activate(){this._current=!0}deactivate(){this._current=!1}dispose(){var t;(t=this._rangeShape)==null||t.dispose(),this._rangeShape=null}isIntersection(t){const{startRow:e,startColumn:n,endRow:i,endColumn:a}=this,{startRow:r,startColumn:c,endRow:l,endColumn:A}=t,d={left:n,top:e,right:a,bottom:i},u={left:c,top:r,right:A,bottom:l};return s.Rectangle.hasIntersectionBetweenTwoRect(d,u)}refresh(){var f;(f=this._rangeShape)==null||f.hide();const{startNodePosition:t,endNodePosition:e,_document:n,_docSkeleton:i}=this,a=n.getOffsetConfig(),{docsLeft:r,docsTop:c}=a,A=new vo(a,i).getRangePointData(t,e);if(A==null)return;const{pointGroup:d=[],startRow:u,endRow:m,startColumn:h,endColumn:g,tableId:p}=A;(d==null?void 0:d.length)>0&&this._createOrUpdateRange(d,r,c),this._updateTableInfo(u,m,h,g,p)}_updateTableInfo(t,e,n,i,a){this._startRow=t,this._endRow=e,this._startCol=n,this._endCol=i,this._tableId=a}_createOrUpdateRange(t,e,n){var r;if(this._rangeShape){this._rangeShape.translate(e,n),this._rangeShape.updatePointGroup(t),this._rangeShape.show();return}const i=.3,a=new _.RegularPolygon(sr+s.generateRandomId(ar),{pointsGroup:t,fill:((r=this.style)==null?void 0:r.fill)||_.getColor(s.COLORS.black,i),left:e,top:n,evented:!1,debounceParentDirty:!1});this._rangeShape=a,this._scene.addObject(a,Zt)}}function Ji(o,t,e,n,i,a,r,c,l=!0,A=!0){const d=i.findNodePositionByCharIndex(o,l,r,c),u=i.findNodePositionByCharIndex(t,A,r,c);if(!(d==null||u==null))return new We(e,n,i,d,u,a,r,c)}function rr(o,t,e,n,i,a,r,c){const l=i.findNodePositionByCharIndex(o,!0,r,c),A=i.findNodePositionByCharIndex(t,!0,r,c);if(!(l==null||A==null))return new Co(e,n,i,l,A,a,r,c)}function cr(o,t,e,n,i,a,r,c){const l=i.findNodePositionByCharIndex(o,!0,r,c),A=i.findNodePositionByCharIndex(t,!0,r,c);if(!(l==null||A==null))return To(l,A,e,n,i,a,r,c)}function To(o,t,e,n,i,a,r,c){const l=[],A=[],d=[e,n,i,o,t,a,r,c];if(Yi(i,o,t)){if(So(o,t))return l.push(new We(...d)),{textRanges:l,rectRanges:A};{const C=en(...d);return A.push(...C),{textRanges:l,rectRanges:A}}}if(zi(o,t)){const C=en(...d);return A.push(...C),{textRanges:l,rectRanges:A}}const u=i.getViewModel().getSelfOrHeaderFooterViewModel(r),m=i.findCharIndexByPosition(o),h=i.findCharIndexByPosition(t);if(m==null||h==null)return;const g=m<=h?s.RANGE_DIRECTION.FORWARD:s.RANGE_DIRECTION.BACKWARD,p=Math.min(m,h),f=Math.max(m,h);let S=p,E=f;for(const C of u.getChildren())for(const T of C.children){const{startIndex:R,endIndex:v,children:O}=T,M=C.children.indexOf(T),b=C.children[M+1],N=O[0];let x=!1;if(N){const{startIndex:w,endIndex:F,children:V}=N;let H=null,Q=null;const j=V.find(k=>k.startIndex<=p&&k.endIndex>=p),X=V.find(k=>k.startIndex<=f&&k.endIndex>=f);if(p>w&&p<F)H=i.findNodePositionByCharIndex(j.startIndex+2,!0,r,c),Q=i.findNodePositionByCharIndex(F-4,!0,r,c),S=F+1;else if(f>w&&f<F)H=i.findNodePositionByCharIndex(w+3,!0,r,c),Q=i.findNodePositionByCharIndex(X.endIndex-3,!0,r,c),E=w-1,x=!0;else if(w>p&&F<f){if(H=i.findNodePositionByCharIndex(w+3,!0,r,c),Q=i.findNodePositionByCharIndex(F-4,!0,r,c),S<=w-1){const k=i.findNodePositionByCharIndex(S,!0,r,c),W=i.findNodePositionByCharIndex(w-1,!1,r,c),G=g===s.RANGE_DIRECTION.FORWARD?k:W,K=g===s.RANGE_DIRECTION.FORWARD?W:k;l.push(new We(e,n,i,G,K,a,r,c))}S=F+1}if(H&&Q){const k=g===s.RANGE_DIRECTION.FORWARD?H:Q,W=g===s.RANGE_DIRECTION.FORWARD?Q:H;A.push(...en(e,n,i,k,W,a,r,c))}}if(E===v+1&&!x&&b&&b.children.length&&(E=v,x=!0),E>=R&&E<=v||x){const w=i.findNodePositionByCharIndex(S,!0,r,c),F=i.findNodePositionByCharIndex(E,!x,r,c),V=g===s.RANGE_DIRECTION.FORWARD?w:F,H=g===s.RANGE_DIRECTION.FORWARD?F:w;if(A.length&&s.Tools.diffValue(V,H))continue;l.push(new We(e,n,i,V,H,a,r,c))}}return{textRanges:l,rectRanges:A}}function Zi(o){const t=o==null?void 0:o.getCanvasElement();if(!t)return{left:0,top:0};const{top:e,left:n}=_.getOffsetRectForDom(t);return{left:n,top:e}}function $i(o){var l;const t=(l=o.parent)==null?void 0:l.parent,e=t==null?void 0:t.parent;if(t==null||e==null)return;const{paragraphIndex:n}=t,i=e.lines.filter(A=>A.paragraphIndex===n);let a=-1,r="",c=!1;for(const A of i)for(const d of A.divides)for(const u of d.glyphGroup)c||(a+=u.count),u===o&&(c=!0),r+=u.count>0?u.content:"";return{st:i[0].st,ed:n,content:r,nodeIndex:a}}function yo(o){const{startOffset:t,endOffset:e,collapsed:n,rangeType:i,startNodePosition:a,endNodePosition:r,direction:c,segmentId:l,segmentPage:A}=o;return{startOffset:t,endOffset:e,collapsed:n,rangeType:i,startNodePosition:a,endNodePosition:r,direction:c,segmentId:l,segmentPage:A,isActive:o.isActive()}}function lr(o){const t=yo(o),{startRow:e,startColumn:n,endRow:i,endColumn:a,tableId:r,spanEntireRow:c,spanEntireColumn:l,spanEntireTable:A}=o;return{...t,startRow:e,startColumn:n,endRow:i,endColumn:a,tableId:r,spanEntireRow:c,spanEntireColumn:l,spanEntireTable:A}}var dr=Object.getOwnPropertyDescriptor,Ar=(o,t,e,n)=>{for(var i=n>1?void 0:n?dr(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},tn=(o,t)=>(e,n)=>t(e,n,o);y.DocSelectionRenderService=class extends s.RxDisposable{constructor(e,n,i,a,r){super();B(this,"_onInputBefore$",new L.Subject);B(this,"onInputBefore$",this._onInputBefore$.asObservable());B(this,"_onKeydown$",new L.Subject);B(this,"onKeydown$",this._onKeydown$.asObservable());B(this,"_onInput$",new L.Subject);B(this,"onInput$",this._onInput$.asObservable());B(this,"_onCompositionstart$",new L.BehaviorSubject(null));B(this,"onCompositionstart$",this._onCompositionstart$.asObservable());B(this,"_onCompositionupdate$",new L.BehaviorSubject(null));B(this,"onCompositionupdate$",this._onCompositionupdate$.asObservable());B(this,"_onCompositionend$",new L.BehaviorSubject(null));B(this,"onCompositionend$",this._onCompositionend$.asObservable());B(this,"_onSelectionStart$",new L.BehaviorSubject(null));B(this,"onSelectionStart$",this._onSelectionStart$.asObservable());B(this,"onChangeByEvent$",L.merge(this._onInput$,this._onKeydown$.pipe(L.filter(e=>e.event.keyCode===I.KeyCode.BACKSPACE)),this._onCompositionend$));B(this,"_onPaste$",new L.Subject);B(this,"onPaste$",this._onPaste$.asObservable());B(this,"_textSelectionInner$",new L.BehaviorSubject(null));B(this,"textSelectionInner$",this._textSelectionInner$.asObservable());B(this,"_onFocus$",new L.Subject);B(this,"onFocus$",this._onFocus$.asObservable());B(this,"_onBlur$",new L.Subject);B(this,"onBlur$",this._onBlur$.asObservable());B(this,"_onPointerDown$",new L.Subject);B(this,"onPointerDown$",this._onPointerDown$.asObservable());B(this,"_container");B(this,"_inputParent");B(this,"_input");B(this,"_scrollTimers",[]);B(this,"_rangeList",[]);B(this,"_rangeListCache",[]);B(this,"_rectRangeList",[]);B(this,"_rectRangeListCache",[]);B(this,"_anchorNodePosition",null);B(this,"_focusNodePosition",null);B(this,"_currentSegmentId","");B(this,"_currentSegmentPage",-1);B(this,"_selectionStyle",_.NORMAL_TEXT_SELECTION_PLUGIN_STYLE);B(this,"_onPointerEvent",!1);B(this,"_viewPortObserverMap",new Map);B(this,"_isIMEInputApply",!1);B(this,"_scenePointerMoveSubs",[]);B(this,"_scenePointerUpSubs",[]);B(this,"_reserveRanges",!1);this._context=e,this._layoutService=n,this._logService=i,this._univerInstanceService=a,this._docSkeletonManagerService=r,this._initDOM(),this._registerContainer(),this._setSystemHighlightColorToStyle(),this._listenCurrentUnitChange()}get isOnPointerEvent(){return this._onPointerEvent}get isFocusing(){return this._input===document.activeElement}get canFocusing(){return this.isFocusing||document.activeElement===document.body||document.activeElement===null}_listenCurrentUnitChange(){this._univerInstanceService.getCurrentTypeOfUnit$(s.UniverInstanceType.UNIVER_DOC).pipe(L.takeUntil(this.dispose$)).subscribe(e=>{if(e==null)return;e.getUnitId()!==this._context.unitId&&!this._reserveRanges&&this.removeAllRanges()})}get activeViewPort(){return this._context.scene.getViewports()[0]}setSegment(e){this._currentSegmentId=e}getSegment(){return this._currentSegmentId}setSegmentPage(e){this._currentSegmentPage=e}getSegmentPage(){return this._currentSegmentPage}setReserveRangesStatus(e){this._reserveRanges=e}_setRangeStyle(e=_.NORMAL_TEXT_SELECTION_PLUGIN_STYLE){this._selectionStyle=e}addDocRanges(e,n=!0,i){const{_currentSegmentId:a,_currentSegmentPage:r,_selectionStyle:c}=this,{scene:l,mainComponent:A}=this._context,d=A,u=this._docSkeletonManagerService.getSkeleton(),m=(h,g)=>{const p=cr(h,g,l,d,u,c,a,r);if(p==null)return;const{textRanges:f,rectRanges:S}=p;for(const E of f)this._addTextRange(E);this._addRectRanges(S)};for(const h of e){const{startOffset:g,endOffset:p,rangeType:f,startNodePosition:S,endNodePosition:E}=h;if(f===s.DOC_RANGE_TYPE.RECT){const C=rr(g,p,l,d,u,c,a,r);C&&this._addRectRanges([C])}else if(f===s.DOC_RANGE_TYPE.TEXT)try{let C=null;S&&E?C=Ji(S.isBack?g:g-1,E.isBack?p:p-1,l,d,u,c,a,r,S.isBack,E.isBack):C=Ji(g,p,l,d,u,c,a,r),C&&this._addTextRange(C)}catch{m(g,p)}else m(g,p)}this._textSelectionInner$.next({textRanges:this._getAllTextRanges(),rectRanges:this._getAllRectRanges(),segmentId:a,segmentPage:r,style:c,isEditing:n,options:i}),!(!e.length||(i==null?void 0:i.shouldFocus)===!1)&&this._updateInputPosition(i==null?void 0:i.forceFocus)}setCursorManually(e,n){const i=this._findNodeByCoord(e,n,{strict:!0,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage}),a=this._getNodePosition(i);if(a==null){this._removeAllRanges();return}(i==null?void 0:i.node.streamType)===s.DataStreamTreeTokenType.PARAGRAPH&&(a.isBack=!0),this._createTextRangeByAnchorPosition(a),this._textSelectionInner$.next({textRanges:this._getAllTextRanges(),rectRanges:this._getAllRectRanges(),segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage,style:this._selectionStyle,isEditing:!1})}sync(){this._updateInputPosition()}activate(e,n,i=!1){this._container.style.left=`${e}px`,this._container.style.top=`${n}px`,this._container.style.zIndex="1000",(this.canFocusing||i)&&this.focus()}hasFocus(){return document.activeElement===this._input}focus(){this._input.focus()}blur(){this._input.blur()}deactivate(){this._container.style.left="0px",this._container.style.top="0px"}__handleDblClick(e){const{offsetX:n,offsetY:i}=e,a=this._findNodeByCoord(n,i,{strict:!1,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage});if(a==null||a.node==null)return;const r=$i(a.node);if(r==null)return;const{content:c,st:l,nodeIndex:A}=r;if(A===-1||Intl.Segmenter==null)return;const u=new Intl.Segmenter(void 0,{granularity:"word"}).segment(c);let m=Number.NEGATIVE_INFINITY,h=Number.NEGATIVE_INFINITY;for(const{segment:g,index:p,isWordLike:f}of u)if(p<=A&&A<p+g.length&&f){m=p+l,h=p+l+g.length;break}if(Number.isFinite(m)&&Number.isFinite(h)){this.removeAllRanges();const g=[{startOffset:m,endOffset:h}];this.addDocRanges(g,!1,{forceFocus:!0})}}__handleTripleClick(e){const{offsetX:n,offsetY:i}=e,a=this._findNodeByCoord(n,i,{strict:!1,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage});if(a==null||a.node==null)return;const r=$i(a.node);if(r==null)return;this.removeAllRanges();const{st:c,ed:l}=r,A=[{startOffset:c,endOffset:l}];this.addDocRanges(A,!1,{forceFocus:!0})}__onPointDown(e){var f,S;const{scene:n,mainComponent:i}=this._context,a=this._docSkeletonManagerService.getSkeleton(),{offsetX:r,offsetY:c}=e,l=this._findNodeByCoord(r,c,{strict:!1,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage}),A=this._getNodePosition(l);if(A==null||l==null){this._removeAllRanges();return}(l==null?void 0:l.node.streamType)===s.DataStreamTreeTokenType.PARAGRAPH&&(A.isBack=!0);const d=this._textSelectionInner$.value;if(l&&e.button===2&&d){const E=a.findCharIndexByPosition(A);if(typeof E=="number"&&d.textRanges.some(C=>C.startOffset<=E&&C.endOffset>E)||typeof E=="number"&&d.rectRanges.some(C=>C.startOffset<=E&&C.endOffset>=E))return}const{segmentId:u,segmentPage:m}=l;u&&this._currentSegmentId&&u!==this._currentSegmentId&&this.setSegment(u),u&&m!==this._currentSegmentPage&&this.setSegmentPage(m),this._anchorNodePosition=A,e.shiftKey&&this._getActiveRangeInstance()?this._updateActiveRangePosition(A):e.ctrlKey?this._removeAllCollapsedTextRanges():this._isEmpty()||this._removeAllRanges(),n.disableObjectsEvent();const h=_.ScrollTimer.create(n);this._scrollTimers.push(h),h.startScroll(r,c),this._onSelectionStart$.next((f=this._getActiveRangeInstance())==null?void 0:f.startNodePosition),(S=n.getTransformer())==null||S.clearSelectedObjects();let g=r,p=c;this._onPointerEvent=!0,this._scenePointerMoveSubs.push(n.onPointerMove$.subscribeEvent(E=>{const{offsetX:C,offsetY:T}=E;n.setCursor(_.CURSOR_TYPE.TEXT),!(Math.sqrt((C-g)**2+(T-p)**2)<3)&&(this._moving(C,T),h.scrolling(C,T,()=>{this._moving(C,T)}),g=C,p=T)})),this._scenePointerUpSubs.push(n.onPointerUp$.subscribeEvent(()=>{if([...this._scenePointerMoveSubs,...this._scenePointerUpSubs].forEach(C=>{C.unsubscribe()}),this._onPointerEvent=!1,n.enableObjectsEvent(),this._anchorNodePosition&&!this._focusNodePosition){if(e.ctrlKey){this._disposeScrollTimers();return}const C=new We(n,i,a,this._anchorNodePosition,void 0,this._selectionStyle,this._currentSegmentId,this._currentSegmentPage);this._addTextRange(C)}else if(this._anchorNodePosition&&this._focusNodePosition){for(const C of this._rangeListCache)e.ctrlKey?C.collapsed?C.dispose():this._addTextRange(C):this._addTextRange(C);this._addRectRanges(this._rectRangeListCache),this._rangeListCache=[],this._rectRangeListCache=[]}this._anchorNodePosition=null,this._focusNodePosition=null;const E={textRanges:this._getAllTextRanges(),rectRanges:this._getAllRectRanges(),segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage,style:this._selectionStyle,isEditing:!1};this._textSelectionInner$.next(E),this._disposeScrollTimers(),this._updateInputPosition(!0)}))}removeAllRanges(){this._removeAllRanges(),this.deactivate()}getActiveTextRange(){return this._getActiveRangeInstance()}_disposeScrollTimers(){this._scrollTimers.forEach(e=>{e==null||e.dispose()}),this._scrollTimers=[]}_setSystemHighlightColorToStyle(){const{r:e,g:n,b:i,a}=_.getSystemHighlightColor(),r={strokeWidth:1,stroke:"rgba(0, 0, 0, 0)",strokeActive:"rgba(0, 0, 0, 1)",fill:`rgba(${e}, ${n}, ${i}, ${a!=null?a:.3})`};this._setRangeStyle(r)}_getAllTextRanges(){return this._rangeList.map(yo)}_getAllRectRanges(){return this._rectRangeList.map(lr)}getAllTextRanges(){return this._getAllTextRanges()}getAllRectRanges(){return this._getAllRectRanges()}_getActiveRange(){const e=this._rangeList.find(a=>a.isActive());if(e==null)return null;const{startOffset:n,endOffset:i}=e;return n==null||i==null?null:yo(e)}_getActiveRangeInstance(){return this._rangeList.find(e=>e.isActive())}dispose(){super.dispose(),this._detachEvent(),this._removeAllRanges(),this._container.remove()}_initDOM(){const{unitId:e}=this._context,n=document.createElement("div");n.style.position="fixed",n.style.left="0px",n.style.top="0px",n.id=`univer-doc-selection-container-${e}`;const i=document.createElement("div"),a=document.createElement("div");i.appendChild(a),n.appendChild(i),this._container=n,this._inputParent=i,this._input=a,this._initInput(),this._initInputEvents(),document.body.appendChild(n)}_registerContainer(){this.disposeWithMe(this._layoutService.registerContainerElement(this._container))}_initInput(){this._inputParent.style.cssText=`
            position:absolute;
            height:1px;
            width:1px;
            overflow: hidden;
        `,this._input.contentEditable="true",this._input.dataset.uComp="editor",this._input.id=`__editor_${this._context.unitId}`,this._input.style.cssText=`
            position: absolute;
            overflow: hidden;
            opacity: 1;
            background: #000;
            color: transparent;
            outline: none;
            z-index: -2;
            caret-color: transparent;
            white-space: pre-wrap;
            user-select: text;
        `}_getNodePosition(e){if(e==null)return;const{node:n,ratioX:i,segmentPage:a}=e,c=this._docSkeletonManagerService.getSkeleton().findPositionByGlyph(n,a);if(c==null)return;let A=i<.5;return n.glyphType===_.GlyphType.LIST&&(A=!0),{...c,isBack:A}}_interactTextRanges(e){const n=[];for(const i of this._rangeList){if(e.some(a=>a.isIntersection(i))){i.dispose();continue}n.push(i)}this._rangeList=n}_interactRectRanges(e){const n=[];for(const i of this._rectRangeList){if(e.some(a=>a.isIntersection(i))){i.dispose();continue}n.push(i)}this._rectRangeList=n}_removeAllRanges(){this._removeAllTextRanges(),this._removeAllRectRanges()}_removeAllCacheRanges(){this._rangeListCache.forEach(e=>{e.dispose()}),this._rectRangeListCache.forEach(e=>{e.dispose()}),this._rangeListCache=[],this._rectRangeListCache=[]}_removeAllTextRanges(){this._rangeList.forEach(e=>{e.dispose()}),this._rangeList=[]}_removeAllRectRanges(){this._rectRangeList.forEach(e=>{e.dispose()}),this._rectRangeList=[]}_removeAllCollapsedTextRanges(){for(const e of this._rangeList)e.collapsed&&e.dispose()}_deactivateAllTextRanges(){this._rangeList.forEach(e=>{e.deactivate()})}_deactivateAllRectRanges(){this._rectRangeList.forEach(e=>{e.deactivate()})}_addTextRangesToCache(e){this._rangeListCache.push(...e)}_addTextRange(e){this._deactivateAllTextRanges(),e.activate(),this._rangeList.push(e)}_addRectRangesToCache(e){this._rectRangeListCache.push(...e)}_addRectRanges(e){e.length!==0&&(this._deactivateAllRectRanges(),e[e.length-1].activate(),this._rectRangeList.push(...e))}_createTextRangeByAnchorPosition(e){this._removeAllRanges();const{scene:n,mainComponent:i}=this._context,a=this._docSkeletonManagerService.getSkeleton(),r=new We(n,i,a,e,void 0,this._selectionStyle,this._currentSegmentId,this._currentSegmentPage);this._addTextRange(r)}_updateActiveRangePosition(e){const n=this._getActiveRangeInstance();if(n==null||n.anchorNodePosition==null){this._logService.error("[DocSelectionRenderService] _updateActiveRangeFocusPosition: active range has no anchor");return}this._removeAllRanges(),this._anchorNodePosition=n.anchorNodePosition,this._focusNodePosition=e;const{scene:i,mainComponent:a}=this._context,r=this._docSkeletonManagerService.getSkeleton(),{_anchorNodePosition:c,_focusNodePosition:l,_selectionStyle:A,_currentSegmentId:d,_currentSegmentPage:u}=this;if(c==null||l==null||a==null)return;const m=To(c,l,i,a,r,A,d,u);if(m==null)return;const{textRanges:h,rectRanges:g}=m;this._addTextRangesToCache(h),this._addRectRangesToCache(g),this.deactivate()}_isEmpty(){return this._rangeList.length===0&&this._rectRangeList.length===0}_getCanvasOffset(){var n;const e=(n=this._context.scene)==null?void 0:n.getEngine();return Zi(e)}_updateInputPosition(e=!1){const n=this._getActiveRangeInstance(),i=n==null?void 0:n.getAnchor();if(!i||i&&!i.visible||this.activeViewPort==null){this.focus();return}const{left:a,top:r}=i,c=this.activeViewPort.getAbsoluteVector(_.Vector2.FromArray([a,r])),{x:l,y:A}=c;let{left:d,top:u}=this._getCanvasOffset();d+=l,u+=A,this.activate(d,u,e)}_moving(e,n){var E,C;const{_currentSegmentId:i,_currentSegmentPage:a}=this,r=this._findNodeByCoord(e,n,{strict:!0,segmentId:i,segmentPage:a}),c=this._getNodePosition(r);if(c==null||r==null)return;const l=r==null?void 0:r.node.parent,A=l==null?void 0:l.glyphGroup[l.glyphGroup.indexOf(r.node)+1];(r==null?void 0:r.node.streamType)===s.DataStreamTreeTokenType.PARAGRAPH&&(A==null?void 0:A.streamType)===s.DataStreamTreeTokenType.SECTION_BREAK&&(c.isBack=!0),this._focusNodePosition=c,this._removeAllCacheRanges();const{_anchorNodePosition:d,_selectionStyle:u}=this,{scene:m,mainComponent:h}=this._context,g=this._docSkeletonManagerService.getSkeleton();if(d==null||h==null)return;const p=To(d,c,m,h,g,u,i,a);if(p==null)return;const{textRanges:f,rectRanges:S}=p;this._rangeList.length>0&&f.length>0&&this._interactTextRanges(f),this._rectRangeList.length>0&&S.length>0&&this._interactRectRanges(S),this._addTextRangesToCache(f),this._addRectRangesToCache(S),this.deactivate(),(C=(E=this._context.scene)==null?void 0:E.getEngine())==null||C.setCapture()}__attachScrollEvent(){const e=this.activeViewPort;if(!e)return;const{unitId:n}=this._context;if(this._viewPortObserverMap.has(n))return;const i=e.onScrollAfter$.subscribeEvent(r=>{if(!r.viewport)return;const l=this._getActiveRangeInstance();l==null||l.activeStatic()}),a=e.onScrollEnd$.subscribeEvent(r=>{const c=r.viewport;if(!c)return;const l=c.getBounding(),A=this._getActiveRangeInstance(),d=A==null?void 0:A.getAnchor();if(!(!d||d&&!d.visible)){if(l){const{left:u,top:m,right:h,bottom:g}=l.viewBound;if(d.left<u||d.left>h||d.top<m||d.top>g){A==null||A.deactivateStatic();return}}this._updateInputPosition()}});this._viewPortObserverMap.set(n,{scrollBefore:i,scrollStop:a})}_initInputEvents(){this.disposeWithMe(L.fromEvent(this._input,"keydown").subscribe(e=>{this._isIMEInputApply||this._eventHandle(e,n=>{this._onKeydown$.next(n)})})),this.disposeWithMe(L.fromEvent(this._input,"input").subscribe(e=>{if(!(e.inputType==="historyUndo"||e.inputType==="historyRedo")){if(this._rectRangeList.length>0)return e.stopPropagation(),e.preventDefault();this._isIMEInputApply||this._eventHandle(e,n=>{this._onInputBefore$.next(n),this._onInput$.next(n)})}})),this.disposeWithMe(L.fromEvent(this._input,"compositionstart").subscribe(e=>{if(this._rectRangeList.length>0)return e.stopPropagation(),e.preventDefault();this._isIMEInputApply=!0,this._eventHandle(e,n=>{this._onCompositionstart$.next(n)})})),this.disposeWithMe(L.fromEvent(this._input,"compositionend").subscribe(e=>{this._isIMEInputApply=!1,this._eventHandle(e,n=>{this._onCompositionend$.next(n)})})),this.disposeWithMe(L.fromEvent(this._input,"compositionupdate").subscribe(e=>{this._eventHandle(e,n=>{this._onInputBefore$.next(n),this._onCompositionupdate$.next(n)})})),this.disposeWithMe(L.fromEvent(this._input,"paste").subscribe(e=>{this._eventHandle(e,n=>{this._onPaste$.next(n)})})),this.disposeWithMe(L.fromEvent(this._input,"focus").subscribe(e=>{this._eventHandle(e,n=>{this._onFocus$.next(n)})})),this.disposeWithMe(L.fromEvent(this._input,"blur").subscribe(e=>{this._eventHandle(e,n=>{this._onBlur$.next(n)})}))}_eventHandle(e,n){const i=this._input.textContent||"";this._input.innerHTML="";const a=this._getActiveRange(),r=this._getAllTextRanges();n({event:e,content:i,activeRange:a,rangeList:r})}_getTransformCoordForDocumentOffset(e,n){const i=this._context.mainComponent,{documentTransform:a}=i.getOffsetConfig();if(this.activeViewPort==null||a==null)return;const r=this.activeViewPort.transformVector2SceneCoord(_.Vector2.FromArray([e,n]));if(r)return a.clone().invert().applyPoint(r)}_findNodeByCoord(e,n,i){const a=this._getTransformCoordForDocumentOffset(e,n);if(a==null)return;const r=this._context.mainComponent,c=this._docSkeletonManagerService.getSkeleton(),{pageLayoutType:l=_.PageLayoutType.VERTICAL,pageMarginLeft:A,pageMarginTop:d}=r.getOffsetConfig();return c.findNodeByCoord(a,l,A,d,i)}_detachEvent(){this._onInputBefore$.complete(),this._onKeydown$.complete(),this._onInput$.complete(),this._onCompositionstart$.complete(),this._onCompositionupdate$.complete(),this._onCompositionend$.complete(),this._onSelectionStart$.complete(),this._textSelectionInner$.complete(),this._onPaste$.complete(),this._onFocus$.complete(),this._onBlur$.complete(),this._onPointerDown$.complete()}},y.DocSelectionRenderService=Ar([tn(1,I.ILayoutService),tn(2,s.ILogService),tn(3,s.IUniverInstanceService),tn(4,s.Inject(D.DocSkeletonManagerService))],y.DocSelectionRenderService);const Rt={id:"doc.command.switch-mode",type:s.CommandType.COMMAND,handler:o=>{var E,C,T,R,v;const t=o.get(s.ICommandService),e=o.get(_.IRenderManagerService),n=o.get(D.DocSelectionManagerService),a=o.get(s.IUniverInstanceService).getCurrentUniverDocInstance();if(a==null)return!1;const r=a.getUnitId(),c=(E=e.getRenderById(r))==null?void 0:E.with(D.DocSkeletonManagerService).getSkeleton(),l=(C=e.getRenderById(r))==null?void 0:C.with(y.DocSelectionRenderService);if(c==null||l==null)return!1;const A=l==null?void 0:l.getSegment(),d=l==null?void 0:l.getSegmentPage(),u=a.getSnapshot().documentStyle.documentFlavor,m=n.getDocRanges(),h={id:D.RichTextEditingMutation.id,params:{unitId:r,actions:[],textRanges:u===s.DocumentFlavor.TRADITIONAL&&A?[]:m}},g=s.JSONX.getInstance(),p=[];let f;if(u===void 0?f=g.insertOp(["documentStyle","documentFlavor"],s.DocumentFlavor.MODERN):u===s.DocumentFlavor.MODERN?f=g.replaceOp(["documentStyle","documentFlavor"],u,s.DocumentFlavor.TRADITIONAL):f=g.replaceOp(["documentStyle","documentFlavor"],u,s.DocumentFlavor.MODERN),f)p.push(f);else return!1;if(u!==s.DocumentFlavor.MODERN){const O=a.getSnapshot(),{drawings:M={},body:b}=O,N=(T=b==null?void 0:b.customBlocks)!=null?T:[];for(const x in M){const w=M[x],F=N.find($=>$.blockId===x);if(F==null)continue;const V=w.docTransform.positionV,{relativeFrom:H,posOffset:Q}=V;if(H===s.ObjectRelativeFromV.PARAGRAPH)continue;const{startIndex:j}=F,X=c.findNodeByCharIndex(j,A,d),k=(R=X==null?void 0:X.parent)==null?void 0:R.parent,W=k==null?void 0:k.parent,G=W==null?void 0:W.lines.find($=>$.paragraphIndex===(k==null?void 0:k.paragraphIndex)&&$.paragraphStart),K=(v=W==null?void 0:W.parent)==null?void 0:v.parent;if(X==null||k==null||G==null||W==null||K==null)continue;let Y=0;H===s.ObjectRelativeFromV.LINE?Y-=k.top:H===s.ObjectRelativeFromV.PAGE&&(Y+=K.marginTop),Y+=G.top;const q={...V,relativeFrom:s.ObjectRelativeFromV.PARAGRAPH,posOffset:(Q!=null?Q:0)-Y},z=g.replaceOp(["drawings",x,"docTransform","positionV"],V,q);z&&p.push(z)}}return h.params.actions=p.reduce((O,M)=>s.JSONX.compose(O,M),null),!!t.syncExecuteCommand(h.id,h.params)}},bo={id:"doc.command.create-table",type:s.CommandType.COMMAND,handler:async(o,t)=>{var q,z,$,ie,fe;const{rowCount:e,colCount:n}=t,i=o.get(D.DocSelectionManagerService),a=o.get(s.IUniverInstanceService),r=o.get(s.ICommandService),c=o.get(ve),l=i.getActiveTextRange();if(l==null)return!1;const{segmentId:A,segmentPage:d}=l,u=a.getCurrentUniverDocInstance(),m=u==null?void 0:u.getSelfOrHeaderFooterModel(A).getBody();if(u==null||m==null)return!1;const h=u.getUnitId(),g=re(o,h),p=g==null?void 0:g.getSkeleton();if(p==null)return!1;const{startOffset:f}=l,E=((q=m.paragraphs)!=null?q:[]).find(He=>He.startIndex>=f),C=p.findNodeByCharIndex(f,A,d);if(C==null)return!1;const T=new s.TextX,R=s.JSONX.getInstance(),v=[],O=f+4,M=[{startOffset:O,endOffset:O,collapsed:!0}],b={id:D.RichTextEditingMutation.id,params:{unitId:h,actions:[],textRanges:M}};f>0&&T.push({t:s.TextXActionType.RETAIN,len:f}),T.push({t:s.TextXActionType.INSERT,body:{dataStream:s.DataStreamTreeTokenType.PARAGRAPH,paragraphs:Nn(s.DataStreamTreeTokenType.PARAGRAPH,E)},len:1});const N=c.getDefaultStyle(),x=c.getStyleCache(),w=wt(m,f,N,x),{dataStream:F,paragraphs:V,sectionBreaks:H}=Oa(e,n),Q=(fe=(ie=($=(z=C.parent)==null?void 0:z.parent)==null?void 0:$.parent)==null?void 0:ie.parent)==null?void 0:fe.parent;if(Q==null)return!1;const{pageWidth:j,marginLeft:X,marginRight:k}=Q,W=Un(e,n,j-X-k);T.push({t:s.TextXActionType.INSERT,body:{dataStream:F,paragraphs:V,sectionBreaks:H,textRuns:[{...w,st:0,ed:F.length}],tables:[{startIndex:0,endIndex:F.length,tableId:W.tableId}]},len:F.length});const G=Z(u,A);v.push(R.editOp(T.serialize(),G));const K=R.insertOp(["tableSource",W.tableId],W);return v.push(K),b.params.actions=v.reduce((He,Se)=>s.JSONX.compose(He,Se),null),!!r.syncExecuteCommand(b.id,b.params)}},nn={id:"doc.table.delete-rows",type:s.CommandType.COMMAND,handler:async o=>{const t=o.get(D.DocSelectionManagerService),e=o.get(s.IUniverInstanceService),n=o.get(s.ICommandService),i=t.getRectRanges(),a=t.getActiveTextRange(),r=At(a,i);if(r==null)return!1;const{segmentId:c}=r,l=e.getCurrentUniverDocInstance(),A=l==null?void 0:l.getSelfOrHeaderFooterModel(c).getBody();if(l==null||A==null)return!1;const d=re(o,l.getUnitId());if(d==null)return!1;const u=d.getViewModel(),m=l==null?void 0:l.getUnitId(),h=new s.TextX,g=s.JSONX.getInstance(),p=di(r,u);if(p==null)return!1;const{offset:f,rowIndexes:S,len:E,tableId:C,cursor:T,selectWholeTable:R}=p;if(R)return n.executeCommand(it.id);const v=[],O=[{startOffset:T,endOffset:T,collapsed:!0}],M={id:D.RichTextEditingMutation.id,params:{unitId:m,actions:[],textRanges:O}};f>0&&h.push({t:s.TextXActionType.RETAIN,len:f}),h.push({t:s.TextXActionType.DELETE,len:E});const b=Z(l,c);v.push(g.editOp(h.serialize(),b));for(const x of S.reverse()){const w=g.removeOp(["tableSource",C,"tableRows",x]);v.push(w)}return M.params.actions=v.reduce((x,w)=>s.JSONX.compose(x,w),null),!!n.syncExecuteCommand(M.id,M.params)}},on={id:"doc.table.delete-columns",type:s.CommandType.COMMAND,handler:async o=>{const t=o.get(D.DocSelectionManagerService),e=o.get(s.IUniverInstanceService),n=o.get(s.ICommandService),i=t.getRectRanges(),a=t.getActiveTextRange(),r=At(a,i);if(r==null)return!1;const{segmentId:c}=r,l=e.getCurrentUniverDocInstance(),A=l==null?void 0:l.getSelfOrHeaderFooterModel(c).getBody();if(l==null||A==null)return!1;const d=re(o,l.getUnitId());if(d==null)return!1;const u=d.getViewModel(),m=l==null?void 0:l.getUnitId(),h=new s.TextX,g=s.JSONX.getInstance(),p=_a(r,u);if(p==null)return!1;const{offsets:f,columnIndexes:S,tableId:E,cursor:C,rowCount:T,selectWholeTable:R}=p;if(R)return n.executeCommand(it.id);const v=[],O=[{startOffset:C,endOffset:C,collapsed:!0}],M={id:D.RichTextEditingMutation.id,params:{unitId:m,actions:[],textRanges:O}};for(const x of f){const{retain:w,delete:F}=x;w>0&&h.push({t:s.TextXActionType.RETAIN,len:w}),h.push({t:s.TextXActionType.DELETE,len:F})}const b=Z(l,c);v.push(g.editOp(h.serialize(),b)),S.reverse();for(let x=0;x<T;x++)for(const w of S){const F=g.removeOp(["tableSource",E,"tableRows",x,"tableCells",w]);v.push(F)}for(const x of S){const w=g.removeOp(["tableSource",E,"tableColumns",x]);v.push(w)}return M.params.actions=v.reduce((x,w)=>s.JSONX.compose(x,w),null),!!n.syncExecuteCommand(M.id,M.params)}},it={id:"doc.table.delete-table",type:s.CommandType.COMMAND,handler:async o=>{const t=o.get(D.DocSelectionManagerService),e=o.get(s.IUniverInstanceService),n=o.get(s.ICommandService),i=t.getRectRanges(),a=t.getActiveTextRange(),r=At(a,i);if(r==null)return!1;const{segmentId:c}=r,l=e.getCurrentUniverDocInstance(),A=l==null?void 0:l.getSelfOrHeaderFooterModel(c).getBody();if(l==null||A==null)return!1;const d=re(o,l.getUnitId());if(d==null)return!1;const u=d.getViewModel(),m=l==null?void 0:l.getUnitId(),h=new s.TextX,g=s.JSONX.getInstance(),p=Ai(r,u);if(p==null)return!1;const{offset:f,len:S,tableId:E,cursor:C}=p,T=[],R=[{startOffset:C,endOffset:C,collapsed:!0}],v={id:D.RichTextEditingMutation.id,params:{unitId:m,actions:[],textRanges:R}};f>0&&h.push({t:s.TextXActionType.RETAIN,len:f}),h.push({t:s.TextXActionType.DELETE,len:S});const O=Z(l,c);T.push(g.editOp(h.serialize(),O));const M=g.removeOp(["tableSource",E]);return T.push(M),v.params.actions=T.reduce((N,x)=>s.JSONX.compose(N,x),null),!!n.syncExecuteCommand(v.id,v.params)}},Oo="doc.command.table-insert-row",Ro="doc.command.table-insert-column",ur="doc.command.table-insert-row-above",hr="doc.command.table-insert-row-bellow",gr="doc.command.table-insert-column-left",mr="doc.command.table-insert-column-right",sn={id:ur,type:s.CommandType.COMMAND,handler:async o=>o.get(s.ICommandService).executeCommand(Oo,{position:Ft.ABOVE})},an={id:hr,type:s.CommandType.COMMAND,handler:async o=>o.get(s.ICommandService).executeCommand(Oo,{position:Ft.BELLOW})},rn={id:gr,type:s.CommandType.COMMAND,handler:async o=>o.get(s.ICommandService).executeCommand(Ro,{position:Pn.LEFT})},cn={id:mr,type:s.CommandType.COMMAND,handler:async o=>o.get(s.ICommandService).executeCommand(Ro,{position:Pn.RIGHT})},Mo={id:Oo,type:s.CommandType.COMMAND,handler:async(o,t)=>{const{position:e}=t,n=o.get(D.DocSelectionManagerService),i=o.get(s.IUniverInstanceService),a=o.get(s.ICommandService),r=n.getRectRanges(),c=n.getActiveTextRange(),l=At(c,r);if(l==null)return!1;const{segmentId:A}=l,d=i.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),u=d==null?void 0:d.getSelfOrHeaderFooterModel(A).getBody();if(d==null||u==null)return!1;const m=re(o,d.getUnitId());if(m==null)return!1;const h=m.getViewModel(),g=d==null?void 0:d.getUnitId(),p=new s.TextX,f=s.JSONX.getInstance(),S=xa(l,e,h);if(S==null)return!1;const{offset:E,colCount:C,tableId:T,insertRowIndex:R}=S,v=[],O=E+2,M=[{startOffset:O,endOffset:O,collapsed:!0}],b={id:D.RichTextEditingMutation.id,params:{unitId:g,actions:[],textRanges:M}};E>0&&p.push({t:s.TextXActionType.RETAIN,len:E});const N=Ra(C);p.push({t:s.TextXActionType.INSERT,body:N,len:N.dataStream.length});const x=Z(d,A);v.push(f.editOp(p.serialize(),x));const w=kt(C),F=f.insertOp(["tableSource",T,"tableRows",R],w);return v.push(F),b.params.actions=v.reduce((H,Q)=>s.JSONX.compose(H,Q),null),!!a.syncExecuteCommand(b.id,b.params)}},es={id:Ro,type:s.CommandType.COMMAND,handler:async(o,t)=>{var K,Y,q;const{position:e}=t,n=o.get(D.DocSelectionManagerService),i=o.get(s.IUniverInstanceService),a=o.get(s.ICommandService),r=n.getRectRanges(),c=n.getActiveTextRange(),l=At(c,r);if(l==null)return!1;const{segmentId:A}=l,d=i.getCurrentUniverDocInstance(),u=d==null?void 0:d.getSelfOrHeaderFooterModel(A).getBody();if(d==null||u==null)return!1;const m=re(o,d.getUnitId());if(m==null)return!1;const h=m.getViewModel(),g=d==null?void 0:d.getUnitId(),p=new s.TextX,f=s.JSONX.getInstance(),S=Da(l,e,h);if(S==null)return!1;const{offsets:E,columnIndex:C,tableId:T,rowCount:R}=S,v=[],O=E[0]+1,M=[{startOffset:O,endOffset:O,collapsed:!0}],b={id:D.RichTextEditingMutation.id,params:{unitId:g,actions:[],textRanges:M}};for(const z of E){p.push({t:s.TextXActionType.RETAIN,len:z});const $=Ma();p.push({t:s.TextXActionType.INSERT,body:$,len:$.dataStream.length})}const N=Z(d,A);v.push(f.editOp(p.serialize(),N));for(let z=0;z<R;z++){const $=Ht(),ie=f.insertOp(["tableSource",T,"tableRows",z,"tableCells",C],$);v.push(ie)}const x=d.getSnapshot(),w=x.documentStyle,{marginLeft:F=0,marginRight:V=0}=w,H=((Y=(K=w.pageSize)==null?void 0:K.width)!=null?Y:800)-F-V,Q=(q=x==null?void 0:x.tableSource)==null?void 0:q[T].tableColumns,{newColWidth:j,widths:X}=Ba(H,Q,C);for(let z=0;z<X.length;z++){const $=f.replaceOp(["tableSource",T,"tableColumns",z,"size","width","v"],Q[z].size.width.v,X[z]);v.push($)}const k=Vt(j),W=f.insertOp(["tableSource",T,"tableColumns",C],k);return v.push(W),b.params.actions=v.reduce((z,$)=>s.JSONX.compose(z,$),null),!!a.syncExecuteCommand(b.id,b.params)}},xo={id:"doc.table.tab-in-table",type:s.CommandType.COMMAND,handler:async(o,t)=>{var g;const{shift:e}=t,n=o.get(D.DocSelectionManagerService),i=n.getDocRanges(),a=o.get(s.ICommandService),c=o.get(s.IUniverInstanceService).getCurrentUniverDocInstance();if(!c)return!1;const l=(g=i.find(p=>p.isActive))!=null?g:i[0],A=c.getUnitId(),d=re(o,A),u=d==null?void 0:d.getSkeleton(),m=u==null?void 0:u.getViewModel().getSelfOrHeaderFooterViewModel(l==null?void 0:l.segmentId);if(m==null||l==null)return!1;let h=null;if(e?h=ui(m,l,wn.PREV):h=ui(m,l,wn.NEXT),h){const{startOffset:p,endOffset:f}=h,S=[{startOffset:p,endOffset:f}];return n.replaceDocRanges(S),!0}return e===!1?await a.executeCommand(Mo.id,{position:Ft.BELLOW}):!0}},ts="COMPONENT_DOC_CREATE_TABLE_CONFIRM",Do="doc.component.create-table-confirm",ln={id:"doc.operation.create-table",type:s.CommandType.COMMAND,handler:async o=>{const t=o.get(s.LocaleService),e=o.get(I.IConfirmService),n=o.get(s.ICommandService),i={rowCount:3,colCount:5},a=(r,c)=>{i.rowCount=r,i.colCount=c};return await e.open({id:Do,children:{label:{name:ts,props:{handleRowColChange:a,tableCreateParams:i}}},width:"auto",title:{title:t.t("toolbar.table.insert")},onConfirm:()=>{n.executeCommand(bo.id,i),e.close(Do)},onClose:()=>{e.close(Do)}}),!0}},Oe={id:"doc.operation.move-cursor",type:s.CommandType.OPERATION,handler:(o,t)=>!!t},Re={id:"doc.operation.move-selection",type:s.CommandType.OPERATION,handler:(o,t)=>!!t};function ne({ref:o,...t}){const{icon:e,id:n,className:i,extend:a,...r}=t,c=`univerjs-icon univerjs-icon-${n} ${i||""}`.trim(),l=U.useRef(`_${Sr()}`);return ns(e,`${n}`,{defIds:e.defIds,idSuffix:l.current},{ref:o,className:c,...r},a)}function ns(o,t,e,n,i){return U.createElement(o.tag,{key:t,...pr(o,e,i),...n},(fr(o,e).children||[]).map((a,r)=>ns(a,`${t}-${o.tag}-${r}`,e,void 0,i)))}function pr(o,t,e){const n={...o.attrs};e!=null&&e.colorChannel1&&n.fill==="colorChannel1"&&(n.fill=e.colorChannel1),o.tag==="mask"&&n.id&&(n.id=n.id+t.idSuffix),Object.entries(n).forEach(([a,r])=>{a==="mask"&&typeof r=="string"&&(n[a]=r.replace(/url\(#(.*)\)/,`url(#$1${t.idSuffix})`))});const{defIds:i}=t;return!i||i.length===0||(o.tag==="use"&&n["xlink:href"]&&(n["xlink:href"]=n["xlink:href"]+t.idSuffix),Object.entries(n).forEach(([a,r])=>{typeof r=="string"&&(n[a]=r.replace(/url\(#(.*)\)/,`url(#$1${t.idSuffix})`))})),n}function fr(o,t){var n;const{defIds:e}=t;return!e||e.length===0?o:o.tag==="defs"&&((n=o.children)!=null&&n.length)?{...o,children:o.children.map(i=>typeof i.attrs.id=="string"&&e&&e.includes(i.attrs.id)?{...i,attrs:{...i.attrs,id:i.attrs.id+t.idSuffix}}:i)}:o}function Sr(){return Math.random().toString(36).substring(2,8)}ne.displayName="UniverIcon";const Ir={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 5.56641C1.66853 5.56641 1.3999 5.83504 1.3999 6.16641C1.3999 6.49778 1.66853 6.76641 1.9999 6.76641H13.9999C14.3313 6.76641 14.5999 6.49778 14.5999 6.16641C14.5999 5.83504 14.3313 5.56641 13.9999 5.56641H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 12.9004C1.66853 12.9004 1.3999 13.169 1.3999 13.5004C1.3999 13.8318 1.66853 14.1004 1.9999 14.1004H13.9999C14.3313 14.1004 14.5999 13.8318 14.5999 13.5004C14.5999 13.169 14.3313 12.9004 13.9999 12.9004H1.9999Z"}}]},os=U.forwardRef(function(t,e){return U.createElement(ne,Object.assign({},t,{id:"align-text-both-icon",ref:e,icon:Ir}))});os.displayName="AlignTextBothIcon";const vr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9834 3.98332C1.9834 3.61513 2.28188 3.31665 2.65007 3.31665H13.3167C13.6849 3.31665 13.9834 3.61513 13.9834 3.98332C13.9834 4.35151 13.6849 4.64998 13.3167 4.64998H2.65007C2.28188 4.64998 1.9834 4.35151 1.9834 3.98332Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9834 7.98267C1.9834 7.61448 2.28188 7.316 2.65007 7.316H10.6501C11.0183 7.316 11.3167 7.61448 11.3167 7.98267C11.3167 8.35086 11.0183 8.64933 10.6501 8.64933H2.65007C2.28188 8.64933 1.9834 8.35086 1.9834 7.98267Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.65007 11.316C2.28188 11.316 1.9834 11.6145 1.9834 11.9827C1.9834 12.3509 2.28188 12.6493 2.65007 12.6493H7.9834C8.35159 12.6493 8.65006 12.3509 8.65006 11.9827C8.65006 11.6145 8.35159 11.316 7.9834 11.316H2.65007Z"}}]},is=U.forwardRef(function(t,e){return U.createElement(ne,Object.assign({},t,{id:"catalogue-icon",ref:e,icon:vr}))});is.displayName="CatalogueIcon";const Er={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.3313 1.4667C5.3313 1.13533 5.59993 0.866699 5.9313 0.866699H10.069C10.4004 0.866699 10.669 1.13533 10.669 1.4667C10.669 1.79807 10.4004 2.0667 10.069 2.0667H5.9313C5.59993 2.0667 5.3313 1.79807 5.3313 1.4667Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.09985 3.64443C1.09985 3.31306 1.36848 3.04443 1.69985 3.04443H14.2999C14.6312 3.04443 14.8999 3.31306 14.8999 3.64443C14.8999 3.9758 14.6312 4.24443 14.2999 4.24443H1.69985C1.36848 4.24443 1.09985 3.9758 1.09985 3.64443Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M6.12398 8.30171C6.35829 8.0674 6.73819 8.0674 6.97251 8.30171L8.00007 9.32928L9.02764 8.30171C9.26195 8.0674 9.64185 8.0674 9.87617 8.30171C10.1105 8.53603 10.1105 8.91593 9.87617 9.15024L8.8486 10.1778L9.87617 11.2054C10.1105 11.4397 10.1105 11.8196 9.87617 12.0539C9.64185 12.2882 9.26195 12.2882 9.02764 12.0539L8.00007 11.0263L6.97251 12.0539C6.73819 12.2882 6.35829 12.2882 6.12398 12.0539C5.88966 11.8196 5.88966 11.4397 6.12398 11.2054L7.15154 10.1778L6.12398 9.15024C5.88966 8.91593 5.88966 8.53603 6.12398 8.30171Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.75332 5.22217C3.86966 5.22217 3.15332 5.93851 3.15332 6.82217V12.5331C3.15332 13.9691 4.31738 15.1332 5.75332 15.1332H10.2465C11.6825 15.1332 12.8465 13.9691 12.8465 12.5331V6.82217C12.8465 5.93851 12.1302 5.22217 11.2465 5.22217H4.75332ZM4.35332 6.82217C4.35332 6.60125 4.53241 6.42217 4.75332 6.42217H11.2465C11.4674 6.42217 11.6465 6.60125 11.6465 6.82217V12.5331C11.6465 13.3063 11.0197 13.9332 10.2465 13.9332H5.75332C4.98012 13.9332 4.35332 13.3063 4.35332 12.5331V6.82217Z",fillRule:"evenodd",clipRule:"evenodd"}}]},ss=U.forwardRef(function(t,e){return U.createElement(ne,Object.assign({},t,{id:"delete-icon",ref:e,icon:Er}))});ss.displayName="DeleteIcon";const Cr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M10.9913 10.8779C11.4971 10.8779 11.9073 11.2882 11.9073 11.7939C11.9073 12.2997 11.4971 12.71 10.9913 12.71C10.4857 12.7099 10.0754 12.2996 10.0753 11.7939C10.0753 11.2882 10.4857 10.878 10.9913 10.8779Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M11.9572 8.51465C12.5471 8.51471 13.0936 8.82742 13.3927 9.33594L14.3419 10.9502C14.6291 11.4386 14.6479 12.037 14.3966 12.5391L14.3419 12.6377L13.3927 14.252C13.0936 14.7605 12.5471 15.0732 11.9572 15.0732H10.0255C9.50941 15.0731 9.02688 14.8339 8.71399 14.4336L8.59094 14.252L7.64075 12.6377C7.33466 12.1169 7.33466 11.471 7.64075 10.9502L8.59094 9.33594L8.71399 9.1543C9.02688 8.75387 9.50935 8.51477 10.0255 8.51465H11.9572ZM10.0255 9.84473C9.93678 9.84483 9.85287 9.87988 9.79114 9.94043L9.73743 10.0098L8.78723 11.624C8.72565 11.7288 8.72564 11.8591 8.78723 11.9639L9.73743 13.5781L9.79114 13.6475C9.85286 13.7079 9.93684 13.7431 10.0255 13.7432H11.9572C12.0757 13.7431 12.186 13.6803 12.2462 13.5781L13.1954 11.9639L13.2306 11.8809C13.2536 11.7953 13.2415 11.7025 13.1954 11.624L12.2462 10.0098C12.186 9.90756 12.0758 9.84479 11.9572 9.84473H10.0255Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.5031 0.926758C11.9748 0.926758 13.1679 2.12013 13.1681 3.5918V6.41602C13.1679 6.78314 12.8702 7.08105 12.5031 7.08105C12.1361 7.08084 11.8382 6.783 11.838 6.41602V3.5918C11.8378 2.85467 11.2402 2.25684 10.5031 2.25684H4.0929C3.35572 2.25684 2.75813 2.85467 2.75793 3.5918V12.085C2.75818 12.8221 3.35574 13.4199 4.0929 13.4199H6.18958L6.32434 13.4326C6.62712 13.4947 6.85444 13.7639 6.85461 14.085C6.8544 14.406 6.62705 14.6742 6.32434 14.7363L6.18958 14.75H4.0929C2.62121 14.75 1.4281 13.5566 1.42786 12.085V3.5918C1.42806 2.12013 2.62118 0.926758 4.0929 0.926758H10.5031Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M8.04993 6.42969C8.35293 6.49172 8.58118 6.75971 8.58118 7.08105C8.581 7.40229 8.35289 7.67047 8.04993 7.73242L7.91614 7.74609H4.73547C4.36833 7.74609 4.07063 7.44816 4.07043 7.08105C4.07043 6.71379 4.3682 6.41602 4.73547 6.41602H7.91614L8.04993 6.42969Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.1007 3.92188C10.4034 3.98418 10.631 4.25215 10.631 4.57324C10.6309 4.8943 10.4033 5.16233 10.1007 5.22461L9.96594 5.23828H4.73547C4.36824 5.23828 4.0705 4.94046 4.07043 4.57324C4.07043 4.20597 4.3682 3.9082 4.73547 3.9082H9.96594L10.1007 3.92188Z"}}]},as=U.forwardRef(function(t,e){return U.createElement(ne,Object.assign({},t,{id:"doc-setting-icon",ref:e,icon:Cr}))});as.displayName="DocSettingIcon";const Tr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 20",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M10.5547 14.1884C10.2599 14.5214 9.74019 14.5214 9.4454 14.1884L3.71321 7.71335C3.29002 7.23532 3.6294 6.48161 4.26784 6.48161L15.7322 6.48161C16.3707 6.48161 16.7101 7.23532 16.2869 7.71335L10.5547 14.1884Z"}}]},rs=U.forwardRef(function(t,e){return U.createElement(ne,Object.assign({},t,{id:"down-icon",ref:e,icon:Tr}))});rs.displayName="DownIcon";const yr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.0999 2.66689C3.0999 2.33552 2.83127 2.06689 2.4999 2.06689C2.16853 2.06689 1.8999 2.33552 1.8999 2.66689V13.3336C1.8999 13.6649 2.16853 13.9336 2.4999 13.9336C2.83127 13.9336 3.0999 13.6649 3.0999 13.3336V8.5999H8.2334V13.3336C8.2334 13.6649 8.50203 13.9336 8.8334 13.9336C9.16477 13.9336 9.4334 13.6649 9.4334 13.3336V2.66689C9.4334 2.33552 9.16477 2.06689 8.8334 2.06689C8.50203 2.06689 8.2334 2.33552 8.2334 2.66689V7.3999H3.0999V2.66689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M14.0999 6.33879C14.0999 6.09377 13.9509 5.87336 13.7236 5.78203C13.4962 5.6907 13.2362 5.74679 13.0667 5.92373L11.4753 7.58486C11.2461 7.82415 11.2542 8.20396 11.4935 8.43319C11.7328 8.66243 12.1126 8.65427 12.3419 8.41499L12.8999 7.83245V13.3333C12.8999 13.6646 13.1686 13.9333 13.4999 13.9333C13.8313 13.9333 14.0999 13.6646 14.0999 13.3333V6.33879Z"}}]},cs=U.forwardRef(function(t,e){return U.createElement(ne,Object.assign({},t,{id:"h1-icon",ref:e,icon:yr}))});cs.displayName="H1Icon";const br={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.5999 2.66689C2.5999 2.33552 2.33127 2.06689 1.9999 2.06689C1.66853 2.06689 1.3999 2.33552 1.3999 2.66689V13.3336C1.3999 13.6649 1.66853 13.9336 1.9999 13.9336C2.33127 13.9336 2.5999 13.6649 2.5999 13.3336V8.5999H7.3999V13.3336C7.3999 13.6649 7.66853 13.9336 7.9999 13.9336C8.33127 13.9336 8.5999 13.6649 8.5999 13.3336V2.66689C8.5999 2.33552 8.33127 2.06689 7.9999 2.06689C7.66853 2.06689 7.3999 2.33552 7.3999 2.66689V7.3999H2.5999V2.66689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M11.2667 8.33356C11.2667 7.67245 11.8201 7.26689 12.3333 7.26689C12.8465 7.26689 13.4 7.67244 13.4 8.33356C13.4 8.62807 13.2712 8.94814 12.9954 9.32391C12.7183 9.70153 12.3394 10.0744 11.9174 10.4803L11.8355 10.559C11.4524 10.9268 11.0365 11.3263 10.7149 11.7373C10.3718 12.1759 10.0667 12.7122 10.0667 13.3336C10.0667 13.6649 10.3353 13.9336 10.6667 13.9336H14C14.3314 13.9336 14.6 13.6649 14.6 13.3336C14.6 13.0022 14.3314 12.7336 14 12.7336H11.4782C11.5286 12.6531 11.5889 12.5676 11.6601 12.4767C11.9269 12.1355 12.2843 11.792 12.6877 11.4043L12.7492 11.3452C13.1606 10.9496 13.615 10.5079 13.9629 10.0338C14.3122 9.55787 14.6 8.98906 14.6 8.33356C14.6 6.88362 13.3757 6.06689 12.3333 6.06689C11.291 6.06689 10.0667 6.88361 10.0667 8.33356C10.0667 8.66493 10.3353 8.93356 10.6667 8.93356C10.998 8.93356 11.2667 8.66493 11.2667 8.33356Z"}}]},ls=U.forwardRef(function(t,e){return U.createElement(ne,Object.assign({},t,{id:"h2-icon",ref:e,icon:br}))});ls.displayName="H2Icon";const Or={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.5999 2.66689C2.5999 2.33552 2.33127 2.06689 1.9999 2.06689C1.66853 2.06689 1.3999 2.33552 1.3999 2.66689V13.3336C1.3999 13.6649 1.66853 13.9336 1.9999 13.9336C2.33127 13.9336 2.5999 13.6649 2.5999 13.3336V8.5999H7.3999V13.3336C7.3999 13.6649 7.66853 13.9336 7.9999 13.9336C8.33127 13.9336 8.5999 13.6649 8.5999 13.3336V2.66689C8.5999 2.33552 8.33127 2.06689 7.9999 2.06689C7.66853 2.06689 7.3999 2.33552 7.3999 2.66689V7.3999H2.5999V2.66689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.6667 6.06689C10.3353 6.06689 10.0667 6.33552 10.0667 6.66689C10.0667 6.99827 10.3353 7.26689 10.6667 7.26689H12.7732L11.193 9.29853C11.0524 9.47942 11.027 9.72465 11.1277 9.93051C11.2283 10.1364 11.4375 10.2669 11.6667 10.2669C12.2418 10.2669 12.6786 10.4115 12.9585 10.6354C13.2204 10.845 13.4 11.166 13.4 11.6669C13.4 12.1622 13.2254 12.3937 13.0567 12.5202C12.8588 12.6686 12.5829 12.7336 12.3333 12.7336C11.7271 12.7336 11.3432 12.4858 11.1106 12.23C10.8877 11.9848 10.5082 11.9667 10.2631 12.1896C10.0179 12.4125 9.99979 12.792 10.2227 13.0372C10.6568 13.5147 11.3522 13.9336 12.3333 13.9336C12.7504 13.9336 13.3078 13.8319 13.7767 13.4802C14.2746 13.1068 14.6 12.5049 14.6 11.6669C14.6 10.8345 14.2796 10.1555 13.7081 9.69837C13.4342 9.47923 13.117 9.32231 12.7746 9.21971L14.4736 7.03526C14.6143 6.85437 14.6397 6.60914 14.539 6.40328C14.4383 6.19743 14.2291 6.06689 14 6.06689H10.6667Z"}}]},ds=U.forwardRef(function(t,e){return U.createElement(ne,Object.assign({},t,{id:"h3-icon",ref:e,icon:Or}))});ds.displayName="H3Icon";const Rr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.4334 2.66689C2.4334 2.33552 2.16477 2.06689 1.8334 2.06689C1.50203 2.06689 1.2334 2.33552 1.2334 2.66689V13.3336C1.2334 13.6649 1.50203 13.9336 1.8334 13.9336C2.16477 13.9336 2.4334 13.6649 2.4334 13.3336V8.5999H7.2334V13.3336C7.2334 13.6649 7.50203 13.9336 7.8334 13.9336C8.16477 13.9336 8.4334 13.6649 8.4334 13.3336V2.66689C8.4334 2.33552 8.16477 2.06689 7.8334 2.06689C7.50203 2.06689 7.2334 2.33552 7.2334 2.66689V7.3999H2.4334V2.66689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.7591 6.66645C13.7591 6.40387 13.5884 6.1718 13.3377 6.09364C13.087 6.01549 12.8147 6.10941 12.6654 6.32546L9.67321 10.6577C9.60398 10.7579 9.56689 10.8769 9.56689 10.9987V11.6731C9.56689 12.0045 9.83552 12.2731 10.1669 12.2731H12.5591V13.3331C12.5591 13.6645 12.8278 13.9331 13.1591 13.9331C13.4905 13.9331 13.7591 13.6645 13.7591 13.3331V12.2731H14.1669C14.4983 12.2731 14.7669 12.0045 14.7669 11.6731C14.7669 11.3417 14.4983 11.0731 14.1669 11.0731H13.7591V6.66645ZM12.5591 8.59091V11.0731H10.8447L12.5591 8.59091Z",fillRule:"evenodd",clipRule:"evenodd"}}]},As=U.forwardRef(function(t,e){return U.createElement(ne,Object.assign({},t,{id:"h4-icon",ref:e,icon:Rr}))});As.displayName="H4Icon";const Mr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.5999 2.66689C2.5999 2.33552 2.33127 2.06689 1.9999 2.06689C1.66853 2.06689 1.3999 2.33552 1.3999 2.66689V13.3336C1.3999 13.6649 1.66853 13.9336 1.9999 13.9336C2.33127 13.9336 2.5999 13.6649 2.5999 13.3336V8.5999H7.3999V13.3336C7.3999 13.6649 7.66853 13.9336 7.9999 13.9336C8.33127 13.9336 8.5999 13.6649 8.5999 13.3336V2.66689C8.5999 2.33552 8.33127 2.06689 7.9999 2.06689C7.66853 2.06689 7.3999 2.33552 7.3999 2.66689V7.3999H2.5999V2.66689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.6669 6.40332C10.3355 6.40332 10.0669 6.67195 10.0669 7.00332V9.34492C10.0669 9.67629 10.3355 9.94492 10.6669 9.94492C10.7822 9.94492 10.8899 9.91238 10.9814 9.85599C10.9901 9.85195 11.0027 9.84632 11.0192 9.83936C11.0764 9.81533 11.1692 9.78033 11.2927 9.74447C11.5397 9.67268 11.8996 9.60022 12.3336 9.60022C12.4975 9.60022 12.5978 9.63412 12.6624 9.67167C12.7263 9.70877 12.79 9.76953 12.8503 9.87834C12.983 10.1181 13.0669 10.5337 13.0669 11.1669C13.0669 11.8061 12.9802 12.1936 12.8338 12.414C12.7252 12.5775 12.5275 12.7336 12.0002 12.7336C11.6445 12.7336 11.4936 12.622 11.4192 12.5328C11.3289 12.4245 11.2669 12.2453 11.2669 12.0028C11.2669 11.6714 10.9983 11.4028 10.6669 11.4028C10.3355 11.4028 10.0669 11.6714 10.0669 12.0028C10.0669 12.4244 10.1716 12.9106 10.4979 13.3016C10.8401 13.7118 11.356 13.9336 12.0002 13.9336C12.8063 13.9336 13.4419 13.6673 13.8334 13.0779C14.1869 12.5456 14.2669 11.8497 14.2669 11.1669C14.2669 10.4781 14.1841 9.81027 13.9002 9.29724C13.7521 9.02964 13.545 8.79662 13.2651 8.63403C12.986 8.4719 12.6697 8.40022 12.3336 8.40022C11.9239 8.40022 11.5627 8.44957 11.2669 8.51389V7.60332H13.3336C13.6649 7.60332 13.9336 7.33469 13.9336 7.00332C13.9336 6.67195 13.6649 6.40332 13.3336 6.40332H10.6669Z"}}]},us=U.forwardRef(function(t,e){return U.createElement(ne,Object.assign({},t,{id:"h5-icon",ref:e,icon:Mr}))});us.displayName="H5Icon";const xr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M3.33315 5.56641C3.00178 5.56641 2.73315 5.83504 2.73315 6.16641C2.73315 6.49778 3.00178 6.76641 3.33315 6.76641H12.6665C12.9979 6.76641 13.2665 6.49778 13.2665 6.16641C13.2665 5.83504 12.9979 5.56641 12.6665 5.56641H3.33315Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M3.33315 12.9004C3.00178 12.9004 2.73315 13.169 2.73315 13.5004C2.73315 13.8318 3.00178 14.1004 3.33315 14.1004H12.6665C12.9979 14.1004 13.2665 13.8318 13.2665 13.5004C13.2665 13.169 12.9979 12.9004 12.6665 12.9004H3.33315Z"}}]},hs=U.forwardRef(function(t,e){return U.createElement(ne,Object.assign({},t,{id:"horizontally-icon",ref:e,icon:xr}))});hs.displayName="HorizontallyIcon";const Dr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M10.4713 3.52876C10.7317 3.78911 10.7317 4.21122 10.4713 4.47157L6.94273 8.00016L10.4713 11.5288C10.7317 11.7891 10.7317 12.2112 10.4713 12.4716C10.211 12.7319 9.78886 12.7319 9.52851 12.4716L5.52851 8.47157C5.26816 8.21122 5.26816 7.78911 5.52851 7.52876L9.52851 3.52876C9.78886 3.26841 10.211 3.26841 10.4713 3.52876Z",fillRule:"evenodd",clipRule:"evenodd"}}]},gs=U.forwardRef(function(t,e){return U.createElement(ne,Object.assign({},t,{id:"left-icon",ref:e,icon:Dr}))});gs.displayName="LeftIcon";const Br={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 5.56641C1.66853 5.56641 1.3999 5.83504 1.3999 6.16641C1.3999 6.49778 1.66853 6.76641 1.9999 6.76641H11.3332C11.6646 6.76641 11.9332 6.49778 11.9332 6.16641C11.9332 5.83504 11.6646 5.56641 11.3332 5.56641H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 12.9004C1.66853 12.9004 1.3999 13.169 1.3999 13.5004C1.3999 13.8318 1.66853 14.1004 1.9999 14.1004H11.3332C11.6646 14.1004 11.9332 13.8318 11.9332 13.5004C11.9332 13.169 11.6646 12.9004 11.3332 12.9004H1.9999Z"}}]},ms=U.forwardRef(function(t,e){return U.createElement(ne,Object.assign({},t,{id:"left-justifying-icon",ref:e,icon:Br}))});ms.displayName="LeftJustifyingIcon";const _r={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.66665 5.56641C4.33528 5.56641 4.06665 5.83504 4.06665 6.16641C4.06665 6.49778 4.33528 6.76641 4.66665 6.76641H14C14.3314 6.76641 14.6 6.49778 14.6 6.16641C14.6 5.83504 14.3314 5.56641 14 5.56641H4.66665Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.66665 12.9004C4.33528 12.9004 4.06665 13.169 4.06665 13.5004C4.06665 13.8318 4.33528 14.1004 4.66665 14.1004H14C14.3314 14.1004 14.6 13.8318 14.6 13.5004C14.6 13.169 14.3314 12.9004 14 12.9004H4.66665Z"}}]},ps=U.forwardRef(function(t,e){return U.createElement(ne,Object.assign({},t,{id:"right-justifying-icon",ref:e,icon:_r}))});ps.displayName="RightJustifyingIcon";const Nr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.06641 1.9999C2.06641 1.66853 2.33504 1.3999 2.66641 1.3999H13.3331C13.6644 1.3999 13.9331 1.66853 13.9331 1.9999V3.64434C13.9331 3.97571 13.6644 4.24434 13.3331 4.24434C13.0017 4.24434 12.7331 3.97571 12.7331 3.64434V2.5999H8.59966V13.3999H10.6665C10.9979 13.3999 11.2665 13.6685 11.2665 13.9999C11.2665 14.3313 10.9979 14.5999 10.6665 14.5999L7.99966 14.5999L5.33315 14.5999C5.00178 14.5999 4.73315 14.3313 4.73315 13.9999C4.73315 13.6685 5.00178 13.3999 5.33315 13.3999H7.39966V2.5999H3.26641V3.64434C3.26641 3.97571 2.99778 4.24434 2.66641 4.24434C2.33504 4.24434 2.06641 3.97571 2.06641 3.64434V1.9999Z"}}]},Mt=U.forwardRef(function(t,e){return U.createElement(ne,Object.assign({},t,{id:"text-type-icon",ref:e,icon:Nr}))});Mt.displayName="TextTypeIcon";const Pr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.96372 2.59116C5.19803 2.35684 5.19803 1.97695 4.96372 1.74263C4.7294 1.50832 4.3495 1.50832 4.11519 1.74263L2.53945 3.31837L1.96372 2.74263C1.7294 2.50832 1.3495 2.50832 1.11519 2.74263C0.880874 2.97695 0.880874 3.35684 1.11519 3.59116L2.11519 4.59116C2.3495 4.82547 2.7294 4.82547 2.96372 4.59116L4.96372 2.59116Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M14.4605 2.56689H6.8981C6.56672 2.56689 6.2981 2.83552 6.2981 3.16689C6.2981 3.49827 6.56672 3.76689 6.8981 3.76689H14.4605C14.7918 3.76689 15.0605 3.49827 15.0605 3.16689C15.0605 2.83552 14.7918 2.56689 14.4605 2.56689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M6.8981 7.2334C6.56672 7.2334 6.2981 7.50203 6.2981 7.8334C6.2981 8.16477 6.56672 8.4334 6.8981 8.4334H14.4605C14.7918 8.4334 15.0605 8.16477 15.0605 7.8334C15.0605 7.50203 14.7918 7.2334 14.4605 7.2334H6.8981Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M6.2981 12.4999C6.2981 12.1685 6.56672 11.8999 6.8981 11.8999H14.4605C14.7918 11.8999 15.0605 12.1685 15.0605 12.4999C15.0605 12.8313 14.7918 13.0999 14.4605 13.0999H6.8981C6.56672 13.0999 6.2981 12.8313 6.2981 12.4999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.87279 5.8999C1.80504 5.8999 0.939453 6.76549 0.939453 7.83324C0.939453 8.90099 1.80504 9.76657 2.87279 9.76657C3.94054 9.76657 4.80612 8.90099 4.80612 7.83324C4.80612 6.76549 3.94054 5.8999 2.87279 5.8999ZM2.13945 7.83324C2.13945 7.42823 2.46778 7.0999 2.87279 7.0999C3.2778 7.0999 3.60612 7.42823 3.60612 7.83324C3.60612 8.23824 3.2778 8.56657 2.87279 8.56657C2.46778 8.56657 2.13945 8.23824 2.13945 7.83324Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M0.939453 12.5002C0.939453 11.4325 1.80504 10.5669 2.87279 10.5669C3.94054 10.5669 4.80612 11.4325 4.80612 12.5002C4.80612 13.568 3.94054 14.4336 2.87279 14.4336C1.80504 14.4336 0.939453 13.568 0.939453 12.5002ZM2.87279 11.7669C2.46778 11.7669 2.13945 12.0952 2.13945 12.5002C2.13945 12.9052 2.46778 13.2336 2.87279 13.2336C3.2778 13.2336 3.60612 12.9052 3.60612 12.5002C3.60612 12.0952 3.2778 11.7669 2.87279 11.7669Z",fillRule:"evenodd",clipRule:"evenodd"}}]},fs=U.forwardRef(function(t,e){return U.createElement(ne,Object.assign({},t,{id:"todo-list-double-icon",ref:e,icon:Pr}))});fs.displayName="TodoListDoubleIcon";function Ss(o){var n;const{dataStream:t}=(n=o.body)!=null?n:{},e=[s.DataStreamTreeTokenType.TABLE_START,s.DataStreamTreeTokenType.TABLE_CELL_END,s.DataStreamTreeTokenType.TABLE_CELL_START,s.DataStreamTreeTokenType.TABLE_END,s.DataStreamTreeTokenType.TABLE_ROW_END,s.DataStreamTreeTokenType.TABLE_ROW_START,s.DataStreamTreeTokenType.COLUMN_BREAK,s.DataStreamTreeTokenType.PAGE_BREAK,s.DataStreamTreeTokenType.TAB,s.DataStreamTreeTokenType.DOCS_END,s.DataStreamTreeTokenType.CUSTOM_BLOCK];if(typeof t=="string")for(let i=0;i<t.length;i++){const a=t[i];if(!e.includes(a))return i}return 0}class Is extends s.Disposable{constructor(e,n,i,a,r,c){super();B(this,"_change$",new L.Subject);B(this,"change$",this._change$.asObservable());B(this,"_input$",new L.Subject);B(this,"input$",this._input$.asObservable());B(this,"_paste$",new L.Subject);B(this,"paste$",this._paste$.asObservable());B(this,"_focus$",new L.Subject);B(this,"focus$",this._focus$.asObservable());B(this,"_blur$",new L.Subject);B(this,"blur$",this._blur$.asObservable());B(this,"_selectionChange$",new L.Subject);B(this,"selectionChange$",this._selectionChange$.asObservable());this._param=e,this._univerInstanceService=n,this._docSelectionManagerService=i,this._commandService=a,this._undoRedoService=r,this._injector=c,this._listenSelection()}get docSelectionRenderService(){return this._param.render.with(y.DocSelectionRenderService)}_listenSelection(){const e=this._param.render.with(y.DocSelectionRenderService);this.disposeWithMe(e.onBlur$.subscribe(n=>{this._blur$.next(n);const i=this.getDocumentData();this._change$.next({target:this,data:i})})),this.disposeWithMe(e.onFocus$.subscribe(n=>{this._focus$.next(n)})),this.disposeWithMe(e.onPaste$.subscribe(n=>{this._paste$.next(n)})),this.disposeWithMe(L.merge(e.onInput$,e.onKeydown$.pipe(lt.filter(n=>{const i=n.event;return i.ctrlKey||i.metaKey?[I.KeyCode.X,I.KeyCode.V].includes(i.keyCode):[I.KeyCode.BACKSPACE].includes(i.keyCode)})),e.onCompositionupdate$,e.onCompositionend$,e.onPaste$).subscribe(n=>{if(n==null)return;const{content:i=""}=n,a=this.getDocumentData();this._input$.next({target:this,content:i,data:a,isComposing:n.event.type==="compositionupdate"})})),this.disposeWithMe(this._docSelectionManagerService.textSelection$.subscribe(n=>{if(n==null)return;const{unitId:i,subUnitId:a,...r}=n,c=this.getEditorId();i===c&&this._selectionChange$.next(r)}))}isFocus(){const e=this._param.render.with(y.DocSelectionRenderService);return e.isFocusing&&!!e.getActiveTextRange()}focus(){const e=this._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),n=this.getEditorId();(e==null||e.getUnitId()!==n)&&this._univerInstanceService.setCurrentUnitForType(n),this._param.render.with(y.DocSelectionRenderService).focus()}blur(){this._param.render.with(y.DocSelectionRenderService).blur()}select(){const e=this.getDocumentData();return this.setSelectionRanges([{startOffset:0,endOffset:e.body?e.body.dataStream.length-2:0}])}setSelectionRanges(e,n=!0){const i=this.getEditorId(),a={unitId:i,subUnitId:i};return this._docSelectionManagerService.replaceDocRanges(e,a,!1,{shouldFocus:n})}getSelectionRanges(){const e=this.getEditorId(),n={unitId:e,subUnitId:e};return this._docSelectionManagerService.getDocRanges(n)}getCursorPosition(){var n,i;return(i=(n=this.getSelectionRanges().find(a=>a.collapsed))==null?void 0:n.startOffset)!=null?i:-1}getEditorId(){return this._getEditorId()}getDocumentData(){return this._getDocDataModel().getSnapshot()}getDocumentDataModel(){return this._getDocDataModel()}setDocumentData(e,n){this._commandService.syncExecuteCommand($n.id,{unitId:this.getEditorId(),snapshot:e,textRanges:n})}replaceText(e,n=!0){const i=this.getDocumentData();this.setDocumentData({...i,body:{dataStream:`${e}\r
`,paragraphs:[{startIndex:0}],customRanges:[],sectionBreaks:[],tables:[],textRuns:[]}},typeof n=="object"?n:n?[{startOffset:e.length,endOffset:e.length,collapsed:!0}]:null)}clearUndoRedoHistory(){const e=this.getEditorId();return this._undoRedoService.clearUndoRedo(e)}dispose(){this._getDocDataModel().dispose()}get editorUnitId(){return this._param.editorUnitId}get params(){return this._param}get cancelDefaultResizeListener(){return this._param.cancelDefaultResizeListener}get render(){return this._param.render}isReadOnly(){return this._param.readonly===!0}getBoundingClientRect(){return this._param.editorDom.getBoundingClientRect()}get editorDOM(){return this._param.editorDom}isVisible(){return this._param.visible}getSkeleton(){var n;return(n=this._injector.get(_.IRenderManagerService).getRenderById(this._getEditorId()))==null?void 0:n.with(D.DocSkeletonManagerService).getSkeleton()}isSheetEditor(){return s.isInternalEditorID(this._getEditorId())}getValue(){var i;return(((i=this._getDocDataModel().getBody())==null?void 0:i.dataStream)||"").replace(/\r\n/g,"").replace(/\n/g,"").replace(/\n/g,"")}getBody(){return this._getDocDataModel().getBody()}update(e){this._param={...this._param,...e}}updateCanvasStyle(){var i;const e=this._getDocDataModel();if(e==null)return;const n={};(i=this._param.canvasStyle)!=null&&i.fontSize&&(n.textStyle==null&&(n.textStyle={}),n.textStyle.fs=this._param.canvasStyle.fontSize),e.updateDocumentStyle(n)}_getDocDataModel(){const e=this._getEditorId();return this._univerInstanceService.getUnit(e,s.UniverInstanceType.UNIVER_DOC)}_getEditorId(){var e;return((e=this._param.initialSnapshot)==null?void 0:e.id)||this._param.editorUnitId||""}}var Ur=Object.getOwnPropertyDescriptor,wr=(o,t,e,n)=>{for(var i=n>1?void 0:n?Ur(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Ge=(o,t)=>(e,n)=>t(e,n,o);const Lr=["editor","render-canvas"];y.EditorService=class extends s.Disposable{constructor(e,n,i,a,r,c,l){super();B(this,"_editors",new Map);B(this,"_focusEditorUnitId");B(this,"_blur$",new L.Subject);B(this,"blur$",this._blur$.asObservable());B(this,"_focus$",new L.Subject);B(this,"focus$",this._focus$.asObservable());this._univerInstanceService=e,this._renderManagerService=n,this._docSelectionManagerService=i,this._contextService=a,this._commandService=r,this._undoRedoService=c,this._injector=l,this._initUniverFocusListener()}_initUniverFocusListener(){this.disposeWithMe(L.fromEvent(window,"focusin").subscribe(e=>{const n=e.target;this._blurSheetEditor(n)}))}_blurSheetEditor(e){if(Lr.some(i=>e.dataset.uComp===i))return;const n=this.getFocusEditor();n&&n.isSheetEditor()!==!0&&this.blur()}_setFocusId(e){this._focusEditorUnitId=e}getFocusId(){return this._focusEditorUnitId}getFocusEditor(){if(this._focusEditorUnitId)return this.getEditor(this._focusEditorUnitId)}isEditor(e){return this._editors.has(e)}isSheetEditor(e){const n=this._editors.get(e);return!!(n&&n.isSheetEditor())}blur(e){const n=this.getFocusEditor();e&&(n==null||n.setSelectionRanges([])),n==null||n.blur(),this._contextService.setContextValue(s.EDITOR_ACTIVATED,!1),this._contextService.setContextValue(s.FOCUSING_EDITOR_STANDALONE,!1),this._contextService.setContextValue(s.FOCUSING_COMMENT_EDITOR,!1),this._setFocusId(null),this._blur$.next(null)}focus(e){if(e===this._focusEditorUnitId||(this._focusEditorUnitId&&this.blur(),e==null))return;const n=this.getEditor(e);if(n==null)return;this._univerInstanceService.setCurrentUnitForType(e);const i=n.getValue().length;this._contextService.setContextValue(s.EDITOR_ACTIVATED,!0),s.isInternalEditorID(e)||this._contextService.setContextValue(s.FOCUSING_EDITOR_STANDALONE,!0),s.isCommentEditorID(e)&&this._contextService.setContextValue(s.FOCUSING_COMMENT_EDITOR,!0),n.focus(),this._setFocusId(e),this._focus$.next({startOffset:i,endOffset:i})}dispose(){this._editors.clear(),super.dispose()}getEditor(e=this._getCurrentEditorUnitId()){return this._editors.get(e)}getAllEditor(){return this._editors}register(e,n){var A,d,u,m;const{initialSnapshot:i,canvasStyle:a={}}=e,r=i.id;this._univerInstanceService.getUnit(r,s.UniverInstanceType.UNIVER_DOC)==null&&this._univerInstanceService.createUnit(s.UniverInstanceType.UNIVER_DOC,i||this._getBlank(r),{makeCurrent:!1});let l=this._renderManagerService.getRenderById(r);if(l==null&&(this._renderManagerService.create(r),l=this._renderManagerService.getRenderById(r)),l){l.engine.setContainer(n);const h=new Is({...e,render:l,editorDom:n,canvasStyle:a},this._univerInstanceService,this._docSelectionManagerService,this._commandService,this._undoRedoService,this._injector);this._editors.set(r,h),e.scrollBar||(m=(u=(d=(A=l.mainComponent)==null?void 0:A.getScene())==null?void 0:d.getViewports())==null?void 0:u[0].getScrollBar())==null||m.dispose()}return s.toDisposable(()=>{this._unRegister(r)})}_unRegister(e){const n=this._editors.get(e);n!=null&&(this._renderManagerService.removeRender(e),n.dispose(),this._editors.delete(e),this._univerInstanceService.disposeUnit(e))}_getCurrentEditorUnitId(){return this._univerInstanceService.getCurrentUniverDocInstance().getUnitId()}_getBlank(e){return{id:e,body:{dataStream:`${s.DEFAULT_EMPTY_DOCUMENT_VALUE}`,textRuns:[],paragraphs:[{startIndex:0}]},documentStyle:{renderConfig:{verticalAlign:s.VerticalAlign.TOP,horizontalAlign:s.HorizontalAlign.LEFT},marginLeft:3,marginTop:0,marginRight:3}}}},y.EditorService=wr([Ge(0,s.IUniverInstanceService),Ge(1,_.IRenderManagerService),Ge(2,s.Inject(D.DocSelectionManagerService)),Ge(3,s.IContextService),Ge(4,s.ICommandService),Ge(5,s.IUndoRedoService),Ge(6,s.Inject(s.Injector))],y.EditorService);const le=s.createIdentifier("univer.editor.service"),Bo="COMPONENT_DOC_HEADER_FOOTER_PANEL";function Qr(o,t,e){const{useFirstPageHeaderFooter:n,evenAndOddHeaders:i,defaultHeaderId:a,defaultFooterId:r,firstPageHeaderId:c,firstPageFooterId:l,evenPageHeaderId:A,evenPageFooterId:d}=o;return t===_.DocumentEditArea.HEADER?n===s.BooleanNumber.TRUE&&e===0?c:i===s.BooleanNumber.TRUE&&e%2===1?A:a:n===s.BooleanNumber.TRUE&&e===0?l:i===s.BooleanNumber.TRUE&&e%2===1?d:r}const Fr=o=>{const t=I.useDependency(s.LocaleService),e=I.useDependency(s.IUniverInstanceService),n=I.useDependency(_.IRenderManagerService),i=I.useDependency(s.ICommandService),a=I.useDependency(I.ILayoutService),{unitId:r}=o,c=n.getRenderById(r).with(y.DocSelectionRenderService),[l,A]=U.useState({}),d=(h,g)=>{var O;A(M=>({...M,[g]:h?s.BooleanNumber.TRUE:s.BooleanNumber.FALSE}));const p=e.getUniverDocInstance(r),f=p==null?void 0:p.getSnapshot().documentStyle,S=(O=n.getRenderById(r))==null?void 0:O.with(D.DocSkeletonManagerService),E=S==null?void 0:S.getViewModel();if(f==null||E==null)return;const C=E.getEditArea();let T=!1;const R=c.getSegmentPage();let v=!1;if(g==="useFirstPageHeaderFooter"&&h===!0&&((C===_.DocumentEditArea.HEADER&&!f.firstPageHeaderId||C===_.DocumentEditArea.FOOTER&&!f.firstPageFooterId)&&(T=!0),T&&R===0&&(v=!0)),g==="evenAndOddHeaders"&&h===!0&&((C===_.DocumentEditArea.HEADER&&!f.evenPageHeaderId||C===_.DocumentEditArea.FOOTER&&!f.evenPageFooterId)&&(T=!0),T&&R%2===1&&(v=!0)),T){const b=s.generateRandomId(6);v&&c.setSegment(b),i.executeCommand(An,{unitId:r,segmentId:b,headerFooterProps:{[g]:h?s.BooleanNumber.TRUE:s.BooleanNumber.FALSE}})}else{const M=c.getSegmentPage(),b=c.getSegment(),N=Qr({...f,[g]:h?s.BooleanNumber.TRUE:s.BooleanNumber.FALSE},C,M);N&&N!==b&&c.setSegment(N),i.executeCommand(An,{unitId:r,headerFooterProps:{[g]:h?s.BooleanNumber.TRUE:s.BooleanNumber.FALSE}})}a.focus()},u=async(h,g)=>{A(p=>({...p,[g]:h})),await i.executeCommand(An,{unitId:r,headerFooterProps:{[g]:h}}),c.removeAllRanges(),c.blur()},m=()=>{i.executeCommand(Lo.id,{unitId:r})};return U.useEffect(()=>{const h=e.getUniverDocInstance(r),g=h==null?void 0:h.getSnapshot().documentStyle;if(g){const{marginHeader:p=0,marginFooter:f=0,useFirstPageHeaderFooter:S=s.BooleanNumber.FALSE,evenAndOddHeaders:E=s.BooleanNumber.FALSE}=g;A({marginHeader:p,marginFooter:f,useFirstPageHeaderFooter:S,evenAndOddHeaders:E})}},[r]),P.jsxs("div",{className:"univer-grid univer-gap-4",children:[P.jsxs("div",{className:"univer-grid univer-gap-2",children:[P.jsx("div",{children:P.jsx(J.Checkbox,{checked:l.useFirstPageHeaderFooter===s.BooleanNumber.TRUE,onChange:h=>{d(h,"useFirstPageHeaderFooter")},children:t.t("headerFooter.firstPageCheckBox")})}),P.jsx("div",{children:P.jsx(J.Checkbox,{checked:l.evenAndOddHeaders===s.BooleanNumber.TRUE,onChange:h=>{d(h,"evenAndOddHeaders")},children:t.t("headerFooter.oddEvenCheckBox")})})]}),P.jsxs("div",{className:"univer-mb-1 univer-flex",children:[P.jsxs("div",{children:[P.jsx("span",{children:t.t("headerFooter.headerTopMargin")}),P.jsx(J.InputNumber,{className:"univer-mt-1.5 univer-w-4/5",min:0,max:200,precision:1,value:l.marginHeader,onChange:h=>{u(h,"marginHeader")}})]}),P.jsxs("div",{children:[P.jsx("span",{children:t.t("headerFooter.footerBottomMargin")}),P.jsx(J.InputNumber,{className:"univer-mt-1.5 univer-w-4/5",min:0,max:200,precision:1,value:l.marginFooter,onChange:h=>{u(h,"marginFooter")}})]})]}),P.jsx("div",{className:"univer-flex univer-justify-end",children:P.jsx(J.Button,{onClick:m,children:t.t("headerFooter.closeHeaderFooter")})})]})},Hr=()=>{var A;const o=I.useDependency(s.LocaleService),t=I.useDependency(_.IRenderManagerService),i=I.useDependency(s.IUniverInstanceService).getCurrentUniverDocInstance().getUnitId(),r=((A=t.getRenderById(i))==null?void 0:A.with(D.DocSkeletonManagerService)).getViewModel(),[c,l]=U.useState(!0);return U.useEffect(()=>{const d=r.getEditArea();l(d!==_.DocumentEditArea.BODY);const u=r.editAreaChange$.subscribe(m=>{m!=null&&l(m!==_.DocumentEditArea.BODY)});return()=>{u.unsubscribe()}},[]),P.jsx("div",{className:"univer-text-sm",children:c?P.jsx(Fr,{unitId:i}):P.jsx("div",{className:"univer-text-gray-400",children:o.t("headerFooter.disableText")})})},vs=18,Es=200,_o=6,kr=4;function Vr(o,t){let{radius:e,width:n,height:i}=t;e=e!=null?e:0,n=n!=null?n:30,i=i!=null?i:30;let a=0;a=Math.min(e,n/2,i/2),o.beginPath(),o.moveTo(0,0),o.lineTo(n,0),o.lineTo(n,i-a),o.arc(n-a,i-a,a,0,Math.PI/2,!1),o.lineTo(0,i),o.lineTo(0,0),o.closePath(),t.fill&&(o.save(),o.fillStyle=t.fill,t.fillRule==="evenodd"?o.fill("evenodd"):o.fill(),o.restore())}class dn extends _.Shape{constructor(e,n){super(e,n);B(this,"color");B(this,"text");this.color=n==null?void 0:n.color,this.text=n==null?void 0:n.text}static drawWith(e,n){const{text:i,color:a}=n;e.save(),e.font="13px Source Han Sans CN";const r=e.measureText(i).width,c=Math.min(r+2*_o,Es);Vr(e,{height:vs,width:c,radius:4,fill:a}),e.fillStyle="rgba(58, 96, 247, 1)";const l=_o,A=vs-kr,d=Es-2*_o;if(r>d){let u="",m=0;for(const h of i){const g=e.measureText(h).width;if(m+g<=d-e.measureText("...").width)u+=h,m+=g;else{u+="...";break}}e.fillText(u,l,A)}else e.fillText(i,l,A);e.restore()}_draw(e){dn.drawWith(e,this)}}var Wr=Object.getOwnPropertyDescriptor,Gr=(o,t,e,n)=>{for(var i=n>1?void 0:n?Wr(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Le=(o,t)=>(e,n)=>t(e,n,o);const Cs="rgba(58, 96, 247, 1)",Ts="rgba(58, 96, 247, 0.08)";var se=(o=>(o[o.FIRST_PAGE_HEADER=0]="FIRST_PAGE_HEADER",o[o.FIRST_PAGE_FOOTER=1]="FIRST_PAGE_FOOTER",o[o.DEFAULT_HEADER=2]="DEFAULT_HEADER",o[o.DEFAULT_FOOTER=3]="DEFAULT_FOOTER",o[o.EVEN_PAGE_HEADER=4]="EVEN_PAGE_HEADER",o[o.EVEN_PAGE_FOOTER=5]="EVEN_PAGE_FOOTER",o))(se||{});function Xr(o,t,e){const{documentStyle:n}=o.getDataModel().getSnapshot(),{defaultHeaderId:i,defaultFooterId:a,evenPageHeaderId:r,evenPageFooterId:c,firstPageHeaderId:l,firstPageFooterId:A,evenAndOddHeaders:d,useFirstPageHeaderFooter:u}=n;switch(t){case _.DocumentEditArea.BODY:return{createType:null,headerFooterId:null};case _.DocumentEditArea.HEADER:return u===s.BooleanNumber.TRUE&&!l?{createType:0,headerFooterId:null}:d===s.BooleanNumber.TRUE&&e%2===0&&!r?{createType:4,headerFooterId:null}:i?{createType:null,headerFooterId:i}:{createType:2,headerFooterId:null};case _.DocumentEditArea.FOOTER:return u===s.BooleanNumber.TRUE&&!A?{createType:1,headerFooterId:null}:d===s.BooleanNumber.TRUE&&e%2===0&&!c?{createType:5,headerFooterId:null}:a?{createType:null,headerFooterId:a}:{createType:3,headerFooterId:null};default:throw new Error(`Invalid editArea: ${t}`)}}let No=class extends s.Disposable{constructor(t,e,n,i,a,r,c,l,A){super();B(this,"_loadedMap",new WeakSet);this._context=t,this._commandService=e,this._editorService=n,this._instanceSrv=i,this._renderManagerService=a,this._docSkeletonManagerService=r,this._docSelectionRenderService=c,this._localeService=l,this._componentManager=A,this._initialize()}_initialize(){this._init(),this._drawHeaderFooterLabel(),this._initCustomComponents(),this._listenSwitchMode()}dispose(){super.dispose()}_listenSwitchMode(){this.disposeWithMe(this._commandService.onCommandExecuted(t=>{if(D.RichTextEditingMutation.id===t.id){const e=this._context.unit,i=this._docSkeletonManagerService.getViewModel().getEditArea(),a=e.getSnapshot().documentStyle.documentFlavor;i!==_.DocumentEditArea.BODY&&a===s.DocumentFlavor.MODERN&&this._commandService.executeCommand(Lo.id,{unitId:this._context.unitId})}}))}_initCustomComponents(){this._componentManager.get(Bo)||this.disposeWithMe(this._componentManager.register(Bo,Hr))}_init(){const{unitId:t}=this._context,e=Ie(this._context);e==null||e.document==null||this._loadedMap.has(e.document)||(this._initialMain(t),this._loadedMap.add(e.document))}_initialMain(t){const e=Ie(this._context),{document:n}=e;this.disposeWithMe(n.onDblclick$.subscribeEvent(async i=>{if(this._isEditorReadOnly(t)||!this._isTraditionalMode())return;const{offsetX:a,offsetY:r}=i,{pageLayoutType:c=_.PageLayoutType.VERTICAL,pageMarginLeft:l,pageMarginTop:A}=n.getOffsetConfig(),d=this._getTransformCoordForDocumentOffset(a,r);if(d==null)return;const u=this._docSkeletonManagerService.getViewModel(),m=this._docSkeletonManagerService.getSkeleton(),h=u.getEditArea(),{editArea:g,pageNumber:p}=m.findEditAreaByCoord(d,c,l,A);if(h===g)return;u.setEditArea(g);const{createType:f,headerFooterId:S}=Xr(u,g,p);if(g===_.DocumentEditArea.BODY)this._docSelectionRenderService.setSegment(""),this._docSelectionRenderService.setSegmentPage(-1),this._docSelectionRenderService.setCursorManually(a,r);else if(f!=null){const C=s.generateRandomId(6);this._docSelectionRenderService.setSegment(C),this._docSelectionRenderService.setSegmentPage(p),await this._commandService.executeCommand(bs.id,{unitId:t,createType:f,segmentId:C})}else S!=null&&(this._docSelectionRenderService.setSegment(S),this._docSelectionRenderService.setSegmentPage(p),this._docSelectionRenderService.setCursorManually(a,r))}))}_getTransformCoordForDocumentOffset(t,e){const n=Ie(this._context),{document:i,scene:a}=n,{documentTransform:r}=i.getOffsetConfig(),c=a.getViewports()[0];if(c==null)return;const l=c.transformVector2SceneCoord(_.Vector2.FromArray([t,e]));return r.clone().invert().applyPoint(l)}_drawHeaderFooterLabel(){const t=this._localeService;this.disposeWithMe(this._instanceSrv.getCurrentTypeOfUnit$(s.UniverInstanceType.UNIVER_DOC).subscribe(e=>{if(e==null)return;const n=e.getUnitId(),i=this._renderManagerService.getRenderById(n);if(this._editorService.isEditor(n)||this._instanceSrv.getUniverDocInstance(n)==null||i==null)return;const{mainComponent:a}=i,r=a;this.disposeWithMe(s.toDisposable(r.pageRender$.subscribe(c=>{if(this._editorService.isEditor(n)||!this._isTraditionalMode())return;const d=this._docSkeletonManagerService.getViewModel().getEditArea()===_.DocumentEditArea.BODY,{page:u,pageLeft:m,pageTop:h,ctx:g}=c,{pageWidth:p,pageHeight:f,marginTop:S,marginBottom:E}=u;if(g.save(),g.translate(m-.5,h-.5),d?(_.Rect.drawWith(g,{left:0,top:0,width:p,height:S,fill:"rgba(255, 255, 255, 0.5)"}),g.save(),g.translate(0,f-E),_.Rect.drawWith(g,{left:0,top:0,width:p,height:E,fill:"rgba(255, 255, 255, 0.5)"}),g.restore()):(g.save(),g.translate(0,S),_.Rect.drawWith(g,{left:0,top:S,width:p,height:f-S-E,fill:"rgba(255, 255, 255, 0.5)"}),g.restore()),!d){const C={dataArray:[{command:"M",points:[0,S]},{command:"L",points:[p,S]}],strokeWidth:1,stroke:Cs},T={dataArray:[{command:"M",points:[0,f-E]},{command:"L",points:[p,f-E]}],strokeWidth:1,stroke:Cs};_.Path.drawWith(g,C),_.Path.drawWith(g,T),g.translate(0,S+1),dn.drawWith(g,{text:t.t("headerFooter.header"),color:Ts}),g.translate(0,f-S-E),dn.drawWith(g,{text:t.t("headerFooter.footer"),color:Ts})}g.restore()})))}))}_isEditorReadOnly(t){const e=this._editorService.getEditor(t);return e?e.isReadOnly():!1}_isTraditionalMode(){return this._context.unit.getSnapshot().documentStyle.documentFlavor===s.DocumentFlavor.TRADITIONAL}};No=Gr([Le(1,s.ICommandService),Le(2,le),Le(3,s.IUniverInstanceService),Le(4,_.IRenderManagerService),Le(5,s.Inject(D.DocSkeletonManagerService)),Le(6,s.Inject(y.DocSelectionRenderService)),Le(7,s.Inject(s.LocaleService)),Le(8,s.Inject(I.ComponentManager))],No);const Po={id:"sidebar.operation.doc-header-footer-panel",type:s.CommandType.OPERATION,handler:async(o,t)=>{const e=o.get(I.ISidebarService),n=o.get(s.LocaleService);switch(t.value){case"open":e.open({header:{title:n.t("headerFooter.panel")},children:{label:Bo},onClose:()=>{},width:400});break;case"close":default:e.close();break}return!0}};function ys(){return{dataStream:`\r
`,textRuns:[{st:0,ed:0,ts:{fs:9}}],customBlocks:[],paragraphs:[{startIndex:0,paragraphStyle:{spaceAbove:{v:0},lineSpacing:1.5,spaceBelow:{v:0}}}],sectionBreaks:[{startIndex:1}]}}function Uo(o,t,e,n){const i=s.JSONX.getInstance(),a=6,r=o!=null?o:s.generateRandomId(a),c=t===se.DEFAULT_HEADER||t===se.FIRST_PAGE_HEADER||t===se.EVEN_PAGE_HEADER,l=i.insertOp([c?"headers":"footers",r],{[c?"headerId":"footerId"]:r,body:ys()});n.push(l);const A=s.generateRandomId(a),d=i.insertOp([c?"footers":"headers",A],{[c?"footerId":"headerId"]:A,body:ys()});n.push(d);let u="defaultHeaderId",m="defaultFooterId";switch(t){case se.DEFAULT_HEADER:u="defaultHeaderId",m="defaultFooterId";break;case se.DEFAULT_FOOTER:u="defaultFooterId",m="defaultHeaderId";break;case se.FIRST_PAGE_HEADER:u="firstPageHeaderId",m="firstPageFooterId";break;case se.FIRST_PAGE_FOOTER:u="firstPageFooterId",m="firstPageHeaderId";break;case se.EVEN_PAGE_HEADER:u="evenPageHeaderId",m="evenPageFooterId";break;case se.EVEN_PAGE_FOOTER:u="evenPageFooterId",m="evenPageHeaderId";break;default:throw new Error(`Unknown header footer type: ${t}`)}for(const[h,g]of[[u,r],[m,A]])if(e[h]!=null){const p=i.replaceOp(["documentStyle",h],e[h],g);n.push(p)}else{const p=i.insertOp(["documentStyle",h],g);n.push(p)}return n}const An="doc.command.core-header-footer",bs={id:An,type:s.CommandType.COMMAND,handler:async(o,t)=>{var T;const e=o.get(s.ICommandService),n=o.get(s.IUniverInstanceService),i=o.get(_.IRenderManagerService),{unitId:a,segmentId:r,createType:c,headerFooterProps:l}=t,A=(T=i.getRenderById(a))==null?void 0:T.with(D.DocSkeletonManagerService),d=n.getUniverDocInstance(a),u=A==null?void 0:A.getViewModel();if(d==null||u==null)return!1;const m=u.getEditArea(),{documentStyle:h}=d.getSnapshot(),g=(l==null?void 0:l.marginFooter)!=null||(l==null?void 0:l.marginHeader)!=null,p=[{startOffset:0,endOffset:0,collapsed:!0}],f={id:D.RichTextEditingMutation.id,params:{unitId:a,actions:[],textRanges:p,debounce:!0}};g&&(f.params.noNeedSetTextRange=!0);const S=s.JSONX.getInstance(),E=[];return c!=null&&Uo(r,c,h,E),l!=null&&Object.keys(l).forEach(R=>{const v=l[R],O=h[R];if(v===O)return;let M;if(O===void 0?M=S.insertOp(["documentStyle",R],v):M=S.replaceOp(["documentStyle",R],O,v),E.push(M),R==="useFirstPageHeaderFooter"&&v===s.BooleanNumber.TRUE&&!h.firstPageHeaderId){const b=m===_.DocumentEditArea.HEADER?se.FIRST_PAGE_HEADER:se.FIRST_PAGE_FOOTER;Uo(r,b,h,E)}else if(R==="evenAndOddHeaders"&&v===s.BooleanNumber.TRUE&&!h.evenPageHeaderId){const b=m===_.DocumentEditArea.HEADER?se.EVEN_PAGE_HEADER:se.EVEN_PAGE_FOOTER;Uo(r,b,h,E)}}),E.length===0?!1:(f.params.actions=E.reduce((R,v)=>s.JSONX.compose(R,v),null),!!e.syncExecuteCommand(f.id,f.params))}},wo={id:"doc.command.open-header-footer-panel",type:s.CommandType.COMMAND,handler:async(o,t)=>o.get(s.ICommandService).executeCommand(Po.id,{value:"open"})},Lo={id:"doc.command.close-header-footer",type:s.CommandType.COMMAND,handler:async(o,t)=>{var g;const e=o.get(s.ICommandService),n=o.get(_.IRenderManagerService),i=o.get(D.DocSelectionManagerService),a=o.get(s.IUniverInstanceService),{unitId:r}=t,c=n.getRenderById(r);if(c==null)return!1;const{scene:l}=c,A=l.getTransformerByCreate(),d=c.with(D.DocSkeletonManagerService),u=c.with(y.DocSelectionRenderService),m=d==null?void 0:d.getSkeleton(),h=d==null?void 0:d.getViewModel();return h==null||m==null?!1:(i.replaceDocRanges([]),A.clearSelectedObjects(),u.setSegment(""),u.setSegmentPage(-1),h.setEditArea(_.DocumentEditArea.BODY),m.calculate(),(g=c.mainComponent)==null||g.makeDirty(!0),queueMicrotask(()=>{const p=a.getUnit(r),f=p==null?void 0:p.getSnapshot();if(f==null)return;const S=Ss(f);i.replaceDocRanges([{startOffset:S,endOffset:S}])}),e.executeCommand(Po.id,{value:"close"}),!0)}},Os="UI_PLUGIN_DOCS",Rs=o=>{const{value:t,onChange:e,options:n}=o;return P.jsx("div",{className:"univer-grid univer-grid-cols-3 univer-gap-2 univer-p-1.5",children:n.map(i=>P.jsx("a",{className:J.clsx("univer-block univer-h-20 univer-w-[72px] univer-cursor-pointer univer-overflow-hidden univer-rounded univer-transition-all hover:univer-border-primary-500",J.borderClassName,{"univer-border-primary-500":t===i.value}),onClick:()=>{e(i.value)},children:P.jsx("img",{className:"univer-size-full",src:i.img,draggable:!1})},i.value))})},jr=[{value:s.PresetListType.ORDER_LIST,img:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAgEA2ADYAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/CABEIAPQA2AMBEQACEQEDEQH/xAAzAAEAAgMBAQEAAAAAAAAAAAAABwkGCAoFBAMBAQADAQEAAAAAAAAAAAAAAAACAwQBBf/aAAwDAQACEAMQAAAA7+AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACrPRXpvZDoUx3gAAAAAAAAAAAfgc027P0wYdAxI12AAAAAAAAMuNiAADmf3Z7hc1u7dU/iMYAAAAAAAAPtMnAAINnHyDYmEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANdZxpZ1VSZHt8mS4YwQUAAAAAZOTqAAAAVM6K9WLIaG3Q6j/P0zhHvmGCAAAAAHqGdAAAAESy5UDpqsJpnjnW+VMwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABVPortYz2AAAAAAAAAAAACnDTVcfmtGPkOgAGQkwgAAAAAAAHN1to6MMV/qnikYgAHtEnAAAAAAAAGgN0Isly1HPYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEcuUc66bn8tuwcJAAAAAAAAAAACn7TVaznt5wNufpnw6BhZhYAAAAAAAPaJOABBE488WynpNxXyPHoj4j4AAAAAAAGQkwgApU1Uw1LljdNkISjbJntAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH//EACoQAAEEAgIBAgYCAwAAAAAAAAYABQcXBAgJFgMKEAECFSBAYDA4FDpw/9oACAEBAAEIAP1PkJ5Ph/SMkjyEwngx3J3W2nknkmDt1/yfhi43wyfnzfhwP/3Z58vc6ycjDFXTIxOyES7IRLshEuyES7IRLshEuyES7IRLshEuyES7IRLshEuyES7IRLshEuyES7IRIFe3nMKmvHy/t4H/AO7PPkhPkT1GNtxzfQodTi3Ybrh+bAz68D1Xgeq8D1Xgeq8D1Xgeq8D1Xgeq8D1Xgeq8D1Xgeq8D1Xgeq8D1Xgeq8D03Bo21Znhz8D7Yl1pgeCSmXTaIGHUnWgX2CK9rB7/hO2x3OMaa3y4a60xnxR7+TrG7HLu3PD/tPs47TXvFx4bg+xk45jUNuWfgWGYKwzBWGYKwzBWGYKwzBWGYKwzBWGYKwzBWGYINMiR1JG3Az/4ebLdeTtCOPyTpyheNeEuDDuKhyWdx/T9/JAfh5OuVvD1djzZfXyWpGk+IoxTy047425LXl1QOqqB1VQOqqB1VQOqqB1VQOqqB1VQOqqB1VQOpmj5mY3LGdMT+GdYLijZeJTiDJwC/T5aei2A3BT9AmgmtGss5zHsDCut/GxqXqhsNsFs/Cv7gT8nWSO8p4Pxn/J+UW7rzkz84MYaHYXsVO2QxsOe6YlrkStciVrkStciVrkSFZBeXx+wGvL/BkH/aNgxZL6yYTo2MeYiFn+vM+Y0qoVUKqFVCqhQ9HH0F4w3b8J80CEHzkeDeRzy7D8U0X7EchGtPIY9/rs7TtE2s0TG05Tl4PUFYTqN3MNau7SwfuTC4rPuvX5HLVoZNvIJ8mm0YB7q6h0aBjg9PHpucPwPTdyYy7G/sXl/VPpyt5W8reVvK3lbyt5W8reVvK3lbyt5W8reVvIekf688YbT9uy+ykO6iQmdbBTy1RRvFz2+dmOthYiiKNIEjQMhyHPY7E3En+lf4FUESqgiVUESqgiVUESqgiVUESqgiVUESqgiVUESqgiVUESqgiVUESqgiQrHzyxv2A6Zf2c0HGjO/JqCwHHMU+LUT1Cvg8Xj8Ph0WirfyLmmRsfe/jH0S2j0yINqXrZH9m//EAD0QAAEDAgMGBAIIBAYDAAAAAAUCAwQBBgAHEggRExSUpZXU1eUV0wkQICIjM0BgISQwWRYXQkRit2Rwtv/aAAgBAQAJPwD9p5DZw7T21TngDKE8lMlsrQSnYZuo+ekS4SvG7NMxdsW5CIuN/E58AHcEuHF1TJMKKORIIxrsBlL22dNocNloNse1QlqDrRytJxC2aoO9bOtUvb41kpcoAeYtKLAGF7nOXOSkxBrMz4s+7NlyJP6mOxSY4w3Fcl0abpJXGZcddajrfoniqYadfecbaquraHHnVpTRTi61/uKXl/21tIfXIfiyG+R4b8d1xh5GsjDQvQ60pK06kKUhWlVNSVKTXfStaYPmvFJ3z8HzXik75+D5rxSd8/B814pO+fg+a8UnfPwfNeKTvn4PmvFJ3z8HzXik75+D5rxSd8/B814pO+fg+a8UnfPwfNeKTvn4PmvFJ3z8HzXik75+D5rxSd8/B814pO+fg+a8UnfPwXKSo7nPcRiRPlvsr0Dpi0a2nXVIVpWlK06k10qSlVN1aUr9r+4peX/bW0hjNFMzacy/BKP3BZC7cuWMOq1HFDTpQYLu2QKbtcsdChTIwoVEQirstiK/K4SH3gx5kVhnjxH+HxWuI61r4TqHm/xGVtup0utoV91dN+7dXemtaVEdwKedwI7gU87gR3Ap53AjuBTzuBHcCnncCO4FPO4EdwKedwI7gU87gR3Ap53AjuBTzuBHcCnncCO4FPO4EdwKedwI7gU87gR3Ap53AjuBTzuBHcCnncDeBLY4nCd5ye7o4rS2XPw3pTjStTTi0/eRXdv303KpStPs5YWzYN1593pJzEziOAWJDM7MG9phE2WlXIfU/JfQ8RfJXIcmLWwhhurxOTWjdKKTROSeX4jaLvgEzbV15vQgbDV4Gg7LECJViRN31abkyYYoXBnkozDBMlBHQYJCZKiRGGW//ROVf+defYe1loypy0XPHDolwXiVnwgwyQUklSwGGoJbqiK7oPQ6mhcokGCzx0CdGnyozqfpbtu/K/aTvkBAuorlzs55gwMqsmMoj5aJHnsWPNsK0VM2/en+E1qaFnnhMi2x5abGnMxZUyM58ZI5iIzuzZ2H70tKPZ+fKg0MGZzOyoveIQct167x45NYyLjGj4IIq5PlSiRmei63oBgsZn2++dLfU9wJbHJ8J3htO6OLPisufhvIcaVqacWn7yK7t++m5VKVoX7eL8lgv28X5LBft4vyWC/bxfksF+3i/JYL9vF+SwX7eL8lgv28X5LBft4vyWC/bxfksF+3i/JYJceI/wA5xWuTgNa+FAlPN/iMxW3U6XW0K+6um/durvTWtK/0YkOuac07Z+XFl3ATHNGBlkEr3KKhyb0liZLT0AjJCiYpH4DGKocDquiSDWXhlhyJIYjthbXe05mPctnDb/vnNIxtS3haWWcFwoGaPFZeXom1CQwVbeXUOO84+K5wwWjMikc2zMiD1MwolyH7wyDFhMpA2W113Lcpm8idyCAhMuJmG27quB6QXuAOSNQicu2ysp51My3XRTsZdYimMZzZcX7mfksQQKzWsS1brEGbmsIkqVJHuQrkFwpLsmBJhk4csSSaWmqhRiM+JJUikmlxaYW+3HlcHiLjqbQ9TgPtSEaFOtvIpvWymitTat6aqpTdWtFUmmuog+nYmmuog+nYmmuog+nYmmuog+nYmmuog+nYmmuog+nYmmuog+nYmmuog+nYmmuog+nYmmuog+nYmmuog+nYklHJEXjcNEh6ItmvHYdjr1pahMrruQ8qqdLidyqJrXfSlU1/o2WKzAytzFDqCXXaxejyY82NSQxNhy4suI7HnijAcnFhGAJwXKhlgZqBALipkQhDjSG889u3M/IcW6yqLsv5hbU1xO7PNI8Z2j0Uc7Y1ngrOnPDI7lK1TBcuBTLyVLblUfacWhVmv2TeOd9rZa2VdYITMbh2AJtfKW2htpWQGsyy4USKKtWCLBiYMWscemjLnCqqjaNW6ljFbezX2lJ06dmHPmXSaLhoqjVxO3hc0W1Ak6Q5EAwbmu1bdwFIieZajy4sSEDoHDMJGfvHZfzVJMXflw9fj20QzMo1aA3TaZi7G349t/AHkEbGZqHdtErfDt3jHR9/LrbDNsT9CJ736qfbadn66ti4hngXHOW7Hculd+R7ozDEtyGLmq9SSwMpDtsYmo1LNW6uJeXr3vVpT6kMuSIvK8NEhLi2a8eZHjr1pacZXXch5VU6XE7lUTWu+lKprCC9PO9RxCC9PO9RxCC9PO9RxCC9PO9RxCC9PO9RxGGNx5XNcRcdmWh6nAhyJCNCnZryKb1sporU2remqqU3VrRVP0P9s8v/APd5w4MCohs0iY6HDySERgoWaHNJeIODB7ryJc9EBlaXZi4rLqYrSkuP1QitK/VI5Tm+X/mODx+HwJTEn8ris6tXB0fmJ06tX8d2mtw9p9zxcPafc8XD2n3PFw9p9zxcPafc8Geb5TmP5f4dwOJx4r8b83nntOnja/y1atOn+G/VT9DmBcjF62bs9StnuNlu2MFqtaaGlGrqNKuF8qpXxZsmh26pDNIraeVq3EZVWupa8Zs5q2zfmzgJCCB9gApo5dnXMxapu57iAJW/MjuFLejSSN3F494QBrr0G6hHBhcATJdJkCX7dvYTl7lfl6JWZui6DK3asRWKutRYcKFDitSCBc0XISIooECFRZhc4XmQhQqFLny2GHPox/pH7i2U0sVKq2iIGTMFwI5acdt10he0QUwZlCHrSiMx35Xxx284w9MRCVzpA+SusRF6xb5y3u1D7cUg3HkjyYgvAUloxbVyBpzbJAHcYSSqkckNmNJVTUzMiOyxsyDNk/qDuX8XZ6sLahs3NjattO8j1wByd95cWzPFRagbYhiLYuAdcUytulL8rQLccwIKeMPW8+uZRTFZMGbb1jWBYdtyCBIhMdgW/a1o2lbQ1T8mTIdXWKMCggYmGpa1V5eEPgxq/lMtbqCFgtlzNrbyzENbNw1sVKCiq2pEnHJLkq34D0eHGQHYtc1YFvt8jEaaizLemiHtEgU5Fi/UO5/n+b/3fK8LleW/8aRxOJzH/DTo/wBWr7tvd29sxb3dvbMW93b2zFvd29sxb3dvbMW93b2zFvd29sxb3dvbMW93b2zFvd29sxb3dvbMW93b2zFvd29sxb3dvbMW93b2zFvd29swG5Tm+Y/mPiPH4fAivyfyuRZ1auDo/MTp1av47tNfsXbGs3LXL8ZSeYJOIVJnz5ch5EQRb1vjG60kGbkuEm9GFAxMb8WZOktUWtiOl+Qy/dOxN9FKQlwrgsfZ9t+e3C2gNqkFEkUm27c+ZRqkaQ1b1nmHW45iGxVPwb4fQau1rfuWXUXm21ZgXL7LLL4Kxb9n2fb7C2BgYYwtx5SEKecflzJkyW/JIlSpGTLKmSsuaWLTZpKbKlPfU9CZ5HnuLzjj7ermeT4fD4MaRv3cuvXq0bt6d2rfXTNC9RO9OxNC9RO9OxNC9RO9OxNC9RO9OxNC9RO9OxNC9RO9OxNC9RO9OxNC9RO9OxNC9RO9OxNC9RO9OxNC9RO9OxNC9RO9OxNC9RO9OxNC9RO9OxNC9RO9OxNC9RO9OxJGOR4vNcREd6Wt6vHhyI6NCXYTKK7lvJqrU4ncmiq031pRNfsZ4WNlPaWV2YB7Mq9QV/W0UuoJe9ysDBYnL958NCaegTo1tw5d9MzIRlp+DMZuSjKor6KvUT9K/s4sssoQ0001si5aNtNNNpohttttGWlEoQhNKJQhNKJSmlKUpSlKUxtS5e7TxYwRtt7LchYOVNvZWt2gOhxi6Llhk49v27bzZlZeTIDPxHpLclcNMCQhtbaZCkq2zLt2rWc8MyB902ANPv3S9BsQaPm3hLJF0R7pNm0hT96JuQUwbt+2FMW6MatQYhmaZouNUX+5v//EADkRAAICAAQDBAUJCQAAAAAAAAECAxESITFBAARREzJAYWBxc6HwFCIzgZGxssHRIzRCQ1NUcJPx/9oACAECAQE/APROGAyhnLrHGh+ezHTK8hufKx+XHNxRRrAYgadCxJJtu6QSCaBz2A93i+b+i5P2I/DH4vm/ouT9iPwx8GGQRCYr+zJoNY6kaXYFirr7x4ppHcKGYkIKUH+EZCh9g4MkhQRlzgBsLeQPxtp/gqMIzqHbAhPzmq6Gv2nQdLvhuYhRisfLRMgNBnGJmA3xHMXtrXuHMxoFimjXAsoNpdhWGteWo6CtBdeJ5WJZplRu7RYgZE1tfnvWdXXXhuacMVijjjAJAURgtrVMSDZ65DPjnMfYcv2gAe2xAACjQyoZA1r58FHVVZlYK3dJBAPqO/iEdo2DocLLmCPj7RweclOYWJX/AKixjH67JOf1cPM7oqMbCFiOpLGySdTZPDzySIkbm1Tu5AbUL60Mh+vpiIL5cz9ouTVg3OYGt5HO6ru534sRIeVabPGJcAzyqlOnXPxa/uD+3H4V4/LxQmIgMFCi+PFvdAV024TmGSF4QqkPeZ1FgA+vQV0PX0eRGdgiAszGgB8adToBx8jN4DPAJNMGLO+mmvlXEkbxMUcUw942IO4PXxPLTJD2rEHGYysZABAY9cxWdZja+MyazJJ9ZJP3knjnv5CsbkWECTc3lr53iP13v4mNGkcIgtjp+ZPQDc8FouUsJUvMaFz3IzuFG5H/AEju8MzOxZiWZjZJ3+PdoPE8rOkBdmQsWAUEEAgb5+eWnTjtOT/t5P8AYf14laFsPZRtHV4sTFr0rUmqz4nljlEeCIR4VokVnpllVgVkTnnt6T//xAA2EQACAQEFAwkGBwEAAAAAAAABAhEDABIhMUFAYYETMlFgcZGhsfAiQlJywdIjNENTcHOS4f/aAAgBAwEBPwDqm9QIQoBZjko+p08bUXdjUDnFWiBEDOQO7ftdHn1vnPm210efW+c+bWvqWKT7Q0/7l67dqCqpJAgsZO82urevQLxwnX+CmJCkqJaMBv8AWNhTciWquGOMKYA3QM+EWpM156bGShwPSN/hvx2mq5RCRngBunX1rYUVIl2ZiRJN7DhutRjlal0ysYHiLBlJIBBIzAOW0EBgQRIOYsKCZS5HwlvZ7hHnYIqsWAgkAbgBAEDhZaaqzMBBbPzw49ceU/EFO6cRN7TKe7SZzwjay7Csqe6Unjjrw2s/mF/r+7ayk1BUnJbsd+PjZqYZ1eTK6aYeWePT1eJCgkmAMzbl9RTqFfijx6I42Vg4DKZB9QdpqIXugRdDAsDOIHRh2+FsAOgDuAFqH6hHNLm72Y/SPQ2lmCgschaHrYtKU9F95uid2vlPOsAFAAEAZDaatNqgUAgAEkzqdO7Hvtdr/uL/AJH22QOJvsGyiBEdOgtTRkvXnLSZGeGeOJzOvZ1n/9k="},{value:s.PresetListType.ORDER_LIST_1,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.ORDER_LIST_2,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.ORDER_LIST_3,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.ORDER_LIST_4,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.ORDER_LIST_5,img:"data:image/jpeg;base64,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"}],Kr=o=>P.jsx(Rs,{...o,options:jr}),zr=[{value:s.PresetListType.BULLET_LIST,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.BULLET_LIST_1,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.BULLET_LIST_2,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.BULLET_LIST_3,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.BULLET_LIST_4,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.BULLET_LIST_5,img:"data:image/jpeg;base64,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"}],Yr=o=>P.jsx(Rs,{...o,options:zr}),Ms=`${Os}_ORDER_LIST_TYPE_COMPONENT`,xs=`${Os}_BULLET_LIST_TYPE_COMPONENT`,qr=o=>{const e=Object.keys(s.PAGE_SIZE).find(n=>{const{width:i,height:a}=s.PAGE_SIZE[n];return o.width===i&&o.height===a});return e!=null?e:"A4"};function Jr(o){const{hooks:t}=o,i=I.useDependency(s.IUniverInstanceService).getCurrentUnitOfType(s.UniverInstanceType.UNIVER_DOC).getDocumentStyle(),a=I.useDependency(s.LocaleService),[r,c]=U.useState(()=>{var d,u,m,h,g;return{paperSize:qr(i.pageSize),orientation:(d=i.pageOrient)!=null?d:s.PageOrientType.PORTRAIT,margins:{top:(u=i.marginTop)!=null?u:0,bottom:(m=i.marginBottom)!=null?m:0,left:(h=i.marginLeft)!=null?h:0,right:(g=i.marginRight)!=null?g:0}}});U.useEffect(()=>{t.beforeClose=()=>r,t.beforeConfirm=()=>r},[r]);const l=d=>{c(u=>({...u,paperSize:d}))},A=(d,u)=>{c(m=>({...m,margins:{...m.margins,[d]:u||0}}))};return P.jsxs("div",{className:"univer-flex univer-flex-col univer-gap-4",children:[P.jsxs("div",{className:"univer-flex univer-flex-col univer-gap-2",children:[P.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-900 dark:!univer-text-white",children:a.t("page-settings.paper-size")}),P.jsx(J.Select,{value:r.paperSize,onChange:l,options:s.PAPER_TYPES.map(d=>({label:a.t(`page-settings.page-size.${d.toLocaleLowerCase()}`),value:d}))})]}),P.jsxs("div",{className:"univer-flex univer-flex-col univer-gap-2",children:[P.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-900 dark:!univer-text-white",children:a.t("page-settings.custom-paper-size")}),P.jsxs("div",{className:"univer-flex univer-flex-col univer-gap-2.5",children:[P.jsxs("div",{className:"univer-flex univer-gap-2.5",children:[P.jsxs("div",{className:"univer-flex univer-flex-1 univer-flex-col univer-gap-2",children:[P.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-500",children:a.t("page-settings.top")}),P.jsx(J.InputNumber,{value:r.margins.top,onChange:d=>A("top",d)})]}),P.jsxs("div",{className:"univer-flex univer-flex-1 univer-flex-col univer-gap-2",children:[P.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-500",children:a.t("page-settings.bottom")}),P.jsx(J.InputNumber,{value:r.margins.bottom,onChange:d=>A("bottom",d)})]})]}),P.jsxs("div",{className:"univer-flex univer-gap-2.5",children:[P.jsxs("div",{className:"univer-flex univer-flex-1 univer-flex-col univer-gap-2",children:[P.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-500",children:a.t("page-settings.left")}),P.jsx(J.InputNumber,{value:r.margins.left,onChange:d=>A("left",d)})]}),P.jsxs("div",{className:"univer-flex univer-flex-1 univer-flex-col univer-gap-2",children:[P.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-500",children:a.t("page-settings.right")}),P.jsx(J.InputNumber,{value:r.margins.right,onChange:d=>A("right",d)})]})]})]})]})]})}const Qo="docs.component.page-setting",Ds={id:"docs.command.page-setup",type:s.CommandType.COMMAND,handler:(o,t)=>{if(!t)return!1;const e=o.get(s.IUniverInstanceService),n=o.get(s.ICommandService),i=e.getCurrentUnitOfType(s.UniverInstanceType.UNIVER_DOC);if(!i)return!1;const{marginLeft:a,marginRight:r,marginBottom:c,marginTop:l,pageOrient:A,pageSize:d}=t,u=s.JSONX.getInstance(),m=i.getDocumentStyle(),{marginBottom:h,marginLeft:g,marginRight:p,marginTop:f,pageOrient:S,pageSize:E}=m,C=[];if(h===void 0){const v=u.insertOp(["documentStyle","marginBottom"],c);v&&C.push(v)}else{const v=u.replaceOp(["documentStyle","marginBottom"],h,c);v&&C.push(v)}if(g===void 0){const v=u.insertOp(["documentStyle","marginLeft"],a);v&&C.push(v)}else{const v=u.replaceOp(["documentStyle","marginLeft"],g,a);v&&C.push(v)}if(p===void 0){const v=u.insertOp(["documentStyle","marginRight"],r);v&&C.push(v)}else{const v=u.replaceOp(["documentStyle","marginRight"],p,r);v&&C.push(v)}if(f===void 0){const v=u.insertOp(["documentStyle","marginTop"],l);v&&C.push(v)}else{const v=u.replaceOp(["documentStyle","marginTop"],f,l);v&&C.push(v)}if(E===void 0){const v=u.insertOp(["documentStyle","pageSize"],d);v&&C.push(v)}else{const v=u.replaceOp(["documentStyle","pageSize"],E,d);v&&C.push(v)}if(S===void 0){const v=u.insertOp(["documentStyle","pageOrient"],A);v&&C.push(v)}else{const v=u.replaceOp(["documentStyle","pageOrient"],S,A);v&&C.push(v)}const T={id:D.RichTextEditingMutation.id,params:{unitId:i.getUnitId(),actions:[],textRanges:void 0}};return T.params.actions=C.reduce((v,O)=>s.JSONX.compose(v,O),null),!!n.syncExecuteCommand(T.id,T.params)}},Fo={id:"docs.operation.open-page-setting",type:s.CommandType.OPERATION,handler:o=>{const t=o.get(I.IConfirmService),e=o.get(s.ICommandService),n=o.get(s.LocaleService),i=t.open({id:Qo,title:{label:n.t("page-settings.document-setting")},children:{label:Qo},width:528,onClose:()=>{i.dispose()},onConfirm:a=>{if(i.dispose(),!a)return;const r=s.PAGE_SIZE[a.paperSize];e.executeCommand(Ds.id,{pageOrient:a.orientation,marginTop:a.margins.top,marginBottom:a.margins.bottom,marginLeft:a.margins.left,marginRight:a.margins.right,pageSize:r})},confirmText:n.t("page-settings.confirm"),cancelText:n.t("page-settings.cancel")});return!0}};function Zr(o){const t=o.get(s.IUniverInstanceService),e=o.get(_.IRenderManagerService);return new L.Observable(n=>{const i=t.focused$.subscribe(a=>{if(a==null||t.getUnitType(a)!==s.UniverInstanceType.UNIVER_DOC)return n.next(!0);const c=e.getRenderById(a);if(c==null)return n.next(!0);c.with(D.DocSkeletonManagerService).getViewModel().editAreaChange$.subscribe(A=>{n.next(A===_.DocumentEditArea.HEADER||A===_.DocumentEditArea.FOOTER)})});return()=>i.unsubscribe()})}function $r(o){const t=o.get(s.IUniverInstanceService),e=o.get(s.ICommandService);return new L.Observable(n=>{const i=e.onCommandExecuted(l=>{if(l.id===D.RichTextEditingMutation.id){const{unitId:A}=l.params,d=t.getUnit(A);if(d==null){n.next(!0);return}const{documentStyle:u}=d.getSnapshot();n.next((u==null?void 0:u.documentFlavor)!==s.DocumentFlavor.TRADITIONAL)}}),a=t.focused$.subscribe(l=>{if(l==null)return n.next(!0);const A=t.getUniverDocInstance(l),d=A==null?void 0:A.getSnapshot().documentStyle.documentFlavor;n.next(d!==s.DocumentFlavor.TRADITIONAL)}),r=t.getCurrentUniverDocInstance();if(r==null)return n.next(!0);const c=r==null?void 0:r.getSnapshot().documentStyle.documentFlavor;return n.next(c!==s.DocumentFlavor.TRADITIONAL),()=>{i.dispose(),a.unsubscribe()}})}function ec(o){const t=o.get(D.DocSelectionManagerService),e=o.get(s.IUniverInstanceService);return new L.Observable(n=>{const i=t.textSelection$.subscribe(a=>{if(a==null){n.next(!0);return}const{textRanges:r}=a;if(r.length!==1){n.next(!0);return}const c=r[0],{collapsed:l,startNodePosition:A,startOffset:d}=c;if(!l||d==null){n.next(!0);return}const u=e.getCurrentUniverDocInstance();if(u==null){n.next(!0);return}const m=re(o,u.getUnitId());if(m==null){n.next(!0);return}if(m.getViewModel().getCustomRangeRaw(d)){n.next(!0);return}if(A!=null){const{path:p}=A;if(p.indexOf("cells")!==-1){n.next(!0);return}}n.next(!1)});return()=>i.unsubscribe()})}function te(o){const t=o.get(D.DocSelectionManagerService);return new L.Observable(e=>{const n=t.textSelection$.subscribe(i=>{if(i==null){e.next(!0);return}const{textRanges:a,rectRanges:r}=i;if(a.length===0&&r.length===0){e.next(!0);return}e.next(!1)});return()=>n.unsubscribe()})}function tc(o){const t=o.get(s.ICommandService);return{id:Be.id,type:I.MenuItemType.BUTTON,icon:"BoldIcon",title:"Set bold",tooltip:"toolbar.bold",activated$:new L.Observable(e=>{const n=()=>{var c;const a=me(o);if(a==null){e.next(!1);return}const r=(c=a.ts)==null?void 0:c.bl;e.next(r===s.BooleanNumber.TRUE)},i=t.onCommandExecuted(a=>{const r=a.id;(r===D.SetTextSelectionsOperation.id||r===ye.id)&&n()});return n(),i.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function nc(o){const t=o.get(s.ICommandService);return{id:_e.id,type:I.MenuItemType.BUTTON,icon:"ItalicIcon",title:"Set italic",tooltip:"toolbar.italic",activated$:new L.Observable(e=>{const n=()=>{var c;const a=me(o);if(a==null){e.next(!1);return}const r=(c=a.ts)==null?void 0:c.it;e.next(r===s.BooleanNumber.TRUE)},i=t.onCommandExecuted(a=>{const r=a.id;(r===D.SetTextSelectionsOperation.id||r===ye.id)&&n()});return n(),i.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function oc(o){const t=o.get(s.ICommandService);return{id:Ne.id,type:I.MenuItemType.BUTTON,icon:"UnderlineIcon",title:"Set underline",tooltip:"toolbar.underline",activated$:new L.Observable(e=>{const n=()=>{var c;const a=me(o);if(a==null){e.next(!1);return}const r=(c=a.ts)==null?void 0:c.ul;e.next((r==null?void 0:r.s)===s.BooleanNumber.TRUE)},i=t.onCommandExecuted(a=>{const r=a.id;(r===D.SetTextSelectionsOperation.id||r===ye.id)&&n()});return n(),i.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function ic(o){const t=o.get(s.ICommandService);return{id:Pe.id,type:I.MenuItemType.BUTTON,icon:"StrikethroughIcon",title:"Set strike through",tooltip:"toolbar.strikethrough",activated$:new L.Observable(e=>{const n=()=>{var c;const a=me(o);if(a==null){e.next(!1);return}const r=(c=a.ts)==null?void 0:c.st;e.next((r==null?void 0:r.s)===s.BooleanNumber.TRUE)},i=t.onCommandExecuted(a=>{const r=a.id;(r===D.SetTextSelectionsOperation.id||r===ye.id)&&n()});return n(),i.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function sc(o){const t=o.get(s.ICommandService);return{id:Ee.id,type:I.MenuItemType.BUTTON,icon:"SubscriptIcon",tooltip:"toolbar.subscript",activated$:new L.Observable(e=>{const n=()=>{var c;const a=me(o);if(a==null){e.next(!1);return}const r=(c=a.ts)==null?void 0:c.va;e.next(r===s.BaselineOffset.SUBSCRIPT)},i=t.onCommandExecuted(a=>{const r=a.id;(r===D.SetTextSelectionsOperation.id||r===ye.id)&&n()});return n(),i.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function ac(o){const t=o.get(s.ICommandService);return{id:Ue.id,type:I.MenuItemType.BUTTON,icon:"SuperscriptIcon",tooltip:"toolbar.superscript",activated$:new L.Observable(e=>{const n=()=>{var c;const a=me(o);if(a==null){e.next(!1);return}const r=(c=a.ts)==null?void 0:c.va;e.next(r===s.BaselineOffset.SUPERSCRIPT)},i=t.onCommandExecuted(a=>{const r=a.id;(r===D.SetTextSelectionsOperation.id||r===ye.id)&&n()});return n(),i.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function rc(o){const t=o.get(s.ICommandService);return{id:we.id,tooltip:"toolbar.font",type:I.MenuItemType.SELECTOR,label:I.FONT_FAMILY_COMPONENT,selections:[{label:{name:I.FONT_FAMILY_ITEM_COMPONENT,hoverable:!1,selectable:!1,props:{id:we.id}}}],value$:new L.Observable(e=>{const n=s.DEFAULT_STYLES.ff,i=()=>{var l;const r=me(o);if(r==null){e.next(n);return}const c=(l=r.ts)==null?void 0:l.ff;e.next(c!=null?c:n)},a=t.onCommandExecuted(r=>{const c=r.id;(c===D.SetTextSelectionsOperation.id||c===we.id)&&i()});return i(),a.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function cc(o){const t=o.get(s.ICommandService);return{id:he.id,type:I.MenuItemType.SELECTOR,tooltip:"toolbar.fontSize",label:{name:I.FONT_SIZE_COMPONENT,props:{min:1,max:400}},selections:I.FONT_SIZE_LIST,value$:new L.Observable(e=>{const n=s.DEFAULT_STYLES.fs,i=()=>{var l;const r=me(o);if(r==null){e.next(n);return}const c=(l=r.ts)==null?void 0:l.fs;e.next(c!=null?c:n)},a=t.onCommandExecuted(r=>{const c=r.id;(c===D.SetTextSelectionsOperation.id||c===he.id)&&i()});return i(),a.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function lc(o){const t=o.get(s.ICommandService);return{id:ce.id,type:I.MenuItemType.SELECTOR,tooltip:"toolbar.heading.tooltip",label:{name:I.COMMON_LABEL_COMPONENT,props:{selections:I.HEADING_LIST}},selections:I.HEADING_LIST.map(e=>({label:{name:I.HEADING_ITEM_COMPONENT,props:{value:e.value,text:e.label}},value:e.value})),value$:new L.Observable(e=>{const n=s.NamedStyleType.NORMAL_TEXT,i=()=>{var l,A;const r=Xe(o);if(r==null){e.next(n);return}const c=(A=(l=r.paragraphStyle)==null?void 0:l.namedStyleType)!=null?A:n;e.next(c)},a=t.onCommandExecuted(r=>{const c=r.id;(c===D.SetTextSelectionsOperation.id||c===he.id)&&i()});return i(),a.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function dc(o){const t=o.get(s.ICommandService),e=o.get(s.ThemeService);return{id:Ce.id,icon:"FontColorDoubleIcon",tooltip:"toolbar.textColor.main",type:I.MenuItemType.BUTTON_SELECTOR,selections:[{label:{name:I.COLOR_PICKER_COMPONENT,hoverable:!1,selectable:!1},value$:new L.Observable(n=>{const i=s.DEFAULT_STYLES.cl.rgb,a=()=>{var A,d;const c=me(o);if(!c){n.next(i);return}const l=(d=(A=c.ts)==null?void 0:A.cl)==null?void 0:d.rgb;n.next(l!=null?l:i)},r=t.onCommandExecuted(c=>{c.id===Ce.id&&a()});return a(),r.dispose})}],value$:new L.Observable(n=>{const i=e.getColorFromTheme("gray.900"),a=t.onCommandExecuted(r=>{if(r.id===Ce.id){const c=r.params.value;n.next(c!=null?c:i)}});return n.next(i),a.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function Ac(o){return{id:wo.id,type:I.MenuItemType.BUTTON,icon:"HeaderFooterIcon",tooltip:"toolbar.headerFooter",hidden$:L.combineLatest(I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY),$r(o),(t,e)=>t||e)}}const uc="GridIcon",Bs="doc.menu.table";function hc(o){return{id:Bs,type:I.MenuItemType.SUBITEMS,icon:uc,tooltip:"toolbar.table.main",disabled$:ec(o),hidden$:L.combineLatest(I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY),Zr(o),(t,e)=>t||e)}}function gc(o){return{id:ln.id,title:"toolbar.table.insert",type:I.MenuItemType.BUTTON,hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function mc(o){const t=o.get(s.ICommandService);return{id:Et.id,type:I.MenuItemType.BUTTON,icon:"LeftJustifyingIcon",tooltip:"toolbar.alignLeft",disabled$:te(o),activated$:new L.Observable(e=>{const n=t.onCommandExecuted(i=>{var r;const a=i.id;if(a===D.SetTextSelectionsOperation.id||a===ge.id){const c=Xe(o);if(c==null)return;const l=(r=c.paragraphStyle)==null?void 0:r.horizontalAlign;e.next(l===s.HorizontalAlign.LEFT)}});return e.next(!1),n.dispose}),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY)}}function pc(o){const t=o.get(s.ICommandService);return{id:Ct.id,type:I.MenuItemType.BUTTON,icon:"HorizontallyIcon",tooltip:"toolbar.alignCenter",activated$:new L.Observable(e=>{const n=t.onCommandExecuted(i=>{var r;const a=i.id;if(a===D.SetTextSelectionsOperation.id||a===ge.id){const c=Xe(o);if(c==null)return;const l=(r=c.paragraphStyle)==null?void 0:r.horizontalAlign;e.next(l===s.HorizontalAlign.CENTER)}});return e.next(!1),n.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY)}}function fc(o){const t=o.get(s.ICommandService);return{id:Tt.id,type:I.MenuItemType.BUTTON,icon:"RightJustifyingIcon",tooltip:"toolbar.alignRight",activated$:new L.Observable(e=>{const n=t.onCommandExecuted(i=>{var r;const a=i.id;if(a===D.SetTextSelectionsOperation.id||a===ge.id){const c=Xe(o);if(c==null)return;const l=(r=c.paragraphStyle)==null?void 0:r.horizontalAlign;e.next(l===s.HorizontalAlign.RIGHT)}});return e.next(!1),n.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY)}}function Sc(o){const t=o.get(s.ICommandService);return{id:yt.id,type:I.MenuItemType.BUTTON,icon:"AlignTextBothIcon",tooltip:"toolbar.alignJustify",activated$:new L.Observable(e=>{const n=t.onCommandExecuted(i=>{var r;const a=i.id;if(a===D.SetTextSelectionsOperation.id||a===ge.id){const c=Xe(o);if(c==null)return;const l=(r=c.paragraphStyle)==null?void 0:r.horizontalAlign;e.next(l===s.HorizontalAlign.JUSTIFIED)}});return e.next(!1),n.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY)}}function Ic(o){return{id:pt.id,type:I.MenuItemType.BUTTON,icon:"ReduceIcon",tooltip:"toolbar.horizontalLine",disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY)}}const xt=o=>new L.Observable(t=>{const e=o.get(s.IUniverInstanceService),n=o.get(D.DocSelectionManagerService);let i;const a=e.focused$.subscribe(r=>{if(i==null||i.unsubscribe(),r==null)return;const c=e.getUniverDocInstance(r);c!=null&&(i=n.textSelection$.subscribe(()=>{var d,u,m,h,g;const l=n.getDocRanges(),A=(d=l.find(p=>p.isActive))!=null?d:l[0];if(A){const p=c.getSelfOrHeaderFooterModel(A==null?void 0:A.segmentId),f=s.BuildTextUtils.range.getParagraphsInRange(A,(m=(u=p.getBody())==null?void 0:u.paragraphs)!=null?m:[],(g=(h=p.getBody())==null?void 0:h.dataStream)!=null?g:"");let S;if(f.every(E=>{var C;return S||(S=(C=E.bullet)==null?void 0:C.listType),E.bullet&&E.bullet.listType===S})){t.next(S);return}}t.next(void 0)}))});return()=>{a.unsubscribe(),i==null||i.unsubscribe()}});function _s(o){return{id:tt.id,type:I.MenuItemType.BUTTON_SELECTOR,slot:!0,selections:[{label:{name:Ms,hoverable:!1,selectable:!1},value$:xt(o)}],icon:"OrderIcon",tooltip:"toolbar.order",hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC),disabled$:te(o),activated$:xt(o).pipe(L.map(t=>!!(t&&t.indexOf("ORDER_LIST")===0)))}}function Ns(o){return{id:et.id,type:I.MenuItemType.BUTTON_SELECTOR,slot:!0,selections:[{label:{name:xs,hoverable:!1,selectable:!1},value$:xt(o)}],icon:"UnorderIcon",tooltip:"toolbar.unorder",disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC),activated$:xt(o).pipe(L.map(t=>!!(t&&t.indexOf("BULLET_LIST")===0)))}}function Ps(o){return{id:vt.id,type:I.MenuItemType.BUTTON,icon:"TodoListDoubleIcon",tooltip:"toolbar.checklist",disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC),activated$:xt(o).pipe(L.map(t=>!!(t&&t.indexOf("CHECK_LIST")===0)))}}function vc(o){const t=o.get(s.ICommandService),e=o.get(s.IUniverInstanceService);return{id:Rt.id,type:I.MenuItemType.BUTTON,icon:"KeyboardIcon",tooltip:"toolbar.documentFlavor",hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY),activated$:new L.Observable(n=>{var r;const i=t.onCommandExecuted(c=>{var l;if(c.id===D.RichTextEditingMutation.id){const A=e.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);n.next(((l=A==null?void 0:A.getSnapshot())==null?void 0:l.documentStyle.documentFlavor)===s.DocumentFlavor.MODERN)}}),a=e.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);return n.next(((r=a==null?void 0:a.getSnapshot())==null?void 0:r.documentStyle.documentFlavor)===s.DocumentFlavor.MODERN),()=>i.dispose()})}}function Ec(o){return{id:Ze.id,type:I.MenuItemType.BUTTON,title:"toolbar.resetColor",icon:"NoColorDoubleIcon"}}function Cc(o){const t=o.get(s.ICommandService),e=o.get(s.ThemeService);return{id:Te.id,tooltip:"toolbar.fillColor.main",type:I.MenuItemType.BUTTON_SELECTOR,icon:"PaintBucketDoubleIcon",selections:[{label:{name:I.COLOR_PICKER_COMPONENT,hoverable:!1,selectable:!1},value$:new L.Observable(n=>{const i=s.DEFAULT_STYLES.bg.rgb,a=()=>{var A,d;const c=me(o);if(!c){n.next(i);return}const l=(d=(A=c.ts)==null?void 0:A.bg)==null?void 0:d.rgb;n.next(l!=null?l:i)},r=t.onCommandExecuted(c=>{c.id===Te.id&&a()});return a(),r.dispose})}],value$:new L.Observable(n=>{const i=e.getColorFromTheme("primary.600"),a=t.onCommandExecuted(r=>{if(r.id===Te.id){const c=r.params.value;n.next(c!=null?c:i)}});return n.next(i),a.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function me(o){var g,p,f,S;const t=o.get(s.IUniverInstanceService),e=o.get(D.DocSelectionManagerService),n=o.get(ve),i=t.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),a=e.getDocRanges(),r=(g=a.find(E=>E.isActive))!=null?g:a[0],c=n.getDefaultStyle(),l=(p=n.getStyleCache())!=null?p:{},A=Xe(o),d=(f=A==null?void 0:A.paragraphStyle)!=null&&f.namedStyleType?s.NAMED_STYLE_MAP[(S=A==null?void 0:A.paragraphStyle)==null?void 0:S.namedStyleType]:null;if(i==null||r==null)return{ts:{...c,...d,...l}};const{segmentId:u}=r,m=i.getSelfOrHeaderFooterModel(u).getBody();if(m==null)return{ts:{...c,...d,...l}};const h=Fi(m,r,{});return s.Tools.deleteNull(h),{ts:{...c,...d,...h,...l}}}function Xe(o){var d,u;const t=o.get(s.IUniverInstanceService),e=o.get(D.DocSelectionManagerService),n=t.getCurrentUniverDocInstance(),i=e.getDocRanges(),a=(d=i.find(m=>m.isActive))!=null?d:i[0];if(n==null||a==null)return;const{startOffset:r,segmentId:c}=a,l=(u=n.getSelfOrHeaderFooterModel(c).getBody())==null?void 0:u.paragraphs;if(l==null)return;let A=-1;for(const m of l){const{startIndex:h}=m;if(r>A&&r<=h)return m;A=h}return null}function Tc(o){return{id:Fo.id,type:I.MenuItemType.BUTTON,icon:"DocumentSettingIcon",tooltip:"toolbar.pageSetup",hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}const yc={[s.NamedStyleType.HEADING_1]:co,[s.NamedStyleType.HEADING_2]:lo,[s.NamedStyleType.HEADING_3]:Ao,[s.NamedStyleType.HEADING_4]:uo,[s.NamedStyleType.HEADING_5]:ho,[s.NamedStyleType.NORMAL_TEXT]:qt,[s.NamedStyleType.TITLE]:ji,[s.NamedStyleType.SUBTITLE]:Ki,[s.NamedStyleType.NAMED_STYLE_TYPE_UNSPECIFIED]:qt},Us={[s.NamedStyleType.HEADING_1]:{key:"H1Icon",component:cs},[s.NamedStyleType.HEADING_2]:{key:"H2Icon",component:ls},[s.NamedStyleType.HEADING_3]:{key:"H3Icon",component:ds},[s.NamedStyleType.HEADING_4]:{key:"H4Icon",component:As},[s.NamedStyleType.HEADING_5]:{key:"H5Icon",component:us},[s.NamedStyleType.NORMAL_TEXT]:{key:"TextTypeIcon",component:Mt},[s.NamedStyleType.TITLE]:{key:"TextTypeIcon",component:Mt},[s.NamedStyleType.SUBTITLE]:{key:"TextTypeIcon",component:Mt},[s.NamedStyleType.NAMED_STYLE_TYPE_UNSPECIFIED]:{key:"TextTypeIcon",component:Mt}},Qe=o=>t=>{const e=t.get(s.ICommandService),n=t.get(I.ComponentManager),i=Us[o];return n.get(i.key)||n.register(i.key,i.component),{id:yc[o].id,type:I.MenuItemType.BUTTON,icon:i.key,tooltip:"toolbar.heading.tooltip",disabled$:te(t),hidden$:I.getMenuHiddenObservable(t,s.UniverInstanceType.UNIVER_DOC),activated$:new L.Observable(a=>{const r=s.NamedStyleType.NORMAL_TEXT,c=()=>{var u,m;const A=Xe(t);if(A==null){a.next(r===o);return}const d=(m=(u=A.paragraphStyle)==null?void 0:u.namedStyleType)!=null?m:r;a.next(d===o)},l=e.onCommandExecuted(A=>{const d=A.id;(d===D.SetTextSelectionsOperation.id||d===he.id)&&c()});return c(),l.dispose})}},bc=Qe(s.NamedStyleType.HEADING_1),Oc=Qe(s.NamedStyleType.HEADING_2),Rc=Qe(s.NamedStyleType.HEADING_3),Mc=Qe(s.NamedStyleType.HEADING_4),xc=Qe(s.NamedStyleType.HEADING_5),Dc=Qe(s.NamedStyleType.NORMAL_TEXT);Qe(s.NamedStyleType.TITLE),Qe(s.NamedStyleType.SUBTITLE);const Bc=o=>({id:Kn.id,type:I.MenuItemType.BUTTON,icon:"CopyDoubleIcon",title:"rightClick.copy"}),_c=o=>({id:zn.id,type:I.MenuItemType.BUTTON,icon:"CutIcon",title:"rightClick.cut"}),Nc=o=>({id:kn.id,type:I.MenuItemType.BUTTON,icon:"DeleteIcon",title:"rightClick.delete"}),Pc=o=>({id:io.id,type:I.MenuItemType.BUTTON,icon:"UnorderIcon",title:"rightClick.bulletList"}),Uc=o=>({id:so.id,type:I.MenuItemType.BUTTON,icon:"OrderIcon",title:"rightClick.orderList"}),wc=o=>({id:ao.id,type:I.MenuItemType.BUTTON,icon:"TodoListDoubleIcon",title:"rightClick.checkList"}),Lc=o=>({id:Yn.id,type:I.MenuItemType.BUTTON,icon:"ReduceIcon",title:"toolbar.horizontalLine"}),ws="doc.menu.insert-bellow";function Qc(o){return{id:ws,type:I.MenuItemType.SUBITEMS,title:"rightClick.insertBellow"}}const Ho=4;var Fc=Object.getOwnPropertyDescriptor,Hc=(o,t,e,n)=>{for(var i=n>1?void 0:n?Fc(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},un=(o,t)=>(e,n)=>t(e,n,o);function Ls(o,t){const e=Qs(o.left,o.top,t),n=Qs(o.right,o.bottom,t);return{left:e.x,top:e.y,right:n.x,bottom:n.y}}function Qs(o,t,e){const{scaleX:n,scaleY:i}=e.getAncestorScale(),a=e.getViewport(ae.VIEW_MAIN);if(!a)return{x:o,y:t};const{viewportScrollX:r,viewportScrollY:c}=a,l=(o-r)*n,A=(t-c)*i;return{x:l,y:A}}function Fs(o,t,e){const{scaleX:n,scaleY:i}=e.getAncestorScale(),a=e.getViewport(ae.VIEW_MAIN);if(!a)return{x:o,y:t};const{viewportScrollX:r,viewportScrollY:c}=a,l=o/n+r,A=t/i+c;return{x:l,y:A}}const hn=(o,t)=>{const{scene:e,mainComponent:n,engine:i}=t,a=t.with(D.DocSkeletonManagerService).getSkeleton(),r=a.findNodePositionByCharIndex(o.startOffset,!0,o.segmentId,o.segmentPage),c=o.collapsed?o.startOffset:o.endOffset-1,l=a.findNodePositionByCharIndex(c,!0,o.segmentId,o.segmentPage),A=n;if(!l||!r)return;const d=A.getOffsetConfig(),{docsLeft:u,docsTop:m}=d,h=i.getCanvasElement(),g=h.getBoundingClientRect(),p=_.pxToNum(h.style.width),{top:f,left:S,width:E}=g,C=E/p,{scaleX:T,scaleY:R}=e.getAncestorScale(),v=new be(d,a),{borderBoxPointGroup:O}=v.getRangePointData(r,l);return $t(O).map(N=>Ls(N,e)).map(N=>({left:(N.left+u*T)*C+S,right:(N.right+u*T)*C+S,top:(N.top+m*R)*C+f,bottom:(N.bottom+m*R)*C+f}))};y.DocCanvasPopManagerService=class extends s.Disposable{constructor(t,e,n,i){super(),this._globalPopupManagerService=t,this._renderManagerService=e,this._univerInstanceService=n,this._commandService=i}_createRectPositionObserver(t,e){const n=()=>{const{scene:l,engine:A}=e,d=typeof t=="function"?t():t,u=A.getCanvasElement(),m=u.getBoundingClientRect(),h=_.pxToNum(u.style.width),g=Ls(d,l),{top:p,left:f,width:S}=m,E=S/h;return{left:g.left*E+f,right:g.right*E+f,top:g.top*E+p,bottom:g.bottom*E+p}},i=n(),a=new L.BehaviorSubject(i),r=new s.DisposableCollection;r.add(this._commandService.onCommandExecuted(l=>{if(l.id===ue.id||l.id===D.RichTextEditingMutation.id){const A=n();A&&a.next(A)}}));const c=e.scene.getViewport(ae.VIEW_MAIN);return c&&r.add(c.onScrollAfter$.subscribeEvent(()=>{a.next(n())})),{position:i,position$:a,disposable:r}}_createObjectPositionObserver(t,e){const n=()=>{const{left:i,top:a,width:r,height:c}=t;return{left:i,right:i+r,top:a,bottom:a+c}};return this._createRectPositionObserver(n,e)}_createRangePositionObserver(t,e){var c;const n=(c=hn(t,e))!=null?c:[],i=new L.BehaviorSubject(n),a=new s.DisposableCollection;a.add(this._commandService.onCommandExecuted(l=>{if((l.id===ue.id||l.id===D.RichTextEditingMutation.id)&&l.params.unitId===e.unitId){const d=hn(t,e);d&&i.next(d)}}));const r=e.scene.getViewport(ae.VIEW_MAIN);return r&&a.add(r.onScrollAfter$.subscribeEvent(()=>{const l=hn(t,e);l&&i.next(l)})),{positions:n,positions$:i,disposable:a}}attachPopupToRect(t,e,n){const i=this._renderManagerService.getRenderById(n);if(!i)throw new Error(`Current render not found, unitId: ${n}`);const{position:a,position$:r,disposable:c}=this._createRectPositionObserver(t,i),l=this._globalPopupManagerService.addPopup({...e,unitId:n,subUnitId:"default",anchorRect:a,anchorRect$:r,canvasElement:i.engine.getCanvasElement()});return{dispose:()=>{this._globalPopupManagerService.removePopup(l),r.complete(),c.dispose()},canDispose:()=>this._globalPopupManagerService.activePopupId!==l}}attachPopupToObject(t,e,n){const i=this._renderManagerService.getRenderById(n);if(!i)throw new Error(`Current render not found, unitId: ${n}`);const{position:a,position$:r,disposable:c}=this._createObjectPositionObserver(t,i),l=this._globalPopupManagerService.addPopup({...e,unitId:n,subUnitId:"default",anchorRect:a,anchorRect$:r,canvasElement:i.engine.getCanvasElement()});return{dispose:()=>{this._globalPopupManagerService.removePopup(l),r.complete(),c.dispose()},canDispose:()=>this._globalPopupManagerService.activePopupId!==l}}attachPopupToRange(t,e,n){if(!this._univerInstanceService.getUnit(n))throw new Error(`Document not found, unitId: ${n}`);const{direction:a="top",multipleDirection:r}=e,c=this._renderManagerService.getRenderById(n);if(!c)throw new Error(`Current render not found, unitId: ${n}`);const{positions:l,positions$:A,disposable:d}=this._createRangePositionObserver(t,c),u=A.pipe(L.map(h=>a.includes("top")?h[0]:h[h.length-1])),m=this._globalPopupManagerService.addPopup({...e,unitId:n,subUnitId:"default",anchorRect:a.includes("top")?l[0]:l[l.length-1],anchorRect$:u,excludeRects:l,excludeRects$:A,direction:["top","bottom","horizontal"].some(h=>a.includes(h))&&l.length>1&&r!=null?r:a,canvasElement:c.engine.getCanvasElement()});return{dispose:()=>{this._globalPopupManagerService.removePopup(m),A.complete(),d.dispose()},canDispose:()=>this._globalPopupManagerService.activePopupId!==m}}},y.DocCanvasPopManagerService=Hc([un(0,s.Inject(I.ICanvasPopupService)),un(1,_.IRenderManagerService),un(2,s.IUniverInstanceService),un(3,s.ICommandService)],y.DocCanvasPopManagerService);var kc=Object.getOwnPropertyDescriptor,Vc=(o,t,e,n)=>{for(var i=n>1?void 0:n?kc(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Wc=(o,t)=>(e,n)=>t(e,n,o);const Gc=(o,t,e,n)=>{var m,h,g,p,f;const i=e.findNodePositionByCharIndex(o.startOffset,!0,o.segmentId,n),a=e.getSkeletonData();let r=o.endOffset-1;if(o.segmentId){const S=(f=Array.from((h=(m=a==null?void 0:a.skeFooters.get(o.segmentId))==null?void 0:m.values())!=null?h:[])[0])!=null?f:Array.from((p=(g=a==null?void 0:a.skeHeaders.get(o.segmentId))==null?void 0:g.values())!=null?p:[])[0];S&&(r=Math.min(S.ed,r))}const c=e.findNodePositionByCharIndex(r,!0,o.segmentId,n);if(!c||!i)return;const l=t.getOffsetConfig(),A=new be(l,e),{borderBoxPointGroup:d}=A.getRangePointData(i,c);return $t(d).map(S=>({top:S.top+l.docsTop-Ho,bottom:S.bottom+l.docsTop+Ho,left:S.left+l.docsLeft,right:S.right+l.docsLeft}))},Hs=(o,t,e,n)=>{const i=[];for(const a of o){const r=a.top;for(const c of a.columns){const l=c.left,A=a.colCount===1?n:c.width;let d=null;for(const u of c.lines){const m=u.paragraphIndex;if(u.paragraphStart){d&&(i.push(d),d=null);const h={top:t+r+u.top,left:e+l,right:e+l+A,bottom:t+r+u.top+u.lineHeight};d={paragraphStart:u.st,paragraphEnd:m,startIndex:m,rect:h,fisrtLine:{top:t+r+u.top+u.marginTop+u.paddingTop,left:e+l,right:e+l+A,bottom:t+r+u.top+u.marginTop+u.paddingTop+u.contentHeight}}}else d&&d.startIndex===m&&(d.rect.bottom=t+r+u.top+u.lineHeight)}d&&i.push(d)}}return i},Xc=(o,t,e,n=-1)=>{const i=e.findPositionByGlyph(o,n);if(!i)return;const a=t.getOffsetConfig(),r={...i,isBack:!0},c=new be(a,e),{borderBoxPointGroup:l}=c.getRangePointData(r,r),d=$t(l)[0];return{top:d.top+a.docsTop,bottom:d.bottom+a.docsTop,left:d.left+a.docsLeft,right:d.left+a.docsLeft+o.width}};function je(o,t,e){const{left:n,right:i,top:a,bottom:r}=e;return o>=n&&o<=i&&t>=a&&t<=r}y.DocEventManagerService=class extends s.Disposable{constructor(e,n){super();B(this,"_hoverCustomRanges$",new L.BehaviorSubject([]));B(this,"hoverCustomRanges$",this._hoverCustomRanges$.pipe(L.distinctUntilChanged((e,n)=>e.length===n.length&&e.every((i,a)=>n[a].range.rangeId===i.range.rangeId&&n[a].segmentId===i.segmentId&&n[a].segmentPageIndex===i.segmentPageIndex&&n[a].range.startIndex===i.range.startIndex))));B(this,"_clickCustomRanges$",new L.Subject);B(this,"clickCustomRanges$",this._clickCustomRanges$.asObservable());B(this,"_hoverBullet$",new L.Subject);B(this,"hoverBullet$",this._hoverBullet$.pipe(L.distinctUntilChanged((e,n)=>(e==null?void 0:e.paragraph.startIndex)===(n==null?void 0:n.paragraph.startIndex)&&(e==null?void 0:e.segmentId)===(n==null?void 0:n.segmentId)&&(e==null?void 0:e.segmentPageIndex)===(n==null?void 0:n.segmentPageIndex))));B(this,"_clickBullet$",new L.Subject);B(this,"clickBullets$",this._clickBullet$.asObservable());B(this,"_hoverParagraph$",new L.BehaviorSubject(null));B(this,"hoverParagraph$",this._hoverParagraph$.pipe(L.distinctUntilChanged((e,n)=>(e==null?void 0:e.startIndex)===(n==null?void 0:n.startIndex)&&(e==null?void 0:e.segmentId)===(n==null?void 0:n.segmentId)&&(e==null?void 0:e.pageIndex)===(n==null?void 0:n.pageIndex))));B(this,"hoverParagraphRealTime$",this._hoverParagraph$.asObservable());B(this,"_hoverParagraphLeft$",new L.BehaviorSubject(null));B(this,"hoverParagraphLeft$",this._hoverParagraphLeft$.pipe(L.distinctUntilChanged((e,n)=>(e==null?void 0:e.startIndex)===(n==null?void 0:n.startIndex)&&(e==null?void 0:e.segmentId)===(n==null?void 0:n.segmentId)&&(e==null?void 0:e.pageIndex)===(n==null?void 0:n.pageIndex))));B(this,"hoverParagraphLeftRealTime$",this._hoverParagraphLeft$.asObservable());B(this,"_hoverTableCell$",new L.Subject);B(this,"hoverTableCell$",this._hoverTableCell$.pipe(L.distinctUntilChanged((e,n)=>(e==null?void 0:e.rowIndex)===(n==null?void 0:n.rowIndex)&&(e==null?void 0:e.colIndex)===(n==null?void 0:n.colIndex)&&(e==null?void 0:e.tableId)===(n==null?void 0:n.tableId)&&(e==null?void 0:e.pageIndex)===(n==null?void 0:n.pageIndex))));B(this,"hoverTableCellRealTime$",this._hoverTableCell$.asObservable());B(this,"_hoverTable$",new L.Subject);B(this,"hoverTable$",this._hoverTable$.pipe(L.distinctUntilChanged((e,n)=>(e==null?void 0:e.tableId)===(n==null?void 0:n.tableId)&&(e==null?void 0:e.pageIndex)===(n==null?void 0:n.pageIndex))));B(this,"hoverTableRealTime$",this._hoverTable$.asObservable());B(this,"_customRangeDirty",!0);B(this,"_bulletDirty",!0);B(this,"_paragraphDirty",!0);B(this,"_customRangeBounds",[]);B(this,"_bulletBounds",[]);B(this,"_paragraphBounds",new Map);B(this,"_paragraphLeftBounds",[]);B(this,"_tableParagraphBounds",new Map);B(this,"_segmentParagraphBounds",new Map);B(this,"_tableCellBounds",new Map);B(this,"_tableBounds",new Map);this._context=e,this._docSkeletonManagerService=n,this._initResetDirty(),this._initEvents(),this._initPointer()}get hoverParagraph(){return this._hoverParagraph$.value}get hoverParagraphLeft(){return this._hoverParagraphLeft$.value}get _skeleton(){return this._docSkeletonManagerService.getSkeleton()}get _documents(){return this._context.mainComponent}dispose(){this._hoverCustomRanges$.complete(),this._clickCustomRanges$.complete(),super.dispose()}_initPointer(){let e=_.CURSOR_TYPE.TEXT;this.disposeWithMe(this.hoverCustomRanges$.subscribe(n=>{n.length?(e=this._context.scene.getCursor(),this._context.scene.setCursor(_.CURSOR_TYPE.POINTER)):this._context.scene.setCursor(e)}))}_initResetDirty(){this.disposeWithMe(this._skeleton.dirty$.subscribe(()=>{this._customRangeDirty=!0,this._bulletDirty=!0,this._paragraphDirty=!0})),this.disposeWithMe(s.fromEventSubject(this._context.engine.onTransformChange$).pipe(L.filter(e=>e.type===_.TRANSFORM_CHANGE_OBSERVABLE_TYPE.resize)).subscribe(()=>{this._customRangeDirty=!0,this._bulletDirty=!0,this._paragraphDirty=!0}))}_initEvents(){this.disposeWithMe(s.fromEventSubject(this._context.scene.onPointerMove$).pipe(L.throttleTime(30)).subscribe(i=>{if(i.buttons>0){this._hoverBullet$.next(null),this._hoverCustomRanges$.next([]),this._hoverParagraph$.next(null),this._hoverParagraphLeft$.next(null),this._hoverTableCell$.next(null),this._hoverTable$.next(null);return}const{x:a,y:r}=Fs(i.offsetX,i.offsetY,this._context.scene);this._hoverCustomRanges$.next(this._calcActiveRanges({x:a,y:r})),this._hoverParagraph$.next(this._calcActiveParagraph({x:a,y:r})),this._hoverParagraphLeft$.next(this._calcActiveParagraphLeft({x:a,y:r})),this._hoverBullet$.next(this._calcActiveBullet({x:a,y:r}))})),this.disposeWithMe(this._context.scene.onPointerEnter$.subscribeEvent(()=>{this._hoverBullet$.next(null),this._hoverCustomRanges$.next([])}));const e=s.fromEventSubject(this._context.mainComponent.onPointerDown$),n=s.fromEventSubject(this._context.scene.onPointerUp$);this.disposeWithMe(e.pipe(L.switchMap(i=>n.pipe(L.take(1),L.map(a=>({down:i,up:a})))),L.filter(({down:i,up:a})=>i.target===a.target&&a.timeStamp-i.timeStamp<300)).subscribe(({down:i})=>{if(i.button===2)return;const a=Fs(i.offsetX,i.offsetY,this._context.scene),r=this._calcActiveRanges(a);r.length&&this._clickCustomRanges$.next(r.pop());const c=this._calcActiveBullet(a);c&&this._clickBullet$.next(c)}))}_buildCustomRangeBoundsBySegment(e,n=-1){var r,c,l;const i=(l=(c=(r=this._context.unit.getSelfOrHeaderFooterModel(e))==null?void 0:r.getBody())==null?void 0:c.customRanges)!=null?l:[],a=[];return i.forEach(A=>{const d={startOffset:A.startIndex,endOffset:A.endIndex+1,segmentId:e},u=Gc(d,this._documents,this._skeleton,n);if(!u)return null;a.push({customRange:A,rects:u,segmentId:e,segmentPageIndex:n})}),a}_buildCustomRangeBounds(){var n;if(!this._customRangeDirty)return;this._customRangeDirty=!1;const e=[];e.push(...this._buildCustomRangeBoundsBySegment()),(n=this._skeleton.getSkeletonData())==null||n.pages.forEach((i,a)=>{i.headerId&&e.push(...this._buildCustomRangeBoundsBySegment(i.headerId,a)),i.footerId&&e.push(...this._buildCustomRangeBoundsBySegment(i.footerId,a))}),this._customRangeBounds=e}_calcActiveRanges(e){this._buildCustomRangeBounds();const{x:n,y:i}=e;return this._customRangeBounds.filter(r=>r.rects.some(c=>je(n,i,c))).map(r=>({segmentId:r.segmentId,range:r.customRange,segmentPageIndex:r.segmentPageIndex,rects:r.rects}))}_buildBulletBoundsBySegment(e,n=-1){var A,d,u,m,h;const i=(A=this._context.unit.getSelfOrHeaderFooterModel(e))==null?void 0:A.getBody(),a=((d=i==null?void 0:i.paragraphs)!=null?d:[]).filter(g=>g.bullet&&g.bullet.listType.indexOf("CHECK_LIST")===0),r=[],c=this._skeleton.getSkeletonData();if(!c)return r;const l=g=>{var p,f,S;for(const E of g){const C=[...E.sections];if(E.skeTables){const T=Array.from(E.skeTables.values());C.push(...T.map(R=>R.rows.map(v=>v.cells.map(O=>O.sections))).flat(4))}for(const T of C)for(const R of T.columns)for(const v of R.lines)if(v.paragraphStart){const O=a.find(M=>M.startIndex===v.paragraphIndex);if(O){const M=v,b=(S=(f=(p=M==null?void 0:M.divides)==null?void 0:p[0])==null?void 0:f.glyphGroup)==null?void 0:S[0];if(!b)continue;const N=Xc(b,this._documents,this._skeleton,n);if(!N)continue;r.push({rect:N,segmentId:e,segmentPageIndex:n,paragraph:O})}}}return r};if(e){const g=(h=(u=c.skeFooters.get(e))==null?void 0:u.values())!=null?h:(m=c.skeHeaders.get(e))==null?void 0:m.values();return g?l(Array.from(g)):r}return l(c.pages)}_buildBulletBounds(){var e;this._bulletDirty&&(this._bulletDirty=!1,this._bulletBounds=[],this._bulletBounds.push(...this._buildBulletBoundsBySegment()),(e=this._skeleton.getSkeletonData())==null||e.pages.forEach((n,i)=>{n.headerId&&this._bulletBounds.push(...this._buildBulletBoundsBySegment(n.headerId,i)),n.footerId&&this._bulletBounds.push(...this._buildBulletBoundsBySegment(n.footerId,i))}))}_calcActiveBullet(e){this._buildBulletBounds();const{x:n,y:i}=e;return this._bulletBounds.find(r=>je(n,i,r.rect))}_buildParagraphBoundsBySegment(e){var c,l,A;const n=this._skeleton.getSkeletonData(),a=this._documents.getOffsetConfig();if(!n)return null;const r=d=>{const u=new Map,m=(h,g,p,f)=>{Hs(h.sections,p,f,h.pageWidth-h.marginLeft-h.marginRight).forEach(E=>{if(!u.has(E.startIndex))u.set(E.startIndex,{rect:E.rect,paragraphStart:E.paragraphStart,paragraphEnd:E.paragraphEnd,startIndex:E.startIndex,rects:[E.rect],pageIndex:g,segmentId:e,firstLine:E.fisrtLine});else{const C=u.get(E.startIndex);C&&(C.rect.bottom=E.rect.bottom,C.rects.push(E.rect))}})};for(let h=0;h<d.length;h++){const g=d[h],p=((g.pageHeight===1/0?0:g.pageHeight)+a.pageMarginTop)*h+g.marginTop+a.docsTop,f=g.marginLeft+a.docsLeft;g.skeTables&&Array.from(g.skeTables.values()).forEach(S=>{const E=S.left+f,C=S.top+p,T=E+S.width,R=C+S.height,v=S.tableId;this._tableBounds.set(v,{rect:{left:E,top:C,right:T,bottom:R},pageIndex:h,tableId:v}),S.rows.forEach((O,M)=>{O.cells.forEach((b,N)=>{const x=((g.pageHeight===1/0?0:g.pageHeight)+a.pageMarginTop)*h+S.top+a.docsTop+g.marginTop+O.top+b.marginTop,w=S.left+a.docsLeft+g.marginLeft+b.left+b.marginLeft,F=Hs(b.sections,x,w,b.pageWidth-b.marginLeft-b.marginRight);let V=this._tableParagraphBounds.get(v);V||(V=[],this._tableParagraphBounds.set(v,V)),V.push(...F.map(Q=>({rect:Q.rect,paragraphStart:Q.paragraphStart,paragraphEnd:Q.paragraphEnd,startIndex:Q.startIndex,pageIndex:h,segmentId:e,rowIndex:M,colIndex:N,firstLine:Q.fisrtLine,tableId:v})));let H=this._tableCellBounds.get(v);H||(H=[],this._tableCellBounds.set(v,H)),H.push({rect:{top:x,left:w,right:w+b.pageWidth-b.marginLeft-b.marginRight,bottom:x+b.pageHeight-b.marginBottom-b.marginTop},pageIndex:h,rowIndex:M,colIndex:N,tableId:v})})})}),m(g,h,p,f)}return u};if(e){const d=(A=(c=n.skeFooters.get(e))==null?void 0:c.values())!=null?A:(l=n.skeHeaders.get(e))==null?void 0:l.values();return d?r(Array.from(d)):null}return r(n.pages)}_buildParagraphBounds(){var n,i;if(!this._paragraphDirty)return;this._paragraphDirty=!1,this._tableParagraphBounds=new Map,this._tableCellBounds=new Map,this._tableBounds=new Map,this._paragraphBounds=(n=this._buildParagraphBoundsBySegment())!=null?n:new Map,this._paragraphLeftBounds=Array.from(this._paragraphBounds.values()).map(a=>({...a,rect:{left:a.rect.left-60,right:a.rect.left,top:a.rect.top,bottom:a.rect.bottom}}));const e=a=>{var r;this._segmentParagraphBounds.set(a,(r=this._buildParagraphBoundsBySegment(a))!=null?r:new Map)};(i=this._skeleton.getSkeletonData())==null||i.pages.forEach(a=>{a.headerId&&e(a.headerId),a.footerId&&e(a.footerId)})}_calcActiveParagraph(e){var c,l;this._buildParagraphBounds();const{x:n,y:i}=e,a=Array.from(this._tableBounds.values()).find(A=>je(n,i,A.rect));if(this._hoverTable$.next(a),a){const A=(c=this._tableCellBounds.get(a.tableId))==null?void 0:c.find(m=>je(n,i,m.rect));if(this._hoverTableCell$.next(A),!A)return null;const d=(l=this._tableParagraphBounds.get(A.tableId))==null?void 0:l.filter(m=>m.colIndex===A.colIndex&&m.rowIndex===A.rowIndex),u=d==null?void 0:d.find(m=>je(n,i,m.rect));return u&&{...u,rects:[u.rect]}}let r;for(const A of this._paragraphBounds){const d=A[1];if(d.rects.some(u=>je(n,i,u))){r=d;break}}return r}_calcActiveParagraphLeft(e){this._buildParagraphBounds();const{x:n,y:i}=e;return this._paragraphLeftBounds.find(r=>je(n,i,r.rect))}get paragraphBounds(){return this._buildParagraphBounds(),this._paragraphBounds}findParagraphBoundByIndex(e){this._buildParagraphBounds();const n=this._paragraphBounds.get(e);return n||Array.from(this._tableParagraphBounds.values()).flat().find(a=>a.startIndex===e)}},y.DocEventManagerService=Vc([Wc(1,s.Inject(D.DocSkeletonManagerService))],y.DocEventManagerService);const jc=[he.id,Be.id,_e.id,Ne.id,Pe.id,Ee.id,Ue.id,Ce.id,Te.id];function Kc(o){const{avaliableMenus:t=jc}=o,e=I.useDependency(I.IMenuManagerService),[n,i]=U.useState([]);return U.useEffect(()=>{function a(){const c=e.getFlatMenuByPositionKey(I.MenuManagerPosition.RIBBON),l=[];for(const A of t){const d=c.find(u=>u.key===A);d&&l.push(d)}i(l)}a();const r=e.menuChanged$.subscribe(a);return()=>{r.unsubscribe()}},[e]),P.jsx("div",{className:J.clsx("univer-box-border univer-flex univer-rounded univer-bg-white univer-py-1.5 univer-shadow-sm dark:!univer-border-gray-700 dark:!univer-bg-gray-900",J.borderClassName),children:n.map(a=>a.item&&P.jsx("div",{className:"univer-flex univer-flex-nowrap univer-gap-2 univer-px-2",children:P.jsx(I.ToolbarItem,{...a.item},a.key)},a.key))})}var zc=Object.getOwnPropertyDescriptor,Yc=(o,t,e,n)=>{for(var i=n>1?void 0:n?zc(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Dt=(o,t)=>(e,n)=>t(e,n,o);const ks="univer.doc.float-menu";function qc(o,t){if(o==null||t==null)return!1;const{glyph:e,...n}=o,{glyph:i,...a}=t;return s.deepCompare(n,a)}const Jc=[s.DataStreamTreeTokenType.CUSTOM_BLOCK,s.DataStreamTreeTokenType.PARAGRAPH];let gn=class extends s.Disposable{constructor(t,e,n,i,a,r){super();B(this,"_floatMenu",null);this._context=t,this._docSelectionManagerService=e,this._docCanvasPopManagerService=n,this._componentManager=i,this._univerInstanceService=a,this._docSelectionRenderService=r,!s.isInternalEditorID(this._context.unitId)&&(this._registerFloatMenu(),this._initSelectionChange(),this.disposeWithMe(()=>{this._hideFloatMenu()}))}get floatMenu(){return this._floatMenu}_registerFloatMenu(){this.disposeWithMe(this._componentManager.register(ks,Kc))}_initSelectionChange(){this.disposeWithMe(this._docSelectionRenderService.onSelectionStart$.subscribe(()=>{this._hideFloatMenu()})),this.disposeWithMe(this._docSelectionManagerService.textSelection$.subscribe(t=>{var a,r;const{unitId:e,textRanges:n}=t;if(e!==this._context.unitId)return;const i=n.length>0&&n.find(c=>!c.collapsed);if(i){if(i.startOffset===((a=this._floatMenu)==null?void 0:a.start)&&i.endOffset===((r=this._floatMenu)==null?void 0:r.end))return;this._hideFloatMenu(),this._showFloatMenu(e,i);return}this._hideFloatMenu()}))}_hideFloatMenu(){var t;(t=this._floatMenu)==null||t.disposable.dispose(),this._floatMenu=null}_showFloatMenu(t,e){var r,c,l;const n=this._univerInstanceService.getUnit(t,s.UniverInstanceType.UNIVER_DOC);if(!n||n.getDisabled())return;const i=(r=n.getBody())==null?void 0:r.dataStream[e.startOffset];if(e.endOffset-e.startOffset===1&&i&&Jc.includes(i))return;const a=(l=(c=n.getBody())==null?void 0:c.customRanges)==null?void 0:l.filter(A=>A.wholeEntity);if(!(a!=null&&a.some(A=>A.startIndex===e.startOffset&&A.endIndex===e.endOffset-1)))return this._floatMenu={disposable:this._docCanvasPopManagerService.attachPopupToRange(e,{componentKey:ks,direction:e.direction==="backward"||qc(e.startNodePosition,e.endNodePosition)?"top-center":"bottom-center",offset:[0,4]},t),start:e.startOffset,end:e.endOffset},s.toDisposable(()=>this._hideFloatMenu())}};gn=Yc([Dt(1,s.Inject(D.DocSelectionManagerService)),Dt(2,s.Inject(y.DocCanvasPopManagerService)),Dt(3,s.Inject(I.ComponentManager)),Dt(4,s.Inject(s.IUniverInstanceService)),Dt(5,s.Inject(y.DocSelectionRenderService))],gn);var Zc=Object.getOwnPropertyDescriptor,$c=(o,t,e,n)=>{for(var i=n>1?void 0:n?Zc(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Bt=(o,t)=>(e,n)=>t(e,n,o);let mn=class extends s.Disposable{constructor(t,e,n,i,a,r){super();B(this,"_paragrahMenu",null);this._context=t,this._docSelectionManagerService=e,this._docEventManagerService=n,this._docPopupManagerService=i,this._docSkeletonManagerService=a,this._floatMenuService=r,!s.isInternalEditorID(this._context.unitId)&&this._init()}get activeParagraph(){var t;return(t=this._paragrahMenu)==null?void 0:t.paragraph}_isCursorInActiveParagraph(){if(!this._paragrahMenu)return!1;const t=this._docSelectionManagerService.getActiveTextRange();return!(!(t!=null&&t.collapsed)||!(t!=null&&t.collapsed)||t.startOffset<this._paragrahMenu.paragraph.paragraphStart||t.startOffset>this._paragrahMenu.paragraph.paragraphEnd)}setParagraphMenuActive(t){this._paragrahMenu&&(this._paragrahMenu.active=t,this._isCursorInActiveParagraph()||this._docSelectionManagerService.replaceDocRanges([{startOffset:this._paragrahMenu.paragraph.paragraphStart,endOffset:this._paragrahMenu.paragraph.paragraphStart}]))}_init(){const t=n=>{var a;if(this._docSkeletonManagerService.getViewModel().getEditArea()===_.DocumentEditArea.BODY&&!this._floatMenuService.floatMenu&&!this._context.unit.getDisabled()){if((a=this._paragrahMenu)!=null&&a.active)return;if(n){this.showParagraphMenu(n);return}}this.hideParagraphMenu(!0)};this.disposeWithMe(L.combineLatest([this._docEventManagerService.hoverParagraphRealTime$,this._docEventManagerService.hoverParagraphLeft$]).pipe(L.throttleTime(16)).subscribe(([n,i])=>{const a=n!=null?n:i;t(a)}));let e=0;this.disposeWithMe(this._context.scene.getViewport(ae.VIEW_MAIN).onScrollAfter$.subscribeEvent(n=>{e!==n.scrollY&&(e=n.scrollY,this.hideParagraphMenu(!0))})),this.disposeWithMe(this._docEventManagerService.clickCustomRanges$.subscribe(()=>{this.hideParagraphMenu(!0)}))}showParagraphMenu(t){var l,A,d;if(((l=this._paragrahMenu)==null?void 0:l.paragraph.startIndex)===t.startIndex)return;this.hideParagraphMenu(!0);const e=(d=(A=this._context.unit.getBody())==null?void 0:A.dataStream)!=null?d:"",n=t?e.slice(t.paragraphStart,t.paragraphEnd):"";if(n==="\b"||n==="")return;const c=this._docPopupManagerService.attachPopupToRect(t.firstLine,{componentKey:"doc.paragraph.menu",direction:"left-center",onClickOutside:()=>{this._docSelectionManagerService.textSelection$.pipe(L.first()).subscribe(()=>{this._isCursorInActiveParagraph()||this.hideParagraphMenu(!0)})},zIndex:101},this._context.unitId);this._paragrahMenu={paragraph:t,disposable:c,active:!1}}hideParagraphMenu(t=!1){this._paragrahMenu&&(this._paragrahMenu.disposable.canDispose()||t)&&(this._paragrahMenu.disposable.dispose(),this._paragrahMenu=null)}};mn=$c([Bt(1,s.Inject(D.DocSelectionManagerService)),Bt(2,s.Inject(y.DocEventManagerService)),Bt(3,s.Inject(y.DocCanvasPopManagerService)),Bt(4,s.Inject(D.DocSkeletonManagerService)),Bt(5,s.Inject(gn))],mn);const el=({popup:o})=>{var v,O;const[t,e]=U.useState(!1),n=U.useRef(null),i=I.useDependency(s.ICommandService),a=I.useDependency(I.ILayoutService),r=U.useRef(null),c=U.useRef(!1),l=I.useDependency(_.IRenderManagerService),A=I.useDependency(s.IUniverInstanceService),d=l.getRenderById(o.unitId),u=A.getUnit(o.unitId,s.UniverInstanceType.UNIVER_DOC),m=d==null?void 0:d.with(mn),h=d==null?void 0:d.with(y.DocEventManagerService),g=I.useObservable(h==null?void 0:h.hoverParagraph$),p=I.useObservable(h==null?void 0:h.hoverParagraphLeft$),f=(v=g!=null?g:p)==null?void 0:v.startIndex,S=U.useMemo(()=>{var M,b;return(b=(M=u==null?void 0:u.getBody())==null?void 0:M.paragraphs)==null?void 0:b.find(N=>N.startIndex===f)},[u,g]),E=(O=S==null?void 0:S.paragraphStyle)==null?void 0:O.namedStyleType,C=Us[E!=null?E:s.NamedStyleType.NORMAL_TEXT],T=U.useMemo(()=>new L.BehaviorSubject({left:0,right:0,top:0,bottom:0}),[]),R=()=>{e(!1),m==null||m.hideParagraphMenu(!0)};return P.jsxs(P.Fragment,{children:[P.jsxs("div",{"data-u-comp":"paragraph-menu",ref:r,className:J.clsx("univer-mr-1 univer-inline-flex univer-h-7 univer-cursor-pointer univer-items-center univer-gap-1 univer-rounded-full univer-px-2.5 univer-py-0 hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-600",J.borderClassName,{"univer-bg-gray-100 dark:!univer-bg-gray-700":t,"univer-bg-white dark:!univer-bg-gray-700":!t}),onMouseEnter:M=>{var N,x,w,F,V,H;(N=o.onPointerEnter)==null||N.call(o,M),c.current=!0;const b=(x=r.current)==null?void 0:x.getBoundingClientRect();T.next({left:((w=b==null?void 0:b.left)!=null?w:0)-4,right:(F=b==null?void 0:b.right)!=null?F:0,top:(V=b==null?void 0:b.top)!=null?V:0,bottom:(H=b==null?void 0:b.bottom)!=null?H:0})},onMouseLeave:()=>{c.current=!1},onClick:()=>{e(!0),m==null||m.setParagraphMenuActive(!0)},children:[P.jsx(C.component,{className:"univer-size-4 univer-text-gray-900 dark:!univer-text-white"}),P.jsx(rs,{className:"univer-size-3 univer-text-gray-600 dark:!univer-text-gray-200"})]}),t&&P.jsx(I.RectPopup,{portal:!0,mask:!0,maskZIndex:100,anchorRect$:T,direction:"left",onMaskClick:R,children:P.jsx("section",{ref:n,onMouseEnter:M=>{var b;(b=o.onPointerEnter)==null||b.call(o,M),c.current=!0},onMouseLeave:()=>{c.current=!1},children:P.jsx(I.DesktopMenu,{style:{width:212},menuType:I.ContextMenuPosition.PARAGRAPH,onOptionSelect:M=>{const{label:b,commandId:N,value:x}=M;i&&i.executeCommand(N!=null?N:b,{value:x}),a.focus(),R()}})})})]})};function ee(o){return o.getContextValue(s.FOCUSING_DOC)&&o.getContextValue(s.FOCUSING_UNIVER_EDITOR)&&!o.getContextValue(s.FOCUSING_COMMON_DRAWINGS)}function tl(o){return o.getContextValue(s.FOCUSING_DOC)&&o.getContextValue(s.FOCUSING_UNIVER_EDITOR)&&!o.getContextValue(s.FOCUSING_COMMON_DRAWINGS)}const nl={id:ke.id,binding:I.KeyCode.TAB,preconditions:ee},ol={id:ke.id,binding:I.KeyCode.TAB|I.MetaKeys.SHIFT,preconditions:ee,staticParameters:{shift:!0}},il={id:Be.id,binding:I.KeyCode.B|I.MetaKeys.CTRL_COMMAND,preconditions:ee},sl={id:_e.id,binding:I.KeyCode.I|I.MetaKeys.CTRL_COMMAND,preconditions:ee},al={id:Ne.id,binding:I.KeyCode.U|I.MetaKeys.CTRL_COMMAND,preconditions:ee},rl={id:Pe.id,binding:I.KeyCode.X|I.MetaKeys.SHIFT|I.MetaKeys.CTRL_COMMAND,preconditions:ee},cl={id:Ee.id,binding:I.KeyCode.COMMA|I.MetaKeys.CTRL_COMMAND,preconditions:ee},ll={id:Ue.id,binding:I.KeyCode.PERIOD|I.MetaKeys.CTRL_COMMAND,preconditions:ee},dl={id:Et.id,binding:I.KeyCode.L|I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT,preconditions:ee},Al={id:Tt.id,binding:I.KeyCode.R|I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT,preconditions:ee},ul={id:Ct.id,binding:I.KeyCode.E|I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT,preconditions:ee},hl={id:yt.id,binding:I.KeyCode.J|I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT,preconditions:ee},gl={id:tt.id,binding:I.KeyCode.Digit7|I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT,preconditions:ee},ml={id:et.id,binding:I.KeyCode.Digit8|I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT,preconditions:ee},pn="docs-ui.config",Vs={layout:{docContainerConfig:ii,toolbarConfig:oi}},pl=[50,80,100,130,150,170,200,400],fl=[10,400];function Sl(){const o=I.useDependency(s.ICommandService),t=I.useDependency(s.IUniverInstanceService),e=U.useMemo(()=>t.getCurrentTypeOfUnit$(s.UniverInstanceType.UNIVER_DOC),[]),n=I.useObservable(e),i=U.useCallback(()=>{var A,d;if(!n)return 100;const l=((d=(A=n.getSettings())==null?void 0:A.zoomRatio)!=null?d:1)*100;return Math.round(l)},[n]),[a,r]=U.useState(()=>i());U.useEffect(()=>(r(i()),o.onCommandExecuted(A=>{if(A.id===ue.id){const d=i();r(d)}}).dispose),[o,i]);function c(l){if(r(l),n==null)return;const A=l/100;o.executeCommand(ue.id,{unitId:n.getUnitId(),zoomRatio:A})}return P.jsx(I.Slider,{min:fl[0],value:a,shortcuts:pl,onChange:c})}function Il(o){return P.jsx("section",{className:"univer-flex univer-flex-shrink-0 univer-justify-end",children:P.jsx(Sl,{})})}function vl(){var i,a,r;const o=I.useDependency(s.IUniverInstanceService),t=I.useConfigValue(pn),e=I.useObservable(()=>o.getCurrentTypeOfUnit$(s.UniverInstanceType.UNIVER_SHEET),void 0,void 0,[]),n=(r=(a=(i=t==null?void 0:t.layout)==null?void 0:i.docContainerConfig)==null?void 0:a.footer)!=null?r:!0;return e?null:n&&P.jsxs("div",{className:"univer-box-border univer-flex univer-items-center univer-justify-between univer-px-5 univer-py-1.5",children:[P.jsx("div",{}),P.jsx(Il,{})]})}const El="univer-font-[500] univer-truncate univer-h-[24px] univer-mb-2 univer-leading-[24px] univer-cursor-pointer univer-pr-1 ",Cl="univer-text-base univer-font-semibold",Tl="univer-text-sm univer-font-semibold",yl="univer-text-sm",bl=U.forwardRef((o,t)=>{const{menus:e,onClick:n,className:i,style:a,mode:r,maxHeight:c,activeId:l,open:A,onOpenChange:d,maxWidth:u,wrapperClass:m,wrapperStyle:h,iconClass:g,iconStyle:p}=o,f=r==="side-bar",S=U.useRef(null),E=U.useRef(e);E.current=e;const C=U.useMemo(()=>({scrollTo:T=>{var x;if(!E.current||E.current.findIndex(w=>w.id===T)===-1||!S.current)return;const v=document.getElementById(`univer-side-menu-${T}`);if(!v)return;const O=v.offsetTop,M=S.current.clientHeight,b=S.current.scrollHeight-M,N=Math.max(0,Math.min(O-M/2+v.clientHeight/2,b));(x=S.current)==null||x.scrollTo({behavior:"smooth",top:N})}}),[]);return U.useImperativeHandle(t,()=>C),U.useEffect(()=>{l&&C.scrollTo(l)},[l,C]),P.jsxs("div",{className:J.clsx("univer-relative",m),style:h,children:[P.jsx("div",{onClick:()=>d==null?void 0:d(!A),className:J.clsx("univer-absolute univer-left-5 univer-top-4 univer-z-[100] univer-flex univer-h-8 univer-w-8 univer-cursor-pointer univer-items-center univer-justify-center univer-rounded-full univer-bg-white univer-text-gray-800 univer-shadow-sm dark:!univer-bg-gray-600 dark:!univer-text-gray-200",g),style:p,children:A?P.jsx(gs,{}):P.jsx(is,{})}),P.jsx("div",{className:J.clsx(i,`
                      univer-absolute univer-left-0 univer-top-0 univer-box-border univer-flex univer-min-w-[180px]
                      univer-flex-col univer-px-4 univer-pb-4 univer-pt-14 univer-transition-all univer-duration-300
                    `,{"univer-rounded-r-2xl univer-bg-white univer-shadow univer-backdrop-blur-[10px] dark:!univer-bg-gray-900":f}),style:{...a,transform:A?"translateX(0)":"translateX(-100%)",maxHeight:c,opacity:A?1:0,maxWidth:u!=null?u:r==="side-bar"?320:180,paddingRight:r==="float"?void 0:0},children:P.jsx("div",{ref:S,className:J.clsx("univer-flex-1 univer-overflow-y-auto univer-overflow-x-hidden",J.scrollbarClassName),children:e==null?void 0:e.map(T=>P.jsx("div",{id:`univer-side-menu-${T.id}`,className:J.clsx(El,{[Cl]:T.isTitle,[Tl]:T.level===1,[yl]:T.level>1,"univer-text-gray-500 dark:!univer-text-gray-400":T.id!==l,"univer-text-gray-800 dark:!univer-text-gray-200":T.id===l}),style:{paddingLeft:(T.level-1)*12},onClick:()=>{n==null||n(T)},children:T.text},T.id))})})]})}),Ol=o=>{switch(o){case s.NamedStyleType.HEADING_1:return 1;case s.NamedStyleType.HEADING_2:return 2;case s.NamedStyleType.HEADING_3:return 3;case s.NamedStyleType.HEADING_4:return 4;case s.NamedStyleType.HEADING_5:return 5;case s.NamedStyleType.TITLE:return 1;default:return 1}};function Rl(o,t,e,n){var c,l;if(!o)return;const i=Array.from(o.values()),a=i.findIndex(A=>A.paragraphStart!==A.paragraphEnd&&A.rect.top<n&&A.rect.bottom>e);if(a===-1)return;const r=i==null?void 0:i.findLastIndex(A=>A.paragraphStart!==A.paragraphEnd&&A.rect.top<n&&A.rect.bottom>e);for(let A=a;A<=r;A++){const d=i[A],u=t.get(d.startIndex);if((c=u==null?void 0:u.paragraphStyle)!=null&&c.headingId)return u.paragraphStyle.headingId}for(let A=a;A>=0;A--){const d=i[A],u=t.get(d.startIndex);if((l=u==null?void 0:u.paragraphStyle)!=null&&l.headingId)return u.paragraphStyle.headingId}}const Ws="__title";function Ml(){var t,e,n;const o=I.useConfigValue(pn);return(n=(e=(t=o==null?void 0:o.layout)==null?void 0:t.docContainerConfig)==null?void 0:e.sideMenu)==null||n?P.jsx(xl,{}):null}function xl(){var N,x,w,F,V,H,Q,j,X;const o=I.useDependency(s.ICommandService),t=I.useDependency(s.IUniverInstanceService),e=I.useObservable(U.useMemo(()=>t.getCurrentTypeOfUnit$(s.UniverInstanceType.UNIVER_DOC),[])),n=I.useDependency(_.IRenderManagerService),i=(x=(N=e==null?void 0:e.getBody())==null?void 0:N.dataStream)!=null?x:"",[a,r]=U.useState(0),[c,l]=U.useState(void 0),A=(w=e==null?void 0:e.getUnitId())!=null?w:"",d=n.getRenderById(A),u=e==null?void 0:e.getTitle(),m=d==null?void 0:d.with(y.DocEventManagerService),h=m==null?void 0:m.paragraphBounds,g=(V=(F=d==null?void 0:d.mainComponent)==null?void 0:F.left)!=null?V:0,p=(H=d==null?void 0:d.engine.height)!=null?H:0,f=(Q=d==null?void 0:d.scene.scaleY)!=null?Q:1,S=(X=(j=e==null?void 0:e.getBody())==null?void 0:j.paragraphs)!=null?X:[],E=U.useMemo(()=>{const k=new Map;return S.forEach(W=>{k.set(W.startIndex,W)}),k},[S]);I.useObservable(U.useMemo(()=>d!=null&&d.engine.onTransformChange$?s.fromEventSubject(d==null?void 0:d.engine.onTransformChange$).pipe(L.throttleTime(33)):L.of(null),[d==null?void 0:d.engine.onTransformChange$]));const C=g<180?"float":"side-bar",T=S==null?void 0:S.filter(k=>{var W;return((W=k.paragraphStyle)==null?void 0:W.namedStyleType)!==void 0&&k.paragraphStyle.namedStyleType!==s.NamedStyleType.SUBTITLE&&k.paragraphStyle.namedStyleType!==s.NamedStyleType.NORMAL_TEXT}).map(k=>{var q;const W=Ol(k.paragraphStyle.namedStyleType),G=h==null?void 0:h.get(k.startIndex);if(!G)return null;const{paragraphStart:K,paragraphEnd:Y}=G;return{id:k.paragraphStyle.headingId,text:s.getPlainText(i.slice(K,Y)),level:W,isTitle:((q=k.paragraphStyle)==null?void 0:q.namedStyleType)===s.NamedStyleType.TITLE}}).filter(k=>k==null?void 0:k.text),R=I.useEvent(k=>{const W=k.viewportScrollY,G=W+p/f,K=Rl(h,E,W,G);K&&l(K)}),v=T!=null&&T.find(k=>k.isTitle)?T:[...u?[{id:Ws,text:u,level:1,isTitle:!0}]:[],...T!=null?T:[]].filter(Boolean),[O,M]=U.useState(!0);U.useEffect(()=>{const k=s.debounce(r,100),W=o.onCommandExecuted(G=>{G.id===D.RichTextEditingMutation.id&&G.params.unitId===(e==null?void 0:e.getUnitId())&&k(Y=>Y+1)});return()=>{W.dispose()}},[o,e]),U.useEffect(()=>{const k=d==null?void 0:d.scene.getViewport(ae.VIEW_MAIN);if(!k)return;const W=s.fromEventSubject(k.onScrollAfter$).pipe(L.throttleTime(33)).subscribe(R);return()=>{W.unsubscribe()}},[d]);const b=I.useEvent(k=>{const W=d==null?void 0:d.scene.getViewport(ae.VIEW_MAIN);if(!W)return;if(k.id===Ws){W.scrollToViewportPos({viewportScrollY:0});return}const G=S.find(Y=>{var q;return((q=Y.paragraphStyle)==null?void 0:q.headingId)===k.id});if(!G)return;const K=h==null?void 0:h.get(G.startIndex);K&&(W.scrollToViewportPos({viewportScrollY:K.rect.top}),l(k.id))});return!e||s.isInternalEditorID(A)||!(v!=null&&v.length)?null:P.jsx("div",{className:"univer-absolute univer-bottom-0 univer-left-0 univer-top-0 univer-z-[100] univer-w-[0px]",children:P.jsx(bl,{menus:v,open:O,onOpenChange:M,mode:C,maxWidth:C==="float"?void 0:Math.floor(g)-10,wrapperClass:"univer-mt-12",activeId:c,onClick:b,maxHeight:p-48})})}const pe={id:"doc-paragraph-setting.command",type:s.CommandType.COMMAND,handler:async(o,t)=>{var C,T,R,v,O;const e=o.get(D.DocSelectionManagerService),n=o.get(s.IUniverInstanceService),i=o.get(s.ICommandService),a=n.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),r=e.getDocRanges();if(!a||r.length===0||!t)return!1;const c=r[0].segmentId,l=a.getUnitId(),A=a.getSelfOrHeaderFooterModel(c),d=(T=(C=A.getBody())==null?void 0:C.paragraphs)!=null?T:[],u=(v=(R=A.getBody())==null?void 0:R.dataStream)!=null?v:"",m=(O=s.BuildTextUtils.range.getParagraphsInRanges(r,d,u))!=null?O:[],h={id:D.RichTextEditingMutation.id,params:{unitId:l,actions:[],textRanges:r}},g=new s.MemoryCursor;g.reset();const p=new s.TextX,f=s.JSONX.getInstance();for(const M of m){const{startIndex:b}=M;p.push({t:s.TextXActionType.RETAIN,len:b-g.cursor});const N={...M.paragraphStyle,...t.paragraph};p.push({t:s.TextXActionType.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...M,paragraphStyle:N,startIndex:0}]},coverType:s.UpdateDocsAttributeType.REPLACE}),g.moveCursorTo(b+1)}const S=Z(a,c);return h.params.actions=f.editOp(p.serialize(),S),!!i.syncExecuteCommand(h.id,h.params)}},Dl=()=>{const o=I.useDependency(D.DocSelectionManagerService),t=I.useDependency(st),e=U.useMemo(()=>o.getDocRanges(),[]);return U.useEffect(()=>{e.length||t.closePanel()},[e]),e},Bl=()=>{var l,A,d,u,m;const t=I.useDependency(s.IUniverInstanceService).getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),e=Dl();if(!t||e.length===0)return[];const n=e[0].segmentId,i=t.getSelfOrHeaderFooterModel(n),a=(A=(l=i.getBody())==null?void 0:l.paragraphs)!=null?A:[],r=(u=(d=i.getBody())==null?void 0:d.dataStream)!=null?u:"";return(m=s.BuildTextUtils.range.getParagraphsInRanges(e,a,r))!=null?m:[]},_l=(o,t)=>{const e=I.useDependency(s.ICommandService),[n,i]=U.useState(()=>{var c,l;const r=o[0];return r?String((l=(c=r.paragraphStyle)==null?void 0:c.horizontalAlign)!=null?l:t):t});return[n,r=>(i(r),e.executeCommand(pe.id,{paragraph:{horizontalAlign:Number(r)}}))]},Nl=o=>{const t=I.useDependency(s.ICommandService),[e,n]=U.useState(()=>{var r;const a=o[0];return a?_.getNumberUnitValue((r=a.paragraphStyle)==null?void 0:r.indentStart,0):0});return[e,a=>(n(a),t.executeCommand(pe.id,{paragraph:{indentStart:{v:a}}}))]},Pl=o=>{const t=I.useDependency(s.ICommandService),[e,n]=U.useState(()=>{var r;const a=o[0];return a?_.getNumberUnitValue((r=a.paragraphStyle)==null?void 0:r.indentEnd,0):0});return[e,a=>(n(a),t.executeCommand(pe.id,{paragraph:{indentEnd:{v:a}}}))]},Ul=o=>{const t=I.useDependency(s.ICommandService),[e,n]=U.useState(()=>{var r;const a=o[0];return a?_.getNumberUnitValue((r=a.paragraphStyle)==null?void 0:r.indentFirstLine,0):0});return[e,a=>(n(a),t.executeCommand(pe.id,{paragraph:{indentFirstLine:{v:a}}}))]},wl=o=>{const t=I.useDependency(s.ICommandService),[e,n]=U.useState(()=>{var r;const a=o[0];return a?_.getNumberUnitValue((r=a.paragraphStyle)==null?void 0:r.hanging,0):0});return[e,a=>(n(a),t.executeCommand(pe.id,{paragraph:{hanging:{v:a}}}))]},Ll=o=>{const t=I.useDependency(s.ICommandService),[e,n]=U.useState(()=>{var r;const a=o[0];return a?_.getNumberUnitValue((r=a.paragraphStyle)==null?void 0:r.spaceAbove,0):0});return[e,a=>(n(a),t.executeCommand(pe.id,{paragraph:{spaceAbove:{v:a}}}))]},Ql=o=>{const t=I.useDependency(s.ICommandService),[e,n]=U.useState(()=>{var r;const a=o[0];return a?_.getNumberUnitValue((r=a.paragraphStyle)==null?void 0:r.spaceBelow,0):0});return[e,a=>(n(a),t.executeCommand(pe.id,{paragraph:{spaceBelow:{v:a}}}))]},Fl=o=>{const t=I.useDependency(s.ICommandService),e=I.useDependency(_.IRenderManagerService),n=I.useDependency(s.IUniverInstanceService),i=U.useMemo(()=>{var g;const h=n.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);if(h)return(g=e.getRenderById(h==null?void 0:h.getUnitId()))==null?void 0:g.with(D.DocSkeletonManagerService).getSkeleton()},[]),a=U.useMemo(()=>new L.BehaviorSubject({}),[]),[r,c]=U.useState(()=>{var g,p;const h=o[0];return h&&(p=(g=h.paragraphStyle)==null?void 0:g.lineSpacing)!=null?p:1}),l=U.useRef(r),[A,d]=U.useState(()=>{var g,p;const h=o[0];return h&&(p=(g=h.paragraphStyle)==null?void 0:g.spacingRule)!=null?p:s.SpacingRule.AUTO}),u=async h=>{c(h),a.next({lineSpacing:h,spacingRule:A})},m=async h=>{if(h!==A){let g=l.current;if(h===s.SpacingRule.AT_LEAST){const p=i==null?void 0:i.findNodeByCharIndex(o[0].startIndex),f=p==null?void 0:p.parent,S=f==null?void 0:f.parent;(S==null?void 0:S.contentHeight)!==void 0&&(g=Math.max(S.contentHeight,g))}else g>5&&(g=2);l.current=r,u(g),d(h),a.next({spacingRule:h})}};return U.useEffect(()=>{const h=a.pipe(lt.filter(g=>!!Object.keys(g).length),lt.bufferTime(16),lt.filter(g=>!!g.length),lt.map(g=>g.reduce((p,f)=>(Object.keys(f).forEach(S=>{p[S]=f[S]}),p),{}))).subscribe(g=>t.executeCommand(pe.id,{paragraph:{...g}}));return()=>h.unsubscribe()},[]),{lineSpacing:[r,u],spacingRule:[A,m]}},Ke=o=>{const{value:t,onChange:e,className:n="",min:i=0,max:a=100,step:r=1}=o,c=U.useRef(null);return P.jsx(J.InputNumber,{step:r,ref:c,min:i,max:a,value:t,onChange:l=>{e(l!=null?l:0).finally(()=>{setTimeout(()=>{var A;(A=c.current)==null||A.focus()},30)})},className:n})};function Hl(){const o=I.useDependency(s.LocaleService),t=U.useMemo(()=>[{label:o.t("toolbar.alignLeft"),value:String(s.HorizontalAlign.LEFT),icon:P.jsx(ms,{})},{label:o.t("toolbar.alignCenter"),value:String(s.HorizontalAlign.CENTER),icon:P.jsx(hs,{})},{label:o.t("toolbar.alignRight"),value:String(s.HorizontalAlign.RIGHT),icon:P.jsx(ps,{})},{label:o.t("toolbar.alignJustify"),value:String(s.HorizontalAlign.JUSTIFIED),icon:P.jsx(os,{})}],[]),e=Bl(),[n,i]=_l(e,t[0].value),[a,r]=Nl(e),[c,l]=Pl(e),[A,d]=Ul(e),[u,m]=wl(e),[h,g]=Ll(e),[p,f]=Ql(e),{lineSpacing:[S,E],spacingRule:[C,T]}=Fl(e),R=U.useMemo(()=>C===s.SpacingRule.AUTO?{min:1,max:5,step:S<2?.5:1}:{min:1,max:100},[C,S]);return P.jsxs("div",{children:[P.jsx("div",{className:"univer-t-4 univer-text-sm univer-font-medium",children:o.t("doc.paragraphSetting.alignment")}),P.jsx("div",{className:J.clsx("univer-mt-4 univer-box-border univer-flex univer-w-full univer-items-center univer-justify-between univer-gap-1 univer-rounded-md univer-p-1",J.borderClassName),children:t.map(v=>P.jsx(J.Tooltip,{title:v.label,placement:"bottom",children:P.jsx("span",{className:J.clsx("hover:univer-bg-black/60 univer-flex univer-cursor-pointer univer-items-center univer-justify-center univer-rounded univer-bg-none univer-px-3 univer-py-1",{"univer-bg-blend-color-dodge/90":n===v.value}),onClick:()=>i(v.value),children:v.icon})},v.value))}),P.jsx("div",{className:"univer-t-4 univer-text-sm univer-font-medium",children:o.t("doc.paragraphSetting.indentation")}),P.jsxs("div",{children:[P.jsxs("div",{className:"univer-item-center univer-flex univer-justify-between",children:[P.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[o.t("doc.paragraphSetting.left"),"(px)"]}),P.jsx(Ke,{className:"univer-mt-4",value:a,onChange:v=>r(v!=null?v:0)})]}),P.jsxs("div",{className:"univer-item-center univer-flex univer-justify-between",children:[P.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[o.t("doc.paragraphSetting.right"),"(px)"]}),P.jsx(Ke,{className:"univer-mt-4",value:c,onChange:v=>l(v!=null?v:0)})]}),P.jsxs("div",{className:"univer-item-center univer-flex univer-justify-between",children:[P.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[o.t("doc.paragraphSetting.firstLine"),"(px)"]}),P.jsx(Ke,{className:"univer-mt-4",value:A,onChange:v=>d(v!=null?v:0)})]}),P.jsxs("div",{className:"univer-item-center univer-flex univer-justify-between",children:[P.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[o.t("doc.paragraphSetting.hanging"),"(px)"]}),P.jsx(Ke,{className:"univer-mt-4",value:u,onChange:v=>m(v!=null?v:0)})]})]}),P.jsx("div",{className:"univer-t-4 univer-text-sm univer-font-medium",children:o.t("doc.paragraphSetting.spacing")}),P.jsxs("div",{children:[P.jsxs("div",{className:"univer-justify-betweenuniver-item-center univer-flex",children:[P.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[o.t("doc.paragraphSetting.before"),"(px)"]}),P.jsx(Ke,{className:"univer-mt-4",value:h,onChange:v=>g(v!=null?v:0)})]}),P.jsxs("div",{className:"univer-item-center univer-flex univer-justify-between",children:[P.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[o.t("doc.paragraphSetting.after"),"(px)"]}),P.jsx(Ke,{className:"univer-mt-4",value:p,onChange:v=>f(v!=null?v:0)})]}),P.jsxs("div",{className:"item-center univer-flex univer-justify-between",children:[P.jsx("div",{className:"univer-mt-3 univer-text-xs",children:o.t("doc.paragraphSetting.lineSpace")}),P.jsxs("div",{className:"univer-mt-4 univer-flex univer-w-[162px] univer-flex-col univer-gap-1.5",children:[P.jsx(J.Select,{value:`${C}`,options:[{label:o.t("doc.paragraphSetting.multiSpace"),value:`${s.SpacingRule.AUTO}`},{label:o.t("doc.paragraphSetting.fixedValue"),value:`${s.SpacingRule.AT_LEAST}`}],onChange:v=>T(Number(v))}),P.jsx(Ke,{...R,value:S,onChange:v=>E(v!=null?v:0)})]})]})]})]})}const kl=(o,t)=>t.length===o.length&&o.some(e=>t.some(n=>n.startOffset===e.startOffset&&n.endOffset===e.endOffset));function Vl(){const o=I.useDependency(s.ICommandService),t=I.useDependency(s.LocaleService),e=I.useObservable(t.currentLocale$),[n,i]=U.useState(""),a=U.useMemo(()=>s.debounce(()=>i(s.generateRandomId(4)),300),[]),r=U.useRef([]);return U.useEffect(()=>{const c=o.onCommandExecuted(l=>{if(D.SetTextSelectionsOperation.id===l.id){const A=l.params.ranges;kl(A,r.current)||i(s.generateRandomId(4)),r.current=A}D.RichTextEditingMutation.id===l.id&&l.params.trigger!==pe.id&&a()});return()=>c.dispose()},[a]),U.useEffect(()=>{i(s.generateRandomId(4))},[e]),U.useEffect(()=>()=>a.cancel(),[a]),P.jsx(Hl,{},n)}var Wl=Object.getOwnPropertyDescriptor,Gl=(o,t,e,n)=>{for(var i=n>1?void 0:n?Wl(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},ko=(o,t)=>(e,n)=>t(e,n,o);const Gs="doc_ui_paragraph-setting-panel";let st=class extends s.Disposable{constructor(t,e,n){super();B(this,"_id");this._commandService=t,this._componentManager=e,this._sidebarService=n,this._init()}_init(){this.disposeWithMe(this._componentManager.register(Gs,Vl))}openPanel(){const t={header:{title:"doc.slider.paragraphSetting"},id:this._id,children:{label:Gs},width:300};this._sidebarService.open(t)}closePanel(){this._sidebarService.close(this._id)}};st=Gl([ko(0,s.ICommandService),ko(1,s.Inject(I.ComponentManager)),ko(2,s.Inject(I.ISidebarService))],st);const Vo={id:"sidebar.operation.doc-paragraph-setting-panel",type:s.CommandType.OPERATION,handler:o=>(o.get(st).openPanel(),!0)},Wo=o=>{const t=o.get(D.DocSelectionManagerService);return new L.Observable(e=>{const n=t.textSelection$.subscribe(()=>{t.getDocRanges().some(r=>r.collapsed===!1||r.rangeType===s.DOC_RANGE_TYPE.RECT)?e.next(!1):e.next(!0)});return()=>n.unsubscribe()})};function Xl(o){if(o.length<2)return!0;const t=o.map(e=>e.tableId);return t.every(e=>e===t[0])}function Xs(o,t,e){var a;const n=t.getRectRanges(),i=t.getActiveTextRange();if(n&&n.length&&Xl(n)&&i==null){o.next(!1);return}if(i&&(n==null||n.length===0)){const{segmentId:r,startOffset:c,endOffset:l}=i,A=e.getCurrentUniverDocInstance(),d=(a=A==null?void 0:A.getSelfOrHeaderFooterModel(r).getBody())==null?void 0:a.tables;if(d&&d.length&&d.some(u=>{const{startIndex:m,endIndex:h}=u;return c>m&&c<h||l>m&&l<h})){o.next(!1);return}}o.next(!0)}const Me=o=>{const t=o.get(D.DocSelectionManagerService),e=o.get(s.IUniverInstanceService);return new L.Observable(n=>{const i=t.textSelection$.subscribe(()=>{Xs(n,t,e)});return Xs(n,t,e),()=>i.unsubscribe()})},jl=o=>({id:mt.name,commandId:mt.id,type:I.MenuItemType.BUTTON,icon:"CopyDoubleIcon",title:"rightClick.copy",disabled$:Wo(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}),Kl=o=>({id:Vo.id,type:I.MenuItemType.BUTTON,icon:"MenuIcon",title:"doc.menu.paragraphSetting",hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}),zl=o=>({id:Kt.id,type:I.MenuItemType.BUTTON,icon:"CopyDoubleIcon",title:"rightClick.cut",disabled$:Wo(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}),Yl=o=>({id:zt.id,type:I.MenuItemType.BUTTON,icon:"PasteSpecialDoubleIcon",title:"rightClick.paste",hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}),ql=o=>({id:ht.id,type:I.MenuItemType.BUTTON,icon:"PasteSpecialDoubleIcon",title:"rightClick.delete",disabled$:Wo(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}),js="doc.menu.table-insert";function Jl(o){return{id:js,type:I.MenuItemType.SUBITEMS,title:"table.insert",icon:"InsertDoubleIcon",hidden$:L.combineLatest(I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC),Me(o),(t,e)=>t||e)}}function Zl(o){return{id:sn.id,type:I.MenuItemType.BUTTON,title:"table.insertRowAbove",icon:"InsertRowAboveDoubleIcon",disabled$:Me(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function $l(o){return{id:an.id,type:I.MenuItemType.BUTTON,title:"table.insertRowBelow",icon:"InsertRowBelowDoubleIcon",disabled$:Me(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function ed(o){return{id:rn.id,type:I.MenuItemType.BUTTON,title:"table.insertColumnLeft",icon:"LeftInsertColumnDoubleIcon",disabled$:Me(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function td(o){return{id:cn.id,type:I.MenuItemType.BUTTON,title:"table.insertColumnRight",icon:"RightInsertColumnDoubleIcon",disabled$:Me(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}const Ks="doc.menu.table-delete";function nd(o){return{id:Ks,type:I.MenuItemType.SUBITEMS,title:"table.delete",icon:"ReduceDoubleIcon",hidden$:L.combineLatest(I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC),Me(o),(t,e)=>t||e)}}function od(o){return{id:nn.id,type:I.MenuItemType.BUTTON,title:"table.deleteRows",icon:"DeleteRowDoubleIcon",disabled$:Me(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function id(o){return{id:on.id,type:I.MenuItemType.BUTTON,title:"table.deleteColumns",icon:"DeleteColumnDoubleIcon",disabled$:Me(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function sd(o){return{id:it.id,type:I.MenuItemType.BUTTON,title:"table.deleteTable",icon:"GridIcon",disabled$:Me(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}const zs={[I.RibbonStartGroup.FORMAT]:{[Be.id]:{order:0,menuItemFactory:tc},[_e.id]:{order:1,menuItemFactory:nc},[Ne.id]:{order:2,menuItemFactory:oc},[Pe.id]:{order:3,menuItemFactory:ic},[Ee.id]:{order:4,menuItemFactory:sc},[Ue.id]:{order:5,menuItemFactory:ac},[ce.id]:{order:5.5,menuItemFactory:lc},[he.id]:{order:6,menuItemFactory:cc},[we.id]:{order:7,menuItemFactory:rc},[Ce.id]:{order:8,menuItemFactory:dc},[Te.id]:{order:9,menuItemFactory:Cc,[Ze.id]:{order:0,menuItemFactory:Ec}}},[I.RibbonStartGroup.LAYOUT]:{[Et.id]:{order:2,menuItemFactory:mc},[Ct.id]:{order:3,menuItemFactory:pc},[Tt.id]:{order:4,menuItemFactory:fc},[yt.id]:{order:5,menuItemFactory:Sc},[pt.id]:{order:6,menuItemFactory:Ic},[tt.id]:{order:7,menuItemFactory:_s},[et.id]:{order:8,menuItemFactory:Ns},[vt.id]:{order:9,menuItemFactory:Ps},[wo.id]:{order:10,menuItemFactory:Ac},[Rt.id]:{order:11,menuItemFactory:vc},[Fo.id]:{order:12,menuItemFactory:Tc}},[I.RibbonInsertGroup.MEDIA]:{[Bs]:{order:2,menuItemFactory:hc,[ln.id]:{order:0,menuItemFactory:gc}}},[I.ContextMenuPosition.MAIN_AREA]:{[I.ContextMenuGroup.FORMAT]:{[mt.name]:{order:0,menuItemFactory:jl},[Kt.id]:{order:1,menuItemFactory:zl},[zt.id]:{order:2,menuItemFactory:Yl},[ht.id]:{order:3,menuItemFactory:ql}},[I.ContextMenuGroup.LAYOUT]:{[Vo.id]:{order:0,menuItemFactory:Kl},[js]:{order:1,menuItemFactory:Jl,[sn.id]:{order:1,menuItemFactory:Zl},[an.id]:{order:2,menuItemFactory:$l},[rn.id]:{order:3,menuItemFactory:ed},[cn.id]:{order:4,menuItemFactory:td}},[Ks]:{order:2,menuItemFactory:nd,[nn.id]:{order:1,menuItemFactory:od},[on.id]:{order:2,menuItemFactory:id},[it.id]:{order:3,menuItemFactory:sd}}}},[I.ContextMenuPosition.PARAGRAPH]:{[I.ContextMenuGroup.QUICK]:{[co.id]:{order:0,menuItemFactory:bc},[lo.id]:{order:1,menuItemFactory:Oc},[Ao.id]:{order:2,menuItemFactory:Rc},[uo.id]:{order:3,menuItemFactory:Mc},[ho.id]:{order:4,menuItemFactory:xc},[qt.id]:{order:5,menuItemFactory:Dc},[tt.id]:{order:6,menuItemFactory:_s},[et.id]:{order:7,menuItemFactory:Ns},[vt.id]:{order:8,menuItemFactory:Ps}},[I.ContextMenuGroup.FORMAT]:{[Kn.id]:{order:0,menuItemFactory:Bc},[zn.id]:{order:1,menuItemFactory:_c},[kn.id]:{order:2,menuItemFactory:Nc}},[I.ContextMenuGroup.LAYOUT]:{[ws]:{menuItemFactory:Qc,[io.id]:{order:0,menuItemFactory:Pc},[so.id]:{order:1,menuItemFactory:Uc},[ao.id]:{order:2,menuItemFactory:wc},[Yn.id]:{order:3,menuItemFactory:Lc}}}}};var ad=Object.getOwnPropertyDescriptor,rd=(o,t,e,n)=>{for(var i=n>1?void 0:n?ad(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},xe=(o,t)=>(e,n)=>t(e,n,o);y.DocUIController=class extends s.Disposable{constructor(t,e,n,i,a,r,c,l,A){super(),this._injector=t,this._componentManager=e,this._commandService=n,this._layoutService=i,this._menuManagerService=a,this._uiPartsService=r,this._univerInstanceService=c,this._shortcutService=l,this._configService=A,this._init()}_initCustomComponents(){[[xs,Yr],[Ms,Kr],["TodoListDoubleIcon",fs],["doc.paragraph.menu",el],["DeleteIcon",ss],[Qo,Jr],["DocumentSettingIcon",as]].forEach(([t,e])=>{this.disposeWithMe(this._componentManager.register(t,e))})}_initUiParts(){this.disposeWithMe(this._uiPartsService.registerComponent(I.BuiltInUIPart.FOOTER,()=>I.connectInjector(vl,this._injector))),this.disposeWithMe(this._uiPartsService.registerComponent(I.BuiltInUIPart.CONTENT,()=>I.connectInjector(Ml,this._injector)))}_initMenus(){this._menuManagerService.mergeMenu(zs)}_initShortCut(){[il,sl,al,rl,cl,ll,ul,hl,Al,dl,gl,ml,nl].forEach(t=>{this.disposeWithMe(this._shortcutService.registerShortcut(t))})}_init(){this._initCustomComponents(),this._initMenus(),this._initFocusHandler(),this._initCommands(),this._initUiParts(),this._initShortCut()}_initCommands(){[bs,wo,Po].forEach(t=>this.disposeWithMe(this._commandService.registerCommand(t)))}_initFocusHandler(){this.disposeWithMe(this._layoutService.registerFocusHandler(s.UniverInstanceType.UNIVER_DOC,t=>{this._injector.get(_.IRenderManagerService).getRenderById(t).with(y.DocSelectionRenderService).focus()}))}},y.DocUIController=rd([xe(0,s.Inject(s.Injector)),xe(1,s.Inject(I.ComponentManager)),xe(2,s.ICommandService),xe(3,I.ILayoutService),xe(4,I.IMenuManagerService),xe(5,I.IUIPartsService),xe(6,s.IUniverInstanceService),xe(7,I.IShortcutService),xe(8,s.IConfigService)],y.DocUIController);var cd=Object.getOwnPropertyDescriptor,ld=(o,t,e,n)=>{for(var i=n>1?void 0:n?cd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Go=(o,t)=>(e,n)=>t(e,n,o);const Ys=1.5;y.DocBackScrollRenderController=class extends s.RxDisposable{constructor(t,e,n,i){super(),this._context=t,this._textSelectionManagerService=e,this._editorService=n,this._docSkeletonManagerService=i,this._init()}_init(){this._textSelectionManagerService.textSelection$.pipe(L.takeUntil(this.dispose$)).subscribe(t=>{if(t==null)return;const{isEditing:e,unitId:n}=t;n!==this._context.unitId||!e||this._context.unitId!==s.DOCS_NORMAL_EDITOR_UNIT_ID_KEY&&this._scrollToSelection()})}scrollToRange(t){const e=this._docSkeletonManagerService.getSkeleton();if(!e)return;const{startOffset:n}=t,i=e.findNodePositionByCharIndex(n);i&&this.scrollToNode(i)}scrollToNode(t){var N;const{unitId:e,scene:n,mainComponent:i}=this._context,a=this._docSkeletonManagerService.getSkeleton();if(i==null||a==null)return;const r=i.getOffsetConfig(),{docsLeft:c,docsTop:l}=r,A=new be(r,a),{contentBoxPointGroup:d}=A.getRangePointData(t,t),{left:u,top:m,height:h}=Ot(d),g=u+c,p=m+l,f=n.getViewport(ae.VIEW_MAIN),S=this._editorService.getEditor(e);if(f==null)return;const{left:E,top:C,right:T,bottom:R}=f.getBounding().viewBound;let v=0,O=0;const M=S?(N=S.params.backScrollOffset)!=null?N:0:100;p<C?v=p-C-M:p>R-h&&(v=p-R+h+M),g<E?O=g-E:g>T-Ys&&(O=g-T+Ys);const b=f.transViewportScroll2ScrollValue(O,v);f.scrollByBarDeltaValue(b)}_scrollToSelection(){const t=this._textSelectionManagerService.getActiveTextRange();if(t==null)return;const{collapsed:e,startNodePosition:n}=t;e&&this.scrollToNode(n)}},y.DocBackScrollRenderController=ld([Go(1,s.Inject(D.DocSelectionManagerService)),Go(2,le),Go(3,s.Inject(D.DocSkeletonManagerService))],y.DocBackScrollRenderController);var dd=Object.getOwnPropertyDescriptor,Ad=(o,t,e,n)=>{for(var i=n>1?void 0:n?dd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},at=(o,t)=>(e,n)=>t(e,n,o);y.DocRenderController=class extends s.RxDisposable{constructor(t,e,n,i,a,r,c){super(),this._context=t,this._commandService=e,this._docSelectionRenderService=n,this._docSkeletonManagerService=i,this._editorService=a,this._renderManagerService=r,this._univerInstanceService=c,this._addNewRender(),this._initRenderRefresh(),this._initCommandListener()}reRender(t){var r,c;const e=(r=this._renderManagerService.getRenderById(t))==null?void 0:r.with(D.DocSkeletonManagerService),n=e==null?void 0:e.getSkeleton();if(!n||!!n.getViewModel().getDataModel().getSnapshot().disabled)return;n.calculate();const a=this._editorService.getEditor(t);if(this._editorService.isEditor(t)&&!(a!=null&&a.params.scrollBar)){(c=this._context.mainComponent)==null||c.makeDirty();return}this._recalculateSizeBySkeleton(n)}_addNewRender(){const{scene:t,engine:e}=this._context,n=new _.Viewport(ae.VIEW_MAIN,t,{left:0,top:0,bottom:0,right:0,isWheelPreventDefaultX:!0});t.attachControl(),t.onMouseWheel$.subscribeEvent((a,r)=>{const c=this._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);if((c==null?void 0:c.getUnitId())!==this._context.unitId)return;const l=a;if(l.ctrlKey){const A=Math.abs(l.deltaX);let d=A<40?.2:A<80?.4:.2;d*=l.deltaY>0?-1:1,t.scaleX<1&&(d/=2),t.scaleX+d>4?t.scale(4,4):t.scaleX+d<.1?t.scale(.1,.1):l.preventDefault()}else n.onMouseWheel(l,r)}),new _.ScrollBar(n),t.addLayer(new _.Layer(t,[],Ut),new _.Layer(t,[],ri)),this._addComponent();const i=()=>t.render();this.disposeWithMe(this._context.activated$.subscribe(a=>{a?e.runRenderLoop(i):e.stopRenderLoop(i)})),this._docSelectionRenderService.__attachScrollEvent()}_addComponent(){const{scene:t,unit:e,components:n}=this._context,r={pageMarginLeft:20,pageMarginTop:20},c=new _.Documents(de.MAIN,void 0,r);c.zIndex=xn;const l=new _.DocBackground(de.BACKGROUND,void 0,r);l.zIndex=xn,this._context.mainComponent=c,n.set(de.MAIN,c),n.set(de.BACKGROUND,l),t.addObjects([c],Ut),t.addObjects([l],ai),this._editorService.getEditor(e.getUnitId())==null&&t.enableLayerCache(Ut)}_initRenderRefresh(){this._docSkeletonManagerService.currentSkeletonBefore$.pipe(L.takeUntil(this.dispose$)).subscribe(t=>{this._create(t)})}_create(t){var l;if(!t)return;const{mainComponent:e,components:n}=this._context,i=e,a=n.get(de.BACKGROUND);i.changeSkeleton(t),a.changeSkeleton(t);const{unitId:r}=this._context,c=this._editorService.getEditor(r);if(this._editorService.isEditor(r)&&!(c!=null&&c.params.scrollBar)){(l=this._context.mainComponent)==null||l.makeDirty();return}this._recalculateSizeBySkeleton(t)}_initCommandListener(){const t=[D.RichTextEditingMutation.id];this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(t.includes(e.id)){const n=e.params,{unitId:i}=n;this.reRender(i)}}))}_recalculateSizeBySkeleton(t){var g;const{mainComponent:e,scene:n,unitId:i,components:a}=this._context,r=e,c=a.get(de.BACKGROUND),l=(g=t.getSkeletonData())==null?void 0:g.pages;if(l==null)return;let A=0,d=0;const m=this._context.unit.getSnapshot().documentStyle.documentFlavor;for(let p=0,f=l.length;p<f;p++){const S=l[p];let{pageWidth:E,pageHeight:C}=S;if(m===s.DocumentFlavor.MODERN){const T=ud(S);E=T.pageWidth,C=T.pageHeight}r.pageLayoutType===_.PageLayoutType.VERTICAL?(d+=C,d+=r.pageMarginTop,p===f-1&&(d+=r.pageMarginTop),A=Math.max(A,E)):r.pageLayoutType===_.PageLayoutType.HORIZONTAL&&(A+=E,p!==f-1&&(A+=r.pageMarginLeft),d=Math.max(d,C))}r.resize(A,d),c.resize(A,d);const h=this._editorService.getEditor(i);(!this._editorService.isEditor(i)||h!=null&&h.params.scrollBar)&&n.resize(A,d)}},y.DocRenderController=Ad([at(1,s.ICommandService),at(2,s.Inject(y.DocSelectionRenderService)),at(3,s.Inject(D.DocSkeletonManagerService)),at(4,le),at(5,_.IRenderManagerService),at(6,s.IUniverInstanceService)],y.DocRenderController);function ud(o){let{pageWidth:t,pageHeight:e}=o;const{marginLeft:n,marginRight:i,marginTop:a,marginBottom:r,skeDrawings:c,skeTables:l}=o;t===Number.POSITIVE_INFINITY&&(t=o.width+n+i),e===Number.POSITIVE_INFINITY&&(e=o.height+a+r);for(const A of c.values())t=Math.max(t,A.aLeft+A.width+n+i),e=Math.max(e,A.aTop+A.height+a+r);for(const A of l.values())t=Math.max(t,A.left+A.width+n+i),e=Math.max(e,A.top+A.height+a+r);return{pageWidth:t,pageHeight:e}}var hd=Object.getOwnPropertyDescriptor,gd=(o,t,e,n)=>{for(var i=n>1?void 0:n?hd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Xo=(o,t)=>(e,n)=>t(e,n,o);let jo=class{constructor(o,t,e){B(this,"_docContainer");B(this,"getComponent",o=>{if(this._docContainer=o,!o.getContentRef().current)throw new Error("container is not ready")});B(this,"changeLocale",o=>{this._localeService.setLocale(o)});this._localeService=o,this._injector=t,this._configService=e}getUIConfig(){return{injector:this._injector,config:this._configService.getConfig(pn),changeLocale:this.changeLocale,getComponent:this.getComponent}}getContentRef(){return this._docContainer.getContentRef()}UIDidMount(o){if(this._docContainer)return o(this._docContainer)}getDocContainer(){return this._docContainer}};jo=gd([Xo(0,s.Inject(s.LocaleService)),Xo(1,s.Inject(s.Injector)),Xo(2,s.IConfigService)],jo);var md=Object.getOwnPropertyDescriptor,pd=(o,t,e,n)=>{for(var i=n>1?void 0:n?md(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},fd=(o,t)=>(e,n)=>t(e,n,o);let fn=class extends s.RxDisposable{constructor(t){super();B(this,"_docContainerController");this._injector=t,this._docContainerController=this._injector.createInstance(jo)}};fn=pd([fd(0,s.Inject(s.Injector))],fn);var Sd=Object.getOwnPropertyDescriptor,Id=(o,t,e,n)=>{for(var i=n>1?void 0:n?Sd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},qs=(o,t)=>(e,n)=>t(e,n,o);let Sn=class extends s.Disposable{constructor(o,t){super(),this._docAutoFormatService=o,this._renderManagerService=t,this._initListTabAutoFormat(),this._initSpaceAutoFormat(),this._initDefaultEnterFormat(),this._initExitListAutoFormat()}_initListTabAutoFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:ke.id,match:o=>{var i;const{selection:t,paragraphs:e,unit:n}=o;if(e.length===1&&t.startOffset===e[0].paragraphStart&&e[0].bullet){const a=(i=n.getBody())==null?void 0:i.paragraphs,r=a==null?void 0:a.filter(c=>{var l;return((l=c.bullet)==null?void 0:l.listId)===e[0].bullet.listId});return(r==null?void 0:r.findIndex(c=>c.startIndex===e[0].startIndex))!==0}else if(e.length>1&&e.some(a=>a.bullet))return!0;return!1},getMutations(o){const t=o.commandParams;return[{id:Yt.id,params:{type:t!=null&&t.shift?It.decrease:It.increase}}]},priority:100})),this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:ke.id,match:o=>{const{selection:t,unit:e}=o,{startNodePosition:n,endNodePosition:i}=t,a=this._renderManagerService.getRenderById(e.getUnitId()),r=a==null?void 0:a.with(D.DocSkeletonManagerService).getSkeleton();return r==null?!1:!!(n&&i&&Yi(r,n,i)||n&&!i&&n.path.indexOf("cells")>-1)},getMutations(o){const t=o.commandParams;return[{id:xo.id,params:{shift:!!(t!=null&&t.shift)}}]},priority:99}))}_initSpaceAutoFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:dt.id,match:o=>{var a;const{selection:t,paragraphs:e,unit:n}=o;if(!t.collapsed||e.length!==1||!t.collapsed)return!1;const i=(a=n.getBody())==null?void 0:a.dataStream.slice(e[0].paragraphStart,t.startOffset-1);return!!(i&&(Object.keys(s.QuickListTypeMap).includes(i)||Object.keys(ro).includes(i)))},getMutations(o){var a;const{paragraphs:t,unit:e,selection:n}=o,i=(a=e.getBody())==null?void 0:a.dataStream.slice(t[0].paragraphStart,n.startOffset-1);if(i&&Object.keys(s.QuickListTypeMap).includes(i)){const r=s.QuickListTypeMap[i];return[{id:no.id,params:{listType:r,paragraph:t[0]}}]}if(i&&Object.keys(ro).includes(i)){const r=ro[i];return[{id:Xi.id,params:{value:r}}]}return[]}}))}_initExitListAutoFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:ze.id,match:o=>{const{paragraphs:t}=o;return!!(t.length===1&&t[0].bullet&&t[0].paragraphStart===t[0].paragraphEnd)},getMutations:o=>{const t=o.paragraphs[0].bullet;return t?t.nestingLevel>0?[{id:Yt.id,params:{type:It.decrease}}]:[{id:$e.id,params:{listType:o.paragraphs[0].bullet.listType}}]:[]}}))}_initDefaultEnterFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:ze.id,match:()=>!0,getMutations(){return[{id:Qt.id}]},priority:-9999}))}};Sn=Id([qs(0,s.Inject(y.DocAutoFormatService)),qs(1,_.IRenderManagerService)],Sn);function vd(o){return o.rows[0].cells[0].sections[0].columns[0].lines[0]}function Ed(o){const t=o.rows[o.rows.length-1],e=t.cells[t.cells.length-1];return _.getLastLine(e)}function Cd(o,t){const{ed:e}=o,{skeTables:n}=t;let i=null;for(const a of n.values())if(a.st===e+1){i=a;break}return i}function Js(o){const t=o==null?void 0:o.parent;let e=null,n=null;if(o==null||t==null)return{lineBeforeTable:e,lineAfterTable:n};const{st:i,ed:a}=o,r=t.type===_.DocumentSkeletonPageType.CELL?[t]:t.parent.pages;return _.lineIterator(r,c=>{c.st===a+1?n=c:c.ed===i-1&&(e=c)}),{lineBeforeTable:e,lineAfterTable:n}}function Zs(o){return o.sections[0].columns[0].lines.length===0}function $s(o){var r,c;const t=o.parent,e=t==null?void 0:t.parent,n=e==null?void 0:e.tableId;if(t==null||e==null)return;const i=t.cells.indexOf(o);let a=e.rows[e.rows.indexOf(t)+1];if(a==null&&n.indexOf("#-#")){const[l,A]=n.split("#-#"),d=(c=(r=e.parent)==null?void 0:r.parent)==null?void 0:c.pages,u=`${l}#-#${Number.parseInt(A)+1}`;if(d)for(const m of d){const{skeTables:h}=m;if(h.has(u)){const g=h.get(u);if(g!=null&&g.rows.length){a=g.rows.find(p=>!p.isRepeatRow);break}}}}if(a!=null){const l=a.cells[i];return Zs(l)?$s(l):l}}function ea(o){var a,r;const t=o.parent,e=t==null?void 0:t.parent;if(t==null||e==null)return;let n=e.rows[e.rows.indexOf(t)-1];const i=t.cells.indexOf(o);if((n==null||n.isRepeatRow)&&e.tableId.indexOf("#-#")){const[c,l]=e.tableId.split("#-#"),A=(r=(a=e.parent)==null?void 0:a.parent)==null?void 0:r.pages,d=`${c}#-#${Number.parseInt(l)-1}`;if(A)for(const u of A){const{skeTables:m}=u;if(m.has(d)){const h=m.get(d);if(h!=null&&h.rows.length){n=h.rows[h.rows.length-1];break}}}}if(n!=null){const c=n.cells[i];return Zs(c)?ea(c):c}}function Td(o,t){const{st:e}=o,{skeTables:n}=t;let i=null;for(const a of n.values())if(a.ed===e-1){i=a;break}return i}function yd(o){return o.sections[0].columns[0].lines[0]}function bd(o){const t=_.getLastColumn(o);return t.lines[t.lines.length-1]}var Od=Object.getOwnPropertyDescriptor,Rd=(o,t,e,n)=>{for(var i=n>1?void 0:n?Od(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},In=(o,t)=>(e,n)=>t(e,n,o);let vn=class extends s.Disposable{constructor(t,e,n,i){super();B(this,"_onInputSubscription");this._univerInstanceService=t,this._renderManagerService=e,this._textSelectionManagerService=n,this._commandService=i,this._commandExecutedListener()}dispose(){var t;super.dispose(),(t=this._onInputSubscription)==null||t.unsubscribe()}_commandExecutedListener(){const t=[Oe.id,Re.id];this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(!t.includes(e.id))return;const n=e.params;switch(e.id){case Oe.id:return this._handleMoveCursor(n.direction);case Re.id:return this._handleShiftMoveSelection(n.direction);default:throw new Error("Unknown command")}}))}_handleShiftMoveSelection(t){var C,T,R;const e=this._textSelectionManagerService.getActiveTextRange(),n=this._textSelectionManagerService.getTextRanges(),i=this._univerInstanceService.getCurrentUniverDocInstance();if(i==null)return;const a=(C=this._renderManagerService.getRenderById(i.getUnitId()))==null?void 0:C.with(D.DocSkeletonManagerService).getSkeleton(),r=this._getDocObject();if(e==null||a==null||r==null)return;const{startOffset:c,endOffset:l,style:A,collapsed:d,direction:u,segmentId:m,startNodePosition:h,endNodePosition:g,segmentPage:p}=e;if(n.length>1){let v=Number.POSITIVE_INFINITY,O=Number.NEGATIVE_INFINITY;for(const M of n)v=Math.min(v,M.startOffset),O=Math.max(O,M.endOffset);this._textSelectionManagerService.replaceTextRanges([{startOffset:t===s.Direction.LEFT||t===s.Direction.UP?O:v,endOffset:t===s.Direction.LEFT||t===s.Direction.UP?v:O,style:A}],!1);return}const f=d||u===s.RANGE_DIRECTION.FORWARD?c:l;let S=d||u===s.RANGE_DIRECTION.FORWARD?l:c;const E=(T=i.getSelfOrHeaderFooterModel(m).getBody().dataStream.length)!=null?T:Number.POSITIVE_INFINITY;if(t===s.Direction.LEFT||t===s.Direction.RIGHT){const v=a.findNodeByCharIndex(S-1,m,p),O=a.findNodeByCharIndex(S,m,p);S=t===s.Direction.RIGHT?S+O.count:S-((R=v==null?void 0:v.count)!=null?R:0),S=Math.min(E-2,Math.max(0,S)),this._textSelectionManagerService.replaceTextRanges([{startOffset:f,endOffset:S,style:A}],!1),this._scrollToFocusNodePosition(i.getUnitId(),S)}else{const v=a.findNodeByCharIndex(S,m,p),O=r.document.getOffsetConfig(),M=d?h:u===s.RANGE_DIRECTION.FORWARD?g:h,b=this._getTopOrBottomPosition(a,v,M,t===s.Direction.DOWN,!0);if(b==null){const x=t===s.Direction.UP?0:E-2;if(x===S)return;this._textSelectionManagerService.replaceTextRanges([{startOffset:f,endOffset:x,style:A}],!1);return}const N=new be(O,a).getRangePointData(b,b).cursorList[0];this._textSelectionManagerService.replaceTextRanges([{startOffset:f,endOffset:N.endOffset,style:A}],!1),this._scrollToFocusNodePosition(i.getUnitId(),N.endOffset)}}_handleMoveCursor(t){var E,C,T,R;const e=this._textSelectionManagerService.getActiveTextRange(),n=this._textSelectionManagerService.getTextRanges(),i=this._univerInstanceService.getCurrentUniverDocInstance();if(i==null)return!1;const a=(E=this._renderManagerService.getRenderById(i.getUnitId()))==null?void 0:E.with(D.DocSkeletonManagerService).getSkeleton(),r=this._getDocObject();if(e==null||a==null||r==null||n==null)return;const{startOffset:c,endOffset:l,style:A,collapsed:d,segmentId:u,startNodePosition:m,endNodePosition:h,segmentPage:g}=e,p=i.getSelfOrHeaderFooterModel(u).getBody();if(p==null)return;const f=(C=p.dataStream.length)!=null?C:Number.POSITIVE_INFINITY,S=(T=i.getCustomRanges())!=null?T:[];if(t===s.Direction.LEFT||t===s.Direction.RIGHT){let v;if(!e.collapsed||n.length>1){let b=Number.POSITIVE_INFINITY,N=Number.NEGATIVE_INFINITY;for(const x of n)b=Math.min(b,x.startOffset),N=Math.max(N,x.endOffset);v=t===s.Direction.LEFT?b:N}else{const b=a.findNodeByCharIndex(c-1,u,g),N=a.findNodeByCharIndex(c,u,g),x=a.findNodeByCharIndex(c+1,u,g);t===s.Direction.LEFT?v=Math.max(0,c-((R=b==null?void 0:b.count)!=null?R:1)):v=Math.min(f-2,l+N.count+((x==null?void 0:x.streamType)===s.DataStreamTreeTokenType.SECTION_BREAK?1:0))}const O=[s.DataStreamTreeTokenType.TABLE_START,s.DataStreamTreeTokenType.TABLE_END,s.DataStreamTreeTokenType.TABLE_ROW_START,s.DataStreamTreeTokenType.TABLE_ROW_END,s.DataStreamTreeTokenType.TABLE_CELL_START,s.DataStreamTreeTokenType.TABLE_CELL_END,s.DataStreamTreeTokenType.SECTION_BREAK];if(t===s.Direction.LEFT)for(;O.includes(p.dataStream[v]);)v--;else for(;O.includes(p.dataStream[v]);)v++;S.filter(b=>b.wholeEntity&&b.startIndex<v&&b.endIndex>=v).forEach(b=>{t===s.Direction.LEFT?v=Math.min(b.startIndex,v):v=Math.max(b.endIndex+1,v)}),this._textSelectionManagerService.replaceTextRanges([{startOffset:Math.max(0,v),endOffset:Math.max(0,v),style:A}],!1),this._scrollToFocusNodePosition(i.getUnitId(),v)}else{const v=a.findNodeByCharIndex(c,u,g),O=a.findNodeByCharIndex(l,u,g),M=r.document.getOffsetConfig(),b=this._getTopOrBottomPosition(a,t===s.Direction.UP||d?v:O,t===s.Direction.UP||d?m:h,t===s.Direction.DOWN);if(b==null){let x;d?x=t===s.Direction.UP?0:f-2:x=t===s.Direction.UP?c:l,this._textSelectionManagerService.replaceTextRanges([{startOffset:Math.max(0,x),endOffset:Math.max(0,x),style:A}],!1);return}const N=new be(M,a).getRangePointData(b,b).cursorList[0];this._textSelectionManagerService.replaceTextRanges([{...N,style:A}],!1),this._scrollToFocusNodePosition(i.getUnitId(),N.endOffset)}}_getTopOrBottomPosition(t,e,n,i,a=!1){if(e==null||n==null)return;const r=this._getGlyphLeftOffsetInLine(e),c=this._getNextOrPrevLine(e,i,a);if(c==null)return;const l=this._matchPositionByLeftOffset(t,c,r,n);if(l!=null)return{...l,isBack:!0}}_getGlyphLeftOffsetInLine(t){const e=t.parent;if(e==null)return Number.NEGATIVE_INFINITY;const n=e.left,{left:i}=t;return n+i}_matchPositionByLeftOffset(t,e,n,i){const a={distance:Number.POSITIVE_INFINITY};for(const c of e.divides){const l=c.left;for(const A of c.glyphGroup){if(A.streamType===s.DataStreamTreeTokenType.SECTION_BREAK)continue;const{left:d}=A,u=l+d,m=Math.abs(n-u);m<a.distance&&(a.glyph=A,a.distance=m)}}if(a.glyph==null)return;const{segmentPage:r}=i;return t.findPositionByGlyph(a.glyph,r)}_getNextOrPrevLine(t,e,n=!1){var p,f,S,E,C,T,R,v,O,M,b,N;const i=t.parent,a=i==null?void 0:i.parent,r=a==null?void 0:a.parent,c=r==null?void 0:r.parent,l=c==null?void 0:c.parent;if(i==null||a==null||r==null||c==null||l==null)return;const A=r.lines.indexOf(a);if(A===-1)return;let d;if(l.type===_.DocumentSkeletonPageType.CELL&&n){const x=ta(l,e);if(x)return x}if(e===!0){d=r.lines[A+1];const x=Cd(a,l);if(x){const w=vd(x);w&&(d=w)}}else{d=r.lines[A-1];const x=Td(a,l);if(x){const w=Ed(x);w&&(d=w)}}if(d!=null)return d;const u=c.columns.indexOf(r);if(u===-1)return;if(e===!0)d=(p=c.columns[u+1])==null?void 0:p.lines[0];else{const x=(S=(f=c.columns)==null?void 0:f[u-1])==null?void 0:S.lines;d=x==null?void 0:x[x.length-1]}if(d!=null)return d;const m=l.sections.indexOf(c);if(m===-1)return;if(e===!0)d=(C=(E=l.sections[m-1])==null?void 0:E.columns[0])==null?void 0:C.lines[0];else{const x=(R=(T=l.sections)==null?void 0:T[m-1])==null?void 0:R.columns,w=x==null?void 0:x[x.length-1],F=w==null?void 0:w.lines;d=F==null?void 0:F[F.length-1]}if(d!=null)return d;if(l.type===_.DocumentSkeletonPageType.CELL)return ta(l,e);const h=l.parent;if(h==null)return;const g=h.pages.indexOf(l);if(g!==-1){if(e===!0)d=(M=(O=(v=h.pages[g+1])==null?void 0:v.sections[0])==null?void 0:O.columns[0])==null?void 0:M.lines[0];else{const x=(b=h.pages[g-1])==null?void 0:b.sections;if(x==null)return;const w=(N=x[x.length-1])==null?void 0:N.columns,F=w[w.length-1],V=F==null?void 0:F.lines;d=V[V.length-1]}if(d!=null)return d}}_scrollToFocusNodePosition(t,e){var i;const n=(i=this._renderManagerService.getRenderById(t))==null?void 0:i.with(y.DocBackScrollRenderController);n!=null&&n.scrollToRange({startOffset:e,endOffset:e,collapsed:!0})}_getDocObject(){return ci(this._univerInstanceService,this._renderManagerService)}};vn=Rd([In(0,s.IUniverInstanceService),In(1,_.IRenderManagerService),In(2,s.Inject(D.DocSelectionManagerService)),In(3,s.ICommandService)],vn);function ta(o,t){var n,i;let e=null;if(t===!0){const a=$s(o);if(a)e=yd(a);else{const r=(n=o.parent)==null?void 0:n.parent,{lineAfterTable:c}=Js(r);c&&(e=c)}}else{const a=ea(o);if(a)e=bd(a);else{const r=(i=o.parent)==null?void 0:i.parent,{lineBeforeTable:c}=Js(r);c&&(e=c)}}return e}const Md=({handleRowColChange:o,tableCreateParams:t})=>{const e=I.useDependency(s.LocaleService),[n,i]=U.useState(3),[a,r]=U.useState(5);function c(l,A){i(l),r(A),o(l,A)}return U.useEffect(()=>{i(t.rowCount),r(t.colCount)},[t]),P.jsxs("div",{className:"univer-flex univer-items-center univer-justify-between univer-gap-2",children:[P.jsxs("div",{className:"univer-flex univer-items-center univer-gap-2",children:[P.jsx("span",{children:e.t("toolbar.table.rowCount")}),P.jsx(J.InputNumber,{className:"univer-w-28",min:1,max:20,precision:0,value:n,onChange:l=>{c(l,a)}})]}),P.jsxs("div",{className:"univer-flex univer-items-center univer-gap-2",children:[P.jsx("span",{children:e.t("toolbar.table.colCount")}),P.jsx(J.InputNumber,{className:"univer-w-28",min:1,max:20,precision:0,value:a,onChange:l=>{c(n,l)}})]})]})};var xd=Object.getOwnPropertyDescriptor,Dd=(o,t,e,n)=>{for(var i=n>1?void 0:n?xd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},na=(o,t)=>(e,n)=>t(e,n,o);let En=class extends s.Disposable{constructor(o,t){super(),this._commandService=o,this._componentManager=t,this._initialize()}_initialize(){this._init(),this._registerCommands(),this._initCustomComponents()}_registerCommands(){[ln].forEach(o=>this.disposeWithMe(this._commandService.registerCommand(o)))}_initCustomComponents(){const o=this._componentManager;this.disposeWithMe(o.register(ts,Md))}_init(){}};En=Dd([na(0,s.ICommandService),na(1,s.Inject(I.ComponentManager))],En);var Bd=Object.getOwnPropertyDescriptor,_d=(o,t,e,n)=>{for(var i=n>1?void 0:n?Bd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Cn=(o,t)=>(e,n)=>t(e,n,o);let Ko=class extends s.Disposable{constructor(o,t,e,n,i){super(),this._context=o,this._docSkeletonManagerService=t,this._commandService=e,this._docEventManagerService=n,this._textSelectionManagerService=i,this._initPointerDownObserver(),this._initHoverCursor()}_initPointerDownObserver(){this._docEventManagerService.clickBullets$.subscribe(o=>{const t=this._textSelectionManagerService.getTextRanges();this._commandService.executeCommand(to.id,{index:o.paragraph.startIndex,segmentId:o.segmentId,textRanges:t})})}_initHoverCursor(){this.disposeWithMe(this._docEventManagerService.hoverBullet$.subscribe(o=>{o?this._context.mainComponent.setCursor(_.CURSOR_TYPE.POINTER):this._context.mainComponent.setCursor(_.CURSOR_TYPE.TEXT)}))}_getTransformCoordForDocumentOffset(o,t,e,n){const{documentTransform:i}=o.getOffsetConfig(),a=t.transformVector2SceneCoord(_.Vector2.FromArray([e,n]));if(a)return i.clone().invert().applyPoint(a)}};Ko=_d([Cn(1,s.Inject(D.DocSkeletonManagerService)),Cn(2,s.ICommandService),Cn(3,s.Inject(y.DocEventManagerService)),Cn(4,s.Inject(D.DocSelectionManagerService))],Ko);var Nd=Object.getOwnPropertyDescriptor,Pd=(o,t,e,n)=>{for(var i=n>1?void 0:n?Nd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},_t=(o,t)=>(e,n)=>t(e,n,o);let Tn=class extends s.RxDisposable{constructor(o,t,e,n,i,a){super(),this._context=o,this._commandService=t,this._docClipboardService=e,this._docSelectionRenderService=n,this._contextService=i,this._editorService=a,this._init()}_init(){this._initLegacyPasteCommand()}_initLegacyPasteCommand(){var o;(o=this._docSelectionRenderService)==null||o.onPaste$.pipe(L.takeUntil(this.dispose$)).subscribe(t=>{var c,l,A;if(!jt(this._contextService))return;t.event.preventDefault();const e=t.event;let n=(c=e.clipboardData)==null?void 0:c.getData(I.HTML_CLIPBOARD_MIME_TYPE);const i=(l=e.clipboardData)==null?void 0:l.getData(I.PLAIN_TEXT_CLIPBOARD_MIME_TYPE),a=[...((A=e.clipboardData)==null?void 0:A.items)||[]].filter(d=>I.imageMimeTypeSet.has(d.type)).map(d=>d.getAsFile()).filter(d=>!!d);this._editorService.getEditor(this._context.unitId)&&(n!=null?n:"").indexOf("</table>")>-1&&(n=""),this._docClipboardService.legacyPaste({html:n,text:i,files:a})})}};Tn=Pd([_t(1,s.ICommandService),_t(2,De),_t(3,s.Inject(y.DocSelectionRenderService)),_t(4,s.IContextService),_t(5,le)],Tn);var Ud=Object.getOwnPropertyDescriptor,wd=(o,t,e,n)=>{for(var i=n>1?void 0:n?Ud(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},oa=(o,t)=>(e,n)=>t(e,n,o);const Ld=[s.DEFAULT_EMPTY_DOCUMENT_VALUE,s.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY,s.DOCS_NORMAL_EDITOR_UNIT_ID_KEY,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY];let zo=class extends s.Disposable{constructor(o,t,e){super(),this._context=o,this._contextMenuService=t,this._commandService=e,Ld.includes(this._context.unitId)||(this._initPointerDown(),this._initEditChange())}_initPointerDown(){var e,n;const t=((n=(e=this._context)==null?void 0:e.mainComponent)==null?void 0:n.onPointerDown$).subscribeEvent(i=>{i.button===2&&this._contextMenuService.triggerContextMenu(i,I.ContextMenuPosition.MAIN_AREA)});this.disposeWithMe(t)}_initEditChange(){this.disposeWithMe(this._commandService.onCommandExecuted(o=>{o.id===D.RichTextEditingMutation.id&&this._contextMenuService.visible&&this._contextMenuService.hideContextMenu()}))}};zo=wd([oa(1,I.IContextMenuService),oa(2,s.ICommandService)],zo);var Qd=Object.getOwnPropertyDescriptor,Fd=(o,t,e,n)=>{for(var i=n>1?void 0:n?Qd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},rt=(o,t)=>(e,n)=>t(e,n,o);let yn=class extends s.Disposable{constructor(t,e,n,i,a,r,c){super();B(this,"_initialEditors",new Set);this._context=t,this._univerInstanceService=e,this._editorService=n,this._commandService=i,this._docSelectionRenderService=a,this._docSkeletonManagerService=r,this._renderManagerService=c,this._initialize()}_initialize(){this._editorService.getAllEditor().forEach(t=>{const e=t.getEditorId();e===this._context.unitId&&(this._initialEditors.has(e)||(this._initialEditors.add(e),this._resize(e)))}),this._commandExecutedListener(),this._initialBlur(),this._initialFocus()}_resize(t){if(t==null)return;const e=this._editorService.getEditor(t);if((e==null?void 0:e.cancelDefaultResizeListener)===!0)return;const n=this._univerInstanceService.getUniverDocInstance(t);if(!n)return;const i=this._docSkeletonManagerService.getSkeleton();if(e==null||e.render==null||i==null||n==null)return;i.calculate();const{marginTop:a=0,marginBottom:r=0,marginLeft:c=0,marginRight:l=0}=n.getSnapshot().documentStyle,{scene:A,mainComponent:d}=e.render;let{actualHeight:u,actualWidth:m}=i.getActualSize();u+=a+r,m+=c+l;const{width:h,height:g}=e.getBoundingClientRect(),p=Math.max(m,h),f=Math.max(u,g);A.transformByState({width:p,height:f}),d==null||d.resize(p,f)}_initialBlur(){this.disposeWithMe(this._editorService.blur$.subscribe(()=>{this._docSelectionRenderService.blur()})),this.disposeWithMe(this._docSelectionRenderService.onBlur$.subscribe(()=>{const{unitId:t}=this._context,e=this._editorService.getEditor(t),n=this._editorService.getFocusEditor();e==null||e.isSheetEditor()||n&&n.getEditorId()===t||t.includes("range_selector")||t.includes("embedding_formula_editor")||this._editorService.blur()}))}_initialFocus(){const t=["univer-formula-search","univer-formula-help","formula-help-decorator","univer-formula-help-param"];this.disposeWithMe(L.fromEvent(window,"mousedown").subscribe(n=>{const a=n.target.classList[0]||"";s.checkForSubstrings(a,t)&&n.stopPropagation()}));const e=new s.DisposableCollection;this.disposeWithMe(this._univerInstanceService.getCurrentTypeOfUnit$(s.UniverInstanceType.UNIVER_SHEET).subscribe(n=>{if(e.dispose(),!n)return;const i=n.getUnitId(),a=this._renderManagerService.getRenderById(i),r=a==null?void 0:a.engine.getCanvas().getCanvasEle();if(r==null)return;const c=L.fromEvent(r,"mousedown").subscribe(l=>{l.stopPropagation()});e.add(c)})),this.disposeWithMe(()=>e.dispose())}_commandExecutedListener(){const t=[D.RichTextEditingMutation.id];this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(t.includes(e.id)){const n=e.params,{unitId:i}=n;if(this._editorService.isSheetEditor(i)||i!==this._context.unitId)return;const a=this._editorService.getEditor(i);a&&!a.params.scrollBar&&this._resize(i)}}))}};yn=Fd([rt(1,s.IUniverInstanceService),rt(2,le),rt(3,s.ICommandService),rt(4,s.Inject(y.DocSelectionRenderService)),rt(5,s.Inject(D.DocSkeletonManagerService)),rt(6,_.IRenderManagerService)],yn);var Hd=Object.getOwnPropertyDescriptor,kd=(o,t,e,n)=>{for(var i=n>1?void 0:n?Hd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},bn=(o,t)=>(e,n)=>t(e,n,o);let Yo=class extends s.Disposable{constructor(t,e,n,i,a){super();B(this,"_previousIMEContent","");B(this,"_isCompositionStart",!0);B(this,"_onStartSubscription");B(this,"_onUpdateSubscription");B(this,"_onEndSubscription");this._context=t,this._docSelectionRenderService=e,this._docImeInputManagerService=n,this._docSkeletonManagerService=i,this._commandService=a,this._initialize()}dispose(){var t,e,n;(t=this._onStartSubscription)==null||t.unsubscribe(),(e=this._onUpdateSubscription)==null||e.unsubscribe(),(n=this._onEndSubscription)==null||n.unsubscribe()}_initialize(){this._initialOnCompositionstart(),this._initialOnCompositionUpdate(),this._initialOnCompositionend()}_initialOnCompositionstart(){this._onStartSubscription=this._docSelectionRenderService.onCompositionstart$.subscribe(t=>{if(t==null)return;this._resetIME();const{activeRange:e}=t;e!=null&&this._docImeInputManagerService.setActiveRange(s.Tools.deepClone(e))})}_initialOnCompositionUpdate(){this._onUpdateSubscription=this._docSelectionRenderService.onCompositionupdate$.subscribe(t=>{this._updateContent(t,!0)})}_initialOnCompositionend(){this._onEndSubscription=this._docSelectionRenderService.onCompositionend$.subscribe(t=>{this._updateContent(t,!1)})}async _updateContent(t,e){if(t==null)return;const n=this._context.unitId,i=this._docSkeletonManagerService.getSkeleton(),{event:a,activeRange:r}=t;if(i==null||r==null)return;const l=a.data;l===this._previousIMEContent&&e||(await this._commandService.executeCommand(Jn.id,{unitId:n,newText:l,oldTextLen:this._previousIMEContent.length,isCompositionStart:this._isCompositionStart,isCompositionEnd:!e}),e?(this._isCompositionStart&&(this._isCompositionStart=!1),this._previousIMEContent=l):this._resetIME())}_resetIME(){this._previousIMEContent="",this._isCompositionStart=!0,this._docImeInputManagerService.clearUndoRedoMutationParamsCache(),this._docImeInputManagerService.setActiveRange(null)}};Yo=kd([bn(1,s.Inject(y.DocSelectionRenderService)),bn(2,s.Inject(ft)),bn(3,s.Inject(D.DocSkeletonManagerService)),bn(4,s.ICommandService)],Yo);var Vd=Object.getOwnPropertyDescriptor,Wd=(o,t,e,n)=>{for(var i=n>1?void 0:n?Vd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},On=(o,t)=>(e,n)=>t(e,n,o);let qo=class extends s.Disposable{constructor(t,e,n,i,a){super();B(this,"_onInputSubscription");this._context=t,this._docSelectionRenderService=e,this._docSkeletonManagerService=n,this._commandService=i,this._docMenuStyleService=a,this._init()}dispose(){var t;super.dispose(),(t=this._onInputSubscription)==null||t.unsubscribe()}_init(){this._initialNormalInput()}_initialNormalInput(){this._onInputSubscription=this._docSelectionRenderService.onInput$.subscribe(async t=>{var f,S;if(t==null)return;const{unitId:e}=this._context,{event:n,content:i="",activeRange:a}=t,r=n,c=this._docSkeletonManagerService.getSkeleton();if(r.data==null||c==null||a==null)return;const{segmentId:l}=a,d=this._context.unit.getSelfOrHeaderFooterModel(l).getBody(),u=this._docMenuStyleService.getDefaultStyle(),m=this._docMenuStyleService.getStyleCache(),h=Dn((f=d==null?void 0:d.customRanges)!=null?f:[],a.endOffset,s.SHEET_EDITOR_UNITS.includes(e)),g=wt(d,a.endOffset,u,m,s.SHEET_EDITOR_UNITS.includes(e)),p=Bn((S=d==null?void 0:d.customDecorations)!=null?S:[],a.endOffset);await this._commandService.executeCommand(Qn.id,{unitId:e,body:{dataStream:i,textRuns:g?[{...g,st:0,ed:i.length}]:[],customRanges:h?[{...h,startIndex:0,endIndex:i.length-1}]:[],customDecorations:p.map(E=>({...E,startIndex:0,endIndex:i.length-1}))},range:a,segmentId:l}),i===" "&&await this._commandService.executeCommand(dt.id)})}};qo=Wd([On(1,s.Inject(y.DocSelectionRenderService)),On(2,s.Inject(D.DocSkeletonManagerService)),On(3,s.ICommandService),On(4,s.Inject(ve))],qo);class Jo extends s.Disposable{constructor(t){super(),this._context=t}calculatePagePosition(){var T,R;const t=Ie(this._context),n=(R=(T=this._context.unit.getSettings())==null?void 0:T.zoomRatio)!=null?R:1,{document:i,scene:a,docBackground:r}=t,c=a==null?void 0:a.getParent(),{width:l,height:A,pageMarginLeft:d,pageMarginTop:u}=i;if(c==null||l===Number.POSITIVE_INFINITY||A===Number.POSITIVE_INFINITY)return;const{width:m,height:h}=c;let g=0,p=u,f=0,S=0,E=Number.POSITIVE_INFINITY;m>(l+d*2)*n?(g=m/2-l*n/2,g/=n,f=(m-d*2)/n,E=0):(g=d,f=l+d*2,E=(f-m/n)/2),h>A?S=(h-u*2)/n:S=A+u*2,a.resize(f,S),m<=1&&(g=-1e4,p=-1e4),i.translate(g,p),r.translate(g,p);const C=a.getViewport(ae.VIEW_MAIN);return E!==Number.POSITIVE_INFINITY&&C!=null&&C.scrollToViewportPos({viewportScrollX:E}),this}}var Gd=Object.getOwnPropertyDescriptor,Xd=(o,t,e,n)=>{for(var i=n>1?void 0:n?Gd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},ia=(o,t)=>(e,n)=>t(e,n,o);let Zo=class extends s.Disposable{constructor(o,t,e){super(),this._context=o,this._docPageLayoutService=t,this._textSelectionManagerService=e;const n=this._context.unitId;if(s.isInternalEditorID(n)&&n!==s.DOCS_ZEN_EDITOR_UNIT_ID_KEY)return this;this._initResize()}_initResize(){this.disposeWithMe(s.fromEventSubject(this._context.engine.onTransformChange$).pipe(L.filter(o=>o.type===_.TRANSFORM_CHANGE_OBSERVABLE_TYPE.resize),L.throttleTime(0,L.animationFrameScheduler)).subscribe(()=>{this._docPageLayoutService.calculatePagePosition(),this._textSelectionManagerService.refreshSelection()}))}};Zo=Xd([ia(1,s.Inject(Jo)),ia(2,s.Inject(D.DocSelectionManagerService))],Zo);var jd=Object.getOwnPropertyDescriptor,Kd=(o,t,e,n)=>{for(var i=n>1?void 0:n?jd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},ct=(o,t)=>(e,n)=>t(e,n,o);let $o=class extends s.Disposable{constructor(t,e,n,i,a,r,c){super();B(this,"_loadedMap",new WeakSet);this._context=t,this._commandService=e,this._editorService=n,this._instanceSrv=i,this._docSelectionRenderService=a,this._docSkeletonManagerService=r,this._docSelectionManagerService=c,this._initialize()}_initialize(){this._init(),this._skeletonListener(),this._commandExecutedListener(),this._refreshListener(),this._syncSelection()}_init(){const{unitId:t}=this._context,e=Ie(this._context);e==null||e.document==null||this._loadedMap.has(e.document)||(this._initialMain(t),this._loadedMap.add(e.document))}_refreshListener(){this.disposeWithMe(this._docSelectionManagerService.refreshSelection$.subscribe(t=>{if(t==null)return;const{unitId:e,docRanges:n,isEditing:i,options:a}=t;e===this._context.unitId&&(this._docSelectionRenderService.removeAllRanges(),this._docSelectionRenderService.addDocRanges(n,i,a))}))}_syncSelection(){this.disposeWithMe(this._docSelectionRenderService.textSelectionInner$.subscribe(t=>{t!=null&&this._docSelectionManagerService.__replaceTextRangesWithNoRefresh(t,{unitId:this._context.unitId,subUnitId:this._context.unitId})}))}_initialMain(t){const e=Ie(this._context),{document:n,scene:i}=e;this.disposeWithMe(n.onPointerEnter$.subscribeEvent(()=>{this._isEditorReadOnly(t)||(n.cursor=_.CURSOR_TYPE.TEXT)})),this.disposeWithMe(n.onPointerLeave$.subscribeEvent(()=>{n.cursor=_.CURSOR_TYPE.DEFAULT,i.resetCursor()})),this.disposeWithMe(n.onPointerDown$.subscribeEvent((a,r)=>{if(this._isEditorReadOnly(t))return;const c=this._instanceSrv.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);(c==null?void 0:c.getUnitId())!==t&&this._instanceSrv.setCurrentUnitForType(t);const l=this._docSkeletonManagerService.getSkeleton(),{offsetX:A,offsetY:d}=a,u=this._getTransformCoordForDocumentOffset(A,d);if(u!=null){const{pageLayoutType:m=_.PageLayoutType.VERTICAL,pageMarginLeft:h,pageMarginTop:g}=n.getOffsetConfig(),{editArea:p}=l.findEditAreaByCoord(u,m,h,g),f=this._docSkeletonManagerService.getViewModel(),S=f.getEditArea();S!==_.DocumentEditArea.BODY&&p!==_.DocumentEditArea.BODY&&p!==S&&f.setEditArea(p)}if(this._docSelectionRenderService.__onPointDown(a),this._editorService.getEditor(t)){this._setEditorFocus(t);const{offsetX:m,offsetY:h}=a;setTimeout(()=>{t===this._editorService.getFocusId()||this._docSelectionRenderService.isOnPointerEvent||(this._setEditorFocus(t),this._docSelectionRenderService.setCursorManually(m,h))},0)}a.button!==2&&r.stopPropagation()})),this.disposeWithMe(n.onDblclick$.subscribeEvent(a=>{this._isEditorReadOnly(t)||this._docSelectionRenderService.__handleDblClick(a)})),this.disposeWithMe(n.onTripleClick$.subscribeEvent(a=>{this._isEditorReadOnly(t)||this._docSelectionRenderService.__handleTripleClick(a)}))}_getTransformCoordForDocumentOffset(t,e){const n=Ie(this._context),{document:i,scene:a}=n,{documentTransform:r}=i.getOffsetConfig(),c=a.getViewports()[0];if(c==null)return;const l=c.transformVector2SceneCoord(_.Vector2.FromArray([t,e]));return r.clone().invert().applyPoint(l)}_isEditorReadOnly(t){const e=this._editorService.getEditor(t);return e?e.isReadOnly():!1}_setEditorFocus(t){this._editorService.focus(t)}_commandExecutedListener(){const t=[ue.id];this.disposeWithMe(this._commandService.onCommandExecuted(e=>{var n;if(t.includes(e.id)){const i=e.params,{unitId:a}=i,r=(n=this._docSelectionManagerService.__getCurrentSelection())==null?void 0:n.unitId;if(a!==r)return;this._docSelectionManagerService.refreshSelection()}}))}_skeletonListener(){this.disposeWithMe(this._docSkeletonManagerService.currentSkeleton$.subscribe(t=>{if(!t)return;const{unitId:e}=this._context;if(!s.isInternalEditorID(e)){this._docSelectionRenderService.focus();const a=this._context.unit.getSnapshot(),r=Ss(a);this._docSelectionManagerService.replaceDocRanges([{startOffset:r,endOffset:r}],{unitId:e,subUnitId:e},!1)}}))}};$o=Kd([ct(1,s.ICommandService),ct(2,le),ct(3,s.IUniverInstanceService),ct(4,s.Inject(y.DocSelectionRenderService)),ct(5,s.Inject(D.DocSkeletonManagerService)),ct(6,s.Inject(D.DocSelectionManagerService))],$o);var zd=Object.getOwnPropertyDescriptor,Yd=(o,t,e,n)=>{for(var i=n>1?void 0:n?zd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Fe=(o,t)=>(e,n)=>t(e,n,o);let ei=class extends s.Disposable{constructor(t,e,n,i,a,r,c,l,A){super();B(this,"_isSheetEditor",!1);this._context=t,this._contextService=e,this._docSkeletonManagerService=n,this._univerInstanceService=i,this._commandService=a,this._textSelectionManagerService=r,this._editorService=c,this._docPageLayoutService=l,this._renderManagerService=A,this._initSkeletonListener(),this._initCommandExecutedListener(),this._initRenderRefresher(),this._isSheetEditor=this._context.unitId===s.DOCS_NORMAL_EDITOR_UNIT_ID_KEY;const d=this._univerInstanceService.getCurrentUnitOfType(s.UniverInstanceType.UNIVER_SHEET),u=d&&this._renderManagerService.getRenderById(d.getUnitId());setTimeout(()=>this.updateViewZoom(u&&this._isSheetEditor?u.scene.scaleX:1,!0),20),s.isInternalEditorID(this._context.unitId)||this._initZoomEventListener()}_initRenderRefresher(){this._docSkeletonManagerService.currentSkeleton$.subscribe(t=>{if(t==null)return;const{unitId:e,scene:n}=this._context;this._editorService.isEditor(e)||this.disposeWithMe(n.onMouseWheel$.subscribeEvent(i=>{if(!i.ctrlKey||!this._contextService.getContextValue(s.FOCUSING_DOC))return;const a=this._univerInstanceService.getCurrentUniverDocInstance();if(!a)return;const{documentFlavor:r}=a.getSnapshot().documentStyle;if(r===s.DocumentFlavor.MODERN)return;const c=Math.abs(i.deltaX);let l=c<40?.2:c<80?.4:.2;l*=i.deltaY>0?-1:1,n.scaleX<1&&(l/=2);const A=a.zoomRatio;let d=+Number.parseFloat(`${A+l}`).toFixed(1);d=d>=4?4:d<=.1?.1:d,this._commandService.executeCommand(bt.id,{zoomRatio:d,unitId:a.getUnitId()}),i.preventDefault()}))})}_initSkeletonListener(){this.disposeWithMe(this._docSkeletonManagerService.currentSkeleton$.subscribe(t=>{if(t==null)return;const e=this._univerInstanceService.getCurrentUniverDocInstance();e&&setTimeout(()=>{const n=this._univerInstanceService.getCurrentUnitOfType(s.UniverInstanceType.UNIVER_SHEET),i=n&&this._renderManagerService.getRenderById(n.getUnitId()),a=this._isSheetEditor?(i==null?void 0:i.scene.scaleX)||1:e.zoomRatio;this.updateViewZoom(a,!1)})}))}_initCommandExecutedListener(){const t=[ue.id];this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(t.includes(e.id)&&e.params.unitId===this._context.unitId){const i=this._context.unit.zoomRatio||1;this.updateViewZoom(i)}})),this.disposeWithMe(this._commandService.beforeCommandExecuted(e=>{e.id===Rt.id&&this._commandService.executeCommand(bt.id,{zoomRatio:1,unitId:this._context.unitId})}))}updateViewZoom(t,e=!0){var i;const n=Ie(this._context);n.scene.scale(t,t),this._editorService.isEditor(this._context.unitId)||this._docPageLayoutService.calculatePagePosition(),e&&!this._editorService.isEditor(this._context.unitId)&&this._textSelectionManagerService.refreshSelection(),(i=n.scene.getTransformer())==null||i.clearSelectedObjects()}_initZoomEventListener(){const t=this._context.scene;this.disposeWithMe(t.onMouseWheel$.subscribeEvent(e=>{if(!e.ctrlKey)return;const n=Math.abs(e.deltaX);let i=n<40?.2:n<80?.4:.2;i*=e.deltaY>0?-1:1,t.scaleX<1&&(i/=2);const a=this._context.unit.zoomRatio;let r=+Number.parseFloat(`${a+i}`).toFixed(1);r=r>=4?4:r<=.1?.1:r,this._commandService.executeCommand(bt.id,{zoomRatio:Math.round(r*10)/10,documentId:this._context.unitId}),e.preventDefault()}))}};ei=Yd([Fe(1,s.IContextService),Fe(2,s.Inject(D.DocSkeletonManagerService)),Fe(3,s.IUniverInstanceService),Fe(4,s.ICommandService),Fe(5,s.Inject(D.DocSelectionManagerService)),Fe(6,le),Fe(7,s.Inject(Jo)),Fe(8,_.IRenderManagerService)],ei);const qd=s.createInterceptorKey("PRINTING_COMPONENT_COLLECT"),Jd=s.createInterceptorKey("PRINTING_DOM_COLLECT");class sa extends s.Disposable{constructor(){super();B(this,"_printComponentMap",new Map);B(this,"interceptor",new s.InterceptorManager({PRINTING_COMPONENT_COLLECT:qd,PRINTING_DOM_COLLECT:Jd}));this.disposeWithMe(this.interceptor.intercept(this.interceptor.getInterceptPoints().PRINTING_COMPONENT_COLLECT,{priority:-1,handler:e=>e})),this.disposeWithMe(this.interceptor.intercept(this.interceptor.getInterceptPoints().PRINTING_DOM_COLLECT,{priority:-1,handler:e=>e}))}registerPrintComponent(e,n){this._printComponentMap.set(e,n)}getPrintComponent(e){return this._printComponentMap.get(e)}}var Zd=Object.getOwnPropertyDescriptor,$d=(o,t,e,n)=>{for(var i=n>1?void 0:n?Zd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Nt=(o,t)=>(e,n)=>t(e,n,o);const aa=300;y.DocStateChangeManagerService=class extends s.RxDisposable{constructor(e,n,i,a,r){super();B(this,"_docStateChange$",new L.BehaviorSubject(null));B(this,"docStateChange$",this._docStateChange$.asObservable());B(this,"_historyStateCache",new Map);B(this,"_changeStateCache",new Map);B(this,"_historyTimer",null);B(this,"_changeStateCacheTimer",null);this._undoRedoService=e,this._commandService=n,this._univerInstanceService=i,this._docStateEmitService=a,this._renderManagerService=r,this._initialize(),this._listenDocStateChange()}getStateCache(e){var n,i;return{history:(n=this._historyStateCache.get(e))!=null?n:[],collaboration:(i=this._changeStateCache.get(e))!=null?i:[]}}setStateCache(e,n){this._historyStateCache.set(e,n.history),this._changeStateCache.set(e,n.collaboration)}_setChangeState(e){this._cacheChangeState(e,"history"),this._cacheChangeState(e,"collaboration")}_initialize(){this.disposeWithMe(this._commandService.beforeCommandExecuted(e=>{if(e.id===s.UndoCommandId||e.id===s.RedoCommandId){const n=this._univerInstanceService.getCurrentUniverDocInstance();if(n==null)return;const i=n.getUnitId();this._pushHistory(i),this._emitChangeState(i)}}))}_listenDocStateChange(){this._docStateEmitService.docStateChangeParams$.pipe(L.takeUntil(this.dispose$)).subscribe(e=>{var l;if(e==null)return;const{isCompositionEnd:n,isSync:i,syncer:a,...r}=e,c=(l=this._renderManagerService.getRenderById(i?a:e.unitId))==null?void 0:l.with(ft);if(c!=null){if(n){const A=c.fetchComposedUndoRedoMutationParams();if(A==null)throw new Error("historyParams is null in RichTextEditingMutation");const{undoMutationParams:d,redoMutationParams:u,previousActiveRange:m}=A;r.redoState.actions=u.actions,r.undoState.actions=d.actions,r.undoState.textRanges=[m]}this._setChangeState(r)}})}_cacheChangeState(e,n="history"){const{trigger:i,unitId:a,noHistory:r,debounce:c=!1}=e;if(r||i==null||n==="history"&&(i===s.RedoCommandId||i===s.UndoCommandId))return;const l=n==="history"?this._historyStateCache:this._changeStateCache,A=n==="history"?this._pushHistory.bind(this):this._emitChangeState.bind(this);if(l.has(a)){const d=l.get(a);d==null||d.push(e)}else l.set(a,[e]);c?n==="history"?(this._historyTimer&&clearTimeout(this._historyTimer),this._historyTimer=setTimeout(()=>{A(a)},aa)):(this._changeStateCacheTimer&&clearTimeout(this._changeStateCacheTimer),this._changeStateCacheTimer=setTimeout(()=>{A(a)},aa)):A(a)}_pushHistory(e){const n=this._undoRedoService,i=this._historyStateCache.get(e);if(!Array.isArray(i)||i.length===0)return;const a=i.length,r=i[0].commandId,c=i[0],l=i[a-1],A={unitId:e,actions:i.reduce((u,m)=>s.JSONX.compose(u,m.redoState.actions),null),textRanges:l.redoState.textRanges},d={unitId:e,actions:i.reverse().reduce((u,m)=>s.JSONX.compose(u,m.undoState.actions),null),textRanges:c.undoState.textRanges};n.pushUndoRedo({unitID:e,undoMutations:[{id:r,params:d}],redoMutations:[{id:r,params:A}]}),i.length=0}_emitChangeState(e){const n=this._changeStateCache.get(e);if(!Array.isArray(n)||n.length===0)return;const i=n.length,{commandId:a,trigger:r,segmentId:c,noHistory:l,debounce:A}=n[0],d=n[0],u=n[i-1],m={unitId:e,actions:n.reduce((p,f)=>s.JSONX.compose(p,f.redoState.actions),null),textRanges:u.redoState.textRanges},h={unitId:e,actions:n.reverse().reduce((p,f)=>s.JSONX.compose(p,f.undoState.actions),null),textRanges:d.undoState.textRanges},g={commandId:a,unitId:e,trigger:r,redoState:m,undoState:h,segmentId:c,noHistory:l,debounce:A};n.length=0,this._docStateChange$.next(g)}},y.DocStateChangeManagerService=$d([Nt(0,s.Inject(s.IUndoRedoService)),Nt(1,s.ICommandService),Nt(2,s.IUniverInstanceService),Nt(3,s.Inject(D.DocStateEmitService)),Nt(4,_.IRenderManagerService)],y.DocStateChangeManagerService);var eA=Object.getOwnPropertyDescriptor,tA=(o,t,e,n)=>{for(var i=n>1?void 0:n?eA(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},ra=(o,t)=>(e,n)=>t(e,n,o);const ca="univer-doc-main-canvas";y.DocsRenderService=class extends s.RxDisposable{constructor(t,e){super(),this._instanceSrv=t,this._renderManagerService=e,this._init()}_init(){this._renderManagerService.createRender$.pipe(L.takeUntil(this.dispose$)).subscribe(t=>this._createRenderWithId(t)),this._instanceSrv.getAllUnitsForType(s.UniverInstanceType.UNIVER_DOC).forEach(t=>this._createRenderer(t)),this._instanceSrv.getTypeOfUnitAdded$(s.UniverInstanceType.UNIVER_DOC).pipe(L.takeUntil(this.dispose$)).subscribe(t=>this._createRenderer(t)),this._instanceSrv.getTypeOfUnitDisposed$(s.UniverInstanceType.UNIVER_DOC).pipe(L.takeUntil(this.dispose$)).subscribe(t=>this._disposeRenderer(t))}_createRenderer(t){var i;const e=t.getUnitId(),n=(i=this._instanceSrv.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC))==null?void 0:i.getUnitId();this._renderManagerService.created$.subscribe(a=>{a.unitId===n&&(a.engine.getCanvas().setId(ca),a.engine.getCanvas().getContext().setId(ca))}),this._renderManagerService.has(e)||this._createRenderWithId(e)}_createRenderWithId(t){this._renderManagerService.createRender(t)}_disposeRenderer(t){const e=t.getUnitId();this._renderManagerService.removeRender(e)}},y.DocsRenderService=tA([ra(0,s.IUniverInstanceService),ra(1,_.IRenderManagerService)],y.DocsRenderService);const nA={id:ze.id,preconditions:tl,binding:I.KeyCode.ENTER},oA={id:ht.id,preconditions:ee,binding:I.KeyCode.BACKSPACE},iA={id:Hn.id,preconditions:ee,binding:I.KeyCode.DELETE},sA={id:Oe.id,binding:I.KeyCode.ARROW_UP,preconditions:ee,staticParameters:{direction:s.Direction.UP}},aA={id:Oe.id,binding:I.KeyCode.ARROW_DOWN,preconditions:ee,staticParameters:{direction:s.Direction.DOWN}},rA={id:Oe.id,binding:I.KeyCode.ARROW_LEFT,preconditions:ee,staticParameters:{direction:s.Direction.LEFT}},cA={id:Oe.id,binding:I.KeyCode.ARROW_RIGHT,preconditions:ee,staticParameters:{direction:s.Direction.RIGHT}},lA={id:Re.id,binding:I.KeyCode.ARROW_UP|I.MetaKeys.SHIFT,preconditions:ee,staticParameters:{direction:s.Direction.UP}},dA={id:Re.id,binding:I.KeyCode.ARROW_DOWN|I.MetaKeys.SHIFT,preconditions:ee,staticParameters:{direction:s.Direction.DOWN}},AA={id:Re.id,binding:I.KeyCode.ARROW_LEFT|I.MetaKeys.SHIFT,preconditions:ee,staticParameters:{direction:s.Direction.LEFT}},uA={id:Re.id,binding:I.KeyCode.ARROW_RIGHT|I.MetaKeys.SHIFT,preconditions:ee,staticParameters:{direction:s.Direction.RIGHT}},hA={id:qn.id,binding:I.KeyCode.A|I.MetaKeys.CTRL_COMMAND,preconditions:o=>o.getContextValue(s.FOCUSING_UNIVER_EDITOR)&&(o.getContextValue(s.FOCUSING_DOC)||o.getContextValue(s.EDITOR_ACTIVATED))};var gA=Object.defineProperty,mA=Object.getOwnPropertyDescriptor,pA=(o,t,e)=>t in o?gA(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e,fA=(o,t,e,n)=>{for(var i=n>1?void 0:n?mA(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Pt=(o,t)=>(e,n)=>t(e,n,o),SA=(o,t,e)=>pA(o,t+"",e);y.UniverDocsUIPlugin=class extends s.Plugin{constructor(t=Vs,e,n,i,a,r){super(),this._config=t,this._injector=e,this._renderManagerSrv=n,this._commandService=i,this._logService=a,this._configService=r;const{menu:c,...l}=s.merge({},Vs,this._config);c&&this._configService.setConfig("menu",c,{merge:!0}),this._configService.setConfig(pn,l),this._initDependencies(e),this._initializeShortcut(),this._initCommand()}onReady(){this._initRenderBasics(),this._markDocAsFocused(),s.touchDependencies(this._injector,[[y.DocStateChangeManagerService],[y.DocsRenderService]])}onRendered(){this._initUI(),this._initRenderModules(),s.touchDependencies(this._injector,[[Sn],[vn],[st],[En],[y.DocUIController]])}_initCommand(){[ht,Hn,Be,_e,Ne,Pe,Ee,Ue,he,we,Ce,Ze,Te,ye,Qt,Qn,Ye,Wt,Fn,Gt,pi,ue,tt,et,$e,Et,Ct,Tt,ge,yt,pt,bo,Mo,sn,an,es,rn,cn,nn,on,it,Lo,xo,ke,dt,ze,Yt,St,vt,to,no,Jn,Rt,pe,Ln,Ve,Hi,$n,ki,bt,qn,Vo,Oe,Re,Wi,eo,Gi,ce,Xi,kn,Kn,zn,co,lo,Ao,uo,ho,qt,ji,Ki,io,so,ao,Yn,Ds,Fo].forEach(t=>{this.disposeWithMe(this._commandService.registerCommand(t))}),[mt,Kt,zt].forEach(t=>this.disposeWithMe(this._commandService.registerMultipleCommand(t)))}_initializeShortcut(){[sA,aA,cA,rA,lA,dA,AA,uA,hA,oA,iA,nA,ol].forEach(t=>{this._injector.get(I.IShortcutService).registerShortcut(t)})}_initDependencies(t){s.mergeOverrideWithDependencies([[sa],[Tn],[yn],[y.DocUIController],[Sn],[En],[vn],[fn],[st],[le,{useClass:y.EditorService}],[De,{useClass:Xn}],[y.DocCanvasPopManagerService],[y.DocsRenderService],[y.DocStateChangeManagerService],[y.DocAutoFormatService],[ve]],this._config.override).forEach(n=>t.add(n))}_markDocAsFocused(){const t=this._injector.get(s.IUniverInstanceService),e=this._injector.get(le);try{const n=t.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);if(!n)return;const i=n.getUnitId();e.isEditor(i)||t.focusUnit(n.getUnitId())}catch(n){this._logService.warn(n)}}_initUI(){this._injector.get(fn)}_initRenderBasics(){[[D.DocSkeletonManagerService],[y.DocSelectionRenderService],[D.DocInterceptorService],[Jo],[ft],[y.DocRenderController],[ei]].forEach(t=>{this._renderManagerSrv.registerRenderModule(s.UniverInstanceType.UNIVER_DOC,t)})}_initRenderModules(){[[y.DocEventManagerService],[gn],[mn],[y.DocBackScrollRenderController],[$o],[No],[Zo],[zo],[Ko],[Tn],[qo],[Yo],[yn]].forEach(t=>{this._renderManagerSrv.registerRenderModule(s.UniverInstanceType.UNIVER_DOC,t)})}},SA(y.UniverDocsUIPlugin,"pluginName",si),y.UniverDocsUIPlugin=fA([s.DependentOn(_.UniverRenderEnginePlugin),Pt(1,s.Inject(s.Injector)),Pt(2,_.IRenderManagerService),Pt(3,s.ICommandService),Pt(4,s.ILogService),Pt(5,s.IConfigService)],y.UniverDocsUIPlugin);function la(o,t,e){const n=I.useDependency(s.ICommandService),i=I.useDependency(I.IShortcutService),a=U.useMemo(()=>s.generateRandomId(4),[]);U.useEffect(()=>{if(!e||!o||!t)return;const c=`sheet.operation.editor-${e.getEditorId()}-keyboard-${a}`,l=new s.DisposableCollection;return l.add(n.registerCommand({id:c,type:s.CommandType.OPERATION,handler(A,d){const{keyCode:u,metaKey:m}=d;t.handler(u,m)}})),t.keyCodes.map(A=>({id:c,binding:A.metaKey?A.keyCode|A.metaKey:A.keyCode,preconditions:()=>!0,priority:901,staticParameters:{eventType:_.DeviceInputEventType.Keyboard,keyCode:A.keyCode,metaKey:A.metaKey}})).forEach(A=>{l.add(i.registerShortcut(A))}),()=>{l.dispose()}},[n,t,e,o,a,i])}const da=(o,t=!0,e,n)=>{const i=U.useCallback(()=>{if(o){const{scene:r,mainComponent:c}=o.render,l=o.render.with(D.DocSkeletonManagerService),{width:A,height:d}=o.getBoundingClientRect();l.getViewModel().getDataModel().updateDocumentDataPageSize(t?1/0:A,1/0),r.transformByState({width:A,height:d}),c==null||c.resize(A,d)}},[o,t]),a=U.useMemo(()=>s.debounce(()=>{var E,C;if(!e||!o||!e)return;const c=o.render.with(D.DocSkeletonManagerService).getSkeleton(),{scene:l,mainComponent:A}=o.render,d=l.getViewport(ae.VIEW_MAIN),{actualWidth:u,actualHeight:m}=c.getActualSize(),{width:h,height:g}=o.getBoundingClientRect();let p=d==null?void 0:d.getScrollBar();const f=Math.max(u,h),S=Math.max(m,g);l.transformByState({width:f,height:S}),A==null||A.resize(f,S),t?u>h?(p==null?d&&new _.ScrollBar(d,{barSize:8,enableVertical:!1,enableHorizontal:!0,minThumbSizeV:8}):d==null||d.resetCanvasSizeAndUpdateScroll(),n&&(d==null||d.scrollToBarPos({x:1/0,y:0}))):(p=null,d==null||d.scrollToBarPos({x:0,y:0}),(C=d==null?void 0:d.getScrollBar())==null||C.dispose()):m>g?(p==null?d&&(p=new _.ScrollBar(d,{enableHorizontal:!1,enableVertical:!0,barSize:8,minThumbSizeV:8})):d==null||d.resetCanvasSizeAndUpdateScroll(),n&&(d==null||d.scrollToBarPos({x:0,y:1/0}))):(p=null,d==null||d.scrollToBarPos({x:0,y:0}),(E=d==null?void 0:d.getScrollBar())==null||E.dispose())},30),[o,e,t,n]);return U.useEffect(()=>{if(e&&o){const r=setTimeout(()=>{i(),a()},500);return()=>{clearTimeout(r)}}},[o,e,i,a]),U.useEffect(()=>{if(e&&o){const r=o.input$.subscribe(()=>{a()});return()=>{r.unsubscribe()}}},[o,e,a]),{resize:i,checkScrollBar:a}};function IA(o){const{editorId:t,initialValue:e,container:n,autoFocus:i,isSingle:a}=o,r=U.useMemo(()=>i!=null?i:!1,[]),[c,l]=U.useState(),A=I.useDependency(le);return U.useLayoutEffect(()=>{var d,u;if(n.current){const m=typeof e=="string"?void 0:s.Tools.deepClone(e),h={body:{dataStream:typeof e=="string"?`${e}\r
`:`\r
`,textRuns:[],customBlocks:[],customDecorations:[],customRanges:[],paragraphs:[{startIndex:0}]},...m,documentStyle:{...m==null?void 0:m.documentStyle,pageSize:{width:a?1/0:n.current.clientWidth,height:1/0}},id:t},g=A.register({autofocus:!0,editorUnitId:t,initialSnapshot:h},n.current),p=A.getEditor(t);if(l(p),r){A.focus(t);const f=((u=(d=h.body)==null?void 0:d.dataStream.length)!=null?u:2)-2;p.setSelectionRanges([{startOffset:f,endOffset:f}])}return()=>{g==null||g.dispose()}}},[]),c}const vA=(o,t,e,n)=>{const i=I.useDependency(s.ICommandService),a=I.useDependency(I.IShortcutService),r=U.useRef(t);r.current=t;const c=U.useRef(n);c.current=n,U.useEffect(()=>{if(!e||!o)return;const A=`sheet.formula-embedding-editor.${e.getEditorId()}`,d=new s.DisposableCollection,u=(h,g)=>{if(c.current){c.current(h,g);return}let p=s.Direction.LEFT;h===I.KeyCode.ARROW_DOWN?p=s.Direction.DOWN:h===I.KeyCode.ARROW_UP?p=s.Direction.UP:h===I.KeyCode.ARROW_RIGHT&&(p=s.Direction.RIGHT),g===I.MetaKeys.SHIFT?i.executeCommand(Re.id,{direction:p}):i.executeCommand(Oe.id,{direction:p})};return d.add(i.registerCommand({id:A,type:s.CommandType.OPERATION,handler(h,g){const{keyCode:p}=g;u(p)}})),[{keyCode:I.KeyCode.ARROW_DOWN},{keyCode:I.KeyCode.ARROW_LEFT},{keyCode:I.KeyCode.ARROW_RIGHT},{keyCode:I.KeyCode.ARROW_UP},{keyCode:I.KeyCode.ARROW_DOWN,metaKey:I.MetaKeys.SHIFT},{keyCode:I.KeyCode.ARROW_LEFT,metaKey:I.MetaKeys.SHIFT},{keyCode:I.KeyCode.ARROW_RIGHT,metaKey:I.MetaKeys.SHIFT},{keyCode:I.KeyCode.ARROW_UP,metaKey:I.MetaKeys.SHIFT},{keyCode:I.KeyCode.ARROW_DOWN,metaKey:I.MetaKeys.CTRL_COMMAND},{keyCode:I.KeyCode.ARROW_LEFT,metaKey:I.MetaKeys.CTRL_COMMAND},{keyCode:I.KeyCode.ARROW_RIGHT,metaKey:I.MetaKeys.CTRL_COMMAND},{keyCode:I.KeyCode.ARROW_UP,metaKey:I.MetaKeys.CTRL_COMMAND},{keyCode:I.KeyCode.ARROW_DOWN,metaKey:I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT},{keyCode:I.KeyCode.ARROW_LEFT,metaKey:I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT},{keyCode:I.KeyCode.ARROW_RIGHT,metaKey:I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT},{keyCode:I.KeyCode.ARROW_UP,metaKey:I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT}].map(({keyCode:h,metaKey:g})=>({id:A,binding:g?h|g:h,preconditions:()=>!0,priority:900,staticParameters:{eventType:_.DeviceInputEventType.Keyboard,keyCode:h}})).forEach(h=>{d.add(a.registerShortcut(h))}),()=>{d.dispose()}},[i,e,o,a])};function EA(o,t){const e=I.useDependency(s.ICommandService);U.useEffect(()=>{if(!o)return;const n=e.onCommandExecuted(i=>{var a,r;if(i.id===D.RichTextEditingMutation.id){if(i.params.unitId!==o.getEditorId())return;const l=o.getDocumentData();t(l,s.getPlainText((r=(a=l.body)==null?void 0:a.dataStream)!=null?r:""))}});return()=>{n.dispose()}},[o,t,e])}const CA=o=>{var W;const{className:t,autoFocus:e,onFocusChange:n,initialValue:i,onClickOutside:a,keyboardEventConfig:r,moveCursor:c=!0,style:l,isSingle:A,editorId:d,onHeightChange:u,onChange:m,defaultHeight:h=32,maxHeight:g=32,icon:p,editorRef:f,placeholder:S}=o,E=I.useDependency(le),C=I.useEvent(n),T=I.useEvent(a),[R,v]=U.useState(h),O=U.useRef(null),M=U.useMemo(()=>d!=null?d:s.createInternalEditorID(`RICH_TEXT_EDITOR-${s.generateRandomId(4)}`),[d]),b=IA({editorId:M,initialValue:i,container:O,autoFocus:e,isSingle:A}),x=I.useDependency(_.IRenderManagerService).getRenderById(M),w=x==null?void 0:x.with(y.DocSelectionRenderService),F=I.useObservable(w==null?void 0:w.textSelectionInner$),V=!!((W=w==null?void 0:w.isFocusing)!=null&&W&&(F!=null&&F.textRanges.some(G=>G.collapsed))),H=U.useRef(null),[Q,j]=U.useState(()=>{var G,K;return!s.BuildTextUtils.transform.getPlainText((K=(G=b==null?void 0:b.getDocumentData().body)==null?void 0:G.dataStream)!=null?K:"")}),{checkScrollBar:X}=da(b,A,!0,!0);U.useLayoutEffect(()=>{if(!(!f||!b)){if(typeof f=="function"){f(b);return}f.current=b}},[b]);const k=I.useEvent(G=>{var q,z;const K=x==null?void 0:x.with(D.DocSkeletonManagerService),Y=K==null?void 0:K.getSkeleton().getActualSize();Y&&(u==null||u(Y.actualHeight),v(Math.max(h,Math.min(Y.actualHeight+10,g)))),m==null||m(G,s.getPlainText((z=(q=G.body)==null?void 0:q.dataStream)!=null?z:"")),X()});return U.useEffect(()=>{var K,Y;j(!s.BuildTextUtils.transform.getPlainText((Y=(K=b==null?void 0:b.getDocumentData().body)==null?void 0:K.dataStream)!=null?Y:""));const G=b==null?void 0:b.selectionChange$.subscribe(()=>{var q,z;j(!s.BuildTextUtils.transform.getPlainText((z=(q=b==null?void 0:b.getDocumentData().body)==null?void 0:q.dataStream)!=null?z:""))});return()=>G==null?void 0:G.unsubscribe()},[b]),I.useObservable(b==null?void 0:b.blur$),I.useObservable(b==null?void 0:b.focus$),U.useEffect(()=>{var K,Y;const G=b==null?void 0:b.getDocumentData();C==null||C(V,s.getPlainText((Y=(K=G==null?void 0:G.body)==null?void 0:K.dataStream)!=null?Y:""))},[V,C]),U.useEffect(()=>{const G=Y=>{var z,$;E.getFocusId()!==M||(($=(z=Y.target)==null?void 0:z.dataset)==null?void 0:$.editorid)===M||H.current&&!H.current.contains(Y.target)&&(T==null||T())},K=setTimeout(()=>{document.addEventListener("click",G)},100);return()=>{document.removeEventListener("click",G),clearTimeout(K)}},[b,M,E,T]),vA(V&&c,!1,b),la(V,r,b),EA(b,k),P.jsx("div",{className:t,style:l,children:P.jsxs("div",{className:J.clsx("univer-relative univer-box-border univer-flex univer-h-8 univer-w-full univer-items-center univer-justify-around univer-gap-2 univer-rounded-md univer-pb-0.5 univer-pl-1.5 univer-pr-2 univer-pt-1.5",J.borderClassName,{"univer-border-primary-500":V}),style:{height:R},ref:H,children:[P.jsx("div",{ref:O,className:"univer-relative univer-size-full",onMouseUp:()=>b==null?void 0:b.focus()}),p,Q?P.jsx("div",{className:"univer-absolute univer-left-[5px] univer-top-[5px] univer-text-sm univer-text-gray-500",children:S}):null]})})};y.AfterSpaceCommand=dt,y.AlignCenterCommand=Ct,y.AlignJustifyCommand=yt,y.AlignLeftCommand=Et,y.AlignOperationCommand=ge,y.AlignRightCommand=Tt,y.BreakLineCommand=Qt,y.BulletListCommand=et,y.ChangeListNestingLevelCommand=Yt,y.ChangeListNestingLevelType=It,y.ChangeListTypeCommand=St,y.CheckListCommand=vt,y.CoverContentCommand=ki,y.CreateDocTableCommand=bo,y.CutContentCommand=Ve,y.DOCS_COMPONENT_BACKGROUND_LAYER_INDEX=ai,y.DOCS_COMPONENT_DEFAULT_Z_INDEX=xn,y.DOCS_COMPONENT_HEADER_LAYER_INDEX=ri,y.DOCS_COMPONENT_MAIN_LAYER_INDEX=Ut,y.DOCS_VIEW_KEY=de,y.DOC_UI_PLUGIN_NAME=si,y.DOC_VERTICAL_PADDING=Ho,y.DefaultDocContainerConfig=ii,y.DefaultToolbarConfig=oi,y.DeleteCommand=Ye,y.DeleteCustomBlockCommand=Wt,y.DeleteLeftCommand=ht,y.DeleteRightCommand=Hn,y.DocCopyCommand=mt,y.DocCreateTableOperation=ln,y.DocCutCommand=Kt,y.DocIMEInputManagerService=ft,y.DocPasteCommand=zt,y.DocPrintInterceptorService=sa,y.DocSelectAllCommand=qn,y.DocTableDeleteColumnsCommand=on,y.DocTableDeleteRowsCommand=nn,y.DocTableDeleteTableCommand=it,y.DocTableInsertColumnCommand=es,y.DocTableInsertColumnLeftCommand=rn,y.DocTableInsertColumnRightCommand=cn,y.DocTableInsertRowAboveCommand=sn,y.DocTableInsertRowBellowCommand=an,y.DocTableInsertRowCommand=Mo,y.DocTableTabCommand=xo,y.DocsUIMenuSchema=zs,y.Editor=Is,y.EditorInsertTextCommandId=mi,y.EnterCommand=ze,y.HorizontalLineCommand=pt,y.IDocClipboardService=De,y.IEditorService=le,y.IMEInputCommand=Jn,y.InnerPasteCommand=Ln,y.InsertCommand=Qn,y.InsertCustomRangeCommand=Gi,y.ListOperationCommand=$e,y.MergeTwoParagraphCommand=Gt,y.MoveCursorOperation=Oe,y.MoveSelectionOperation=Re,y.NORMAL_TEXT_SELECTION_PLUGIN_NAME=ma,y.NodePositionConvertToCursor=be,y.NodePositionConvertToRectRange=vo,y.OrderListCommand=tt,y.PastePluginLark=vi,y.PastePluginUniver=Ci,y.PastePluginWord=Ti,y.QuickListCommand=no,y.RectRange=Co,y.ReplaceContentCommand=Hi,y.ReplaceSelectionCommand=eo,y.ReplaceSnapshotCommand=$n,y.ReplaceTextRunsCommand=Wi,y.ResetInlineFormatTextBackgroundColorCommand=Ze,y.RichTextEditor=CA,y.SetDocZoomRatioCommand=bt,y.SetDocZoomRatioOperation=ue,y.SetInlineFormatBoldCommand=Be,y.SetInlineFormatCommand=ye,y.SetInlineFormatFontFamilyCommand=we,y.SetInlineFormatFontSizeCommand=he,y.SetInlineFormatItalicCommand=_e,y.SetInlineFormatStrikethroughCommand=Pe,y.SetInlineFormatSubscriptCommand=Ee,y.SetInlineFormatSuperscriptCommand=Ue,y.SetInlineFormatTextBackgroundColorCommand=Te,y.SetInlineFormatTextColorCommand=Ce,y.SetInlineFormatUnderlineCommand=Ne,y.SetParagraphNamedStyleCommand=ce,y.SwitchDocModeCommand=Rt,y.TEXT_RANGE_LAYER_INDEX=Zt,y.TabCommand=ke,y.TextRange=We,y.ToggleCheckListCommand=to,y.UpdateCommand=Fn,y.VIEWPORT_KEY=ae,y.addCustomDecorationBySelectionFactory=fa,y.addCustomDecorationFactory=li,y.calcDocRangePositions=hn,y.convertBodyToHtml=bi,y.convertPositionsToRectRanges=en,y.deleteCustomDecorationFactory=Sa,y.docDrawingPositionToTransform=va,y.genTableSource=Un,y.generateParagraphs=Nn,y.getAnchorBounding=Ot,y.getCanvasOffsetByEngine=Zi,y.getCommandSkeleton=re,y.getCursorWhenDelete=Xt,y.getCustomBlockIdsInSelections=hi,y.getCutActionsFromDocRanges=gi,y.getDocObject=ci,y.getDocObjectById=pa,y.getEmptyTableCell=Ht,y.getEmptyTableRow=kt,y.getLineBounding=$t,y.getOneTextSelectionRange=po,y.getRichTextEditPath=Z,y.getTableColumn=Vt,y.hasParagraphInTable=Ia,y.isInSameTableCell=So,y.isValidRectRange=zi,y.neoGetDocObject=Ie,y.transformToDocDrawingPosition=Ea,y.useKeyboardEvent=la,y.useResize=da,y.whenDocAndEditorFocused=ee,Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})}));


// @univerjs/docs-ui/facade
(function(n,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("@univerjs/core"),require("@univerjs/core/facade"),require("@univerjs/docs-ui"),require("@univerjs/engine-render")):typeof define=="function"&&define.amd?define(["exports","@univerjs/core","@univerjs/core/facade","@univerjs/docs-ui","@univerjs/engine-render"],e):(n=typeof globalThis<"u"?globalThis:n||self,e(n.UniverDocsUiFacade={},n.UniverCore,n.UniverCoreFacade,n.UniverDocsUi,n.UniverEngineRender))})(this,(function(n,e,a,v,h){"use strict";var D=Object.defineProperty;var U=(n,e,a)=>e in n?D(n,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[e]=a;var m=(n,e,a)=>U(n,typeof e!="symbol"?e+"":e,a);var _=Object.getOwnPropertyDescriptor,g=(o,t,r,i)=>{for(var s=i>1?void 0:i?_(t,r):t,c=o.length-1,u;c>=0;c--)(u=o[c])&&(s=u(s)||s);return s},d=(o,t)=>(r,i)=>t(r,i,o);n.FDocument=class{constructor(t,r,i,s,c,u){m(this,"id");this._documentDataModel=t,this._injector=r,this._univerInstanceService=i,this._commandService=s,this._resourceManagerService=c,this._renderManagerService=u,this.id=this._documentDataModel.getUnitId()}getId(){return this._documentDataModel.getUnitId()}getName(){return this.getSnapshot().title||""}getSnapshot(){const t=this._resourceManagerService.getResourcesByType(this.id,e.UniverInstanceType.UNIVER_DOC),r=this._documentDataModel.getSnapshot();return r.resources=t,r}undo(){return this._univerInstanceService.focusUnit(this.id),this._commandService.executeCommand(e.UndoCommand.id)}redo(){return this._univerInstanceService.focusUnit(this.id),this._commandService.executeCommand(e.RedoCommand.id)}appendText(t){const r=this.id,{body:i}=this.getSnapshot();if(!i)throw new Error("The document body is empty");const s=i.dataStream.length-2,c={startOffset:s,endOffset:s,collapsed:!0,segmentId:""},{segmentId:u}=c;return this._commandService.executeCommand(v.InsertCommand.id,{unitId:r,body:{dataStream:t},range:c,segmentId:u})}setSelection(t,r){var s;const i=(s=this._renderManagerService.getRenderById(this.getId()))==null?void 0:s.with(v.DocSelectionRenderService);i==null||i.removeAllRanges(),i==null||i.addDocRanges([{startOffset:t,endOffset:r,rangeType:e.DOC_RANGE_TYPE.TEXT}],!0)}},n.FDocument=g([d(1,e.Inject(e.Injector)),d(2,e.IUniverInstanceService),d(3,e.ICommandService),d(4,e.IResourceManagerService),d(5,h.IRenderManagerService)],n.FDocument);class I extends a.FUniver{createUniverDoc(t){const r=this._univerInstanceService.createUnit(e.UniverInstanceType.UNIVER_DOC,t);return this._injector.createInstance(n.FDocument,r)}getActiveDocument(){const t=this._univerInstanceService.getCurrentUnitForType(e.UniverInstanceType.UNIVER_DOC);return t?this._injector.createInstance(n.FDocument,t):null}getUniverDoc(t){const r=this._univerInstanceService.getUniverDocInstance(t);return r?this._injector.createInstance(n.FDocument,r):null}}a.FUniver.extend(I),Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})}));


// @univerjs/sheets/index
(function(g,i){typeof exports=="object"&&typeof module<"u"?i(exports,require("@univerjs/core"),require("rxjs"),require("@univerjs/engine-formula"),require("rxjs/operators"),require("@univerjs/rpc")):typeof define=="function"&&define.amd?define(["exports","@univerjs/core","rxjs","@univerjs/engine-formula","rxjs/operators","@univerjs/rpc"],i):(g=typeof globalThis<"u"?globalThis:g||self,i(g.UniverSheets={},g.UniverCore,g.rxjs,g.UniverEngineFormula,g.rxjs.operators,g.UniverRpc))})(this,(function(g,i,O,J,Nt,ji){"use strict";var Yd=Object.defineProperty;var Kd=(g,i,O)=>i in g?Yd(g,i,{enumerable:!0,configurable:!0,writable:!0,value:O}):g[i]=O;var f=(g,i,O)=>Kd(g,typeof i!="symbol"?i+"":i,O);function Gi(s,e,t){var r,a,l;if(e.t)return e.t;if(e.v===null)return null;const n=s.getStyleByCell(e),o=s.getStyleByCell(t);if(t.t===i.CellValueType.FORCE_STRING){if(!i.isTextFormat((r=o==null?void 0:o.n)==null?void 0:r.pattern)&&e.v!==void 0){if(i.isRealNum(e.v))return i.CellValueType.NUMBER;if(i.isBooleanString(`${e.v}`))return i.CellValueType.BOOLEAN}return i.CellValueType.FORCE_STRING}return zi(n)?i.isTextFormat((a=n==null?void 0:n.n)==null?void 0:a.pattern)?i.CellValueType.STRING:no(e,t):i.isTextFormat((l=o==null?void 0:o.n)==null?void 0:l.pattern)?i.CellValueType.STRING:no(e,t)}function no(s,e){return s.v!==void 0?$n(s.v,s.t):$n(e.v,e.t)}function zi(s){var e;return!!((e=s==null?void 0:s.n)!=null&&e.pattern)}function $n(s,e){return s===null?null:typeof s=="string"?i.isRealNum(s)?(+s==0||+s==1)&&e===i.CellValueType.BOOLEAN?i.CellValueType.BOOLEAN:e!==i.CellValueType.STRING&&e!==i.CellValueType.FORCE_STRING&&i.willLoseNumericPrecision(s)?i.CellValueType.FORCE_STRING:i.CellValueType.NUMBER:i.isBooleanString(s)?i.CellValueType.BOOLEAN:i.CellValueType.STRING:typeof s=="number"?(s===0||s===1)&&e===i.CellValueType.BOOLEAN?i.CellValueType.BOOLEAN:i.CellValueType.NUMBER:typeof s=="boolean"?i.CellValueType.BOOLEAN:i.CellValueType.FORCE_STRING}const ge=(s,e)=>{if(s.get(i.IUniverInstanceService).getUniverSheetInstance(e.unitId)==null)throw new Error("universheet is null error!");return{unitId:e.unitId,subUnitId:e.subUnitId,ranges:i.Tools.deepClone(e.ranges)}},j={id:"sheet.mutation.add-worksheet-merge",type:i.CommandType.MUTATION,handler:(s,e)=>{const n=s.get(i.IUniverInstanceService).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const o=n.getSheetBySheetId(e.subUnitId);if(!o)return!1;const a=o.getConfig().mergeData,l=e.ranges;for(let u=0;u<l.length;u++)a.push(l[u]);return o.getSpanModel().rebuild(a),!0}},qi=i.createInterceptorKey("CELL_CONTENT"),Yi=i.createInterceptorKey("ROW_FILTERED"),Ae={CELL_CONTENT:qi,ROW_FILTERED:Yi};var so=(s=>(s[s.DATA_VALIDATION=9]="DATA_VALIDATION",s[s.NUMFMT=10]="NUMFMT",s[s.CELL_IMAGE=11]="CELL_IMAGE",s))(so||{});const oo="sheet.interceptor.range-theme-id",ro="sheet.interceptor.ignore-range-theme";var Ki=Object.getOwnPropertyDescriptor,Ji=(s,e,t,n)=>{for(var o=n>1?void 0:n?Ki(e,t):e,r=s.length-1,a;r>=0;r--)(a=s[r])&&(o=a(o)||o);return o},xi=(s,e)=>(t,n)=>e(t,n,s);const Ln=i.createInterceptorKey("BEFORE_CELL_EDIT"),en=i.createInterceptorKey("AFTER_CELL_EDIT"),tn=i.createInterceptorKey("VALIDATE_CELL");g.SheetInterceptorService=class extends i.Disposable{constructor(t){super();f(this,"_interceptorsByName",new Map);f(this,"_commandInterceptors",[]);f(this,"_rangeInterceptors",[]);f(this,"_autoHeightInterceptors",[]);f(this,"_beforeCommandInterceptor",[]);f(this,"_afterCommandInterceptors",[]);f(this,"_workbookDisposables",new Map);f(this,"_worksheetDisposables",new Map);f(this,"_interceptorsDirty",!1);f(this,"_composedInterceptorByKey",new Map);f(this,"writeCellInterceptor",new i.InterceptorManager({BEFORE_CELL_EDIT:Ln,AFTER_CELL_EDIT:en,VALIDATE_CELL:tn}));this._univerInstanceService=t,this.disposeWithMe(this._univerInstanceService.getTypeOfUnitAdded$(i.UniverInstanceType.UNIVER_SHEET).subscribe(n=>{this._interceptWorkbook(n)})),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitDisposed$(i.UniverInstanceType.UNIVER_SHEET).subscribe(n=>this._disposeWorkbookInterceptor(n))),this.intercept(Ae.CELL_CONTENT,{priority:-1,effect:i.InterceptorEffectEnum.Style|i.InterceptorEffectEnum.Value,handler:n=>n}),this.disposeWithMe(this.writeCellInterceptor.intercept(en,{priority:-1,handler:n=>n})),this.disposeWithMe(this.writeCellInterceptor.intercept(Ln,{priority:-1,handler:n=>n})),this.disposeWithMe(this.writeCellInterceptor.intercept(tn,{priority:-1,handler:n=>n}))}dispose(){super.dispose(),this._workbookDisposables.forEach(t=>t.dispose()),this._workbookDisposables.clear(),this._worksheetDisposables.forEach(t=>t.dispose()),this._worksheetDisposables.clear(),this._interceptorsByName.clear()}interceptCommand(t){if(this._commandInterceptors.includes(t))throw new Error("[SheetInterceptorService]: Interceptor already exists!");return this._commandInterceptors.push(t),this._commandInterceptors.sort((n,o)=>{var r,a;return((r=o.priority)!=null?r:0)-((a=n.priority)!=null?a:0)}),this.disposeWithMe(i.toDisposable(()=>i.remove(this._commandInterceptors,t)))}onCommandExecute(t){const n=this._commandInterceptors.map(o=>o.getMutations(t));return{preUndos:n.map(o=>{var r;return(r=o.preUndos)!=null?r:[]}).flat(),undos:n.map(o=>o.undos).flat(),preRedos:n.map(o=>{var r;return(r=o.preRedos)!=null?r:[]}).flat(),redos:n.map(o=>o.redos).flat()}}interceptAfterCommand(t){if(this._afterCommandInterceptors.includes(t))throw new Error("[SheetInterceptorService]: Interceptor already exists!");return this._afterCommandInterceptors.push(t),this._afterCommandInterceptors.sort((n,o)=>{var r,a;return((r=o.priority)!=null?r:0)-((a=n.priority)!=null?a:0)}),this.disposeWithMe(i.toDisposable(()=>i.remove(this._afterCommandInterceptors,t)))}afterCommandExecute(t){const n=this._afterCommandInterceptors.map(o=>o.getMutations(t));return{undos:n.map(o=>o.undos).flat(),redos:n.map(o=>o.redos).flat()}}interceptAutoHeight(t){if(this._autoHeightInterceptors.includes(t))throw new Error("[SheetInterceptorService]: Interceptor already exists!");return this._autoHeightInterceptors.push(t),this._autoHeightInterceptors.sort((n,o)=>{var r,a;return((r=o.priority)!=null?r:0)-((a=n.priority)!=null?a:0)}),this.disposeWithMe(i.toDisposable(()=>i.remove(this._autoHeightInterceptors,t)))}generateMutationsOfAutoHeight(t){const n=this._autoHeightInterceptors.map(o=>o.getMutations(t));return{preUndos:n.map(o=>{var r;return(r=o.preUndos)!=null?r:[]}).flat(),undos:n.map(o=>o.undos).flat(),preRedos:n.map(o=>{var r;return(r=o.preRedos)!=null?r:[]}).flat(),redos:n.map(o=>o.redos).flat()}}interceptBeforeCommand(t){if(this._beforeCommandInterceptor.includes(t))throw new Error("[SheetInterceptorService]: Interceptor already exists!");return this._beforeCommandInterceptor.push(t),this._beforeCommandInterceptor.sort((n,o)=>{var r,a;return((r=o.priority)!=null?r:0)-((a=n.priority)!=null?a:0)}),this.disposeWithMe(i.toDisposable(()=>i.remove(this._beforeCommandInterceptor,t)))}async beforeCommandExecute(t){return(await Promise.all(this._beforeCommandInterceptor.map(o=>o.performCheck(t)))).every(o=>o)}interceptRanges(t){if(this._rangeInterceptors.includes(t))throw new Error("[SheetInterceptorService]: Interceptor already exists!");return this._rangeInterceptors.push(t),this._rangeInterceptors.sort((n,o)=>{var r,a;return((r=o.priority)!=null?r:0)-((a=n.priority)!=null?a:0)}),this.disposeWithMe(i.toDisposable(()=>i.remove(this._rangeInterceptors,t)))}generateMutationsByRanges(t){const n=this._rangeInterceptors.map(o=>o.getMutations(t));return{preUndos:n.map(o=>{var r;return(r=o.preUndos)!=null?r:[]}).flat(),undos:n.map(o=>o.undos).flat(),preRedos:n.map(o=>{var r;return(r=o.preRedos)!=null?r:[]}).flat(),redos:n.map(o=>o.redos).flat()}}onWriteCell(t,n,o,r,a){const l={subUnitId:n.getSheetId(),unitId:t.getUnitId(),workbook:t,worksheet:n,row:o,col:r,origin:i.Tools.deepClone(a)};return this.writeCellInterceptor.fetchThroughInterceptors(en)(a,l)}onValidateCell(t,n,o,r){const a={subUnitId:n.getSheetId(),unitId:t.getUnitId(),workbook:t,worksheet:n,row:o,col:r};return this.writeCellInterceptor.fetchThroughInterceptors(tn)(Promise.resolve(!0),a)}intercept(t,n){const o=t;this._interceptorsByName.has(o)||this._interceptorsByName.set(o,[]);const r=this._interceptorsByName.get(o);r.push(n);const a=r.sort((l,u)=>{var d,c;return((d=u.priority)!=null?d:0)-((c=l.priority)!=null?c:0)});if(this._interceptorsDirty=!0,o===Ae.CELL_CONTENT){const l=i.InterceptorEffectEnum.Style|i.InterceptorEffectEnum.Value;this._interceptorsByName.set(`${o}-${l}`,a);const u=i.InterceptorEffectEnum.Style|i.InterceptorEffectEnum.Value;return this._interceptorsByName.set(`${o}-${i.InterceptorEffectEnum.Style}`,a.filter(d=>((d.effect||u)&i.InterceptorEffectEnum.Style)>0)),this._interceptorsByName.set(`${o}-${i.InterceptorEffectEnum.Value}`,a.filter(d=>((d.effect||u)&i.InterceptorEffectEnum.Value)>0)),this.disposeWithMe(i.toDisposable(()=>{i.remove(this._interceptorsByName.get(o),n),i.remove(this._interceptorsByName.get(`${o}-${l}`),n),i.remove(this._interceptorsByName.get(`${o}-${i.InterceptorEffectEnum.Style}`),n),i.remove(this._interceptorsByName.get(`${o}-${i.InterceptorEffectEnum.Value}`),n)}))}else return this._interceptorsByName.set(o,a),this.disposeWithMe(i.toDisposable(()=>i.remove(this._interceptorsByName.get(o),n)))}fetchThroughInterceptors(t,n,o,r){const a=n===void 0?t:`${t}-${n}`,l=o!=null?o:a;let u=this._composedInterceptorByKey.get(l);if(!u||this._interceptorsDirty){let d=this._interceptorsByName.get(a);d&&r&&(d=d.filter(r)),u=i.composeInterceptors(d||[]),this._composedInterceptorByKey.set(l,u)}return u}_interceptWorkbook(t){const n=new i.DisposableCollection,o=t.getUnitId(),r=this,a=l=>{const u=l.getSheetId();l.__interceptViewModel(d=>{const c=new i.DisposableCollection;r._worksheetDisposables.set(io(o,l),c),c.add(d.registerCellContentInterceptor({getCell(m,h,R,C,S){const I=l.getCellRaw(m,h);return r.fetchThroughInterceptors(Ae.CELL_CONTENT,R,C,S)(I,{unitId:o,subUnitId:u,row:m,col:h,worksheet:l,workbook:t,rawData:I})}})),c.add(d.registerRowFilteredInterceptor({getRowFiltered(m){return!!r.fetchThroughInterceptors(Ae.ROW_FILTERED)(!1,{unitId:o,subUnitId:u,row:m,workbook:t,worksheet:l})}}))})};t.getSheets().forEach(l=>a(l)),n.add(t.sheetCreated$.subscribe(l=>a(l))),n.add(i.toDisposable(()=>t.getSheets().forEach(l=>this._disposeSheetInterceptor(o,l)))),n.add(t.sheetDisposed$.subscribe(l=>this._disposeSheetInterceptor(o,l))),this._workbookDisposables.set(o,n)}_disposeWorkbookInterceptor(t){const n=t.getUnitId(),o=this._workbookDisposables.get(n);o&&(o.dispose(),this._workbookDisposables.delete(n))}_disposeSheetInterceptor(t,n){const o=io(t,n),r=this._worksheetDisposables.get(o);r&&(r.dispose(),this._worksheetDisposables.delete(o))}},g.SheetInterceptorService=Ji([xi(0,i.IUniverInstanceService)],g.SheetInterceptorService);function io(s,e){return`${s}|${e.getSheetId()}`}const Z=s=>{const e={};return s.bg&&(e.bg={...s.bg}),s.ol&&(e.ol={...s.ol}),s.bd&&(e.bd={...s.bd}),s.cl&&(e.cl={...s.cl}),s.ht&&(e.ht=s.ht),s.vt&&(e.vt=s.vt),s.bl!==void 0&&(e.bl=s.bl),e};function Xi(s){const e={};if(s.length===1)return s[0];for(const t of s)t.bg&&(e.bg=t.bg),t.ol&&(e.ol=t.ol),t.bd&&(e.bd={...e.bd,...t.bd}),t.cl&&(e.cl=t.cl),t.ht&&(e.ht=t.ht),t.vt&&(e.vt=t.vt),t.bl!==void 0&&(e.bl=t.bl);return e}const x={wholeStyle:1,headerRowStyle:2,headerColumnStyle:4,firstRowStyle:8,secondRowStyle:16,lastRowStyle:32,firstColumnStyle:128,secondColumnStyle:256,lastColumnStyle:512};class We{constructor(e,t){f(this,"_name");f(this,"wholeStyle",null);f(this,"headerRowStyle",null);f(this,"headerColumnStyle",null);f(this,"firstRowStyle",null);f(this,"secondRowStyle",null);f(this,"lastRowStyle",null);f(this,"firstColumnStyle",null);f(this,"secondColumnStyle",null);f(this,"lastColumnStyle",null);f(this,"_mergeCacheMap",new Map);t&&this.fromJson({...t,name:e}),this._name=e}getName(){return this._name}getWholeStyle(){return this.wholeStyle}setWholeStyle(e){this.wholeStyle=e,this._resetStyleCache()}getFirstRowStyle(){return this.firstRowStyle}setFirstRowStyle(e){this.firstRowStyle=e,this._resetStyleCache()}getSecondRowStyle(){return this.secondRowStyle}setSecondRowStyle(e){this.secondRowStyle=e,this._resetStyleCache()}getLastRowStyle(){return this.lastRowStyle}setLastRowStyle(e){this.lastRowStyle=e,this._resetStyleCache()}getFirstColumnStyle(){return this.firstColumnStyle}setFirstColumnStyle(e){this.firstColumnStyle=e,this._resetStyleCache()}getSecondColumnStyle(){return this.secondColumnStyle}setSecondColumnStyle(e){this.secondColumnStyle=e,this._resetStyleCache()}getLastColumnStyle(){return this.lastColumnStyle}setLastColumnStyle(e){this.lastColumnStyle=e,this._resetStyleCache()}getHeaderRowStyle(){return this.headerRowStyle}setHeaderRowStyle(e){this.headerRowStyle=e,this._resetStyleCache()}getHeaderColumnStyle(){return this.headerColumnStyle}setHeaderColumnStyle(e){this.headerColumnStyle=e,this._resetStyleCache()}getStyle(e,t,n,o,r){let a=0;return n&&(a=a|x.lastRowStyle),o&&(a=a|x.lastColumnStyle),e>=0&&t>=0&&(a=a|x.wholeStyle),e%2===1&&(a=a|(r?x.secondRowStyle:x.firstRowStyle)),e%2===0&&(a=a|(r?x.firstRowStyle:x.secondRowStyle)),e===0&&(a=a|x.headerRowStyle),t===0&&(a=a|x.headerColumnStyle),t%2===1&&(a=a|x.firstColumnStyle),t%2===0&&(a=a|x.secondColumnStyle),a===0?null:this._getMergeStyle(a)}_getMergeStyle(e){let t=this._mergeCacheMap.get(e);return t||(t=this._mergeStyle(e),this._mergeCacheMap.set(e,t)),t}_mergeStyle(e){const t=[];return this.wholeStyle&&e&x.wholeStyle&&t.push(this.wholeStyle),this.firstColumnStyle&&e&x.firstColumnStyle&&t.push(this.firstColumnStyle),this.secondColumnStyle&&e&x.secondColumnStyle&&t.push(this.secondColumnStyle),this.firstRowStyle&&e&x.firstRowStyle&&t.push(this.firstRowStyle),this.secondRowStyle&&e&x.secondRowStyle&&t.push(this.secondRowStyle),this.headerColumnStyle&&e&x.headerColumnStyle&&t.push(this.headerColumnStyle),this.lastColumnStyle&&e&x.lastColumnStyle&&t.push(this.lastColumnStyle),this.headerRowStyle&&e&x.headerRowStyle&&t.push(this.headerRowStyle),this.lastRowStyle&&e&x.lastRowStyle&&t.push(this.lastRowStyle),Xi(t)}_resetStyleCache(){this._mergeCacheMap.clear()}toJson(){const e={name:this._name};return this.wholeStyle&&(e.wholeStyle=Z(this.wholeStyle)),this.headerRowStyle&&(e.headerRowStyle=Z(this.headerRowStyle)),this.headerColumnStyle&&(e.headerColumnStyle=Z(this.headerColumnStyle)),this.firstRowStyle&&(e.firstRowStyle=Z(this.firstRowStyle)),this.secondRowStyle&&(e.secondRowStyle=Z(this.secondRowStyle)),this.lastRowStyle&&(e.lastRowStyle=Z(this.lastRowStyle)),this.firstColumnStyle&&(e.firstColumnStyle=Z(this.firstColumnStyle)),this.secondColumnStyle&&(e.secondColumnStyle=Z(this.secondColumnStyle)),this.lastColumnStyle&&(e.lastColumnStyle=Z(this.lastColumnStyle)),e}fromJson(e){this._name=e.name,e.wholeStyle&&(this.wholeStyle=Z(e.wholeStyle)),e.headerRowStyle&&(this.headerRowStyle=Z(e.headerRowStyle)),e.headerColumnStyle&&(this.headerColumnStyle=Z(e.headerColumnStyle)),e.firstRowStyle&&(this.firstRowStyle=Z(e.firstRowStyle)),e.secondRowStyle&&(this.secondRowStyle=Z(e.secondRowStyle)),e.lastRowStyle&&(this.lastRowStyle=Z(e.lastRowStyle)),e.firstColumnStyle&&(this.firstColumnStyle=Z(e.firstColumnStyle)),e.secondColumnStyle&&(this.secondColumnStyle=Z(e.secondColumnStyle)),e.lastColumnStyle&&(this.lastColumnStyle=Z(e.lastColumnStyle))}dispose(){this._mergeCacheMap.clear()}}const Zi=(s,e,t)=>new We(`light-${s}`,{headerRowStyle:{bg:{rgb:e}},firstColumnStyle:{bg:{rgb:"rgb(255, 255, 255)"}},secondColumnStyle:{bg:{rgb:t}},lastRowStyle:{bg:{rgb:e}}}),Qi=(s,e,t)=>new We(`middle-${s}`,{headerRowStyle:{bg:{rgb:e}},headerColumnStyle:{bg:{rgb:t}},secondRowStyle:{bg:{rgb:t}},lastRowStyle:{bg:{rgb:e}},lastColumnStyle:{bg:{rgb:t}}}),ea=(s,e,t,n)=>new We(`dark-${s}`,{headerRowStyle:{bg:{rgb:e},cl:{rgb:"rgb(255, 255, 255)"},ht:i.HorizontalAlign.CENTER,bl:i.BooleanNumber.TRUE},firstRowStyle:{bg:{rgb:t}},secondRowStyle:{bg:{rgb:n}},lastRowStyle:{bg:{rgb:e}}}),ta=[{baseName:"blue",header:"rgb(164, 202, 254)",color:"rgb(225, 239, 254)"},{baseName:"grey",header:"rgb(205, 208, 216)",color:"rgb(238, 239, 241)"},{baseName:"red",header:"rgb(248, 180, 180)",color:"rgb(253, 232, 232)"},{baseName:"orange",header:"rgb(253, 186, 140)",color:"rgb(254, 236, 220)"},{baseName:"yellow",header:"rgb(250, 200, 21)",color:"rgb(255, 244, 185)"},{baseName:"green",header:"rgb(132, 225, 188)",color:"rgb(222, 247, 236)"},{baseName:"azure",header:"rgb(126, 220, 226)",color:"rgb(213, 245, 246)"},{baseName:"indigo",header:"rgb(186, 198, 248)",color:"rgb(233, 237, 255)"},{baseName:"purple",header:"rgb(202, 191, 253)",color:"rgb(237, 235, 254)"},{baseName:"magenta",header:"rgb(248, 180, 217)",color:"rgb(252, 232, 243)"}],na=[{baseName:"blue",rowHeader:"rgb(63, 131, 248)",colHeader:"rgb(195, 221, 253)"},{baseName:"grey",rowHeader:"rgb(95, 101, 116)",colHeader:"rgb(227, 229, 234)"},{baseName:"red",rowHeader:"rgb(240, 82, 82)",colHeader:"rgb(251, 213, 213)"},{baseName:"orange",rowHeader:"rgb(255, 90, 31)",colHeader:"rgb(252, 217, 189)"},{baseName:"yellow",rowHeader:"rgb(212, 157, 15)",colHeader:"rgb(252, 220, 106)"},{baseName:"green",rowHeader:"rgb(13, 164, 113)",colHeader:"rgb(188, 240, 218)"},{baseName:"azure",rowHeader:"rgb(6, 148, 162)",colHeader:"rgb(175, 236, 239)"},{baseName:"indigo",rowHeader:"rgb(70, 106, 247)",colHeader:"rgb(210, 218, 250)"},{baseName:"purple",rowHeader:"rgb(144, 97, 249)",colHeader:"rgb(220, 215, 254)"},{baseName:"magenta",rowHeader:"rgb(231, 70, 148)",colHeader:"rgb(250, 209, 232)"}],sa=[{baseName:"blue",rowHeader:"rgb(30, 66, 159)",firstRow:"rgb(195, 221, 253)",secondRow:"rgb(118, 169, 250)"},{baseName:"grey",rowHeader:"rgb(44, 48, 64)",firstRow:"rgb(227, 229, 234)",secondRow:"rgb(151, 157, 172)"},{baseName:"red",rowHeader:"rgb(155, 28, 28)",firstRow:"rgb(251, 213, 213)",secondRow:"rgb(249, 128, 128)"},{baseName:"orange",rowHeader:"rgb(180, 52, 3)",firstRow:"rgb(252, 217, 189)",secondRow:"rgb(255, 138, 76)"},{baseName:"yellow",rowHeader:"rgb(154, 109, 21)",firstRow:"rgb(252, 220, 106)",secondRow:"rgb(212, 157, 15)"},{baseName:"green",rowHeader:"rgb(4, 108, 78)",firstRow:"rgb(188, 240, 218)",secondRow:"rgb(49, 196, 141)"},{baseName:"azure",rowHeader:"rgb(3, 102, 114)",firstRow:"rgb(175, 236, 239)",secondRow:"rgb(22, 189, 202)"},{baseName:"indigo",rowHeader:"rgb(16, 51, 191)",firstRow:"rgb(210, 218, 250)",secondRow:"rgb(98, 128, 249)"},{baseName:"purple",rowHeader:"rgb(74, 29, 150)",firstRow:"rgb(220, 215, 254)",secondRow:"rgb(172, 148, 250)"},{baseName:"magenta",rowHeader:"rgb(153, 21, 75)",firstRow:"rgb(250, 209, 232)",secondRow:"rgb(241, 126, 184)"}],oa=ta.map(({baseName:s,header:e,color:t})=>Zi(s,e,t)),ra=na.map(({baseName:s,rowHeader:e,colHeader:t})=>Qi(s,e,t)),ia=sa.map(({baseName:s,rowHeader:e,firstRow:t,secondRow:n})=>ea(s,e,t,n)),aa=[...oa,...ra,...ia],ao={headerRowStyle:{bg:{rgb:"rgb(68,114,196)"},cl:{rgb:"rgb(255,255,255)"},ht:i.HorizontalAlign.CENTER,bl:i.BooleanNumber.TRUE},firstRowStyle:{bg:{rgb:"rgb(217,225,242)"}}},la=new We("default",ao),ua=new We("default-last-row",{...ao,lastRowStyle:{bd:{t:{s:i.BorderStyleTypes.THIN,cl:{rgb:"rgb(68,114,196)"}}},ht:i.HorizontalAlign.CENTER,bl:i.BooleanNumber.TRUE}});class da{constructor(){f(this,"_toggleRanges",[])}refresh(e,t){const{startRow:n,endRow:o}=e,r=[];let a=0,l=!1,u=-1;for(let d=n;d<=o;d++){if(!t(d)){a++,a%2===1?l=!0:(l=!1,u!==-1&&(r.push([u,d-1]),u=-1));continue}a%2===1?l?u===-1&&(u=d):(l=!0,u=d):l&&(r.push([u,d-2]),l=!1,u=-1),d===o&&l&&r.push([u,d])}this._toggleRanges=r}getToggleRanges(){return this._toggleRanges.concat()}getIsToggled(e){let t=0,n=this._toggleRanges.length-1;for(;t<=n;){const o=Math.floor((t+n)/2),[r,a]=this._toggleRanges[o];if(e<r)n=o-1;else if(e>a)t=o+1;else return!0}return!1}}var ca=Object.getOwnPropertyDescriptor,ma=(s,e,t,n)=>{for(var o=n>1?void 0:n?ca(e,t):e,r=s.length-1,a;r>=0;r--)(a=s[r])&&(o=a(o)||o);return o},Bn=(s,e)=>(t,n)=>e(t,n,s);const ha="SHEET_RANGE_THEME_MODEL_PLUGIN";g.SheetRangeThemeModel=class extends i.Disposable{constructor(t,n,o){super();f(this,"_rangeThemeStyleMap",new Map);f(this,"_rangeThemeStyleRuleMap",new Map);f(this,"_rTreeCollection",new Map);f(this,"_defaultRangeThemeMap",new Map);f(this,"_zebraCrossingCacheMap",new Map);f(this,"_rowVisibleFuncSet",new Map);f(this,"_rangeThemeMapChanged$",new O.Subject);f(this,"rangeThemeMapChange$",this._rangeThemeMapChanged$.asObservable());this._sheetInterceptorService=t,this._resourceManagerService=n,this._univerInstanceService=o,this._registerIntercept(),this._initSnapshot(),this._initDefaultTheme()}_initDefaultTheme(){this.registerDefaultRangeTheme(la),this.registerDefaultRangeTheme(ua);for(const t of aa)this.registerDefaultRangeTheme(t)}_ensureRangeThemeStyleMap(t){return this._rangeThemeStyleMap.has(t)||this._rangeThemeStyleMap.set(t,new Map),this._rangeThemeStyleMap.get(t)}_ensureRangeThemeStyleRuleMap(t){return this._rangeThemeStyleRuleMap.has(t)||this._rangeThemeStyleRuleMap.set(t,new Map),this._rangeThemeStyleRuleMap.get(t)}_ensureRTreeCollection(t){return this._rTreeCollection.has(t)||this._rTreeCollection.set(t,new i.RTree),this._rTreeCollection.get(t)}getDefaultRangeThemeStyle(t){return this._defaultRangeThemeMap.get(t)}getCustomRangeThemeStyle(t,n){return this._ensureRangeThemeStyleMap(t).get(n)}_getSheetRowVisibleFuncSet(t,n){this._rowVisibleFuncSet.has(t)||this._rowVisibleFuncSet.set(t,new Map);const o=this._rowVisibleFuncSet.get(t);return o.has(n)||o.set(n,new Set),o.get(n)}_getSheetRowVisibleHasInit(t,n){var o;return!!(this._rowVisibleFuncSet.has(t)&&((o=this._rowVisibleFuncSet.get(t))!=null&&o.has(n)))}refreshSheetRowVisibleFuncSet(t,n){const o=this._getSheetRowVisibleFuncSet(t,n);o.clear();const r=this._univerInstanceService.getUnit(t);if(r){const a=r.getSheetBySheetId(n);if(a){const l=a.getRowCount(),u=a.getRowManager();for(let d=1;d<=l;d++)a.getRowVisible(d)?u.getRowHeight(d)===0&&o.add(d):o.add(d)}}}_ensureZebraCrossingCache(t,n,o){this._zebraCrossingCacheMap.has(t)||this._zebraCrossingCacheMap.set(t,new Map);const r=this._zebraCrossingCacheMap.get(t);r.has(n)||r.set(n,new Map);const a=r.get(n);return a.has(o)||a.set(o,new da),a.get(o)}registerRangeThemeRule(t,n){const{unitId:o,subUnitId:r,range:a}=n,l=i.generateRandomId(),u=this._ensureRangeThemeStyleRuleMap(o),d=this._ensureRTreeCollection(o);u.set(l,{rangeInfo:n,themeName:t}),d.insert({unitId:o,sheetId:r,range:a,id:l}),this._getSheetRowVisibleHasInit(o,r)||this.refreshSheetRowVisibleFuncSet(o,r);const c=this._ensureZebraCrossingCache(o,r,l),m=this._getSheetRowVisibleFuncSet(o,r);c.refresh(a,h=>!m.has(h))}getRegisteredRangeThemeStyle(t){const{unitId:n,subUnitId:o,range:r}=t,a=this._ensureRTreeCollection(n),l=Array.from(a.bulkSearch([{unitId:n,sheetId:o,range:r}]));if(l[0]){const d=this._ensureRangeThemeStyleRuleMap(n).get(l[0]);if(d)return d.themeName}}refreshZebraCrossingCacheBySheet(t,n){this._zebraCrossingCacheMap.has(t)||this._zebraCrossingCacheMap.set(t,new Map);const o=this._zebraCrossingCacheMap.get(t);o.has(n)||o.set(n,new Map);const r=o.get(n);r&&r.forEach((a,l)=>{const d=this._ensureRangeThemeStyleRuleMap(t).get(l);d?a.refresh(d.rangeInfo.range,c=>!this._getSheetRowVisibleFuncSet(t,n).has(c)):r.delete(l)})}removeRangeThemeRule(t,n){const{unitId:o,subUnitId:r,range:a}=n,l=this._ensureRTreeCollection(o),u=Array.from(l.bulkSearch([{unitId:o,sheetId:r,range:a}])),d=this._ensureRangeThemeStyleRuleMap(o);for(let c=0;c<u.length;c++){const m=d.get(u[c]);if(m&&m.themeName===t){d.delete(u[c]),l.remove({unitId:o,sheetId:r,range:a,id:u[c]});const h=this._zebraCrossingCacheMap.get(o);if(h){const R=h.get(r);R&&R.delete(u[c])}break}}}registerDefaultRangeTheme(t){this._defaultRangeThemeMap.set(t.getName(),t),this._rangeThemeMapChanged$.next({type:"add",styleName:t.getName()})}unRegisterDefaultRangeTheme(t){this._defaultRangeThemeMap.delete(t),this._rangeThemeMapChanged$.next({type:"remove",styleName:t})}getRegisteredRangeThemes(){return Array.from(this._defaultRangeThemeMap.keys())}registerRangeThemeStyle(t,n){this._ensureRangeThemeStyleMap(t).set(n.getName(),n),this._rangeThemeMapChanged$.next({type:"add",styleName:n.getName()})}unregisterRangeThemeStyle(t,n){this._ensureRangeThemeStyleMap(t).delete(n),this._rangeThemeMapChanged$.next({type:"remove",styleName:n})}getALLRegisteredTheme(t){return Array.from(this._ensureRangeThemeStyleMap(t).keys())}getRangeThemeStyle(t,n){return this._defaultRangeThemeMap.has(n)?this._defaultRangeThemeMap.get(n):this._ensureRangeThemeStyleMap(t).get(n)}getCellStyle(t,n,o,r){const a={startRow:o,startColumn:r,endRow:o,endColumn:r},l=this._ensureRTreeCollection(t),u=Array.from(l.bulkSearch([{unitId:t,sheetId:n,range:a}]));if(u[0]){const c=this._ensureRangeThemeStyleRuleMap(t).get(u[0]);if(c){const{rangeInfo:m,themeName:h}=c,R=o-m.range.startRow,C=r-m.range.startColumn,S=this.getRangeThemeStyle(t,h),v=this._ensureZebraCrossingCache(t,n,u[0]).getIsToggled(o);if(S)return S.getStyle(R,C,o===m.range.endRow,r===m.range.endColumn,v)}}}_registerIntercept(){this.disposeWithMe(this._sheetInterceptorService.intercept(Ae.CELL_CONTENT,{id:oo,effect:i.InterceptorEffectEnum.Style,handler:(t,n,o)=>{const{row:r,col:a,unitId:l,subUnitId:u}=n,d=this.getCellStyle(l,u,r,a);if(d){const c=!t||t===n.rawData?{...n.rawData}:t;return c.themeStyle=d,o(c)}return o(t)}}))}toJson(t){const n=this._ensureRangeThemeStyleRuleMap(t),o=this._ensureRangeThemeStyleMap(t);if(o.size===0&&n.size===0)return"{}";const r={};n.forEach((l,u)=>{r[u]=l});const a={};return o.forEach((l,u)=>{a[u]=l.toJson()}),JSON.stringify({rangeThemeStyleRuleMap:r,rangeThemeStyleMapJson:a})}fromJSON(t,n){const{rangeThemeStyleRuleMap:o,rangeThemeStyleMapJson:r}=n;o&&Object.keys(o).forEach(a=>{const l=o[a],{themeName:u,rangeInfo:d}=l;u.startsWith("table")||(this.registerRangeThemeRule(u,d),this._ensureRTreeCollection(d.unitId).insert({unitId:a,sheetId:d.subUnitId,range:d.range,id:a}))}),r&&Object.keys(r).forEach(a=>{const l=r[a],u=new We(l.name);u.fromJson(l),this._ensureRangeThemeStyleMap(t).set(u.getName(),u)})}deleteUnitId(t){this._rangeThemeStyleMap.delete(t),this._rangeThemeStyleRuleMap.delete(t),this._rTreeCollection.delete(t)}_initSnapshot(){this.disposeWithMe(this._resourceManagerService.registerPluginResource({toJson:t=>this.toJson(t),parseJson:t=>{if(!t)return{};try{return JSON.parse(t)}catch{return{}}},businesses:[i.UniverInstanceType.UNIVER_SHEET],pluginName:ha,onLoad:(t,n)=>{this.fromJSON(t,n)},onUnLoad:t=>{this.deleteUnitId(t)}}))}dispose(){super.dispose(),this._rangeThemeStyleMap.clear(),this._rangeThemeStyleRuleMap.clear(),this._defaultRangeThemeMap.clear(),this._rTreeCollection.clear(),this._zebraCrossingCacheMap.clear(),this._rowVisibleFuncSet.clear()}},g.SheetRangeThemeModel=ma([Bn(0,i.Inject(g.SheetInterceptorService)),Bn(1,i.Inject(i.IResourceManagerService)),Bn(2,i.Inject(i.IUniverInstanceService))],g.SheetRangeThemeModel);function Hn(s,e){const{unitId:t}=e,n=t?s.getUnit(t,i.UniverInstanceType.UNIVER_SHEET):s.getCurrentUnitOfType(i.UniverInstanceType.UNIVER_SHEET);return n?{workbook:n,unitId:n.getUnitId()}:null}function P(s,e={}){const{unitId:t,subUnitId:n}=e,o=t?s.getUnit(t,i.UniverInstanceType.UNIVER_SHEET):s.getCurrentUnitOfType(i.UniverInstanceType.UNIVER_SHEET);if(!o)return null;const r=n?o.getSheetBySheetId(n):o.getActiveSheet(!0);return r?{worksheet:r,workbook:o,unitId:o.getUnitId(),subUnitId:r.getSheetId()}:null}function ve(s,e){const{unitId:t,subUnitId:n}=e,o=s.getUnit(t,i.UniverInstanceType.UNIVER_SHEET);if(!o)return null;const r=o.getSheetBySheetId(n);return r?{worksheet:r,workbook:o}:null}const it={id:"sheet.mutation.set-worksheet-range-theme-style",type:i.CommandType.MUTATION,handler:(s,e)=>{const{unitId:t,subUnitId:n,range:o,themeName:r}=e,a=s.get(i.IUniverInstanceService),l=P(a),u=s.get(g.SheetRangeThemeModel);return l?(u.registerRangeThemeRule(r,{range:o,unitId:t,subUnitId:n}),!0):!1}},lo=(s,e)=>{const t=ve(s.get(i.IUniverInstanceService),e);if(!t)throw new Error("[SetWorksheetRangeThemeStyleMutation]: worksheet is null error!");const{worksheet:n}=t;return{unitId:e.unitId,subUnitId:n.getSheetId(),range:e.range,themeName:e.themeName}},at={id:"sheet.mutation.remove-worksheet-range-theme-style",type:i.CommandType.MUTATION,handler:(s,e)=>{const{unitId:t,subUnitId:n,range:o,themeName:r}=e,a=s.get(i.IUniverInstanceService),l=P(a),u=s.get(g.SheetRangeThemeModel);return l?(u.removeRangeThemeRule(r,{range:o,unitId:t,subUnitId:n}),!0):!1}},uo=(s,e)=>{const t=ve(s.get(i.IUniverInstanceService),e);if(!t)throw new Error("[DeleteWorksheetRangeThemeStyleMutationFactory]: worksheet is null error!");const{worksheet:n}=t;return{unitId:e.unitId,subUnitId:n.getSheetId(),range:e.range,themeName:e.themeName}},nn=(s,e)=>{if(s.get(i.IUniverInstanceService).getUniverSheetInstance(e.unitId)==null)throw new Error("universheet is null error!");return{unitId:e.unitId,subUnitId:e.subUnitId,range:e.range}},re={id:"sheet.mutation.insert-row",type:i.CommandType.MUTATION,handler:(s,e)=>{var C;const{unitId:t,subUnitId:n,range:o,rowInfo:r}=e,l=s.get(i.IUniverInstanceService).getUniverSheetInstance(t);if(l==null)throw new Error("universheet is null error!");const u=l.getSheetBySheetId(n);if(u==null)throw new Error("worksheet is null error!");const d=u.getRowManager().getRowData(),c={h:u.getConfig().defaultRowHeight,hd:0},m=o.startRow,h=o.endRow-o.startRow+1;for(let S=m;S<m+h;S++)r?i.insertMatrixArray(S,(C=r[S-o.startRow])!=null?C:c,d):i.insertMatrixArray(S,c,d);return u.setRowCount(u.getRowCount()+h),u.getCellMatrix().insertRows(o.startRow,h),!0}},Ot=(s,e)=>{if(s.get(i.IUniverInstanceService).getUniverSheetInstance(e.unitId)==null)throw new Error("universheet is null error!");return{unitId:e.unitId,subUnitId:e.subUnitId,range:e.range}},ie={id:"sheet.mutation.insert-col",type:i.CommandType.MUTATION,handler:(s,e)=>{var C;const n=s.get(i.IUniverInstanceService).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const o=n.getSheetBySheetId(e.subUnitId);if(!o)return!1;const r=o.getColumnManager(),{range:a,colInfo:l}=e,d=r.getColumnData(),c=a.startColumn,m=a.endColumn-a.startColumn+1,h=o.getConfig().defaultColumnWidth;for(let S=c;S<c+m;S++){const I={w:h,hd:0};l?i.insertMatrixArray(S,(C=l[S-a.startColumn])!=null?C:I,d):i.insertMatrixArray(S,I,d)}return o.setColumnCount(o.getColumnCount()+a.endColumn-a.startColumn+1),o.getCellMatrix().insertColumns(a.startColumn,m),!0}},Le={id:"sheet.mutation.move-range",type:i.CommandType.MUTATION,handler:(s,e)=>{const{from:t,to:n}=e;if(!t||!n)return!1;const r=s.get(i.IUniverInstanceService).getCurrentUnitForType(i.UniverInstanceType.UNIVER_SHEET);if(!r)return!1;const a=r.getSheetBySheetId(e.from.subUnitId),l=r.getSheetBySheetId(e.to.subUnitId);if(!a||!l)return!1;const u=a.getCellMatrix(),d=l.getCellMatrix();return new i.ObjectMatrix(t.value).forValue((c,m,h)=>{h==null?u.realDeleteValue(c,m):u.setValue(c,m,h)}),new i.ObjectMatrix(n.value).forValue((c,m,h)=>{h==null?d.realDeleteValue(c,m):d.setValue(c,m,h)}),!0}};function co(s,e){const{unitId:t,subUnitId:n,sourceRange:o,targetRange:r}=e,a=o.startRow>r.startRow,l=o.endRow-o.startRow+1;return a?{unitId:t,subUnitId:n,sourceRange:i.Rectangle.clone(r),targetRange:{...o,endRow:o.endRow+l,startRow:o.startRow+l}}:{unitId:t,subUnitId:n,targetRange:i.Rectangle.clone(o),sourceRange:{...r,endRow:r.endRow-l,startRow:r.startRow-l}}}const pe={id:"sheet.mutation.move-rows",type:i.CommandType.MUTATION,handler:(s,e)=>{const{unitId:t,subUnitId:n,sourceRange:o,targetRange:r}=e,l=s.get(i.IUniverInstanceService).getUniverSheetInstance(t);if(!l)throw new Error("[MoveRowMutation] univerSheet is null!");const u=l.getSheetBySheetId(n);if(!u)throw new Error("[MoveRowMutation] worksheet is null!");const d=o.startRow,c=o.endRow-o.startRow+1,m=r.startRow,h=u.getRowManager().getRowData();return i.moveMatrixArray(d,c,m,h),u.getCellMatrix().moveRows(d,c,m),!0}};function mo(s,e){const{unitId:t,subUnitId:n,sourceRange:o,targetRange:r}=e,a=o.startColumn>r.startColumn,l=o.endColumn-o.startColumn+1;return a?{unitId:t,subUnitId:n,sourceRange:i.Rectangle.clone(r),targetRange:{...o,endColumn:o.endColumn+l,startColumn:o.startColumn+l}}:{unitId:t,subUnitId:n,targetRange:i.Rectangle.clone(o),sourceRange:{...r,startColumn:r.startColumn-l,endColumn:r.endColumn-l}}}const we={id:"sheet.mutation.move-columns",type:i.CommandType.MUTATION,handler:(s,e)=>{const{unitId:t,subUnitId:n,sourceRange:o,targetRange:r}=e,l=s.get(i.IUniverInstanceService).getUniverSheetInstance(t);if(!l)throw new Error("[MoveColumnMutation] univerSheet is null!");const u=l.getSheetBySheetId(n);if(!u)throw new Error("[MoveColumnMutation] worksheet is null!");const d=o.startColumn,c=o.endColumn-o.startColumn+1,m=r.startColumn,h=u.getColumnManager().getColumnData();return i.moveMatrixArray(d,c,m,h),u.getCellMatrix().moveColumns(d,c,m),!0}},ga=(s,e)=>{const o=e.getRowManager().getRowData(),r={},a=s.range,l=i.sliceMatrixArray(a.startRow,a.endRow,o),u=i.concatMatrixArray(r,l);return{unitId:s.unitId,subUnitId:s.subUnitId,range:s.range,rowInfo:u}},ae={id:"sheet.mutation.remove-rows",type:i.CommandType.MUTATION,handler:(s,e)=>{const n=s.get(i.IUniverInstanceService).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const o=n.getSheetBySheetId(e.subUnitId);if(!o)return!1;const r=e.range,l=o.getRowManager().getRowData();for(let c=r.startRow;c<=r.endRow;c++)o.getRowFiltered(c);const u=r.endRow-r.startRow+1;return i.spliceArray(r.startRow,u,l),o.getCellMatrix().removeRows(r.startRow,u),o.setRowCount(o.getRowCount()-u),!0}},Ra=(s,e)=>{const n=s.get(i.IUniverInstanceService).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const o=n.getSheetBySheetId(e.subUnitId);if(o==null)throw new Error("worksheet is null error!");const l=o.getColumnManager().getColumnData(),u={},d=e.range,c=i.sliceMatrixArray(d.startColumn,d.endColumn,l),m=i.concatMatrixArray(u,c);return{unitId:e.unitId,subUnitId:e.subUnitId,range:e.range,colInfo:m}},ne={id:"sheet.mutation.remove-col",type:i.CommandType.MUTATION,handler:(s,e)=>{const n=s.get(i.IUniverInstanceService).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const o=n.getSheetBySheetId(e.subUnitId);if(!o)return!1;const r=e.range,l=o.getColumnManager().getColumnData(),u=r.endColumn-r.startColumn+1;return i.spliceArray(r.startColumn,u,l),o.setColumnCount(o.getColumnCount()-u),o.getCellMatrix().removeColumns(r.startColumn,u),!0}},le=(s,e)=>{const n=s.get(i.IUniverInstanceService).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const o=n.getSheetBySheetId(e.subUnitId);if(o==null)throw new Error("worksheet is null error!");const a=o.getConfig().mergeData,l=e.ranges,u=[];for(let d=0;d<l.length;d++)for(let c=a.length-1;c>=0;c--){const m=a[c],h=l[d];i.Rectangle.intersects(m,h)&&u.push(a[c])}return{unitId:e.unitId,subUnitId:e.subUnitId,ranges:u}},G={id:"sheet.mutation.remove-worksheet-merge",type:i.CommandType.MUTATION,handler:(s,e)=>{const n=s.get(i.IUniverInstanceService).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const o=n.getSheetBySheetId(e.subUnitId);if(!o)return!1;const a=o.getConfig().mergeData,l=e.ranges;for(let u=0;u<l.length;u++)for(let d=a.length-1;d>=0;d--){const c=a[d],m=l[u];i.Rectangle.intersects(c,m)&&a.splice(d,1)}return o.getSpanModel().rebuild(a),!0}},ho=s=>{const{order:e}=s,t={};return Object.keys(e).forEach(n=>{t[e[Number(n)]]=Number(n)}),{...s,order:t}},Dt={id:"sheet.mutation.reorder-range",type:i.CommandType.MUTATION,handler:(s,e)=>{const{subUnitId:t,unitId:n,range:o,order:r}=e,u=s.get(i.IUniverInstanceService).getUnit(n).getSheetBySheetId(t);if(!u)return!1;const d=new i.ObjectMatrix;i.Range.foreach(o,(m,h)=>{if(r.hasOwnProperty(m)){const R=r[m],C=i.Tools.deepClone(u.getCellRaw(R,h));d.setValue(m,h,C)}});const c=u.getCellMatrix();return d.forValue((m,h,R)=>{c.setValue(m,h,R)}),!0}};function Ca(s,e){if(s==null)return s;const t=i.Tools.deepClone(s);if(e==null)return t;const n={};return"h"in e&&(n.h=t.h),"ia"in e&&(n.ia=t.ia),"ah"in e&&(n.ah=t.ah),"hd"in e&&(n.hd=t.hd),"s"in e&&(n.s=t.s),"custom"in e&&(n.custom=t.custom),n}function Sa(s,e){if(s==null)return s;const t=i.Tools.deepClone(s);if(e==null)return t;const n={};return"w"in e&&(n.w=t.w),"hd"in e&&(n.hd=t.hd),"s"in e&&(n.s=t.s),"custom"in e&&(n.custom=t.custom),n}const go=(s,e)=>{const{unitId:t,subUnitId:n,columnData:o}=s,r={},a=e.getColumnManager();for(const l in o){const u=o[l],d=a.getColumn(Number(l));r[l]=Sa(d,u)}return{unitId:t,subUnitId:n,columnData:r}},lt={id:"sheet.mutation.set-col-data",type:i.CommandType.MUTATION,handler:(s,e)=>{const{columnData:t}=e,n=s.get(i.IUniverInstanceService),o=P(n,e);if(!o)return!1;const{worksheet:r}=o,a=r.getColumnManager();for(const l in t){const u=t[l];if(u==null){a.removeColumn(Number(l));continue}const d=a.getColumnOrCreate(Number(l));Object.assign(d,u)}return!0}},fa=(s,e)=>{if(s.get(i.IUniverInstanceService).getUniverSheetInstance(e.unitId)==null)throw new Error("universheet is null error!");return{unitId:e.unitId,subUnitId:e.subUnitId,ranges:e.ranges}},ut={id:"sheet.mutation.set-col-hidden",type:i.CommandType.MUTATION,handler:(s,e)=>{const n=s.get(i.IUniverInstanceService).getUniverSheetInstance(e.unitId);if(!n)return!1;const o=n.getSheetBySheetId(e.subUnitId).getColumnManager();for(let r=0;r<e.ranges.length;r++){const a=e.ranges[r];for(let l=a.startColumn;l<a.endColumn+1;l++){const u=o.getColumnOrCreate(l);u!=null&&(u.hd=i.BooleanNumber.TRUE)}}return!0}},Ia=(s,e)=>{if(s.get(i.IUniverInstanceService).getUniverSheetInstance(e.unitId)==null)throw new Error("universheet is null error!");return{unitId:e.unitId,subUnitId:e.subUnitId,ranges:e.ranges}},dt={id:"sheet.mutation.set-col-visible",type:i.CommandType.MUTATION,handler:(s,e)=>{const n=s.get(i.IUniverInstanceService).getUniverSheetInstance(e.unitId);if(!n)return!1;const o=n.getSheetBySheetId(e.subUnitId).getColumnManager();for(let r=0;r<e.ranges.length;r++){const a=e.ranges[r];for(let l=a.startColumn;l<a.endColumn+1;l++){const u=o.getColumnOrCreate(l);u!=null&&(u.hd=i.BooleanNumber.FALSE)}}return!0}},ct={id:"sheet.mutation.set-gridlines-color",type:i.CommandType.MUTATION,handler:(s,e)=>{const t=P(s.get(i.IUniverInstanceService),e);if(!t)return!1;const{worksheet:n}=t,o=n.getConfig();return o.gridlinesColor=e.color,!0}};function va(s,e,t){var a;const n=s.getStyleByCell(e);n==null&&delete e.s,typeof t.s=="string"&&(t.s=s.get(t.s));const o=sn(n,t.s?t.s:null);o&&(i.Tools.removeNull(o),Object.entries(o).forEach(([l,u])=>{typeof u=="object"&&u!==null&&Object.keys(u).length===0&&delete o[l]})),i.Tools.isEmptyObject(o)?delete e.s:e.s=s.setValue(o);const r=t.v?`${t.v}\r
`:"";!t.p&&e.p&&(r&&r!==((a=e.p.body)==null?void 0:a.dataStream)?delete e.p:Ma(e.p,t.s?t.s:null))}function pa(s,e){if(!e||!Object.keys(e).length)return s;const t=i.Tools.deepClone(s!=null?s:{});for(const n in e)n==="bd"?t[n]=wa(t[n]||{},e[n]):n in t||(t[n]=null);return t}function wa(s,e){if(!e||!Object.keys(e).length)return s;for(const t in e)t in s||(s[t]=null);return s}function sn(s,e,t=!1){if(e===null)return e;if(e===void 0)return s;const n=i.Tools.deepClone(s)||{};for(const o in e)t&&["bd","tr","td","ht","vt","tb","pd","bg"].includes(o)||(o in n&&o==="bd"?n[o]=Object.assign(n[o],e[o]):n[o]=e[o]);return"cl"in n&&("ul"in n&&n.ul&&(n.ul.cl=n.cl),"ol"in n&&n.ol&&(n.ol.cl=n.cl),"st"in n&&n.st&&(n.st.cl=n.cl)),n}function Ro(s,e){return s.some(t=>t.startIndex===e)?Ro(s,e+1):e}function Ma(s,e){var a;if(s.body==null)return;Array.isArray(s.body.textRuns)||(s.body.textRuns=[]);let t=0;const n=[],o=((a=s.body)==null?void 0:a.paragraphs)||[];for(const l of s.body.textRuns){const{st:u,ed:d,ts:c={}}=l;if(t<u){const h={st:t,ed:u},R=sn({},e,!0);R&&i.Tools.removeNull(R),i.Tools.isEmptyObject(R)||(h.ts=R),n.push(h)}const m=sn(c,e,!0);m&&i.Tools.removeNull(m),i.Tools.isEmptyObject(m)?delete l.ts:l.ts=m,n.push(l),t=Ro(o,d)}const r=s.body.dataStream.endsWith(`\r
`)?s.body.dataStream.length-2:s.body.dataStream.length;if(t<r){const l={st:t,ed:r},u=sn({},e,!0);u&&i.Tools.removeNull(u),i.Tools.isEmptyObject(u)||(l.ts=u),n.push(l)}s.body.textRuns=i.normalizeTextRuns(n)}function Co(s,e){return e.v===void 0||e.v===null?e.v:s===i.CellValueType.NUMBER?Number(e.v):s===i.CellValueType.BOOLEAN?ya(e.v)?1:0:s===i.CellValueType.STRING||s===i.CellValueType.FORCE_STRING?`${e.v}`:e.v}function ya(s){if(typeof s=="string"){if(s.toUpperCase()==="TRUE")return!0;if(s.toUpperCase()==="FALSE")return!1;if(i.isSafeNumeric(s)){if(Number(s)===0)return!1;if(Number(s)===1)return!0}}if(typeof s=="number"){if(s===0)return!1;if(s===1)return!0}return typeof s=="boolean"?s:null}function _a(s){return s==null?null:(s.f===void 0&&(s.f=null),s.si===void 0&&(s.si=null),s.p===void 0&&(s.p=null),s.v===void 0&&(s.v=null),s.t===void 0&&(s.t=null),s.s===void 0&&(s.s=null),s.custom===void 0&&(s.custom=null),s)}const ce=(s,e)=>{const{unitId:t,subUnitId:n,cellValue:o}=e,a=s.get(i.IUniverInstanceService).getUniverSheetInstance(t);if(a==null)throw new Error("workbook is null error!");const l=a.getSheetBySheetId(n);if(l==null)throw new Error("worksheet is null error!");const u=l.getCellMatrix(),d=a.getStyles(),c=new i.ObjectMatrix;return new i.ObjectMatrix(o).forValue((h,R,C)=>{const S=i.Tools.deepClone(u==null?void 0:u.getValue(h,R))||{},I=d.getStyleByCell(S),v=d.getStyleByCell(C);S.s=pa(I,v),c.setValue(h,R,_a(S))}),{...e,options:{},cellValue:c.getMatrix()}},F={id:"sheet.mutation.set-range-values",type:i.CommandType.MUTATION,handler:(s,e)=>{const{cellValue:t,subUnitId:n,unitId:o}=e,a=s.get(i.IUniverInstanceService).getUnit(o);if(!a)return!1;const l=a.getSheetBySheetId(n);if(!l)return!1;const u=l.getCellMatrix(),d=a.getStyles();return new i.ObjectMatrix(t).forValue((m,h,R)=>{if(!R)u.realDeleteValue(m,h);else{let C=u.getValue(m,h)||{};C=Ea(R,C,d),i.Tools.isEmptyObject(C)?u.realDeleteValue(m,h):u.setValue(m,h,C)}}),!0}},ba=new Set(["f","p","si","custom","ref","xf"]);function Ea(s,e,t){const n=Gi(t,s,e);return Object.keys(s).forEach(o=>{const r=o;if(ba.has(r)){const a=s[r];Ta(e,r,a)}else r==="v"?s.v!==void 0&&(e.v=Co(n,s)):r==="s"&&va(t,e,s)}),e.v!==void 0&&(e.t=n,e.v=Co(n,e)),e.v===null&&(delete e.t,delete e.v),e}function Ta(s,e,t){t===void 0||(t===null?delete s[e]:s[e]=t)}const So=(s,e)=>{const{unitId:t,subUnitId:n,rowData:o}=s,r={},a=e.getRowManager();for(const l in o){const u=o[l],d=a.getRow(Number(l));r[l]=Ca(d,u)}return{unitId:t,subUnitId:n,rowData:r}},mt={id:"sheet.mutation.set-row-data",type:i.CommandType.MUTATION,handler:(s,e)=>{const{rowData:t}=e,n=s.get(i.IUniverInstanceService),o=P(n,e);if(!o)return!1;const{worksheet:r}=o,a=r.getRowManager();for(const l in t){const u=t[l];if(u==null){a.removeRow(Number(l));continue}const d=a.getRowOrCreate(Number(l));Object.assign(d,u)}return!0}},Ua=(s,e)=>{if(s.get(i.IUniverInstanceService).getUniverSheetInstance(e.unitId)==null)throw new Error("universheet is null error!");return{unitId:e.unitId,subUnitId:e.subUnitId,ranges:e.ranges}},Ke={id:"sheet.mutation.set-row-visible",type:i.CommandType.MUTATION,handler:(s,e)=>{const n=s.get(i.IUniverInstanceService).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const o=n.getSheetBySheetId(e.subUnitId).getRowManager();for(let r=0;r<e.ranges.length;r++){const a=e.ranges[r];for(let l=a.startRow;l<a.endRow+1;l++){const u=o.getRowOrCreate(l);u!=null&&(u.hd=0)}}return!0}},ka=(s,e)=>{if(s.get(i.IUniverInstanceService).getUniverSheetInstance(e.unitId)==null)throw new Error("universheet is null error!");return{unitId:e.unitId,subUnitId:e.subUnitId,ranges:e.ranges}},Je={id:"sheet.mutation.set-row-hidden",type:i.CommandType.MUTATION,handler:(s,e)=>{const n=s.get(i.IUniverInstanceService).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const o=n.getSheetBySheetId(e.subUnitId).getRowManager();for(let r=0;r<e.ranges.length;r++){const a=e.ranges[r];for(let l=a.startRow;l<a.endRow+1;l++){const u=o.getRowOrCreate(l);u!=null&&(u.hd=1)}}return!0}},Fn=(s,e)=>{const{unitId:t,subUnitId:n,ranges:o}=s,r={},a=e.getColumnManager();for(let l=0;l<o.length;l++){const u=o[l];for(let d=u.startColumn;d<u.endColumn+1;d++)r[d]=a.getColumnWidth(d)}return{unitId:t,subUnitId:n,ranges:o,colWidth:r}},Ve={id:"sheet.mutation.set-worksheet-col-width",type:i.CommandType.MUTATION,handler:(s,e)=>{const t=s.get(i.IUniverInstanceService),n=P(t,e);if(!n)return!1;const{worksheet:o}=n,r=o.getColumnManager(),a=e.ranges;for(let l=0;l<a.length;l++){const u=a[l];for(let d=u.startColumn;d<u.endColumn+1;d++)o.getColVisible(d)&&(typeof e.colWidth=="number"?r.setColumnWidth(d,e.colWidth):i.Tools.isDefine(e.colWidth[d])&&r.setColumnWidth(d,e.colWidth[d]))}return!0}},fo=(s,e)=>{const t=ve(s.get(i.IUniverInstanceService),e);if(!t)throw new Error("[SetWorksheetColumnCountUndoMutationFactory]: worksheet is null error!");return{unitId:e.unitId,subUnitId:e.subUnitId,columnCount:t.worksheet.getColumnCount()}},ht={id:"sheet.mutation.set-worksheet-column-count",type:i.CommandType.MUTATION,handler:(s,e)=>{const t=s.get(i.IUniverInstanceService),n=ve(t,e);return n?(n.worksheet.setColumnCount(e.columnCount),!0):!1}},gt={id:"sheet.mutation.set-worksheet-default-style",type:i.CommandType.MUTATION,handler:(s,e)=>{const{defaultStyle:t}=e,n=s.get(i.IUniverInstanceService),o=P(n);if(!o)return!1;const{worksheet:r}=o;return r?(r.setDefaultCellStyle(t),!0):!1}},Io=(s,e)=>{const t=ve(s.get(i.IUniverInstanceService),e);if(!t)throw new Error("[SetWorksheetDefaultStyleMutationFactory]: worksheet is null error!");const{worksheet:n}=t;return{unitId:e.unitId,subUnitId:n.getSheetId(),defaultStyle:n.getDefaultCellStyle()}},vo=(s,e)=>{const t=ve(s.get(i.IUniverInstanceService),e);if(!t)throw new Error("[SetWorksheetRowCountUndoMutationFactory]: worksheet is null error!");return{unitId:e.unitId,subUnitId:e.subUnitId,rowCount:t.worksheet.getRowCount()}},Rt={id:"sheet.mutation.set-worksheet-row-count",type:i.CommandType.MUTATION,handler:(s,e)=>{const t=s.get(i.IUniverInstanceService),n=ve(t,e);return n?(n.worksheet.setRowCount(e.rowCount),!0):!1}},po=(s,e)=>{var l,u;const{unitId:t,subUnitId:n,ranges:o}=s,r={},a=e.getRowManager();for(const{startRow:d,endRow:c}of o)for(let m=d;m<c+1;m++)r[m]=(u=(l=a.getRow(m))==null?void 0:l.h)!=null?u:e.getConfig().defaultRowHeight;return{unitId:t,subUnitId:n,ranges:o,rowHeight:r}},jn=(s,e)=>{var l;const{unitId:t,subUnitId:n,ranges:o}=s,r={},a=e.getRowManager();for(const{startRow:u,endRow:d}of o)for(let c=u;c<=d;c++)r[c]=(l=a.getRow(c))==null?void 0:l.ia;return{unitId:t,subUnitId:n,ranges:o,autoHeightInfo:r}},Pa=(s,e)=>{var l,u;const{unitId:t,subUnitId:n,rowsAutoHeightInfo:o}=s,r=[],a=e.getRowManager();for(const d of o){const{row:c}=d;r.push({row:c,autoHeight:(u=(l=a.getRow(c))==null?void 0:l.ah)!=null?u:e.getConfig().defaultRowHeight})}return{unitId:t,subUnitId:n,rowsAutoHeightInfo:r}},Ee={id:"sheet.mutation.set-worksheet-row-height",type:i.CommandType.MUTATION,handler:(s,e)=>{const{ranges:t,rowHeight:n}=e,o=s.get(i.IUniverInstanceService),r=P(o,e);if(!r)return!1;const{worksheet:a}=r,l=a.getRowManager();for(const{startRow:u,endRow:d}of t)for(let c=u;c<=d;c++)typeof n=="number"?l.setRowHeight(c,n):i.Tools.isDefine(n[c])&&l.setRowHeight(c,n[c]);return!0}},Re={id:"sheet.mutation.set-worksheet-row-is-auto-height",type:i.CommandType.MUTATION,handler:(s,e)=>{var l;const{ranges:t,autoHeightInfo:n}=e,o=s.get(i.IUniverInstanceService),r=P(o,e);if(!r)return!1;const a=r.worksheet.getRowManager();for(const{startRow:u,endRow:d}of t)for(let c=u;c<=d;c++){const m=a.getRowOrCreate(c);typeof n=="number"?m.ia=n:m.ia=(l=n[c])!=null?l:void 0}return!0}},Gn={id:"sheet.mutation.set-worksheet-row-auto-height",type:i.CommandType.MUTATION,handler:(s,e)=>{const{rowsAutoHeightInfo:t}=e,n=s.get(i.IUniverInstanceService),o=P(n,e);if(!o)return!1;const r=o.worksheet.getRowManager();for(const{row:a,autoHeight:l}of t){const u=r.getRowOrCreate(a);u.ah=l}return!0}},Ct={id:"sheet.mutation.toggle-gridlines",type:i.CommandType.MUTATION,handler:(s,e)=>{const t=P(s.get(i.IUniverInstanceService),e);if(!t)return!1;const{worksheet:n}=t,o=n.getConfig();return o.showGridlines=e.showGridlines,!0}},St={id:"sheet.operation.set-worksheet-active",type:i.CommandType.OPERATION,handler:(s,e)=>{const t=s.get(i.IUniverInstanceService).getUniverSheetInstance(e.unitId);if(!t)return!1;const n=t.getWorksheets();for(const[,o]of n)if(o.getSheetId()===e.subUnitId)return t.setActiveSheet(o),!0;return!1}};var wo=(s=>(s.SET_WORKSHEET_ROW_HEIGHT="sheet.mutation.set-worksheet-row-height",s.SET_WORKSHEET_ROW_IS_AUTO_HEIGHT="sheet.mutation.set-worksheet-row-is-auto-height",s.SET_WORKSHEET_ROW_AUTO_HEIGHT="sheet.mutation.set-worksheet-row-auto-height",s.SET_WORKSHEET_COL_WIDTH="sheet.mutation.set-worksheet-col-width",s.SET_WORKSHEET_ACTIVE="sheet.operation.set-worksheet-active",s.MOVE_ROWS="sheet.mutation.move-rows",s.MOVE_COLUMNS="sheet.mutation.move-columns",s.SET_COL_HIDDEN="sheet.mutation.set-col-hidden",s.SET_COL_VISIBLE="sheet.mutation.set-col-visible",s.SET_ROW_HIDDEN="sheet.mutation.set-row-hidden",s.SET_ROW_VISIBLE="sheet.mutation.set-row-visible",s.INSERT_COL="sheet.mutation.insert-col",s.INSERT_ROW="sheet.mutation.insert-row",s.REMOVE_COL="sheet.mutation.remove-col",s.REMOVE_ROW="sheet.mutation.remove-rows",s.TOGGLE_GRIDLINES="sheet.mutation.toggle-gridlines",s.SET_GRIDLINES_COLOR="sheet.mutation.set-gridlines-color",s))(wo||{}),Mo=(s=>(s.SET_RANGE_VALUES="sheet.mutation.set-range-values",s.MOVE_RANGE="sheet.mutation.move-range",s.REMOVE_WORKSHEET_MERGE="sheet.mutation.remove-worksheet-merge",s.ADD_WORKSHEET_MERGE="sheet.mutation.add-worksheet-merge",s.REORDER_RANGE="sheet.mutation.reorder-range",s.SET_WORKSHEET_DEFAULT_STYLE="sheet.mutation.set-worksheet-default-style",s.SET_ROW_DATA="sheet.mutation.set-row-data",s.SET_COL_DATA="sheet.mutation.set-col-data",s.SET_WORKSHEET_RANGE_THEME_STYLE="sheet.mutation.set-worksheet-range-theme-style",s.DELETE_WORKSHEET_RANGE_THEME_STYLE="sheet.mutation.delete-worksheet-range-theme-style",s))(Mo||{});const Na=[Ee.id,Re.id,Gn.id,Ve.id,St.id,pe.id,we.id,ut.id,dt.id,Je.id,Ke.id,ie.id,re.id,ne.id,ae.id,Ct.id,ct.id,Rt.id,ht.id],Oa=[F.id,Le.id,G.id,j.id,Dt.id,gt.id,mt.id,lt.id,it.id,at.id];function Da(s){switch(s.id){case"sheet.mutation.set-range-values":{const e=s.params,t=new i.ObjectMatrix(e.cellValue).getDataRange();return t.endRow===-1?[]:e.cellValue?[{unitId:e.unitId,subUnitId:e.subUnitId,range:t}]:[]}case"sheet.mutation.move-range":{const e=s.params;return[{unitId:e.unitId,subUnitId:e.from.subUnitId,range:new i.ObjectMatrix(e.from.value).getRange()},{unitId:e.unitId,subUnitId:e.to.subUnitId,range:new i.ObjectMatrix(e.to.value).getRange()}]}case"sheet.mutation.remove-worksheet-merge":{const e=s.params;return e.ranges.map(t=>({unitId:e.unitId,subUnitId:e.subUnitId,range:t}))}case"sheet.mutation.add-worksheet-merge":{const e=s.params;return e.ranges.map(t=>({unitId:e.unitId,subUnitId:e.subUnitId,range:t}))}case"sheet.mutation.reorder-range":{const e=s.params;return[{unitId:e.unitId,subUnitId:e.subUnitId,range:e.range}]}case"sheet.mutation.set-worksheet-default-style":{const e=s.params;return[{unitId:e.unitId,subUnitId:e.subUnitId,range:{startRow:0,endRow:Number.MAX_SAFE_INTEGER,startColumn:0,endColumn:Number.MAX_SAFE_INTEGER}}]}case"sheet.mutation.set-row-data":{const e=s.params,t=Object.keys(e.rowData).map(Number);return t.length===0?[]:[{unitId:e.unitId,subUnitId:e.subUnitId,range:{startRow:Math.min(...t),endRow:Math.max(...t),startColumn:0,endColumn:Number.MAX_SAFE_INTEGER}}]}case"sheet.mutation.set-col-data":{const e=s.params,t=Object.keys(e.columnData).map(Number);return t.length===0?[]:[{unitId:e.unitId,subUnitId:e.subUnitId,range:{startRow:0,endRow:Number.MAX_SAFE_INTEGER,startColumn:Math.min(...t),endColumn:Math.max(...t)}}]}case"sheet.mutation.set-worksheet-range-theme-style":case"sheet.mutation.delete-worksheet-range-theme-style":{const e=s.params;return[{unitId:e.unitId,subUnitId:e.subUnitId,range:e.range}]}default:return[]}}function Aa(s,e){switch(s.id){case"sheet.mutation.set-worksheet-row-height":case"sheet.mutation.set-worksheet-row-is-auto-height":{const t=s.params;return t.ranges.map(n=>({unitId:t.unitId,subUnitId:t.subUnitId,range:{...n,rangeType:i.RANGE_TYPE.ROW}}))}case"sheet.mutation.set-worksheet-row-auto-height":{const t=s.params;return t.rowsAutoHeightInfo.map(n=>({unitId:t.unitId,subUnitId:t.subUnitId,range:{startRow:n.row,endRow:n.row,startColumn:0,endColumn:e-1,rangeType:i.RANGE_TYPE.ROW}}))}case"sheet.mutation.set-worksheet-col-width":{const t=s.params;return t.ranges.map(n=>({unitId:t.unitId,subUnitId:t.subUnitId,range:{...n,rangeType:i.RANGE_TYPE.COLUMN}}))}case"sheet.mutation.move-rows":case"sheet.mutation.move-columns":{const t=s.params;return[{unitId:t.unitId,subUnitId:t.subUnitId,range:t.targetRange},{unitId:t.unitId,subUnitId:t.subUnitId,range:t.sourceRange}]}case"sheet.mutation.set-col-hidden":case"sheet.mutation.set-col-visible":{const t=s.params;return t.ranges.map(n=>({unitId:t.unitId,subUnitId:t.subUnitId,range:{...n,rangeType:i.RANGE_TYPE.COLUMN}}))}case"sheet.mutation.set-row-hidden":case"sheet.mutation.set-row-visible":{const t=s.params;return t.ranges.map(n=>({unitId:t.unitId,subUnitId:t.subUnitId,range:{...n,rangeType:i.RANGE_TYPE.ROW}}))}case"sheet.mutation.insert-col":{const t=s.params;return[{unitId:t.unitId,subUnitId:t.subUnitId,range:{...t.range,rangeType:i.RANGE_TYPE.COLUMN}}]}case"sheet.mutation.insert-row":{const t=s.params;return[{unitId:t.unitId,subUnitId:t.subUnitId,range:{...t.range,rangeType:i.RANGE_TYPE.ROW}}]}case"sheet.mutation.remove-col":{const t=s.params;return[{unitId:t.unitId,subUnitId:t.subUnitId,range:{...t.range,rangeType:i.RANGE_TYPE.COLUMN}}]}case"sheet.mutation.remove-rows":{const t=s.params;return[{unitId:t.unitId,subUnitId:t.subUnitId,range:{...t.range,rangeType:i.RANGE_TYPE.ROW}}]}case"sheet.mutation.toggle-gridlines":case"sheet.mutation.set-gridlines-color":return[];default:return[]}}function yo(s){return s==null?!1:s.v!==void 0&&s.v!==null&&s.v!==""||s.p!==void 0}function Be(s,e){return s&&s.spanAnchor?yo(e.getValue(s.spanAnchor.startRow,s.spanAnchor.startColumn)):yo(s)}function Wa(s,e,t,n,o){const r=s.getCellMatrix(),a=s.getSpanModel().getMergedCellRange(e,t,n,o),l=new i.ObjectMatrix;return r.forValue((u,d)=>{const c=r.getValue(u,d);c&&l.setValue(u,d,c)}),a.forEach(u=>{const{startColumn:d,startRow:c,endColumn:m,endRow:h}=u;i.createRowColIter(c,h,d,m).forEach((R,C)=>{R===c&&C===d&&l.setValue(R,C,{...r.getValue(R,C),spanAnchor:{startRow:c,endRow:h,startColumn:d,endColumn:m}}),(R!==c||C!==d)&&(l.realDeleteValue(R,C),l.setValue(R,C,{spanAnchor:{startRow:c,endRow:h,startColumn:d,endColumn:m}}))})}),l}function Va(s,e,t,n){const{startRow:o,startColumn:r,endRow:a}=s;let l=null,u=!1;for(let d=o;d<=a;d++){const c=e.getValue(d,r-t);if(u=u||Be(c,e),!n&&u)break;c&&c.spanAnchor&&(l?l={startRow:Math.min(c.spanAnchor.startRow,l.startRow),startColumn:Math.min(c.spanAnchor.startColumn,l.startColumn),endRow:Math.max(c.spanAnchor.endRow,l.endRow),endColumn:Math.max(c.spanAnchor.endColumn,l.endColumn)}:l={startRow:c.spanAnchor.startRow,startColumn:c.spanAnchor.startColumn,endRow:c.spanAnchor.endRow,endColumn:c.spanAnchor.endColumn})}return u?(s.startColumn=s.startColumn-t,{spanAnchor:l,hasValue:!0,range:s}):l?{spanAnchor:i.Rectangle.simpleRangesIntersect(s,l)?l:null,hasValue:!1,range:s}:{spanAnchor:null,hasValue:!1,range:s}}function $a(s,e,t,n){const{startRow:o,endColumn:r,endRow:a}=s;let l=null,u=!1;for(let d=o;d<=a;d++){const c=e.getValue(d,r+t);if(u=u||Be(c,e),!n&&u)break;c&&c.spanAnchor&&(l?l={startRow:Math.min(c.spanAnchor.startRow,l.startRow),startColumn:Math.min(c.spanAnchor.startColumn,l.startColumn),endRow:Math.max(c.spanAnchor.endRow,l.endRow),endColumn:Math.max(c.spanAnchor.endColumn,l.endColumn)}:l={startRow:c.spanAnchor.startRow,startColumn:c.spanAnchor.startColumn,endRow:c.spanAnchor.endRow,endColumn:c.spanAnchor.endColumn})}return u?(s.endColumn=s.endColumn+t,{spanAnchor:l,hasValue:!0,range:s}):l?{spanAnchor:i.Rectangle.simpleRangesIntersect(s,l)?l:null,hasValue:!1,range:s}:{spanAnchor:null,hasValue:!1,range:s}}function La(s,e,t,n){const{startRow:o,startColumn:r,endColumn:a}=s;let l=null,u=!1;for(let d=r;d<=a;d++){const c=e.getValue(o-t,d);if(u=u||Be(c,e),!n&&u)break;c&&c.spanAnchor&&(l?l={startRow:Math.min(c.spanAnchor.startRow,l.startRow),startColumn:Math.min(c.spanAnchor.startColumn,l.startColumn),endRow:Math.max(c.spanAnchor.endRow,l.endRow),endColumn:Math.max(c.spanAnchor.endColumn,l.endColumn)}:l={startRow:c.spanAnchor.startRow,startColumn:c.spanAnchor.startColumn,endRow:c.spanAnchor.endRow,endColumn:c.spanAnchor.endColumn})}return u?(s.startRow=s.startRow-t,{spanAnchor:l,hasValue:!0,range:s}):l?{spanAnchor:i.Rectangle.simpleRangesIntersect(s,l)?l:null,hasValue:!1,range:s}:{spanAnchor:null,hasValue:!1,range:s}}function Ba(s,e,t,n){const{startColumn:o,endColumn:r,endRow:a}=s;let l=null,u=!1;for(let d=o;d<=r;d++){const c=e.getValue(a+t,d);if(u=u||Be(c,e),!n&&u)break;c&&c.spanAnchor&&(l?l={startRow:Math.min(c.spanAnchor.startRow,l.startRow),startColumn:Math.min(c.spanAnchor.startColumn,l.startColumn),endRow:Math.max(c.spanAnchor.endRow,l.endRow),endColumn:Math.max(c.spanAnchor.endColumn,l.endColumn)}:l={startRow:c.spanAnchor.startRow,startColumn:c.spanAnchor.startColumn,endRow:c.spanAnchor.endRow,endColumn:c.spanAnchor.endColumn})}return u?(s.endRow=s.endRow+t,{spanAnchor:l,hasValue:!0,range:s}):l?{spanAnchor:i.Rectangle.simpleRangesIntersect(s,l)?l:null,hasValue:!1,range:s}:{spanAnchor:null,hasValue:!1,range:s}}function Ha({range:s,allMatrixWithSpan:e,directions:t,isWorksheetHasSpan:n,maxRow:o,maxColumn:r}){const{left:a,right:l,up:u,down:d}=t,{startRow:c,startColumn:m,endRow:h,endColumn:R}=s;let C=!1;if(a&&u&&c>0&&m>0){const S=e.getValue(c-1,m-1);Be(S,e)&&(n&&S.spanAnchor?(s.startRow=S.spanAnchor.startRow,s.startColumn=S.spanAnchor.startColumn):(s.startRow=c-1,s.startColumn=m-1),C=!0)}if(l&&u&&c>0&&R<r-1){const S=e.getValue(c-1,R+1);Be(S,e)&&(n&&S.spanAnchor?(s.startRow=S.spanAnchor.startRow,s.endColumn=S.spanAnchor.endColumn):(s.startRow=c-1,s.endColumn=R+1),C=!0)}if(a&&d&&h<o-1&&m>0){const S=e.getValue(h+1,m-1);Be(S,e)&&(n&&S.spanAnchor?(s.endRow=S.spanAnchor.endRow,s.startColumn=S.spanAnchor.startColumn):(s.endRow=h+1,s.startColumn=m-1),C=!0)}if(l&&d&&h<o-1&&R<r-1){const S=e.getValue(h+1,R+1);Be(S,e)&&(n&&S.spanAnchor?(s.endRow=S.spanAnchor.endRow,s.endColumn=S.spanAnchor.endColumn):(s.endRow=h+1,s.endColumn=R+1),C=!0)}return{hasValue:C,range:s}}function Fa(s,e,t){const n=t.getMaxRows(),o=t.getMaxColumns(),r=Wa(t,0,0,n-1,o-1),a=t.getSnapshot().mergeData.length>0,{left:l,right:u,up:d,down:c}=e;let m=!0,h={...s};const R=[];for(;m;){m=!1;const C=Ha({range:h,allMatrixWithSpan:r,directions:e,isWorksheetHasSpan:a,maxRow:n,maxColumn:o});if(C.hasValue){h=C.range,m=!0;continue}if(d&&h.startRow!==0){const{hasValue:S,range:I,spanAnchor:v}=La(h,r,1,a);if(v&&R.push(v),S){h=I,m=!0;continue}}if(c&&h.endRow!==n-1){const{hasValue:S,range:I,spanAnchor:v}=Ba(h,r,1,a);if(v&&R.push(v),S){h=I,m=!0;continue}}if(l&&h.startColumn!==0){const{hasValue:S,range:I,spanAnchor:v}=Va(h,r,1,a);if(v&&R.push(v),S){h=I,m=!0;continue}}if(u&&h.endColumn!==o-1){const{hasValue:S,range:I,spanAnchor:v}=$a(h,r,1,a);if(v&&R.push(v),S){h=I,m=!0;continue}}}return R.length>0&&(h=i.Rectangle.union(h,...R)),h}const _o=s=>{const e=new i.ObjectMatrix;return s.forEach(t=>{i.Range.foreach(t,(n,o)=>{e.setValue(n,o,1)})}),e.forValue((t,n)=>{const o=e.getValue(t-1,n);o&&e.setValue(t,n,o+1)}),e},bo=s=>{const e=s;return e.forValue((t,n)=>{const o=s.getValue(t-1,n);o&&e.setValue(t,n,o+1)}),e},Eo=s=>{const e={area:0},t=(n,o)=>e.area<n?(e.area=n,e.range=o,!0):!1;return s.forValue((n,o,r)=>{let a=1,l=r;t(a*l,{startRow:n-l+1,endRow:n,startColumn:o,endColumn:o});const u={startRow:n-l+1,endRow:n,startColumn:0,endColumn:o};for(let d=o-1;d>=0&&s.getValue(n,d);d--){l=Math.min(s.getValue(n,d)||0,l),a++;const c=l*a;u.startColumn=d,u.startRow=n-l+1,t(c,u)}}),e},ja=(s,e)=>{i.Range.foreach(e,(t,n)=>{s.realDeleteValue(t,n)});for(let t=e.startColumn;t<=e.endColumn;t++){const n=e.endRow+1;if(s.getValue(n,t)>0){s.setValue(n,t,1);let r=n+1;for(;s.getValue(r,t)>0;)s.setValue(r,t,s.getValue(r-1,t)+1),r++}}return s},zn=s=>{const e=[];let t=Eo(s);for(;t.area>0;)t.range&&(e.push(t.range),ja(s,t.range)),t=Eo(s);return e},qn=s=>{const e=_o(s);return zn(e)};class Ga{constructor(){f(this,"_matrix",new i.ObjectMatrix)}add(...e){return e.forEach(t=>{i.Range.foreach(t,(n,o)=>{this._matrix.setValue(n,o,1)})}),this}subtract(...e){return e.forEach(t=>{i.Range.foreach(t,(n,o)=>{this._matrix.realDeleteValue(n,o)})}),this}merge(){const e=bo(this._matrix);return zn(e)}}const za=1.5,qa="rgba(255, 255, 255, 0.01)";function Ya(s){const{rangeWithCoord:e,primaryWithCoord:t,style:n}=s,o={range:{startRow:e.startRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn,rangeType:e.rangeType,unitId:e.unitId,sheetId:e.sheetId},primary:null,style:n};return t!=null&&(o.primary=To(t)),o}function To(s){const{actualRow:e,actualColumn:t,isMerged:n,isMergedMainCell:o}=s,{startRow:r,startColumn:a,endRow:l,endColumn:u}=s.mergeInfo;return{actualRow:e,actualColumn:t,isMerged:n,isMergedMainCell:o,startRow:r,startColumn:a,endRow:l,endColumn:u}}var Uo=(s=>(s[s.Tab=1]="Tab",s[s.Comma=2]="Comma",s[s.Semicolon=4]="Semicolon",s[s.Space=8]="Space",s[s.Custom=16]="Custom",s))(Uo||{});class Ka{constructor(){f(this,"_tabCount",0);f(this,"_commaCount",0);f(this,"_semicolonCount",0);f(this,"_spaceCount",0)}add(e){switch(e){case"	":this._tabCount++;break;case",":this._commaCount++;break;case";":this._semicolonCount++;break;case" ":this._spaceCount++;break}}update(e){e&&typeof e=="string"&&(e.includes("	")&&this._tabCount++,e.includes(",")&&this._commaCount++,e.includes(";")&&this._semicolonCount++,e.trim().includes(" ")&&this._spaceCount++)}getDelimiter(){const e=Math.max(this._tabCount,this._commaCount,this._semicolonCount,this._spaceCount);return e===0||e===this._tabCount?1:e===this._commaCount?2:e===this._semicolonCount?4:e===this._spaceCount?8:1}}function Ja(s,e,t){const n=[];t!==void 0&&(s&16)>0&&n.push(t),(s&1)>0&&n.push("	"),(s&2)>0&&n.push(","),(s&4)>0&&n.push(";"),(s&8)>0&&n.push(" ");let o="";for(const a of n)o+=xa(a);let r="[".concat(o,"]");return e&&(r+="+"),new RegExp(r)}function xa(s){return s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const Xa=s=>{var t;return((t=s.body)==null?void 0:t.dataStream.replace(/\r\n$/,""))||""};function Za(s){if(s!=null){if(s.p)return Xa(s.p);if(s.v&&typeof s.v=="string")return s.v;if(s.t&&(s.t===i.CellValueType.FORCE_STRING||s.t===i.CellValueType.STRING))return String(s.v)}}function ko(s,e,t,n,o=!1){const r=i.Range.transformRange(e,s),{startColumn:a,startRow:l,endColumn:u,endRow:d}=r;if(a!==u)throw new Error("The range must be in the same column.");if(t&&(t&16)>0&&(n===void 0||n.length!==1))throw new Error("The custom delimiter must a character.");const c=t===void 0,m=c?new Ka:null,h=[];for(let p=l;p<=d;p++){const w=s.getCell(p,a),y=Za(w);h.push(y),m&&m.update(y)}const R=c?m.getDelimiter():t,C=Ja(R,o,n);let S=-1,I=0,v=0;const M=[];for(const p of h){if(p!==void 0){const w=String(p).split(C);S<0?S=w.length:S=Math.max(S,w.length),M.push(w),I=v}else M.push(void 0);v++}return{rs:M,maxLength:S===-1?0:S,lastRow:I}}const Qa=(s,e,t="")=>s.reduce((n,o)=>{const r=o&&o[e];return typeof r!="string"?(console.warn(o,`${e} is not string`),n):(r?(n[r]||(n[r]=[]),n[r].push(o)):n[t].push(o),n)},{}),el=(s=0)=>{let e=s;return function(){return e++}};function tl(s){return s==null?!1:s.v!==void 0&&s.v!==null&&s.v!==""||s.p!==void 0}function nl(s,e){for(let t=s.startRow;t<=s.endRow;t++)for(let n=s.startColumn;n<=s.endColumn;n++){const o=e.getCell(t,n);if(tl(o))return{startRow:t,startColumn:n,endRow:t,endColumn:n}}return null}function Yn(s){const e=new i.ObjectMatrix;return s.forEach(t=>{const{startRow:n,startColumn:o,endRow:r,endColumn:a}=t;for(let l=n;l<=r;l++)for(let u=o;u<=a;u++)e.setValue(l,u,null)}),e.clone()}function Po(s){const e=new i.ObjectMatrix;return s.forEach(t=>{const{startRow:n,startColumn:o,endRow:r,endColumn:a}=t;for(let l=n;l<=r;l++)for(let u=o;u<=a;u++)e.setValue(l,u,{v:null,p:null,f:null,si:null,custom:null})}),e.clone()}function sl(s){const e=new i.ObjectMatrix;return s.forEach(t=>{const{startRow:n,startColumn:o,endRow:r,endColumn:a}=t;for(let l=n;l<=r;l++)for(let u=o;u<=a;u++)e.setValue(l,u,{s:null})}),e.clone()}function No(s,e,t,n){const o=e.get(i.IUniverInstanceService),r=t?o.getUnit(t,i.UniverInstanceType.UNIVER_SHEET):o.getCurrentUnitForType(i.UniverInstanceType.UNIVER_SHEET),a=n?r==null?void 0:r.getSheetBySheetId(n):r==null?void 0:r.getActiveSheet();if(!a)return null;const{startRow:l,endRow:u,startColumn:d,endColumn:c}=s,m=[],h=[];for(let R=l;R<=u;R++)a.getRowFiltered(R)||m.push(R);for(let R=d;R<=c;R++)h.push(R);return{rows:m,cols:h}}function At(s,e,t,n){const o=[],r=[];for(const h of s){const R=No(h,e,t,n);R&&(o.push(...R.rows),r.push(...R.cols))}const a=Array.from(new Set(o)).sort((h,R)=>h-R),l=Array.from(new Set(r)).sort((h,R)=>h-R),u=[];function d(h){const R=[];let C=h[0];for(let S=1;S<h.length;S++)h[S]!==h[S-1]+1&&(R.push([C,h[S-1]]),C=h[S]);return R.push([C,h[h.length-1]]),R}const c=d(a),m=d(l);for(const[h,R]of c)for(const[C,S]of m)u.push({startRow:h,endRow:R,startColumn:C,endColumn:S});return u}var Oo=(s=>(s.OthersCanView="othersCanView",s.NoOneElseCanView="noOneElseCanView",s))(Oo||{}),Do=(s=>(s.DesignedUserCanEdit="designedUserCanEdit",s.OnlyMe="onlyMe",s))(Do||{});class X{constructor(){f(this,"_model",new Map);f(this,"_ruleChange$",new O.Subject);f(this,"ruleChange$",this._ruleChange$.asObservable());f(this,"_ruleRefresh$",new O.Subject);f(this,"ruleRefresh$",this._ruleRefresh$.asObservable());f(this,"_rangeRuleInitStateChange",new O.BehaviorSubject(!1));f(this,"rangeRuleInitStateChange$",this._rangeRuleInitStateChange.asObservable())}dispose(){this._ruleChange$.complete(),this._ruleRefresh$.complete()}ruleRefresh(e){this._ruleRefresh$.next(e)}getRangeRuleInitState(){return this._rangeRuleInitStateChange.value}changeRuleInitState(e){this._rangeRuleInitStateChange.next(e)}addRule(e,t,n){this._ensureRuleMap(e,t).set(n.id,n),this._ruleChange$.next({unitId:e,subUnitId:t,rule:n,type:"add"})}deleteRule(e,t,n){var r,a,l,u;const o=(a=(r=this._model.get(e))==null?void 0:r.get(t))==null?void 0:a.get(n);o&&((u=(l=this._model.get(e))==null?void 0:l.get(t))==null||u.delete(n),this._ruleChange$.next({unitId:e,subUnitId:t,rule:o,type:"delete"}))}setRule(e,t,n,o){var a,l;const r=this.getRule(e,t,n);r&&((l=(a=this._model.get(e))==null?void 0:a.get(t))==null||l.set(n,o),this._ruleChange$.next({unitId:e,subUnitId:t,oldRule:r,rule:o,type:"set"}))}getRule(e,t,n){var o,r;return(r=(o=this._model.get(e))==null?void 0:o.get(t))==null?void 0:r.get(n)}getSubunitRuleList(e,t){var o;return[...(((o=this._model.get(e))==null?void 0:o.get(t))||new Map).values()]}getSubunitRuleListLength(e,t){var o;const n=(o=this._model.get(e))==null?void 0:o.get(t);return n?n.size:0}_ensureRuleMap(e,t){let n=this._model.get(e);n||(n=new Map,this._model.set(e,n));let o=n.get(t);return o||(o=new Map,n.set(t,o)),o}toObject(){const e={};return[...this._model.keys()].forEach(n=>{const o=this._model.get(n),r=[...o.keys()];e[n]={},r.forEach(a=>{const l=o.get(a);e[n][a]=[...l.values()]})}),e}fromObject(e){const t=new Map;Object.keys(e).forEach(n=>{const o=e[n],r=new Map;Object.keys(o).forEach(a=>{const l=o[a].reduce((u,d)=>(u.set(d.id,d),u),new Map);r.set(a,l)}),t.set(n,r)}),this._model=t}deleteUnitModel(e){this._model.delete(e)}createRuleId(e,t){let n=i.generateRandomId(4);const o=this._ensureRuleMap(e,t);for(;o.has(n);)n=i.generateRandomId(4);return n}getTargetByPermissionId(e,t){const n=this._model.get(e);if(!n)return null;for(const[o,r]of n)for(const a of r.values())if(a.permissionId===t)return[e,o];return null}}const ol=(s,e)=>{const t=s.get(X),n=e.ruleIds.map(r=>t.getRule(e.unitId,e.subUnitId,r)).filter(r=>!!r);return{id:Ce.id,params:{subUnitId:e.subUnitId,unitId:e.unitId,rules:n}}},Te={id:"sheet.mutation.delete-range-protection",type:i.CommandType.MUTATION,handler:(s,e)=>{const{unitId:t,subUnitId:n,ruleIds:o}=e,r=s.get(X);return o.forEach(a=>{r.deleteRule(t,n,a)}),!0}},rl=s=>{const e={...s,ruleIds:s.rules.map(t=>t.id)};return{id:Te.id,params:e}},Ce={id:"sheet.mutation.add-range-protection",type:i.CommandType.MUTATION,handler:(s,e)=>{const{unitId:t,subUnitId:n,rules:o}=e,r=s.get(X);return o.forEach(a=>{r.addRule(t,n,a)}),!0}},Ao={type:i.CommandType.COMMAND,id:"sheet.command.add-range-protection",async handler(s,e){if(!e)return!1;const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),o=s.get(X),{rule:r,permissionId:a}=e,{unitId:l,subUnitId:u,ranges:d,description:c,viewState:m,editState:h}=r,R=[{ranges:d,permissionId:a,id:o.createRuleId(l,u),description:c,unitType:r.unitType,unitId:l,subUnitId:u,viewState:m,editState:h}];if(await t.executeCommand(Ce.id,{unitId:l,subUnitId:u,rules:R})){const S=[{id:Ce.id,params:{unitId:l,subUnitId:u,rules:R}}],I=[{id:Te.id,params:{unitId:l,subUnitId:u,ruleIds:R.map(v=>v.id)}}];n.pushUndoRedo({unitID:l,redoMutations:S,undoMutations:I})}return!0}};var te=(s=>(s[s.MOVE_START=0]="MOVE_START",s[s.MOVING=1]="MOVING",s[s.MOVE_END=2]="MOVE_END",s[s.ONLY_SET=3]="ONLY_SET",s))(te||{});class Wo extends i.Disposable{constructor(t){super();f(this,"_worksheetSelections",new Map);f(this,"_selectionMoveStart$",new O.Subject);f(this,"selectionMoveStart$",this._selectionMoveStart$.asObservable());f(this,"_selectionMoving$",new O.Subject);f(this,"selectionMoving$",this._selectionMoving$.asObservable());f(this,"_selectionMoveEnd$",new O.BehaviorSubject([]));f(this,"selectionMoveEnd$",this._selectionMoveEnd$.asObservable());f(this,"_selectionSet$",new O.BehaviorSubject([]));f(this,"selectionSet$",this._selectionSet$.asObservable());f(this,"selectionChanged$");f(this,"_beforeSelectionMoveEnd$",new O.BehaviorSubject([]));f(this,"beforeSelectionMoveEnd$",this._beforeSelectionMoveEnd$.asObservable());this._workbook=t,this.selectionChanged$=O.merge(this._selectionMoveEnd$,this._selectionSet$)}dispose(){super.dispose(),this._beforeSelectionMoveEnd$.complete(),this._selectionMoveEnd$.complete(),this._selectionMoving$.complete(),this._selectionMoveStart$.complete(),this._selectionSet$.complete(),this._workbook=null}addSelections(t,n){const o=this.getSelectionsOfWorksheet(t);o.push(...n),this._selectionSet$.next(o)}setSelections(t,n=[],o){switch(this.setSelectionsOfWorksheet(t,n),o){case te.MOVE_START:this._selectionMoveStart$.next(n);break;case te.MOVING:this._selectionMoving$.next(n);break;case te.MOVE_END:this._beforeSelectionMoveEnd$.next(n),this._selectionMoveEnd$.next(n);break;case te.ONLY_SET:{this._selectionSet$.next(n);break}default:this._selectionSet$.next(n);break}}getCurrentSelections(){return this._getCurrentSelections()}getSelectionOfWorksheet(t){return this.getSelectionsOfWorksheet(t)}getSelectionsOfWorksheet(t){return this._worksheetSelections.has(t)||this._worksheetSelections.set(t,[]),this._worksheetSelections.get(t)}setSelectionsOfWorksheet(t,n){this._worksheetSelections.set(t,[...n])}deleteSheetSelection(t){this._worksheetSelections.set(t,[])}clear(){this._worksheetSelections.clear(),this._selectionSet$.next([])}_getCurrentSelections(){return this.getSelectionsOfWorksheet(this._workbook.getActiveSheet().getSheetId())}getCurrentLastSelection(){const t=this._getCurrentSelections();return t[t.length-1]}}var il=Object.getOwnPropertyDescriptor,al=(s,e,t,n)=>{for(var o=n>1?void 0:n?il(e,t):e,r=s.length-1,a;r>=0;r--)(a=s[r])&&(o=a(o)||o);return o},ll=(s,e)=>(t,n)=>e(t,n,s);g.SheetsSelectionsService=class extends i.RxDisposable{constructor(t){super();f(this,"_cellStylesCache",new Map);f(this,"selectionMoveStart$");f(this,"selectionMoving$");f(this,"selectionMoveEnd$");f(this,"selectionSet$");f(this,"selectionChanged$");f(this,"_workbookSelections",new Map);this._instanceSrv=t,this._init()}get _currentSelectionPos(){const t=this._instanceSrv.getCurrentUnitForType(i.UniverInstanceType.UNIVER_SHEET);if(!t)return null;const n=t.getActiveSheet();return{unitId:t.getUnitId(),sheetId:n.getSheetId()}}get currentSelectionParam(){return this._currentSelectionPos}_init(){const t=this._instanceSrv.getCurrentTypeOfUnit$(i.UniverInstanceType.UNIVER_SHEET).pipe(O.shareReplay(1),O.takeUntil(this.dispose$));this.selectionMoveStart$=t.pipe().pipe(O.switchMap(n=>n?this._ensureWorkbookSelection(n.getUnitId()).selectionMoveStart$:O.of())).pipe(O.takeUntil(this.dispose$)),this.selectionMoving$=t.pipe(O.switchMap(n=>n?this._ensureWorkbookSelection(n.getUnitId()).selectionMoving$:O.of())).pipe(O.takeUntil(this.dispose$)),this.selectionMoveEnd$=t.pipe(O.switchMap(n=>n?this._ensureWorkbookSelection(n.getUnitId()).selectionMoveEnd$:O.of([]))).pipe(O.takeUntil(this.dispose$)),this.selectionSet$=t.pipe(O.switchMap(n=>n?this._ensureWorkbookSelection(n.getUnitId()).selectionSet$:O.of([]))).pipe(O.takeUntil(this.dispose$)),this.selectionChanged$=t.pipe(O.switchMap(n=>n?this._ensureWorkbookSelection(n.getUnitId()).selectionChanged$:O.of([]))).pipe(O.distinctUntilChanged((n,o)=>n.length!==o.length?!1:n.length===0&&o.length===0?!0:n.every((r,a)=>JSON.stringify(r)===JSON.stringify(o[a]))),O.skip(1)).pipe(O.takeUntil(this.dispose$)),this.disposeWithMe(this._instanceSrv.getTypeOfUnitDisposed$(i.UniverInstanceType.UNIVER_SHEET).pipe(O.takeUntil(this.dispose$)).subscribe(n=>{this._removeWorkbookSelection(n.getUnitId())})),this.disposeWithMe(this.selectionChanged$.pipe(O.takeUntil(this.dispose$)).subscribe(()=>{this._cellStylesCache.clear()}))}dispose(){super.dispose(),this._cellStylesCache.clear(),this._workbookSelections.forEach(t=>t.dispose()),this._workbookSelections.clear(),this.selectionMoveStart$=O.of(null),this.selectionMoving$=O.of(null),this.selectionMoveEnd$=O.of([]),this.selectionSet$=O.of(null),this.selectionChanged$=O.of(null)}clear(){this._workbookSelections.forEach(t=>t.clear())}getCurrentSelections(){return this._getCurrentSelections()}getCurrentLastSelection(){const t=this._getCurrentSelections();return t==null?void 0:t[t.length-1]}addSelections(t,n,o){if(typeof t=="string"){this._ensureWorkbookSelection(t).addSelections(n,o);return}const r=this._currentSelectionPos;if(!r)throw new Error("[SheetsSelectionsService]: cannot find current selection position!");const{unitId:a,sheetId:l}=r;this._ensureWorkbookSelection(a).addSelections(l,t)}setSelections(t,n,o,r){if(typeof t=="string"&&typeof n=="string"){const d=t;this._ensureWorkbookSelection(d).setSelections(n,o||[],r!=null?r:te.ONLY_SET);return}const a=this._currentSelectionPos;if(!a)throw new Error("[SheetsSelectionsService]: cannot find current selection position!");const{unitId:l,sheetId:u}=a;if(typeof t=="object"){const d=t!=null?t:o,c=n!=null?n:te.ONLY_SET;this._ensureWorkbookSelection(l).setSelections(u,d,c)}}clearCurrentSelections(){this._getCurrentSelections().splice(0)}isOverlapping(){const t=this.getCurrentSelections();return t==null?!1:t.some(({range:n},o)=>t.some(({range:r},a)=>o===a?!1:n.startRow<=r.endRow&&n.endRow>=r.startRow&&n.startColumn<=r.endColumn&&n.endColumn>=r.startColumn))}_getCurrentSelections(){const t=this._currentSelectionPos;if(!t)return[];const{unitId:n,sheetId:o}=t;return this._ensureWorkbookSelection(n).getSelectionsOfWorksheet(o)}getWorkbookSelections(t){return this._ensureWorkbookSelection(t)}_ensureWorkbookSelection(t){let n=this._workbookSelections.get(t);if(!n){const o=this._instanceSrv.getUnit(t);if(!o)throw new Error(`[SheetsSelectionsService]: cannot resolve unit with id "${t}"!`);n=new Wo(o),this._workbookSelections.set(t,n)}return n}_removeWorkbookSelection(t){this._workbookSelections.delete(t)}getCellStylesProperty(t){var a;const n=(a=this._instanceSrv.getCurrentUnitForType(i.UniverInstanceType.UNIVER_SHEET))==null?void 0:a.getActiveSheet(),o=this.getCurrentSelections();if(!n||o.length===0)return{isAllValuesSame:!1,value:null};let r=null;for(let l=0;l<o.length;l++){const u=o[l],{startRow:d,endRow:c,startColumn:m,endColumn:h}=u.range;for(let R=d;R<=c;R++)for(let C=m;C<=h;C++){const S=`${R}_${C}`;let I;this._cellStylesCache.has(S)?I=this._cellStylesCache.get(S):(I=n.getComposedCellStyle(R,C),this._cellStylesCache.set(S,I));const v=I[t];if(r!=null&&!i.Tools.diffValue(r,v))return{isAllValuesSame:!1,value:null};r=v}}return{isAllValuesSame:!0,value:r}}},g.SheetsSelectionsService=al([ll(0,i.IUniverInstanceService)],g.SheetsSelectionsService);const ul="DISABLE_NORMAL_SELECTIONS",dl="SELECTIONS_ENABLED",Vo="REF_SELECTIONS_ENABLED",on={id:"sheet.command.clear-selection-all",type:i.CommandType.COMMAND,handler:(s,e)=>{var p;const t=s.get(i.IUniverInstanceService),n=s.get(i.ICommandService),o=s.get(g.SheetsSelectionsService),r=s.get(i.IUndoRedoService),a=s.get(g.SheetInterceptorService),l=t.getCurrentUnitForType(i.UniverInstanceType.UNIVER_SHEET);if(!l)return!1;const u=(e==null?void 0:e.unitId)||l.getUnitId(),d=l.getActiveSheet();if(!d)return!1;const c=(e==null?void 0:e.subUnitId)||d.getSheetId(),m=(e==null?void 0:e.ranges)||((p=o.getCurrentSelections())==null?void 0:p.map(w=>w.range));if(!(m!=null&&m.length))return!1;const h=At(m,s,u,c),R=[],C=[],S={subUnitId:c,unitId:u,cellValue:Yn(h)},I=ce(s,S);R.push({id:F.id,params:S}),C.push({id:F.id,params:I});const v=a.onCommandExecute({id:on.id});return R.push(...v.redos),C.unshift(...v.undos),i.sequenceExecute(R,n)?(r.pushUndoRedo({unitID:u,undoMutations:C,redoMutations:R}),!0):!1}},rn={id:"sheet.command.clear-selection-format",type:i.CommandType.COMMAND,handler:(s,e)=>{var p;const t=s.get(i.IUniverInstanceService),n=s.get(i.ICommandService),o=s.get(g.SheetsSelectionsService),r=s.get(i.IUndoRedoService),a=s.get(g.SheetInterceptorService),l=t.getCurrentUnitForType(i.UniverInstanceType.UNIVER_SHEET);if(!l)return!1;const u=(e==null?void 0:e.unitId)||l.getUnitId(),d=l.getActiveSheet();if(!d)return!1;const c=(e==null?void 0:e.subUnitId)||d.getSheetId(),m=(e==null?void 0:e.ranges)||((p=o.getCurrentSelections())==null?void 0:p.map(w=>w.range));if(!(m!=null&&m.length))return!1;const h=At(m,s,u,c),R=[],C=[],S={subUnitId:c,unitId:u,cellValue:sl(h)},I=ce(s,S);R.push({id:F.id,params:S}),C.push({id:F.id,params:I});const v=a.onCommandExecute({id:rn.id});return R.push(...v.redos),C.unshift(...v.undos),i.sequenceExecute(R,n)?(r.pushUndoRedo({unitID:u,undoMutations:C,redoMutations:R}),!0):!1}};function Wt(s,e,t=!0){const n=e.getMatrixWithMergedCells(...i.selectionToArray(s)),o=[];if(n.forValue((a,l,u)=>{if(u.colSpan!==void 0&&u.rowSpan!==void 0){const d={startRow:a,startColumn:l,endRow:a+u.rowSpan-1,endColumn:l+u.colSpan-1};i.Rectangle.contains(s,d)||o.push(d)}}),o.length===0)return s;const r=i.Rectangle.union(s,...o);return t?Wt(r,e,t):r}function cl(s,e,t){let n=null;return t.getMatrixWithMergedCells(s,e,s,e).forValue((r,a,l)=>(n={actualRow:r,actualColumn:a,startRow:r,startColumn:a,isMerged:l.rowSpan!==void 0||l.colSpan!==void 0,isMergedMainCell:l.rowSpan!==void 0&&l.colSpan!==void 0,endRow:r+(l.rowSpan!==void 0?l.rowSpan-1:0),endColumn:a+(l.colSpan!==void 0?l.colSpan-1:0),rangeType:i.RANGE_TYPE.NORMAL},!1)),n||{actualColumn:e,actualRow:s,startRow:s,startColumn:e,endRow:s,endColumn:e,isMerged:!1,isMergedMainCell:!1,rangeType:i.RANGE_TYPE.NORMAL}}function ml(s,e,t){const{startRow:n,startColumn:o,endRow:r,endColumn:a}=s;return Number.isNaN(n)&&(s.startRow=0),Number.isNaN(r)&&(s.endRow=e-1),Number.isNaN(o)&&(s.startColumn=0),Number.isNaN(a)&&(s.endColumn=t-1),s}function se(s,e){const t=Number.isNaN(s.startRow)?0:s.startRow,n=Number.isNaN(s.startColumn)?0:s.startColumn,o=e.getMergedCell(t,n);return o?{...o,actualRow:t,actualColumn:n,rangeType:i.RANGE_TYPE.NORMAL,isMerged:!0,isMergedMainCell:!0}:{startRow:t,startColumn:n,endRow:s.startRow,endColumn:s.startColumn,actualRow:t,actualColumn:n,rangeType:i.RANGE_TYPE.NORMAL,isMerged:!1,isMergedMainCell:!1}}const Ue=(s,e,t)=>({id:q.id,params:{unitId:e.getUnitId(),subUnitId:t.getSheetId(),reveal:!0,selections:[{range:s,primary:se(s,t)}]}});function hl(s){if(!s)return!1;const{range:e,primary:t}=s;return i.Rectangle.equals(e,t)}function gl(s){function e(t,n){function o(r){for(let a=r.startRow;a<=r.endRow;a++)if(!s.getRowFiltered(a))for(let l=r.startColumn;l<=r.endColumn;l++)n(a,l,r)}o(t)}return{forOperableEach:e}}const $o=s=>s.id!==oo;function $e(s,e,t,n,o,r,a){const l={};for(let u=e;u<=t;u++)for(let d=n;d<=o;d++){const c=r?s.getCellWithFilteredInterceptors(a,d,ro,$o):s.getCellWithFilteredInterceptors(u,a,ro,$o);!c||!c.s||(l[u]||(l[u]={}),l[u][d]={s:c.s})}for(const u in l){for(const d in l[u]){const c=l[u][d];c.s&&typeof c.s=="object"&&i.Tools.isEmptyObject(c.s)&&delete c.s,i.Tools.isEmptyObject(c)&&delete l[u][d]}i.Tools.isEmptyObject(l[u])&&delete l[u]}return l}var Rl=Object.getOwnPropertyDescriptor,Cl=(s,e,t,n)=>{for(var o=n>1?void 0:n?Rl(e,t):e,r=s.length-1,a;r>=0;r--)(a=s[r])&&(o=a(o)||o);return o},Sl=(s,e)=>(t,n)=>e(t,n,s);const Lo=i.createIdentifier("sheets-formula.ref-selections.service");g.RefSelectionsService=class extends g.SheetsSelectionsService{constructor(e){super(e)}_init(){const e=this._getAliveWorkbooks$().pipe(O.takeUntil(this.dispose$));this.selectionMoveStart$=e.pipe(O.switchMap(t=>O.merge(...t.map(n=>n.selectionMoveStart$)))),this.selectionMoving$=e.pipe(O.switchMap(t=>O.merge(...t.map(n=>n.selectionMoving$)))),this.selectionMoveEnd$=e.pipe(O.switchMap(t=>O.merge(...t.map(n=>n.selectionMoveEnd$)))),this.selectionSet$=e.pipe(O.switchMap(t=>O.merge(...t.map(n=>n.selectionSet$))))}dispose(){super.dispose(),this.selectionMoveStart$=O.of(null),this.selectionMoving$=O.of(null),this.selectionMoveEnd$=O.of(null),this.selectionSet$=O.of(null),delete this._instanceSrv,this._workbookSelections.clear()}_getAliveWorkbooks$(){const e=this._instanceSrv.getAllUnitsForType(i.UniverInstanceType.UNIVER_SHEET);e.forEach(n=>this._ensureWorkbookSelection(n.getUnitId()));const t=new O.BehaviorSubject(e);return this.disposeWithMe(this._instanceSrv.getTypeOfUnitAdded$(i.UniverInstanceType.UNIVER_SHEET).subscribe(n=>{this._ensureWorkbookSelection(n.getUnitId()),t.next([...t.getValue(),n])})),this.disposeWithMe(this._instanceSrv.getTypeOfUnitDisposed$(i.UniverInstanceType.UNIVER_SHEET).subscribe(n=>{this._removeWorkbookSelection(n.getUnitId()),t.next(t.getValue().filter(o=>o!==n))})),t.pipe(O.map(n=>n.map(o=>this._ensureWorkbookSelection(o.getUnitId()))))}},g.RefSelectionsService=Cl([Sl(0,i.IUniverInstanceService)],g.RefSelectionsService);function Bo(s,e){const n=s.get(i.IContextService).getContextValue(Vo);return s.get(n&&!e?Lo:g.SheetsSelectionsService)}const q={id:"sheet.operation.set-selections",type:i.CommandType.OPERATION,handler:(s,e)=>{if(!e)return!1;const{selections:t,type:n,unitId:o,subUnitId:r}=e;return Bo(s).setSelections(o,r,[...t],n),!0}},Ho={id:"sheet.command.select-range",type:i.CommandType.COMMAND,handler:(s,e)=>{if(!e)return!1;const{unitId:t,subUnit:n,range:o}=e,r=s.get(i.ICommandService),a=P(s.get(i.IUniverInstanceService),e);if(!a)return!1;const l=[{range:o,primary:se(o,a.worksheet),style:null}];return r.syncExecuteCommand(q.id,{unitId:t,subUnitId:n,selections:l})}},Fo="sheet.command.move-range",xe={type:i.CommandType.COMMAND,id:Fo,handler:async(s,e)=>{var M,p;const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),o=s.get(i.IUniverInstanceService),r=s.get(i.ErrorService),a=s.get(i.LocaleService),l=s.get(g.SheetInterceptorService),u=P(o);if(!u||!await l.beforeCommandExecute({id:xe.id,params:e}))return!1;const{worksheet:c,subUnitId:m,unitId:h}=u,R=an(s,{unitId:h,subUnitId:m,range:e.fromRange},{subUnitId:m,range:e.toRange});if(R===null)return r.emit(a.t("sheets.info.acrossMergedCell")),!1;const C=l.onCommandExecute({id:xe.id,params:e}),S=[...(M=C.preRedos)!=null?M:[],...R.redos,...C.redos,{id:q.id,params:{unitId:h,subUnitId:m,selections:[{range:e.toRange,primary:fl(e.fromRange,e.toRange,c)}],type:te.MOVE_END}}],I=[...(p=C.preUndos)!=null?p:[],...R.undos,...C.undos,{id:q.id,params:{unitId:h,subUnitId:m,selections:[{range:e.fromRange,primary:se(e.fromRange,c)}],type:te.MOVE_END}}];if(i.sequenceExecute(S,t).result){const{undos:w,redos:y}=l.generateMutationsOfAutoHeight({unitId:h,subUnitId:m,ranges:[e.fromRange,e.toRange]}),b=l.afterCommandExecute({id:xe.id,params:e});return i.sequenceExecute([...b.redos,...y],t),n.pushUndoRedo({unitID:h,undoMutations:[...I,...b.undos,...w],redoMutations:[...S,...b.redos,...y]}),!0}return!1}};function an(s,e,t,n=!1){const o=[],r=[],{range:a,subUnitId:l,unitId:u}=e,{range:d,subUnitId:c}=t,h=s.get(i.IUniverInstanceService).getUniverSheetInstance(u),R=h==null?void 0:h.getSheetBySheetId(c),C=h==null?void 0:h.getSheetBySheetId(l),S=R==null?void 0:R.getCellMatrix(),I=C==null?void 0:C.getCellMatrix();if(R&&C&&S&&I){const v=Wt(d,R,!1);if(!i.Rectangle.equals(d,v)&&!n)return null;const M=new i.ObjectMatrix,p=new i.ObjectMatrix,w=new i.ObjectMatrix;i.Range.foreach(a,(k,T)=>{const N=I.getValue(k,T);if(M.setValue(k,T,i.Tools.deepClone(N)),N){const W=h==null?void 0:h.getStyles().get(N.s);w.setValue(k,T,i.Tools.deepClone(W))}p.setValue(k,T,null)});const y=new i.ObjectMatrix,b=new i.ObjectMatrix;i.Range.foreach(d,(k,T)=>{y.setValue(k,T,i.Tools.deepClone(S.getValue(k,T)))}),i.Range.foreach(a,(k,T)=>{const N=i.cellToRange(k,T),W=i.Rectangle.getRelativeRange(N,a),V=i.Rectangle.getPositionRange(W,d),$=i.Tools.deepClone(w.getValue(k,T)),L=i.Tools.deepClone(M.getValue(k,T));L&&$&&(L.s=$),b.setValue(V.startRow,V.startColumn,L)});const E={fromRange:e.range,toRange:t.range,from:{value:p.getMatrix(),subUnitId:l},to:{value:b.getMatrix(),subUnitId:c},unitId:u},U={fromRange:t.range,toRange:e.range,from:{value:M.getMatrix(),subUnitId:l},to:{value:y.getMatrix(),subUnitId:c},unitId:u};o.push({id:Le.id,params:E}),r.push({id:Le.id,params:U})}return{redos:o,undos:r}}function fl(s,e,t){const n=s.startRow,o=s.startColumn,r=t.getMergedCell(n,o),a=se(e,t);if(r){const l=r.endRow-r.startRow+1,u=r.endColumn-r.startColumn+1;a.endRow=a.startRow+l-1,a.endColumn=a.startColumn+u-1,a.actualRow=a.startRow,a.actualColumn=a.startColumn,a.isMerged=!1,a.isMergedMainCell=!0}return a}var ln=(s=>(s[s.UNIVER_UNKNOWN=0]="UNIVER_UNKNOWN",s[s.UNIVER_DOC=1]="UNIVER_DOC",s[s.UNIVER_SHEET=2]="UNIVER_SHEET",s[s.UNIVER_SLIDE=3]="UNIVER_SLIDE",s[s.UNIVER_PROJECT=4]="UNIVER_PROJECT",s[s.UNRECOGNIZED=-1]="UNRECOGNIZED",s))(ln||{}),_=(s=>(s[s.View=0]="View",s[s.Edit=1]="Edit",s[s.ManageCollaborator=2]="ManageCollaborator",s[s.Print=3]="Print",s[s.Duplicate=4]="Duplicate",s[s.Comment=5]="Comment",s[s.Copy=6]="Copy",s[s.Share=7]="Share",s[s.Export=8]="Export",s[s.MoveWorksheet=9]="MoveWorksheet",s[s.DeleteWorksheet=10]="DeleteWorksheet",s[s.HideWorksheet=11]="HideWorksheet",s[s.RenameWorksheet=12]="RenameWorksheet",s[s.CreateWorksheet=13]="CreateWorksheet",s[s.SetWorksheetStyle=14]="SetWorksheetStyle",s[s.EditWorksheetCell=15]="EditWorksheetCell",s[s.InsertHyperlink=16]="InsertHyperlink",s[s.Sort=17]="Sort",s[s.Filter=18]="Filter",s[s.PivotTable=19]="PivotTable",s[s.FloatImg=20]="FloatImg",s[s.History=21]="History",s[s.RwHgtClWdt=22]="RwHgtClWdt",s[s.ViemRwHgtClWdt=23]="ViemRwHgtClWdt",s[s.ViewFilter=24]="ViewFilter",s[s.MoveSheet=25]="MoveSheet",s[s.DeleteSheet=26]="DeleteSheet",s[s.HideSheet=27]="HideSheet",s[s.CopySheet=28]="CopySheet",s[s.RenameSheet=29]="RenameSheet",s[s.CreateSheet=30]="CreateSheet",s[s.SelectProtectedCells=31]="SelectProtectedCells",s[s.SelectUnProtectedCells=32]="SelectUnProtectedCells",s[s.SetCellStyle=33]="SetCellStyle",s[s.SetCellValue=34]="SetCellValue",s[s.SetRowStyle=35]="SetRowStyle",s[s.SetColumnStyle=36]="SetColumnStyle",s[s.InsertRow=37]="InsertRow",s[s.InsertColumn=38]="InsertColumn",s[s.DeleteRow=39]="DeleteRow",s[s.DeleteColumn=40]="DeleteColumn",s[s.EditExtraObject=41]="EditExtraObject",s[s.Delete=42]="Delete",s[s.RecoverHistory=43]="RecoverHistory",s[s.ViewHistory=44]="ViewHistory",s[s.CreatePermissionObject=45]="CreatePermissionObject",s[s.UNRECOGNIZED=-1]="UNRECOGNIZED",s))(_||{}),D=(s=>(s[s.Unkonwn=0]="Unkonwn",s[s.Workbook=1]="Workbook",s[s.Worksheet=2]="Worksheet",s[s.SelectRange=3]="SelectRange",s[s.Document=4]="Document",s[s.Slide=5]="Slide",s[s.UNRECOGNIZED=-1]="UNRECOGNIZED",s))(D||{});class Se{constructor(e,t,n){f(this,"type",D.SelectRange);f(this,"subType",_.Edit);f(this,"status",i.PermissionStatus.INIT);f(this,"value",!0);f(this,"id");f(this,"unitId");f(this,"subUnitId");f(this,"permissionId");this.unitId=e,this.subUnitId=t,this.permissionId=n,this.id=`${D.SelectRange}.${_.Edit}.${n}`}}class un{constructor(e,t,n){f(this,"type",D.SelectRange);f(this,"subType",_.View);f(this,"status",i.PermissionStatus.INIT);f(this,"value",!1);f(this,"id");f(this,"unitId");f(this,"subUnitId");f(this,"permissionId");this.unitId=e,this.subUnitId=t,this.permissionId=n,this.id=`${D.SelectRange}.${_.View}.${n}`}}class Kn{constructor(e){f(this,"id");f(this,"value",!0);f(this,"type",D.Workbook);f(this,"status",i.PermissionStatus.INIT);f(this,"subType",_.Comment);this.unitId=e,this.unitId=e,this.id=`${this.type}.${_.Comment}_${e}`}}class Jn{constructor(e){f(this,"id");f(this,"value",!0);f(this,"type",D.Workbook);f(this,"status",i.PermissionStatus.INIT);f(this,"subType",_.Copy);this.unitId=e,this.unitId=e,this.id=`${this.type}.${_.Copy}_${e}`}}class jo{constructor(e){f(this,"id");f(this,"value",!0);f(this,"type",D.Workbook);f(this,"subType",_.CopySheet);f(this,"status",i.PermissionStatus.INIT);this.unitId=e,this.unitId=e,this.id=`${this.type}.${_.CopySheet}_${e}`}}class xn{constructor(e){f(this,"id");f(this,"value",!0);f(this,"type",D.Workbook);f(this,"status",i.PermissionStatus.INIT);f(this,"subType",_.CreatePermissionObject);this.unitId=e,this.unitId=e,this.id=`${this.type}.${_.CreatePermissionObject}_${e}`}}class Xn{constructor(e){f(this,"id");f(this,"value",!0);f(this,"type",D.Workbook);f(this,"status",i.PermissionStatus.INIT);f(this,"subType",_.CreateSheet);this.unitId=e,this.unitId=e,this.id=`${this.type}.${_.CreateSheet}_${e}`}}class Go{constructor(e){f(this,"value",!0);f(this,"type",D.Workbook);f(this,"status",i.PermissionStatus.INIT);f(this,"id");f(this,"subType",_.DeleteColumn);this.unitId=e,this.id=`${this.type}.${_.DeleteColumn}_${e}`}}class zo{constructor(e){f(this,"value",!0);f(this,"type",D.Workbook);f(this,"status",i.PermissionStatus.INIT);f(this,"id");f(this,"subType",_.DeleteRow);this.unitId=e,this.id=`${this.type}.${_.DeleteRow}_${e}`}}class Zn{constructor(e){f(this,"id");f(this,"value",!0);f(this,"type",D.Workbook);f(this,"status",i.PermissionStatus.INIT);f(this,"subType",_.DeleteSheet);this.unitId=e,this.unitId=e,this.id=`${this.type}.${_.DeleteSheet}_${e}`}}class Qn{constructor(e){f(this,"id");f(this,"value",!0);f(this,"type",D.Workbook);f(this,"status",i.PermissionStatus.INIT);f(this,"subType",_.Duplicate);this.unitId=e,this.unitId=e,this.id=`${this.type}.${_.Duplicate}_${e}`}}class me{constructor(e){f(this,"id");f(this,"value",!0);f(this,"type",D.Workbook);f(this,"status",i.PermissionStatus.INIT);f(this,"subType",_.Edit);this.unitId=e,this.unitId=e,this.id=`${this.type}.${_.Edit}_${e}`}}class es{constructor(e){f(this,"id");f(this,"value",!0);f(this,"type",D.Workbook);f(this,"status",i.PermissionStatus.INIT);f(this,"subType",_.Export);this.unitId=e,this.unitId=e,this.id=`${this.type}.${_.Export}_${e}`}}class dn{constructor(e){f(this,"id");f(this,"value",!0);f(this,"type",D.Workbook);f(this,"status",i.PermissionStatus.INIT);f(this,"subType",_.HideSheet);this.unitId=e,this.unitId=e,this.id=`${this.type}.${_.HideSheet}_${e}`}}class qo{constructor(e){f(this,"id");f(this,"value",!0);f(this,"type",D.Workbook);f(this,"status",i.PermissionStatus.INIT);f(this,"subType",_.History);this.unitId=e,this.unitId=e,this.id=`${this.type}.${_.History}_${e}`}}class Yo{constructor(e){f(this,"value",!0);f(this,"type",D.Workbook);f(this,"status",i.PermissionStatus.INIT);f(this,"id");f(this,"subType",_.InsertColumn);this.unitId=e,this.id=`${this.type}.${_.InsertColumn}_${e}`}}class Ko{constructor(e){f(this,"value",!0);f(this,"type",D.Workbook);f(this,"status",i.PermissionStatus.INIT);f(this,"id");f(this,"subType",_.InsertRow);this.unitId=e,this.id=`${this.type}.${_.InsertRow}_${e}`}}class cn{constructor(e){f(this,"id");f(this,"value",!0);f(this,"type",D.Workbook);f(this,"status",i.PermissionStatus.INIT);f(this,"subType",_.ManageCollaborator);this.unitId=e,this.unitId=e,this.id=`${this.type}.${_.ManageCollaborator}_${e}`}}class mn{constructor(e){f(this,"id");f(this,"value",!0);f(this,"type",D.Workbook);f(this,"status",i.PermissionStatus.INIT);f(this,"subType",_.MoveSheet);this.unitId=e,this.unitId=e,this.id=`${this.type}.${_.MoveSheet}_${e}`}}class ts{constructor(e){f(this,"id");f(this,"value",!0);f(this,"type",D.Workbook);f(this,"status",i.PermissionStatus.INIT);f(this,"subType",_.Print);this.unitId=e,this.unitId=e,this.id=`${this.type}.${_.Print}_${e}`}}class ns{constructor(e){f(this,"id");f(this,"value",!0);f(this,"type",D.Workbook);f(this,"status",i.PermissionStatus.INIT);f(this,"subType",_.RecoverHistory);this.unitId=e,this.unitId=e,this.id=`${this.type}.${_.RecoverHistory}_${e}`}}class hn{constructor(e){f(this,"id");f(this,"value",!0);f(this,"type",D.Workbook);f(this,"status",i.PermissionStatus.INIT);f(this,"subType",_.RenameSheet);this.unitId=e,this.unitId=e,this.id=`${this.type}.${_.RenameSheet}_${e}`}}class ss{constructor(e){f(this,"id");f(this,"value",!0);f(this,"type",D.Workbook);f(this,"status",i.PermissionStatus.INIT);f(this,"subType",_.Share);this.unitId=e,this.unitId=e,this.id=`${this.type}.${_.Share}_${e}`}}class os{constructor(e){f(this,"id");f(this,"value",!0);f(this,"type",D.Workbook);f(this,"status",i.PermissionStatus.INIT);f(this,"subType",_.View);this.unitId=e,this.unitId=e,this.id=`${this.type}.${_.View}_${e}`}}class rs{constructor(e){f(this,"id");f(this,"value",!0);f(this,"type",D.Workbook);f(this,"status",i.PermissionStatus.INIT);f(this,"subType",_.ViewHistory);this.unitId=e,this.unitId=e,this.id=`${this.type}.${_.ViewHistory}_${e}`}}class is{constructor(e,t){f(this,"value",!0);f(this,"type",D.Worksheet);f(this,"status",i.PermissionStatus.INIT);f(this,"id");f(this,"subType",_.Copy);this.unitId=e,this.subUnitId=t,this.id=`${this.type}.${_.Copy}_${e}_${t}`}}class as{constructor(e,t){f(this,"value",!0);f(this,"type",D.Worksheet);f(this,"status",i.PermissionStatus.INIT);f(this,"id");f(this,"subType",_.DeleteColumn);this.unitId=e,this.subUnitId=t,this.id=`${this.type}.${_.DeleteColumn}_${e}_${t}`}}class ls{constructor(e,t){f(this,"value",!0);f(this,"type",D.Worksheet);f(this,"status",i.PermissionStatus.INIT);f(this,"id");f(this,"subType",_.Delete);this.unitId=e,this.subUnitId=t,this.id=`${this.type}.${_.Delete}_${e}_${t}`}}class us{constructor(e,t){f(this,"value",!0);f(this,"type",D.Worksheet);f(this,"status",i.PermissionStatus.INIT);f(this,"id");f(this,"subType",_.DeleteRow);this.unitId=e,this.subUnitId=t,this.id=`${this.type}.${_.DeleteRow}_${e}_${t}`}}class fe{constructor(e,t){f(this,"value",!0);f(this,"type",D.Worksheet);f(this,"status",i.PermissionStatus.INIT);f(this,"id");f(this,"subType",_.Edit);this.unitId=e,this.subUnitId=t,this.id=`${this.type}.${_.Edit}_${e}_${t}`}}class ds{constructor(e,t){f(this,"value",!0);f(this,"type",D.Worksheet);f(this,"status",i.PermissionStatus.INIT);f(this,"id");f(this,"subType",_.EditExtraObject);this.unitId=e,this.subUnitId=t,this.id=`${this.type}.${_.EditExtraObject}_${e}_${t}`}}class cs{constructor(e,t){f(this,"value",!0);f(this,"type",D.Worksheet);f(this,"status",i.PermissionStatus.INIT);f(this,"id");f(this,"subType",_.Filter);this.unitId=e,this.subUnitId=t,this.id=`${this.type}.${_.Filter}_${e}_${t}`}}class ms{constructor(e,t){f(this,"value",!0);f(this,"type",D.Worksheet);f(this,"status",i.PermissionStatus.INIT);f(this,"id");f(this,"subType",_.InsertColumn);this.unitId=e,this.subUnitId=t,this.id=`${this.type}.${_.InsertColumn}_${e}_${t}`}}class hs{constructor(e,t){f(this,"value",!0);f(this,"type",D.Worksheet);f(this,"status",i.PermissionStatus.INIT);f(this,"id");f(this,"subType",_.InsertHyperlink);this.unitId=e,this.subUnitId=t,this.id=`${this.type}.${_.InsertHyperlink}_${e}_${t}`}}class gs{constructor(e,t){f(this,"value",!0);f(this,"type",D.Worksheet);f(this,"status",i.PermissionStatus.INIT);f(this,"id");f(this,"subType",_.InsertRow);this.unitId=e,this.subUnitId=t,this.id=`${this.type}.${_.InsertRow}_${e}_${t}`}}class Rs{constructor(e,t){f(this,"value",!0);f(this,"type",D.Worksheet);f(this,"status",i.PermissionStatus.INIT);f(this,"id");f(this,"subType",_.ManageCollaborator);this.unitId=e,this.subUnitId=t,this.id=`${this.type}.${_.ManageCollaborator}_${e}_${t}`}}class Cs{constructor(e,t){f(this,"value",!0);f(this,"type",D.Worksheet);f(this,"status",i.PermissionStatus.INIT);f(this,"id");f(this,"subType",_.PivotTable);this.unitId=e,this.subUnitId=t,this.id=`${this.type}.${_.PivotTable}_${e}_${t}`}}class Il{constructor(e,t){f(this,"value",!0);f(this,"type",D.Worksheet);f(this,"status",i.PermissionStatus.INIT);f(this,"id");f(this,"subType",_.SelectProtectedCells);this.unitId=e,this.subUnitId=t,this.id=`${this.type}.${_.SelectProtectedCells}_${e}_${t}`}}class vl{constructor(e,t){f(this,"value",!0);f(this,"type",D.Worksheet);f(this,"status",i.PermissionStatus.INIT);f(this,"id");f(this,"subType",_.SelectUnProtectedCells);this.unitId=e,this.subUnitId=t,this.id=`${this.type}.${_.SelectUnProtectedCells}_${e}_${t}`}}class Ss{constructor(e,t){f(this,"value",!0);f(this,"type",D.Worksheet);f(this,"status",i.PermissionStatus.INIT);f(this,"id");f(this,"subType",_.SetCellStyle);this.unitId=e,this.subUnitId=t,this.id=`${this.type}.${_.SetCellStyle}_${e}_${t}`}}class Vt{constructor(e,t){f(this,"value",!0);f(this,"type",D.Worksheet);f(this,"status",i.PermissionStatus.INIT);f(this,"id");f(this,"subType",_.SetCellValue);this.unitId=e,this.subUnitId=t,this.id=`${this.type}.${_.SetCellValue}_${e}_${t}`}}class ft{constructor(e,t){f(this,"value",!0);f(this,"type",D.Worksheet);f(this,"status",i.PermissionStatus.INIT);f(this,"id");f(this,"subType",_.SetColumnStyle);this.unitId=e,this.subUnitId=t,this.id=`${this.type}.${_.SetColumnStyle}_${e}_${t}`}}class It{constructor(e,t){f(this,"value",!0);f(this,"type",D.Worksheet);f(this,"status",i.PermissionStatus.INIT);f(this,"id");f(this,"subType",_.SetRowStyle);this.unitId=e,this.subUnitId=t,this.id=`${this.type}.${_.SetRowStyle}_${e}_${t}`}}class fs{constructor(e,t){f(this,"value",!0);f(this,"type",D.Worksheet);f(this,"status",i.PermissionStatus.INIT);f(this,"id");f(this,"subType",_.Sort);this.unitId=e,this.subUnitId=t,this.id=`${this.type}.${_.Sort}_${e}_${t}`}}class $t{constructor(e,t){f(this,"value",!0);f(this,"type",D.Worksheet);f(this,"status",i.PermissionStatus.INIT);f(this,"id");f(this,"subType",_.View);this.unitId=e,this.subUnitId=t,this.id=`${this.type}.${_.View}_${e}_${t}`}}const vt={id:"sheet.command.set-range-values",type:i.CommandType.COMMAND,handler:(s,e)=>{var W;const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),o=s.get(i.IUniverInstanceService),r=s.get(g.SheetsSelectionsService),a=s.get(g.SheetInterceptorService),l=s.get(i.IPermissionService),u=P(o,e);if(!u)return!1;const{subUnitId:d,unitId:c,workbook:m,worksheet:h}=u,{value:R,range:C,redoUndoId:S}=e,I=C?[C]:(W=r.getCurrentSelections())==null?void 0:W.map(V=>V.range);if(!I||!I.length||!l.getPermissionPoint(new fe(c,d).id))return!1;const v=new i.ObjectMatrix;let M;if(i.Tools.isArray(R))for(let V=0;V<I.length;V++){const{startRow:$,startColumn:L,endRow:Y,endColumn:z}=I[V];for(let K=0;K<=Y-$;K++)for(let oe=0;oe<=z-L;oe++)v.setValue(K+$,oe+L,R[K][oe])}else if(i.isICellData(R))for(let V=0;V<I.length;V++){const{startRow:$,startColumn:L,endRow:Y,endColumn:z}=I[V];for(let K=$;K<=Y;K++)for(let oe=L;oe<=z;oe++)v.setValue(K,oe,R)}else M=R;const p={subUnitId:d,unitId:c,cellValue:M!=null?M:v.getMatrix()},w=ce(s,p),y=i.mapObjectMatrix(p.cellValue,(V,$)=>h.getCellHeight(V,$)||void 0);if(!t.syncExecuteCommand(F.id,p))return!1;const{undos:E,redos:U}=a.onCommandExecute({id:vt.id,params:p}),{undos:k,redos:T}=a.generateMutationsOfAutoHeight({unitId:c,subUnitId:d,ranges:I,cellHeights:new i.ObjectMatrix(y)});if(i.sequenceExecute([...U,...T],t).result){const V=Ue(C!=null?C:v.getRange(),m,h);return n.pushUndoRedo({unitID:c,undoMutations:[{id:F.id,params:w},...E,...k,V],redoMutations:[{id:F.id,params:p},...U,...T,i.Tools.deepClone(V)],id:S}),!0}return!1}};function Is(s,e){const t=[],n=[],{unitId:o,subUnitId:r,range:a,shiftDimension:l,cellValue:u={}}=e,d=s.get(i.IUniverInstanceService),c=s.get(g.SheetInterceptorService),m=d.getUniverSheetInstance(o),h=m==null?void 0:m.getSheetBySheetId(r);if(h){const R=h.getCellMatrix(),C=R.getDataRange();if(a.startColumn<=C.endColumn||a.startRow<=C.endRow){let p,w;if(l===i.Dimension.COLUMNS){const b=Math.min(a.endRow,C.endRow);let E=0;for(let k=a.startRow;k<=b;k++){const T=R.getRow(k),N=T?i.getArrayLength(T)-1:0;E=Math.max(E,N)}p={startRow:a.startRow,startColumn:a.startColumn,endRow:b,endColumn:E};const U=a.endColumn-a.startColumn+1;w={startRow:a.startRow,startColumn:p.startColumn+U,endRow:b,endColumn:p.endColumn+U}}else{const b=Math.min(a.endColumn,C.endColumn),E=C.endRow;p={startRow:a.startRow,startColumn:a.startColumn,endRow:E,endColumn:b};const U=a.endRow-a.startRow+1;w={startRow:p.startRow+U,startColumn:a.startColumn,endRow:p.endRow+U,endColumn:b}}const y=an(s,{unitId:o,subUnitId:r,range:p},{subUnitId:r,range:w},!0);y&&(t.push(...y.redos),n.push(...y.undos))}if(Object.entries(u).length===0)for(let p=a.startRow;p<=a.endRow;p++){u[p]||(u[p]={});for(let w=a.startColumn;w<=a.endColumn;w++)u[p][w]=null}const S={subUnitId:r,unitId:o,cellValue:u},I=ce(s,S),{undos:v,redos:M}=c.onCommandExecute({id:vt.id,params:{...S,range:a}});t.push({id:F.id,params:S},...M),n.push({id:F.id,params:I},...v)}return{redo:t,undo:n}}function vs(s,e){const t=[],n=[],{unitId:o,subUnitId:r,range:a,shiftDimension:l}=e,u=s.get(i.IUniverInstanceService),d=s.get(g.SheetInterceptorService),c=u.getUniverSheetInstance(o),m=c==null?void 0:c.getSheetBySheetId(r);if(m){const h=m.getCellMatrix(),R=h.getDataRange(),C={subUnitId:r,unitId:o,cellValue:Yn([a])},S=ce(s,C),I=d.onCommandExecute({id:vt.id,params:C});if(t.push({id:F.id,params:C},...I.redos),n.push(...I.undos,{id:F.id,params:S}),a.startColumn<=R.endColumn||a.startRow<=R.endRow){let v=null,M=null;if(l===i.Dimension.COLUMNS&&a.endColumn<R.endColumn){const p=Math.min(a.endRow,R.endRow);let w=0;for(let b=a.startRow;b<=p;b++){const E=h.getRow(b),U=E?i.getArrayLength(E)-1:0;w=Math.max(w,U)}v={startRow:a.startRow,startColumn:a.endColumn+1,endRow:p,endColumn:w};const y=a.endColumn-a.startColumn+1;M={startRow:a.startRow,startColumn:v.startColumn-y,endRow:p,endColumn:v.endColumn-y}}if(l===i.Dimension.ROWS&&a.endRow<R.endRow){const p=Math.min(a.endColumn,R.endColumn),w=R.endRow;v={startRow:a.endRow+1,startColumn:a.startColumn,endRow:w,endColumn:p};const y=a.endRow-a.startRow+1;M={startRow:v.startRow-y,startColumn:a.startColumn,endRow:v.endRow-y,endColumn:p}}if(v&&M){const p=an(s,{unitId:o,subUnitId:r,range:v},{subUnitId:r,range:M},!0);p&&(t.push(...p.redos),n.push(...p.undos))}}}return{redo:t,undo:n}}function pl(s,e,t,n,o,r){const{startRow:a,endRow:l,startColumn:u,endColumn:d}=e;if(o===i.Dimension.ROWS){const c=l-a+1;for(let m=t;m>=a;m--)for(let h=u;h<=d;h++){const R=s.getValue(m,h);R==null?s.realDeleteValue(m+c,h):s.setValue(m+c,h,R)}for(let m=l;m>=a;m--)for(let h=u;h<=d;h++)r&&r[m]&&r[m][h]?s.setValue(m,h,r[m][h]):s.realDeleteValue(m,h)}else if(o===i.Dimension.COLUMNS){const c=d-u+1;for(let m=a;m<=l;m++)for(let h=n;h>=u;h--){const R=s.getValue(m,h);R==null?s.realDeleteValue(m,h+c):s.setValue(m,h+c,R)}for(let m=a;m<=l;m++)for(let h=d;h>=u;h--)r&&r[m]&&r[m][h]?s.setValue(m,h,r[m][h]):s.realDeleteValue(m,h)}}function wl(s,e,t,n,o){const{startRow:r,endRow:a,startColumn:l,endColumn:u}=e,d=a-r+1,c=u-l+1;if(o===i.Dimension.ROWS)for(let m=r;m<=t;m++)for(let h=l;h<=u;h++){const R=s.getValue(m+d,h);R==null?s.realDeleteValue(m,h):s.setValue(m,h,R)}else if(o===i.Dimension.COLUMNS)for(let m=r;m<=a;m++)for(let h=l;h<=n;h++){const R=s.getValue(m,h+c);R==null?s.realDeleteValue(m,h):s.setValue(m,h,R)}}const Jo="sheet.command.delete-range-move-left",He={type:i.CommandType.COMMAND,id:Jo,handler:async(s,e)=>{var w,y,b;const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),o=s.get(i.IUniverInstanceService),r=s.get(g.SheetsSelectionsService),a=s.get(g.SheetInterceptorService),l=P(o);if(!l)return!1;const{worksheet:u,workbook:d,subUnitId:c,unitId:m}=l;let h=e==null?void 0:e.range;if(h||(h=(w=r.getCurrentLastSelection())==null?void 0:w.range),!h)return!1;const R={range:h,subUnitId:c,unitId:m,shiftDimension:i.Dimension.COLUMNS},C=a.onCommandExecute({id:He.id,params:{range:h}}),{redo:S,undo:I}=vs(s,R),v=[...(y=C.preRedos)!=null?y:[],...S],M=[...C.undos,...I];if(v.push(...C.redos),v.push(Ue(h,d,u)),M.push(...(b=C.preUndos)!=null?b:[]),i.sequenceExecute(v,t).result){const E=a.afterCommandExecute({id:He.id,params:{range:h}});return i.sequenceExecute(E.redos,t),M.push(...E.undos),v.push(...E.redos),n.pushUndoRedo({unitID:m,undoMutations:M.reverse(),redoMutations:v}),!0}return!1}},xo="sheet.command.delete-range-move-up",Fe={type:i.CommandType.COMMAND,id:xo,handler:async(s,e)=>{var w,y,b;const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),o=s.get(i.IUniverInstanceService),r=s.get(g.SheetsSelectionsService),a=s.get(g.SheetInterceptorService),l=P(o);if(!l)return!1;const{unitId:u,subUnitId:d,workbook:c,worksheet:m}=l;let h=e==null?void 0:e.range;if(h||(h=(w=r.getCurrentLastSelection())==null?void 0:w.range),!h)return!1;const R={range:h,subUnitId:d,unitId:u,shiftDimension:i.Dimension.ROWS},C=a.onCommandExecute({id:Fe.id,params:{range:h}}),{redo:S,undo:I}=vs(s,R),v=[...(y=C.preRedos)!=null?y:[],...S],M=[...C.undos,...I];if(v.push(...C.redos),v.push(Ue(h,c,m)),M.push(...(b=C.preUndos)!=null?b:[]),i.sequenceExecute(v,t).result){const E=a.afterCommandExecute({id:Fe.id,params:{range:h}});return i.sequenceExecute(E.redos,t),M.push(...E.undos),v.push(...E.redos),n.pushUndoRedo({unitID:u,undoMutations:M.reverse(),redoMutations:v}),!0}return!1}},Ml="sheet.command.insert-range-move-down",Xe={type:i.CommandType.COMMAND,id:"sheet.command.insert-range-move-down",handler:async(s,e)=>{var W,V,$;const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),o=s.get(i.IUniverInstanceService),r=s.get(g.SheetsSelectionsService),a=s.get(g.SheetInterceptorService),l=s.get(i.ErrorService),u=s.get(i.LocaleService);if(r.isOverlapping())return l.emit(u.t("sheets.info.overlappingSelections")),!1;const d=P(o);if(!d)return!1;const{unitId:c,subUnitId:m,worksheet:h,workbook:R}=d;let C=e==null?void 0:e.range;if(C||(C=(W=r.getCurrentLastSelection())==null?void 0:W.range),!C)return!1;const S=[],I=[],v=h.getCellMatrix(),M=v.getDataRange(),w=v.getSlice(M.startRow,M.endRow,C.startColumn,C.endColumn).getDataRange().endRow,y=Math.max(w+(C.endRow-C.startRow+1)-M.endRow,0);if(y>0){const L=C.startRow-1,Y=h.getRowHeight(L),z={unitId:c,subUnitId:m,range:{startRow:M.endRow+1,endRow:M.endRow+y,startColumn:M.startColumn,endColumn:M.endColumn},rowInfo:new Array(y).fill(void 0).map(()=>({h:Y,hd:i.BooleanNumber.FALSE}))};S.push({id:re.id,params:z});const K=nn(s,z);I.push({id:ae.id,params:K})}const b={};i.Range.foreach(C,(L,Y)=>{const z=h.getCell(L,Y);z&&(b[L]||(b[L]={}),b[L][Y]={s:z.s})});const E={range:C,subUnitId:m,unitId:c,shiftDimension:i.Dimension.ROWS,cellValue:b},{redo:U,undo:k}=Is(s,E);S.push(...U),I.push(...k);const T=a.onCommandExecute({id:Xe.id,params:{range:C}});if(S.push(...T.redos),S.push(Ue(C,R,h)),I.push(...(V=T.preUndos)!=null?V:[]),S.unshift(...($=T.preRedos)!=null?$:[]),I.unshift(...T.undos),i.sequenceExecute(S,t)){const L=a.afterCommandExecute({id:Xe.id,params:{range:C}});return i.sequenceExecute(L.redos,t),I.push(...L.undos),S.push(...L.redos),n.pushUndoRedo({unitID:c,undoMutations:I.reverse(),redoMutations:S}),!0}return!1}},ps="sheet.command.insert-range-move-right",pt={type:i.CommandType.COMMAND,id:ps,handler:async(s,e)=>{var W,V,$;const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),o=s.get(i.IUniverInstanceService),r=s.get(g.SheetsSelectionsService),a=s.get(g.SheetInterceptorService),l=s.get(i.ErrorService),u=s.get(i.LocaleService);if(r.isOverlapping())return l.emit(u.t("sheets.info.overlappingSelections")),!1;const d=P(o);if(!d)return!1;const{workbook:c,worksheet:m,unitId:h,subUnitId:R}=d;let C=e==null?void 0:e.range;if(C||(C=(W=r.getCurrentLastSelection())==null?void 0:W.range),!C)return!1;const S=[],I=[],v=m.getCellMatrix(),M=v.getDataRange(),w=v.getSlice(C.startRow,C.endRow,M.startColumn,M.endColumn).getDataRange().endColumn,y=Math.max(w+(C.endColumn-C.startColumn+1)-M.endColumn,0);if(y>0){const L=C.startColumn-1,Y=m.getColumnWidth(L),z={unitId:h,subUnitId:R,range:{startRow:M.startRow+1,endRow:M.endRow,startColumn:M.endColumn+1,endColumn:M.endColumn+y},colInfo:new Array(y).fill(void 0).map(()=>({w:Y,hd:i.BooleanNumber.FALSE}))};S.push({id:ie.id,params:z});const K=Ot(s,z);I.push({id:ne.id,params:K})}const b={};i.Range.foreach(C,(L,Y)=>{const z=m.getCell(L,Y);!z||!z.s||(b[L]||(b[L]={}),b[L][Y]={s:z.s})});const E={range:C,subUnitId:R,unitId:h,shiftDimension:i.Dimension.COLUMNS,cellValue:b},{redo:U,undo:k}=Is(s,E);S.push(...U),I.push(...k);const T=a.onCommandExecute({id:pt.id,params:{range:C}});if(S.push(...T.redos),S.push(Ue(C,c,m)),I.push(...(V=T.preUndos)!=null?V:[]),S.unshift(...($=T.preRedos)!=null?$:[]),I.unshift(...T.undos),i.sequenceExecute(S,t).result){const L=a.afterCommandExecute({id:pt.id,params:{range:C}});return i.sequenceExecute(L.redos,t),I.push(...L.undos),S.push(...L.redos),n.pushUndoRedo({unitID:h,undoMutations:I.reverse(),redoMutations:S}),!0}return!1}},Xo="sheet.command.insert-row",Me={type:i.CommandType.COMMAND,id:Xo,handler:async(s,e)=>{const t=s.get(i.ICommandService),n=s.get(g.SheetInterceptorService),{range:o,direction:r,unitId:a,subUnitId:l,cellValue:u}=e;return await n.beforeCommandExecute({id:Me.id,params:e})?t.syncExecuteCommand(ws.id,{range:o,direction:r,unitId:a,subUnitId:l,cellValue:u}):!1}},ws={type:i.CommandType.COMMAND,id:"sheet.command.insert-row-by-range",handler:(s,e)=>{var U,k,T,N;const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),o=s.get(i.IUniverInstanceService),r=s.get(g.SheetInterceptorService),a=P(o,e);if(!a)return!1;const{workbook:l,worksheet:u}=a,{range:d,direction:c,unitId:m,subUnitId:h,cellValue:R}=e,{startRow:C,endRow:S}=d;d.rangeType=i.RANGE_TYPE.ROW;const I=c===i.Direction.UP?C:C-1,v=u.getRowHeight(I),M={unitId:m,subUnitId:h,range:d,rowInfo:new Array(S-C+1).fill(void 0).map(()=>({h:v,hd:i.BooleanNumber.FALSE}))},p=nn(s,M),w=[{id:re.id,params:M}],y=[{id:ae.id,params:p}];R&&Object.keys(R).length>0&&w.push({id:F.id,params:{unitId:m,subUnitId:h,cellValue:R}});const b=r.onCommandExecute({id:Me.id,params:e});if(w.unshift(...(U=b.preRedos)!=null?U:[]),w.push(...(k=b.redos)!=null?k:[]),w.push(Ue(d,l,u)),y.unshift(...(T=b.preUndos)!=null?T:[]),y.push(...(N=b.undos)!=null?N:[]),i.sequenceExecute(w,t).result){const W=r.afterCommandExecute({id:Me.id,params:e});return i.sequenceExecute(W.redos,t),w.push(...W.redos),y.push(...W.undos),n.pushUndoRedo({unitID:e.unitId,undoMutations:y,redoMutations:w}),!0}return!1}},Zo={type:i.CommandType.COMMAND,id:"sheet.command.insert-row-before",handler:async(s,e)=>{var I;const n=(I=s.get(g.SheetsSelectionsService).getCurrentSelections())==null?void 0:I.map(v=>v.range);let o;if((n==null?void 0:n.length)===1)o=n[0];else return!1;const r=s.get(i.IUniverInstanceService),a=P(r);if(!a)return!1;const{worksheet:l,subUnitId:u,unitId:d}=a,c=e.value||0,m=o.startRow,h=o.startRow+c-1,R=0,C=l.getColumnCount()-1,S={unitId:d,subUnitId:u,direction:i.Direction.UP,range:{startRow:m,endRow:h,startColumn:R,endColumn:C},cellValue:$e(l,m,h,R,C,!0,m-1)};return s.get(i.ICommandService).executeCommand(Me.id,S)}},Qo={type:i.CommandType.COMMAND,id:"sheet.command.insert-row-after",handler:async s=>{var S;const t=(S=s.get(g.SheetsSelectionsService).getCurrentSelections())==null?void 0:S.map(I=>I.range);let n;if((t==null?void 0:t.length)===1)n=t[0];else return!1;const o=s.get(i.IUniverInstanceService),r=P(o);if(!r)return!1;const{worksheet:a,unitId:l,subUnitId:u}=r,d=n.endRow-n.startRow+1,c=n.endRow+1,m=n.endRow+d,h=0,R=a.getColumnCount()-1,C={unitId:l,subUnitId:u,direction:i.Direction.DOWN,range:{startRow:c,endRow:m,startColumn:h,endColumn:R,rangeType:i.RANGE_TYPE.ROW},cellValue:$e(a,c,m,h,R,!0,n.endRow)};return s.get(i.ICommandService).executeCommand(Me.id,C)}},er={type:i.CommandType.COMMAND,id:"sheet.command.insert-multi-rows-above",handler:async(s,e)=>{var v;const n=(v=s.get(g.SheetsSelectionsService).getCurrentSelections())==null?void 0:v.map(M=>M.range);let o;if((n==null?void 0:n.length)===1)o=n[0];else return!1;const r=s.get(i.IUniverInstanceService),a=P(r);if(!a)return!1;const{worksheet:l,unitId:u,subUnitId:d}=a,c=e.value||0,m=o.startRow,h=o.startRow+c-1,R=0,C=l.getColumnCount()-1,S=$e(l,m,h,R,C,!0,m-1),I={unitId:u,subUnitId:d,direction:i.Direction.UP,range:{startRow:m,endRow:h,startColumn:R,endColumn:C,rangeType:i.RANGE_TYPE.ROW},cellValue:S};return s.get(i.ICommandService).executeCommand(Me.id,I)}},tr={type:i.CommandType.COMMAND,id:"sheet.command.insert-multi-rows-after",handler:async(s,e)=>{var I;const n=(I=s.get(g.SheetsSelectionsService).getCurrentSelections())==null?void 0:I.map(v=>v.range);let o;if((n==null?void 0:n.length)===1)o=n[0];else return!1;const r=s.get(i.IUniverInstanceService),a=P(r);if(!a)return!1;const{worksheet:l,unitId:u,subUnitId:d}=a,c=e.value||0,m=o.endRow+1,h=o.endRow+c,R=0,C=l.getColumnCount()-1,S={unitId:u,subUnitId:d,direction:i.Direction.DOWN,range:{startRow:m,endRow:h,startColumn:R,endColumn:C,rangeType:i.RANGE_TYPE.ROW},cellValue:$e(l,m,h,R,C,!0,o.endRow)};return s.get(i.ICommandService).executeCommand(Me.id,S)}},nr="sheet.command.insert-col",ye={type:i.CommandType.COMMAND,id:nr,handler:async(s,e)=>{const t=s.get(i.ICommandService),n=s.get(g.SheetInterceptorService),{range:o,direction:r,subUnitId:a,unitId:l,cellValue:u}=e;return await n.beforeCommandExecute({id:ye.id,params:e})?t.syncExecuteCommand(Ms.id,{range:o,direction:r,unitId:l,subUnitId:a,cellValue:u}):!1}},Ms={type:i.CommandType.COMMAND,id:"sheet.command.insert-col-by-range",handler:(s,e)=>{var E,U,k,T;const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),o=s.get(i.IUniverInstanceService),r=s.get(g.SheetInterceptorService),{range:a,direction:l,subUnitId:u,unitId:d,cellValue:c}=e,{startColumn:m,endColumn:h}=e.range;a.rangeType=i.RANGE_TYPE.COLUMN;const R=o.getUniverSheetInstance(e.unitId),C=R.getSheetBySheetId(e.subUnitId),S=l===i.Direction.LEFT?m:m-1,I=C.getColumnWidth(S),v={unitId:d,subUnitId:u,range:a,colInfo:new Array(h-m+1).fill(void 0).map(()=>({w:I,hd:i.BooleanNumber.FALSE}))},M=Ot(s,v),p=[{id:ie.id,params:v}],w=[{id:ne.id,params:M}];c&&p.push({id:F.id,params:{unitId:d,subUnitId:u,cellValue:c}});const y=r.onCommandExecute({id:ye.id,params:e});if(p.unshift(...(E=y.preRedos)!=null?E:[]),p.push(...(U=y.redos)!=null?U:[]),p.push(Ue(a,R,C)),w.unshift(...(k=y.preUndos)!=null?k:[]),w.push(...(T=y.undos)!=null?T:[]),i.sequenceExecute(p,t).result){const N=r.afterCommandExecute({id:ye.id,params:e});return i.sequenceExecute(N.redos,t),p.push(...N.redos),w.push(...N.undos),n.pushUndoRedo({unitID:e.unitId,undoMutations:w.filter(Boolean),redoMutations:p.filter(Boolean)}),!0}return!1}},sr={type:i.CommandType.COMMAND,id:"sheet.command.insert-col-before",handler:async(s,e)=>{const n=s.get(g.SheetsSelectionsService).getCurrentSelections();let o;if((n==null?void 0:n.length)===1)o=n[0].range;else return!1;const r=s.get(i.IUniverInstanceService),a=P(r);if(!a)return!1;const{worksheet:l,unitId:u,subUnitId:d}=a,c=e.value||0,m=o.startColumn,h=o.startColumn+c-1,R=0,C=l.getRowCount()-1,S={unitId:u,subUnitId:d,direction:i.Direction.LEFT,range:{startColumn:m,endColumn:h,startRow:R,endRow:C,rangeType:i.RANGE_TYPE.COLUMN},cellValue:$e(l,R,C,m,h,!1,m-1)};return s.get(i.ICommandService).executeCommand(ye.id,S)}},or={type:i.CommandType.COMMAND,id:"sheet.command.insert-col-after",handler:async s=>{const t=s.get(g.SheetsSelectionsService).getCurrentSelections();let n;if((t==null?void 0:t.length)===1)n=t[0].range;else return!1;const o=s.get(i.IUniverInstanceService),r=P(o);if(!r)return!1;const{worksheet:a,unitId:l,subUnitId:u}=r,d=n.endColumn-n.startColumn+1,c=n.endColumn+1,m=n.endColumn+d,h=0,R=a.getRowCount()-1,C={unitId:l,subUnitId:u,direction:i.Direction.RIGHT,range:{startColumn:c,endColumn:m,startRow:h,endRow:R},cellValue:$e(a,h,R,c,m,!1,n.endColumn)};return s.get(i.ICommandService).executeCommand(ye.id,C)}},rr={type:i.CommandType.COMMAND,id:"sheet.command.insert-multi-cols-before",handler:async(s,e)=>{const n=s.get(g.SheetsSelectionsService).getCurrentSelections();let o;if((n==null?void 0:n.length)===1)o=n[0].range;else return!1;const r=s.get(i.IUniverInstanceService),a=P(r);if(!a)return!1;const{worksheet:l,unitId:u,subUnitId:d}=a,c=e.value||0,m=o.startColumn,h=o.startColumn+c-1,R=0,C=l.getRowCount()-1,S={unitId:u,subUnitId:d,direction:i.Direction.LEFT,range:{startColumn:m,endColumn:h,startRow:R,endRow:C,rangeType:i.RANGE_TYPE.COLUMN},cellValue:$e(l,R,C,m,h,!1,m-1)};return s.get(i.ICommandService).executeCommand(ye.id,S)}},ir={type:i.CommandType.COMMAND,id:"sheet.command.insert-multi-cols-right",handler:async(s,e)=>{const n=s.get(g.SheetsSelectionsService).getCurrentSelections();let o;if((n==null?void 0:n.length)===1)o=n[0].range;else return!1;const r=s.get(i.IUniverInstanceService),a=P(r);if(!a)return!1;const{worksheet:l,unitId:u,subUnitId:d}=a,c=e.value||0,m=o.endColumn+1,h=o.endColumn+c,R=0,C=l.getRowCount()-1,S={unitId:u,subUnitId:d,direction:i.Direction.RIGHT,range:{startColumn:m,endColumn:h,startRow:R,endRow:C},cellValue:$e(l,R,C,m,h,!1,o.endColumn)};return s.get(i.ICommandService).executeCommand(ye.id,S)}},gn="sheet.command.remove-row",ys={type:i.CommandType.COMMAND,id:"sheet.command.remove-row-by-range",handler:(s,e)=>{var I,v,M;if(!e)return!1;const t=s.get(i.IUniverInstanceService),n=P(t,e);if(!n)return!1;const{workbook:o,worksheet:r}=n,a=s.get(g.SheetInterceptorService),{range:l,unitId:u,subUnitId:d}=e,c=At([l],s,u,d).reverse(),m=[],h=[];c.forEach(p=>{const w=[],y=[],b={unitId:u,subUnitId:d,range:p},E=ga(b,r),U=r.getCellMatrix().getSlice(p.startRow,p.endRow,0,r.getColumnCount()-1),k={unitId:u,subUnitId:d,cellValue:U.getMatrix()};y.push({id:ae.id,params:b}),w.push({id:re.id,params:E}),w.push({id:F.id,params:k}),h.push(...y),m.unshift(...w)});const R=a.onCommandExecute({id:gn,params:{range:l}}),C=s.get(i.ICommandService);if(i.sequenceExecute([...(I=R.preRedos)!=null?I:[],...h,...R.redos,Ue(l,o,r)],C).result){const p=a.afterCommandExecute({id:gn,params:{range:l}});return i.sequenceExecute(p.redos,C),s.get(i.IUndoRedoService).pushUndoRedo({unitID:u,undoMutations:[...(v=R.preUndos)!=null?v:[],...m,...R.undos,...p.undos],redoMutations:[...(M=R.preRedos)!=null?M:[],...h,...R.redos,...p.redos]}),!0}return!1}},Lt={type:i.CommandType.COMMAND,id:gn,handler:async(s,e)=>{var h;const t=s.get(g.SheetsSelectionsService),n=s.get(g.SheetInterceptorService),o=s.get(i.ICommandService);let r=e==null?void 0:e.range;if(r||(r=(h=t.getCurrentLastSelection())==null?void 0:h.range),!r)return!1;const a=s.get(i.IUniverInstanceService),l=P(a);if(!l)return!1;const{worksheet:u,subUnitId:d,unitId:c}=l;return r={...r,startColumn:0,endColumn:Math.max(u.getMaxColumns()-1,0)},await n.beforeCommandExecute({id:Lt.id,params:{range:r}})?o.syncExecuteCommand(ys.id,{range:r,unitId:c,subUnitId:d}):!1}},Rn="sheet.command.remove-col",_s={type:i.CommandType.COMMAND,id:"sheet.command.remove-col-by-range",handler:(s,e)=>{var v,M,p;if(!e)return!1;const t=s.get(i.IUniverInstanceService),n=P(t,e);if(!n)return!1;const{workbook:o,worksheet:r}=n,a=s.get(g.SheetInterceptorService),{range:l,unitId:u,subUnitId:d}=e,c={unitId:u,subUnitId:d,range:l},m=Ra(s,c),h=r.getCellMatrix().getSlice(0,r.getRowCount()-1,l.startColumn,l.endColumn),R={unitId:u,subUnitId:d,cellValue:h.getMatrix()},C=a.onCommandExecute({id:Rn,params:{range:l}}),S=s.get(i.ICommandService);if(i.sequenceExecute([...(v=C.preRedos)!=null?v:[],{id:ne.id,params:c},...C.redos,Ue(l,o,r)],S).result){const w=a.afterCommandExecute({id:Rn,params:{range:l}});return i.sequenceExecute(w.redos,S),s.get(i.IUndoRedoService).pushUndoRedo({unitID:u,undoMutations:[...(M=C.preUndos)!=null?M:[],{id:ie.id,params:m},{id:F.id,params:R},...C.undos,...w.undos],redoMutations:[...(p=C.preRedos)!=null?p:[],{id:ne.id,params:c},...C.redos,...w.redos]}),!0}return!1}},Bt={type:i.CommandType.COMMAND,id:Rn,handler:async(s,e)=>{var h;const t=s.get(g.SheetsSelectionsService),n=s.get(g.SheetInterceptorService),o=s.get(i.ICommandService);let r=e==null?void 0:e.range;if(r||(r=(h=t.getCurrentLastSelection())==null?void 0:h.range),!r)return!1;const a=s.get(i.IUniverInstanceService),l=P(a);if(!l)return!1;const{worksheet:u,subUnitId:d,unitId:c}=l;return r={...r,startRow:0,endRow:Math.max(u.getMaxRows()-1,0)},await n.beforeCommandExecute({id:Bt.id,params:{range:r}})?o.syncExecuteCommand(_s.id,{range:r,unitId:c,subUnitId:d}):!1}},ar=(s,e)=>{const t=s.get(i.IUniverInstanceService),{subUnitId:n,unitId:o}=e,r=ve(t,e);if(!r)throw new Error("[RemoveSheetUndoMutationFactory]: Worksheet is null error!");const{workbook:a,worksheet:l}=r,u=l.getConfig();return{index:a.getConfig().sheetOrder.findIndex(m=>m===n),sheet:u,unitId:o}},Ze={id:"sheet.mutation.remove-sheet",type:i.CommandType.MUTATION,handler:(s,e)=>{const t=s.get(i.IUniverInstanceService),{subUnitId:n,unitId:o}=e,r=t.getUniverSheetInstance(o);return r?r.removeSheet(n):!1}};function yl(s,e){return e.getMergeData().some(t=>t.startRow<s&&s<=t.endRow)}function _l(s,e){return e.getMergeData().some(t=>t.startColumn<s&&s<=t.endColumn)}const lr="sheet.command.move-rows",wt={id:lr,type:i.CommandType.COMMAND,handler:(s,e)=>{var W,V;const t=s.get(g.SheetsSelectionsService),{fromRange:{startRow:n},toRange:{startRow:o},range:r}=e,a=r?[dr(r)]:t.getCurrentSelections(),l=a==null?void 0:a.filter($=>$.range.rangeType===i.RANGE_TYPE.ROW&&$.range.startRow<=n&&n<=$.range.endRow);if((l==null?void 0:l.length)!==1)return!1;const u=s.get(g.SheetInterceptorService),d=s.get(i.IUniverInstanceService),c=P(d,e);if(!c)return!1;const{workbook:m,worksheet:h}=c,R=m.getUnitId(),C=h.getSheetId(),S=s.get(i.ErrorService),I=s.get(i.LocaleService),v=l[0].range,M=l[0].primary,p=Wt(v,h,!1);if(!i.Rectangle.equals(v,p))return S.emit(I.t("sheets.info.partOfCell")),!1;if(yl(o,h))return S.emit(I.t("sheets.info.acrossMergedCell")),!1;const w={...v,startRow:o,endRow:o+v.endRow-v.startRow},y={unitId:R,subUnitId:C,sourceRange:v,targetRange:w},b=co(s,y),E=s.get(i.ICommandService),U=u.onCommandExecute({id:wt.id,params:e}),k=[...(W=U.preRedos)!=null?W:[],{id:pe.id,params:y}],T=[...(V=U.preUndos)!=null?V:[],{id:pe.id,params:b}];if(M){const L=o-n<0,Y=v.endRow-v.startRow+1,z=L?w:{...w,startRow:w.startRow-Y,endRow:w.endRow-Y},K={unitId:R,subUnitId:C,type:te.MOVE_END,selections:[{range:z,primary:se(z,h),style:null}]},oe={unitId:R,subUnitId:C,type:te.MOVE_END,selections:[{range:v,primary:M,style:null}]};k.push({id:q.id,params:K}),T.push({id:q.id,params:oe})}if(k.push(...U.redos),T.push(...U.undos),i.sequenceExecute(k,E).result){const $=u.afterCommandExecute({id:wt.id,params:e});return i.sequenceExecute($.redos,E),k.push(...$.redos),T.push(...$.undos),s.get(i.IUndoRedoService).pushUndoRedo({unitID:R,undoMutations:T,redoMutations:k}),!0}return!1}},ur="sheet.command.move-cols",Mt={id:ur,type:i.CommandType.COMMAND,handler:(s,e)=>{var W,V;const t=s.get(g.SheetsSelectionsService),{fromRange:{startColumn:n},toRange:{startColumn:o},range:r}=e,a=r?[dr(r)]:t.getCurrentSelections(),l=a==null?void 0:a.filter($=>$.range.rangeType===i.RANGE_TYPE.COLUMN&&$.range.startColumn<=n&&n<=$.range.endColumn);if((l==null?void 0:l.length)!==1)return!1;const u=s.get(g.SheetInterceptorService),d=s.get(i.IUniverInstanceService),c=P(d,e);if(!c)return!1;const{workbook:m,worksheet:h}=c,R=m.getUnitId(),C=h.getSheetId(),S=s.get(i.ErrorService),I=s.get(i.LocaleService),v=l[0].range,M=l[0].primary,p=Wt(v,h,!1);if(!i.Rectangle.equals(v,p))return S.emit(I.t("sheets.info.partOfCell")),!1;if(_l(o,h))return S.emit(I.t("sheets.info.acrossMergedCell")),!1;const w={...v,startColumn:o,endColumn:o+v.endColumn-v.startColumn},y={unitId:R,subUnitId:C,sourceRange:v,targetRange:w},b=mo(s,y),E=s.get(i.ICommandService),U=u.onCommandExecute({id:Mt.id,params:e}),k=[...(W=U.preRedos)!=null?W:[],{id:we.id,params:y}],T=[...(V=U.preUndos)!=null?V:[],{id:we.id,params:b}];if(M){const $=v.endColumn-v.startColumn+1,z=o-n<0?w:{...w,startColumn:w.startColumn-$,endColumn:w.endColumn-$},K={unitId:R,subUnitId:C,type:te.MOVE_END,selections:[{range:z,primary:se(z,h),style:null}]},oe={unitId:R,subUnitId:C,type:te.MOVE_END,selections:[{range:v,primary:M,style:null}]};k.push({id:q.id,params:K}),T.push({id:q.id,params:oe})}if(k.push(...U.redos),T.push(...U.undos),i.sequenceExecute(k,E).result){const $=u.afterCommandExecute({id:Mt.id,params:e});return i.sequenceExecute($.redos,E),k.push(...$.redos),T.push(...$.undos),s.get(i.IUndoRedoService).pushUndoRedo({unitID:R,undoMutations:T,redoMutations:k}),!0}return!1}};function dr(s){return{range:s,primary:null,style:null}}var bl=Object.getOwnPropertyDescriptor,El=(s,e,t,n)=>{for(var o=n>1?void 0:n?bl(e,t):e,r=s.length-1,a;r>=0;r--)(a=s[r])&&(o=a(o)||o);return o},Tl=(s,e)=>(t,n)=>e(t,n,s);g.SheetSkeletonService=class extends i.Disposable{constructor(t){super();f(this,"_sheetSkeletonStore",new Map);this._injector=t,this.disposeWithMe(()=>{this._sheetSkeletonStore=new Map})}getSkeleton(t,n){if(this._sheetSkeletonStore.has(t))return this._sheetSkeletonStore.get(t).get(n)}setSkeleton(t,n,o){this._sheetSkeletonStore.has(t)||this._sheetSkeletonStore.set(t,new Map),this._sheetSkeletonStore.get(t).set(n,o)}deleteSkeleton(t,n){this._sheetSkeletonStore.has(t)&&this._sheetSkeletonStore.get(t).delete(n)}},g.SheetSkeletonService=El([Tl(0,i.Inject(i.Injector))],g.SheetSkeletonService);function bs(s,e){const t=new i.ObjectMatrix;return s.map(n=>i.Range.transformRange(n,e)).forEach(n=>{i.Range.foreach(n,(o,r)=>{const a=e.getCellHeight(o,r);a&&t.setValue(o,r,a)})}),t}const Ul=1e4;function Ht(s,e){if(!e)return{suitableRanges:s,remainingRanges:[]};const t=e.worksheet.getColumnCount(),n=Math.ceil(Ul/t),o=[],r=[],a=e.getOffsetRelativeToRowCol(0,e.scrollY).row,l=s.map(d=>{let c;return a>=d.startRow&&a<=d.endRow?c=0:a<d.startRow?c=d.startRow-a:c=a-d.endRow,{range:d,distance:c,rowCount:d.endRow-d.startRow+1}});l.sort((d,c)=>d.distance!==c.distance?d.distance-c.distance:d.rowCount-c.rowCount);let u=0;for(const d of l)if(u+d.rowCount<=n)o.push(d.range),u+=d.rowCount;else{const c=n-u;if(c>0){const m={...d.range,endRow:d.range.startRow+c-1},h={...d.range,startRow:d.range.startRow+c};o.push(m),r.push(h),u=n}else r.push(d.range)}return{suitableRanges:o,remainingRanges:r}}function cr(s){let e=0;return s.forEach(()=>{e++}),e}const mr="sheet.command.reorder-range",Cn={id:mr,type:i.CommandType.COMMAND,handler:(s,e)=>{var p,w;const{subUnitId:t,unitId:n,range:o,order:r}=e,a=s.get(i.ICommandService),l={id:Dt.id,params:{unitId:n,subUnitId:t,order:r,range:o}},u={id:Dt.id,params:ho(l.params)},d=s.get(g.SheetInterceptorService),c=d.onCommandExecute({id:Cn.id,params:e}),m=[...(p=c.preRedos)!=null?p:[],l,...c.redos],h=[...(w=c.preUndos)!=null?w:[],u,...c.undos],R=i.sequenceExecute(m,a),{suitableRanges:C,remainingRanges:S}=Ht([o],s.get(g.SheetSkeletonService).getSkeleton(n,t)),{undos:I,redos:v}=d.generateMutationsOfAutoHeight({unitId:n,subUnitId:t,ranges:[o],autoHeightRanges:C,lazyAutoHeightRanges:S}),M=d.afterCommandExecute({id:Cn.id,params:e});return R.result?(i.sequenceExecute([...M.redos,...v],a),s.get(i.IUndoRedoService).pushUndoRedo({unitID:n,undoMutations:[...h,...M.undos,...I],redoMutations:[...m,...M.redos,...v]}),!0):!1}},A={MoveRangeCommandId:Fo,InsertRowCommandId:Xo,InsertColCommandId:nr,RemoveColCommandId:Rn,RemoveRowCommandId:gn,DeleteRangeMoveLeftCommandId:Jo,DeleteRangeMoveUpCommandId:xo,InsertRangeMoveDownCommandId:Ml,InsertRangeMoveRightCommandId:ps,MoveColsCommandId:ur,MoveRowsCommandId:lr,ReorderRangeCommandId:mr};var B=(s=>(s[s.Set=0]="Set",s[s.Delete=1]="Delete",s[s.HorizontalMove=2]="HorizontalMove",s[s.VerticalMove=3]="VerticalMove",s[s.Unknown=4]="Unknown",s))(B||{});const Sn=Number.MAX_SAFE_INTEGER,ke=s=>{const e={...s},t=Number.isNaN(e.startRow)&&Number.isNaN(e.endRow)&&!Number.isNaN(e.startColumn)&&!Number.isNaN(e.endColumn),n=Number.isNaN(e.startColumn)&&Number.isNaN(e.endColumn)&&!Number.isNaN(e.startRow)&&!Number.isNaN(e.endRow);return(e.rangeType===i.RANGE_TYPE.COLUMN||t)&&(e.startRow=0,e.endRow=Sn),(e.rangeType===i.RANGE_TYPE.ROW||n)&&(e.startColumn=0,e.endColumn=Sn),e.rangeType===i.RANGE_TYPE.ALL&&(e.startColumn=0,e.endColumn=Sn,e.startRow=0,e.endRow=Sn),e},he=s=>{let e=s.rangeType;return s.rangeType===i.RANGE_TYPE.COLUMN?e=i.RANGE_TYPE.ROW:s.rangeType===i.RANGE_TYPE.ROW&&(e=i.RANGE_TYPE.COLUMN),{startRow:s.startColumn,endRow:s.endColumn,startColumn:s.startRow,endColumn:s.endRow,rangeType:e}},Ft=(s,e,t)=>{const n={...t},o={...e},r=(S,I)=>{const v=Math.max(S.start,I.start),M=Math.min(S.end,I.end);return M<v?null:{start:v,end:M}},a=S=>S.end-S.start+1,l=(S,I)=>({start:S.start-I.start,end:S.start-I.start+S.end-S.start}),u=(S,I)=>({start:I.start+S.start,end:I.start+S.start+S.end-S.start}),d=e.start>s.start;if(d){const S=Math.min(s.end,e.start)-s.start+1;o.start-=S,o.end-=S}const c=a(s),m=c,h=r(s,n),R=h&&a(h)>=a(n);if(s.end<n.start)n.start-=c,n.end-=c;else if(h){const S=a(h);if(R){const I=l(n,s),v=u(I,o);n.start=v.start,n.end=v.end}else h.start>s.start?d?(n.end-=S+c,n.start-=c):n.end-=S:d?n.end-=S:n.start>s.start&&n.end>s.end?(n.start-=c,n.end-=c+S):n.end-=S}const C=r(o,n);return R||(o.start<=n.start?(n.start+=m,n.end+=m):C&&(d?o.end<=n.start||o.start<=n.start&&o.end>=n.start?(n.start+=m,n.end+=m):o.start>=n.start&&o.start<=n.end&&(n.end+=m):n.start<o.start&&n.end>o.start?n.end+=m:(n.start>=o.end||n.start>=o.start&&n.start<=o.end)&&(n.end+=m,n.start+=m))),{step:n.start-t.start,length:a(n)-a(t)}},Es=(s,e)=>{const{fromRange:t,toRange:n}=s.params||{};if(!n||!t)return[];const o=ke(t),r=ke(n),a=ke(e),l=Ft({start:o.startRow,end:o.endRow},{start:r.startRow,end:r.endRow},{start:a.startRow,end:a.endRow});return l===null?[{type:B.Delete}]:[{type:B.VerticalMove,step:l.step||0,length:l.length||0}]},kl=(s,e)=>{const{fromRange:t,toRange:n}=s.params||{};if(!t||!n)return[e];const o=t.startRow,r=t.endRow-t.startRow+1,a=n.startRow,l=new i.ObjectMatrix;return i.Range.foreach(e,(d,c)=>{l.setValue(d,c,1)}),l.moveRows(o,r,a),i.queryObjectMatrix(l,d=>d===1)},Pl=(s,e)=>{const{range:t,order:n}=s.params||{};if(!t||!n)return[e];const o=new i.ObjectMatrix;i.Range.foreach(e,(l,u)=>{o.setValue(l,u,1)});const r=new i.ObjectMatrix;return i.Range.foreach(t,(l,u)=>{var d;if(Object.prototype.hasOwnProperty.call(n,l)){const c=n[l],m=(d=o.getValue(c,u))!=null?d:0;r.setValue(l,u,m)}}),r.forValue((l,u,d)=>{o.setValue(l,u,d)}),i.queryObjectMatrix(o,l=>l===1)},Ts=(s,e)=>{const{fromRange:t,toRange:n}=s.params||{};if(!n||!t)return[];const o=ke(t),r=ke(n),a=ke(e),l=Ft({start:o.startColumn,end:o.endColumn},{start:r.startColumn,end:r.endColumn},{start:a.startColumn,end:a.endColumn});return l===null?[{type:B.Delete}]:[{type:B.HorizontalMove,step:l.step||0,length:l.length||0}]},Nl=(s,e)=>{const{fromRange:t,toRange:n}=s.params||{};if(!t||!n)return[e];const o=t.startColumn,r=t.endColumn-t.startColumn+1,a=n.startColumn,l=new i.ObjectMatrix;return i.Range.foreach(e,(u,d)=>{l.setValue(u,d,1)}),l.moveColumns(o,r,a),i.queryObjectMatrix(l,u=>u===1)},hr=(s,e)=>{var r,a;const t=(r=s.params)==null?void 0:r.toRange,n=(a=s.params)==null?void 0:a.fromRange;if(!t||!n)return[];const o=[];if(i.Rectangle.contains(t,e)&&o.push({type:B.Delete}),i.Rectangle.contains(n,e)){o.push({type:B.Delete});const l=i.Rectangle.getRelativeRange(e,n),u=i.Rectangle.getPositionRange(l,t);return[{type:B.Set,range:u}]}return o},Ol=(s,e)=>{var m,h;const t=(m=s.params)==null?void 0:m.toRange,n=(h=s.params)==null?void 0:h.fromRange;if(!t||!n)return[e];if(!i.Rectangle.intersects(n,e)&&!i.Rectangle.intersects(t,e))return[e];if(i.Rectangle.contains(n,e)){const R=i.Rectangle.getRelativeRange(e,n);return[i.Rectangle.getPositionRange(R,t)]}const o=new i.ObjectMatrix;i.Range.foreach(e,(R,C)=>{o.setValue(R,C,1)});const r=new i.ObjectMatrix,a=i.Rectangle.getIntersects(n,e);a&&i.Range.foreach(a,(R,C)=>{o.getValue(R,C)&&(o.setValue(R,C,void 0),r.setValue(R,C,1))});const l=t.startColumn-n.startColumn,u=t.startRow-n.startRow,d={startColumn:t.startColumn-l,endColumn:t.endColumn-l,startRow:t.startRow-u,endRow:t.endRow-u};return d&&i.Range.foreach(d,(R,C)=>{var v;const S=R+u,I=C+l;o.setValue(S,I,(v=r.getValue(R,C))!=null?v:0)}),i.queryObjectMatrix(o,R=>R===1)},Qe=(s,e)=>{const t=ke(s),n=ke(e),o=a=>a.endColumn-a.startColumn+1,r=a=>a.endRow-a.startRow+1;if(t.startRow<=n.startRow&&t.endRow>=n.endRow){if(n.startColumn<t.startColumn&&n.endColumn>=t.startColumn&&n.endColumn<=t.endColumn||n.startColumn<t.startColumn&&n.endColumn>=t.endColumn){const a=i.Rectangle.getIntersects(n,t);if(a)return{step:0,length:-o(a)}}if(n.startColumn>=t.startColumn&&n.endColumn<=t.endColumn&&r(t)>=r(n))return null;if(n.startColumn>=t.startColumn&&n.startColumn<=t.endColumn&&n.endColumn>t.endColumn){const a=i.Rectangle.getIntersects(n,t);if(a){const l=-o(a);return{step:-(o(t)-o(a)),length:l}}}if(n.startColumn>t.endColumn)return{step:-o(t),length:0}}return{step:0,length:0}},Us=(s,e)=>{var r;const t=(r=s.params)==null?void 0:r.range;if(!t)return[];const n=[],o=Qe(t,e);if(!o)n.push({type:B.Delete});else{const{step:a,length:l}=o;n.push({type:B.HorizontalMove,step:a,length:l})}return n},gr=(s,e,t)=>{var a;const n=(a=s.params)==null?void 0:a.range;if(!n)return[];const o=[];if(t&&t.length>0){let l=n.startRow;for(let u=n.startRow;u<=n.endRow;u++){if(t.includes(u)){if(u===l){l=u+1;continue}r({...n,startRow:l,endRow:u-1}),l=u+1;continue}u===n.endRow&&r({...n,startRow:l,endRow:n.endRow})}}else r(n);function r(l){const u=Qe(he(l),he(e));if(!u)o.push({type:B.Delete});else{const{step:d,length:c}=u;o.push({type:B.VerticalMove,step:d,length:c})}}return o},Dl=(s,e)=>{const{range:t,order:n}=s.params||{};if(!t||!n)return[];if(i.Rectangle.contains(t,e)&&e.endRow===e.startRow){const o=[],r=e.startRow;for(const a in n)if(n[a]===r){const l=Number(a);return o.push({type:B.VerticalMove,step:l-r,length:0}),o}return[]}return[]},et=(s,e)=>{const t=ke(s),n=ke(e),o=r=>r.endColumn-r.startColumn+1;return t.startRow<=n.startRow&&t.endRow>=n.endRow?n.startColumn<t.startColumn&&n.endColumn>=t.startColumn&&n.endColumn<=t.endColumn||n.startColumn<t.startColumn&&n.endColumn>=t.endColumn?{step:0,length:o(t)}:n.startColumn>=t.startColumn&&n.endColumn<=t.endColumn||n.startColumn>=t.startColumn&&n.startColumn<=t.endColumn&&n.endColumn>t.endColumn||n.startColumn>=t.endColumn?{step:o(t),length:0}:{step:0,length:0}:{step:0,length:0}};function Al(s,e,t){const n=[];if(i.Rectangle.contains(e,t)&&n.push({type:B.Delete}),i.Rectangle.contains(s,t)){n.push({type:B.Delete});const o=i.Rectangle.getRelativeRange(t,s),r=i.Rectangle.getPositionRange(o,e);return[{type:B.Set,range:r}]}return n}const Rr=(s,e)=>{var l;const t=(l=s.params)==null?void 0:l.range;if(!t)return[];const n=[],o=et(he(t),he(e)),{step:r,length:a}=o;return n.push({type:B.VerticalMove,step:r,length:a}),n},Cr=(s,e)=>{var l;const t=(l=s.params)==null?void 0:l.range;if(!t)return[];const n=[],o=et(t,e),{step:r,length:a}=o;return n.push({type:B.HorizontalMove,step:r,length:a}),n},Sr=(s,e)=>{var l;const t=(l=s.params)==null?void 0:l.range;if(!t)return[];const n=[],o=et(he(t),he(e)),{step:r,length:a}=o;return n.push({type:B.VerticalMove,step:r,length:a}),n},Wl=(s,e)=>{var u;const t=(u=s.params)==null?void 0:u.range;if(!t)return[e];const n=t.endRow-t.startRow+1,o={...t,startRow:t.startRow,endRow:Number.POSITIVE_INFINITY},r=i.Rectangle.subtract(e,o),a=i.Rectangle.getIntersects(o,e);if(!a)return[e];const l=new i.ObjectMatrix;return r.forEach(d=>{i.Range.foreach(d,(c,m)=>{l.setValue(c,m,1)})}),a&&i.Range.foreach(a,(d,c)=>{l.setValue(d+n,c,1)}),i.queryObjectMatrix(l,d=>d===1)},fr=(s,e)=>{var l;const t=(l=s.params)==null?void 0:l.range;if(!t)return[];const n=[],o=et(t,e),{step:r,length:a}=o;return n.push({type:B.HorizontalMove,step:r,length:a}),n},Vl=(s,e)=>{var u;const t=(u=s.params)==null?void 0:u.range;if(!t)return[e];const n=t.endColumn-t.startColumn+1,o={...t,startColumn:t.startColumn,endColumn:Number.POSITIVE_INFINITY},r=i.Rectangle.subtract(e,o),a=i.Rectangle.getIntersects(o,e);if(!a)return[e];const l=new i.ObjectMatrix;return r.forEach(d=>{i.Range.foreach(d,(c,m)=>{l.setValue(c,m,1)})}),a&&i.Range.foreach(a,(d,c)=>{l.setValue(d,c+n,1)}),i.queryObjectMatrix(l,d=>d===1)},Ir=(s,e)=>{var r;const t=(r=s.params)==null?void 0:r.range;if(!t)return[];const n=[],o=Qe(t,e);if(!o)n.push({type:B.Delete});else{const{step:a,length:l}=o;n.push({type:B.HorizontalMove,step:a,length:l})}return n},$l=(s,e)=>{var d;const t=(d=s.params)==null?void 0:d.range;if(!t)return[e];const n={startRow:t.startRow,endRow:t.endRow,startColumn:t.startColumn,endColumn:Number.POSITIVE_INFINITY},o=t.endColumn-t.startColumn+1,r=i.Rectangle.getIntersects(t,e),a=i.Rectangle.subtract(e,n),l=i.Rectangle.getIntersects(n,e);if(!r&&!l)return[e];const u=new i.ObjectMatrix;return l&&i.Range.foreach(l,(c,m)=>{u.setValue(c,m-o,1)}),r&&i.Range.foreach(r,(c,m)=>{u.setValue(c,m-o,0)}),a.forEach(c=>{i.Range.foreach(c,(m,h)=>{u.setValue(m,h,1)})}),i.queryObjectMatrix(u,c=>c===1)},vr=(s,e)=>{var r;const t=(r=s.params)==null?void 0:r.range;if(!t)return[];const n=[],o=Qe(he(t),he(e));if(!o)n.push({type:B.Delete});else{const{step:a,length:l}=o;n.push({type:B.VerticalMove,step:a,length:l})}return n},Ll=(s,e)=>{var d;const t=(d=s.params)==null?void 0:d.range;if(!t)return[e];const n={...t,startRow:t.startRow,endRow:Number.POSITIVE_INFINITY},o=t.endRow-t.startRow+1,r=i.Rectangle.getIntersects(t,e),a=i.Rectangle.subtract(e,n),l=i.Rectangle.getIntersects(n,e);if(!r&&!l)return[e];const u=new i.ObjectMatrix;return l&&i.Range.foreach(l,(c,m)=>{u.setValue(c-o,m,1)}),r&&i.Range.foreach(r,(c,m)=>{u.setValue(c-o,m,0)}),a.forEach(c=>{i.Range.foreach(c,(m,h)=>{u.setValue(m,h,1)})}),i.queryObjectMatrix(u,c=>c===1)},Bl=(s,e)=>{var o;const t=(o=s.ranges)!=null?o:[s.range],n=new i.ObjectMatrix;return i.Range.foreach(e,(r,a)=>{n.setValue(r,a,1)}),t.forEach(r=>{const a=r.startRow,u=r.endRow-a+1;n.removeRows(a,u)}),i.queryObjectMatrix(n,r=>r===1)},Hl=(s,e)=>{const t=s.params,n=t.range.startRow,o=t.range.endRow-t.range.startRow+1;return e.startRow>=n?[{startRow:e.startRow+o,endRow:e.endRow+o,startColumn:e.startColumn,endColumn:e.endColumn}]:e.endRow<n?[e]:[{startRow:e.startRow,endRow:e.endRow+o,startColumn:e.startColumn,endColumn:e.endColumn}]},Fl=(s,e)=>{const t=s.params,n=t.range.startColumn,o=t.range.endColumn-t.range.startColumn+1;return e.startColumn>=n?[{startRow:e.startRow,endRow:e.endRow,startColumn:e.startColumn+o,endColumn:e.endColumn+o}]:e.endColumn<n?[e]:[{startRow:e.startRow,endRow:e.endRow,startColumn:e.startColumn,endColumn:e.endColumn+o}]},tt=(s,e)=>{let t={...e};return s.forEach(n=>{switch(n.type){case B.Delete:{t=null;break}case B.HorizontalMove:{if(!t)return;t.startColumn+=n.step,t.endColumn+=n.step+(n.length||0);break}case B.VerticalMove:{if(!t)return;t.startRow+=n.step,t.endRow+=n.step+(n.length||0);break}case B.Set:{t=n.range;break}}}),t&&(t.endColumn<t.startColumn||t.endRow<t.startRow)?null:t},ks=(s,e)=>{let t=[];switch(e.id){case A.DeleteRangeMoveLeftCommandId:{t=Ir(e,s);break}case A.DeleteRangeMoveUpCommandId:{t=vr(e,s);break}case A.InsertColCommandId:{t=Cr(e,s);break}case A.InsertRangeMoveDownCommandId:{t=Sr(e,s);break}case A.InsertRangeMoveRightCommandId:{t=fr(e,s);break}case A.InsertRowCommandId:{t=Rr(e,s);break}case A.MoveColsCommandId:{t=Ts(e,s);break}case A.MoveRangeCommandId:{t=hr(e,s);break}case A.MoveRowsCommandId:{t=Es(e,s);break}case A.RemoveColCommandId:{t=Us(e,s);break}case A.RemoveRowCommandId:{t=gr(e,s);break}case A.ReorderRangeCommandId:{t=Dl(e,s);break}}return tt(t,s)},jl=(s,e,t)=>[He.id,Fe.id].includes(e.id)||wr(e,t).some(r=>i.Rectangle.intersects(r,s))?ks(s,e):s,Ps=(s,e)=>{let t=[];switch(e.id){case A.DeleteRangeMoveLeftCommandId:return $l(e,s);case A.DeleteRangeMoveUpCommandId:return Ll(e,s);case A.InsertRangeMoveDownCommandId:return Wl(e,s);case A.InsertRangeMoveRightCommandId:return Vl(e,s);case A.InsertColCommandId:return Fl(e,s);case A.InsertRowCommandId:return Hl(e,s);case A.MoveColsCommandId:return Nl(e,s);case A.MoveRangeCommandId:return Ol(e,s);case A.MoveRowsCommandId:return kl(e,s);case A.ReorderRangeCommandId:return Pl(e,s);case A.RemoveColCommandId:{t=Us(e,s);break}case A.RemoveRowCommandId:return Bl(e.params,s)}const n=tt(t,s);return n?[n]:[]},Gl=(s,e,t)=>[He.id,Fe.id,Xe.id,ps].includes(e.id)||wr(e,t).some(r=>i.Rectangle.intersects(r,s))?Ps(s,e):s;function pr(s,e){const{id:t,params:n}=e;let o={length:0,step:0,type:B.Unknown};switch(t){case Ze.id:o.type=B.Delete;break;case pe.id:o=Ft({start:n.sourceRange.startRow,end:n.sourceRange.endRow},{start:n.targetRange.startRow,end:n.targetRange.endRow},{start:s.startRow,end:s.endRow}),o.type=B.VerticalMove;break;case we.id:o=Ft({start:n.sourceRange.startColumn,end:n.sourceRange.endColumn},{start:n.targetRange.startColumn,end:n.targetRange.endColumn},{start:s.startColumn,end:s.endColumn}),o.type=B.HorizontalMove;break;case ne.id:o=Qe(n.range,s),o?o.type=B.HorizontalMove:o={step:0,length:0,type:B.Delete};break;case ae.id:o=Qe(he(n.range),he(s)),o?o.type=B.VerticalMove:o={step:0,length:0,type:B.Delete};break;case re.id:o=et(he(n.range),he(s)),o.type=B.VerticalMove;break;case ie.id:o=et(n.range,s),o.type=B.HorizontalMove;break;case Le.id:{const r=n.fromRange||new i.ObjectMatrix(n.from).getRange(),a=n.toRange||new i.ObjectMatrix(n.to).getRange();o=Al(r,a,s)}break}return o?Array.isArray(o)?tt(o,s):tt([o],s):s}function wr(s,e){var n,o,r,a,l,u;const{selectionManagerService:t}=e;switch(s.id){case A.MoveColsCommandId:{const d=s.params;return[d.fromRange,{...d.toRange,startColumn:d.toRange.startColumn-.5,endColumn:d.toRange.endColumn-.5}]}case A.MoveRowsCommandId:{const d=s.params;return[d.fromRange,{...d.toRange,startRow:d.toRange.startRow-.5,endRow:d.toRange.startRow-.5}]}case A.MoveRangeCommandId:{const d=s;return[d.params.fromRange,d.params.toRange]}case A.InsertRowCommandId:{const c=s.params.range;return[{...c,startRow:c.startRow-.5,endRow:c.endRow-.5}]}case A.InsertColCommandId:{const c=s.params.range;return[{...c,startColumn:c.startColumn-.5,endColumn:c.endColumn-.5}]}case A.RemoveRowCommandId:return[s.params.range];case A.RemoveColCommandId:return[s.params.range];case A.DeleteRangeMoveUpCommandId:case A.InsertRangeMoveDownCommandId:{const c=((n=s.params)==null?void 0:n.range)||((r=(o=t.getCurrentSelections())==null?void 0:o.map(m=>m.range))==null?void 0:r[0]);return c?[c]:[]}case A.DeleteRangeMoveLeftCommandId:case A.InsertRangeMoveRightCommandId:{const c=((a=s.params)==null?void 0:a.range)||((u=(l=t.getCurrentSelections())==null?void 0:l.map(m=>m.range))==null?void 0:u[0]);return c?[c]:[]}case A.ReorderRangeCommandId:{const d=s,{range:c,order:m}=d.params,h=[];for(let R=c.startRow;R<=c.endRow;R++)R in m&&h.push({startRow:R,endRow:R,startColumn:c.startColumn,endColumn:c.endColumn});return h}}}function zl(s){switch(s.id){case we.id:{const e=s.params;return[e.sourceRange,{...e.targetRange,startColumn:e.targetRange.startColumn-.5,endColumn:e.targetRange.startColumn-.5}]}case pe.id:{const e=s.params;return[e.sourceRange,{...e.targetRange,startRow:e.targetRange.startRow-.5,endRow:e.targetRange.startRow-.5}]}case Le.id:{const e=s.params;return[new i.ObjectMatrix(e.from.value).getRange(),new i.ObjectMatrix(e.to.value).getRange()]}case ie.id:{const t=s.params.range;return[{...t,startColumn:t.startColumn-.5,endColumn:t.startColumn-.5}]}case re.id:{const t=s.params.range;return[{...t,startRow:t.startRow-.5,endRow:t.startRow-.5}]}case ne.id:return[s.params.range];case ae.id:return[s.params.range]}}function ql(s,e){var o,r,a,l,u,d;const t=s.get(i.IUniverInstanceService),n=s.get(g.SheetsSelectionsService);switch(e.id){case A.MoveColsCommandId:{const c=e.params,m=P(t,{unitId:c.unitId,subUnitId:c.subUnitId});return{unitId:m.unitId,subUnitId:m.subUnitId,ranges:[c.fromRange,{...c.toRange,startColumn:c.fromRange.startColumn<c.toRange.startColumn?c.fromRange.endColumn+1:c.toRange.startColumn,endColumn:c.fromRange.startColumn<c.toRange.startColumn?c.toRange.endColumn-1:c.fromRange.startColumn-1}]}}case A.MoveRowsCommandId:{const c=e.params,m=P(t,{unitId:c.unitId,subUnitId:c.subUnitId});return{unitId:m.unitId,subUnitId:m.subUnitId,ranges:[c.fromRange,{...c.toRange,startRow:c.fromRange.startRow<c.toRange.startRow?c.fromRange.endRow+1:c.toRange.startRow,endRow:c.fromRange.startRow<c.toRange.startRow?c.toRange.endRow-1:c.fromRange.startRow-1}]}}case A.MoveRangeCommandId:{const c=e.params,m=P(t);return{unitId:m.unitId,subUnitId:m.subUnitId,ranges:[c.fromRange,c.toRange]}}case A.InsertRowCommandId:{const c=e.params,m=c.range;return{unitId:c.unitId,subUnitId:c.subUnitId,ranges:[...m.startRow>0?[{...m,startRow:m.startRow-1,endRow:m.endRow-1}]:[],{...m,startRow:m.startRow,endRow:Number.MAX_SAFE_INTEGER}]}}case A.InsertColCommandId:{const c=e.params,m=c.range;return{unitId:c.unitId,subUnitId:c.subUnitId,ranges:[...m.startColumn>0?[{...m,startColumn:m.startColumn-1,endColumn:m.endColumn-1}]:[],{...m,startColumn:m.startColumn,endColumn:Number.MAX_SAFE_INTEGER}]}}case A.RemoveRowCommandId:{const m=e.params.range,h=P(t);return{unitId:h.unitId,subUnitId:h.subUnitId,ranges:[m,{...m,startRow:m.endRow+1,endRow:Number.MAX_SAFE_INTEGER}]}}case A.RemoveColCommandId:{const m=e.params.range,h=P(t);return{unitId:h.unitId,subUnitId:h.subUnitId,ranges:[m,{...m,startColumn:m.endColumn+1,endColumn:Number.MAX_SAFE_INTEGER}]}}case A.DeleteRangeMoveUpCommandId:case A.InsertRangeMoveDownCommandId:{const c=e,m=P(t),h=((o=c.params)==null?void 0:o.range)||((a=(r=n.getCurrentSelections())==null?void 0:r.map(R=>R.range))==null?void 0:a[0]);return h?{unitId:m.unitId,subUnitId:m.subUnitId,ranges:[h,{...h,startRow:h.endRow+1,endRow:Number.MAX_SAFE_INTEGER}]}:{unitId:m.unitId,subUnitId:m.subUnitId,ranges:[]}}case A.DeleteRangeMoveLeftCommandId:case A.InsertRangeMoveRightCommandId:{const m=((l=e.params)==null?void 0:l.range)||((d=(u=n.getCurrentSelections())==null?void 0:u.map(R=>R.range))==null?void 0:d[0]),h=P(t);return m?{unitId:h.unitId,subUnitId:h.subUnitId,ranges:[m,{...m,startColumn:m.endColumn+1,endColumn:Number.MAX_SAFE_INTEGER}]}:{unitId:h.unitId,subUnitId:h.subUnitId,ranges:[]}}case A.ReorderRangeCommandId:{const c=e,{range:m,order:h}=c.params,R=[];for(let S=m.startRow;S<=m.endRow;S++)S in h&&R.push({startRow:S,endRow:S,startColumn:m.startColumn,endColumn:m.endColumn});const C=P(t);return{unitId:C.unitId,subUnitId:C.subUnitId,ranges:R}}}}var Yl=Object.getOwnPropertyDescriptor,Kl=(s,e,t,n)=>{for(var o=n>1?void 0:n?Yl(e,t):e,r=s.length-1,a;r>=0;r--)(a=s[r])&&(o=a(o)||o);return o},fn=(s,e)=>(t,n)=>e(t,n,s);const Jl=i.createInterceptorKey("MERGE_REDO"),xl=i.createInterceptorKey("MERGE_UNDO"),Mr=Math.floor(Number.MAX_SAFE_INTEGER/10);class Xl extends i.Disposable{constructor(e,t,n,o,r=!1){super(),this._unitId=e,this._subUnitId=t,this._range=n,this._callback=o,this._skipIntersects=r}onMutation(e){var o,r;if(((o=e.params)==null?void 0:o.unitId)!==this._unitId)return;if(e.id===Le.id){const a=e.params;if(a.from.subUnitId!==this._subUnitId||a.to.subUnitId!==this._subUnitId)return}else if(((r=e.params)==null?void 0:r.subUnitId)!==this._subUnitId)return;if(!this._range)return;if(this._skipIntersects){if(e.id===Ze.id)return;const a=zl(e);if(a!=null&&a.some(l=>i.Rectangle.intersects(l,this._range)))return}const t=pr(this._range,e);if(t&&i.Rectangle.equals(t,this._range))return!1;const n=this._range;this._range=t,this._callback(n,t)}}g.RefRangeService=class extends i.Disposable{constructor(t,n,o,r){super();f(this,"interceptor",new i.InterceptorManager({MERGE_REDO:Jl,MERGE_UNDO:xl}));f(this,"_watchRanges",new Set);f(this,"_refRangeManagerMap",new Map);f(this,"_serializer",Zl());f(this,"_onRefRangeChange",()=>{this._sheetInterceptorService.interceptCommand({getMutations:t=>{const n=this._univerInstanceService.getCurrentUnitForType(i.UniverInstanceType.UNIVER_SHEET).getActiveSheet(),o=yr(this._univerInstanceService),r=_r(this._univerInstanceService);if(!n||!o||!r)return{redos:[],undos:[],preRedos:[],preUndos:[]};const u=((()=>{switch(t.id){case A.MoveColsCommandId:{const R=t.params,C=Math.min(R.fromRange.startColumn,R.toRange.startColumn);return this._checkRange([{...R.fromRange,startColumn:C,endColumn:n.getColumnCount()-1}],o,r)}case A.MoveRowsCommandId:{const R=t.params,C=Math.min(R.fromRange.startRow,R.toRange.startRow);return this._checkRange([{...R.fromRange,startRow:C,endRow:n.getRowCount()-1}],o,r)}case A.MoveRangeCommandId:{const R=t;return this._checkRange([R.params.fromRange,R.params.toRange],o,r)}case A.InsertRowCommandId:{const S={startRow:t.params.range.startRow,endRow:n.getRowCount()-1,startColumn:0,endColumn:n.getColumnCount()-1,rangeType:i.RANGE_TYPE.ROW};return this._checkRange([S],o,r)}case A.InsertColCommandId:{const C=t.params.range.startColumn,S={startRow:0,endRow:n.getRowCount()-1,startColumn:C,endColumn:n.getColumnCount()-1,rangeType:i.RANGE_TYPE.COLUMN};return this._checkRange([S],o,r)}case A.RemoveRowCommandId:{const S={startRow:t.params.range.startRow,endRow:n.getRowCount()-1,startColumn:0,endColumn:n.getColumnCount()-1,rangeType:i.RANGE_TYPE.ROW};return this._checkRange([S],o,r)}case A.RemoveColCommandId:{const C=t.params.range.startColumn,S={startRow:0,endRow:n.getRowCount()-1,startColumn:C,endColumn:n.getColumnCount()-1,rangeType:i.RANGE_TYPE.COLUMN};return this._checkRange([S],o,r)}case A.DeleteRangeMoveUpCommandId:case A.InsertRangeMoveDownCommandId:{const C=t.params.range||br(this._selectionManagerService)[0],S={startRow:C.startRow,startColumn:C.startColumn,endColumn:C.endColumn,endRow:Mr};return this._checkRange([S],o,r)}case A.DeleteRangeMoveLeftCommandId:case A.InsertRangeMoveRightCommandId:{const C=t.params.range||br(this._selectionManagerService)[0],S={startRow:C.startRow,startColumn:C.startColumn,endColumn:Mr,endRow:C.endRow};return this._checkRange([S],o,r)}case A.ReorderRangeCommandId:{const R=t,{range:C,order:S}=R.params,I=[];for(let v=C.startRow;v<=C.endRow;v++)v in S&&I.push({startRow:v,endRow:v,startColumn:C.startColumn,endColumn:C.endColumn});return this._checkRange(I,o,r)}}})()||[]).reduce((R,C)=>{const S=C(t);return R.push(S),R},[]).reduce((R,C)=>{var S,I;return R.redos.push(...C.redos),R.undos.push(...C.undos),R.preRedos.push(...(S=C.preRedos)!=null?S:[]),R.preUndos.push(...(I=C.preUndos)!=null?I:[]),R},{redos:[],undos:[],preUndos:[],preRedos:[]}),d=this.interceptor.fetchThroughInterceptors(this.interceptor.getInterceptPoints().MERGE_REDO)(u.preRedos,null)||[],c=this.interceptor.fetchThroughInterceptors(this.interceptor.getInterceptPoints().MERGE_REDO)(u.redos,null)||[],m=this.interceptor.fetchThroughInterceptors(this.interceptor.getInterceptPoints().MERGE_UNDO)(u.preUndos,null)||[],h=this.interceptor.fetchThroughInterceptors(this.interceptor.getInterceptPoints().MERGE_UNDO)(u.undos,null)||[];return{redos:c,undos:h,preRedos:d,preUndos:m}}})});f(this,"_checkRange",(t,n,o)=>{const r=Er(n,o),a=this._refRangeManagerMap.get(r);if(a){const l=new Set;return[...a.keys()].forEach(d=>{const c=a.get(d),m=this._serializer.deserialize(d),h={...m,startRow:+m.startRow,endRow:+m.endRow,startColumn:+m.startColumn,endColumn:+m.endColumn,rangeType:m.rangeType&&+m.rangeType};t.some(R=>i.Rectangle.intersects(R,h))&&c&&c.forEach(R=>{l.add(R)})}),[...l]}return[]});f(this,"registerRefRange",(t,n,o,r)=>{const a=o||yr(this._univerInstanceService),l=r||_r(this._univerInstanceService);if(!a||!l)return i.toDisposable(()=>{});const u=Er(a,l),d=this._serializer.serialize(t);let c=this._refRangeManagerMap.get(u);c||(c=new Map,this._refRangeManagerMap.set(u,c));const m=c.get(d);return m?m.add(n):c.set(d,new Set([n])),i.toDisposable(()=>{const h=c.get(d);h&&(h.delete(n),h.size||(c.delete(d),c.size||this._refRangeManagerMap.delete(u)))})});this._commandService=t,this._sheetInterceptorService=n,this._univerInstanceService=o,this._selectionManagerService=r,this._onRefRangeChange(),this.interceptor.intercept(this.interceptor.getInterceptPoints().MERGE_REDO,{priority:-1,handler:a=>a}),this.interceptor.intercept(this.interceptor.getInterceptPoints().MERGE_UNDO,{priority:-1,handler:a=>a})}watchRange(t,n,o,r,a){let l;this._watchRanges.size===0&&(l=this._commandService.onCommandExecuted(m=>{if(m.type!==i.CommandType.MUTATION)return!1;for(const h of this._watchRanges)h.onMutation(m)}));const u=new Xl(t,n,o,r,a);this._watchRanges.add(u);const d=i.toDisposable(()=>{this._watchRanges.delete(u),this._watchRanges.size===0&&(l==null||l.dispose(),l=null)}),c=this.disposeWithMe(d);return i.toDisposable(()=>{c.dispose(),d.dispose()})}},g.RefRangeService=Kl([fn(0,i.ICommandService),fn(1,i.Inject(g.SheetInterceptorService)),fn(2,i.Inject(i.IUniverInstanceService)),fn(3,i.Inject(g.SheetsSelectionsService))],g.RefRangeService);function yr(s){return s.getCurrentUnitForType(i.UniverInstanceType.UNIVER_SHEET).getUnitId()}function _r(s){var e;return(e=s.getCurrentUnitForType(i.UniverInstanceType.UNIVER_SHEET).getActiveSheet())==null?void 0:e.getSheetId()}function br(s){var e;return((e=s.getCurrentSelections())==null?void 0:e.map(t=>t.range))||[]}function Er(s,e){return`${s}_${e}`}function Zl(){const s=["startRow","startColumn","endRow","endColumn","rangeType"];return{deserialize:t=>{const n=s.reduce((r,a,l)=>(r[String(l)]=a,r),{});return t.split("_").reduce((r,a,l)=>{const u=String(l);return a&&n[u]&&(r[n[u]]=a),r},{})},serialize:t=>s.reduce((n,o,r)=>{const a=t[o];return a!==void 0?`${n}${r>0?"_":""}${a}`:`${n}`},"")}}var Ql=Object.getOwnPropertyDescriptor,eu=(s,e,t,n)=>{for(var o=n>1?void 0:n?Ql(e,t):e,r=s.length-1,a;r>=0;r--)(a=s[r])&&(o=a(o)||o);return o},yt=(s,e)=>(t,n)=>e(t,n,s);const tu=[ie.id,re.id,ne.id,ae.id],nu=[pe.id,we.id];function Ns(s,e){let t=s;if(e!==void 0){const n=[];for(let o=0;o<t.length;o++){const{startRow:r,endRow:a,startColumn:l,endColumn:u}=t[o];if(e===i.Dimension.ROWS)for(let d=r;d<=a;d++){const c={startRow:d,endRow:d,startColumn:l,endColumn:u};n.push(c)}else if(e===i.Dimension.COLUMNS)for(let d=l;d<=u;d++){const c={startRow:r,endRow:a,startColumn:d,endColumn:d};n.push(c)}}t=n}return t}const Tr=i.createInterceptorKey("mergeCellPermissionCheck");g.MergeCellController=class extends i.Disposable{constructor(t,n,o,r,a,l){super();f(this,"disposableCollection",new i.DisposableCollection);f(this,"interceptor",new i.InterceptorManager({MERGE_CELL_INTERCEPTOR_CHECK:Tr}));this._commandService=t,this._refRangeService=n,this._univerInstanceService=o,this._injector=r,this._sheetInterceptorService=a,this._selectionManagerService=l,this._onRefRangeChange(),this._initCommandInterceptor(),this._commandExecutedListener()}_initCommandInterceptor(){const t=this;this._sheetInterceptorService.interceptCommand({getMutations(n){var o;switch(n.id){case on.id:case rn.id:{const r=t._univerInstanceService.getCurrentUnitForType(i.UniverInstanceType.UNIVER_SHEET),a=r.getUnitId(),l=r==null?void 0:r.getActiveSheet();if(!l)return{redos:[],undos:[]};const u=l.getSheetId(),d=l.getConfig().mergeData,c=(o=t._selectionManagerService.getCurrentSelections())==null?void 0:o.map(m=>m.range);if(c&&c.length>0&&c.some(h=>d.some(R=>i.Rectangle.intersects(R,h)))){const h={unitId:a,subUnitId:u,ranges:c},R=le(t._injector,h),C=[{id:G.id,params:h}],S=[{id:j.id,params:R}];return{redos:C,undos:S}}}}return{redos:[],undos:[]}}}),this._sheetInterceptorService.interceptRanges({getMutations:({unitId:n,subUnitId:o,ranges:r})=>{const a=[],l=[],u={redos:a,undos:l};if(!r||!r.length)return u;const d=P(this._univerInstanceService,{unitId:n,subUnitId:o});if(!d)return u;const{worksheet:c}=d,h=c.getMergeData().filter(R=>r.some(C=>i.Rectangle.intersects(R,C)));return h.length?(a.push({id:G.id,params:{unitId:n,subUnitId:o,ranges:h}}),l.push({id:j.id,params:{unitId:n,subUnitId:o,ranges:h}}),{undos:l,redos:a}):u}})}refRangeHandle(t,n,o){switch(t.id){case A.MoveColsCommandId:{const r=t.params;return this._handleMoveColsCommand(r,n,o)}case A.MoveRowsCommandId:{const r=t.params;return this._handleMoveRowsCommand(r,n,o)}case Me.id:{const r=t.params,a=r.unitId||n,l=r.subUnitId||o;return this._handleInsertRowCommand(r,a,l)}case ye.id:{const r=t.params,a=r.unitId||n,l=r.subUnitId||o;return this._handleInsertColCommand(r,a,l)}case Bt.id:{const r=t.params;return this._handleRemoveColCommand(r,n,o)}case Lt.id:{const r=t.params;return this._handleRemoveRowCommand(r,n,o)}case xe.id:{const r=t.params;return this._handleMoveRangeCommand(r,n,o)}case pt.id:{const r=t.params;return this._handleInsertRangeMoveRightCommand(r,n,o)}case Xe.id:{const r=t.params;return this._handleInsertRangeMoveDownCommand(r,n,o)}case Fe.id:{const r=t.params;return this._handleDeleteRangeMoveUpCommand(r,n,o)}case He.id:{const r=t.params;return this._handleDeleteRangeMoveLeftCommand(r,n,o)}}return{redos:[],undos:[]}}_onRefRangeChange(){const t=(n,o)=>{const r=this._univerInstanceService.getUniverSheetInstance(n);if(!r)return;const a=r==null?void 0:r.getSheetBySheetId(o);if(!a)return;this.disposableCollection.dispose();const l=a.getMergeData(),u=d=>this.refRangeHandle(d,n,o);l.forEach(d=>{this.disposableCollection.add(this._refRangeService.registerRefRange(d,u,n,o))})};this.disposeWithMe(this._commandService.onCommandExecuted(n=>{if(n.id===St.id){const o=n.params,r=o.subUnitId,a=o.unitId;if(!r||!a)return;t(a,r)}if(n.id===j.id){const o=n.params,r=o.subUnitId,a=o.unitId;if(!r||!a)return;t(o.unitId,o.subUnitId)}})),this._univerInstanceService.getCurrentTypeOfUnit$(i.UniverInstanceType.UNIVER_SHEET).pipe(O.first(n=>!!n)).subscribe(n=>{const o=n.getActiveSheet();o&&t(n.getUnitId(),o.getSheetId())})}_handleMoveRowsCommand(t,n,o){const r=_e(this._univerInstanceService,n);if(!r)return this._handleNull();const a=be(r,o);if(!a)return this._handleNull();const l=[...a.getMergeData()],u={unitId:n,subUnitId:o,ranges:[]},d={unitId:n,subUnitId:o,ranges:[]},{fromRange:c}=t,{startRow:m,endRow:h}=c;if(l.forEach(S=>{if(m<=S.startRow&&h>=S.endRow){u.ranges.push(S);const I=Es({id:A.MoveRowsCommandId,params:t},S),v=tt(I,S);v&&d.ranges.push(v)}}),u.ranges.length===0)return this._handleNull();const R=le(this._injector,u),C=ge(this._injector,d);return{preRedos:[{id:G.id,params:u}],redos:[{id:j.id,params:d}],preUndos:[{id:G.id,params:C}],undos:[{id:j.id,params:R}]}}_handleMoveColsCommand(t,n,o){const r=_e(this._univerInstanceService,n);if(!r)return this._handleNull();const a=be(r,o);if(!a)return this._handleNull();const l=[...a.getMergeData()],u={unitId:n,subUnitId:o,ranges:[]},d={unitId:n,subUnitId:o,ranges:[]},{fromRange:c}=t,{startColumn:m,endColumn:h}=c;if(l.forEach(S=>{if(m<=S.startColumn&&h>=S.endColumn){u.ranges.push(S);const I=Ts({id:A.MoveColsCommandId,params:t},S),v=tt(I,S);v&&d.ranges.push(v)}}),u.ranges.length===0)return this._handleNull();const R=le(this._injector,u),C=ge(this._injector,d);return{preRedos:[{id:G.id,params:u}],redos:[{id:j.id,params:d}],preUndos:[{id:G.id,params:C}],undos:[{id:j.id,params:R}]}}_handleMoveRangeCommand(t,n,o){const r=_e(this._univerInstanceService,n);if(!r)return this._handleNull();const a=be(r,o);if(!a)return this._handleNull();const l=a.getMergeData(),u=l.filter(C=>i.Rectangle.intersects(C,t.fromRange)),d=l.filter(C=>i.Rectangle.intersects(C,t.toRange)),c=u.map(C=>i.Rectangle.getRelativeRange(C,t.fromRange)).map(C=>i.Rectangle.getPositionRange(C,t.toRange)),m=Ns(c).filter(C=>!l.some(S=>i.Rectangle.equals(C,S))),h=[{id:G.id,params:{unitId:n,subUnitId:o,ranges:u}},{id:G.id,params:{unitId:n,subUnitId:o,ranges:d}},{id:j.id,params:{unitId:n,subUnitId:o,ranges:m}}],R=[{id:G.id,params:{unitId:n,subUnitId:o,ranges:m}},{id:j.id,params:{unitId:n,subUnitId:o,ranges:d}},{id:j.id,params:{unitId:n,subUnitId:o,ranges:u}}];return{redos:h,undos:R}}_handleInsertRowCommand(t,n,o){const r=_e(this._univerInstanceService,n);if(!r)return this._handleNull();const a=be(r,o);if(!a)return this._handleNull();const{range:l}=t,{startRow:u,endRow:d}=l,c=i.Tools.deepClone(a.getMergeData()).reduce((M,p)=>(u>p.startRow&&u<=p.endRow&&M.push(p),M),[]);if(c.length===0)return this._handleNull();const m=i.Tools.deepClone(a.getMergeData()).reduce((M,p)=>{if(u>p.startRow&&u<=p.endRow){const w=d-u+1;p.endRow+=w,this._checkIsMergeCell(p)&&M.push(p)}return M},[]),h={unitId:n,subUnitId:o,ranges:c},R=le(this._injector,h),C={unitId:n,subUnitId:o,ranges:m},S=ge(this._injector,C),I=[{id:G.id,params:h},{id:j.id,params:C}],v=[{id:G.id,params:S},{id:j.id,params:R}];return{redos:I,undos:v}}_handleInsertColCommand(t,n,o){const{range:r}=t,a=_e(this._univerInstanceService,n);if(!a)return this._handleNull();const l=be(a,o);if(!l)return this._handleNull();const{startColumn:u,endColumn:d}=r,c=i.Tools.deepClone(l.getMergeData()).reduce((M,p)=>(u>p.startColumn&&u<=p.endColumn&&M.push(p),M),[]);if(c.length===0)return this._handleNull();const m=i.Tools.deepClone(l.getMergeData()).reduce((M,p)=>{if(u>p.startColumn&&u<=p.endColumn){const w=d-u+1;p.endColumn+=w,this._checkIsMergeCell(p)&&M.push(p)}return M},[]),h={unitId:n,subUnitId:o,ranges:c},R=le(this._injector,h),C={unitId:n,subUnitId:o,ranges:m},S=ge(this._injector,C),I=[{id:G.id,params:h},{id:j.id,params:C}],v=[{id:G.id,params:S},{id:j.id,params:R}];return{redos:I,undos:v}}_handleRemoveColCommand(t,n,o){const r=_e(this._univerInstanceService,n);if(!r)return this._handleNull();const a=be(r,o);if(!a)return this._handleNull();const{range:l}=t,{startColumn:u,endColumn:d}=l,c=i.Tools.deepClone(a.getMergeData()).reduce((w,y)=>(i.Rectangle.intersects(l,y)&&w.push(y),w),[]);if(c.length===0)return this._handleNull();const m=i.Tools.deepClone(a.getMergeData()).reduce((w,y)=>{if(i.Rectangle.intersects(l,y)){if(u<=y.startColumn&&d>=y.endColumn)return w;u>=y.startColumn&&d<=y.endColumn?y.endColumn-=d-u+1:u<y.startColumn?(y.startColumn=u,y.endColumn-=d-u+1):d>y.endColumn&&(y.endColumn=u-1),this._checkIsMergeCell(y)&&w.push(y)}return w},[]),h={unitId:n,subUnitId:o,ranges:c},R=le(this._injector,h),C={unitId:n,subUnitId:o,ranges:m},S=ge(this._injector,C),I=[{id:G.id,params:h}],v=[{id:j.id,params:C}],M=[{id:G.id,params:S}],p=[{id:j.id,params:R}];return{preUndos:M,undos:p,preRedos:I,redos:v}}_handleRemoveRowCommand(t,n,o){const{range:r}=t,a=_e(this._univerInstanceService,n);if(!a)return this._handleNull();const l=be(a,o);if(!l)return this._handleNull();const{startRow:u,endRow:d}=r,c=i.Tools.deepClone(l.getMergeData()).reduce((w,y)=>(i.Rectangle.intersects(r,y)&&w.push(y),w),[]);if(c.length===0)return this._handleNull();const m=i.Tools.deepClone(l.getMergeData()).reduce((w,y)=>{if(i.Rectangle.intersects(r,y)){if(u<=y.startRow&&d>=y.endRow)return w;u>=y.startRow&&d<=y.endRow?y.endRow-=d-u+1:u<y.startRow?(y.startRow=u,y.endRow-=d-u+1):d>y.endRow&&(y.endRow=u-1),this._checkIsMergeCell(y)&&w.push(y)}return w},[]),h={unitId:n,subUnitId:o,ranges:c},R=le(this._injector,h),C={unitId:n,subUnitId:o,ranges:m},S=ge(this._injector,C),I=[{id:G.id,params:h}],v=[{id:j.id,params:C}],M=[{id:G.id,params:S}],p=[{id:j.id,params:R}];return{preUndos:M,undos:p,preRedos:I,redos:v}}_handleInsertRangeMoveRightCommand(t,n,o){const r=_e(this._univerInstanceService,n);if(!r)return this._handleNull();const a=be(r,o);if(!a)return this._handleNull();const l=t.range,u=a.getMaxColumns()-1,d=a.getMergeData(),c=[],m=[];d.forEach(I=>{const{startRow:v,endRow:M,startColumn:p,endColumn:w}=l;if(i.Rectangle.intersects({startRow:v,startColumn:p,endRow:M,endColumn:u},I)&&(c.push(I),i.Rectangle.contains({startRow:v,startColumn:p,endRow:M,endColumn:u},I))){const E=w-p+1;m.push({startRow:I.startRow,startColumn:I.startColumn+E,endRow:I.endRow,endColumn:I.endColumn+E})}});const h={unitId:n,subUnitId:o,ranges:c},R=le(this._injector,h),C={unitId:n,subUnitId:o,ranges:m},S=ge(this._injector,C);return{preRedos:[{id:G.id,params:h}],redos:[{id:j.id,params:C}],preUndos:[{id:G.id,params:S}],undos:[{id:j.id,params:R}]}}_handleInsertRangeMoveDownCommand(t,n,o){const r=_e(this._univerInstanceService,n);if(!r)return this._handleNull();const a=be(r,o);if(!a)return this._handleNull();const l=t.range,u=a.getMaxRows()-1,d=a.getMergeData(),c=[],m=[];d.forEach(w=>{const{startRow:y,startColumn:b,endColumn:E,endRow:U}=l;if(i.Rectangle.intersects({startRow:y,startColumn:b,endRow:u,endColumn:E},w)&&(c.push(w),i.Rectangle.contains({startRow:y,startColumn:b,endRow:u,endColumn:E},w))){const N=U-y+1;m.push({startRow:w.startRow+N,startColumn:w.startColumn,endRow:w.endRow+N,endColumn:w.endColumn})}});const h={unitId:n,subUnitId:o,ranges:c},R=le(this._injector,h),C={unitId:n,subUnitId:o,ranges:m},S=ge(this._injector,C),I=[{id:G.id,params:h}],v=[{id:j.id,params:C}],M=[{id:G.id,params:S}],p=[{id:j.id,params:R}];return{redos:v,undos:p,preRedos:I,preUndos:M}}_handleDeleteRangeMoveUpCommand(t,n,o){const r=_e(this._univerInstanceService,n);if(!r)return this._handleNull();const a=be(r,o);if(!a)return this._handleNull();const l=t.range,u=a.getMaxRows()-1,d=a.getMergeData(),c=[],m=[];d.forEach(w=>{const{startRow:y,startColumn:b,endColumn:E,endRow:U}=l;if(i.Rectangle.intersects({startRow:y,startColumn:b,endRow:u,endColumn:E},w)&&(c.push(w),i.Rectangle.contains({startRow:y,startColumn:b,endRow:u,endColumn:E},w))){const N=U-y+1,W=i.Rectangle.moveVertical(w,-N);m.push(W)}});const h={unitId:n,subUnitId:o,ranges:c},R=le(this._injector,h),C={unitId:n,subUnitId:o,ranges:m},S=ge(this._injector,C),I=[{id:G.id,params:h}],v=[{id:j.id,params:C}],M=[{id:G.id,params:S}],p=[{id:j.id,params:R}];return{redos:v,undos:p,preRedos:I,preUndos:M}}_handleDeleteRangeMoveLeftCommand(t,n,o){const r=_e(this._univerInstanceService,n);if(!r)return this._handleNull();const a=be(r,o);if(!a)return this._handleNull();const l=t.range,u=a.getMaxColumns()-1,d=a.getMergeData(),c=[],m=[];d.forEach(I=>{const{startRow:v,endRow:M,startColumn:p,endColumn:w}=l;if(i.Rectangle.intersects({startRow:v,startColumn:p,endRow:M,endColumn:u},I)&&(c.push(I),i.Rectangle.contains({startRow:v,startColumn:p,endRow:M,endColumn:u},I))){const E=w-p+1;m.push({startRow:I.startRow,startColumn:I.startColumn-E,endRow:I.endRow,endColumn:I.endColumn-E})}});const h={unitId:n,subUnitId:o,ranges:c},R=le(this._injector,h),C={unitId:n,subUnitId:o,ranges:m},S=ge(this._injector,C);return{preRedos:[{id:G.id,params:h}],redos:[{id:j.id,params:C}],undos:[{id:j.id,params:R}],preUndos:[{id:G.id,params:S}]}}_checkIsMergeCell(t){return!(t.startRow===t.endRow&&t.startColumn===t.endColumn)}_handleNull(){return{redos:[],undos:[]}}_commandExecutedListener(){this.disposeWithMe(this._commandService.onCommandExecuted(t=>{if(nu.includes(t.id)){if(!t.params)return;const n=this._univerInstanceService.getUniverSheetInstance(t.params.unitId);if(!n)return;const o=n.getSheetBySheetId(t.params.subUnitId);if(!o)return;const{sourceRange:r,targetRange:a}=t.params,l=r.startColumn===a.startColumn&&r.endColumn===a.endColumn,u=l?r.endRow-r.startRow+1:r.endColumn-r.startColumn+1,d=l?r.startRow:r.startColumn,c=l?a.startRow:a.startColumn,m=o.getConfig().mergeData,h=[];m.forEach(I=>{let{startRow:v,endRow:M,startColumn:p,endColumn:w,rangeType:y}=I;i.Rectangle.intersects(I,r)||(l?d<v&&c>M?(v-=u,M-=u):d>M&&c<=v&&(v+=u,M+=u):d<p&&c>w?(p-=u,w-=u):d>w&&c<=p&&(p+=u,w+=u)),I.startRow===I.endRow&&I.startColumn===I.endColumn||h.push({startRow:v,endRow:M,startColumn:p,endColumn:w,rangeType:y})}),o.setMergeData(h),this.disposableCollection.dispose();const{unitId:R,subUnitId:C}=t.params,S=I=>this.refRangeHandle(I,R,C);h.forEach(I=>{this.disposableCollection.add(this._refRangeService.registerRefRange(I,S,R,C))})}if(tu.includes(t.id)){const n=this._univerInstanceService.getUniverSheetInstance(t.params.unitId);if(!n)return;const o=n.getSheetBySheetId(t.params.subUnitId);if(!o)return;const r=o.getConfig().mergeData,a=t.params;if(!a)return;const{range:l}=a,u=t.id.includes("row"),d=t.id.includes("insert"),c=u?l.startRow:l.startColumn,m=u?l.endRow:l.endColumn,h=m-c+1,R=[];r.forEach(v=>{let{startRow:M,endRow:p,startColumn:w,endColumn:y,rangeType:b}=v;d?u?c<=M&&(M+=h,p+=h):c<=w&&(w+=h,y+=h):u?m<M&&(M-=h,p-=h):m<w&&(w-=h,y-=h),v.startRow===v.endRow&&v.startColumn===v.endColumn||R.push({startRow:M,endRow:p,startColumn:w,endColumn:y,rangeType:b})}),o.setMergeData(R),this.disposableCollection.dispose();const{unitId:C,subUnitId:S}=t.params,I=v=>this.refRangeHandle(v,C,S);R.forEach(v=>{this.disposableCollection.add(this._refRangeService.registerRefRange(v,I,C,S))})}}))}},g.MergeCellController=eu([yt(0,i.Inject(i.ICommandService)),yt(1,i.Inject(g.RefRangeService)),yt(2,i.Inject(i.IUniverInstanceService)),yt(3,i.Inject(i.Injector)),yt(4,i.Inject(g.SheetInterceptorService)),yt(5,i.Inject(g.SheetsSelectionsService))],g.MergeCellController);function _e(s,e){return e?s.getUniverSheetInstance(e):s.getCurrentUnitForType(i.UniverInstanceType.UNIVER_SHEET)}function be(s,e){return e?s.getSheetBySheetId(e):s.getActiveSheet()}function su(s,e){return e.some(t=>ou(s,t))}function ou(s,e){const{startRow:t,startColumn:n,endColumn:o,endRow:r}=e,a=s.getMatrixWithMergedCells(t,n,r,o);let l=!1;return a.forValue((u,d,c)=>{if(c&&(u!==t||d!==n)&&s.cellHasValue(c))return l=!0,!1}),l}function ru(s,e,t,n){const o=[],r=[],a=t.getSheetId();return n.forEach(l=>{const u=iu(t,l),d={unitId:e,subUnitId:a,cellValue:u.getData()},c=ce(s,d);o.push({id:F.id,params:c}),r.push({id:F.id,params:d})}),{undos:o,redos:r}}function iu(s,e){const{startRow:t,startColumn:n,endColumn:o,endRow:r}=e,a=s.getMatrixWithMergedCells(t,n,r,o,i.CellModeEnum.Raw),l=new i.ObjectMatrix;return a.forValue((u,d,c)=>{c&&(u!==t||d!==n)&&l.setValue(u,d,null)}),l}const jt={type:i.CommandType.COMMAND,id:"sheet.command.add-worksheet-merge",handler:(s,e)=>{const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),o=s.get(i.IUniverInstanceService),r=e.unitId,a=e.subUnitId,l=e.selections,u=Ns(l,e.value),d=o.getUniverSheetInstance(r).getSheetBySheetId(a),c=[],m=[],h=su(d,u),R={unitId:r,subUnitId:a,ranges:u},C={unitId:r,subUnitId:a,ranges:u};c.push({id:G.id,params:R}),c.push({id:j.id,params:C});const S=le(s,R),I=ge(s,C);if(m.push({id:G.id,params:I}),m.push({id:j.id,params:S}),h){const M=ru(s,r,d,u);c.unshift(...M.redos),m.push(...M.undos)}return i.sequenceExecute(c,t).result?(n.pushUndoRedo({unitID:r,undoMutations:m,redoMutations:c}),!0):!1}},au={type:i.CommandType.COMMAND,id:"sheet.command.add-worksheet-merge-all",handler:async s=>{var d;const e=s.get(i.ICommandService),n=(d=s.get(g.SheetsSelectionsService).getCurrentSelections())==null?void 0:d.map(c=>c.range);if(!(n!=null&&n.length))return!1;const r=s.get(i.IUniverInstanceService).getCurrentUnitForType(i.UniverInstanceType.UNIVER_SHEET);if(!r)return!1;const a=r.getActiveSheet();if(!a)return!1;const l=r.getUnitId(),u=a.getSheetId();return e.executeCommand(jt.id,{selections:n,unitId:l,subUnitId:u})}},lu={type:i.CommandType.COMMAND,id:"sheet.command.add-worksheet-merge-vertical",handler:async s=>{var d;const e=s.get(i.ICommandService),n=(d=s.get(g.SheetsSelectionsService).getCurrentSelections())==null?void 0:d.map(c=>c.range);if(!(n!=null&&n.length))return!1;const r=s.get(i.IUniverInstanceService).getCurrentUnitForType(i.UniverInstanceType.UNIVER_SHEET);if(!r)return!1;const a=r.getActiveSheet();if(!a)return!1;const l=r.getUnitId(),u=a.getSheetId();return e.executeCommand(jt.id,{value:i.Dimension.COLUMNS,selections:n,unitId:l,subUnitId:u})}},uu={type:i.CommandType.COMMAND,id:"sheet.command.add-worksheet-merge-horizontal",handler:async s=>{var d;const e=s.get(i.ICommandService),n=(d=s.get(g.SheetsSelectionsService).getCurrentSelections())==null?void 0:d.map(c=>c.range);if(!(n!=null&&n.length))return!1;const r=s.get(i.IUniverInstanceService).getCurrentUnitForType(i.UniverInstanceType.UNIVER_SHEET);if(!r)return!1;const a=r.getActiveSheet();if(!a)return!1;const l=r.getUnitId(),u=a.getSheetId();return e.executeCommand(jt.id,{value:i.Dimension.ROWS,selections:n,unitId:l,subUnitId:u})}};function du(s,e,t,n,o){const r=s.get(i.IUniverInstanceService),a=P(r,{unitId:e,subUnitId:t});if(!a)return;const{worksheet:l}=a;if(l.getMergeData().some(m=>n.some(h=>i.Rectangle.intersects(h,m))))throw new Error("The ranges to be merged overlap with the existing merged cells");s.get(i.ICommandService).executeCommand(jt.id,{unitId:e,subUnitId:t,selections:n,defaultMerge:o})}class Pe{constructor(){f(this,"_model",new Map);f(this,"_ruleChange",new O.Subject);f(this,"_ruleRefresh",new O.Subject);f(this,"_resetOrder",new O.Subject);f(this,"ruleChange$",this._ruleChange.asObservable());f(this,"ruleRefresh$",this._ruleRefresh.asObservable());f(this,"resetOrder$",this._resetOrder.asObservable());f(this,"_worksheetRuleInitStateChange",new O.BehaviorSubject(!1));f(this,"worksheetRuleInitStateChange$",this._worksheetRuleInitStateChange.asObservable())}changeRuleInitState(e){this._worksheetRuleInitStateChange.next(e)}getSheetRuleInitState(){return this._worksheetRuleInitStateChange.value}addRule(e,t){this._ensureSubUnitMap(e).set(t.subUnitId,t),this._ruleChange.next({unitId:e,rule:t,type:"add",subUnitId:t.subUnitId})}deleteRule(e,t){var o,r,a;const n=(r=(o=this._model)==null?void 0:o.get(e))==null?void 0:r.get(t);n&&((a=this._model.get(e))==null||a.delete(t),this._ruleChange.next({unitId:e,rule:n,type:"delete",subUnitId:t}))}setRule(e,t,n){var r,a;const o=this.getRule(e,t);o&&((a=(r=this._model)==null?void 0:r.get(e))==null||a.set(t,n),this._ruleChange.next({unitId:e,oldRule:o,rule:n,type:"set",subUnitId:t}))}getRule(e,t){var n,o;return(o=(n=this._model)==null?void 0:n.get(e))==null?void 0:o.get(t)}toObject(){const e={};return[...this._model.keys()].forEach(n=>{const o=this._model.get(n);o!=null&&o.size&&(e[n]=[],[...o.keys()].forEach(a=>{const l=o.get(a);l&&e[n].push(l)}))}),e}fromObject(e){const t=new Map;Object.keys(e).forEach(n=>{const o=e[n];if(o!=null&&o.length){const r=new Map;o.forEach(a=>{r.set(a.subUnitId,a)}),t.set(n,r)}}),this._model=t}deleteUnitModel(e){this._model.delete(e)}_ensureSubUnitMap(e){let t=this._model.get(e);return t||(t=new Map,this._model.set(e,t)),t}ruleRefresh(e){this._ruleRefresh.next(e)}resetOrder(){this._resetOrder.next(Math.random())}getTargetByPermissionId(e,t){const n=this._model.get(e);if(!n)return null;for(const[o,r]of n)if(r.permissionId===t)return[e,o]}}const je={id:"sheet.mutation.add-worksheet-protection",type:i.CommandType.MUTATION,handler:(s,e)=>{const t=s.get(Pe),{unitId:n,rule:o}=e;return t.addRule(n,o),!0}},nt={id:"sheet.mutation.delete-worksheet-protection",type:i.CommandType.MUTATION,handler:(s,e)=>{const t=s.get(Pe),{unitId:n,subUnitId:o}=e;return t.deleteRule(n,o),!0}},Ur={type:i.CommandType.COMMAND,id:"sheet.command.add-worksheet-protection",async handler(s,e){if(!e)return!1;const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),{rule:o,unitId:r}=e,a=o.subUnitId;if(await t.executeCommand(je.id,{unitId:r,rule:o,subUnitId:o.subUnitId})){const u=[{id:je.id,params:{unitId:r,rule:o,subUnitId:o.subUnitId}}],d=[{id:nt.id,params:{unitId:r,subUnitId:a}}];n.pushUndoRedo({unitID:r,redoMutations:u,undoMutations:d})}return!0}},kr={type:i.CommandType.COMMAND,id:"sheet.command.set-worksheet-range-theme-style",handler:(s,e)=>{const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),{unitId:o}=e,r=lo(s,e);return t.syncExecuteCommand(it.id,e)?(n.pushUndoRedo({unitID:o,undoMutations:[{id:at.id,params:r}],redoMutations:[{id:it.id,params:e}]}),!0):!1}},Pr={type:i.CommandType.COMMAND,id:"sheet.command.append-row",handler:(s,e)=>{const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),{unitId:o,subUnitId:r,cellValue:a,insertRowNums:l,insertColumnNums:u,maxRows:d,maxColumns:c}=e,m={unitId:o,subUnitId:r,cellValue:a},h=ce(s,m),R=[{id:F.id,params:m}],C=[{id:F.id,params:h}];if(l){const I={unitId:o,subUnitId:r,range:{startRow:d,endRow:d,startColumn:0,endColumn:c-1}},v=nn(s,I);R.unshift({id:re.id,params:I}),C.push({id:ae.id,params:v})}if(u){const I={unitId:o,subUnitId:r,range:{startRow:0,endRow:d-1,startColumn:c,endColumn:c-1+u}},v=Ot(s,I);R.unshift({id:ie.id,params:I}),C.push({id:ne.id,params:v})}return i.sequenceExecute(R,t).result?(n.pushUndoRedo({unitID:o,undoMutations:C,redoMutations:R}),!0):!1}},In={id:"sheet.command.clear-selection-content",type:i.CommandType.COMMAND,handler:(s,e)=>{var p;const t=s.get(i.IUniverInstanceService),n=s.get(i.ICommandService),o=s.get(g.SheetsSelectionsService),r=s.get(i.IUndoRedoService),a=s.get(g.SheetInterceptorService),l=t.getCurrentUnitForType(i.UniverInstanceType.UNIVER_SHEET);if(!l)return!1;const u=(e==null?void 0:e.unitId)||l.getUnitId(),d=l.getActiveSheet();if(!d)return!1;const c=(e==null?void 0:e.subUnitId)||d.getSheetId(),m=(e==null?void 0:e.ranges)||((p=o.getCurrentSelections())==null?void 0:p.map(w=>w.range));if(!(m!=null&&m.length))return!1;const h=At(m,s,u,c),R={subUnitId:c,unitId:u,cellValue:Po(h)},C=ce(s,R),S=a.onCommandExecute({id:In.id}),I=[{id:F.id,params:R},...S.redos],v=[...S.undos,{id:F.id,params:C}];return i.sequenceExecute(I,n).result?(r.pushUndoRedo({unitID:u,undoMutations:v,redoMutations:I}),!0):!1}},Gt="sheets.config",Os={largeSheetCellCountThreshold:6e3,batchSize:3e3},Nr={};var cu=Object.getOwnPropertyDescriptor,mu=(s,e,t,n)=>{for(var o=n>1?void 0:n?cu(e,t):e,r=s.length-1,a;r>=0;r--)(a=s[r])&&(o=a(o)||o);return o},Or=(s,e)=>(t,n)=>e(t,n,s);g.SheetLazyExecuteScheduleService=class extends i.Disposable{constructor(t,n){super();f(this,"_tasks",new Map);f(this,"_idleCallbackId",null);f(this,"_beforeUnloadHandler",null);this._commandService=t,this._univerInstanceService=n,this._setupBeforeUnloadListener(),this.disposeWithMe(()=>{this._cancelAllTasks(),this._removeBeforeUnloadListener()})}hasPendingTasks(){return this._tasks.size>0}getPendingMutationsCount(){let t=0;for(const n of this._tasks.values())t+=n.mutations.length-n.currentIndex;return t}scheduleMutations(t,n,o){if(o.length===0)return;const r=`${t}_${n}`;this._cancelTask(r),this._tasks.set(r,{unitId:t,subUnitId:n,mutations:o,currentIndex:0}),this._scheduleNextIdle()}cancelScheduledMutations(t,n){const o=`${t}_${n}`;this._cancelTask(o)}_cancelTask(t){this._tasks.delete(t),this._tasks.size===0&&this._idleCallbackId!==null&&(typeof cancelIdleCallback<"u"&&cancelIdleCallback(this._idleCallbackId),this._idleCallbackId=null)}_cancelAllTasks(){this._tasks.clear(),this._idleCallbackId!==null&&(typeof cancelIdleCallback<"u"&&cancelIdleCallback(this._idleCallbackId),this._idleCallbackId=null)}_scheduleNextIdle(){this._idleCallbackId===null&&(typeof requestIdleCallback<"u"?this._idleCallbackId=requestIdleCallback(t=>this._processIdleTasks(t),{timeout:1e3*60}):this._idleCallbackId=setTimeout(()=>{this._processIdleTasks({didTimeout:!1,timeRemaining:()=>16})},16))}_processIdleTasks(t){this._idleCallbackId=null;for(const[n,o]of this._tasks){if(!this._isSheetExist(o.unitId,o.subUnitId)){this._tasks.delete(n);continue}for(o.currentIndex;o.currentIndex<o.mutations.length;){if(t.timeRemaining()<=0&&!t.didTimeout){this._scheduleNextIdle();return}const r=o.mutations[o.currentIndex];this._commandService.syncExecuteCommand(r.id,r.params,{onlyLocal:!0}),o.currentIndex++}this._tasks.delete(n)}this._tasks.size>0&&this._scheduleNextIdle()}_isSheetExist(t,n){const o=this._univerInstanceService.getUnit(t,i.UniverInstanceType.UNIVER_SHEET);return o?o.getSheetBySheetId(n)!==null:!1}_setupBeforeUnloadListener(){typeof window>"u"||(this._beforeUnloadHandler=t=>{if(this.hasPendingTasks())return t.preventDefault(),t.returnValue="",""},window.addEventListener("beforeunload",this._beforeUnloadHandler))}_removeBeforeUnloadListener(){typeof window>"u"||!this._beforeUnloadHandler||(window.removeEventListener("beforeunload",this._beforeUnloadHandler),this._beforeUnloadHandler=null)}},g.SheetLazyExecuteScheduleService=mu([Or(0,i.ICommandService),Or(1,i.IUniverInstanceService)],g.SheetLazyExecuteScheduleService);const Ds={id:"sheet.mutation.copy-worksheet-end",type:i.CommandType.MUTATION,handler:()=>!0},As=(s,e)=>({subUnitId:e.sheet.id,unitId:e.unitId,subUnitName:e.sheet.name}),_t={id:"sheet.mutation.insert-sheet",type:i.CommandType.MUTATION,handler:(s,e)=>{const t=s.get(i.IUniverInstanceService),{sheet:n,index:o,unitId:r,styles:a}=e,l=t.getUniverSheetInstance(r);return l?(a&&l.addStyles(a),l.addWorksheet(n.id,o,n)):!1}};function hu(s){let e=0;for(const t of Object.keys(s)){const n=s[Number(t)];n&&(e+=Object.keys(n).length)}return e}function gu(s,e,t,n){const o=[];let r={},a=0;for(const d in t){const c=Number(d),m=t[c];if(!m)continue;const h=Object.keys(m).length;a>0&&a+h>n&&(o.push(r),r={},a=0),r[c]=m,a+=h,a>=n&&(o.push(r),r={},a=0)}a>0&&o.push(r);const l=o.length>0?o[0]:{},u=o.slice(1).map(d=>({id:F.id,params:{unitId:s,subUnitId:e,cellValue:d,__splitChunk__:!0}}));return{firstChunkCellData:l,remainingMutations:u}}const Dr="sheet.command.copy-sheet";function Ru(s,e,t,n,o,r,a){var b,E;const u=s.get(i.IConfigService).getConfig(Gt),d={...Os,...u==null?void 0:u.largeSheetOperation},c=i.cloneWorksheetData(t.getConfig());c.name=Cu(e,r,c.name);const m=i.generateRandomId();c.id=m;const h=e.getSheetIndex(t),{cellData:R}=c,S=hu(R)>=d.largeSheetCellCountThreshold;let I,v=[];if(S){const{firstChunkCellData:U,remainingMutations:k}=gu(n,m,R,d.batchSize),T={...c,cellData:U};I={index:h+1,sheet:T,unitId:n},v=k}else I={index:h+1,sheet:c,unitId:n};const M=As(s,I),p=a.onCommandExecute({id:Dr,params:{unitId:n,subUnitId:o,targetSubUnitId:c.id}}),w=[...(b=p.preRedos)!=null?b:[],{id:_t.id,params:I},...p.redos],y=[...(E=p.preUndos)!=null?E:[],{id:Ze.id,params:M},...p.undos];return{redos:w,undos:y,unitId:n,newSheetId:m,isSplit:S,scheduledMutations:v}}const Ar={type:i.CommandType.COMMAND,id:Dr,handler:(s,e)=>{const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),o=s.get(i.IUniverInstanceService),r=s.get(g.SheetInterceptorService),a=s.get(i.LocaleService),l=s.get(g.SheetLazyExecuteScheduleService),u=P(o,e);if(!u)return!1;const{workbook:d,worksheet:c,unitId:m,subUnitId:h}=u,{redos:R,undos:C,newSheetId:S,isSplit:I,scheduledMutations:v}=Ru(s,d,c,m,h,a,r);if(i.sequenceExecute(R,t).result){if(I){if(n.pushUndoRedo({unitID:m,undoMutations:C,redoMutations:[]}),v.length>0){for(const p of v)t.syncExecuteCommand(p.id,p.params,{syncOnly:!0});t.syncExecuteCommand(Ds.id,{unitId:m,subUnitId:S},{syncOnly:!0}),l.scheduleMutations(m,S,v)}}else n.pushUndoRedo({unitID:m,undoMutations:C,redoMutations:R});return!0}return!1}};function Cu(s,e,t){let n=`${t} ${e.t("sheets.tabs.sheetCopy","")}`,o=2;for(;s.checkSheetName(n);)n=`${t} ${e.t("sheets.tabs.sheetCopy",`${o}`)}`,o++;return n}const Wr={type:i.CommandType.COMMAND,id:"sheet.command.delete-range-protection",async handler(s,e){if(!e)return!1;const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),{unitId:o,subUnitId:r,rule:a}=e,l={unitId:o,subUnitId:r,ruleIds:[a.id]};return await t.executeCommand(Te.id,l)&&n.pushUndoRedo({unitID:o,redoMutations:[{id:Te.id,params:l}],undoMutations:[{id:Ce.id,params:{unitId:o,subUnitId:r,rules:[a]}}]}),!0}},Vr={type:i.CommandType.COMMAND,id:"sheet.command.delete-worksheet-protection",handler(s,e){if(!e)return!1;const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),{rule:o,unitId:r,subUnitId:a}=e;t.executeCommand(nt.id,{unitId:r,subUnitId:a});const l=[{id:nt.id,params:{unitId:r,subUnitId:a}}],u=[{id:je.id,params:{unitId:r,rule:o,subUnitId:a}}];return n.pushUndoRedo({unitID:r,redoMutations:l,undoMutations:u}),!0}},$r={type:i.CommandType.COMMAND,id:"sheet.command.remove-worksheet-range-theme-style",handler:(s,e)=>{const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),{unitId:o}=e,r=uo(s,e);return t.syncExecuteCommand(at.id,e)?(n.pushUndoRedo({unitID:o,undoMutations:[{id:it.id,params:r}],redoMutations:[{id:at.id,params:e}]}),!0):!1}},Lr={id:"sheet.command.insert-defined-name",type:i.CommandType.COMMAND,handler:(s,e)=>{const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService);if(!e)return!1;const o={...e};return t.syncExecuteCommand(J.SetDefinedNameMutation.id,o)?(n.pushUndoRedo({unitID:e.unitId,undoMutations:[{id:J.RemoveDefinedNameMutation.id,params:o}],redoMutations:[{id:J.SetDefinedNameMutation.id,params:o}]}),!0):!1}},Br={id:"sheet.command.insert-sheet",type:i.CommandType.COMMAND,handler:(s,e)=>{var I;const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),o=s.get(i.IUniverInstanceService),r=s.get(i.LocaleService),a=Hn(o,{unitId:e==null?void 0:e.unitId});if(!a)return!1;const{unitId:l,workbook:u}=a;let d=u.getSheets().length;const c=e==null?void 0:e.sheet,m=c==null?void 0:c.id,h=i.mergeWorksheetSnapshotWithDefault(c||{});e?(d=(I=e.index)!=null?I:d,h.id=m||i.generateRandomId(),h.name=(c==null?void 0:c.name)||u.generateNewSheetName(`${r.t("sheets.tabs.sheet")}`)):(h.id=i.generateRandomId(),h.name=u.generateNewSheetName(`${r.t("sheets.tabs.sheet")}`));const R={index:d,sheet:h,unitId:l},C=As(s,R);return t.syncExecuteCommand(_t.id,R)?(n.pushUndoRedo({unitID:l,undoMutations:[{id:Ze.id,params:C}],redoMutations:[{id:_t.id,params:R}]}),!0):!1}},bt={id:"sheet.mutation.register-worksheet-range-theme-style",type:i.CommandType.MUTATION,handler:(s,e)=>{const{unitId:t,rangeThemeStyleJson:n,themeName:o}=e,r=s.get(i.IUniverInstanceService),a=P(r),l=s.get(g.SheetRangeThemeModel);if(!a)return!1;const u=new We(o,n);return l.registerRangeThemeStyle(t,u),!0}},vn={id:"sheet.mutation.unregister-worksheet-range-theme-style",type:i.CommandType.MUTATION,handler:(s,e)=>{const{unitId:t,themeName:n}=e,o=s.get(i.IUniverInstanceService),r=P(o),a=s.get(g.SheetRangeThemeModel);return r?(a.unregisterRangeThemeStyle(t,n),!0):!1}},Hr={id:"sheet.command.register-worksheet-range-theme-style",type:i.CommandType.COMMAND,handler:(s,e)=>{if(!e)return!1;const{unitId:t,rangeThemeStyle:n}=e,o=s.get(i.IUniverInstanceService),r=s.get(i.ICommandService),a=s.get(i.IUndoRedoService);if(!P(o))return!1;const u={unitId:t,themeName:n.getName(),rangeThemeStyleJson:n.toJson()},d={unitId:t,themeName:n.getName()};return r.syncExecuteCommand(bt.id,u)&&a.pushUndoRedo({unitID:t,undoMutations:[{id:vn.id,params:d}],redoMutations:[{id:bt.id,params:u}]}),!0}},Ws={id:"sheet.command.remove-defined-name",type:i.CommandType.COMMAND,handler:(s,e)=>{var c,m;const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),o=s.get(g.SheetInterceptorService);if(!e)return!1;const r={...e},a=o.onCommandExecute({id:Ws.id,params:e}),l=[...(c=a.preRedos)!=null?c:[],{id:J.RemoveDefinedNameMutation.id,params:r},...a.redos],u=[...(m=a.preUndos)!=null?m:[],{id:J.SetDefinedNameMutation.id,params:r},...a.undos];return i.sequenceExecute(l,t)?(n.pushUndoRedo({unitID:e.unitId,undoMutations:u.filter(Boolean),redoMutations:l.filter(Boolean)}),!0):!1}},pn={id:"sheet.command.remove-sheet",type:i.CommandType.COMMAND,handler:(s,e)=>{var b,E;const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),o=s.get(i.IUniverInstanceService),r=s.get(g.SheetInterceptorService),a=s.get(i.IConfigService),l=P(o,e);if(!l)return!1;const{unitId:u,subUnitId:d,workbook:c,worksheet:m}=l;if(c.getSheets().length<=1)return!1;const h=a.getConfig(Gt),R={...Os,...h==null?void 0:h.largeSheetOperation},S=cr(m.getCellMatrix())>=R.largeSheetCellCountThreshold,I={subUnitId:d,unitId:u,subUnitName:m.getName()},v=S?null:ar(s,I),M=r.onCommandExecute({id:pn.id,params:{unitId:u,subUnitId:d}}),p=[...(b=M.preRedos)!=null?b:[],{id:Ze.id,params:I},...M.redos],w=S?[]:[...(E=M.preUndos)!=null?E:[],{id:_t.id,params:v},...M.undos];return i.sequenceExecute(p,t).result?(S?n.clearUndoRedo(u):n.pushUndoRedo({unitID:u,undoMutations:w,redoMutations:p}),!0):!1}},Fr={type:i.CommandType.COMMAND,id:"sheet.command.remove-worksheet-merge",handler:(s,e)=>{var N;const t=s.get(g.SheetsSelectionsService),n=s.get(i.ICommandService),o=s.get(i.IUndoRedoService),r=s.get(i.IUniverInstanceService),a=(e==null?void 0:e.ranges)||((N=t.getCurrentSelections())==null?void 0:N.map(W=>W.range));if(!(a!=null&&a.length))return!1;const l=P(r);if(!l)return!1;const{subUnitId:u,unitId:d,worksheet:c}=l,m={unitId:d,subUnitId:u,ranges:a},R=c.getConfig().mergeData.filter(W=>a.some(V=>i.Rectangle.intersects(V,W)));if(!R.length)return!1;const C=le(s,m),S=t.getCurrentSelections();if(!(S!=null&&S.length))return!1;const I=i.Tools.deepClone(S),v=i.Tools.deepClone(S),M=v[v.length-1],{startRow:p,startColumn:w}=M.range;M.primary={startRow:p,startColumn:w,endRow:p,endColumn:w,actualRow:p,actualColumn:w,isMerged:!1,isMergedMainCell:!1};const y=Su(c,R),b={unitId:d,subUnitId:u,cellValue:y.redoParams.getMatrix()},E={unitId:d,subUnitId:u,cellValue:y.undoParams.getMatrix()},U=[{id:G.id,params:C},{id:F.id,params:b},{id:q.id,params:{selections:v}}],k=[{id:j.id,params:C},{id:F.id,params:E},{id:q.id,params:{selections:I}}];return i.sequenceExecute(U,n)?(o.pushUndoRedo({unitID:d,undoMutations:k,redoMutations:U}),!0):!1}};function Su(s,e){const t=new i.ObjectMatrix,n=new i.ObjectMatrix;return e.forEach(o=>{const{startRow:r,startColumn:a,endColumn:l,endRow:u}=o,d=s.getCellMatrix().getValue(r,a);if(d!=null&&d.s)for(let c=r;c<=u;c++)for(let m=a;m<=l;m++)(c!==r||m!==a)&&(t.setValue(c,m,{s:d.s}),n.setValue(c,m,null))}),{redoParams:t,undoParams:n}}class st{constructor(){f(this,"_borderInfo",{type:i.BorderType.ALL,color:"#000000",style:i.BorderStyleTypes.THIN,activeBorderType:!1});f(this,"_borderInfo$",new O.BehaviorSubject(this._borderInfo));f(this,"borderInfo$",this._borderInfo$.asObservable())}dispose(){this._borderInfo$.complete()}setType(e){this._borderInfo.type=e,this.setActiveBorderType(!0),this._refresh()}setColor(e){this._borderInfo.color=e,this._refresh()}setStyle(e){this._borderInfo.style=e,this._refresh()}setActiveBorderType(e){this._borderInfo.activeBorderType=e}getBorderInfo(){return this._borderInfo}_refresh(){this._borderInfo$.next(this._borderInfo)}}function wn(s,e){const{startRow:t,startColumn:n,endRow:o,endColumn:r}=s;for(let a=t;a<=o;a++)for(let l=n;l<=r;l++)e(a,l)}const Vs=(s,e,t,n)=>{const{mr:o,worksheet:r}=s;e.startRow<0||e.startColumn<0||wn(e,(a,l)=>{var c,m;const u=r.getMergedCell(a,l);let d=t;if(u&&(t.bc_tr||t.ml_tr||t.bl_tr||t.tl_mr||t.tl_bc||t.tl_br)){if(n){const h=i.Tools.deepClone((c=o.getValue(u.startRow,u.startColumn))==null?void 0:c.s);d=h!=null&&h.bd?Object.assign(h.bd,t):t}o.setValue(u.startRow,u.startColumn,{s:{bd:d}})}else{if(n){const h=i.Tools.deepClone((m=o.getValue(a,l))==null?void 0:m.s);d=h!=null&&h.bd?Object.assign(h.bd,t):t}o.setValue(a,l,{s:{bd:d}})}})},fu=s=>{const e={startRow:s.startRow-1,startColumn:s.startColumn,endRow:s.startRow-1,endColumn:s.endColumn},t={startRow:s.startRow,startColumn:s.startColumn-1,endRow:s.endRow,endColumn:s.startColumn-1},n={startRow:s.endRow+1,startColumn:s.startColumn,endRow:s.endRow+1,endColumn:s.endColumn},o={startRow:s.startRow,startColumn:s.endColumn+1,endRow:s.endRow,endColumn:s.endColumn+1},r={startRow:s.startRow,startColumn:s.startColumn,endRow:s.startRow,endColumn:s.endColumn},a={startRow:s.startRow,startColumn:s.startColumn,endRow:s.endRow,endColumn:s.startColumn},l={startRow:s.endRow,startColumn:s.startColumn,endRow:s.endRow,endColumn:s.endColumn},u={startRow:s.startRow,startColumn:s.endColumn,endRow:s.endRow,endColumn:s.endColumn};return{topRangeOut:e,leftRangeOut:t,bottomRangeOut:n,rightRangeOut:o,topRange:r,leftRange:a,bottomRange:l,rightRange:u}};function Iu(s,e,t){const{style:n,color:o,type:r}=s.getBorderInfo(),a=r===i.BorderType.TOP||r===i.BorderType.ALL||r===i.BorderType.OUTSIDE,l=r===i.BorderType.LEFT||r===i.BorderType.ALL||r===i.BorderType.OUTSIDE,u=r===i.BorderType.BOTTOM||r===i.BorderType.ALL||r===i.BorderType.OUTSIDE,d=r===i.BorderType.RIGHT||r===i.BorderType.ALL||r===i.BorderType.OUTSIDE,c=r===i.BorderType.VERTICAL||r===i.BorderType.ALL||r===i.BorderType.INSIDE,m=r===i.BorderType.HORIZONTAL||r===i.BorderType.ALL||r===i.BorderType.INSIDE,h=r.indexOf("tlbr")>-1,R=r.indexOf("tlbc")>-1,C=r.indexOf("tlmr")>-1,S=r.indexOf("bltr")>-1,I=r.indexOf("mltr")>-1,v=r.indexOf("bctr")>-1,M=t[0],{topRangeOut:p,leftRangeOut:w,bottomRangeOut:y,rightRangeOut:b,topRange:E,leftRange:U,bottomRange:k,rightRange:T}=fu(M),N=new i.ObjectMatrix,{worksheet:W,unitId:V,subUnitId:$}=e;return{worksheet:W,unitId:V,subUnitId:$,style:n,color:o,type:r,top:a,left:l,right:d,bottom:u,vertical:c,horizontal:m,tl_br:h,tl_bc:R,tl_mr:C,bl_tr:S,ml_tr:I,bc_tr:v,topRangeOut:p,leftRangeOut:w,bottomRangeOut:y,rightRangeOut:b,topRange:E,leftRange:U,bottomRange:k,rightRange:T,range:M,mr:N,borderStyle:{s:n,cl:{rgb:o}}}}const vu=s=>{const{range:e,mr:t,borderStyle:n,vertical:o,horizontal:r,worksheet:a}=s;o&&wn(e,(l,u)=>{var c,m,h;const d=a.getMergedCell(l,u);if(d){const R=(c=t.getValue(d.startRow,d.startColumn))==null?void 0:c.s;d.startColumn!==e.startColumn&&t.setValue(l,u,{s:{bd:R!=null&&R.bd?Object.assign(R.bd,{l:i.Tools.deepClone(n)}):{l:i.Tools.deepClone(n)}}})}else{if(u!==e.endColumn){const R=(m=t.getValue(l,u))==null?void 0:m.s;t.setValue(l,u,{s:{bd:R!=null&&R.bd?Object.assign(R.bd,{r:i.Tools.deepClone(n)}):{r:i.Tools.deepClone(n)}}})}if(u!==e.startColumn){const R=(h=t.getValue(l,u))==null?void 0:h.s;t.setValue(l,u,{s:{bd:R!=null&&R.bd?Object.assign(R.bd,{l:i.Tools.deepClone(n)}):{l:i.Tools.deepClone(n)}}})}}}),r&&wn(e,(l,u)=>{var c,m,h;const d=a.getMergedCell(l,u);if(d){const R=(c=t.getValue(d.startRow,d.startColumn))==null?void 0:c.s;d.startRow!==e.startRow&&t.setValue(l,u,{s:{bd:R!=null&&R.bd?Object.assign(R.bd,{t:i.Tools.deepClone(n)}):{t:i.Tools.deepClone(n)}}})}else{if(l!==e.endRow){const R=(m=t.getValue(l,u))==null?void 0:m.s;t.setValue(l,u,{s:{bd:R!=null&&R.bd?Object.assign(R.bd,{b:i.Tools.deepClone(n)}):{b:i.Tools.deepClone(n)}}})}if(l!==e.startRow){const R=(h=t.getValue(l,u))==null?void 0:h.s;t.setValue(l,u,{s:{bd:R!=null&&R.bd?Object.assign(R.bd,{t:i.Tools.deepClone(n)}):{t:i.Tools.deepClone(n)}}})}}})};function pu(s){const{borderStyle:e,tl_br:t,tl_bc:n,tl_mr:o,bl_tr:r,ml_tr:a,bc_tr:l}=s,u=(d,c,m)=>{Vs(s,d,c,m)};t&&u(s.range,{tl_br:i.Tools.deepClone(e)},!0),n&&u(s.range,{tl_bc:i.Tools.deepClone(e)},!0),o&&u(s.range,{tl_mr:i.Tools.deepClone(e)},!0),r&&u(s.range,{bl_tr:i.Tools.deepClone(e)},!0),a&&u(s.range,{ml_tr:i.Tools.deepClone(e)},!0),l&&u(s.range,{bc_tr:i.Tools.deepClone(e)},!0)}const wu=s=>{const{top:e,left:t,right:n,bottom:o,borderStyle:r,bottomRange:a,topRange:l,leftRange:u,rightRange:d,bottomRangeOut:c,topRangeOut:m,leftRangeOut:h,rightRangeOut:R}=s,C=(S,I,v)=>{Vs(s,S,I,v)};e&&(C(m,{b:null}),C(l,{t:i.Tools.deepClone(r)},!0)),o&&(C(c,{t:null}),C(a,{b:i.Tools.deepClone(r)},!0)),t&&(C(h,{r:null}),C(u,{l:i.Tools.deepClone(r)},!0)),n&&(C(R,{l:null}),C(d,{r:i.Tools.deepClone(r)},!0))},Mu=s=>{const{range:e,worksheet:t,mr:n,top:o,bottom:r,left:a,right:l,vertical:u,horizontal:d,tl_br:c,tl_bc:m,tl_mr:h,bl_tr:R,ml_tr:C,bc_tr:S,topRange:I,bottomRange:v,leftRange:M,rightRange:p,topRangeOut:w,bottomRangeOut:y,leftRangeOut:b,rightRangeOut:E}=s,U=(k,T,N)=>{Vs(s,k,T,N)};!o&&!r&&!a&&!l&&!u&&!d&&!c&&!m&&!h&&!R&&!C&&!S&&(wn(e,(k,T)=>{var W,V,$,L,Y,z,K,oe;const N=t.getMergedCell(k,T);if(N){if(N.endColumn!==e.endColumn){const H=(W=n.getValue(N.startRow,N.startColumn))==null?void 0:W.s;n.setValue(k,T,{s:{bd:H!=null&&H.bd?Object.assign(H.bd,{r:null}):{r:null}}})}if(N.startColumn!==e.startColumn){const H=(V=n.getValue(N.startRow,N.startColumn))==null?void 0:V.s;n.setValue(k,T,{s:{bd:H!=null&&H.bd?Object.assign(H.bd,{l:null}):{l:null}}})}if(N.endRow!==e.endRow){const H=($=n.getValue(N.startRow,N.startColumn))==null?void 0:$.s;n.setValue(k,T,{s:{bd:H!=null&&H.bd?Object.assign(H.bd,{b:null}):{b:null}}})}if(N.startRow!==e.startRow){const H=(L=n.getValue(N.startRow,N.startColumn))==null?void 0:L.s;n.setValue(k,T,{s:{bd:H!=null&&H.bd?Object.assign(H.bd,{t:null}):{t:null}}})}}else{if(T!==e.endColumn){const H=(Y=n.getValue(k,T))==null?void 0:Y.s;n.setValue(k,T,{s:{bd:H!=null&&H.bd?Object.assign(H.bd,{r:null}):{r:null}}})}if(T!==e.startColumn){const H=(z=n.getValue(k,T))==null?void 0:z.s;n.setValue(k,T,{s:{bd:H!=null&&H.bd?Object.assign(H.bd,{l:null}):{l:null}}})}if(k!==e.endRow){const H=(K=n.getValue(k,T))==null?void 0:K.s;n.setValue(k,T,{s:{bd:H!=null&&H.bd?Object.assign(H.bd,{b:null}):{b:null}}})}if(k!==e.startRow){const H=(oe=n.getValue(k,T))==null?void 0:oe.s;n.setValue(k,T,{s:{bd:H!=null&&H.bd?Object.assign(H.bd,{t:null}):{t:null}}})}}}),U(w,{b:null}),U(I,{t:null},!0),U(y,{t:null}),U(v,{b:null},!0),U(b,{r:null}),U(M,{l:null},!0),U(E,{l:null}),U(p,{r:null},!0),U(e,{tl_br:null},!0),U(e,{tl_bc:null},!0),U(e,{tl_mr:null},!0),U(e,{bl_tr:null},!0),U(e,{ml_tr:null},!0),U(e,{bc_tr:null},!0))},Et={id:"sheet.command.set-border",type:i.CommandType.COMMAND,handler:(s,e)=>{var v;const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),o=s.get(i.IUniverInstanceService),r=s.get(g.SheetsSelectionsService),a=s.get(st),l=P(o,e);if(!l)return!1;const u=(e==null?void 0:e.ranges)||((v=r.getCurrentSelections())==null?void 0:v.map(M=>M.range));if(!(u!=null&&u.length))return!1;const{activeBorderType:d}=a.getBorderInfo();if(!d)return!1;const c=Iu(a,l,u);vu(c),wu(c),pu(c),Mu(c);const{unitId:m,subUnitId:h,mr:R}=c,C={unitId:m,subUnitId:h,cellValue:R.getData()},S=ce(s,C);return t.syncExecuteCommand(F.id,C)?(n.pushUndoRedo({unitID:m,undoMutations:[{id:F.id,params:S}],redoMutations:[{id:F.id,params:C}]}),!0):!1}},jr={id:"sheet.command.set-border-position",type:i.CommandType.COMMAND,handler:(s,e)=>{if(!e.value)return!1;const t=s.get(i.ICommandService);return s.get(st).setType(e.value),t.syncExecuteCommand(Et.id)}},Gr={id:"sheet.command.set-border-style",type:i.CommandType.COMMAND,handler:(s,e)=>{const t=s.get(i.ICommandService);return s.get(st).setStyle(e.value),t.syncExecuteCommand(Et.id)}},zr={id:"sheet.command.set-border-color",type:i.CommandType.COMMAND,handler:(s,e)=>{const t=s.get(i.ICommandService);return s.get(st).setColor(e.value),t.syncExecuteCommand(Et.id)}},qr={id:"sheet.command.set-border-basic",type:i.CommandType.COMMAND,handler:(s,e)=>{const{unitId:t,subUnitId:n,value:o,ranges:r}=e,{type:a,color:l,style:u}=o,d=s.get(i.ICommandService),c=s.get(st);return c.setType(a),l&&c.setColor(l),c.setStyle(u),d.syncExecuteCommand(Et.id,{unitId:t,subUnitId:n,ranges:r})}},Yr={type:i.CommandType.COMMAND,id:"sheet.command.set-col-data",handler:(s,e)=>{const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),o=s.get(i.IUniverInstanceService),r=P(o,e);if(!r)return!1;const{columnData:a}=e,{unitId:l,subUnitId:u,worksheet:d}=r,c={subUnitId:u,unitId:l,columnData:a},m=go(c,d);return t.syncExecuteCommand(lt.id,c)?(n.pushUndoRedo({unitID:l,undoMutations:[{id:lt.id,params:m}],redoMutations:[{id:lt.id,params:c}]}),!0):!1}},Tt={type:i.CommandType.COMMAND,id:"sheet.command.set-col-visible-on-cols",handler:(s,e)=>{var v,M;const{unitId:t,subUnitId:n,ranges:o}=e,r=s.get(g.SheetInterceptorService),a=s.get(i.ICommandService),l=s.get(i.IUniverInstanceService),u=P(l,{unitId:t,subUnitId:n});if(!u)return!1;const{worksheet:d}=u,c={unitId:t,subUnitId:n,ranges:o},m={unitId:t,subUnitId:n,reveal:!0,selections:o.map(p=>({range:p,primary:se(p,d),style:null}))},h=Ia(s,c),R={unitId:t,subUnitId:n,selections:Kr(o).map(p=>({range:p,primary:se(p,d),style:null}))},C=i.sequenceExecute([{id:dt.id,params:c},{id:q.id,params:m}],a),S=r.onCommandExecute({id:Tt.id,params:e}),I=i.sequenceExecute([...S.redos],a);if(C.result&&I.result){const p=r.afterCommandExecute({id:Tt.id,params:e});return i.sequenceExecute(p.redos,a),s.get(i.IUndoRedoService).pushUndoRedo({unitID:t,undoMutations:[{id:ut.id,params:h},{id:q.id,params:R},...(v=S.undos)!=null?v:[],...p.undos],redoMutations:[...(M=S.preRedos)!=null?M:[],{id:dt.id,params:c},{id:q.id,params:m},...S.redos,...p.redos]}),!0}return!0}},$s={type:i.CommandType.COMMAND,id:"sheet.command.set-selected-cols-visible",handler:s=>{var d;const e=s.get(g.SheetsSelectionsService),t=s.get(i.ICommandService),n=(d=e.getCurrentSelections())==null?void 0:d.map(c=>c.range).filter(c=>c.rangeType===i.RANGE_TYPE.COLUMN);if(!(n!=null&&n.length))return!1;const o=P(s.get(i.IUniverInstanceService));if(!o)return!1;const{worksheet:r,unitId:a,subUnitId:l}=o,u=n.map(c=>r.getHiddenCols(c.startColumn,c.endColumn)).flat();return t.executeCommand(Tt.id,{unitId:a,subUnitId:l,ranges:u})}},Mn={type:i.CommandType.COMMAND,id:"sheet.command.set-col-hidden",handler:(s,e)=>{var M,p,w,y;const t=s.get(g.SheetsSelectionsService),n=s.get(g.SheetInterceptorService),o=s.get(i.IUniverInstanceService),r=s.get(i.ICommandService);let a=(M=e==null?void 0:e.ranges)!=null&&M.length?e.ranges:(p=t.getCurrentSelections())==null?void 0:p.map(b=>b.range).filter(b=>b.rangeType===i.RANGE_TYPE.COLUMN);if(!(a!=null&&a.length))return!1;const l=P(o,e);if(!l)return!1;const{worksheet:u,unitId:d,subUnitId:c}=l;a=yu(l.worksheet,a);const m={unitId:d,subUnitId:c,ranges:a},h={unitId:d,subUnitId:c,selections:Kr(a).map(b=>({range:b,primary:se(b,u),style:null}))},R=fa(s,m),C={unitId:d,subUnitId:c,reveal:!0,selections:a.map(b=>({range:b,primary:se(b,u),style:null}))},S=i.sequenceExecute([{id:ut.id,params:m},{id:q.id,params:h}],r),I=n.onCommandExecute({id:Mn.id,params:m}),v=i.sequenceExecute([...I.redos],r);if(S.result&&v.result){const b=n.afterCommandExecute({id:Mn.id,params:m});return i.sequenceExecute(b.redos,r),s.get(i.IUndoRedoService).pushUndoRedo({unitID:d,undoMutations:[{id:dt.id,params:R},{id:q.id,params:C},...(w=I.undos)!=null?w:[],...b.undos],redoMutations:[...(y=I.preRedos)!=null?y:[],{id:ut.id,params:m},{id:q.id,params:h},...I.redos,...b.redos]}),!0}return!1}};function yu(s,e){const t=s.getRowCount()-1,n=s.getHiddenCols(),o=[];return e.forEach(r=>{const a=n.filter(l=>l.startColumn>=r.startColumn&&l.endColumn<=r.endColumn);if(a.length){let l=r.startColumn;a.forEach(u=>{u.startColumn>l&&(o.push({startColumn:l,endColumn:u.startColumn-1,startRow:0,endRow:t}),l=u.endColumn+1)}),l<=r.endColumn&&o.push({startColumn:l,endColumn:r.endColumn,startRow:0,endRow:t})}else o.push(r)}),o}function Kr(s){return _u(s).map(t=>{const n=t.startColumn===0?t.endColumn+1:t.startColumn-1;return{...t,startColumn:n,endColumn:n}})}function _u(s){const e=[];let t;return s.sort((n,o)=>n.startColumn-o.startColumn).forEach(n=>{if(!t){t=n;return}t.endColumn===n.startColumn-1?t.endColumn=n.endColumn:(e.push(t),t=n)}),e.push(t),e}const Ls={id:"sheet.command.set-defined-name",type:i.CommandType.COMMAND,handler:(s,e)=>{var m,h;const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),o=s.get(g.SheetInterceptorService);if(!e)return!1;const r={...e},a=J.SetDefinedNameMutationFactory(s,e),l=o.onCommandExecute({id:Ls.id,params:e}),u=[...(m=l.preRedos)!=null?m:[],{id:J.RemoveDefinedNameMutation.id,params:a},{id:J.SetDefinedNameMutation.id,params:r},...l.redos],d=[...(h=l.preUndos)!=null?h:[],{id:J.RemoveDefinedNameMutation.id,params:r},{id:J.SetDefinedNameMutation.id,params:a},...l.undos];return i.sequenceExecute(u,t)?(n.pushUndoRedo({unitID:e.unitId,undoMutations:d.filter(Boolean),redoMutations:u.filter(Boolean)}),!0):!1}},Bs=(s,e)=>{const n=s.get(i.IUniverInstanceService).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const o=n.getSheetBySheetId(e.subUnitId);if(o==null)throw new Error("worksheet is null error!");const a=o.getConfig().freeze;return{unitId:e.unitId,subUnitId:e.subUnitId,...a}},Ne={id:"sheet.mutation.set-frozen",type:i.CommandType.MUTATION,handler:(s,e)=>{const n=s.get(i.IUniverInstanceService).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const o=n.getSheetBySheetId(e.subUnitId);if(!o)return!1;const r=o.getConfig(),{startRow:a,startColumn:l,ySplit:u,xSplit:d}=e;return r.freeze={startRow:a,startColumn:l,ySplit:u,xSplit:d},!0}},Jr={type:i.CommandType.COMMAND,id:"sheet.command.set-frozen",handler:(s,e)=>{const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),o=s.get(i.IUniverInstanceService),r=P(o,{unitId:e.unitId,subUnitId:e.subUnitId});if(!r)return!1;const{unitId:a,subUnitId:l,worksheet:u}=r,{startColumn:d,startRow:c,xSplit:m,ySplit:h}=e;if(c>=u.getRowCount()||d>=u.getColumnCount()||m>=u.getColumnCount()||h>=u.getRowCount())return!1;const R={unitId:a,subUnitId:l,...e},C=Bs(s,R);return t.syncExecuteCommand(Ne.id,R)?(n.pushUndoRedo({unitID:a,undoMutations:[{id:Ne.id,params:C}],redoMutations:[{id:Ne.id,params:R}]}),!0):!1}},xr={type:i.CommandType.COMMAND,id:"sheet.command.cancel-frozen",handler:(s,e)=>{const t=s.get(i.ICommandService),n=s.get(i.IUniverInstanceService),o=s.get(i.IUndoRedoService),r=P(n,{unitId:e==null?void 0:e.unitId,subUnitId:e==null?void 0:e.subUnitId});if(!r)return!1;const{unitId:a,subUnitId:l}=r,u={unitId:a,subUnitId:l,startRow:-1,startColumn:-1,xSplit:0,ySplit:0},d=Bs(s,u);return t.syncExecuteCommand(Ne.id,u)&&o.pushUndoRedo({unitID:a,undoMutations:[{id:Ne.id,params:d}],redoMutations:[{id:Ne.id,params:u}]}),!0}},Xr={type:i.CommandType.COMMAND,id:"sheet.command.set-gridlines-color",handler:(s,e)=>{const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),o=s.get(i.IUniverInstanceService),r=P(o);if(!r)return!1;const{worksheet:a}=r,l=a.getConfig().gridlinesColor;if(l===(e==null?void 0:e.color))return!1;const{unitId:u,subUnitId:d}=r,c={color:e==null?void 0:e.color,unitId:u,subUnitId:d},m={color:l,unitId:u,subUnitId:d};return t.syncExecuteCommand(ct.id,c)?(n.pushUndoRedo({unitID:u,undoMutations:[{id:ct.id,params:m}],redoMutations:[{id:ct.id,params:c}]}),!0):!1}},Q={id:"sheet.mutation.set-range-protection",type:i.CommandType.MUTATION,handler:(s,e)=>{const{unitId:t,subUnitId:n,rule:o,ruleId:r}=e;return s.get(X).setRule(t,n,r,o),!0}},bu=(s,e)=>{const{unitId:t,subUnitId:n,ruleId:o}=e,a=s.get(X).getRule(t,n,o);return a?{id:Q.id,params:{...e,rule:a}}:null},ot={id:"sheet.mutation.set-worksheet-protection",type:i.CommandType.MUTATION,handler:(s,e)=>{const{unitId:t,subUnitId:n,rule:o}=e;return s.get(Pe).setRule(t,n,o),!0}},Zr={type:i.CommandType.COMMAND,id:"sheet.command.set-protection",async handler(s,e){if(!e)return!1;const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),o=s.get(X),{rule:r,oldRule:a}=e,{unitId:l,subUnitId:u}=r,d=[],c=[];return(a==null?void 0:a.unitType)===r.unitType?r.unitType===D.Worksheet?(d.push({id:ot.id,params:{unitId:l,subUnitId:u,rule:r}}),c.push({id:ot.id,params:{unitId:l,subUnitId:u,rule:a}})):(d.push({id:Q.id,params:{unitId:l,subUnitId:u,rule:r,ruleId:r.id}}),c.push({id:Q.id,params:{unitId:l,subUnitId:u,ruleId:a.id,rule:a}})):(a&&(a.unitType===D.Worksheet?(d.push({id:nt.id,params:{unitId:l,subUnitId:u}}),c.push({id:je.id,params:{unitId:l,rule:a,subUnitId:a.subUnitId}})):a.unitType===D.SelectRange&&(d.push({id:Te.id,params:{unitId:l,subUnitId:u,ruleIds:[a.id]}}),c.push({id:Ce.id,params:{unitId:l,subUnitId:u,rules:[a]}}))),r.unitType===D.Worksheet?(d.push({id:je.id,params:{unitId:l,rule:r,subUnitId:r.subUnitId}}),c.unshift({id:nt.id,params:{unitId:l,subUnitId:u}})):r.unitType===D.SelectRange&&(r.id=o.createRuleId(l,u),d.push({id:Ce.id,params:{unitId:l,subUnitId:u,rules:[r]}}),c.unshift({id:Te.id,params:{unitId:l,subUnitId:u,ruleIds:[r.id]}}))),i.sequenceExecute(d,t)&&n.pushUndoRedo({unitID:l,undoMutations:c,redoMutations:d}),!0}},Qr={type:i.CommandType.COMMAND,id:"sheet.command.set-row-data",handler:(s,e)=>{const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),o=s.get(i.IUniverInstanceService),r=P(o,e);if(!r)return!1;const{rowData:a}=e,{unitId:l,subUnitId:u,worksheet:d}=r,c={subUnitId:u,unitId:l,rowData:a},m=So(c,d);return t.syncExecuteCommand(mt.id,c)?(n.pushUndoRedo({unitID:l,undoMutations:[{id:mt.id,params:m}],redoMutations:[{id:mt.id,params:c}]}),!0):!1}},Ut={type:i.CommandType.COMMAND,id:"sheet.command.set-specific-rows-visible",handler:(s,e)=>{var v,M,p;const{unitId:t,subUnitId:n,ranges:o}=e,r=s.get(i.ICommandService),a=s.get(i.IUndoRedoService),l=s.get(g.SheetInterceptorService),u=P(s.get(i.IUniverInstanceService),{unitId:t,subUnitId:n});if(!u)return!1;const{worksheet:d}=u,c={unitId:t,subUnitId:n,ranges:o},m={unitId:t,subUnitId:n,reveal:!0,selections:o.map(w=>({range:w,primary:se(w,d),style:null}))},h=Ua(s,c),R={unitId:t,subUnitId:n,selections:ei(o).map(w=>({range:w,primary:se(w,d),style:null}))},C=i.sequenceExecute([{id:Ke.id,params:c},{id:q.id,params:m}],r),S=l.onCommandExecute({id:Ut.id,params:e}),I=i.sequenceExecute([...S.redos],r);if(C.result&&I.result){const w=l.afterCommandExecute({id:Ut.id,params:e});return i.sequenceExecute(w.redos,r),a.pushUndoRedo({unitID:t,undoMutations:[...(v=S.preUndos)!=null?v:[],{id:Je.id,params:h},{id:q.id,params:R},...(M=S.undos)!=null?M:[],...w.undos],redoMutations:[...(p=S.preRedos)!=null?p:[],{id:Ke.id,params:c},{id:q.id,params:m},...S.redos,...w.redos]}),!0}return!0}},Hs={type:i.CommandType.COMMAND,id:"sheet.command.set-selected-rows-visible",handler:async s=>{var c;const e=s.get(g.SheetsSelectionsService),t=s.get(i.IUniverInstanceService),n=s.get(i.ICommandService),o=(c=e.getCurrentSelections())==null?void 0:c.map(m=>m.range).filter(m=>m.rangeType===i.RANGE_TYPE.ROW);if(!(o!=null&&o.length))return!1;const r=P(t);if(!r)return!1;const{worksheet:a,unitId:l,subUnitId:u}=r,d=o.map(m=>a.getHiddenRows(m.startRow,m.endRow)).flat();return n.executeCommand(Ut.id,{unitId:l,subUnitId:u,ranges:d})}},yn={type:i.CommandType.COMMAND,id:"sheet.command.set-rows-hidden",handler:(s,e)=>{var M,p,w,y,b,E;const t=s.get(g.SheetsSelectionsService),n=s.get(i.ICommandService),o=s.get(i.IUndoRedoService),r=s.get(i.IUniverInstanceService),a=s.get(g.SheetInterceptorService);let l=(M=e==null?void 0:e.ranges)!=null&&M.length?e.ranges:(p=t.getCurrentSelections())==null?void 0:p.map(U=>U.range).filter(U=>U.rangeType===i.RANGE_TYPE.ROW);if(!(l!=null&&l.length))return!1;const u=P(r,e);if(!u)return!1;l=Eu(u.worksheet,l);const{unitId:d,subUnitId:c,worksheet:m}=u,h={unitId:d,subUnitId:c,ranges:l},R={unitId:d,subUnitId:c,selections:ei(l).map(U=>({range:U,primary:se(U,m),style:null}))},C=ka(s,h),S={unitId:d,subUnitId:c,reveal:!0,selections:l.map(U=>({range:U,primary:se(U,m),style:null}))},I=a.onCommandExecute({id:yn.id,params:h});if(i.sequenceExecute([...(w=I.preRedos)!=null?w:[],{id:Je.id,params:h},{id:q.id,params:R},...I.redos],n).result){const U=a.afterCommandExecute({id:yn.id,params:h});return i.sequenceExecute(U.redos,n),o.pushUndoRedo({unitID:d,undoMutations:[...(y=I.preUndos)!=null?y:[],{id:Ke.id,params:C},{id:q.id,params:S},...(b=I.undos)!=null?b:[],...U.undos],redoMutations:[...(E=I.preRedos)!=null?E:[],{id:Je.id,params:h},{id:q.id,params:R},...I.redos,...U.redos]}),!0}return!0}};function Eu(s,e){const t=s.getMaxColumns()-1,n=s.getHiddenRows(),o=[];return e.forEach(r=>{const a=n.filter(l=>l.startRow>=r.startRow&&l.endRow<=r.endRow);if(a.length){let l=r.startRow;a.forEach(u=>{u.startRow>l&&(o.push({startRow:l,endRow:u.startRow-1,startColumn:0,endColumn:t}),l=u.endRow+1)}),l<=r.endRow&&o.push({startRow:l,endRow:r.endRow,startColumn:0,endColumn:t})}else o.push(r)}),o}function ei(s){return Tu(s).map(t=>{const n=t.startRow===0?t.endRow+1:t.startRow-1;return{...t,startRow:n,endRow:n}})}function Tu(s){const e=[];let t;return s.sort((n,o)=>n.startRow-o.startRow).forEach(n=>{if(!t){t=n;return}n.startRow===t.endRow+1?t.endRow=n.endRow:(e.push(t),t=n)}),e.push(t),e}const Uu=["ff","fs","tr","tb"],ee={type:i.CommandType.COMMAND,id:"sheet.command.set-style",handler:(s,e)=>{var k;const t=s.get(i.IUniverInstanceService),n=P(t,e);if(!n)return!1;const{unitId:o,subUnitId:r,worksheet:a}=n,{range:l,style:u}=e,d=s.get(i.ICommandService),c=s.get(i.IUndoRedoService),m=s.get(g.SheetsSelectionsService),h=l?[l]:(k=m.getCurrentSelections())==null?void 0:k.map(T=>T.range);if(!(h!=null&&h.length))return!1;const R=new i.ObjectMatrix,C=gl(a);if(i.Tools.isArray(u.value))for(let T=0;T<h.length;T++)C.forOperableEach(h[T],(N,W,V)=>{R.setValue(N,W,{s:{[u.type]:u.value[N-V.startRow][W-V.startColumn]}})});else for(let T=0;T<h.length;T++){const N={s:{[u.type]:u.value}};C.forOperableEach(h[T],(W,V)=>R.setValue(W,V,N))}const S={subUnitId:r,unitId:o,cellValue:R.getMatrix()},I=s.get(g.SheetSkeletonService).getSkeleton(o,r),v=ce(s,S),M=d.syncExecuteCommand(F.id,S),p=s.get(g.SheetInterceptorService);let w=[],y=[];if(Uu.includes(e==null?void 0:e.style.type)){const{suitableRanges:T,remainingRanges:N}=Ht(h,I),W=bs(T,a),{undos:V,redos:$}=p.generateMutationsOfAutoHeight({unitId:o,subUnitId:r,ranges:T,autoHeightRanges:T,lazyAutoHeightRanges:N,cellHeights:W});w=V,y=$}const{undos:b,redos:E}=p.onCommandExecute({id:ee.id,params:e}),U=i.sequenceExecute([...E,...y],d);return M&&U.result?(c.pushUndoRedo({unitID:S.unitId,undoMutations:[{id:F.id,params:v},...b,...w],redoMutations:[{id:F.id,params:S},...E,...y]}),!0):!1}},ku={type:i.CommandType.COMMAND,id:"sheet.command.set-bold",handler:s=>{const e=s.get(g.SheetsSelectionsService).getCurrentLastSelection();if(!e)return!1;const t=P(s.get(i.IUniverInstanceService));if(!t)return!1;const{worksheet:n}=t,{actualRow:o,actualColumn:r}=e.primary,l={style:{type:"bl",value:n.getRange(o,r).getFontWeight()===i.FontWeight.BOLD?i.BooleanNumber.FALSE:i.BooleanNumber.TRUE}};return s.get(i.ICommandService).syncExecuteCommand(ee.id,l)}},Pu={type:i.CommandType.COMMAND,id:"sheet.command.set-italic",handler:s=>{const e=s.get(g.SheetsSelectionsService).getCurrentLastSelection();if(!e)return!1;const t=P(s.get(i.IUniverInstanceService));if(!t)return!1;const{worksheet:n}=t;let o=!0;if(e.primary){const{startRow:a,startColumn:l}=e.primary;o=n.getRange(a,l).getFontStyle()===i.FontItalic.ITALIC}const r={style:{type:"it",value:o?i.BooleanNumber.FALSE:i.BooleanNumber.TRUE}};return s.get(i.ICommandService).syncExecuteCommand(ee.id,r)}},Nu={type:i.CommandType.COMMAND,id:"sheet.command.set-underline",handler:s=>{const e=s.get(g.SheetsSelectionsService).getCurrentLastSelection();if(!e)return!1;const t=P(s.get(i.IUniverInstanceService));if(!t)return!1;const{worksheet:n}=t;let o=!0;e.primary&&(o=!!n.getRange(e.primary.startRow,e.primary.startColumn).getUnderline().s);const r={style:{type:"ul",value:{s:o?i.BooleanNumber.FALSE:i.BooleanNumber.TRUE}}};return s.get(i.ICommandService).syncExecuteCommand(ee.id,r)}},Ou={type:i.CommandType.COMMAND,id:"sheet.command.set-stroke",handler:s=>{const e=s.get(g.SheetsSelectionsService).getCurrentLastSelection();if(!e)return!1;const t=P(s.get(i.IUniverInstanceService));if(!t)return!1;const{worksheet:n}=t;let o=!0;e.primary&&(o=!!n.getRange(e.primary.actualRow,e.primary.actualColumn).getStrikeThrough().s);const r={style:{type:"st",value:{s:o?i.BooleanNumber.FALSE:i.BooleanNumber.TRUE}}};return s.get(i.ICommandService).syncExecuteCommand(ee.id,r)}},Du={type:i.CommandType.COMMAND,id:"sheet.command.set-overline",handler:s=>{const e=s.get(g.SheetsSelectionsService).getCurrentLastSelection();if(!e)return!1;const t=P(s.get(i.IUniverInstanceService));if(!t)return!1;const{worksheet:n}=t;let o=!0;e.primary&&(o=!!n.getRange(e.primary.startRow,e.primary.startColumn).getOverline().s);const r={style:{type:"ol",value:{s:o?i.BooleanNumber.FALSE:i.BooleanNumber.TRUE}}};return s.get(i.ICommandService).syncExecuteCommand(ee.id,r)}},Au={type:i.CommandType.COMMAND,id:"sheet.command.set-font-family",handler:(s,e)=>{if(!e)return!1;const t=s.get(i.ICommandService),n={style:{type:"ff",value:e.value}};return t.syncExecuteCommand(ee.id,n)}},Wu={type:i.CommandType.COMMAND,id:"sheet.command.set-font-size",handler:(s,e)=>{if(!e)return!1;const t=s.get(i.ICommandService),n={style:{type:"fs",value:e.value}};return t.syncExecuteCommand(ee.id,n)}},ti={type:i.CommandType.COMMAND,id:"sheet.command.set-text-color",handler:(s,e)=>{if(!e)return!1;const t=s.get(i.ICommandService),n={style:{type:"cl",value:{rgb:e.value}}};return t.syncExecuteCommand(ee.id,n)}},ni={type:i.CommandType.COMMAND,id:"sheet.command.reset-text-color",handler:s=>{const e=s.get(i.ICommandService),t={style:{type:"cl",value:{rgb:null}}};return e.syncExecuteCommand(ee.id,t)}},si={type:i.CommandType.COMMAND,id:"sheet.command.set-background-color",handler:(s,e)=>{if(!e||!e.value)return!1;const t=s.get(i.ICommandService),n={style:{type:"bg",value:{rgb:e.value}}};return t.syncExecuteCommand(ee.id,n)}},oi={type:i.CommandType.COMMAND,id:"sheet.command.reset-background-color",handler:s=>{const e=s.get(i.ICommandService),t={style:{type:"bg",value:{rgb:null}}};return e.syncExecuteCommand(ee.id,t)}},ri={type:i.CommandType.COMMAND,id:"sheet.command.set-vertical-text-align",handler:(s,e)=>{if(!e)return!1;const t=s.get(i.ICommandService),n={unitId:e.unitId,subUnitId:e.subUnitId,range:e.range,style:{type:"vt",value:e.value}};return t.syncExecuteCommand(ee.id,n)}},ii={type:i.CommandType.COMMAND,id:"sheet.command.set-horizontal-text-align",handler:(s,e)=>{if(!e)return!1;const t=s.get(i.ICommandService),n={unitId:e.unitId,subUnitId:e.subUnitId,range:e.range,style:{type:"ht",value:e.value}};return t.syncExecuteCommand(ee.id,n)}},ai={type:i.CommandType.COMMAND,id:"sheet.command.set-text-wrap",handler:(s,e)=>{if(!e)return!1;const t=s.get(i.ICommandService),n={unitId:e.unitId,subUnitId:e.subUnitId,range:e.range,style:{type:"tb",value:e.value}};return t.syncExecuteCommand(ee.id,n)}},li={type:i.CommandType.COMMAND,id:"sheet.command.set-text-rotation",handler:(s,e)=>{if(!e)return!1;const t=typeof e.value=="number"?{a:e.value}:{a:0,v:i.BooleanNumber.TRUE},n=s.get(i.ICommandService),o={unitId:e.unitId,subUnitId:e.subUnitId,range:e.range,style:{type:"tr",value:t}};return n.syncExecuteCommand(ee.id,o)}},Vu=(s,e)=>{const r=s.get(i.IUniverInstanceService).getUniverSheetInstance(e.unitId).getSheetBySheetId(e.subUnitId).getConfig().tabColor;return{...i.Tools.deepClone(e),color:r}},zt={id:"sheet.mutation.set-tab-color",type:i.CommandType.MUTATION,handler:(s,e)=>{const t=s.get(i.IUniverInstanceService).getUniverSheetInstance(e.unitId);if(!t)return!1;const n=t.getSheetBySheetId(e.subUnitId);return n?(n.getConfig().tabColor=e.color,!0):!1}},ui={type:i.CommandType.COMMAND,id:"sheet.command.set-tab-color",handler:(s,e)=>{const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),o=P(s.get(i.IUniverInstanceService));if(!o)return!1;const{unitId:r,subUnitId:a}=o,l={color:e.value,unitId:r,subUnitId:a},u=Vu(s,l);return t.syncExecuteCommand(zt.id,l)?(n.pushUndoRedo({unitID:r,undoMutations:[{id:zt.id,params:u}],redoMutations:[{id:zt.id,params:l}]}),!0):!1}},Fs={id:"sheet.mutation.set-workbook-name",type:i.CommandType.MUTATION,handler:(s,e)=>{const t=s.get(i.IUniverInstanceService).getUnit(e.unitId,i.UniverInstanceType.UNIVER_SHEET);return t?(t.setName(e.name),!0):!1}},js={type:i.CommandType.COMMAND,id:"sheet.command.set-workbook-name",handler:(s,e)=>{var u;const t=s.get(i.ICommandService),n=s.get(g.SheetInterceptorService);if(!Hn(s.get(i.IUniverInstanceService),e))return!1;const r=n.onCommandExecute({id:js.id,params:e}),a={name:e.name,unitId:e.unitId},l=[...(u=r.preRedos)!=null?u:[],{id:Fs.id,params:a},...r.redos];return i.sequenceExecute(l,t).result}},$u=4,Gs={type:i.CommandType.COMMAND,id:"sheet.command.set-worksheet-activate",handler:(s,e,t)=>{const n=s.get(i.ICommandService),o=P(s.get(i.IUniverInstanceService),e);if(!o)return!1;const{unitId:r,subUnitId:a}=o;return new Promise(l=>{setTimeout(()=>{const u=n.syncExecuteCommand(St.id,{unitId:r,subUnitId:a},t);l(u)},$u)})}},qt={type:i.CommandType.COMMAND,id:"sheet.command.delta-column-width",handler:async(s,e)=>{const n=s.get(g.SheetsSelectionsService).getCurrentSelections();if(!(n!=null&&n.length))return!1;const o=s.get(i.ICommandService),r=s.get(i.IUndoRedoService),a=P(s.get(i.IUniverInstanceService));if(!a)return!1;const{worksheet:l,unitId:u,subUnitId:d}=a,{anchorCol:c,deltaX:m}=e,R=l.getColumnWidth(c)+m,C=n.length===1&&n[0].range.rangeType===i.RANGE_TYPE.ALL,S=n.filter(L=>L.range.rangeType===i.RANGE_TYPE.COLUMN),I=C?i.RANGE_TYPE.ALL:S.some(({range:L})=>{const{startColumn:Y,endColumn:z}=L;return Y<=c&&c<=z})?i.RANGE_TYPE.COLUMN:i.RANGE_TYPE.NORMAL;let v;if(I===i.RANGE_TYPE.ALL){const L=l.getRowCount(),Y=new Array(l.getColumnCount()).fill(void 0).map((z,K)=>({startRow:0,endRow:L-1,startColumn:K,endColumn:K}));v={subUnitId:d,unitId:u,colWidth:R,ranges:Y}}else I===i.RANGE_TYPE.COLUMN?v={subUnitId:d,unitId:u,ranges:S.map(L=>i.Rectangle.clone(L.range)),colWidth:R}:v={subUnitId:d,unitId:u,colWidth:R,ranges:[{startRow:0,endRow:l.getMaxRows()-1,startColumn:c,endColumn:c}]};const M=s.get(g.SheetSkeletonService).getSkeleton(u,d),{suitableRanges:p,remainingRanges:w}=Ht(v.ranges,M);bs(p,l);const y=s.get(g.SheetInterceptorService),{undos:b,redos:E}=y.onCommandExecute({id:qt.id,params:v}),U=Fn(v,l),k=o.syncExecuteCommand(Ve.id,v),{undos:T,redos:N}=y.generateMutationsOfAutoHeight({unitId:u,subUnitId:d,ranges:p,autoHeightRanges:p,lazyAutoHeightRanges:w}),{undos:W,redos:V}=s.get(g.SheetInterceptorService).afterCommandExecute({id:qt.id,params:v}),$=i.sequenceExecute([...E,...V,...N],o);return k&&$.result&&r.pushUndoRedo({unitID:u,undoMutations:[{id:Ve.id,params:U},...b,...W,...T],redoMutations:[{id:Ve.id,params:v},...E,...V,...N]}),!0}},Yt={type:i.CommandType.COMMAND,id:"sheet.command.set-worksheet-col-width",handler:(s,e)=>{var y,b,E,U;const t=s.get(g.SheetsSelectionsService),n=s.get(i.ICommandService),o=s.get(i.IUndoRedoService),r=s.get(g.SheetInterceptorService),a=(y=e==null?void 0:e.ranges)!=null&&y.length?e.ranges:(b=t.getCurrentSelections())==null?void 0:b.map(k=>k.range);if(!(a!=null&&a.length))return!1;const l=P(s.get(i.IUniverInstanceService),e);if(!l)return!1;const{subUnitId:u,unitId:d,worksheet:c}=l,m=s.get(g.SheetSkeletonService).getSkeleton(d,u),h={subUnitId:u,unitId:d,ranges:a,colWidth:e.value},{suitableRanges:R,remainingRanges:C}=Ht(h.ranges,m);bs(R,c);const S=Fn(h,c),I=n.syncExecuteCommand(Ve.id,h),{undos:v,redos:M}=r.generateMutationsOfAutoHeight({unitId:d,subUnitId:u,ranges:R,autoHeightRanges:R,lazyAutoHeightRanges:C}),p=r.onCommandExecute({id:Yt.id,params:h}),w=i.sequenceExecute([...p.redos,...M],n);if(I&&w.result){const k=r.afterCommandExecute({id:Yt.id,params:h});return i.sequenceExecute(k.redos,n),o.pushUndoRedo({unitID:d,undoMutations:[...(E=p.preUndos)!=null?E:[],{id:Ve.id,params:S},...p.undos,...k.undos,...v],redoMutations:[...(U=p.preRedos)!=null?U:[],{id:Ve.id,params:h},...p.redos,...k.redos,...M]}),!0}return!1}};i.CommandType.COMMAND;const di={type:i.CommandType.COMMAND,id:"sheet.command.set-worksheet-column-count",handler:(s,e)=>{const{unitId:t,subUnitId:n,columnCount:o}=e,r=s.get(i.ICommandService),a=s.get(i.IUndoRedoService),l=s.get(i.IUniverInstanceService);if(!P(l,e))return!1;const d={unitId:t,subUnitId:n,columnCount:o},c=fo(s,d);return r.syncExecuteCommand(ht.id,d)?(a.pushUndoRedo({unitID:t,undoMutations:[{id:ht.id,params:c}],redoMutations:[{id:ht.id,params:d}]}),!0):!1}},ci={type:i.CommandType.COMMAND,id:"sheet.command.set-worksheet-default-style",handler:(s,e)=>{const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),{unitId:o}=e,r=Io(s,e);return t.syncExecuteCommand(gt.id,e)?(n.pushUndoRedo({unitID:o,undoMutations:[{id:gt.id,params:r}],redoMutations:[{id:gt.id,params:e}]}),!0):!1}},mi=(s,e)=>{const t=ve(s.get(i.IUniverInstanceService),e);if(!t)throw new Error("[SetWorksheetHideMutationFactory]: worksheet is null error!");const{worksheet:n}=t;return{hidden:n.isSheetHidden(),unitId:e.unitId,subUnitId:n.getSheetId()}},Ge={id:"sheet.mutation.set-worksheet-hidden",type:i.CommandType.MUTATION,handler:(s,e)=>{const t=s.get(i.IUniverInstanceService).getUniverSheetInstance(e.unitId);if(t==null)return!1;const n=t.getSheetBySheetId(e.subUnitId);return n?(n.getConfig().hidden=e.hidden,!0):!1}},hi={type:i.CommandType.COMMAND,id:"sheet.command.set-worksheet-hidden",handler:(s,e)=>{const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),o=s.get(i.ErrorService),r=s.get(i.LocaleService),a=P(s.get(i.IUniverInstanceService),e);if(!a)return!1;const{workbook:l,worksheet:u,unitId:d,subUnitId:c}=a;if(u.getConfig().hidden===i.BooleanNumber.TRUE)return!1;const h={unitId:d,subUnitId:c,hidden:i.BooleanNumber.TRUE},R=mi(s,h);return l.getSheets().filter(v=>v.getConfig().hidden===i.BooleanNumber.FALSE).length===1?(o.emit(r.t("sheets.info.hideSheet")),!1):t.syncExecuteCommand(Ge.id,h)?(n.pushUndoRedo({unitID:d,undoMutations:[{id:Ge.id,params:R}],redoMutations:[{id:Ge.id,params:h}]}),!0):!1}},Lu=(s,e)=>{const t=ve(s.get(i.IUniverInstanceService),e);if(!t)throw new Error("[SetWorksheetNameMutationFactory]: worksheet is null error!");const{worksheet:n}=t;return{unitId:e.unitId,name:n.getName(),subUnitId:n.getSheetId()}},Kt={id:"sheet.mutation.set-worksheet-name",type:i.CommandType.MUTATION,handler:(s,e)=>{const t=s.get(i.IUniverInstanceService).getUniverSheetInstance(e.unitId);if(t==null)return!1;const n=t.getSheetBySheetId(e.subUnitId);return n?(n.getConfig().name=e.name,!0):!1}},_n={type:i.CommandType.COMMAND,id:"sheet.command.set-worksheet-name",handler:(s,e)=>{var C,S;const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),o=s.get(g.SheetInterceptorService),r=P(s.get(i.IUniverInstanceService),e);if(!r)return!1;const{unitId:a,subUnitId:l}=r,u={subUnitId:l,name:e.name,unitId:a},d=Lu(s,u),c=o.onCommandExecute({id:_n.id,params:e}),m=[...(C=c.preRedos)!=null?C:[],{id:Kt.id,params:u},...c.redos],h=[...(S=c.preUndos)!=null?S:[],{id:Kt.id,params:d},...c.undos];return i.sequenceExecute(m,t).result?(n.pushUndoRedo({unitID:a,undoMutations:h,redoMutations:m}),!0):!1}},Bu=(s,e)=>({...i.Tools.deepClone(e),toOrder:e.fromOrder,fromOrder:e.toOrder}),Jt={id:"sheet.mutation.set-worksheet-order",type:i.CommandType.MUTATION,handler:(s,e)=>{const t=s.get(i.IUniverInstanceService).getUniverSheetInstance(e.unitId);if(!t)return!1;const n=t.getConfig();return n.sheetOrder.splice(e.fromOrder,1),n.sheetOrder.splice(e.toOrder,0,e.subUnitId),t.ensureSheetOrderUnique(),!0}},zs={type:i.CommandType.COMMAND,id:"sheet.command.set-worksheet-order",handler:(s,e)=>{const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),o=P(s.get(i.IUniverInstanceService),e);if(!o)return!1;const{workbook:r,unitId:a,subUnitId:l}=o,d={fromOrder:r.getConfig().sheetOrder.indexOf(l),toOrder:e.order,unitId:a,subUnitId:l},c=Bu(s,d);return t.syncExecuteCommand(Jt.id,d)?(n.pushUndoRedo({unitID:a,undoMutations:[{id:Jt.id,params:c}],redoMutations:[{id:Jt.id,params:d}]}),!0):!1}};class kt{constructor(){f(this,"_model",new Map);f(this,"_pointChange",new O.Subject);f(this,"pointChange$",this._pointChange.asObservable())}addRule(e){this._ensureSubUnitMap(e.unitId).set(e.subUnitId,e),this._pointChange.next(e)}deleteRule(e,t){var o,r,a;const n=(o=this._model.get(e))==null?void 0:o.get(t);n&&((a=(r=this._model)==null?void 0:r.get(e))==null||a.delete(t),this._pointChange.next(n))}getRule(e,t){var n,o;return(o=(n=this._model)==null?void 0:n.get(e))==null?void 0:o.get(t)}toObject(){const e={};return[...this._model.keys()].forEach(n=>{const o=this._model.get(n);o!=null&&o.size&&(e[n]=[],[...o.keys()].forEach(a=>{const l=o.get(a);l&&e[n].push(l)}))}),e}fromObject(e){const t=new Map;Object.keys(e).forEach(n=>{const o=e[n];if(o!=null&&o.length){const r=new Map;o.forEach(a=>{r.set(a.subUnitId,a)}),t.set(n,r)}}),this._model=t}deleteUnitModel(e){this._model.delete(e)}_ensureSubUnitMap(e){let t=this._model.get(e);return t||(t=new Map,this._model.set(e,t)),t}getTargetByPermissionId(e,t){const n=this._model.get(e);if(!n)return null;for(const[o,r]of n)if(r.permissionId===t)return[e,o]}}class qs{constructor(e,t,n){f(this,"type",D.SelectRange);f(this,"subType",_.Delete);f(this,"status",i.PermissionStatus.INIT);f(this,"value",!0);f(this,"id");f(this,"unitId");f(this,"subUnitId");f(this,"permissionId");this.unitId=e,this.subUnitId=t,this.permissionId=n,this.id=`${D.SelectRange}.${_.Delete}.${n}`}}class Ys{constructor(e,t,n){f(this,"type",D.SelectRange);f(this,"subType",_.ManageCollaborator);f(this,"status",i.PermissionStatus.INIT);f(this,"value",!0);f(this,"id");f(this,"unitId");f(this,"subUnitId");f(this,"permissionId");this.unitId=e,this.subUnitId=t,this.permissionId=n,this.id=`${D.SelectRange}.${_.ManageCollaborator}.${n}`}}const ue=()=>[un,Se,Ys,qs],ze=[_.Edit,_.View,_.ManageCollaborator,_.Delete],Hu=(s="unitId",e="subUnitId",t="permissionId")=>ue().reduce((n,o)=>{const r=new o(s,e,t);return n[r.subType]=r.value,n},{}),Pt=()=>[me,ts,Kn,os,Jn,es,cn,Xn,Zn,hn,dn,Qn,ss,mn,jo,rs,ns,xn,Ko,Yo,zo,Go],gi=[_.Edit,_.Print,_.Comment,_.View,_.Copy,_.Export,_.ManageCollaborator,_.CreateSheet,_.DeleteSheet,_.RenameSheet,_.HideSheet,_.Duplicate,_.Share,_.MoveSheet,_.CopySheet,_.RecoverHistory,_.ViewHistory,_.CreatePermissionObject,_.InsertRow,_.InsertColumn,_.DeleteRow,_.DeleteColumn],de=()=>[fe,$t,Rs,ls],Ie=()=>[is,as,us,ds,cs,ms,gs,hs,Cs,Ss,Vt,ft,It,fs],bn=[_.Copy,_.DeleteColumn,_.DeleteRow,_.EditExtraObject,_.Filter,_.InsertColumn,_.InsertRow,_.InsertHyperlink,_.PivotTable,_.SetCellStyle,_.SetCellValue,_.SetColumnStyle,_.SetRowStyle,_.Sort];var Fu=Object.getOwnPropertyDescriptor,ju=(s,e,t,n)=>{for(var o=n>1?void 0:n?Fu(e,t):e,r=s.length-1,a;r>=0;r--)(a=s[r])&&(o=a(o)||o);return o},qe=(s,e)=>(t,n)=>e(t,n,s);const Gu="SHEET_WORKSHEET_PROTECTION_PLUGIN",zu="SHEET_WORKSHEET_PROTECTION_POINT_PLUGIN";g.WorksheetPermissionService=class extends i.RxDisposable{constructor(e,t,n,o,r,a,l,u){super(),this._permissionService=e,this._univerInstanceService=t,this._injector=n,this._worksheetProtectionRuleModel=o,this._worksheetProtectionPointRuleModel=r,this._resourceManagerService=a,this._rangeProtectionRuleModel=l,this._logService=u,this._init(),this._initRuleChange(),this._initRuleSnapshot(),this._initPointSnapshot()}_init(){const e=t=>{const n=t.getUnitId(),o=r=>{const a=r.getSheetId();[...de(),...Ie()].forEach(l=>{const u=new l(n,a);this._permissionService.addPermissionPoint(u)}),this._logService.debug("[WorksheetPermissionService]","Initialization completed",n,a)};t.getSheets().forEach(r=>{o(r)}),t.sheetCreated$.subscribe(r=>{o(r)}),t.sheetDisposed$.subscribe(r=>{const a=r.getSheetId();this._rangeProtectionRuleModel.getSubunitRuleList(n,a).forEach(u=>{[...ue()].forEach(d=>{const c=new d(n,a,u.permissionId);this._permissionService.deletePermissionPoint(c.id)})}),[...de(),...Ie()].forEach(u=>{const d=new u(n,a);this._permissionService.deletePermissionPoint(d.id)})})};this._univerInstanceService.getAllUnitsForType(i.UniverInstanceType.UNIVER_SHEET).forEach(t=>{e(t)}),this._univerInstanceService.getTypeOfUnitAdded$(i.UniverInstanceType.UNIVER_SHEET).pipe(Nt.takeUntil(this.dispose$)).subscribe(e),this._univerInstanceService.getTypeOfUnitDisposed$(i.UniverInstanceType.UNIVER_SHEET).pipe(Nt.takeUntil(this.dispose$)).subscribe(t=>{t.getSheets().forEach(n=>{const o=t.getUnitId(),r=n.getSheetId();de().forEach(a=>{const l=new a(o,r);this._permissionService.deletePermissionPoint(l.id)})})})}_initRuleChange(){this.disposeWithMe(this._worksheetProtectionRuleModel.ruleChange$.subscribe(e=>{switch(e.type){case"add":break;case"delete":{de().forEach(t=>{const n=new t(e.unitId,e.subUnitId);this._permissionService.updatePermissionPoint(n.id,!0)});break}case"set":{de().forEach(t=>{const n=new t(e.unitId,e.subUnitId);this._permissionService.updatePermissionPoint(n.id,e.rule)});break}}}))}_initRuleSnapshot(){const e=()=>{const n=this._worksheetProtectionRuleModel.toObject();return JSON.stringify(n)},t=n=>{if(!n)return{};try{return JSON.parse(n)}catch{return{}}};this.disposeWithMe(this._resourceManagerService.registerPluginResource({toJson:e,parseJson:t,pluginName:Gu,businesses:[ln.UNIVER_SHEET],onLoad:(n,o)=>{this._worksheetProtectionRuleModel.fromObject(o),Object.keys(o).forEach(r=>{de().forEach(a=>{const l=new a(n,r);l.value=!1,this._permissionService.addPermissionPoint(l)})}),this._worksheetProtectionRuleModel.changeRuleInitState(!0)},onUnLoad:n=>{const o=this._univerInstanceService.getUnit(n);o&&(o.getSheets().forEach(r=>{const a=r.getSheetId();[...de(),...Ie()].forEach(l=>{const u=new l(n,a);this._permissionService.deletePermissionPoint(u.id)})}),Pt().forEach(r=>{const a=new r(n);this._permissionService.deletePermissionPoint(a.id)})),this._worksheetProtectionRuleModel.deleteUnitModel(n)}}))}_initPointSnapshot(){const e=()=>{const n=this._worksheetProtectionPointRuleModel.toObject();return JSON.stringify(n)},t=n=>{if(!n)return{};try{return JSON.parse(n)}catch{return{}}};this.disposeWithMe(this._resourceManagerService.registerPluginResource({toJson:e,parseJson:t,pluginName:zu,businesses:[ln.UNIVER_SHEET],onLoad:(n,o)=>{this._worksheetProtectionPointRuleModel.fromObject(o),Object.keys(o).forEach(r=>{Ie().forEach(a=>{const l=new a(n,r);this._permissionService.addPermissionPoint(l)})})},onUnLoad:n=>{this._worksheetProtectionPointRuleModel.deleteUnitModel(n)}}))}},g.WorksheetPermissionService=ju([qe(0,i.Inject(i.IPermissionService)),qe(1,i.Inject(i.IUniverInstanceService)),qe(2,i.Inject(i.Injector)),qe(3,i.Inject(Pe)),qe(4,i.Inject(kt)),qe(5,i.Inject(i.IResourceManagerService)),qe(6,i.Inject(X)),qe(7,i.Inject(i.ILogService))],g.WorksheetPermissionService);const En={id:"sheet.mutation.set-worksheet-permission-points",type:i.CommandType.MUTATION,handler:(s,e)=>{const{rule:t}=e;return s.get(kt).addRule(t),!0}},Ri={type:i.CommandType.COMMAND,id:"sheet.command.set-worksheet-permission-points",async handler(s,e){if(!e)return!1;const t=s.get(i.ICommandService),{rule:n}=e;return t.executeCommand(En.id,{rule:n,unitId:n.unitId,subUnitId:n.subUnitId}),!0}},Ci={type:i.CommandType.COMMAND,id:"sheet.command.set-worksheet-protection",async handler(s,e){if(!e)return!1;const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),{rule:o,permissionId:r,oldRule:a}=e,{unitId:l,subUnitId:u}=o,d={...o,permissionId:r};if(await t.executeCommand(ot.id,{unitId:l,subUnitId:u,newRule:d})){const m=[{id:ot.id,params:{unitId:l,subUnitId:u,newRule:d}}],h=[{id:ot.id,params:{unitId:l,subUnitId:u,rule:a}}];n.pushUndoRedo({unitID:l,redoMutations:m,undoMutations:h})}return!0}},qu=(s,e)=>{const r=s.get(i.IUniverInstanceService).getUniverSheetInstance(e.unitId).getSheetBySheetId(e.subUnitId).getConfig().rightToLeft;return{...i.Tools.deepClone(e),rightToLeft:r}},Tn={id:"sheet.mutation.set-worksheet-right-to-left",type:i.CommandType.MUTATION,handler:(s,e)=>{const t=s.get(i.IUniverInstanceService).getUniverSheetInstance(e.unitId);if(!t)return!1;const n=t.getSheetBySheetId(e.subUnitId);if(!n)return!1;const o=n.getConfig();return o.rightToLeft=e.rightToLeft,!0}},Yu={type:i.CommandType.COMMAND,id:"sheet.command.set-worksheet-right-to-left",handler:async(s,e)=>{var m;const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),o=P(s.get(i.IUniverInstanceService),e);if(!o)return!1;const{unitId:r,subUnitId:a}=o;let l=i.BooleanNumber.FALSE;e&&(l=(m=e.rightToLeft)!=null?m:i.BooleanNumber.FALSE);const u={rightToLeft:l,unitId:r,subUnitId:a},d=qu(s,u);return t.syncExecuteCommand(Tn.id,u)?(n.pushUndoRedo({unitID:r,undoMutations:[{id:Tn.id,params:d}],redoMutations:[{id:Tn.id,params:u}]}),!0):!1}},Si={type:i.CommandType.COMMAND,id:"sheet.command.set-worksheet-row-count",handler:(s,e)=>{const{unitId:t,subUnitId:n,rowCount:o}=e,r=s.get(i.ICommandService),a=s.get(i.IUndoRedoService),l=s.get(i.IUniverInstanceService);if(!P(l,e))return!1;const d={unitId:t,subUnitId:n,rowCount:o},c=vo(s,d);return r.syncExecuteCommand(Rt.id,d)?(a.pushUndoRedo({unitID:t,undoMutations:[{id:Rt.id,params:c}],redoMutations:[{id:Rt.id,params:d}]}),!0):!1}},xt={type:i.CommandType.COMMAND,id:"sheet.command.delta-row-height",handler:async(s,e)=>{var k,T;const n=s.get(g.SheetsSelectionsService).getCurrentSelections(),o=s.get(g.SheetInterceptorService);if(!(n!=null&&n.length))return!1;const r=P(s.get(i.IUniverInstanceService));if(!r)return!1;const{worksheet:a,subUnitId:l,unitId:u}=r,{anchorRow:d,deltaY:c}=e,h=a.getRowHeight(d)+c,R=n.length===1&&n[0].range.rangeType===i.RANGE_TYPE.ALL,C=n.filter(N=>N.range.rangeType===i.RANGE_TYPE.ROW),S=R?i.RANGE_TYPE.ALL:C.some(({range:N})=>{const{startRow:W,endRow:V}=N;return W<=d&&d<=V})?i.RANGE_TYPE.ROW:i.RANGE_TYPE.NORMAL;let I;if(S===i.RANGE_TYPE.ALL){const N=a.getColumnCount(),W=new Array(a.getRowCount()).fill(void 0).map((V,$)=>({startRow:$,endRow:$,startColumn:0,endColumn:N-1}));I={subUnitId:l,unitId:u,rowHeight:h,ranges:W}}else S===i.RANGE_TYPE.ROW?I={subUnitId:l,unitId:u,ranges:C.map(N=>i.Rectangle.clone(N.range)),rowHeight:h}:I={subUnitId:l,unitId:u,rowHeight:h,ranges:[{startRow:d,endRow:d,startColumn:0,endColumn:a.getMaxColumns()-1}]};const v=po(I,a),M={unitId:u,subUnitId:l,ranges:I.ranges,autoHeightInfo:i.BooleanNumber.FALSE},p=jn(M,a),w=s.get(i.ICommandService),y=s.get(i.IUndoRedoService),b=o.onCommandExecute({id:xt.id,params:I}),E=i.sequenceExecute([{id:Ee.id,params:I},{id:Re.id,params:M}],w),U=i.sequenceExecute([...b.redos],w);if(E.result&&U.result){const N=o.afterCommandExecute({id:xt.id,params:I});return i.sequenceExecute(N.redos,w),y.pushUndoRedo({unitID:u,undoMutations:[...(k=b.preUndos)!=null?k:[],{id:Ee.id,params:v},{id:Re.id,params:p},...b.undos,...N.undos],redoMutations:[...(T=b.preRedos)!=null?T:[],{id:Ee.id,params:I},{id:Re.id,params:M},...b.redos,...N.redos]}),!0}return!1}},Xt={type:i.CommandType.COMMAND,id:"sheet.command.set-row-height",handler:(s,e)=>{var p,w,y,b;const t=s.get(g.SheetsSelectionsService),n=s.get(i.ICommandService),o=s.get(i.IUndoRedoService),r=s.get(i.IUniverInstanceService),a=s.get(g.SheetInterceptorService),l=(p=e==null?void 0:e.ranges)!=null&&p.length?e.ranges:(w=t.getCurrentSelections())==null?void 0:w.map(E=>E.range);if(!(l!=null&&l.length))return!1;const u=P(r,e);if(!u)return!1;const{unitId:d,subUnitId:c,worksheet:m}=u,h={subUnitId:c,unitId:d,ranges:l,rowHeight:e.value},R=po(h,m),C={unitId:d,subUnitId:c,ranges:h.ranges,autoHeightInfo:i.BooleanNumber.FALSE},S=jn(C,m),I=i.sequenceExecute([{id:Ee.id,params:h},{id:Re.id,params:C}],n),v=a.onCommandExecute({id:Xt.id,params:h}),M=i.sequenceExecute([...v.redos],n);if(I.result&&M.result){const E=a.afterCommandExecute({id:Xt.id,params:h});return i.sequenceExecute(E.redos,n),o.pushUndoRedo({unitID:d,undoMutations:[...(y=v.preRedos)!=null?y:[],{id:Ee.id,params:R},{id:Re.id,params:S},...v.undos,...E.undos],redoMutations:[...(b=v.preRedos)!=null?b:[],{id:Ee.id,params:h},{id:Re.id,params:C},...v.redos,...E.redos]}),!0}return!1}},Un={type:i.CommandType.COMMAND,id:"sheet.command.set-row-is-auto-height",handler:(s,e)=>{var E,U;const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),o=s.get(g.SheetsSelectionsService),r=s.get(i.IUniverInstanceService),a=P(r,e);if(!a)return!1;const{unitId:l,subUnitId:u,worksheet:d}=a,c=(E=e==null?void 0:e.ranges)!=null&&E.length?e.ranges:(U=o.getCurrentSelections())==null?void 0:U.map(k=>k.range);if(!(c!=null&&c.length))return!1;const m={unitId:l,subUnitId:u,ranges:c,autoHeightInfo:i.BooleanNumber.TRUE},h=jn(m,d),R=t.syncExecuteCommand(Re.id,m),C=s.get(g.SheetSkeletonService).getSkeleton(l,u),{suitableRanges:S,remainingRanges:I}=Ht(m.ranges,C),v=s.get(g.SheetInterceptorService),{undos:M,redos:p}=v.generateMutationsOfAutoHeight({unitId:l,subUnitId:u,ranges:S,autoHeightRanges:S,lazyAutoHeightRanges:I}),{undos:w,redos:y}=v.onCommandExecute({id:Un.id,params:m}),b=i.sequenceExecute([...y,...p],t);return R&&b.result?(n.pushUndoRedo({unitID:l,undoMutations:[{id:Re.id,params:h},...w,...M],redoMutations:[{id:Re.id,params:m},...y,...p]}),!0):!1}},Ks={type:i.CommandType.COMMAND,id:"sheet.command.set-worksheet-show",handler:(s,e)=>{const{unitId:t,subUnitId:n}=e,o=s.get(i.ICommandService),r=s.get(i.IUndoRedoService),a=s.get(i.IUniverInstanceService);if(!P(s.get(i.IUniverInstanceService)))return!1;const u=a.getCurrentUnitForType(i.UniverInstanceType.UNIVER_SHEET);if(!u)return!1;const d=u.getSheetBySheetId(n);if(!d||d.getConfig().hidden===i.BooleanNumber.FALSE)return!1;const m={unitId:t,subUnitId:n,hidden:i.BooleanNumber.FALSE},h=mi(s,m),R=o.syncExecuteCommand(Ge.id,m),C={unitId:t,subUnitId:n},S=o.syncExecuteCommand(St.id,C);return R&&S?(r.pushUndoRedo({unitID:t,undoMutations:[{id:Ge.id,params:h}],redoMutations:[{id:Ge.id,params:m}]}),!0):!1}},fi={type:i.CommandType.COMMAND,id:"sheet.command.split-text-to-columns",handler:(s,e)=>{const{unitId:t,subUnitId:n,range:o,delimiter:r,customDelimiter:a,treatMultipleDelimitersAsOne:l}=e,u=s.get(i.ICommandService),d=s.get(i.IUniverInstanceService),c=s.get(i.IUndoRedoService);if(!P(s.get(i.IUniverInstanceService)))return!1;const h=d.getCurrentUnitForType(i.UniverInstanceType.UNIVER_SHEET);if(!h)return!1;const R=h.getSheetBySheetId(n);if(!R)return!1;const{lastRow:C,rs:S,maxLength:I}=ko(R,o,r,a,l),v=R.getColumnCount(),{startColumn:M}=i.Range.transformRange(o,R);if(o.startColumn!==o.endColumn)return!1;const p=[],w=[],y=M+I+1-v;if(y>0){const N={unitId:t,subUnitId:n,range:{startRow:0,endRow:R.getRowCount()-1,startColumn:v-1,endColumn:v-1+y}};p.push({id:ie.id,params:N});const W=Ot(s,N);w.push({id:ne.id,params:W})}const b={startRow:o.startRow,endRow:C,startColumn:M,endColumn:M+I},E=new i.ObjectMatrix;for(let N=b.startRow;N<=b.endRow;N++)for(let W=b.startColumn;W<=b.endColumn;W++){const V=S[N-b.startRow];W===0&&(V==null?void 0:V.length)===1?E.setValue(N,W,R.getCell(N,W)):E.setValue(N,W,{v:(V==null?void 0:V[W-b.startColumn])||null,p:null,f:null,si:null,custom:null})}const U={unitId:t,subUnitId:n,cellValue:E.clone()},k=ce(s,U);return p.push({id:F.id,params:U}),w.unshift({id:F.id,params:k}),i.sequenceExecute(p,u).result?(c.pushUndoRedo({unitID:t,undoMutations:w,redoMutations:p}),!0):!1}},Ii={id:"sheet.command.toggle-cell-checkbox",type:i.CommandType.COMMAND,handler:(s,e)=>{if(!e)return!1;const{unitId:t,subUnitId:n,row:o,col:r,paragraphIndex:a}=e,u=s.get(i.IUniverInstanceService).getUnit(t,i.UniverInstanceType.UNIVER_SHEET),d=u==null?void 0:u.getSheetBySheetId(n),c=s.get(i.IUndoRedoService),m=s.get(i.ICommandService);if(!d)return!1;const h=d.getCell(o,r);if(!(h!=null&&h.p))return!1;const R=i.Tools.deepClone(h.p),C=new i.DocumentDataModel(R),S=i.BuildTextUtils.paragraph.bullet.toggleChecklist({document:C,paragraphIndex:a});if(!S)return!1;i.TextX.apply(C.getBody(),S.serialize());const I={unitId:t,subUnitId:n,cellValue:{[o]:{[r]:{p:R,t:i.CellValueType.STRING}}}},v={id:F.id,params:I},M=ce(s,I),p={id:F.id,params:M},w=[v],y=[p];return c.pushUndoRedo({redoMutations:w,undoMutations:y,unitID:t}),m.syncExecuteCommand(v.id,v.params)}},vi={type:i.CommandType.COMMAND,id:"sheet.command.toggle-gridlines",handler:(s,e)=>{const t=s.get(i.ICommandService),n=s.get(i.IUndoRedoService),o=s.get(i.IUniverInstanceService),r=P(o);if(!r)return!1;const{worksheet:a}=r,l=a.getConfig().showGridlines;if(l===(e==null?void 0:e.showGridlines))return!1;const{unitId:u,subUnitId:d}=r,c={showGridlines:l===i.BooleanNumber.TRUE?i.BooleanNumber.FALSE:i.BooleanNumber.TRUE,unitId:u,subUnitId:d},m={showGridlines:l,unitId:u,subUnitId:d};return t.syncExecuteCommand(Ct.id,c)?(n.pushUndoRedo({unitID:u,undoMutations:[{id:Ct.id,params:m}],redoMutations:[{id:Ct.id,params:c}]}),!0):!1}},pi={id:"sheet.command.unregister-worksheet-range-theme-style",type:i.CommandType.COMMAND,handler:(s,e)=>{var h;if(!e)return!1;const{unitId:t,themeName:n}=e,o=s.get(i.IUniverInstanceService),r=s.get(i.ICommandService),a=s.get(i.IUndoRedoService),l=s.get(g.SheetRangeThemeModel);if(!P(o))return!1;const d={unitId:t,themeName:n},c={unitId:t,themeName:n,rangeThemeStyleJson:(h=l.getRangeThemeStyle(t,n))==null?void 0:h.toJson()};return r.syncExecuteCommand(bt.id,e)&&a.pushUndoRedo({unitID:t,undoMutations:[{id:bt.id,params:c}],redoMutations:[{id:vn.id,params:d}]}),!0}},wi={id:"sheet.mutation.add-range-theme",type:i.CommandType.MUTATION,handler:(s,e)=>{if(!e)return!1;const{styleJSON:t,unitId:n}=e,o=s.get(g.SheetRangeThemeModel),r=new We(t.name);return r.fromJson(t),o.registerRangeThemeStyle(n,r),!0}},Mi={id:"sheet.mutation.empty",type:i.CommandType.MUTATION,handler:()=>!0},yi={id:"sheet.operation.mark-dirty-row-auto-height",type:i.CommandType.OPERATION,handler:()=>!0},_i={id:"sheet.operation.cancel-mark-dirty-row-auto-height",type:i.CommandType.OPERATION,handler:()=>!0},rt=i.createIdentifier("INumfmtService"),Ku=(s,e)=>{const t=s.get(rt),{values:n,unitId:o,subUnitId:r}=e,a=[],l=[];Object.keys(n).forEach(d=>{n[d].ranges.forEach(m=>{i.Range.foreach(m,(h,R)=>{const C=t.getValue(o,r,h,R);C?a.push({pattern:C.pattern,row:h,col:R}):l.push({startColumn:R,endColumn:R,startRow:h,endRow:h})})})});const u=[];if(a.length){const d=Pn(o,r,a);Object.keys(d.values).forEach(c=>{const m=d.values[c];m.ranges=qn(m.ranges)}),u.push({id:kn.id,params:Pn(o,r,a)})}return l.length&&u.push({id:Js.id,params:{unitId:o,subUnitId:r,ranges:l}}),u},kn={id:"sheet.mutation.set.numfmt",type:i.CommandType.MUTATION,handler:(s,e)=>{if(!e)return!1;const{values:t,refMap:n}=e,o=s.get(rt),r=e.unitId,a=e.subUnitId,l=Object.keys(t).reduce((u,d)=>{const c=n[d],m=t[d].ranges;return c&&u.push({...c,ranges:m}),u},[]);return o.setValues(r,a,l),!0}},Js={id:"sheet.mutation.remove.numfmt",type:i.CommandType.MUTATION,handler:(s,e)=>{if(!e)return!1;const{unitId:t,subUnitId:n,ranges:o}=e;return s.get(rt).deleteValues(t,n,o),!0}},Ju=(s,e)=>{const t=s.get(rt),{ranges:n,unitId:o,subUnitId:r}=e,a=[];if(n.forEach(u=>{i.Range.foreach(u,(d,c)=>{const m=t.getValue(o,r,d,c);m&&a.push({pattern:m.pattern,row:d,col:c})})}),!a.length)return[];const l=Pn(o,r,a);return Object.keys(l.values).forEach(u=>{const d=l.values[u];d.ranges=qn(d.ranges)}),[{id:kn.id,params:l}]},Pn=(s,e,t)=>{const n=Qa(t,"pattern"),o={},r={},a=el();return Object.keys(n).forEach(l=>{const u=n[l],d=a();o[d]={pattern:l},u.forEach(c=>{r[d]||(r[d]={ranges:[]}),r[d].ranges.push(i.cellToRange(c.row,c.col))})}),{unitId:s,subUnitId:e,refMap:o,values:r}},bi={id:"sheet.mutation.remove-range-theme",type:i.CommandType.MUTATION,handler:(s,e)=>{if(!e)return!1;const{styleName:t,unitId:n}=e;return s.get(g.SheetRangeThemeModel).unregisterRangeThemeStyle(n,t),!0}},Ei={id:"sheet.mutation.set-range-theme",type:i.CommandType.MUTATION,handler:(s,e)=>{if(!e)return!1;const{unitId:t,styleName:n,style:o}=e,a=s.get(g.SheetRangeThemeModel).getRangeThemeStyle(t,n);return a&&(o.headerRowStyle&&a.setHeaderRowStyle(o.headerRowStyle),o.firstRowStyle&&a.setFirstRowStyle(o.firstRowStyle),o.secondRowStyle&&a.setSecondRowStyle(o.secondRowStyle),o.lastRowStyle&&a.setLastRowStyle(o.lastRowStyle)),!0}},Ti={id:"sheet.operation.scroll-to-cell",type:i.CommandType.OPERATION,handler:()=>!0},xu=(s,e,t)=>{const o=s.get(g.SheetsSelectionsService).getCurrentSelections(),{value:r,selections:a,unitId:l,subUnitId:u}=e;if(o){const c=o[(o==null?void 0:o.length)-1].primary;if(c){const{actualColumn:m,actualRow:h}=c;let{startRow:R,startColumn:C,endRow:S,endColumn:I}=a[a.length-1];if(r===i.Dimension.COLUMNS){const w=t.find(y=>y.startColumn===m&&y.endColumn===m&&h===y.startRow);w&&(I=w.endColumn,R=w.startRow,S=w.endRow)}else if(r===i.Dimension.ROWS){const w=t.find(y=>y.startRow===h&&y.endRow===h&&m===y.startColumn);w&&(S=w.endRow,C=w.startColumn,I=w.endColumn)}const v={startRow:R,startColumn:C,endRow:S,endColumn:I,actualRow:h,actualColumn:m,isMerged:!0,isMergedMainCell:R===h&&C===m},M=o.map((w,y,b)=>({range:w.range,style:null,primary:y===b.length-1?v:null})),p={unitId:l,subUnitId:u,type:te.ONLY_SET,selections:M};return{id:q.id,params:p}}return null}return null},Xu=(s,e)=>{const n=s.get(g.SheetsSelectionsService).getCurrentSelections(),{unitId:o,subUnitId:r}=e;if(n&&n[(n==null?void 0:n.length)-1].primary){const u={unitId:o,subUnitId:r,type:te.ONLY_SET,selections:[...n]};return{id:q.id,params:u}}return null},Ui="maxCellsPerSheet",Zu=3e6;var Qu=Object.getOwnPropertyDescriptor,ed=(s,e,t,n)=>{for(var o=n>1?void 0:n?Qu(e,t):e,r=s.length-1,a;r>=0;r--)(a=s[r])&&(o=a(o)||o);return o},ki=(s,e)=>(t,n)=>e(t,n,s);const td="SHEET_DEFINED_NAME_PLUGIN",nd="AllDefaultWorkbook";g.DefinedNameDataController=class extends i.Disposable{constructor(e,t){super(),this._definedNamesService=e,this._resourceManagerService=t,this._initialize()}_initialize(){this._initSnapshot()}_initSnapshot(){const e=n=>{const o=this._definedNamesService.getDefinedNameMap(n);return o?JSON.stringify(o):""},t=n=>{if(!n)return{};try{return JSON.parse(n)}catch{return{}}};this.disposeWithMe(this._resourceManagerService.registerPluginResource({pluginName:td,businesses:[i.UniverInstanceType.UNIVER_SHEET],toJson:n=>e(n),parseJson:n=>t(n),onUnLoad:n=>{this._definedNamesService.removeUnitDefinedName(n)},onLoad:(n,o)=>{this._definedNamesService.registerDefinedNames(n,o)}}))}},g.DefinedNameDataController=ed([ki(0,J.IDefinedNamesService),ki(1,i.IResourceManagerService)],g.DefinedNameDataController);var sd=Object.getOwnPropertyDescriptor,od=(s,e,t,n)=>{for(var o=n>1?void 0:n?sd(e,t):e,r=s.length-1,a;r>=0;r--)(a=s[r])&&(o=a(o)||o);return o},xs=(s,e)=>(t,n)=>e(t,n,s);const rd=[Ne.id],id=[re.id,ie.id,ae.id,ne.id,pe.id,we.id];g.SheetsFreezeSyncController=class extends i.Disposable{constructor(t,n,o){var a,l;super();f(this,"_d",new i.DisposableCollection);f(this,"_enabled",!0);this._univerInstanceService=t,this._commandService=n,this._configService=o;const r=(l=(a=this._configService.getConfig(Gt))==null?void 0:a.freezeSync)!=null?l:!0;this.setEnabled(r)}getEnabled(){return this._enabled}setEnabled(t){t?this._d.dispose():this._initOnlyLocalListener(),this._enabled=t}_initOnlyLocalListener(){this._d.add(this._commandService.beforeCommandExecuted((t,n)=>{rd.includes(t.id)&&(n||(n={}),n.onlyLocal=!0)})),this._d.add(this._commandService.onCommandExecuted((t,n)=>{if(id.includes(t.id)&&(n!=null&&n.fromCollab)){const{id:o,params:r}=t;o===re.id?this._handleInsertRowMutation(r,n):o===ie.id?this._handleInsertColMutation(r,n):o===ae.id?this._handleRemoveRowMutation(r,n):o===ne.id?this._handleRemoveColMutation(r,n):o===pe.id?this._handleMoveRowsMutation(r,n):o===we.id&&this._handleMoveColsMutation(r,n)}}))}_handleInsertRowMutation(t,n){const{range:o,unitId:r,subUnitId:a}=t,l=this._getFreeze(r,a);if(l&&o.startRow<l.startRow){const u=o.endRow-o.startRow+1,d={...l,startRow:Math.max(1,l.startRow+u),ySplit:Math.max(1,l.ySplit+u)};this._sequenceExecute(r,a,d,n)}}_handleInsertColMutation(t,n){const{range:o,unitId:r,subUnitId:a}=t,l=this._getFreeze(r,a);if(l&&o.startColumn<l.startColumn){const u=o.endColumn-o.startColumn+1,d={...l,startColumn:Math.max(1,l.startColumn+u),xSplit:Math.max(1,l.xSplit+u)};this._sequenceExecute(r,a,d,n)}}_handleRemoveRowMutation(t,n){const{range:o,unitId:r,subUnitId:a}=t,l=this._getFreeze(r,a);if(l&&o.startRow<l.startRow){const u=Math.min(l.startRow,o.endRow+1)-o.startRow,d={...l,startRow:Math.max(1,l.startRow-u),ySplit:Math.max(1,l.ySplit-u)};this._sequenceExecute(r,a,d,n)}}_handleRemoveColMutation(t,n){const{range:o,unitId:r,subUnitId:a}=t,l=this._getFreeze(r,a);if(l&&o.startColumn<l.startColumn){const u=Math.min(l.startColumn,o.endColumn+1)-o.startColumn,d={...l,startColumn:Math.max(1,l.startColumn-u),xSplit:Math.max(1,l.xSplit-u)};this._sequenceExecute(r,a,d,n)}}_handleMoveRowsMutation(t,n){const{sourceRange:o,targetRange:r,unitId:a,subUnitId:l}=t,u=this._getFreeze(a,l);if(!u||u.startRow<=0||o.startRow>=u.startRow&&r.startRow>=u.startRow||o.endRow<u.startRow&&r.endRow<u.startRow)return;const d=o.endRow-o.startRow+1,c=Math.max(Math.min(u.startRow,o.endRow+1)-o.startRow,0),m={...u};r.startRow>=u.startRow?(m.startRow=Math.max(1,u.startRow-c),m.ySplit=Math.max(1,u.ySplit-c)):(m.startRow=u.startRow+d-c,m.ySplit=u.ySplit+d-c),this._sequenceExecute(a,l,m,n)}_handleMoveColsMutation(t,n){const{sourceRange:o,targetRange:r,unitId:a,subUnitId:l}=t,u=this._getFreeze(a,l);if(!u||u.startColumn<=0||o.startColumn>=u.startColumn&&r.startColumn>=u.startColumn||o.endColumn<u.startColumn&&r.endColumn<u.startColumn)return;const d=o.endColumn-o.startColumn+1,c=Math.max(Math.min(u.startColumn,o.endColumn+1)-o.startColumn,0),m={...u};r.startColumn>=u.startColumn?(m.startColumn=Math.max(1,u.startColumn-c),m.xSplit=Math.max(1,u.xSplit-c)):(m.startColumn=u.startColumn+d-c,m.xSplit=u.xSplit+d-c),this._sequenceExecute(a,l,m,n)}_getFreeze(t,n){const o=this._univerInstanceService.getUnit(t,i.UniverInstanceType.UNIVER_SHEET);if(!o)return null;const r=o.getSheetBySheetId(n);return r?r.getFreeze():null}_sequenceExecute(t,n,o,r){i.sequenceExecute([{id:Ne.id,params:{...o,unitId:t,subUnitId:n,resetScroll:!1}}],this._commandService,r)}},g.SheetsFreezeSyncController=od([xs(0,i.Inject(i.IUniverInstanceService)),xs(1,i.ICommandService),xs(2,i.IConfigService)],g.SheetsFreezeSyncController);var ad=Object.getOwnPropertyDescriptor,ld=(s,e,t,n)=>{for(var o=n>1?void 0:n?ad(e,t):e,r=s.length-1,a;r>=0;r--)(a=s[r])&&(o=a(o)||o);return o},Oe=(s,e)=>(t,n)=>e(t,n,s);g.SheetPermissionCheckController=class extends i.Disposable{constructor(t,n,o,r,a,l,u,d,c,m){super();f(this,"disposableCollection",new i.DisposableCollection);f(this,"_triggerPermissionUIEvent$",new O.Subject);f(this,"triggerPermissionUIEvent$",this._triggerPermissionUIEvent$.asObservable());this._commandService=t,this._univerInstanceService=n,this._permissionService=o,this._selectionManagerService=r,this._rangeProtectionRuleModel=a,this._worksheetProtectionRuleModel=l,this._localeService=u,this._lexerTreeBuilder=d,this._contextService=c,this._definedNamesService=m,this._initialize()}blockExecuteWithoutPermission(t){throw this._triggerPermissionUIEvent$.next(t),new i.CustomCommandExecutionError("have no permission")}_getPermissionCheck(t,n){let o=!0,r="";switch(t){case vt.id:i.isICellData(n.value)&&n.value.f?(o=this._permissionCheckWithFormula(n),r=this._localeService.t("permission.dialog.formulaErr")):o=this._permissionCheckBySetRangeValue({workbookTypes:[me],rangeTypes:[Se],worksheetTypes:[Vt,fe]},n);break;case In.id:o=this.permissionCheckWithRanges({workbookTypes:[me],rangeTypes:[Se],worksheetTypes:[Vt,fe]},n==null?void 0:n.ranges,n==null?void 0:n.unitId,n==null?void 0:n.subUnitId),r=this._localeService.t("permission.dialog.editErr");break;case qt.id:case Yt.id:o=this.permissionCheckWithoutRange({worksheetTypes:[ft]}),r=this._localeService.t("permission.dialog.setRowColStyleErr");break;case xt.id:case Xt.id:case Un.id:o=this.permissionCheckWithoutRange({worksheetTypes:[It]}),r=this._localeService.t("permission.dialog.setRowColStyleErr");break;case Mt.id:case wt.id:o=this._permissionCheckByMoveCommand(n),r=this._localeService.t("permission.dialog.moveRowColErr");break;case xe.id:o=this._permissionCheckByMoveRangeCommand(n),r=this._localeService.t("permission.dialog.moveRangeErr");break;case zs.id:o=this._permissionCheckByWorksheetCommand([me,mn]),r=this._localeService.t("permission.dialog.operatorSheetErr"),o===!1&&this._worksheetProtectionRuleModel.resetOrder();break;case _n.id:o=this._permissionCheckByWorksheetCommand([me,hn]),r=this._localeService.t("permission.dialog.operatorSheetErr"),o===!1&&this._worksheetProtectionRuleModel.resetOrder();break;case Ks.id:{const{unitId:a,subUnitId:l}=n;o=this._permissionCheckByWorksheetCommand([me,dn],a,l),r=this._localeService.t("permission.dialog.operatorSheetErr"),o===!1&&this._worksheetProtectionRuleModel.resetOrder()}break;case Tt.id:o=this.permissionCheckWithRanges({workbookTypes:[me],rangeTypes:[Se],worksheetTypes:[fe,ft]},n.ranges,n.unitId,n.subUnitId),r=this._localeService.t("permission.dialog.setRowColStyleErr");break;case Ut.id:o=this.permissionCheckWithRanges({workbookTypes:[me],rangeTypes:[Se],worksheetTypes:[fe,It]},n.ranges,n.unitId,n.subUnitId),r=this._localeService.t("permission.dialog.setRowColStyleErr");break;case $s.id:o=this.permissionCheckWithRanges({workbookTypes:[me],rangeTypes:[Se],worksheetTypes:[fe,ft]}),r=this._localeService.t("permission.dialog.setRowColStyleErr");break;case Hs.id:o=this.permissionCheckWithRanges({workbookTypes:[me],rangeTypes:[Se],worksheetTypes:[fe,It]}),r=this._localeService.t("permission.dialog.setRowColStyleErr");break;case pt.id:o=this._permissionCheckWithInsertRangeMove("right"),r=this._localeService.t("permission.dialog.insertOrDeleteMoveRangeErr");break;case Xe.id:o=this._permissionCheckWithInsertRangeMove("bottom"),r=this._localeService.t("permission.dialog.insertOrDeleteMoveRangeErr");break;case He.id:o=this._permissionCheckWithInsertRangeMove("left"),r=this._localeService.t("permission.dialog.insertOrDeleteMoveRangeErr");break;case Fe.id:o=this._permissionCheckWithInsertRangeMove("top"),r=this._localeService.t("permission.dialog.insertOrDeleteMoveRangeErr");break}o||this.blockExecuteWithoutPermission(r)}_initialize(){this._commandExecutedListener()}_commandExecutedListener(){this.disposeWithMe(this._commandService.beforeCommandExecuted(t=>{this._getPermissionCheck(t.id,t==null?void 0:t.params)})),this.disposeWithMe(this._commandService.onCommandExecuted(t=>{var n;if(t.id===Kt.id){const o=t.params,{unitId:r=(n=this._univerInstanceService.getCurrentUnitForType(i.UniverInstanceType.UNIVER_SHEET))==null?void 0:n.getUnitId(),subUnitId:a}=o;if(!r||!a)return;const l=this._worksheetProtectionRuleModel.getRule(r,a),u=this._rangeProtectionRuleModel.getSubunitRuleList(r,a);l&&this._worksheetProtectionRuleModel.ruleRefresh(l.permissionId),u.length&&this._rangeProtectionRuleModel.ruleRefresh(a)}}))}_permissionCheckWithInsertRangeMove(t){var c;const n=P(this._univerInstanceService);if(!n)return!1;const{worksheet:o,unitId:r,subUnitId:a}=n,l=i.Tools.deepClone((c=this._selectionManagerService.getCurrentLastSelection())==null?void 0:c.range);return!(!l||(t==="top"||t==="bottom"?l.endRow=o.getRowCount()-1:(t==="left"||t==="right")&&(l.endColumn=o.getColumnCount()-1),this._rangeProtectionRuleModel.getSubunitRuleList(r,a).map(m=>m.ranges).flat().some(m=>i.Rectangle.getIntersects(l,m))))}_permissionCheckByWorksheetCommand(t,n,o){var c,m;const r=P(this._univerInstanceService,{unitId:n,subUnitId:o});if(!r)return!1;const{unitId:a,subUnitId:l}=r,u=this._worksheetProtectionRuleModel.getRule(a,l),d=this._rangeProtectionRuleModel.getSubunitRuleList(a,l).length>0;return u||d?(m=(c=this._permissionService.getPermissionPoint(new cn(a).id))==null?void 0:c.value)!=null?m:!1:this._permissionService.composePermission(t.map(h=>new h(a).id)).every(h=>h.value)}permissionCheckWithoutRange(t){var R,C,S,I;const n=P(this._univerInstanceService);if(!n)return!1;const{worksheet:o,unitId:r,subUnitId:a}=n,l=this._selectionManagerService.getCurrentLastSelection();if(!l)return!0;const u=(C=(R=l==null?void 0:l.primary)==null?void 0:R.actualRow)!=null?C:0,d=(I=(S=l==null?void 0:l.primary)==null?void 0:S.actualColumn)!=null?I:0,{workbookTypes:c,worksheetTypes:m,rangeTypes:h}=t;return!(c&&c.some(M=>{var y,b;const p=new M(r);return((b=(y=this._permissionService.getPermissionPoint(p.id))==null?void 0:y.value)!=null?b:!1)===!1})===!0||m&&m.some(M=>{var y,b;const p=new M(r,a);return((b=(y=this._permissionService.getPermissionPoint(p.id))==null?void 0:y.value)!=null?b:!1)===!1})===!0||h&&h.some(M=>{var E,U,k,T,N;const p=(U=(E=o.getCell(u,d))==null?void 0:E.selectionProtection)==null?void 0:U[0];if(!(p!=null&&p.ruleId))return!1;const w=(k=this._rangeProtectionRuleModel.getRule(r,a,p.ruleId))==null?void 0:k.permissionId;if(!w)return!1;const y=new M(r,a,w);return((N=(T=this._permissionService.getPermissionPoint(y.id))==null?void 0:T.value)!=null?N:!1)===!1})===!0)}permissionCheckWithRanges(t,n,o,r){var C;const a=P(this._univerInstanceService);if(!a)return!1;const{workbook:l,worksheet:u}=a;o||(o=l.getUnitId()),r||(r=u.getSheetId());const d=n!=null?n:(C=this._selectionManagerService.getCurrentSelections())==null?void 0:C.map(S=>S.range);if(!d)return!1;const{workbookTypes:c,worksheetTypes:m,rangeTypes:h}=t,R=[];return c&&R.push(...c.map(S=>new S(o).id)),m&&R.push(...m.map(S=>new S(o,r).id)),h&&this._rangeProtectionRuleModel.getSubunitRuleList(o,r).forEach(S=>{d.some(v=>S.ranges.some(M=>i.Rectangle.intersects(M,v)))&&R.push(...h.map(v=>new v(o,r,S.permissionId).id))}),R.length?this._permissionService.composePermission(R).every(S=>S.value):!0}_permissionCheckByMoveCommand(t){const n=P(this._univerInstanceService);if(!n)return!1;const{worksheet:o,unitId:r,subUnitId:a}=n,l=t.toRange;l.endRow===o.getRowCount()-1?l.endColumn=l.startColumn:l.endRow=l.startRow;const u=this._rangeProtectionRuleModel.getSubunitRuleList(r,a).reduce((d,c)=>[...d,...c.ranges],[]).filter(d=>i.Rectangle.intersects(d,l));return u.length>0?!1:(u.forEach(d=>{var c,m;for(let h=d.startRow;h<=d.endRow;h++)for(let R=d.startColumn;R<=d.endColumn;R++){const C=(m=(c=o.getCell(h,R))==null?void 0:c.selectionProtection)==null?void 0:m[0];if((C==null?void 0:C[_.Edit])===!1)return!1}}),!0)}_permissionCheckByMoveRangeCommand(t){const n=P(this._univerInstanceService);if(!n)return!1;const{worksheet:o,unitId:r,subUnitId:a}=n,l=t.toRange,u=this._rangeProtectionRuleModel.getSubunitRuleList(r,a).reduce((d,c)=>[...d,...c.ranges],[]).filter(d=>i.Rectangle.intersects(d,l));return u.length>0?!1:(u.forEach(d=>{var c,m;for(let h=d.startRow;h<=d.endRow;h++)for(let R=d.startColumn;R<=d.endColumn;R++){const C=(m=(c=o.getCell(h,R))==null?void 0:c.selectionProtection)==null?void 0:m[0];if((C==null?void 0:C[_.Edit])===!1)return!1}}),!0)}_permissionCheckBySetRangeValue(t,n){let o=[];n.range?o=[n.range]:o=[new i.ObjectMatrix(n.value).getDataRange()];const{unitId:r,subUnitId:a}=n;return this.permissionCheckWithRanges(t,o,r,a)}_permissionCheckWithFormula(t){var a,l,u,d,c;const n=t.value,o=t.range,r=n.f;if(r){const m=r.substring(1),h=this._univerInstanceService.getCurrentUnitForType(i.UniverInstanceType.UNIVER_SHEET),R=(a=t.unitId)!=null?a:h.getUnitId(),C=this._definedNamesService.getValueByName(R,m);if(C){let S=C.formulaOrRefString;S.startsWith(J.operatorToken.EQUALS)&&(S=S.slice(1));const I=S.split(",");for(let v=0;v<I.length;v++){const M=I[v],p=J.deserializeRangeWithSheet(M);if(p.sheetName){const w=h.getSheetBySheetName(p.sheetName);if(!w)return!0;const{startRow:y,endRow:b,startColumn:E,endColumn:U}=p.range;for(let k=y;k<=b;k++)for(let T=E;T<=U;T++){const N=(u=(l=w.getCell(k,T))==null?void 0:l.selectionProtection)==null?void 0:u[0];if((N==null?void 0:N[_.View])===!1)return!1}}}return!0}else{const S=this._lexerTreeBuilder.sequenceNodesBuilder(r);if(!S)return!0;for(let I=0;I<S.length;I++){const v=S[I];if(typeof v=="string"||v.nodeType!==J.sequenceNodeType.REFERENCE)continue;const{token:M}=v,p=J.deserializeRangeWithSheetWithCache(M),w=p.unitId?this._univerInstanceService.getUnit(p.unitId):this._univerInstanceService.getCurrentUnitForType(i.UniverInstanceType.UNIVER_SHEET);if(!w)return!0;let y=p.sheetName?w.getSheetBySheetName(p.sheetName):w.getActiveSheet();const b=w.getUnitId();if(p.sheetName){if(y=w.getSheetBySheetName(p.sheetName),!y)return!0;const N=y==null?void 0:y.getSheetId();if(!this._permissionService.getPermissionPoint(new $t(b,N).id))return!1}if(!y)return!0;const{startRow:E,endRow:U,startColumn:k,endColumn:T}=p.range;for(let N=E;N<=U;N++)for(let W=k;W<=T;W++){const V=(c=(d=y.getCell(N,W))==null?void 0:d.selectionProtection)==null?void 0:c[0];if((V==null?void 0:V[_.View])===!1)return!1}}return!0}}if(o){const m=P(this._univerInstanceService);if(!m)return!1;const h=t.unitId||m.unitId,R=t.subUnitId||m.subUnitId,S=this._rangeProtectionRuleModel.getSubunitRuleList(h,R).filter(v=>v.ranges.some(M=>i.Rectangle.intersects(M,o))).map(v=>new Se(h,R,v.permissionId).id);if(!this._permissionService.composePermission(S).every(v=>v.value))return!1}return!0}},g.SheetPermissionCheckController=ld([Oe(0,i.ICommandService),Oe(1,i.IUniverInstanceService),Oe(2,i.IPermissionService),Oe(3,i.Inject(g.SheetsSelectionsService)),Oe(4,i.Inject(X)),Oe(5,i.Inject(Pe)),Oe(6,i.Inject(i.LocaleService)),Oe(7,i.Inject(J.LexerTreeBuilder)),Oe(8,i.IContextService),Oe(9,J.IDefinedNamesService)],g.SheetPermissionCheckController);var ud=Object.getOwnPropertyDescriptor,dd=(s,e,t,n)=>{for(var o=n>1?void 0:n?ud(e,t):e,r=s.length-1,a;r>=0;r--)(a=s[r])&&(o=a(o)||o);return o},Zt=(s,e)=>(t,n)=>e(t,n,s);g.WorkbookPermissionService=class extends i.Disposable{constructor(t,n,o,r,a){super();f(this,"_unitPermissionInitStateChange",new O.BehaviorSubject(!1));f(this,"unitPermissionInitStateChange$",this._unitPermissionInitStateChange.asObservable());this._permissionService=t,this._univerInstanceService=n,this._rangeProtectionRuleModel=o,this._worksheetProtectionRuleModel=r,this._worksheetProtectionPointModel=a,this._init()}_init(){const t=n=>{const o=n.getUnitId();Pt().forEach(r=>{const a=new r(o);this._permissionService.addPermissionPoint(a)})};this._univerInstanceService.getAllUnitsForType(i.UniverInstanceType.UNIVER_SHEET).forEach(n=>{t(n)}),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitAdded$(i.UniverInstanceType.UNIVER_SHEET).subscribe(n=>{t(n)})),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitDisposed$(i.UniverInstanceType.UNIVER_SHEET).subscribe(n=>{const o=n.getUnitId();n.getSheets().forEach(r=>{const a=r.getSheetId();this._rangeProtectionRuleModel.getSubunitRuleList(o,a).forEach(u=>{[...ue()].forEach(d=>{const c=new d(o,a,u.permissionId);this._permissionService.deletePermissionPoint(c.id)})}),[...de(),...Ie()].forEach(u=>{const d=new u(o,a);this._permissionService.deletePermissionPoint(d.id)})}),Pt().forEach(r=>{const a=new r(o);this._permissionService.deletePermissionPoint(a.id)}),this._rangeProtectionRuleModel.deleteUnitModel(o),this._worksheetProtectionPointModel.deleteUnitModel(o),this._worksheetProtectionRuleModel.deleteUnitModel(o)}))}changeUnitInitState(t){this._unitPermissionInitStateChange.next(t)}},g.WorkbookPermissionService=dd([Zt(0,i.Inject(i.IPermissionService)),Zt(1,i.Inject(i.IUniverInstanceService)),Zt(2,i.Inject(X)),Zt(3,i.Inject(Pe)),Zt(4,i.Inject(kt))],g.WorkbookPermissionService);var cd=Object.getOwnPropertyDescriptor,md=(s,e,t,n)=>{for(var o=n>1?void 0:n?cd(e,t):e,r=s.length-1,a;r>=0;r--)(a=s[r])&&(o=a(o)||o);return o},De=(s,e)=>(t,n)=>e(t,n,s);g.SheetPermissionInitController=class extends i.Disposable{constructor(e,t,n,o,r,a,l,u,d,c){super(),this._univerInstanceService=e,this._permissionService=t,this._authzIoService=n,this._rangeProtectionRuleModel=o,this._worksheetProtectionRuleModel=r,this._userManagerService=a,this._worksheetProtectionPointRuleModel=l,this._workbookPermissionService=u,this._undoRedoService=d,this._commandService=c}initPermission(){this._initRangePermissionFromSnapshot(),this._initRangePermissionChange(),this._initWorksheetPermissionFromSnapshot(),this._initWorksheetPermissionChange(),this._initWorksheetPermissionPointsChange(),this._initWorkbookPermissionFromSnapshot(),this._initUserChange(),this._refreshPermissionByCollaCreate()}refreshRangeProtectPermission(){this._initRangePermissionFromSnapshot()}async _initRangePermissionFromSnapshot(){const e=async t=>{const n=[],o=t.getUnitId(),r=t.getSheets(),a=new Map;if(r.forEach(l=>{const u=l.getSheetId();this._rangeProtectionRuleModel.getSubunitRuleList(o,u).forEach(d=>{a.set(d.permissionId,d),n.push({objectID:d.permissionId,unitID:o,objectType:D.SelectRange,actions:ze})})}),!n.length){this._rangeProtectionRuleModel.changeRuleInitState(!0);return}this._authzIoService.batchAllowed(n).then(l=>{l.forEach(u=>{const d=a.get(u.objectID);if(d){if(!this._rangeProtectionRuleModel.getRule(o,d.subUnitId,d.id))return;ue().forEach(m=>{const h=new m(o,d.subUnitId,u.objectID),R=h.subType,C=u.actions.find(S=>S.action===R);(C==null?void 0:C.allowed)!==void 0&&this._permissionService.updatePermissionPoint(h.id,C.allowed)})}}),this._rangeProtectionRuleModel.changeRuleInitState(!0)})};await Promise.all(this._univerInstanceService.getAllUnitsForType(i.UniverInstanceType.UNIVER_SHEET).map(t=>e(t))),this._rangeProtectionRuleModel.changeRuleInitState(!0)}_initRangePermissionChange(){this.disposeWithMe(this._rangeProtectionRuleModel.ruleChange$.subscribe(e=>{e.type!=="delete"?this._authzIoService.allowed({objectID:e.rule.permissionId,unitID:e.unitId,objectType:D.SelectRange,actions:ze}).then(t=>{this._rangeProtectionRuleModel.getRule(e.unitId,e.subUnitId,e.rule.id)&&(ue().forEach(o=>{if(e.type==="set"){const{rule:d,oldRule:c}=e;if(d.permissionId===(c==null?void 0:c.permissionId))return}const r=e.rule,a=new o(r.unitId,r.subUnitId,r.permissionId),l=a.subType,u=t.find(d=>d.action===l);u&&this._permissionService.updatePermissionPoint(a.id,u.allowed)}),this._rangeProtectionRuleModel.ruleRefresh(e.rule.permissionId))}):this._rangeProtectionRuleModel.getSubunitRuleList(e.unitId,e.subUnitId).length===0&&(this._worksheetProtectionPointRuleModel.deleteRule(e.unitId,e.subUnitId),[...Ie()].forEach(n=>{const o=new n(e.unitId,e.subUnitId);this._permissionService.updatePermissionPoint(o.id,o.value)}))}))}async initWorkbookPermissionChange(e){var n;const t=e||((n=this._univerInstanceService.getCurrentUnitForType(i.UniverInstanceType.UNIVER_SHEET))==null?void 0:n.getUnitId());if(t)return this._authzIoService.allowed({objectID:t,objectType:D.Workbook,unitID:t,actions:gi}).then(o=>{Pt().forEach(r=>{const a=new r(t),l=a.subType,u=o.find(d=>d.action===l);u&&this._permissionService.updatePermissionPoint(a.id,u.allowed)})})}async _initWorkbookPermissionFromSnapshot(){await Promise.all(this._univerInstanceService.getAllUnitsForType(i.UniverInstanceType.UNIVER_SHEET).map(e=>this.initWorkbookPermissionChange(e.getUnitId()))),this._workbookPermissionService.changeUnitInitState(!0)}_initWorksheetPermissionChange(){this.disposeWithMe(this._worksheetProtectionRuleModel.ruleChange$.subscribe(e=>{e.type!=="delete"?this._authzIoService.allowed({objectID:e.rule.permissionId,unitID:e.unitId,objectType:D.Worksheet,actions:ze}).then(t=>{const n=this._worksheetProtectionRuleModel.getRule(e.unitId,e.subUnitId);!n||n.permissionId!==e.rule.permissionId||(de().forEach(o=>{const r=new o(e.unitId,e.subUnitId),a=r.subType,l=t.find(u=>u.action===a);l&&this._permissionService.updatePermissionPoint(r.id,l.allowed)}),this._worksheetProtectionRuleModel.ruleRefresh(e.rule.permissionId))}):([...de(),...Ie()].forEach(t=>{const n=new t(e.unitId,e.subUnitId);this._permissionService.updatePermissionPoint(n.id,!0)}),this._worksheetProtectionPointRuleModel.deleteRule(e.unitId,e.subUnitId))}))}_initWorksheetPermissionPointsChange(){this.disposeWithMe(this._worksheetProtectionPointRuleModel.pointChange$.subscribe(e=>{this._authzIoService.allowed({objectID:e.permissionId,unitID:e.unitId,objectType:D.Worksheet,actions:bn}).then(t=>{const n=this._worksheetProtectionPointRuleModel.getRule(e.unitId,e.subUnitId);!n||n.permissionId!==e.permissionId||Ie().forEach(o=>{const r=new o(e.unitId,e.subUnitId),a=r.subType,l=t.find(u=>u.action===a);l&&this._permissionService.updatePermissionPoint(r.id,l.allowed)})})}))}async _initWorksheetPermissionFromSnapshot(){const e=async t=>{const n=[],o=t.getUnitId(),r=t.getSheets(),a=new Map;if(r.forEach(l=>{const u=l.getSheetId(),d=this._worksheetProtectionRuleModel.getRule(o,u);d&&(a.set(d.permissionId,d),n.push({objectID:d.permissionId,unitID:o,objectType:D.Worksheet,actions:ze}));const c=this._worksheetProtectionPointRuleModel.getRule(o,u);c&&(a.set(c.permissionId,c),n.push({objectID:c.permissionId,unitID:o,objectType:D.Worksheet,actions:bn}))}),!n.length){this._worksheetProtectionRuleModel.changeRuleInitState(!0);return}this._authzIoService.batchAllowed(n).then(l=>{l.forEach(u=>{const d=a.get(u.objectID);if(d){const c=this._worksheetProtectionRuleModel.getRule(o,d.subUnitId)||this._worksheetProtectionPointRuleModel.getRule(o,d.subUnitId);if(!c||c.permissionId!==u.objectID)return;[...de(),...Ie()].forEach(m=>{const h=new m(o,d.subUnitId),R=h.subType,C=u.actions.find(S=>S.action===R);(C==null?void 0:C.allowed)!==void 0&&this._permissionService.updatePermissionPoint(h.id,C.allowed)})}}),this._worksheetProtectionRuleModel.changeRuleInitState(!0)})};await Promise.all(this._univerInstanceService.getAllUnitsForType(i.UniverInstanceType.UNIVER_SHEET).map(t=>e(t))),this._worksheetProtectionRuleModel.changeRuleInitState(!0)}_initUserChange(){this.disposeWithMe(this._userManagerService.currentUser$.pipe(O.skip(1)).subscribe(()=>{const e=this._permissionService.getAllPermissionPoint();this._permissionService.clearPermissionMap(),this._worksheetProtectionRuleModel.changeRuleInitState(!1),this._univerInstanceService.getAllUnitsForType(i.UniverInstanceType.UNIVER_SHEET).forEach(n=>{const o=n.getUnitId();Pt().forEach(r=>{let a=new r(o);e.has(a.id)&&(a=e.get(a.id)),this._permissionService.addPermissionPoint(a)}),n.getSheets().forEach(r=>{const a=r.getSheetId();[...de(),...Ie()].forEach(u=>{let d=new u(o,a);e.has(d.id)&&(d=e.get(d.id)),this._permissionService.addPermissionPoint(d)}),this._rangeProtectionRuleModel.getSubunitRuleList(o,a).forEach(u=>{ue().forEach(d=>{let c=new d(o,a,u.permissionId);e.has(c.id)&&(c=e.get(c.id)),this._permissionService.addPermissionPoint(c)})})}),this._initWorkbookPermissionFromSnapshot(),this._initWorksheetPermissionFromSnapshot(),this._initRangePermissionFromSnapshot()})}))}refreshPermission(e,t){const n=this._worksheetProtectionRuleModel.getTargetByPermissionId(e,t);let o=!1;if(n){const[l,u]=n;this._authzIoService.allowed({objectID:t,unitID:e,objectType:D.Worksheet,actions:ze}).then(d=>{if(!this._worksheetProtectionRuleModel.getTargetByPermissionId(e,t))return;let m="";de().forEach(h=>{var I;const R=new h(e,u),C=R.subType,S=d.find(v=>v.action===C);S&&(((I=this._permissionService.getPermissionPoint(R.id))==null?void 0:I.value)!==S.allowed&&(o=!0),this._permissionService.updatePermissionPoint(R.id,S.allowed),m+=`${S.action}_${S.allowed}`)}),this._worksheetProtectionRuleModel.ruleRefresh(`${t}_${m}`),o&&this._undoRedoService.clearUndoRedo(e)})}const r=this._worksheetProtectionPointRuleModel.getTargetByPermissionId(e,t);if(r){const[l,u]=r;this._authzIoService.allowed({objectID:t,unitID:e,objectType:D.Worksheet,actions:bn}).then(d=>{this._worksheetProtectionPointRuleModel.getTargetByPermissionId(e,t)&&(Ie().forEach(m=>{var S;const h=new m(e,u),R=h.subType,C=d.find(I=>I.action===R);C&&(((S=this._permissionService.getPermissionPoint(h.id))==null?void 0:S.value)!==C.allowed&&(o=!0),this._permissionService.updatePermissionPoint(h.id,C.allowed))}),o&&this._undoRedoService.clearUndoRedo(e))})}const a=this._rangeProtectionRuleModel.getTargetByPermissionId(e,t);if(a){const[l,u]=a;this._authzIoService.allowed({objectID:t,unitID:e,objectType:D.SelectRange,actions:ze}).then(d=>{if(!this._rangeProtectionRuleModel.getTargetByPermissionId(e,t))return;let m="";ue().forEach(h=>{var I;const R=new h(e,u,t),C=R.subType,S=d.find(v=>v.action===C);S&&(((I=this._permissionService.getPermissionPoint(R.id))==null?void 0:I.value)!==S.allowed&&(o=!0),this._permissionService.updatePermissionPoint(R.id,S.allowed),m+=`${S.action}_${S.allowed}`)}),this._rangeProtectionRuleModel.ruleRefresh(`${t}_${m}`),o&&this._undoRedoService.clearUndoRedo(e)})}}_refreshPermissionByCollaCreate(){this.disposeWithMe(this._commandService.onCommandExecuted((e,t)=>{if(t!=null&&t.fromCollab&&(e.id===Ce.id||e.id===je.id||e.id===En.id)){const n=e.params;this._undoRedoService.clearUndoRedo(n.unitId)}}))}},g.SheetPermissionInitController=md([De(0,i.IUniverInstanceService),De(1,i.IPermissionService),De(2,i.IAuthzIoService),De(3,i.Inject(X)),De(4,i.Inject(Pe)),De(5,i.Inject(i.UserManagerService)),De(6,i.Inject(kt)),De(7,i.Inject(g.WorkbookPermissionService)),De(8,i.Inject(i.IUndoRedoService)),De(9,i.Inject(i.ICommandService))],g.SheetPermissionInitController);var hd=Object.getOwnPropertyDescriptor,gd=(s,e,t,n)=>{for(var o=n>1?void 0:n?hd(e,t):e,r=s.length-1,a;r>=0;r--)(a=s[r])&&(o=a(o)||o);return o},Xs=(s,e)=>(t,n)=>e(t,n,s);g.ZebraCrossingCacheController=class extends i.Disposable{constructor(t,n,o){super();f(this,"_zebraCacheUpdateSubject",new O.Subject);this._commandService=t,this._sheetRangeThemeModel=n,this._univerInstanceService=o,this._init()}_init(){this._initializeCommandListener(),this._initTriggerCacheUpdateListener()}updateZebraCrossingCache(t,n){this._zebraCacheUpdateSubject.next({unitId:t,subUnitId:n})}_initializeCommandListener(){this.disposeWithMe(this._commandService.onCommandExecuted(t=>{const{id:n}=t;let o,r;switch(n){case re.id:{const a=t.params;o=a.unitId,r=a.subUnitId}break;case Ke.id:{const a=t.params;o=a.unitId,r=a.subUnitId}break;case Je.id:{const a=t.params;o=a.unitId,r=a.subUnitId}break;case ae.id:{const a=t.params;o=a.unitId,r=a.subUnitId}break;case Ee.id:{const a=t.params;o=a.unitId,r=a.subUnitId}break}o&&r&&(this._sheetRangeThemeModel.refreshSheetRowVisibleFuncSet(o,r),this._sheetRangeThemeModel.refreshZebraCrossingCacheBySheet(o,r))}))}_initTriggerCacheUpdateListener(){this.disposeWithMe(this._zebraCacheUpdateSubject.subscribe(({unitId:t,subUnitId:n})=>{this._sheetRangeThemeModel.refreshSheetRowVisibleFuncSet(t,n),this._sheetRangeThemeModel.refreshZebraCrossingCacheBySheet(t,n)}))}},g.ZebraCrossingCacheController=gd([Xs(0,i.Inject(i.ICommandService)),Xs(1,i.Inject(g.SheetRangeThemeModel)),Xs(2,i.Inject(i.IUniverInstanceService))],g.ZebraCrossingCacheController);var Rd=Object.getOwnPropertyDescriptor,Cd=(s,e,t,n)=>{for(var o=n>1?void 0:n?Rd(e,t):e,r=s.length-1,a;r>=0;r--)(a=s[r])&&(o=a(o)||o);return o},Pi=(s,e)=>(t,n)=>e(t,n,s);g.RangeProtectionRenderModel=class{constructor(e,t){f(this,"_cache",new i.LRUMap(1e4));this._selectionProtectionRuleModel=e,this._permissionService=t,this._init()}_init(){this._permissionService.permissionPointUpdate$.pipe(Nt.filter(e=>e.type===D.SelectRange),Nt.filter(e=>ue().some(t=>e instanceof t)),Nt.map(e=>e)).subscribe(e=>{const t=this._selectionProtectionRuleModel.getSubunitRuleList(e.unitId,e.subUnitId);for(const n of t)n.permissionId===e.permissionId&&n.ranges.forEach(o=>{i.Range.foreach(o,(r,a)=>{const l=this._createKey(e.unitId,e.subUnitId,r,a);this._cache.delete(l)})})}),this._selectionProtectionRuleModel.ruleChange$.subscribe(e=>{var t;e.rule.ranges.forEach(n=>{i.Range.foreach(n,(o,r)=>{const a=this._createKey(e.unitId,e.subUnitId,o,r);this._cache.delete(a)})}),e.type==="set"&&((t=e.oldRule)==null||t.ranges.forEach(n=>{i.Range.foreach(n,(o,r)=>{const a=this._createKey(e.unitId,e.subUnitId,o,r);this._cache.delete(a)})}))})}_createKey(e,t,n,o){return`${e}_${t}_${n}_${o}`}getCellInfo(e,t,n,o){const r=this._selectionProtectionRuleModel.getSubunitRuleList(e,t),a=[];if(!r||!r.length)return a;const l=this._createKey(e,t,n,o),u=this._cache.get(l);if(u)return u;const d=[];for(const c of r)if(c.ranges.some(m=>m.startRow<=n&&m.endRow>=n&&m.startColumn<=o&&m.endColumn>=o)){const m=ue().reduce((h,R)=>{var I;const C=new R(e,t,c.permissionId),S=this._permissionService.getPermissionPoint(C.id);return h[C.subType]=(I=S==null?void 0:S.value)!=null?I:C.value,h},{});d.push({...m,ruleId:c.id,ranges:c.ranges})}return this._cache.set(l,d),d}clear(){this._cache.clear()}},g.RangeProtectionRenderModel=Cd([Pi(0,i.Inject(X)),Pi(1,i.Inject(i.IPermissionService))],g.RangeProtectionRenderModel);var Sd=Object.getOwnPropertyDescriptor,fd=(s,e,t,n)=>{for(var o=n>1?void 0:n?Sd(e,t):e,r=s.length-1,a;r>=0;r--)(a=s[r])&&(o=a(o)||o);return o},Zs=(s,e)=>(t,n)=>e(t,n,s);g.RangeProtectionCache=class extends i.Disposable{constructor(t,n,o){super();f(this,"_cellRuleCache",new Map);f(this,"_permissionIdCache",new Map);f(this,"_cellInfoCache",new Map);f(this,"_rowInfoCache",new Map);f(this,"_colInfoCache",new Map);this._ruleModel=t,this._permissionService=n,this._univerInstanceService=o,this._initUpdateCellRuleCache(),this._initUpdateCellInfoCache(),this._initUpdateRowColInfoCache(),this._initCache()}_initCache(){this._univerInstanceService.getAllUnitsForType(i.UniverInstanceType.UNIVER_SHEET).forEach(t=>{t.getSheets().forEach(n=>{const o=t.getUnitId(),r=n.getSheetId();this.reBuildCache(o,r)})})}_initUpdateCellInfoCache(){this._permissionService.permissionPointUpdate$.pipe(O.filter(t=>t.type===D.SelectRange),O.map(t=>t)).subscribe(t=>{const{subUnitId:n,unitId:o,permissionId:r}=t,a=this._permissionIdCache.get(r);if(!a)return;const l=this._ruleModel.getRule(o,n,a);if(!l)return;const u=this._ensureCellInfoMap(o,n);l.ranges.forEach(d=>{const{startRow:c,endRow:m,startColumn:h,endColumn:R}=d;for(let C=c;C<=m;C++)for(let S=h;S<=R;S++)u.delete(`${C}-${S}`)})}),this._ruleModel.ruleChange$.subscribe(t=>{var a;const{unitId:n,subUnitId:o}=t,r=this._ensureCellInfoMap(n,o);t.rule.ranges.forEach(l=>{i.Range.foreach(l,(u,d)=>{r.delete(`${u}-${d}`)})}),t.type==="set"&&((a=t.oldRule)==null||a.ranges.forEach(l=>{i.Range.foreach(l,(u,d)=>{this._cellInfoCache.delete(`${u}-${d}`)})}))})}_initUpdateCellRuleCache(){this._ruleModel.ruleChange$.subscribe(t=>{const{type:n}=t;n==="add"?this._addCellRuleCache(t):n==="delete"?this._deleteCellRuleCache(t):(this._deleteCellRuleCache({...t,rule:t.oldRule}),this._addCellRuleCache(t))})}_ensureRuleMap(t,n){let o=this._cellRuleCache.get(t);o||(o=new Map,this._cellRuleCache.set(t,o));let r=o.get(n);return r||(r=new Map,o.set(n,r)),r}_ensureCellInfoMap(t,n){let o=this._cellInfoCache.get(t);o||(o=new Map,this._cellInfoCache.set(t,o));let r=o.get(n);return r||(r=new Map,o.set(n,r)),r}_ensureRowColInfoMap(t,n,o){let r=o==="row"?this._rowInfoCache.get(t):this._colInfoCache.get(t);r||(r=new Map,o==="row"?this._rowInfoCache.set(t,r):this._colInfoCache.set(t,r));let a=r.get(n);return a||(a=new Map,r.set(n,a)),a}_addCellRuleCache(t){const{subUnitId:n,unitId:o,rule:r}=t,a=this._ensureRuleMap(o,n);r.ranges.forEach(l=>{const{startRow:u,endRow:d,startColumn:c,endColumn:m}=l;for(let h=u;h<=d;h++)for(let R=c;R<=m;R++)a.set(`${h}-${R}`,r.id)}),this._permissionIdCache.set(r.permissionId,r.id)}_deleteCellRuleCache(t){const{subUnitId:n,unitId:o,rule:r}=t,a=this._ensureRuleMap(o,n),l=this._ensureCellInfoMap(o,n);r.ranges.forEach(u=>{const{startRow:d,endRow:c,startColumn:m,endColumn:h}=u;for(let R=d;R<=c;R++)for(let C=m;C<=h;C++)a.delete(`${R}-${C}`),l.delete(`${R}-${C}`)}),this._permissionIdCache.delete(r.permissionId)}_getSelectionActions(t,n,o){var c,m,h,R,C,S,I,v,M,p,w,y;const r=(h=(m=this._permissionService.getPermissionPoint((c=new Se(t,n,o.permissionId))==null?void 0:c.id))==null?void 0:m.value)!=null?h:!1,a=(S=(C=this._permissionService.getPermissionPoint((R=new un(t,n,o.permissionId))==null?void 0:R.id))==null?void 0:C.value)!=null?S:!1,l=(M=(v=this._permissionService.getPermissionPoint((I=new Ys(t,n,o.permissionId))==null?void 0:I.id))==null?void 0:v.value)!=null?M:!1,u=(y=(w=this._permissionService.getPermissionPoint((p=new qs(t,n,o.permissionId))==null?void 0:p.id))==null?void 0:w.value)!=null?y:!1;return{[_.Edit]:r,[_.View]:a,[_.ManageCollaborator]:l,[_.Delete]:u}}reBuildCache(t,n){const o=this._ensureRuleMap(t,n),r=this._ensureCellInfoMap(t,n);o.clear(),r.clear();const a=this._ensureRowColInfoMap(t,n,"row"),l=this._ensureRowColInfoMap(t,n,"col");a.clear(),l.clear(),this._ruleModel.getSubunitRuleList(t,n).forEach(u=>{const d=this._getSelectionActions(t,n,u),c={...d,ruleId:u.id,ranges:u.ranges};u.ranges.forEach(m=>{const{startRow:h,endRow:R,startColumn:C,endColumn:S}=m;for(let I=h;I<=R;I++){const v=a.get(`${I}`);v?v.set(u.id,d):a.set(`${I}`,new Map([[u.id,d]]));for(let M=C;M<=S;M++){o.set(`${I}-${M}`,u.id),r.set(`${I}-${M}`,c);const p=l.get(`${M}`);p?p.set(u.id,d):l.set(`${M}`,new Map([[u.id,d]]))}}}),this._permissionIdCache.set(u.permissionId,u.id)})}getRowPermissionInfo(t,n,o,r){var u;const a=(u=this._rowInfoCache.get(t))==null?void 0:u.get(n);if(!a)return!0;const l=a.get(`${o}`);return l?r.every(d=>{for(const c of l.values())if(c[d]===!1)return!1;return!0}):!0}getColPermissionInfo(t,n,o,r){var u;const a=(u=this._colInfoCache.get(t))==null?void 0:u.get(n);if(!a)return!0;const l=a.get(`${o}`);return l?r.every(d=>{for(const c of l.values())if(c[d]===!1)return!1;return!0}):!0}_initUpdateRowColInfoCache(){this._permissionService.permissionPointUpdate$.pipe(O.filter(t=>t.type===D.SelectRange),O.map(t=>t)).subscribe({next:t=>{const{subUnitId:n,unitId:o,permissionId:r}=t,a=this._permissionIdCache.get(r);if(!a)return;const l=this._ruleModel.getRule(o,n,a);if(!l)return;const u=this._ensureRowColInfoMap(o,n,"row"),d=this._ensureRowColInfoMap(o,n,"col"),c=this._getSelectionActions(o,n,l);l.ranges.forEach(m=>{const{startRow:h,endRow:R,startColumn:C,endColumn:S}=m;for(let I=h;I<=R;I++){const v=u.get(`${I}`);v?v.set(a,c):u.set(`${I}`,new Map([[a,c]]));for(let M=C;M<=S;M++){const p=d.get(`${M}`);p?p.set(a,c):d.set(`${M}`,new Map([[a,c]]))}}})}}),this._ruleModel.ruleChange$.subscribe(t=>{if(t.type==="delete"){const{unitId:n,subUnitId:o,rule:r}=t,a=this._ensureRowColInfoMap(n,o,"row"),l=this._ensureRowColInfoMap(n,o,"col");r.ranges.forEach(u=>{const{startRow:d,endRow:c,startColumn:m,endColumn:h}=u;for(let R=d;R<=c;R++){const C=a.get(`${R}`);C==null||C.delete(r.id);for(let S=m;S<=h;S++){const I=l.get(`${S}`);I==null||I.delete(r.id)}}})}})}getCellInfo(t,n,o,r){var c,m;const a=this._ensureCellInfoMap(t,n),l=a.get(`${o}-${r}`);if(l)return l;const u=(m=(c=this._cellRuleCache.get(t))==null?void 0:c.get(n))==null?void 0:m.get(`${o}-${r}`);if(!u)return;const d=this._ruleModel.getRule(t,n,u);if(d){const R={...this._getSelectionActions(t,n,d),ruleId:u,ranges:d.ranges};return a.set(`${o}-${r}`,R),R}}deleteUnit(t){this._cellRuleCache.delete(t),this._cellInfoCache.delete(t),this._rowInfoCache.delete(t),this._colInfoCache.delete(t);const n=this._univerInstanceService.getUnit(t);n==null||n.getSheets().forEach(o=>{const r=o.getSheetId();this._ruleModel.getSubunitRuleList(t,r).forEach(a=>{this._permissionIdCache.delete(a.permissionId)})})}},g.RangeProtectionCache=fd([Zs(0,i.Inject(X)),Zs(1,i.Inject(i.IPermissionService)),Zs(2,i.Inject(i.IUniverInstanceService))],g.RangeProtectionCache);const Ni="ONLY_REGISTER_FORMULA_RELATED_MUTATIONS_KEY";var Id=Object.getOwnPropertyDescriptor,vd=(s,e,t,n)=>{for(var o=n>1?void 0:n?Id(e,t):e,r=s.length-1,a;r>=0;r--)(a=s[r])&&(o=a(o)||o);return o},Qs=(s,e)=>(t,n)=>e(t,n,s);let Nn=class extends i.Disposable{constructor(s,e,t){var o;super(),this._commandService=s,this._configService=e,this._dataSyncPrimaryController=t,[F,ie,re,_t,Le,pe,we,ne,ae,Ze,G,Js,j,Fs,Kt,kn,Dt,Mi,Je,Ke,yi,_i,Ds].forEach(r=>{var a;this._commandService.registerCommand(r),(a=this._dataSyncPrimaryController)==null||a.registerSyncingMutations(r)}),((o=this._configService.getConfig(Ni))!=null?o:!1)||[Pr,on,In,rn,Ar,He,Fe,qt,xt,or,sr,rr,ir,Ms,ye,Xe,pt,Qo,Zo,tr,er,ws,Me,Br,Mt,xe,wt,ys,Bt,_s,Lt,pn,Cn,Fr,oi,ni,si,qr,zr,Et,jr,Gr,Mn,ut,dt,Yt,Yr,lt,Jr,Ne,xr,ii,vt,Xt,yn,Qr,mt,$s,Hs,Tt,Ut,ee,ui,zt,ti,li,ai,ri,js,Gs,St,hi,Ge,_n,zs,Jt,Gn,Ee,Un,Re,Ve,Si,Rt,di,ht,Ho,q,Ti,Lr,Ws,Ls,Ks,vi,Ct,Xr,ct,Ri,je,ot,nt,En,Ao,Zr,Wr,Ur,Vr,Ci,Ce,Te,Q,Ii,gt,ci,fi,at,it,vn,bt,pi,Hr,kr,$r,wi,Ei,bi].forEach(r=>this.disposeWithMe(this._commandService.registerCommand(r))),this._configService.setConfig(Ui,Zu)}};Nn=vd([Qs(0,i.ICommandService),Qs(1,i.IConfigService),Qs(2,i.Optional(ji.DataSyncPrimaryController))],Nn);var pd=Object.getOwnPropertyDescriptor,wd=(s,e,t,n)=>{for(var o=n>1?void 0:n?pd(e,t):e,r=s.length-1,a;r>=0;r--)(a=s[r])&&(o=a(o)||o);return o},Oi=(s,e)=>(t,n)=>e(t,n,s);let On=class extends i.Disposable{constructor(s,e){super(),this._univerInstanceService=s,this._commandService=e,this._initialize()}_initialize(){this.disposeWithMe(this._commandService.onCommandExecuted(s=>{if(s.id!==J.SetFormulaCalculationResultMutation.id)return;const e=s.params,{unitData:t}=e,n=Object.keys(t),o=[];for(let a=0;a<n.length;a++){const l=n[a],u=t[l];if(u==null)continue;const d=Object.keys(u);for(let c=0;c<d.length;c++){const m=d[c],h=u[m];if(h==null)continue;const R=this._getMergedCellData(l,m,h),C={subUnitId:m,unitId:l,cellValue:R};o.push({id:F.id,params:C})}}return o.every(a=>this._commandService.executeCommand(a.id,a.params,{onlyLocal:!0,fromFormula:!0}))}))}_getMergedCellData(s,e,t){const n=this._univerInstanceService.getUniverSheetInstance(s),o=n==null?void 0:n.getStyles(),r=n==null?void 0:n.getSheetBySheetId(e),a=r==null?void 0:r.getCellMatrix(),l=new i.ObjectMatrix(t);return l.forValue((u,d,c)=>{const m=a==null?void 0:a.getValue(u,d),h=J.handleNumfmtInCell(m,c,o);l.setValue(u,d,h)}),l.getMatrix()}};On=wd([Oi(0,i.Inject(i.IUniverInstanceService)),Oi(1,i.ICommandService)],On);var Md=Object.getOwnPropertyDescriptor,yd=(s,e,t,n)=>{for(var o=n>1?void 0:n?Md(e,t):e,r=s.length-1,a;r>=0;r--)(a=s[r])&&(o=a(o)||o);return o},_d=(s,e)=>(t,n)=>e(t,n,s);let Dn=class extends i.Disposable{constructor(s){super(),this._sheetInterceptorService=s,this._initialize()}_initialize(){this._initInterceptorCellContent()}_initInterceptorCellContent(){this.disposeWithMe(this._sheetInterceptorService.intercept(Ae.CELL_CONTENT,{priority:11,effect:i.InterceptorEffectEnum.Value|i.InterceptorEffectEnum.Style,handler:(s,e,t)=>{var o;if(!s)return t(s);const n=e.workbook.getStyles().getStyleByCell(s);return i.isDefaultFormat((o=n==null?void 0:n.n)==null?void 0:o.pattern)&&(s==null?void 0:s.t)===i.CellValueType.NUMBER&&s.v!==void 0&&s.v!==null&&i.isRealNum(s.v)&&((!s||s===e.rawData)&&(s={...e.rawData}),s.v=J.stripErrorMargin(Number(s.v))),t(s)}}))}};Dn=yd([_d(0,i.Inject(g.SheetInterceptorService))],Dn);var bd=Object.getOwnPropertyDescriptor,Ed=(s,e,t,n)=>{for(var o=n>1?void 0:n?bd(e,t):e,r=s.length-1,a;r>=0;r--)(a=s[r])&&(o=a(o)||o);return o},An=(s,e)=>(t,n)=>e(t,n,s);let Wn=class extends i.Disposable{constructor(s,e,t,n){super(),this._permissionService=s,this._worksheetProtectionRuleModel=e,this._sheetInterceptorService=t,this._rangeProtectionCache=n,this._initViewModelByRangeInterceptor(),this._initViewModelBySheetInterceptor()}_initViewModelByRangeInterceptor(){this.disposeWithMe(this._sheetInterceptorService.intercept(Ae.CELL_CONTENT,{priority:999,effect:i.InterceptorEffectEnum.Value|i.InterceptorEffectEnum.Style,handler:(s,e,t)=>{const{unitId:n,subUnitId:o,row:r,col:a}=e,l=this._rangeProtectionCache.getCellInfo(n,o,r,a);if(l){const u=l[_.View]===!1,d=!s||s===e.rawData?{...e.rawData}:s;return d.selectionProtection=[l],u?(delete d.s,delete d.v,delete d.p,d):t(d)}return t(s)}}))}_initViewModelBySheetInterceptor(){this.disposeWithMe(this._sheetInterceptorService.intercept(Ae.CELL_CONTENT,{priority:999,effect:i.InterceptorEffectEnum.Value|i.InterceptorEffectEnum.Style,handler:(s,e,t)=>{var a,l,u,d,c;const{unitId:n,subUnitId:o}=e,r=this._worksheetProtectionRuleModel.getRule(n,o);if(r!=null&&r.permissionId){const m=[{[_.View]:(l=(a=this._permissionService.getPermissionPoint(new $t(n,o).id))==null?void 0:a.value)!=null?l:!1,[_.Edit]:(d=(u=this._permissionService.getPermissionPoint(new fe(n,o).id))==null?void 0:u.value)!=null?d:!1}],h=!((c=m[0])!=null&&c[_.View]),R=!s||s===e.rawData?{...s}:s;return R.hasWorksheetRule=!0,R.selectionProtection=m,h?(delete R.s,delete R.v,delete R.p,R):t(R)}return t(s)}}))}};Wn=Ed([An(0,i.IPermissionService),An(1,i.Inject(Pe)),An(2,i.Inject(g.SheetInterceptorService)),An(3,i.Inject(g.RangeProtectionCache))],Wn);const eo=i.createIdentifier("univer.exclusive-range-service");class Di extends i.Disposable{constructor(){super(...arguments);f(this,"_exclusiveRanges",new Map);f(this,"_exclusiveRangesChange$",new O.Subject);f(this,"exclusiveRangesChange$",this._exclusiveRangesChange$.asObservable())}_ensureUnitMap(t){return this._exclusiveRanges.has(t)||this._exclusiveRanges.set(t,new Map),this._exclusiveRanges.get(t)}_ensureSubunitMap(t,n){const o=this._ensureUnitMap(t);return o.has(n)||o.set(n,new Map),o.get(n)}_ensureFeature(t,n,o){const r=this._ensureSubunitMap(t,n);return r.has(o)||r.set(o,[]),r.get(o)}addExclusiveRange(t,n,o,r){const a=this._ensureFeature(t,n,o);a.push(...r),this._exclusiveRangesChange$.next({unitId:t,subUnitId:n,ranges:a.map(l=>l.range)})}getExclusiveRanges(t,n,o){var r,a;return(a=(r=this._exclusiveRanges.get(t))==null?void 0:r.get(n))==null?void 0:a.get(o)}clearExclusiveRanges(t,n,o){const r=this.getExclusiveRanges(t,n,o);this._exclusiveRangesChange$.next({unitId:t,subUnitId:n,ranges:(r==null?void 0:r.map(a=>a.range))||[]}),this._ensureFeature(t,n,o),this._exclusiveRanges.get(t).get(n).set(o,[])}clearExclusiveRangesByGroupId(t,n,o,r){const a=this.getExclusiveRanges(t,n,o);this._exclusiveRangesChange$.next({unitId:t,subUnitId:n,ranges:(a==null?void 0:a.map(u=>u.range))||[]});const l=this.getExclusiveRanges(t,n,o);if(l){const u=l.filter(d=>d.groupId!==r);this._exclusiveRanges.get(t).get(n).set(o,u)}}getInterestGroupId(t){const n=[];return t.forEach(o=>{var d;const r=o.range,{unitId:a,sheetId:l}=r;if(!a||!l)return;const u=(d=this._exclusiveRanges.get(a))==null?void 0:d.get(l);if(u)for(const c of u.keys()){const m=u.get(c);if(m){for(const h of m)if(i.Rectangle.intersects(r,h.range)){n.push(c);break}}}}),n}}var Td=Object.getOwnPropertyDescriptor,Ud=(s,e,t,n)=>{for(var o=n>1?void 0:n?Td(e,t):e,r=s.length-1,a;r>=0;r--)(a=s[r])&&(o=a(o)||o);return o},to=(s,e)=>(t,n)=>e(t,n,s);g.NumfmtService=class extends i.Disposable{constructor(e,t,n){super(),this._resourceManagerService=e,this._univerInstanceService=t,this._logService=n}getValue(e,t,n,o){const r=this._univerInstanceService.getUniverSheetInstance(e);if(!r)return;const a=r==null?void 0:r.getSheetBySheetId(t);if(!a)return;const l=r.getStyles(),u=a.getCellRaw(n,o);if(u!=null&&u.s){const d=l.get(u.s);if(d!=null&&d.n)return d.n}return null}deleteValues(e,t,n){const o=this._univerInstanceService.getUniverSheetInstance(e);if(!o)return;const r=o==null?void 0:o.getSheetBySheetId(t);if(!r)return;const a=o.getStyles();n.forEach(l=>{i.Range.foreach(l,(u,d)=>{const c=r.getCellRaw(u,d);if(!c)return;const m=c==null?void 0:c.s,R={...m&&a.get(m)||{}};delete R.n;const C=a.setValue(R);c.s=C})})}setValues(e,t,n){const o=this._univerInstanceService.getUniverSheetInstance(e);if(!o)return;const r=o==null?void 0:o.getSheetBySheetId(t);if(!r)return;const a=o.getStyles(),l=r.getCellMatrix();n.forEach(u=>{u.ranges.forEach(d=>{i.Range.foreach(d,(c,m)=>{const h=r.getCellRaw(c,m);if(h){const C={...a.getStyleByCell(h)||{},n:{pattern:u.pattern}},S=a.setValue(C);h.s=S}else{const R={n:{pattern:u.pattern}},C=a.setValue(R);C&&l.setValue(c,m,{s:C})}})})})}},g.NumfmtService=Ud([to(0,i.IResourceManagerService),to(1,i.IUniverInstanceService),to(2,i.ILogService)],g.NumfmtService);var kd=Object.getOwnPropertyDescriptor,Pd=(s,e,t,n)=>{for(var o=n>1?void 0:n?kd(e,t):e,r=s.length-1,a;r>=0;r--)(a=s[r])&&(o=a(o)||o);return o},Ye=(s,e)=>(t,n)=>e(t,n,s);const Ai=[ie.id,re.id,ne.id,ae.id],Wi=[pe.id,we.id];g.RangeProtectionRefRangeService=class extends i.Disposable{constructor(t,n,o,r,a,l,u,d){super();f(this,"disposableCollection",new i.DisposableCollection);this._selectionProtectionRuleModel=t,this._univerInstanceService=n,this._commandService=o,this._refRangeService=r,this._selectionProtectionRenderModel=a,this._rangeProtectionCache=l,this._sheetInterceptorService=u,this._rangeProtectionRuleModel=d,this._onRefRangeChange(),this._correctPermissionRange(),this._initReBuildCache(),this._initRemoveSheet()}_onRefRangeChange(){const t=(o,r)=>{const a=this._univerInstanceService.getCurrentUnitForType(i.UniverInstanceType.UNIVER_SHEET);if(!a||!(a==null?void 0:a.getSheetBySheetId(r)))return;this.disposableCollection.dispose();const u=c=>this.refRangeHandle(c,o,r);this._selectionProtectionRuleModel.getSubunitRuleList(o,r).reduce((c,m)=>[...c,...m.ranges],[]).forEach(c=>{this.disposableCollection.add(this._refRangeService.registerRefRange(c,u,o,r))})};this.disposeWithMe(this._commandService.onCommandExecuted(o=>{if(o.id===Gs.id){const r=o.params,a=r.subUnitId,l=r.unitId;if(!a||!l)return;t(l,a)}if(o.id===Q.id||o.id===Ce.id){const r=o.params,a=r.subUnitId,l=r.unitId;if(!a||!l)return;t(l,a)}}));const n=this._univerInstanceService.getCurrentUnitForType(i.UniverInstanceType.UNIVER_SHEET);if(n){const o=n.getActiveSheet();if(!o)return;t(n.getUnitId(),o.getSheetId())}}refRangeHandle(t,n,o){switch(t.id){case wt.id:return this._getRefRangeMutationsByMoveRows(t.params,n,o);case Mt.id:return this._getRefRangeMutationsByMoveCols(t.params,n,o);case Me.id:return this._getRefRangeMutationsByInsertRows(t.params,n,o);case ye.id:return this._getRefRangeMutationsByInsertCols(t.params,n,o);case Bt.id:return this._getRefRangeMutationsByDeleteCols(t.params,n,o);case Lt.id:return this._getRefRangeMutationsByDeleteRows(t.params,n,o)}return{redos:[],undos:[]}}_getRefRangeMutationsByDeleteCols(t,n,o){const r=this._selectionProtectionRuleModel.getSubunitRuleList(n,o).filter(l=>l.ranges.some(u=>i.Rectangle.intersects(u,t.range))),a=t.range;if(r.length){const l=[],u=[];return r.forEach(d=>{const c=i.Tools.deepClone(d),m=c.ranges.reduce((h,R)=>{if(i.Rectangle.intersects(R,a)){const C=i.Tools.deepClone(R),{startColumn:S,endColumn:I}=a;if(S<=C.startColumn&&I>=C.endColumn)return h;S>=C.startColumn&&I<=C.endColumn?C.endColumn-=I-S+1:S<C.startColumn?(C.startColumn=S,C.endColumn-=I-S+1):I>C.endColumn&&(C.endColumn=S-1),this._checkIsRightRange(C)&&h.push(C)}return h},[]);c.ranges=m,c.ranges.length?(l.push({id:Q.id,params:{unitId:n,subUnitId:o,rule:c,ruleId:d.id}}),u.push({id:Q.id,params:{unitId:n,subUnitId:o,rule:d,ruleId:d.id}})):(l.push({id:Te.id,params:{unitId:n,subUnitId:o,ruleIds:[d.id]}}),u.push({id:Ce.id,params:{unitId:n,subUnitId:o,name:"",rules:[d]}}))}),{redos:l,undos:u}}return{undos:[],redos:[]}}_getRefRangeMutationsByDeleteRows(t,n,o){const r=this._selectionProtectionRuleModel.getSubunitRuleList(n,o).filter(l=>l.ranges.some(u=>i.Rectangle.intersects(u,t.range))),a=t.range;if(r.length){const l=[],u=[];return r.forEach(d=>{const c=i.Tools.deepClone(d),m=c.ranges.reduce((h,R)=>{if(i.Rectangle.intersects(R,a)){const C=i.Tools.deepClone(R),{startRow:S,endRow:I}=a;if(S<=C.startRow&&I>=C.endRow)return h;S>=C.startRow&&I<=C.endRow?C.endRow-=I-S+1:S<C.startRow?(C.startRow=S,C.endRow-=I-S+1):I>C.endRow&&(C.endRow=S-1),this._checkIsRightRange(C)&&h.push(C)}return h},[]);c.ranges=m,l.push({id:Q.id,params:{unitId:n,subUnitId:o,rule:c,ruleId:d.id}}),u.push({id:Q.id,params:{unitId:n,subUnitId:o,rule:d,ruleId:d.id}})}),{redos:l,undos:u}}return{undos:[],redos:[]}}_getRefRangeMutationsByInsertCols(t,n,o){const r=t.range.startColumn,a=t.range.endColumn-t.range.startColumn+1,l=this._selectionProtectionRuleModel.getSubunitRuleList(n,o).filter(u=>u.ranges.some(d=>r>d.startColumn&&r<=d.endColumn));if(l.length){const u=[],d=[];return l.forEach(c=>{const m=i.Tools.deepClone(c);let h=!1;m.ranges.forEach(R=>{r>R.startColumn&&r<=R.endColumn&&(R.endColumn+=a,h=!0)}),h&&(u.push({id:Q.id,params:{unitId:n,subUnitId:o,rule:m,ruleId:c.id}}),d.push({id:Q.id,params:{unitId:n,subUnitId:o,rule:c,ruleId:c.id}}))}),{redos:u,undos:d}}return{undos:[],redos:[]}}_getRefRangeMutationsByInsertRows(t,n,o){const r=t.range.startRow,a=t.range.endRow-t.range.startRow+1,l=this._selectionProtectionRuleModel.getSubunitRuleList(n,o).filter(u=>u.ranges.some(d=>r>d.startRow&&r<=d.endRow));if(l.length){const u=[],d=[];return l.forEach(c=>{const m=i.Tools.deepClone(c);let h=!1;m.ranges.forEach(R=>{r>R.startRow&&r<=R.endRow&&(R.endRow+=a,h=!0)}),h&&(u.push({id:Q.id,params:{unitId:n,subUnitId:o,rule:m,ruleId:c.id}}),d.push({id:Q.id,params:{unitId:n,subUnitId:o,rule:c,ruleId:c.id}}))}),{redos:u,undos:d}}return{undos:[],redos:[]}}_getRefRangeMutationsByMoveRows(t,n,o){const r=t.toRange,a=r.startRow,l=r.endRow-r.startRow+1,u=this._selectionProtectionRuleModel.getSubunitRuleList(n,o).filter(d=>d.ranges.some(c=>a>c.startRow&&a<=c.endRow));if(u.length){const d=[],c=[];return u.forEach(m=>{const h=i.Tools.deepClone(m),C=t.fromRange.startRow;let S=!1;h.ranges.forEach(I=>{a>I.startRow&&a<=I.endRow&&(C<I.startRow&&(I.startRow=I.startRow-l,I.endRow=I.endRow-l),I.endRow+=l,S=!0)}),S&&(d.push({id:Q.id,params:{unitId:n,subUnitId:o,rule:h,ruleId:m.id}}),c.push({id:Q.id,params:{unitId:n,subUnitId:o,rule:m,ruleId:m.id}}))}),{redos:d,undos:c}}return{undos:[],redos:[]}}_getRefRangeMutationsByMoveCols(t,n,o){const r=t.toRange,a=r.startColumn,l=r.endColumn-r.startColumn+1,u=this._selectionProtectionRuleModel.getSubunitRuleList(n,o).filter(d=>d.ranges.some(c=>a>c.startColumn&&a<=c.endColumn));if(u.length){const d=[],c=[];return u.forEach(m=>{const h=i.Tools.deepClone(m),C=t.fromRange.startColumn;let S=!1;h.ranges.forEach(I=>{a>I.startColumn&&a<=I.endColumn&&(C<I.startColumn&&(I.startColumn=I.startColumn-l,I.endColumn=I.endColumn-l),I.endColumn+=l,S=!0)}),S&&(d.push({id:Q.id,params:{unitId:n,subUnitId:o,rule:h,ruleId:m.id}}),c.push({id:Q.id,params:{unitId:n,subUnitId:o,rule:m,ruleId:m.id}}))}),{redos:d,undos:c}}return{undos:[],redos:[]}}_correctPermissionRange(){this.disposeWithMe(this._commandService.onCommandExecuted(t=>{if(Wi.includes(t.id)){if(!t.params)return;const n=this._univerInstanceService.getCurrentUnitForType(i.UniverInstanceType.UNIVER_SHEET);if(!n)return;const o=n.getSheetBySheetId(t.params.subUnitId);if(!o)return;const{sourceRange:r,targetRange:a}=t.params,l=r.startColumn===a.startColumn&&r.endColumn===a.endColumn,u=l?r.endRow-r.startRow+1:r.endColumn-r.startColumn+1,d=l?r.startRow:r.startColumn,c=l?a.startRow:a.startColumn;this._selectionProtectionRuleModel.getSubunitRuleList(n.getUnitId(),o.getSheetId()).forEach(I=>{I.ranges.forEach(M=>{let{startRow:p,endRow:w,startColumn:y,endColumn:b}=M;i.Rectangle.intersects(M,r)||(l?d<p&&c>w?(p-=u,w-=u):d>w&&c<=p&&(p+=u,w+=u):d<y&&c>b?(y-=u,b-=u):d>b&&c<=y&&(y+=u,b+=u)),this._checkIsRightRange({startRow:p,endRow:w,startColumn:y,endColumn:b})&&(M.startColumn=y,M.endColumn=b,M.startRow=p,M.endRow=w)})}),this.disposableCollection.dispose();const{unitId:h,subUnitId:R}=t.params,C=I=>this.refRangeHandle(I,h,R);this._selectionProtectionRuleModel.getSubunitRuleList(h,R).reduce((I,v)=>[...I,...v.ranges],[]).forEach(I=>{this.disposableCollection.add(this._refRangeService.registerRefRange(I,C,h,R))}),this._selectionProtectionRenderModel.clear()}if(Ai.includes(t.id)){const n=this._univerInstanceService.getUniverSheetInstance(t.params.unitId);if(!n)return;const o=n.getSheetBySheetId(t.params.subUnitId);if(!o)return;const r=t.params;if(!r)return;const{range:a}=r,l=t.id.includes("row"),u=t.id.includes("insert"),d=l?a.startRow:a.startColumn,c=l?a.endRow:a.endColumn,m=c-d+1;this._selectionProtectionRuleModel.getSubunitRuleList(n.getUnitId(),o.getSheetId()).forEach(v=>{v.ranges.forEach(p=>{let{startRow:w,endRow:y,startColumn:b,endColumn:E}=p;u?l?d<=w&&(w+=m,y+=m):d<=b&&(b+=m,E+=m):l?c<w&&(w-=m,y-=m):c<b&&(b-=m,E-=m),this._checkIsRightRange({startRow:w,endRow:y,startColumn:b,endColumn:E})&&(p.startColumn=b,p.endColumn=E,p.startRow=w,p.endRow=y)})}),this.disposableCollection.dispose();const{unitId:R,subUnitId:C}=t.params,S=v=>this.refRangeHandle(v,R,C);this._selectionProtectionRuleModel.getSubunitRuleList(R,C).reduce((v,M)=>[...v,...M.ranges],[]).forEach(v=>{this.disposableCollection.add(this._refRangeService.registerRefRange(v,S,R,C))}),this._selectionProtectionRenderModel.clear()}}))}_checkIsRightRange(t){return t.startRow<=t.endRow&&t.startColumn<=t.endColumn}_initReBuildCache(){this.disposeWithMe(this._commandService.onCommandExecuted(t=>{if(Ai.includes(t.id)||Wi.includes(t.id)){const{unitId:n,subUnitId:o}=t.params;this._rangeProtectionCache.reBuildCache(n,o)}}))}_initRemoveSheet(){this._sheetInterceptorService.interceptCommand({getMutations:t=>{const n=[],o=[],r=[],a=[];if(t.id===pn.id){const l=t.params,u=[],d=[];this._rangeProtectionRuleModel.getSubunitRuleList(l.unitId,l.subUnitId).forEach(c=>{u.push(c.id),d.push(c)}),u.length&&d.length&&(r.push({id:Te.id,params:{unitId:l.unitId,subUnitId:l.subUnitId,ruleIds:u}}),n.push({id:Ce.id,params:{unitId:l.unitId,subUnitId:l.subUnitId,name:"",rules:d}}))}return{redos:o,undos:n,preRedos:r,preUndos:a}}})}},g.RangeProtectionRefRangeService=Pd([Ye(0,i.Inject(X)),Ye(1,i.Inject(i.IUniverInstanceService)),Ye(2,i.ICommandService),Ye(3,i.Inject(g.RefRangeService)),Ye(4,i.Inject(g.RangeProtectionRenderModel)),Ye(5,i.Inject(g.RangeProtectionCache)),Ye(6,i.Inject(g.SheetInterceptorService)),Ye(7,i.Inject(X))],g.RangeProtectionRefRangeService);var Nd=Object.getOwnPropertyDescriptor,Od=(s,e,t,n)=>{for(var o=n>1?void 0:n?Nd(e,t):e,r=s.length-1,a;r>=0;r--)(a=s[r])&&(o=a(o)||o);return o},Qt=(s,e)=>(t,n)=>e(t,n,s);const Dd="SHEET_RANGE_PROTECTION_PLUGIN";g.RangeProtectionService=class extends i.Disposable{constructor(e,t,n,o,r){super(),this._selectionProtectionRuleModel=e,this._permissionService=t,this._resourceManagerService=n,this._selectionProtectionCache=o,this._univerInstanceService=r,this._initSnapshot(),this._initRuleChange()}_initRuleChange(){this.disposeWithMe(this._selectionProtectionRuleModel.ruleChange$.subscribe(e=>{switch(e.type){case"add":{ue().forEach(t=>{const n=new t(e.unitId,e.subUnitId,e.rule.permissionId);this._permissionService.addPermissionPoint(n)});break}case"delete":{ue().forEach(t=>{const n=new t(e.unitId,e.subUnitId,e.rule.permissionId);this._permissionService.deletePermissionPoint(n.id)});break}case"set":{e.oldRule.permissionId!==e.rule.permissionId&&ue().forEach(t=>{const n=new t(e.unitId,e.subUnitId,e.oldRule.permissionId);this._permissionService.deletePermissionPoint(n.id);const o=new t(e.unitId,e.subUnitId,e.rule.permissionId);this._permissionService.addPermissionPoint(o)});break}}}))}_initSnapshot(){const e=n=>{const r=this._selectionProtectionRuleModel.toObject()[n];return r?JSON.stringify(r):""},t=n=>{if(!n)return{};try{return JSON.parse(n)}catch{return{}}};this.disposeWithMe(this._resourceManagerService.registerPluginResource({toJson:e,parseJson:t,pluginName:Dd,businesses:[ln.UNIVER_SHEET],onLoad:(n,o)=>{const r=this._selectionProtectionRuleModel.toObject();r[n]=o,this._selectionProtectionRuleModel.fromObject(r);const a=[];Object.keys(o).forEach(l=>{const u=o[l];this._selectionProtectionRuleModel.getSubunitRuleList(n,l).forEach(d=>{a.push({objectID:d.permissionId,unitID:n,objectType:D.SelectRange,actions:ze})}),u.forEach(d=>{ue().forEach(c=>{const m=new c(n,l,d.permissionId);m.value=!1,this._permissionService.addPermissionPoint(m)})}),this._selectionProtectionCache.reBuildCache(n,l)})},onUnLoad:n=>{this._selectionProtectionCache.deleteUnit(n)}}))}},g.RangeProtectionService=Od([Qt(0,i.Inject(X)),Qt(1,i.Inject(i.IPermissionService)),Qt(2,i.Inject(i.IResourceManagerService)),Qt(3,i.Inject(g.RangeProtectionCache)),Qt(4,i.Inject(i.IUniverInstanceService))],g.RangeProtectionService);var Ad=Object.getOwnPropertyDescriptor,Wd=(s,e,t,n)=>{for(var o=n>1?void 0:n?Ad(e,t):e,r=s.length-1,a;r>=0;r--)(a=s[r])&&(o=a(o)||o);return o},Vd=(s,e)=>(t,n)=>e(t,n,s);g.SheetRangeThemeService=class extends i.Disposable{constructor(e){super(),this._sheetRangeThemeModel=e}registerRangeTheme(e,t){this._sheetRangeThemeModel.registerRangeThemeStyle(e,t)}removeRangeThemeRule(e,t){this._sheetRangeThemeModel.removeRangeThemeRule(e,t)}getALLRegisterThemes(e){return this._sheetRangeThemeModel.getALLRegisteredTheme(e)}registerRangeThemeStyle(e,t){this._sheetRangeThemeModel.registerRangeThemeRule(e,t)}getAppliedRangeThemeStyle(e){return this._sheetRangeThemeModel.getRegisteredRangeThemeStyle(e)}getRegisteredRangeThemes(){return this._sheetRangeThemeModel.getRegisteredRangeThemes()}},g.SheetRangeThemeService=Wd([Vd(0,i.Inject(g.SheetRangeThemeModel))],g.SheetRangeThemeService);var $d=Object.defineProperty,Ld=Object.getOwnPropertyDescriptor,Bd=(s,e,t)=>e in s?$d(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,Hd=(s,e,t,n)=>{for(var o=n>1?void 0:n?Ld(e,t):e,r=s.length-1,a;r>=0;r--)(a=s[r])&&(o=a(o)||o);return o},Vi=(s,e)=>(t,n)=>e(t,n,s),$i=(s,e,t)=>Bd(s,typeof e!="symbol"?e+"":e,t);const Fd="SHEET_PLUGIN";g.UniverSheetsPlugin=class extends i.Plugin{constructor(e=Nr,t,n){super(),this._config=e,this._injector=t,this._configService=n;const{...o}=i.merge({},Nr,this._config);this._configService.setConfig(Gt,o),this._initConfig(),this._initDependencies()}_initConfig(){var e,t,n;(e=this._config)!=null&&e.onlyRegisterFormulaRelatedMutations&&this._configService.setConfig(Ni,!0),(t=this._config)!=null&&t.isRowStylePrecedeColumnStyle&&this._configService.setConfig(i.IS_ROW_STYLE_PRECEDE_COLUMN_STYLE,!0),(n=this._config)!=null&&n.autoHeightForMergedCells&&this._configService.setConfig(i.AUTO_HEIGHT_FOR_MERGED_CELLS,!0)}_initDependencies(){var t;const e=[[st],[g.SheetLazyExecuteScheduleService],[g.SheetsSelectionsService],[g.RefRangeService],[g.WorkbookPermissionService],[rt,{useClass:g.NumfmtService}],[g.SheetInterceptorService],[g.SheetRangeThemeService],[g.SheetSkeletonService],[Nn],[g.MergeCellController],[Dn],[g.DefinedNameDataController],[g.ZebraCrossingCacheController],[g.SheetsFreezeSyncController],[g.WorksheetPermissionService],[Pe],[kt],[Wn],[g.SheetPermissionInitController],[g.SheetPermissionCheckController],[g.SheetRangeThemeModel],[g.RangeProtectionRenderModel],[X],[g.RangeProtectionCache],[g.RangeProtectionRefRangeService],[g.RangeProtectionService],[eo,{useClass:Di,deps:[g.SheetsSelectionsService]}]];(t=this._config)!=null&&t.notExecuteFormula||e.push([On]),i.registerDependencies(this._injector,i.mergeOverrideWithDependencies(e,this._config.override)),i.touchDependencies(this._injector,[[g.SheetInterceptorService],[g.RangeProtectionService],[eo],[g.SheetPermissionInitController],[g.SheetsFreezeSyncController]])}onStarting(){i.touchDependencies(this._injector,[[Nn],[g.MergeCellController],[g.WorkbookPermissionService],[g.WorksheetPermissionService],[Wn],[g.SheetSkeletonService]])}onRendered(){i.touchDependencies(this._injector,[[rt]])}onReady(){i.touchDependencies(this._injector,[[On],[g.DefinedNameDataController],[g.ZebraCrossingCacheController],[g.SheetRangeThemeModel],[Dn],[g.RangeProtectionRenderModel],[g.RangeProtectionRefRangeService],[g.RefRangeService],[g.SheetPermissionCheckController]])}},$i(g.UniverSheetsPlugin,"pluginName",Fd),$i(g.UniverSheetsPlugin,"type",i.UniverInstanceType.UNIVER_SHEET),g.UniverSheetsPlugin=Hd([i.DependentOn(J.UniverFormulaEnginePlugin),Vi(1,i.Inject(i.Injector)),Vi(2,i.IConfigService)],g.UniverSheetsPlugin);const jd={WorkbookCommentPermission:Kn,WorkbookCopyPermission:Jn,WorkbookCreateProtectPermission:xn,WorkbookCreateSheetPermission:Xn,WorkbookDeleteSheetPermission:Zn,WorkbookDuplicatePermission:Qn,WorkbookEditablePermission:me,WorkbookExportPermission:es,WorkbookHideSheetPermission:dn,WorkbookHistoryPermission:qo,WorkbookManageCollaboratorPermission:cn,WorkbookMoveSheetPermission:mn,WorkbookPrintPermission:ts,WorkbookRecoverHistoryPermission:ns,WorkbookRenameSheetPermission:hn,WorkbookSharePermission:ss,WorkbookViewHistoryPermission:rs,WorkbookViewPermission:os,WorksheetCopyPermission:is,WorksheetDeleteColumnPermission:as,WorksheetDeleteProtectionPermission:ls,WorksheetDeleteRowPermission:us,WorksheetEditExtraObjectPermission:ds,WorksheetEditPermission:fe,WorksheetFilterPermission:cs,WorksheetInsertColumnPermission:ms,WorksheetInsertHyperlinkPermission:hs,WorksheetInsertRowPermission:gs,WorksheetManageCollaboratorPermission:Rs,WorksheetPivotTablePermission:Cs,WorksheetSetCellStylePermission:Ss,WorksheetSetCellValuePermission:Vt,WorksheetSetColumnStylePermission:ft,WorksheetSetRowStylePermission:It,WorksheetSortPermission:fs,WorksheetViewPermission:$t,RangeProtectionPermissionEditPoint:Se,RangeProtectionPermissionViewPoint:un},Gd=(s,e,t,n)=>{const o=s.get(i.IPermissionService),r=s.get(X),a=o.getPermissionPoint(new me(e).id);if(!(a!=null&&a.value))return!1;const l=o.getPermissionPoint(new fe(e,t).id);if(!(l!=null&&l.value))return!1;const d=r.getSubunitRuleList(e,t).filter(c=>c.ranges.some(m=>n.some(h=>i.Rectangle.intersects(m,h))));return d.length?d.every(c=>{const m=c.permissionId,h=o.getPermissionPoint(new Se(e,t,m).id);return!!(h!=null&&h.value)}):!0},Li=(s,e,t,n=1,o=!0,r=!0)=>{const a=i.Range.transformRange(s,e),{startRow:l,endRow:u}=a;let d=t.startRow-n,c=e.getMergedCell(d,t.startColumn),m=!c||c.startRow===d&&c.startColumn===t.startColumn;for(;!e.getRowVisible(d)||!m;)d--,c=e.getMergedCell(d,t.startColumn),m=!c||c.startRow===d&&c.startColumn===t.startColumn;if(d>=l)return{...t,startRow:d,endRow:d};if(r){const h={...t,startRow:u,endRow:u};return Hi(s,e,h,n,o,!1)}},Bi=(s,e,t,n=1,o=!0,r=!0)=>{const a=i.Range.transformRange(s,e),{startRow:l,endRow:u}=a;let d=t.endRow+n,c=e.getMergedCell(d,t.startColumn),m=!c||c.startRow===d&&c.startColumn===t.startColumn;for(;!e.getRowVisible(d)||!m;)d++,c=e.getMergedCell(d,t.startColumn),m=!c||c.startRow===d&&c.startColumn===t.startColumn;if(d<=u)return{...t,startRow:d,endRow:d};if(r){const h={...t,startRow:l,endRow:l};return Fi(s,e,h,n,o,!1)}},Hi=(s,e,t,n=1,o=!0,r=!0)=>{const a=i.Range.transformRange(s,e),{startColumn:l,endColumn:u}=a;let d=t.startColumn-n,c=e.getMergedCell(t.startRow,d),m=!c||c.startRow===t.startRow&&c.startColumn===d;for(;!e.getColVisible(d)||!m;)d--,c=e.getMergedCell(t.startRow,d),m=!c||c.startRow===t.startRow&&c.startColumn===d;if(d>=l)return{...t,startColumn:d,endColumn:d};if(r){const h={...t,startColumn:u,endColumn:u};return Li(s,e,h,n,o,!1)}},Fi=(s,e,t,n=1,o=!0,r=!0)=>{const a=i.Range.transformRange(s,e),{startColumn:l,endColumn:u}=a;let d=t.endColumn+n,c=e.getMergedCell(t.startRow,d),m=!c||c.startRow===t.startRow&&c.startColumn===d;for(;!e.getColVisible(d)||!m;)d++,c=e.getMergedCell(t.startRow,d),m=!c||c.startRow===t.startRow&&c.startColumn===d;if(d<=u)return{...t,endColumn:d,startColumn:d};if(r){const h={...t,startColumn:l,endColumn:l};return Bi(s,e,h,n,o,!1)}};function Vn(s,e,t){let n=null;return t.getMatrixWithMergedCells(s,e,s,e).forValue((r,a,l)=>(n={actualRow:r,actualColumn:a,startRow:r,startColumn:a,isMerged:l.rowSpan!==void 0||l.colSpan!==void 0,isMergedMainCell:l.rowSpan!==void 0&&l.colSpan!==void 0,endRow:r+(l.rowSpan!==void 0?l.rowSpan-1:0),endColumn:a+(l.colSpan!==void 0?l.colSpan-1:0),rangeType:i.RANGE_TYPE.NORMAL},!1)),n||{actualColumn:e,actualRow:s,startRow:s,startColumn:e,endRow:s,endColumn:e,isMerged:!1,isMergedMainCell:!1,rangeType:i.RANGE_TYPE.NORMAL}}const zd=(s,e,t,n,o=1)=>{switch(n){case i.Direction.UP:return Li(s,e,t,o);case i.Direction.DOWN:return Bi(s,e,t,o);case i.Direction.LEFT:return Hi(s,e,t,o);case i.Direction.RIGHT:return Fi(s,e,t,o)}},qd=(s,e,t)=>{let n,o=-1,r;for(let v=0;v<s.length;v++)if(s[v].primary){n=s[v],o=v,r=n.primary;break}if(o===-1)return null;const a=e===i.Direction.LEFT||e===i.Direction.UP,l=a?o-1>=0?o-1:s.length-1:o+1<s.length?o+1:0,u=s[l];if(!n||!r)return null;const d={...r},{startRow:c,startColumn:m,endRow:h,endColumn:R}=n.range,C=a?d.startRow===c&&d.startColumn===m:d.endRow===h&&d.endColumn===R,S=C&&a;if(!i.Rectangle.equals(n.range,d)){const v=C?u.range:zd(n.range,t,d,e);if(!v)return null;const M=S?Vn(v.endRow,v.endColumn,t):Vn(v.startRow,v.startColumn,t);return{startRow:M.startRow,startColumn:M.startColumn,endRow:M.endRow,endColumn:M.endColumn}}const I=S?Vn(u.range.endRow,u.range.endColumn,t):Vn(u.range.startRow,u.range.startColumn,t);return{startRow:I.startRow,startColumn:I.startColumn,endRow:I.endRow,endColumn:I.endColumn}};g.AFTER_CELL_EDIT=en,g.AddMergeRedoSelectionsOperationFactory=xu,g.AddMergeUndoMutationFactory=ge,g.AddMergeUndoSelectionsOperationFactory=Xu,g.AddRangeProtectionCommand=Ao,g.AddRangeProtectionMutation=Ce,g.AddRangeThemeMutation=wi,g.AddWorksheetMergeAllCommand=au,g.AddWorksheetMergeCommand=jt,g.AddWorksheetMergeHorizontalCommand=uu,g.AddWorksheetMergeMutation=j,g.AddWorksheetMergeVerticalCommand=lu,g.AddWorksheetProtectionCommand=Ur,g.AddWorksheetProtectionMutation=je,g.AppendRowCommand=Pr,g.BEFORE_CELL_EDIT=Ln,g.BorderStyleManagerService=st,g.COMMAND_LISTENER_SKELETON_CHANGE=Na,g.COMMAND_LISTENER_VALUE_CHANGE=Oa,g.CancelFrozenCommand=xr,g.CancelMarkDirtyRowAutoHeightMutation=_i,g.ClearSelectionAllCommand=on,g.ClearSelectionContentCommand=In,g.ClearSelectionFormatCommand=rn,g.CopySheetCommand=Ar,g.CopyWorksheetEndMutation=Ds,g.DISABLE_NORMAL_SELECTIONS=ul,g.DeleteRangeMoveLeftCommand=He,g.DeleteRangeMoveUpCommand=Fe,g.DeleteRangeProtectionCommand=Wr,g.DeleteRangeProtectionMutation=Te,g.DeleteWorksheetProtectionCommand=Vr,g.DeleteWorksheetProtectionMutation=nt,g.DeleteWorksheetRangeThemeStyleCommand=$r,g.DeleteWorksheetRangeThemeStyleMutation=at,g.DeleteWorksheetRangeThemeStyleMutationFactory=uo,g.DeltaColumnWidthCommand=qt,g.DeltaRowHeightCommand=xt,g.EditStateEnum=Do,g.EffectRefRangId=A,g.EmptyMutation=Mi,g.ExclusiveRangeService=Di,g.FactoryAddRangeProtectionMutation=rl,g.FactoryDeleteRangeProtectionMutation=ol,g.FactorySetRangeProtectionMutation=bu,g.IExclusiveRangeService=eo,g.INTERCEPTOR_POINT=Ae,g.INumfmtService=rt,g.IRefSelectionsService=Lo,g.InsertColAfterCommand=or,g.InsertColBeforeCommand=sr,g.InsertColByRangeCommand=Ms,g.InsertColCommand=ye,g.InsertColMutation=ie,g.InsertColMutationUndoFactory=Ot,g.InsertDefinedNameCommand=Lr,g.InsertMultiColsLeftCommand=rr,g.InsertMultiColsRightCommand=ir,g.InsertMultiRowsAboveCommand=er,g.InsertMultiRowsAfterCommand=tr,g.InsertRangeMoveDownCommand=Xe,g.InsertRangeMoveRightCommand=pt,g.InsertRowAfterCommand=Qo,g.InsertRowBeforeCommand=Zo,g.InsertRowByRangeCommand=ws,g.InsertRowCommand=Me,g.InsertRowMutation=re,g.InsertRowMutationUndoFactory=nn,g.InsertSheetCommand=Br,g.InsertSheetMutation=_t,g.InsertSheetUndoMutationFactory=As,g.InterceptCellContentPriority=so,g.MAX_CELL_PER_SHEET_KEY=Ui,g.MERGE_CELL_INTERCEPTOR_CHECK=Tr,g.MarkDirtyRowAutoHeightMutation=yi,g.MoveColsCommand=Mt,g.MoveColsMutation=we,g.MoveColsMutationUndoFactory=mo,g.MoveRangeCommand=xe,g.MoveRangeMutation=Le,g.MoveRowsCommand=wt,g.MoveRowsMutation=pe,g.MoveRowsMutationUndoFactory=co,g.OperatorType=B,g.PermissionPointsDefinitions=jd,g.REF_SELECTIONS_ENABLED=Vo,g.RangeMergeUtil=Ga,g.RangeProtectionPermissionDeleteProtectionPoint=qs,g.RangeProtectionPermissionEditPoint=Se,g.RangeProtectionPermissionManageCollaPoint=Ys,g.RangeProtectionPermissionViewPoint=un,g.RangeProtectionRuleModel=X,g.RangeThemeStyle=We,g.RegisterWorksheetRangeThemeStyleCommand=Hr,g.RegisterWorksheetRangeThemeStyleMutation=bt,g.RemoveColByRangeCommand=_s,g.RemoveColCommand=Bt,g.RemoveColMutation=ne,g.RemoveDefinedNameCommand=Ws,g.RemoveMergeUndoMutationFactory=le,g.RemoveNumfmtMutation=Js,g.RemoveRangeThemeMutation=bi,g.RemoveRowByRangeCommand=ys,g.RemoveRowCommand=Lt,g.RemoveRowMutation=ae,g.RemoveSheetCommand=pn,g.RemoveSheetMutation=Ze,g.RemoveSheetUndoMutationFactory=ar,g.RemoveWorksheetMergeCommand=Fr,g.RemoveWorksheetMergeMutation=G,g.ReorderRangeCommand=Cn,g.ReorderRangeMutation=Dt,g.ReorderRangeUndoMutationFactory=ho,g.ResetBackgroundColorCommand=oi,g.ResetTextColorCommand=ni,g.SCOPE_WORKBOOK_VALUE_DEFINED_NAME=nd,g.SELECTIONS_ENABLED=dl,g.SELECTION_CONTROL_BORDER_BUFFER_COLOR=qa,g.SELECTION_CONTROL_BORDER_BUFFER_WIDTH=za,g.SHEETS_PLUGIN_CONFIG_KEY=Gt,g.ScrollToCellOperation=Ti,g.SelectRangeCommand=Ho,g.SelectionMoveType=te,g.SetBackgroundColorCommand=si,g.SetBoldCommand=ku,g.SetBorderBasicCommand=qr,g.SetBorderColorCommand=zr,g.SetBorderCommand=Et,g.SetBorderPositionCommand=jr,g.SetBorderStyleCommand=Gr,g.SetColDataCommand=Yr,g.SetColDataMutation=lt,g.SetColDataMutationFactory=go,g.SetColHiddenCommand=Mn,g.SetColHiddenMutation=ut,g.SetColVisibleMutation=dt,g.SetColWidthCommand=Yt,g.SetDefinedNameCommand=Ls,g.SetFontFamilyCommand=Au,g.SetFontSizeCommand=Wu,g.SetFrozenCommand=Jr,g.SetFrozenMutation=Ne,g.SetFrozenMutationFactory=Bs,g.SetGridlinesColorCommand=Xr,g.SetGridlinesColorMutation=ct,g.SetHorizontalTextAlignCommand=ii,g.SetItalicCommand=Pu,g.SetNumfmtMutation=kn,g.SetOverlineCommand=Du,g.SetProtectionCommand=Zr,g.SetRangeProtectionMutation=Q,g.SetRangeThemeMutation=Ei,g.SetRangeValuesCommand=vt,g.SetRangeValuesMutation=F,g.SetRangeValuesUndoMutationFactory=ce,g.SetRowDataCommand=Qr,g.SetRowDataMutation=mt,g.SetRowDataMutationFactory=So,g.SetRowHeightCommand=Xt,g.SetRowHiddenCommand=yn,g.SetRowHiddenMutation=Je,g.SetRowVisibleMutation=Ke,g.SetSelectedColsVisibleCommand=$s,g.SetSelectedRowsVisibleCommand=Hs,g.SetSelectionsOperation=q,g.SetSpecificColsVisibleCommand=Tt,g.SetSpecificRowsVisibleCommand=Ut,g.SetStrikeThroughCommand=Ou,g.SetStyleCommand=ee,g.SetTabColorCommand=ui,g.SetTabColorMutation=zt,g.SetTextColorCommand=ti,g.SetTextRotationCommand=li,g.SetTextWrapCommand=ai,g.SetUnderlineCommand=Nu,g.SetVerticalTextAlignCommand=ri,g.SetWorkbookNameCommand=js,g.SetWorkbookNameMutation=Fs,g.SetWorksheetActivateCommand=Gs,g.SetWorksheetActiveOperation=St,g.SetWorksheetColWidthMutation=Ve,g.SetWorksheetColWidthMutationFactory=Fn,g.SetWorksheetColumnCountCommand=di,g.SetWorksheetColumnCountMutation=ht,g.SetWorksheetColumnCountUndoMutationFactory=fo,g.SetWorksheetDefaultStyleCommand=ci,g.SetWorksheetDefaultStyleMutation=gt,g.SetWorksheetDefaultStyleMutationFactory=Io,g.SetWorksheetHideCommand=hi,g.SetWorksheetHideMutation=Ge,g.SetWorksheetNameCommand=_n,g.SetWorksheetNameMutation=Kt,g.SetWorksheetOrderCommand=zs,g.SetWorksheetOrderMutation=Jt,g.SetWorksheetPermissionPointsCommand=Ri,g.SetWorksheetPermissionPointsMutation=En,g.SetWorksheetProtectionCommand=Ci,g.SetWorksheetProtectionMutation=ot,g.SetWorksheetRangeThemeStyleCommand=kr,g.SetWorksheetRangeThemeStyleMutation=it,g.SetWorksheetRangeThemeStyleMutationFactory=lo,g.SetWorksheetRightToLeftCommand=Yu,g.SetWorksheetRightToLeftMutation=Tn,g.SetWorksheetRowAutoHeightMutation=Gn,g.SetWorksheetRowAutoHeightMutationFactory=Pa,g.SetWorksheetRowCountCommand=Si,g.SetWorksheetRowCountMutation=Rt,g.SetWorksheetRowCountUndoMutationFactory=vo,g.SetWorksheetRowHeightMutation=Ee,g.SetWorksheetRowIsAutoHeightCommand=Un,g.SetWorksheetRowIsAutoHeightMutation=Re,g.SetWorksheetShowCommand=Ks,g.SheetSkeletonChangeType=wo,g.SheetValueChangeType=Mo,g.SplitDelimiterEnum=Uo,g.SplitTextToColumnsCommand=fi,g.ToggleCellCheckboxCommand=Ii,g.ToggleGridlinesCommand=vi,g.ToggleGridlinesMutation=Ct,g.UnitAction=_,g.UnitObject=D,g.UnregisterWorksheetRangeThemeStyleCommand=pi,g.UnregisterWorksheetRangeThemeStyleMutation=vn,g.VALIDATE_CELL=tn,g.ViewStateEnum=Oo,g.WorkbookCommentPermission=Kn,g.WorkbookCopyPermission=Jn,g.WorkbookCopySheetPermission=jo,g.WorkbookCreateProtectPermission=xn,g.WorkbookCreateSheetPermission=Xn,g.WorkbookDeleteColumnPermission=Go,g.WorkbookDeleteRowPermission=zo,g.WorkbookDeleteSheetPermission=Zn,g.WorkbookDuplicatePermission=Qn,g.WorkbookEditablePermission=me,g.WorkbookExportPermission=es,g.WorkbookHideSheetPermission=dn,g.WorkbookHistoryPermission=qo,g.WorkbookInsertColumnPermission=Yo,g.WorkbookInsertRowPermission=Ko,g.WorkbookManageCollaboratorPermission=cn,g.WorkbookMoveSheetPermission=mn,g.WorkbookPrintPermission=ts,g.WorkbookRecoverHistoryPermission=ns,g.WorkbookRenameSheetPermission=hn,g.WorkbookSelectionModel=Wo,g.WorkbookSharePermission=ss,g.WorkbookViewHistoryPermission=rs,g.WorkbookViewPermission=os,g.WorksheetCopyPermission=is,g.WorksheetDeleteColumnPermission=as,g.WorksheetDeleteProtectionPermission=ls,g.WorksheetDeleteRowPermission=us,g.WorksheetEditExtraObjectPermission=ds,g.WorksheetEditPermission=fe,g.WorksheetFilterPermission=cs,g.WorksheetInsertColumnPermission=ms,g.WorksheetInsertHyperlinkPermission=hs,g.WorksheetInsertRowPermission=gs,g.WorksheetManageCollaboratorPermission=Rs,g.WorksheetPivotTablePermission=Cs,g.WorksheetProtectionPointModel=kt,g.WorksheetProtectionRuleModel=Pe,g.WorksheetSelectProtectedCellsPermission=Il,g.WorksheetSelectUnProtectedCellsPermission=vl,g.WorksheetSetCellStylePermission=Ss,g.WorksheetSetCellValuePermission=Vt,g.WorksheetSetColumnStylePermission=ft,g.WorksheetSetRowStylePermission=It,g.WorksheetSortPermission=fs,g.WorksheetViewPermission=$t,g.addMergeCellsUtil=du,g.adjustRangeOnMutation=pr,g.alignToMergedCellsBorders=Wt,g.baseProtectionActions=ze,g.checkCellValueType=$n,g.checkRangesEditablePermission=Gd,g.convertPrimaryWithCoordToPrimary=To,g.convertSelectionDataToRange=Ya,g.copyRangeStyles=$e,g.countCells=cr,g.createTopMatrixFromMatrix=bo,g.createTopMatrixFromRanges=_o,g.defaultLargeSheetOperationConfig=Os,g.defaultWorkbookPermissionPoints=gi,g.defaultWorksheetPermissionPoint=bn,g.expandToContinuousRange=Fa,g.factoryRemoveNumfmtUndoMutation=Ju,g.factorySetNumfmtUndoMutation=Ku,g.findAllRectangle=zn,g.findFirstNonEmptyCell=nl,g.followSelectionOperation=Ue,g.generateNullCell=Yn,g.generateNullCellValue=Po,g.getAddMergeMutationRangeByType=Ns,g.getAllRangePermissionPoint=ue,g.getAllWorkbookPermissionPoint=Pt,g.getAllWorksheetPermissionPoint=de,g.getAllWorksheetPermissionPointByPointPanel=Ie,g.getCellAtRowCol=cl,g.getDefaultRangePermission=Hu,g.getInsertRangeMutations=Is,g.getMoveRangeUndoRedoMutations=an,g.getNextPrimaryCell=qd,g.getPrimaryForRange=se,g.getRemoveRangeMutations=vs,g.getSelectionsService=Bo,g.getSeparateEffectedRangesOnCommand=ql,g.getSheetCommandTarget=P,g.getSheetCommandTargetWorkbook=Hn,g.getSheetMutationTarget=ve,g.getSkeletonChangedEffectedRange=Aa,g.getValueChangedEffectedRange=Da,g.getVisibleRanges=At,g.handleBaseInsertRange=et,g.handleBaseMoveRowsCols=Ft,g.handleBaseRemoveRange=Qe,g.handleCommonDefaultRangeChangeWithEffectRefCommands=Ps,g.handleCommonRangeChangeWithEffectRefCommandsSkipNoInterests=Gl,g.handleDefaultRangeChangeWithEffectRefCommands=ks,g.handleDefaultRangeChangeWithEffectRefCommandsSkipNoInterests=jl,g.handleDeleteRangeMoveLeft=Ir,g.handleDeleteRangeMoveUp=vr,g.handleDeleteRangeMutation=wl,g.handleIRemoveCol=Us,g.handleIRemoveRow=gr,g.handleInsertCol=Cr,g.handleInsertRangeMoveDown=Sr,g.handleInsertRangeMoveRight=fr,g.handleInsertRangeMutation=pl,g.handleInsertRow=Rr,g.handleMoveCols=Ts,g.handleMoveRange=hr,g.handleMoveRows=Es,g.isSingleCellSelection=hl,g.rangeMerge=qn,g.rangeToDiscreteRange=No,g.rotateRange=he,g.runRefRangeMutations=tt,g.setEndForRange=ml,g.splitRangeText=ko,g.transformCellsToRange=Pn,Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})}));


// @univerjs/sheets/facade
(function(c,h){typeof exports=="object"&&typeof module<"u"?h(exports,require("@univerjs/core"),require("@univerjs/core/facade"),require("@univerjs/sheets"),require("@univerjs/engine-formula"),require("rxjs"),require("rxjs/operators")):typeof define=="function"&&define.amd?define(["exports","@univerjs/core","@univerjs/core/facade","@univerjs/sheets","@univerjs/engine-formula","rxjs","rxjs/operators"],h):(c=typeof globalThis<"u"?globalThis:c||self,h(c.UniverSheetsFacade={},c.UniverCore,c.UniverCoreFacade,c.UniverSheets,c.UniverEngineFormula,c.rxjs,c.rxjs.operators))})(this,(function(c,h,b,s,P,j,C){"use strict";var De=Object.defineProperty;var je=(c,h,b)=>h in c?De(c,h,{enumerable:!0,configurable:!0,writable:!0,value:b}):c[h]=b;var w=(c,h,b)=>je(c,typeof h!="symbol"?h+"":h,b);var D;var te=Object.getOwnPropertyDescriptor,ne=(r,n,e,t)=>{for(var i=t>1?void 0:t?te(n,e):n,o=r.length-1,a;o>=0;o--)(a=r[o])&&(i=a(i)||i);return i},p=(r,n)=>(e,t)=>n(e,t,r);function ie(r,n,e){const t=e.getDefinedNameMap(r);if(t==null)return n.t("definedName.defaultName")+1;const o=Array.from(Object.values(t)).length+1,a=n.t("definedName.defaultName")+o;if(e.getValueByName(r,a)==null)return a;let d=o+1;for(;;){const u=n.t("definedName.defaultName")+d;if(e.getValueByName(r,u)==null)return u;d++}}class V{constructor(){w(this,"_definedNameParam");this._definedNameParam={id:h.generateRandomId(10),unitId:"",name:"",formulaOrRefString:"",localSheetId:s.SCOPE_WORKBOOK_VALUE_DEFINED_NAME}}setName(n){return this._definedNameParam.name=n,this}setFormula(n){return this._definedNameParam.formulaOrRefString=`=${n}`,this}setRef(n){return this._definedNameParam.formulaOrRefString=n,this}setRefByRange(n,e,t,i){return this._definedNameParam.formulaOrRefString=P.serializeRange({startRow:n,endRow:n+(t!=null?t:1)-1,startColumn:e,endColumn:e+(i!=null?i:1)-1}),this}setComment(n){return this._definedNameParam.comment=n,this}setScopeToWorksheet(n){return this._definedNameParam.localSheetId=n.getSheetId(),this}setScopeToWorkbook(){return this._definedNameParam.localSheetId=s.SCOPE_WORKBOOK_VALUE_DEFINED_NAME,this}setHidden(n){return this._definedNameParam.hidden=n,this}build(){return this._definedNameParam}load(n){return this._definedNameParam=n,this}}let A=class extends b.FBase{constructor(r,n,e,t,i,o,a,d,u,l){super(),this._definedNameParam=r,this._injector=n,this._commandService=e,this._permissionService=t,this._worksheetProtectionRuleModel=i,this._rangeProtectionRuleModel=o,this._worksheetProtectionPointRuleModel=a,this._authzIoService=d,this._localeService=u,this._definedNamesService=l}_apply(){this._definedNameParam.name===""&&(this._definedNameParam.name=ie(this._definedNameParam.unitId,this._localeService,this._definedNamesService)),this._commandService.syncExecuteCommand(s.SetDefinedNameCommand.id,this._definedNameParam)}getName(){return this._definedNameParam.name}setName(r){this._definedNameParam.name=r,this._apply()}setFormula(r){this._definedNameParam.formulaOrRefString=`=${r}`,this._apply()}setRef(r){this._definedNameParam.formulaOrRefString=r,this._apply()}getFormulaOrRefString(){return this._definedNameParam.formulaOrRefString}setRefByRange(r,n,e,t){this._definedNameParam.formulaOrRefString=P.serializeRange({startRow:r,endRow:r+(e!=null?e:1)-1,startColumn:n,endColumn:n+(t!=null?t:1)-1}),this._apply()}getComment(){return this._definedNameParam.comment}setComment(r){this._definedNameParam.comment=r,this._apply()}setScopeToWorksheet(r){this._definedNameParam.localSheetId=r.getSheetId(),this._apply()}setScopeToWorkbook(){this._definedNameParam.localSheetId=s.SCOPE_WORKBOOK_VALUE_DEFINED_NAME,this._apply()}setHidden(r){this._definedNameParam.hidden=r,this._apply()}delete(){this._commandService.syncExecuteCommand(s.RemoveDefinedNameCommand.id,this._definedNameParam)}getLocalSheetId(){return this._definedNameParam.localSheetId}isWorkbookScope(){return this._definedNameParam.localSheetId===s.SCOPE_WORKBOOK_VALUE_DEFINED_NAME}toBuilder(){const r=this._injector.createInstance(V);return r.load(this._definedNameParam),r}};A=ne([p(1,h.Inject(h.Injector)),p(2,h.ICommandService),p(3,h.IPermissionService),p(4,h.Inject(s.WorksheetProtectionRuleModel)),p(5,h.Inject(s.RangeProtectionRuleModel)),p(6,h.Inject(s.WorksheetProtectionPointModel)),p(7,h.Inject(h.IAuthzIoService)),p(8,h.Inject(h.LocaleService)),p(9,P.IDefinedNamesService)],A);var M=(r=>(r[r.Reader=0]="Reader",r[r.Editor=1]="Editor",r[r.Owner=2]="Owner",r))(M||{}),g=(r=>(r.Edit="WorkbookEdit",r.View="WorkbookView",r.Print="WorkbookPrint",r.Export="WorkbookExport",r.Share="WorkbookShare",r.CopyContent="WorkbookCopy",r.DuplicateFile="WorkbookDuplicate",r.Comment="WorkbookComment",r.ManageCollaborator="WorkbookManageCollaborator",r.CreateSheet="WorkbookCreateSheet",r.DeleteSheet="WorkbookDeleteSheet",r.RenameSheet="WorkbookRenameSheet",r.MoveSheet="WorkbookMoveSheet",r.HideSheet="WorkbookHideSheet",r.ViewHistory="WorkbookViewHistory",r.ManageHistory="WorkbookHistory",r.RecoverHistory="WorkbookRecoverHistory",r.CreateProtection="WorkbookCreateProtect",r.InsertRow="WorkbookInsertRow",r.InsertColumn="WorkbookInsertColumn",r.DeleteRow="WorkbookDeleteRow",r.DeleteColumn="WorkbookDeleteColumn",r.CopySheet="WorkbookCopySheet",r))(g||{}),S=(r=>(r.Edit="WorksheetEdit",r.View="WorksheetView",r.Copy="WorksheetCopy",r.SetCellValue="WorksheetSetCellValue",r.SetCellStyle="WorksheetSetCellStyle",r.SetRowStyle="WorksheetSetRowStyle",r.SetColumnStyle="WorksheetSetColumnStyle",r.InsertRow="WorksheetInsertRow",r.InsertColumn="WorksheetInsertColumn",r.DeleteRow="WorksheetDeleteRow",r.DeleteColumn="WorksheetDeleteColumn",r.Sort="WorksheetSort",r.Filter="WorksheetFilter",r.PivotTable="WorksheetPivotTable",r.InsertHyperlink="WorksheetInsertHyperlink",r.EditExtraObject="WorksheetEditExtraObject",r.ManageCollaborator="WorksheetManageCollaborator",r.DeleteProtection="WorksheetDeleteProtection",r.SelectProtectedCells="WorksheetSelectProtectedCells",r.SelectUnProtectedCells="WorksheetSelectUnProtectedCells",r))(S||{}),I=(r=>(r.Edit="RangeEdit",r.View="RangeView",r.ManageCollaborator="RangeManageCollaborator",r.Delete="RangeDeleteProtection",r))(I||{}),re=Object.getOwnPropertyDescriptor,oe=(r,n,e,t)=>{for(var i=t>1?void 0:t?re(n,e):n,o=r.length-1,a;o>=0;o--)(a=r[o])&&(i=a(i)||i);return i},U=(r,n)=>(e,t)=>n(e,t,r);c.FPermission=class extends b.FBase{constructor(e,t,i,o,a,d,u,l){super();w(this,"permissionPointsDefinition",s.PermissionPointsDefinitions);w(this,"rangeRuleChangedAfterAuth$");w(this,"sheetRuleChangedAfterAuth$");w(this,"unitPermissionInitStateChange$");this._injector=e,this._commandService=t,this._permissionService=i,this._worksheetProtectionRuleModel=o,this._rangeProtectionRuleModel=a,this._worksheetProtectionPointRuleModel=d,this._workbookPermissionService=u,this._authzIoService=l,this.rangeRuleChangedAfterAuth$=this._rangeProtectionRuleModel.ruleRefresh$,this.sheetRuleChangedAfterAuth$=this._worksheetProtectionRuleModel.ruleRefresh$,this.unitPermissionInitStateChange$=this._workbookPermissionService.unitPermissionInitStateChange$}setWorkbookPermissionPoint(e,t,i){const o=new t(e);this._permissionService.getPermissionPoint(o.id)||this._permissionService.addPermissionPoint(o),this._permissionService.updatePermissionPoint(o.id,i)}checkWorkbookPermissionPoint(e,t){const i=new t(e),o=this._permissionService.getPermissionPoint(i.id);if(o)return o.value}setWorkbookEditPermission(e,t){this.setWorkbookPermissionPoint(e,s.WorkbookEditablePermission,t)}async addWorksheetBasePermission(e,t,i){let o=[];i!=null&&i.allowedUsers&&(o=i.allowedUsers.map(u=>({id:u,role:M.Editor,subject:void 0})));const a=await this._authzIoService.create({objectType:s.UnitObject.Worksheet,worksheetObject:{collaborators:o,unitID:e,strategies:[],name:(i==null?void 0:i.name)||"",scope:void 0}});if(this._commandService.syncExecuteCommand(s.AddWorksheetProtectionMutation.id,{unitId:e,subUnitId:t,rule:{permissionId:a,unitType:s.UnitObject.Worksheet,unitId:e,subUnitId:t}}))return a}removeWorksheetPermission(e,t){this._commandService.syncExecuteCommand(s.DeleteWorksheetProtectionMutation.id,{unitId:e,subUnitId:t}),[...s.getAllWorksheetPermissionPoint(),...s.getAllWorksheetPermissionPointByPointPanel()].forEach(i=>{const o=new i(e,t);this._permissionService.updatePermissionPoint(o.id,!0)}),this._worksheetProtectionPointRuleModel.deleteRule(e,t)}async setWorksheetPermissionPoint(e,t,i,o){const a=this._worksheetProtectionRuleModel.getRule(e,t);let d;if(i===s.WorksheetEditPermission||i===s.WorksheetViewPermission)a?d=a.permissionId:d=await this.addWorksheetBasePermission(e,t);else{const _=this._worksheetProtectionPointRuleModel.getRule(e,t);_?d=_.permissionId:(d=await this._authzIoService.create({objectType:s.UnitObject.Worksheet,worksheetObject:{collaborators:[],unitID:e,strategies:[],name:"",scope:void 0}}),this._commandService.syncExecuteCommand(s.SetWorksheetPermissionPointsMutation.id,{unitId:e,subUnitId:t,rule:{unitId:e,subUnitId:t,permissionId:d}}))}const l=new i(e,t);return this._permissionService.getPermissionPoint(l.id)||this._permissionService.addPermissionPoint(l),this._permissionService.updatePermissionPoint(l.id,o),d}checkWorksheetPermissionPoint(e,t,i){const o=new i(e,t),a=this._permissionService.getPermissionPoint(o.id);if(a)return a.value}async addRangeBaseProtection(e,t,i,o){var R,f;const a=await this._authzIoService.create({objectType:s.UnitObject.SelectRange,selectRangeObject:{collaborators:(f=(R=o==null?void 0:o.allowedUsers)==null?void 0:R.map(T=>({id:T,role:M.Editor,subject:void 0})))!=null?f:[],unitID:e,name:(o==null?void 0:o.name)||"",scope:void 0}}),d=`ruleId_${h.generateRandomId(6)}`;if(this._rangeProtectionRuleModel.getSubunitRuleList(e,t).some(T=>T.ranges.some(Ue=>i.some(We=>h.Rectangle.intersects(We.getRange(),Ue)))))throw new Error("range protection cannot intersect");const m=this._determineRangeViewState(o),_=this._determineRangeEditState(o),k={unitId:e,subUnitId:t,rules:[{permissionId:a,unitType:s.UnitObject.SelectRange,unitId:e,subUnitId:t,ranges:i.map(T=>T.getRange()),id:d,description:o==null?void 0:o.name,viewState:m,editState:_}]};if(this._commandService.syncExecuteCommand(s.AddRangeProtectionMutation.id,k))return{permissionId:a,ruleId:d}}_determineRangeViewState(e){return(e==null?void 0:e.allowViewByOthers)===!1?s.ViewStateEnum.NoOneElseCanView:s.ViewStateEnum.OthersCanView}_determineRangeEditState(e){var t;return(e==null?void 0:e.allowEdit)===!0&&((t=e==null?void 0:e.allowedUsers)!=null&&t.length)?s.EditStateEnum.DesignedUserCanEdit:s.EditStateEnum.OnlyMe}removeRangeProtection(e,t,i){this._commandService.syncExecuteCommand(s.DeleteRangeProtectionMutation.id,{unitId:e,subUnitId:t,ruleIds:i})&&this._rangeProtectionRuleModel.getSubunitRuleList(e,t).length===0&&(this._worksheetProtectionPointRuleModel.deleteRule(e,t),[...s.getAllWorksheetPermissionPointByPointPanel()].forEach(d=>{const u=new d(e,t);this._permissionService.updatePermissionPoint(u.id,u.value)}))}setRangeProtectionPermissionPoint(e,t,i,o,a){const d=new o(e,t,i);this._permissionService.getPermissionPoint(d.id)||this._permissionService.addPermissionPoint(d),this._permissionService.updatePermissionPoint(d.id,a)}setRangeProtectionRanges(e,t,i,o){const a=this._rangeProtectionRuleModel.getRule(e,t,i);if(a){if(this._rangeProtectionRuleModel.getSubunitRuleList(e,t).filter(l=>l.id!==i).some(l=>l.ranges.some(m=>o.some(_=>h.Rectangle.intersects(_.getRange(),m)))))throw new Error("range protection cannot intersect");this._commandService.syncExecuteCommand(s.SetRangeProtectionMutation.id,{unitId:e,subUnitId:t,ruleId:i,rule:{...a,ranges:o.map(l=>l.getRange())}})}}getPermissionInfoWithCell(e,t,i,o){const a=h.cellToRange(i,o),d=this._rangeProtectionRuleModel.getSubunitRuleList(e,t).find(u=>u.ranges.some(m=>h.Rectangle.intersects(a,m)));if(d)return{permissionId:d.permissionId,ruleId:d.id}}},c.FPermission=oe([U(0,h.Inject(h.Injector)),U(1,h.ICommandService),U(2,h.IPermissionService),U(3,h.Inject(s.WorksheetProtectionRuleModel)),U(4,h.Inject(s.RangeProtectionRuleModel)),U(5,h.Inject(s.WorksheetProtectionPointModel)),U(6,h.Inject(s.WorkbookPermissionService)),U(7,h.Inject(h.IAuthzIoService))],c.FPermission);var se=Object.getOwnPropertyDescriptor,ae=(r,n,e,t)=>{for(var i=t>1?void 0:t?se(n,e):n,o=r.length-1,a;o>=0;o--)(a=r[o])&&(i=a(i)||i);return i},he=(r,n)=>(e,t)=>n(e,t,r);c.FSelection=class{constructor(n,e,t,i){this._workbook=n,this._worksheet=e,this._selections=t,this._injector=i}getActiveRange(){const n=this._selections.find(e=>!!e.primary);return n?this._injector.createInstance(c.FRange,this._workbook,this._worksheet,n.range):null}getActiveRangeList(){return this._selections.map(n=>this._injector.createInstance(c.FRange,this._workbook,this._worksheet,n.range))}getCurrentCell(){const n=this._selections.find(e=>!!e.primary);return n?n.primary:null}getActiveSheet(){const n=this._injector.createInstance(c.FWorkbook,this._workbook);return this._injector.createInstance(c.FWorksheet,n,this._workbook,this._worksheet)}updatePrimaryCell(n){const e=this._injector.get(h.ICommandService);let t=[],i=!1;for(const{range:a,style:d}of this._selections)h.Rectangle.contains(a,n.getRange())?(t.push({range:a,primary:s.getPrimaryForRange(n.getRange(),this._worksheet),style:d}),i=!0):t.push({range:a,primary:null,style:d});i||(t=[{range:n.getRange(),primary:s.getPrimaryForRange(n.getRange(),this._worksheet)}]);const o={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),selections:t};return e.syncExecuteCommand(s.SetSelectionsOperation.id,o),new c.FSelection(this._workbook,this._worksheet,t,this._injector)}getNextDataRange(n){if(!this._selections.find(i=>!!i.primary))return null;const t=s.getNextPrimaryCell(this._selections.concat(),n,this._worksheet);return t?this._injector.createInstance(c.FRange,this._workbook,this._worksheet,t):null}},c.FSelection=ae([he(3,h.Inject(h.Injector))],c.FSelection);var H=(r=>(r[r.Reader=0]="Reader",r[r.Editor=1]="Editor",r[r.Owner=2]="Owner",r[r.UNRECOGNIZED=-1]="UNRECOGNIZED",r))(H||{}),de=Object.getOwnPropertyDescriptor,ue=(r,n,e,t)=>{for(var i=t>1?void 0:t?de(n,e):n,o=r.length-1,a;o>=0;o--)(a=r[o])&&(i=a(i)||i);return i},$=(r,n)=>(e,t)=>n(e,t,r);let E=class{constructor(r,n,e,t,i,o,a,d,u){this._unitId=r,this._subUnitId=n,this._ruleId=e,this._permissionId=t,this._ranges=i,this._options=o,this._injector=a,this._commandService=d,this._rangeProtectionRuleModel=u}get id(){return this._ruleId}get ranges(){return this._ranges}get options(){return{...this._options}}async updateRanges(r){if(!r||r.length===0)throw new Error("Ranges cannot be empty");const n=this._rangeProtectionRuleModel.getRule(this._unitId,this._subUnitId,this._ruleId);if(!n)throw new Error(`Rule ${this._ruleId} not found`);if(this._rangeProtectionRuleModel.getSubunitRuleList(this._unitId,this._subUnitId).filter(i=>i.id!==this._ruleId).some(i=>i.ranges.some(o=>r.some(a=>{const d=a.getRange();return this._rangesIntersect(d,o)}))))throw new Error("Range protection cannot intersect with other protection rules");await this._commandService.executeCommand(s.SetRangeProtectionMutation.id,{unitId:this._unitId,subUnitId:this._subUnitId,ruleId:this._ruleId,rule:{...n,ranges:r.map(i=>i.getRange())}}),this._ranges.length=0,this._ranges.push(...r)}async remove(){await this._commandService.executeCommand(s.DeleteRangeProtectionMutation.id,{unitId:this._unitId,subUnitId:this._subUnitId,ruleIds:[this._ruleId]})}_rangesIntersect(r,n){return!(r.endRow<n.startRow||r.startRow>n.endRow||r.endColumn<n.startColumn||r.startColumn>n.endColumn)}};E=ue([$(6,h.Inject(h.Injector)),$(7,h.Inject(h.ICommandService)),$(8,h.Inject(s.RangeProtectionRuleModel))],E);const x={[g.Edit]:s.WorkbookEditablePermission,[g.View]:s.WorkbookViewPermission,[g.Print]:s.WorkbookPrintPermission,[g.Export]:s.WorkbookExportPermission,[g.Share]:s.WorkbookSharePermission,[g.CopyContent]:s.WorkbookCopyPermission,[g.DuplicateFile]:s.WorkbookDuplicatePermission,[g.Comment]:s.WorkbookCommentPermission,[g.ManageCollaborator]:s.WorkbookManageCollaboratorPermission,[g.CreateSheet]:s.WorkbookCreateSheetPermission,[g.DeleteSheet]:s.WorkbookDeleteSheetPermission,[g.RenameSheet]:s.WorkbookRenameSheetPermission,[g.MoveSheet]:s.WorkbookMoveSheetPermission,[g.HideSheet]:s.WorkbookHideSheetPermission,[g.ViewHistory]:s.WorkbookViewHistoryPermission,[g.ManageHistory]:s.WorkbookHistoryPermission,[g.RecoverHistory]:s.WorkbookRecoverHistoryPermission,[g.CreateProtection]:s.WorkbookCreateProtectPermission,[g.InsertRow]:s.WorkbookInsertRowPermission,[g.InsertColumn]:s.WorkbookInsertColumnPermission,[g.DeleteRow]:s.WorkbookDeleteRowPermission,[g.DeleteColumn]:s.WorkbookDeleteColumnPermission,[g.CopySheet]:s.WorkbookCopySheetPermission},F={[S.Edit]:s.WorksheetEditPermission,[S.View]:s.WorksheetViewPermission,[S.Copy]:s.WorksheetCopyPermission,[S.SetCellValue]:s.WorksheetSetCellValuePermission,[S.SetCellStyle]:s.WorksheetSetCellStylePermission,[S.SetRowStyle]:s.WorksheetSetRowStylePermission,[S.SetColumnStyle]:s.WorksheetSetColumnStylePermission,[S.InsertRow]:s.WorksheetInsertRowPermission,[S.InsertColumn]:s.WorksheetInsertColumnPermission,[S.DeleteRow]:s.WorksheetDeleteRowPermission,[S.DeleteColumn]:s.WorksheetDeleteColumnPermission,[S.Sort]:s.WorksheetSortPermission,[S.Filter]:s.WorksheetFilterPermission,[S.PivotTable]:s.WorksheetPivotTablePermission,[S.InsertHyperlink]:s.WorksheetInsertHyperlinkPermission,[S.EditExtraObject]:s.WorksheetEditExtraObjectPermission,[S.ManageCollaborator]:s.WorksheetManageCollaboratorPermission,[S.DeleteProtection]:s.WorksheetDeleteProtectionPermission,[S.SelectProtectedCells]:s.WorksheetSelectProtectedCellsPermission,[S.SelectUnProtectedCells]:s.WorksheetSelectUnProtectedCellsPermission},N={[I.Edit]:s.RangeProtectionPermissionEditPoint,[I.View]:s.RangeProtectionPermissionViewPoint,[I.ManageCollaborator]:s.RangeProtectionPermissionManageCollaPoint,[I.Delete]:s.RangeProtectionPermissionDeleteProtectionPoint};var le=Object.getOwnPropertyDescriptor,ce=(r,n,e,t)=>{for(var i=t>1?void 0:t?le(n,e):n,o=r.length-1,a;o>=0;o--)(a=r[o])&&(i=a(i)||i);return i},W=(r,n)=>(e,t)=>n(e,t,r);let z=class{constructor(r,n,e,t,i,o,a,d){w(this,"_permissionSubject");w(this,"_rangeRulesSubject");w(this,"permission$");w(this,"pointChange$");w(this,"rangeProtectionChange$");w(this,"rangeProtectionRules$");w(this,"_unitId");w(this,"_subUnitId");w(this,"_subscriptions",[]);w(this,"_fPermission");this._worksheet=r,this._injector=n,this._permissionService=e,this._authzIoService=t,this._commandService=i,this._rangeProtectionRuleModel=o,this._worksheetProtectionPointModel=a,this._worksheetProtectionRuleModel=d,this._unitId=this._worksheet.getWorkbook().getUnitId(),this._subUnitId=this._worksheet.getSheetId(),this._fPermission=this._injector.createInstance(c.FPermission),this._permissionSubject=new j.BehaviorSubject(this._buildSnapshot()),this._rangeRulesSubject=new j.BehaviorSubject(this._buildRangeProtectionRules()),this.permission$=this._createPermissionStream(),this.pointChange$=this._createPointChangeStream(),this.rangeProtectionChange$=this._createRangeProtectionChangeStream(),this.rangeProtectionRules$=this._createRangeProtectionRulesStream()}_createPermissionStream(){const r=this._permissionService.permissionPointUpdate$.pipe(C.filter(n=>n.id.includes(this._unitId)&&n.id.includes(this._subUnitId))).subscribe(()=>{this._permissionSubject.next(this._buildSnapshot())});return this._subscriptions.push(r),this._permissionSubject.asObservable().pipe(C.distinctUntilChanged((n,e)=>JSON.stringify(n)===JSON.stringify(e)),C.shareReplay({bufferSize:1,refCount:!0}))}_createPointChangeStream(){return this._permissionService.permissionPointUpdate$.pipe(C.filter(r=>r.id.includes(this._unitId)&&r.id.includes(this._subUnitId)),C.map(r=>{var e,t;const n=this._extractWorksheetPointType(r.id);return n?{point:n,value:(e=r.value)!=null?e:!1,oldValue:!((t=r.value)!=null&&t)}:null}),C.filter(r=>r!==null),C.shareReplay({bufferSize:1,refCount:!0}))}_createRangeProtectionChangeStream(){return this._rangeProtectionRuleModel.ruleChange$.pipe(C.filter(r=>r.unitId===this._unitId&&r.subUnitId===this._subUnitId),C.map(r=>{const n=this._buildRangeProtectionRules();return{type:r.type==="delete"?"delete":r.type==="set"?"update":"add",rules:n}}),C.shareReplay({bufferSize:1,refCount:!0}))}_createRangeProtectionRulesStream(){const r=this._rangeProtectionRuleModel.ruleChange$.pipe(C.filter(n=>n.unitId===this._unitId&&n.subUnitId===this._subUnitId)).subscribe(()=>{this._rangeRulesSubject.next(this._buildRangeProtectionRules())});return this._subscriptions.push(r),this._rangeRulesSubject.asObservable().pipe(C.distinctUntilChanged((n,e)=>n.length!==e.length?!1:n.every((t,i)=>t.id===e[i].id)),C.shareReplay({bufferSize:1,refCount:!0}))}_extractWorksheetPointType(r){for(const[n,e]of Object.entries(F))if(new e(this._unitId,this._subUnitId).id===r)return n;return null}_getRuleEditPermission(r){var i;const n=N[I.Edit];if(!n)return!1;const e=new n(this._unitId,this._subUnitId,r.permissionId),t=this._permissionService.getPermissionPoint(e.id);return(i=t==null?void 0:t.value)!=null?i:!1}_buildSnapshot(){const r={};for(const n in S){const e=S[n];r[e]=this.getPoint(e)}return r}_buildRangeProtectionRules(){return this._rangeProtectionRuleModel.getSubunitRuleList(this._unitId,this._subUnitId).map(n=>{const e=n.ranges.map(t=>this._worksheet.getRange(t.startRow,t.startColumn,t.endRow-t.startRow+1,t.endColumn-t.startColumn+1));return this._injector.createInstance(E,this._unitId,this._subUnitId,n.id,n.permissionId,e,{name:n.description||"",allowEdit:this._getRuleEditPermission(n)})})}_buildProtectionRule(r){const n=r.ranges.map(t=>this._worksheet.getRange(t)),e={name:r.description||"",allowViewByOthers:r.viewState!==s.ViewStateEnum.NoOneElseCanView};return r.editState===s.EditStateEnum.DesignedUserCanEdit?e.allowEdit=!0:e.allowEdit=!1,this._injector.createInstance(E,this._unitId,this._subUnitId,r.id,r.permissionId,n,e)}debugCellPermission(r,n){const e=this._fPermission.getPermissionInfoWithCell(this._unitId,this._subUnitId,r,n);if(!e)return;const{ruleId:t}=e,i=this._rangeProtectionRuleModel.getRule(this._unitId,this._subUnitId,t);if(i)return this._buildProtectionRule(i)}async protect(r){if(this.isProtected())throw new Error("Worksheet is already protected. Call unprotect() first.");const n=await this._fPermission.addWorksheetBasePermission(this._unitId,this._subUnitId,r);if(!n)throw new Error("Failed to create worksheet protection");return n}async unprotect(){if(!this.isProtected())return;this._fPermission.removeWorksheetPermission(this._unitId,this._subUnitId);const r=this._buildSnapshot();this._permissionSubject.next(r)}isProtected(){return!!this._worksheetProtectionRuleModel.getRule(this._unitId,this._subUnitId)}async setMode(r){const n=this._getModePermissions(r);await this._batchSetPermissionPoints(n)}_getModePermissions(r){const n={};switch(Object.values(S).forEach(e=>{n[e]=!1}),r){case"editable":Object.values(S).forEach(e=>{n[e]=!0});break;case"readOnly":n[S.View]=!0;break;case"filterOnly":n[S.View]=!0,n[S.Sort]=!0,n[S.Filter]=!0;break}return n}async _batchSetPermissionPoints(r){const n=[];for(const[e,t]of Object.entries(r)){const i=e,o=F[i];if(!o)throw new Error(`Unknown worksheet permission point: ${i}`);const a=this.getPoint(i);a!==t&&(await this._fPermission.setWorksheetPermissionPoint(this._unitId,this._subUnitId,o,t),n.push({point:i,value:t,oldValue:a}))}if(n.length>0){const e=this._buildSnapshot();this._permissionSubject.next(e)}}async setReadOnly(){await this.setMode("readOnly")}async setEditable(){await this.setMode("editable")}canEdit(){return this.getPoint(S.Edit)}canEditCell(r,n){if(!this.canEdit())return!1;const e=this._rangeProtectionRuleModel.getSubunitRuleList(this._unitId,this._subUnitId);for(const t of e)for(const i of t.ranges)if(r>=i.startRow&&r<=i.endRow&&n>=i.startColumn&&n<=i.endColumn)return this._getRuleEditPermission(t);return!0}canViewCell(r,n){return this.getPoint(S.View)}async setPoint(r,n){const e=F[r];if(!e)throw new Error(`Unknown worksheet permission point: ${r}`);if(this.getPoint(r)===n)return;await this._fPermission.setWorksheetPermissionPoint(this._unitId,this._subUnitId,e,n);const i=this._buildSnapshot();this._permissionSubject.next(i)}getPoint(r){var i;const n=F[r];if(!n)throw new Error(`Unknown worksheet permission point: ${r}`);const e=new n(this._unitId,this._subUnitId),t=this._permissionService.getPermissionPoint(e.id);return(i=t==null?void 0:t.value)!=null?i:!0}getSnapshot(){return this._buildSnapshot()}async applyConfig(r){if(r.mode&&await this.setMode(r.mode),r.points)for(const[n,e]of Object.entries(r.points))typeof e=="boolean"&&await this.setPoint(n,e);if(r.rangeProtections&&r.rangeProtections.length>0){const n=r.rangeProtections.map(e=>({ranges:e.rangeRefs.map(t=>this._worksheet.getRange(t)),options:e.options}));await this.protectRanges(n)}}async protectRanges(r){if(!r||r.length===0)throw new Error("Configs cannot be empty");const n=await Promise.all(r.map(o=>{var a,d,u,l;return this._authzIoService.create({objectType:s.UnitObject.SelectRange,selectRangeObject:{collaborators:(u=(d=(a=o.options)==null?void 0:a.allowedUsers)==null?void 0:d.map(m=>({id:m,role:H.Editor,subject:void 0})))!=null?u:[],unitID:this._unitId,name:((l=o.options)==null?void 0:l.name)||"",scope:void 0}})})),e=r.map((o,a)=>{var l;const d=this._determineViewState(o.options),u=this._determineEditState(o.options);return{permissionId:n[a],unitType:s.UnitObject.SelectRange,unitId:this._unitId,subUnitId:this._subUnitId,ranges:o.ranges.map(m=>m.getRange()),id:this._rangeProtectionRuleModel.createRuleId(this._unitId,this._subUnitId),description:((l=o.options)==null?void 0:l.name)||"",viewState:d,editState:u}});if(!await this._commandService.executeCommand(s.AddRangeProtectionMutation.id,{unitId:this._unitId,subUnitId:this._subUnitId,rules:e}))throw new Error("Failed to create range protection rules");return await Promise.all(r.map((o,a)=>this._setPermissionPoints(n[a],o.options))),e.map((o,a)=>this._injector.createInstance(E,this._unitId,this._subUnitId,o.id,o.permissionId,r[a].ranges,r[a].options||{}))}_determineViewState(r){return(r==null?void 0:r.allowViewByOthers)===!1?s.ViewStateEnum.NoOneElseCanView:s.ViewStateEnum.OthersCanView}_determineEditState(r){var n;return(r==null?void 0:r.allowEdit)===!0&&((n=r==null?void 0:r.allowedUsers)!=null&&n.length)?s.EditStateEnum.DesignedUserCanEdit:s.EditStateEnum.OnlyMe}async _setPermissionPoints(r,n){if(!n)return;const e=(t,i)=>t===void 0?i:typeof t=="boolean"?t:!0;await this._setPermissionPoint(r,I.Edit,e(n.allowEdit,!1)),await this._setPermissionPoint(r,I.View,e(n.allowViewByOthers,!0))}async _setPermissionPoint(r,n,e){const t=N[n];t&&this._fPermission.setRangeProtectionPermissionPoint(this._unitId,this._subUnitId,r,t,e)}async unprotectRules(r){!r||r.length===0||this._fPermission.removeRangeProtection(this._unitId,this._subUnitId,r)}async listRangeProtectionRules(){return this._buildRangeProtectionRules()}subscribe(r){const n=this.permission$.subscribe(r);return()=>n.unsubscribe()}dispose(){this._subscriptions.forEach(r=>r.unsubscribe()),this._permissionSubject.complete(),this._rangeRulesSubject.complete()}};z=ce([W(1,h.Inject(h.Injector)),W(2,h.IPermissionService),W(3,h.IAuthzIoService),W(4,h.ICommandService),W(5,h.Inject(s.RangeProtectionRuleModel)),W(6,h.Inject(s.WorksheetProtectionPointModel)),W(7,h.Inject(s.WorksheetProtectionRuleModel))],z);function me(r){switch(r){case"left":return h.HorizontalAlign.LEFT;case"center":return h.HorizontalAlign.CENTER;case"normal":return h.HorizontalAlign.RIGHT;default:throw new Error(`Invalid horizontal alignment: ${r}`)}}function Z(r){switch(r){case h.HorizontalAlign.LEFT:return"left";case h.HorizontalAlign.CENTER:return"center";case h.HorizontalAlign.RIGHT:return"normal";default:return"general"}}function ge(r){switch(r){case"top":return h.VerticalAlign.TOP;case"middle":return h.VerticalAlign.MIDDLE;case"bottom":return h.VerticalAlign.BOTTOM;default:throw new Error(`Invalid vertical alignment: ${r}`)}}function Q(r){switch(r){case h.VerticalAlign.TOP:return"top";case h.VerticalAlign.MIDDLE:return"middle";case h.VerticalAlign.BOTTOM:return"bottom";default:return"general"}}function L(r,n){return{startRow:r.startRow,endRow:r.endRow,startColumn:0,endColumn:n.getColumnCount()-1,rangeType:h.RANGE_TYPE.ROW}}function G(r,n){return{startRow:0,endRow:n.getRowCount()-1,startColumn:r.startColumn,endColumn:r.endColumn,rangeType:h.RANGE_TYPE.COLUMN}}var _e=Object.getOwnPropertyDescriptor,Se=(r,n,e,t)=>{for(var i=t>1?void 0:t?_e(n,e):n,o=r.length-1,a;o>=0;o--)(a=r[o])&&(i=a(i)||i);return i},B=(r,n)=>(e,t)=>n(e,t,r);c.FWorksheet=class extends b.FBaseInitialable{constructor(e,t,i,o,a,d,u){super(o);w(this,"setActiveSelection",this.setActiveRange);this._fWorkbook=e,this._workbook=t,this._worksheet=i,this._injector=o,this._selectionManagerService=a,this._logService=d,this._commandService=u}dispose(){super.dispose(),delete this._fWorkbook,delete this._workbook,delete this._worksheet}getSheet(){return this._worksheet}getInject(){return this._injector}getWorkbook(){return this._workbook}getSheetId(){return this._worksheet.getSheetId()}getSheetName(){return this._worksheet.getName()}getSelection(){const e=this._selectionManagerService.getCurrentSelections();return e?this._injector.createInstance(c.FSelection,this._workbook,this._worksheet,e):null}getDefaultStyle(){return this._worksheet.getDefaultCellStyle()}getRowDefaultStyle(e,t=!1){return t?this._worksheet.getRowStyle(e,t):this._worksheet.getRowStyle(e)}getColumnDefaultStyle(e,t=!1){return t?this._worksheet.getColumnStyle(e,t):this._worksheet.getColumnStyle(e)}setDefaultStyle(e){const t=this._workbook.getUnitId(),i=this._worksheet.getSheetId();return this._commandService.syncExecuteCommand(s.SetWorksheetDefaultStyleMutation.id,{unitId:t,subUnitId:i,defaultStyle:e}),this._worksheet.setDefaultCellStyle(e),this}setColumnDefaultStyle(e,t){const i=this._workbook.getUnitId(),o=this._worksheet.getSheetId(),a={unitId:i,subUnitId:o,columnData:{[e]:{s:t}}};return this._commandService.syncExecuteCommand(s.SetColDataCommand.id,a),this}setRowDefaultStyle(e,t){const i=this._workbook.getUnitId(),o=this._worksheet.getSheetId(),a={unitId:i,subUnitId:o,rowData:{[e]:{s:t}}};return this._commandService.syncExecuteCommand(s.SetRowDataCommand.id,a),this}getRange(e,t,i,o){let a,d;if(typeof e=="object")a=e,d=this._worksheet;else if(typeof e=="string"){const{range:u,sheetName:l}=P.deserializeRangeWithSheet(e),m=l?this._workbook.getSheetBySheetName(l):this._worksheet;if(!m)throw new Error("Range not found");d=m,a={...u,unitId:this._workbook.getUnitId(),sheetId:d.getSheetId(),rangeType:h.RANGE_TYPE.NORMAL,startRow:u.rangeType===h.RANGE_TYPE.COLUMN?0:u.startRow,endRow:u.rangeType===h.RANGE_TYPE.COLUMN?d.getMaxRows()-1:u.endRow,startColumn:u.rangeType===h.RANGE_TYPE.ROW?0:u.startColumn,endColumn:u.rangeType===h.RANGE_TYPE.ROW?d.getMaxColumns()-1:u.endColumn}}else if(typeof e=="number"&&t!==void 0)d=this._worksheet,a={startRow:e,endRow:e+(i!=null?i:1)-1,startColumn:t,endColumn:t+(o!=null?o:1)-1,unitId:this._workbook.getUnitId(),sheetId:this._worksheet.getSheetId()};else throw new Error("Invalid range specification");return this._injector.createInstance(c.FRange,this._workbook,d,a)}getMaxColumns(){return this._worksheet.getMaxColumns()}getMaxRows(){return this._worksheet.getMaxRows()}insertRowAfter(e){return this.insertRowsAfter(e,1)}insertRowBefore(e){return this.insertRowsBefore(e,1)}insertRows(e,t=1){return this.insertRowsBefore(e,t)}insertRowsAfter(e,t){const i=this._workbook.getUnitId(),o=this._worksheet.getSheetId(),a=h.Direction.DOWN,d=e+1,u=e+t,l=0,m=this._worksheet.getColumnCount()-1,_=s.copyRangeStyles(this._worksheet,d,u,l,m,!0,e);return this._commandService.syncExecuteCommand(s.InsertRowByRangeCommand.id,{unitId:i,subUnitId:o,direction:a,range:{startRow:d,endRow:u,startColumn:l,endColumn:m},cellValue:_}),this}insertRowsBefore(e,t){const i=this._workbook.getUnitId(),o=this._worksheet.getSheetId(),a=h.Direction.UP,d=e,u=e+t-1,l=0,m=this._worksheet.getColumnCount()-1,_=s.copyRangeStyles(this._worksheet,d,u,l,m,!0,e-1);return this._commandService.syncExecuteCommand(s.InsertRowByRangeCommand.id,{unitId:i,subUnitId:o,direction:a,range:{startRow:d,endRow:u,startColumn:l,endColumn:m},cellValue:_}),this}deleteRow(e){return this.deleteRows(e,1)}deleteRows(e,t){const i={startRow:e,endRow:e+t-1,startColumn:0,endColumn:this._worksheet.getColumnCount()-1};return this._commandService.syncExecuteCommand(s.RemoveRowByRangeCommand.id,{range:i,unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId()}),this}moveRows(e,t){const i=this._workbook.getUnitId(),o=this._worksheet.getSheetId(),a=L(e.getRange(),this._worksheet),d=a,u={startRow:t,endRow:t,startColumn:a.startColumn,endColumn:a.endColumn};return this._commandService.syncExecuteCommand(s.MoveRowsCommand.id,{unitId:i,subUnitId:o,range:a,fromRange:d,toRange:u}),this}hideRow(e){const t=this._workbook.getUnitId(),i=this._worksheet.getSheetId(),o=L(e.getRange(),this._worksheet);return this._commandService.syncExecuteCommand(s.SetRowHiddenCommand.id,{unitId:t,subUnitId:i,ranges:[o]}),this}hideRows(e,t=1){const i=this._workbook.getUnitId(),o=this._worksheet.getSheetId(),a={startRow:e,endRow:e+t-1,startColumn:0,endColumn:this._worksheet.getColumnCount()-1,rangeType:h.RANGE_TYPE.ROW};return this._commandService.syncExecuteCommand(s.SetRowHiddenCommand.id,{unitId:i,subUnitId:o,ranges:[a]}),this}unhideRow(e){const t=this._workbook.getUnitId(),i=this._worksheet.getSheetId(),o=L(e.getRange(),this._worksheet);return this._commandService.syncExecuteCommand(s.SetSpecificRowsVisibleCommand.id,{unitId:t,subUnitId:i,ranges:[o]}),this}showRows(e,t=1){const i=this._workbook.getUnitId(),o=this._worksheet.getSheetId(),a={startRow:e,endRow:e+t-1,startColumn:0,endColumn:this._worksheet.getColumnCount()-1,rangeType:h.RANGE_TYPE.ROW};return this._commandService.syncExecuteCommand(s.SetSpecificRowsVisibleCommand.id,{unitId:i,subUnitId:o,ranges:[a]}),this}setRowHeight(e,t){return this.setRowHeights(e,1,t)}autoFitRow(e,t=h.BooleanNumber.TRUE){const i=this._workbook.getUnitId(),o=this._worksheet.getSheetId(),a=[{startRow:e,endRow:e,startColumn:0,endColumn:this._worksheet.getColumnCount()-1}];return this._commandService.syncExecuteCommand(s.SetTextWrapCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:a[0],value:h.WrapStrategy.WRAP}),this._commandService.syncExecuteCommand(s.SetWorksheetRowIsAutoHeightMutation.id,{unitId:i,subUnitId:o,ranges:a,autoHeightInfo:t}),this}setRowHeights(e,t,i){var m;const o=this._workbook.getUnitId(),a=this._worksheet.getSheetId(),d=this._worksheet.getRowManager(),u=[],l=[];for(let _=e;_<e+t;_++){const k=((m=d.getRow(_))==null?void 0:m.ah)||this._worksheet.getConfig().defaultRowHeight,v={startRow:_,endRow:_,startColumn:0,endColumn:this._worksheet.getColumnCount()-1};i<=k?u.push(v):l.push(v)}return l.length>0&&this._commandService.syncExecuteCommand(s.SetRowHeightCommand.id,{unitId:o,subUnitId:a,ranges:l,value:i}),u.length>0&&this._commandService.syncExecuteCommand(s.SetWorksheetRowIsAutoHeightCommand.id,{unitId:o,subUnitId:a,ranges:u}),this}getRowHeight(e){return this._worksheet.getRowHeight(e)}setRowAutoHeight(e,t){const i=this._workbook.getUnitId(),o=this._worksheet.getSheetId(),a=[{startRow:e,endRow:e+t-1,startColumn:0,endColumn:this._worksheet.getColumnCount()-1}];return this._commandService.syncExecuteCommand(s.SetWorksheetRowIsAutoHeightCommand.id,{unitId:i,subUnitId:o,ranges:a}),this}setRangesAutoHeight(e){const t=this._workbook.getUnitId(),i=this._worksheet.getSheetId();return this._commandService.syncExecuteCommand(s.SetWorksheetRowIsAutoHeightCommand.id,{unitId:t,subUnitId:i,ranges:e}),this}setRowHeightsForced(e,t,i){const o=this._workbook.getUnitId(),a=this._worksheet.getSheetId(),d=[{startRow:e,endRow:e+t-1,startColumn:0,endColumn:this._worksheet.getColumnCount()-1}];return this._commandService.syncExecuteCommand(s.SetRowHeightCommand.id,{unitId:o,subUnitId:a,ranges:d,value:i}),this}setRowCustom(e){const t=this._workbook.getUnitId(),i=this._worksheet.getSheetId(),o={};for(const[d,u]of Object.entries(e))o[Number(d)]={custom:u};const a={unitId:t,subUnitId:i,rowData:o};return this._commandService.syncExecuteCommand(s.SetRowDataCommand.id,a),this}insertColumnAfter(e){return this.insertColumnsAfter(e,1)}insertColumnBefore(e){return this.insertColumnsBefore(e,1)}insertColumns(e,t=1){return this.insertColumnsBefore(e,t)}insertColumnsAfter(e,t){const i=this._workbook.getUnitId(),o=this._worksheet.getSheetId(),a=h.Direction.RIGHT,d=0,u=this._worksheet.getRowCount()-1,l=e+1,m=e+t,_=s.copyRangeStyles(this._worksheet,d,u,l,m,!1,e);return this._commandService.syncExecuteCommand(s.InsertColByRangeCommand.id,{unitId:i,subUnitId:o,direction:a,range:{startRow:d,endRow:u,startColumn:l,endColumn:m},cellValue:_}),this}insertColumnsBefore(e,t){const i=this._workbook.getUnitId(),o=this._worksheet.getSheetId(),a=h.Direction.LEFT,d=0,u=this._worksheet.getRowCount()-1,l=e,m=e+t-1,_=s.copyRangeStyles(this._worksheet,d,u,l,m,!1,e-1);return this._commandService.syncExecuteCommand(s.InsertColByRangeCommand.id,{unitId:i,subUnitId:o,direction:a,range:{startRow:d,endRow:u,startColumn:l,endColumn:m},cellValue:_}),this}deleteColumn(e){return this.deleteColumns(e,1)}deleteColumns(e,t){const i={startRow:0,endRow:this._worksheet.getRowCount()-1,startColumn:e,endColumn:e+t-1};return this._commandService.syncExecuteCommand(s.RemoveColByRangeCommand.id,{range:i,unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId()}),this}moveColumns(e,t){const i=this._workbook.getUnitId(),o=this._worksheet.getSheetId(),a=G(e.getRange(),this._worksheet),d=a,u={startRow:0,endRow:this._worksheet.getRowCount()-1,startColumn:t,endColumn:t};return this._commandService.syncExecuteCommand(s.MoveColsCommand.id,{unitId:i,subUnitId:o,range:a,fromRange:d,toRange:u}),this}hideColumn(e){const t=this._workbook.getUnitId(),i=this._worksheet.getSheetId(),o=G(e.getRange(),this._worksheet);return this._commandService.syncExecuteCommand(s.SetColHiddenCommand.id,{unitId:t,subUnitId:i,ranges:[o]}),this}hideColumns(e,t=1){const i=this._workbook.getUnitId(),o=this._worksheet.getSheetId(),a={startRow:0,endRow:this._worksheet.getRowCount()-1,startColumn:e,endColumn:e+t-1,rangeType:h.RANGE_TYPE.COLUMN};return this._commandService.syncExecuteCommand(s.SetColHiddenCommand.id,{unitId:i,subUnitId:o,ranges:[a]}),this}unhideColumn(e){const t=this._workbook.getUnitId(),i=this._worksheet.getSheetId(),o=G(e.getRange(),this._worksheet);return this._commandService.syncExecuteCommand(s.SetSpecificColsVisibleCommand.id,{unitId:t,subUnitId:i,ranges:[o]}),this}showColumns(e,t=1){const i=this._workbook.getUnitId(),o=this._worksheet.getSheetId(),a={startRow:0,endRow:this._worksheet.getRowCount()-1,startColumn:e,endColumn:e+t-1,rangeType:h.RANGE_TYPE.COLUMN};return this._commandService.syncExecuteCommand(s.SetSpecificColsVisibleCommand.id,{unitId:i,subUnitId:o,ranges:[a]}),this}setColumnWidth(e,t){return this.setColumnWidths(e,1,t)}setColumnWidths(e,t,i){const o=this._workbook.getUnitId(),a=this._worksheet.getSheetId(),d=[{startColumn:e,endColumn:e+t-1,startRow:0,endRow:this._worksheet.getRowCount()-1}];return this._commandService.syncExecuteCommand(s.SetColWidthCommand.id,{unitId:o,subUnitId:a,ranges:d,value:i}),this}getColumnWidth(e){return this._worksheet.getColumnWidth(e)}setColumnCustom(e){const t=this._workbook.getUnitId(),i=this._worksheet.getSheetId(),o={};for(const[d,u]of Object.entries(e))o[Number(d)]={custom:u};const a={unitId:t,subUnitId:i,columnData:o};return this._commandService.syncExecuteCommand(s.SetColDataCommand.id,a),this}getMergeData(){return this._worksheet.getMergeData().map(e=>this._injector.createInstance(c.FRange,this._workbook,this._worksheet,e))}getMergedRanges(){return this._worksheet.getSnapshot().mergeData.map(t=>this._injector.createInstance(c.FRange,this._workbook,this._worksheet,t))}getCellMergeData(e,t){const o=this._worksheet.getMergedCell(e,t);if(o)return this._injector.createInstance(c.FRange,this._workbook,this._worksheet,o)}getActiveRange(){return this._fWorkbook.getActiveRange()}setActiveRange(e){const{unitId:t,sheetId:i}=e.getRange();if(t!==this._workbook.getUnitId()||i!==this._worksheet.getSheetId())throw new Error("Specified range must be part of the sheet.");return this._fWorkbook.setActiveRange(e),this}getActiveCell(){return this._fWorkbook.getActiveCell()}setFreeze(e){return this._logService.warn("setFreeze is deprecated, use setFrozenRows and setFrozenColumns instead"),this._commandService.syncExecuteCommand(s.SetFrozenCommand.id,{...e,unitId:this._workbook.getUnitId(),subUnitId:this.getSheetId()}),this}cancelFreeze(){return this._commandService.syncExecuteCommand(s.CancelFrozenCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this.getSheetId()}),this}getFreeze(){return this._worksheet.getFreeze()}setFrozenColumns(...e){const t=this.getFreeze();if(arguments.length===1){const i=e[0];this.setFreeze({...t,startColumn:i>0?i:-1,xSplit:i})}else if(arguments.length===2){let[i=0,o=0]=e;i>o&&([i,o]=[o,i]),this._commandService.syncExecuteCommand(s.SetFrozenCommand.id,{startColumn:o+1,xSplit:o-i+1,startRow:t.startRow,ySplit:t.ySplit,unitId:this._workbook.getUnitId(),subUnitId:this.getSheetId()})}return this}setFrozenRows(...e){const t=this.getFreeze();if(arguments.length===1){const i=e[0];this.setFreeze({...t,startRow:i>0?i:-1,ySplit:i})}else if(arguments.length===2){let[i=0,o=0]=e;i>o&&([i,o]=[o,i]),this._commandService.syncExecuteCommand(s.SetFrozenCommand.id,{startRow:o+1,ySplit:o-i+1,startColumn:t.startColumn,xSplit:t.xSplit,unitId:this._workbook.getUnitId(),subUnitId:this.getSheetId()})}return this}getFrozenColumns(){const e=this.getFreeze();return e.startColumn===-1?0:e.startColumn}getFrozenRows(){const e=this.getFreeze();return e.startRow===-1?0:e.startRow}getFrozenRowRange(){const e=this._worksheet.getFreeze();return{startRow:e.startRow-e.ySplit,endRow:e.startRow-1}}getFrozenColumnRange(){const e=this._worksheet.getFreeze();return{startColumn:e.startColumn-e.xSplit,endColumn:e.startColumn-1}}hasHiddenGridLines(){return this._worksheet.getConfig().showGridlines===h.BooleanNumber.FALSE}setHiddenGridlines(e){return this._commandService.syncExecuteCommand(s.ToggleGridlinesCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),showGridlines:e?h.BooleanNumber.FALSE:h.BooleanNumber.TRUE}),this}setGridLinesColor(e){return this._commandService.syncExecuteCommand(s.SetGridlinesColorCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),color:e}),this}getGridLinesColor(){return this._worksheet.getGridlinesColor()}setTabColor(e){return this._commandService.syncExecuteCommand(s.SetTabColorCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),value:e}),this}getTabColor(){return this._worksheet.getTabColor()}onCellDataChange(e){return this._injector.get(h.ICommandService).onCommandExecuted(i=>{if(i.id===s.SetRangeValuesMutation.id){const o=i.params;o.unitId===this._workbook.getUnitId()&&o.subUnitId===this._worksheet.getSheetId()&&o.cellValue&&e(new h.ObjectMatrix(o.cellValue))}})}onBeforeCellDataChange(e){return this._injector.get(h.ICommandService).beforeCommandExecuted(i=>{if(i.id===s.SetRangeValuesMutation.id){const o=i.params;o.unitId===this._workbook.getUnitId()&&o.subUnitId===this._worksheet.getSheetId()&&o.cellValue&&e(new h.ObjectMatrix(o.cellValue))}})}hideSheet(){const e=this._injector.get(h.ICommandService);if(this._workbook.getSheets().filter(a=>a.isSheetHidden()!==h.BooleanNumber.TRUE).length<=1)throw new Error("Cannot hide the only visible sheet");return e.syncExecuteCommand(s.SetWorksheetHideCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId()}),this}showSheet(){return this._injector.get(h.ICommandService).syncExecuteCommand(s.SetWorksheetShowCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId()}),this}isSheetHidden(){return this._worksheet.isSheetHidden()===h.BooleanNumber.TRUE}setName(e){return this._commandService.syncExecuteCommand(s.SetWorksheetNameCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),name:e}),this}activate(){return this._fWorkbook.setActiveSheet(this),this}getIndex(){return this._workbook.getSheetIndex(this._worksheet)}clear(e){if(e&&e.contentsOnly&&!e.formatOnly)return this.clearContents();if(e&&e.formatOnly&&!e.contentsOnly)return this.clearFormats();const t=this._workbook.getUnitId(),i=this._worksheet.getSheetId(),o=this._injector.get(h.ICommandService),a={startRow:0,endRow:this._worksheet.getRowCount()-1,startColumn:0,endColumn:this._worksheet.getColumnCount()-1};return o.syncExecuteCommand(s.ClearSelectionAllCommand.id,{unitId:t,subUnitId:i,ranges:[a],options:e}),this}clearContents(){const e=this._workbook.getUnitId(),t=this._worksheet.getSheetId(),i=this._injector.get(h.ICommandService),o={startRow:0,endRow:this._worksheet.getRowCount()-1,startColumn:0,endColumn:this._worksheet.getColumnCount()-1};return i.syncExecuteCommand(s.ClearSelectionContentCommand.id,{unitId:e,subUnitId:t,ranges:[o]}),this}clearFormats(){const e=this._workbook.getUnitId(),t=this._worksheet.getSheetId(),i=this._injector.get(h.ICommandService),o={startRow:0,endRow:this._worksheet.getRowCount()-1,startColumn:0,endColumn:this._worksheet.getColumnCount()-1};return i.syncExecuteCommand(s.ClearSelectionFormatCommand.id,{unitId:e,subUnitId:t,ranges:[o]}),this}getDataRange(){const{startRow:e,endRow:t,startColumn:i,endColumn:o}=this._worksheet.getDataRealRange();return this.getRange(e,i,t-e+1,o-i+1)}getLastColumns(){return this._worksheet.getLastColumnWithContent()}getLastColumn(){return this._worksheet.getLastColumnWithContent()}getLastRows(){return this._worksheet.getLastRowWithContent()}getLastRow(){return this._worksheet.getLastRowWithContent()}equalTo(e){return e instanceof c.FWorksheet?this._worksheet.getSheetId()===e.getSheetId()&&this._workbook.getUnitId()===e.getWorkbook().getUnitId():!1}insertDefinedName(e,t){const o=this._injector.createInstance(V).setName(e).setRef(t).build();o.localSheetId=this.getSheetId(),this._fWorkbook.insertDefinedNameBuilder(o)}getDefinedNames(){return this._fWorkbook.getDefinedNames().filter(t=>t.getLocalSheetId()===this.getSheetId())}setCustomMetadata(e){return this._worksheet.setCustomMetadata(e),this}getCustomMetadata(){return this._worksheet.getCustomMetadata()}setRowCustomMetadata(e,t){return this._worksheet.getRowManager().setCustomMetadata(e,t),this}setColumnCustomMetadata(e,t){return this._worksheet.getColumnManager().setCustomMetadata(e,t),this}getRowCustomMetadata(e){return this._worksheet.getRowManager().getCustomMetadata(e)}getColumnCustomMetadata(e){return this._worksheet.getColumnManager().getCustomMetadata(e)}appendRow(e){const t=this._worksheet.getCellMatrix().hasValue(),i=this._worksheet.getLastRowWithContent(),o=this._worksheet.getRowCount(),a=this._worksheet.getColumnCount(),d=t?i+1:i,u=new h.ObjectMatrix;for(let l=0;l<e.length;l++)u.setValue(d,l,h.covertCellValue(e[l]));return this._commandService.syncExecuteCommand(s.AppendRowCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),cellValue:u.getMatrix(),insertRowNums:d>o-1?1:0,insertColumnNums:e.length>a?e.length-a:0,maxRows:o,maxColumns:a}),this}setRowCount(e){return this._commandService.syncExecuteCommand(s.SetWorksheetRowCountCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),rowCount:e}),this}setColumnCount(e){return this._commandService.syncExecuteCommand(s.SetWorksheetColumnCountCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),columnCount:e}),this}getWorksheetPermission(){return this._injector.createInstance(z,this)}},c.FWorksheet=Se([B(3,h.Inject(h.Injector)),B(4,h.Inject(s.SheetsSelectionsService)),B(5,h.Inject(h.ILogService)),B(6,h.ICommandService)],c.FWorksheet);var we=Object.getOwnPropertyDescriptor,Ce=(r,n,e,t)=>{for(var i=t>1?void 0:t?we(n,e):n,o=r.length-1,a;o>=0;o--)(a=r[o])&&(i=a(i)||i);return i},O=(r,n)=>(e,t)=>n(e,t,r);let K=class{constructor(r,n,e,t,i,o,a,d,u){w(this,"_permissionSubject");w(this,"_subscriptions",[]);w(this,"_fPermission");w(this,"permission$");w(this,"protectionChange$");this._unitId=r,this._subUnitId=n,this._range=e,this._worksheet=t,this._injector=i,this._permissionService=o,this._authzIoService=a,this._commandService=d,this._rangeProtectionRuleModel=u,this._fPermission=this._injector.createInstance(c.FPermission),this._permissionSubject=new j.BehaviorSubject(this._buildSnapshot()),this.permission$=this._createPermissionStream(),this.protectionChange$=this._createProtectionChangeStream()}_createPermissionStream(){const r=this._permissionService.permissionPointUpdate$.pipe(C.filter(n=>{const e=n.id;return e.includes(this._unitId)&&e.includes(this._subUnitId)})).subscribe(()=>{this._permissionSubject.next(this._buildSnapshot())});return this._subscriptions.push(r),this._permissionSubject.asObservable().pipe(C.distinctUntilChanged((n,e)=>JSON.stringify(n)===JSON.stringify(e)),C.shareReplay({bufferSize:1,refCount:!0}))}_createProtectionChangeStream(){return this._rangeProtectionRuleModel.ruleChange$.pipe(C.filter(r=>r.unitId!==this._unitId||r.subUnitId!==this._subUnitId?!1:r.type==="delete"?this._rangeMatches(r.rule):r.type==="add"?this._rangeMatches(r.rule):!1),C.map(r=>(this._permissionSubject.next(this._buildSnapshot()),r.type==="delete"?{type:"unprotected",ruleId:r.rule.id}:{type:"protected",rule:this._createFacadeRule(r.rule)})),C.shareReplay({bufferSize:1,refCount:!0}))}_rangeMatches(r){const n=this._range.getRange();return r.ranges.some(e=>n.startRow===e.startRow&&n.startColumn===e.startColumn&&n.endRow===e.endRow&&n.endColumn===e.endColumn)}_createFacadeRule(r){const n=r.ranges.map(t=>this._worksheet.getRange(t.startRow,t.startColumn,t.endRow-t.startRow+1,t.endColumn-t.startColumn+1)),e={name:r.description||"",allowViewByOthers:r.viewState!==s.ViewStateEnum.NoOneElseCanView,allowEdit:r.editState===s.EditStateEnum.DesignedUserCanEdit};return this._injector.createInstance(E,this._unitId,this._subUnitId,r.id,r.permissionId,n,e)}getPoint(r){const n=N[r];if(!n)return console.warn(`Unknown permission point: ${r}`),!1;const e=this._getProtectionRule();if(e){const t=new n(this._unitId,this._subUnitId,e.permissionId),i=this._permissionService.getPermissionPoint(t.id);if(i)return i.value}return!0}getSnapshot(){return this._buildSnapshot()}isProtected(){return this._getProtectionRule()!==null}canEdit(){return this.getPoint(I.Edit)}canView(){return this.getPoint(I.View)}canManageCollaborator(){return this.getPoint(I.ManageCollaborator)}canDelete(){return this.getPoint(I.Delete)}async setPoint(r,n){const e=N[r];if(!e)throw new Error(`Unknown permission point: ${r}`);const t=this._getProtectionRule();if(!t)throw new Error("Cannot set permission point: No protection rule exists for this range. Call protect() first.");if(this.getPoint(r)===n)return;const o=t.permissionId;this._fPermission.setRangeProtectionPermissionPoint(this._unitId,this._subUnitId,o,e,n),this._permissionSubject.next(this._buildSnapshot())}async protect(r){if(this.isProtected())throw new Error("Range is already protected");const n=await this._fPermission.addRangeBaseProtection(this._unitId,this._subUnitId,[this._range],r);if(!n)throw new Error("Failed to create range protection");const{permissionId:e,ruleId:t}=n;return await this._setPermissionPoints(e,r),this._injector.createInstance(E,this._unitId,this._subUnitId,t,e,[this._range],r||{})}_determineViewState(r){return(r==null?void 0:r.allowViewByOthers)===!1?s.ViewStateEnum.NoOneElseCanView:s.ViewStateEnum.OthersCanView}_determineEditState(r){var n;return(r==null?void 0:r.allowEdit)===!0&&((n=r==null?void 0:r.allowedUsers)!=null&&n.length)?s.EditStateEnum.DesignedUserCanEdit:s.EditStateEnum.OnlyMe}async _setPermissionPoints(r,n){if(!n)return;const e=(t,i)=>t===void 0?i:typeof t=="boolean"?t:!0;await this._setPermissionPoint(r,I.Edit,e(n.allowEdit,!1)),await this._setPermissionPoint(r,I.View,e(n.allowViewByOthers,!0))}async _setPermissionPoint(r,n,e){const t=N[n];t&&this._fPermission.setRangeProtectionPermissionPoint(this._unitId,this._subUnitId,r,t,e)}async unprotect(){const r=this._getProtectionRule();if(!r)return;const n=r.id;this._fPermission.removeRangeProtection(this._unitId,this._subUnitId,[n])}async listRules(){return await this._buildProtectionRulesAsync()}subscribe(r){const n=this.permission$.subscribe(r);return()=>n.unsubscribe()}_getProtectionRule(){const r=this._rangeProtectionRuleModel.getSubunitRuleList(this._unitId,this._subUnitId),n=this._range.getRange();for(const e of r)for(const t of e.ranges)if(n.startRow===t.startRow&&n.startColumn===t.startColumn&&n.endRow===t.endRow&&n.endColumn===t.endColumn)return e;return null}_buildProtectionRules(){return this._rangeProtectionRuleModel.getSubunitRuleList(this._unitId,this._subUnitId).map(n=>{const e=n.ranges.map(i=>this._worksheet.getRange(i.startRow,i.startColumn,i.endRow-i.startRow+1,i.endColumn-i.startColumn+1)),t={name:n.description||"",allowViewByOthers:n.viewState!==s.ViewStateEnum.NoOneElseCanView};return n.editState===s.EditStateEnum.DesignedUserCanEdit?t.allowEdit=!0:t.allowEdit=!1,this._injector.createInstance(E,this._unitId,this._subUnitId,n.id,n.permissionId,e,t)})}async _buildProtectionRulesAsync(){const r=this._rangeProtectionRuleModel.getSubunitRuleList(this._unitId,this._subUnitId);return(await Promise.all(r.map(async e=>{const t=e.ranges.map(o=>this._worksheet.getRange(o.startRow,o.startColumn,o.endRow-o.startRow+1,o.endColumn-o.startColumn+1)),i={name:e.description||"",allowViewByOthers:e.viewState!==s.ViewStateEnum.NoOneElseCanView};if(e.editState===s.EditStateEnum.DesignedUserCanEdit)try{const a=(await this._authzIoService.listCollaborators({objectID:e.permissionId,unitID:this._unitId})).filter(d=>d.role===H.Editor).map(d=>{var u;return((u=d.subject)==null?void 0:u.userID)||d.id});i.allowEdit=a.length>0}catch(o){console.warn(`Failed to fetch collaborators for rule ${e.id}:`,o),i.allowEdit=!1}else i.allowEdit=!1;return{rule:e,ranges:t,options:i}}))).map(({rule:e,ranges:t,options:i})=>this._injector.createInstance(E,this._unitId,this._subUnitId,e.id,e.permissionId,t,i))}_buildSnapshot(){const r={};return Object.values(I).forEach(n=>{r[n]=this.getPoint(n)}),r}dispose(){this._subscriptions.forEach(r=>r.unsubscribe()),this._permissionSubject.complete()}};K=Ce([O(4,h.Inject(h.Injector)),O(5,h.Inject(h.IPermissionService)),O(6,h.Inject(h.IAuthzIoService)),O(7,h.Inject(h.ICommandService)),O(8,h.Inject(s.RangeProtectionRuleModel))],K);var ke=Object.getOwnPropertyDescriptor,Ie=(r,n,e,t)=>{for(var i=t>1?void 0:t?ke(n,e):n,o=r.length-1,a;o>=0;o--)(a=r[o])&&(i=a(i)||i);return i},Y=(r,n)=>(e,t)=>n(e,t,r);c.FRange=(D=class extends b.FBaseInitialable{constructor(n,e,t,i,o,a){super(i),this._workbook=n,this._worksheet=e,this._range=t,this._injector=i,this._commandService=o,this._formulaDataModel=a;const d=this._worksheet.getRowCount(),u=this._worksheet.getColumnCount();if(this._range.startRow<0||this._range.startColumn<0||this._range.endRow>=d||this._range.endColumn>=u)throw new Error(`Range is out of bounds. Max rows: ${d}, Max columns: ${u}, Given range: ${JSON.stringify(this._range)}`);this._runInitializers(this._injector,this._workbook,this._worksheet,this._range,this._commandService,this._formulaDataModel)}getUnitId(){return this._workbook.getUnitId()}getSheetName(){return this._worksheet.getName()}getSheetId(){return this._worksheet.getSheetId()}getRange(){return this._range}getRow(){return this._range.startRow}getLastRow(){return this._range.endRow}getColumn(){return this._range.startColumn}getLastColumn(){return this._range.endColumn}getWidth(){return this._range.endColumn-this._range.startColumn+1}getHeight(){return this._range.endRow-this._range.startRow+1}isMerged(){const{startColumn:n,startRow:e,endColumn:t,endRow:i}=this._range;return this._worksheet.getMergedCellRange(e,n,i,t).some(a=>h.Rectangle.equals(a,this._range))}getCellStyleData(n="row"){return n!=="cell"?this._worksheet.getComposedCellStyle(this._range.startRow,this._range.startColumn,n==="row"):this._worksheet.getCellStyle(this._range.startRow,this._range.startColumn)}getFontFamily(n="row"){var e,t;return(t=(e=this.getCellStyleData(n))==null?void 0:e.ff)!=null?t:null}getFontSize(n="row"){var e,t;return(t=(e=this.getCellStyleData(n))==null?void 0:e.fs)!=null?t:null}getCellStyle(n="row"){const e=this.getCellStyleData(n);return e?h.TextStyleValue.create(e):null}getCellStyles(n="row"){return this.getCellDatas().map((t,i)=>t.map((o,a)=>{if(!o)return null;const d=n!=="cell"?this._worksheet.getComposedCellStyle(i+this._range.startRow,a+this._range.startColumn,n==="row"):this._worksheet.getCellStyle(i+this._range.startRow,a+this._range.startColumn);return d?h.TextStyleValue.create(d):null}))}getValue(n){var e,t;return n?this.getValueAndRichTextValue():(t=(e=this._worksheet.getCell(this._range.startRow,this._range.startColumn))==null?void 0:e.v)!=null?t:null}getRawValue(){var e,t;const n=this._worksheet.getCellMatrix().getValue(this._range.startRow,this._range.startColumn);return n!=null&&n.p&&((e=n.p.body)!=null&&e.dataStream)?n.p.body.dataStream:(t=n==null?void 0:n.v)!=null?t:null}getDisplayValue(){var e,t,i;const n=this._worksheet.getCell(this._range.startRow,this._range.startColumn);return n!=null&&n.p&&((e=n.p.body)!=null&&e.dataStream)?n.p.body.dataStream:(i=(t=n==null?void 0:n.v)==null?void 0:t.toString())!=null?i:""}getValues(n){var d,u;if(n)return this.getValueAndRichTextValues();const{startRow:e,endRow:t,startColumn:i,endColumn:o}=this._range,a=[];for(let l=e;l<=t;l++){const m=[];for(let _=i;_<=o;_++)m.push((u=(d=this._worksheet.getCell(l,_))==null?void 0:d.v)!=null?u:null);a.push(m)}return a}getRawValues(){var d,u;const n=this._worksheet.getCellMatrix(),{startRow:e,endRow:t,startColumn:i,endColumn:o}=this._range,a=[];for(let l=e;l<=t;l++){const m=[];for(let _=i;_<=o;_++){const k=n.getValue(l,_);k!=null&&k.p&&((d=k.p.body)!=null&&d.dataStream)?m.push(k.p.body.dataStream):m.push((u=k==null?void 0:k.v)!=null?u:null)}a.push(m)}return a}getDisplayValues(){var a,d,u;const{startRow:n,endRow:e,startColumn:t,endColumn:i}=this._range,o=[];for(let l=n;l<=e;l++){const m=[];for(let _=t;_<=i;_++){const k=this._worksheet.getCell(l,_);k!=null&&k.p&&((a=k.p.body)!=null&&a.dataStream)?m.push(k.p.body.dataStream):m.push((u=(d=k==null?void 0:k.v)==null?void 0:d.toString())!=null?u:"")}o.push(m)}return o}getCellData(){var n;return(n=this._worksheet.getCell(this._range.startRow,this._range.startColumn))!=null?n:null}getCellDatas(){return this.getCellDataGrid()}getCellDataGrid(){const{startRow:n,endRow:e,startColumn:t,endColumn:i}=this._range,o=[];for(let a=n;a<=e;a++){const d=[];for(let u=t;u<=i;u++)d.push(this._worksheet.getCellRaw(a,u));o.push(d)}return o}getRichTextValue(){const n=this.getCellData();return n!=null&&n.p?new h.RichTextValue(n.p):null}getRichTextValues(){return this.getCellDataGrid().map(e=>e.map(t=>t!=null&&t.p?new h.RichTextValue(t.p):null))}getValueAndRichTextValue(){const n=this.getCellData();return n!=null&&n.p?new h.RichTextValue(n.p):n==null?void 0:n.v}getValueAndRichTextValues(){return this.getCellDatas().map(e=>e.map(t=>t!=null&&t.p?new h.RichTextValue(t.p):t==null?void 0:t.v))}getFormula(){var n;return(n=this._formulaDataModel.getFormulaStringByCell(this._range.startRow,this._range.startColumn,this._worksheet.getSheetId(),this._workbook.getUnitId()))!=null?n:""}getFormulas(){const n=[],{startRow:e,endRow:t,startColumn:i,endColumn:o}=this._range,a=this._worksheet.getSheetId(),d=this._workbook.getUnitId();for(let u=e;u<=t;u++){const l=[];for(let m=i;m<=o;m++){const _=this._formulaDataModel.getFormulaStringByCell(u,m,a,d);l.push(_||"")}n.push(l)}return n}getWrap(){return this._worksheet.getRange(this._range).getWrap()===h.BooleanNumber.TRUE}getWraps(){const n=this.getCellDatas(),e=this._workbook.getStyles();return n.map(t=>t.map(i=>{var o;return((o=e.getStyleByCell(i))==null?void 0:o.tb)===h.WrapStrategy.WRAP}))}getWrapStrategy(){return this._worksheet.getRange(this._range).getWrapStrategy()}getHorizontalAlignment(){const n=this._worksheet.getRange(this._range).getHorizontalAlignment();return Z(n)}getHorizontalAlignments(){return this._worksheet.getRange(this._range).getHorizontalAlignments().map(e=>e.map(t=>Z(t)))}getVerticalAlignment(){return Q(this._worksheet.getRange(this._range).getVerticalAlignment())}getVerticalAlignments(){return this._worksheet.getRange(this._range).getVerticalAlignments().map(e=>e.map(t=>Q(t)))}setCustomMetaData(n){return this.setValue({custom:n})}setCustomMetaDatas(n){return this.setValues(n.map(e=>e.map(t=>({custom:t}))))}getCustomMetaData(){var e;const n=this.getCellData();return(e=n==null?void 0:n.custom)!=null?e:null}getCustomMetaDatas(){return this.getCellDataGrid().map(e=>e.map(t=>{var i;return(i=t==null?void 0:t.custom)!=null?i:null}))}setBorder(n,e,t){return this._commandService.syncExecuteCommand(s.SetBorderBasicCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),ranges:[this._range],value:{type:n,style:e,color:t}}),this}getBackground(){var e,t;const n=this.getCellStyle();return(t=(e=n==null?void 0:n.background)==null?void 0:e.rgb)!=null?t:h.DEFAULT_STYLES.bg.rgb}getBackgrounds(){return this.getCellStyles().map(e=>e.map(t=>{var i,o;return(o=(i=t==null?void 0:t.background)==null?void 0:i.rgb)!=null?o:h.DEFAULT_STYLES.bg.rgb}))}setBackgroundColor(n){return this._commandService.syncExecuteCommand(s.SetStyleCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,style:{type:"bg",value:{rgb:n}}}),this}setBackground(n){return this.setBackgroundColor(n),this}setTextRotation(n){return this._commandService.syncExecuteCommand(s.SetTextRotationCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,value:n}),this}setValue(n){const e=h.covertCellValue(n);if(!e)throw new Error("Invalid value");return this._commandService.syncExecuteCommand(s.SetRangeValuesCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,value:e}),this}setValueForCell(n){const e=h.covertCellValue(n);if(!e)throw new Error("Invalid value");return this._commandService.syncExecuteCommand(s.SetRangeValuesCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:{startColumn:this._range.startColumn,startRow:this._range.startRow,endColumn:this._range.startColumn,endRow:this._range.startRow},value:e}),this}setRichTextValueForCell(n){const e=n instanceof h.RichTextValue?n.getData():n,t={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:{startColumn:this._range.startColumn,startRow:this._range.startRow,endColumn:this._range.startColumn,endRow:this._range.startRow},value:{p:e}};return this._commandService.syncExecuteCommand(s.SetRangeValuesCommand.id,t),this}setRichTextValues(n){const e=n.map(o=>o.map(a=>a&&{p:a instanceof h.RichTextValue?a.getData():a})),t=h.covertCellValues(e,this._range),i={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,value:t};return this._commandService.syncExecuteCommand(s.SetRangeValuesCommand.id,i),this}setWrap(n){return this._commandService.syncExecuteCommand(s.SetTextWrapCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,value:n?h.WrapStrategy.WRAP:h.WrapStrategy.UNSPECIFIED}),this}setWrapStrategy(n){return this._commandService.syncExecuteCommand(s.SetTextWrapCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,value:n}),this}setVerticalAlignment(n){return this._commandService.syncExecuteCommand(s.SetVerticalTextAlignCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,value:ge(n)}),this}setHorizontalAlignment(n){return this._commandService.syncExecuteCommand(s.SetHorizontalTextAlignCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,value:me(n)}),this}setValues(n){const e=h.covertCellValues(n,this._range);return this._commandService.syncExecuteCommand(s.SetRangeValuesCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,value:e}),this}setFontWeight(n){let e;if(n==="bold")e=h.BooleanNumber.TRUE;else if(n==="normal")e=h.BooleanNumber.FALSE;else if(n===null)e=null;else throw new Error("Invalid fontWeight");const t={type:"bl",value:e},i={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,style:t};return this._commandService.syncExecuteCommand(s.SetStyleCommand.id,i),this}setFontStyle(n){let e;if(n==="italic")e=h.BooleanNumber.TRUE;else if(n==="normal")e=h.BooleanNumber.FALSE;else if(n===null)e=null;else throw new Error("Invalid fontStyle");const t={type:"it",value:e},i={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,style:t};return this._commandService.syncExecuteCommand(s.SetStyleCommand.id,i),this}setFontLine(n){if(n==="underline")this._setFontUnderline({s:h.BooleanNumber.TRUE});else if(n==="line-through")this._setFontStrikethrough({s:h.BooleanNumber.TRUE});else if(n==="none")this._setFontUnderline({s:h.BooleanNumber.FALSE}),this._setFontStrikethrough({s:h.BooleanNumber.FALSE});else if(n===null)this._setFontUnderline(null),this._setFontStrikethrough(null);else throw new Error("Invalid fontLine");return this}_setFontUnderline(n){const e={type:"ul",value:n},t={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,style:e};this._commandService.syncExecuteCommand(s.SetStyleCommand.id,t)}_setFontStrikethrough(n){const e={type:"st",value:n},t={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,style:e};this._commandService.syncExecuteCommand(s.SetStyleCommand.id,t)}setFontFamily(n){const e={type:"ff",value:n},t={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,style:e};return this._commandService.syncExecuteCommand(s.SetStyleCommand.id,t),this}setFontSize(n){const e={type:"fs",value:n},t={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,style:e};return this._commandService.syncExecuteCommand(s.SetStyleCommand.id,t),this}setFontColor(n){const t={type:"cl",value:n===null?null:{rgb:n}},i={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,style:t};return this._commandService.syncExecuteCommand(s.SetStyleCommand.id,i),this}merge(n=!0){const e=this._workbook.getUnitId(),t=this._worksheet.getSheetId();return s.addMergeCellsUtil(this._injector,e,t,[this._range],n),this}mergeAcross(n=!0){const e=s.getAddMergeMutationRangeByType([this._range],h.Dimension.ROWS),t=this._workbook.getUnitId(),i=this._worksheet.getSheetId();return s.addMergeCellsUtil(this._injector,t,i,e,n),this}mergeVertically(n=!0){const e=s.getAddMergeMutationRangeByType([this._range],h.Dimension.COLUMNS),t=this._workbook.getUnitId(),i=this._worksheet.getSheetId();return s.addMergeCellsUtil(this._injector,t,i,e,n),this}isPartOfMerge(){const{startRow:n,startColumn:e,endRow:t,endColumn:i}=this._range;return this._worksheet.getMergedCellRange(n,e,t,i).length>0}breakApart(){return this._commandService.syncExecuteCommand(s.RemoveWorksheetMergeCommand.id,{ranges:[this._range]}),this}forEach(n){const{startColumn:e,startRow:t,endColumn:i,endRow:o}=this._range;this._worksheet.getMatrixWithMergedCells(t,e,o,i).forValue((a,d,u)=>{n(a,d,u)})}getA1Notation(n,e,t){const i={...this._range,startAbsoluteRefType:e,endAbsoluteRefType:t};return n?P.serializeRangeWithSheet(this._worksheet.getName(),i):P.serializeRange(i)}activate(){return this._injector.createInstance(c.FWorkbook,this._workbook).setActiveRange(this),this}activateAsCurrentCell(){const n=this._worksheet.getMergedCell(this._range.startRow,this._range.startColumn);if(n&&h.Rectangle.equals(n,this._range)||!n&&this._range.startRow===this._range.endRow&&this._range.startColumn===this._range.endColumn){const i=this._injector.createInstance(c.FWorkbook,this._workbook).getActiveRange();if(!i||i.getUnitId()!==this.getUnitId()||i.getSheetId()!==this.getSheetId())return this.activate();if(h.Rectangle.contains(i.getRange(),this._range)){const o={unitId:this.getUnitId(),subUnitId:this.getSheetId(),selections:[{range:i.getRange(),primary:s.getPrimaryForRange(this.getRange(),this._worksheet),style:null}]};return this._commandService.syncExecuteCommand(s.SetSelectionsOperation.id,o),this}return this.activate()}else throw new Error("The range is not a single cell")}splitTextToColumns(n,e,t){this._commandService.syncExecuteCommand(s.SplitTextToColumnsCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,delimiter:e,customDelimiter:t,treatMultipleDelimitersAsOne:n})}useThemeStyle(n){if(n==null){const e=this.getUsedThemeStyle();e&&this.removeThemeStyle(e)}else this._commandService.syncExecuteCommand(s.SetWorksheetRangeThemeStyleCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,themeName:n})}removeThemeStyle(n){this._commandService.syncExecuteCommand(s.DeleteWorksheetRangeThemeStyleCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range,themeName:n})}getUsedThemeStyle(){return this._injector.get(s.SheetRangeThemeService).getAppliedRangeThemeStyle({unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),range:this._range})}clear(n){return n&&n.contentsOnly&&!n.formatOnly?this.clearContent():n&&n.formatOnly&&!n.contentsOnly?this.clearFormat():(this._commandService.syncExecuteCommand(s.ClearSelectionAllCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),ranges:[this._range],options:n}),this)}clearContent(){return this._commandService.syncExecuteCommand(s.ClearSelectionContentCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),ranges:[this._range]}),this}clearFormat(){return this._commandService.syncExecuteCommand(s.ClearSelectionFormatCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),ranges:[this._range]}),this}insertCells(n){n===h.Dimension.ROWS?this._commandService.executeCommand(s.InsertRangeMoveDownCommand.id,{range:this._range}):this._commandService.executeCommand(s.InsertRangeMoveRightCommand.id,{range:this._range})}deleteCells(n){n===h.Dimension.ROWS?this._commandService.executeCommand(s.DeleteRangeMoveUpCommand.id,{range:this._range}):this._commandService.executeCommand(s.DeleteRangeMoveLeftCommand.id,{range:this._range})}getDataRegion(n){const{startRow:e,startColumn:t,endRow:i,endColumn:o}=this._range,a=this._worksheet.getMaxRows(),d=this._worksheet.getMaxColumns(),u=this._worksheet.getCellMatrix();let l=e,m=t,_=i,k=o;if(n!==h.Dimension.COLUMNS){let v=!1,R=!1;for(let f=t;f<=o&&(e>0&&!h.isNullCell(u.getValue(e-1,f))&&(v=!0),i<a-1&&!h.isNullCell(u.getValue(i+1,f))&&(R=!0),!(v&&R));f++);v&&(l=e-1),R&&(_=i+1)}if(n!==h.Dimension.ROWS){let v=!1,R=!1;for(let f=e;f<=i&&(t>0&&!h.isNullCell(u.getValue(f,t-1))&&(v=!0),o<d-1&&!h.isNullCell(u.getValue(f,o+1))&&(R=!0),!(v&&R));f++);v&&(m=t-1),R&&(k=o+1)}return this._injector.createInstance(c.FRange,this._workbook,this._worksheet,{startRow:l,startColumn:m,endRow:_,endColumn:k})}isBlank(){const n=this._worksheet.getCellMatrix(),{startRow:e,startColumn:t,endRow:i,endColumn:o}=this._range;let a=!0;for(let d=e;d<=i;d++){for(let u=t;u<=o;u++)if(!h.isNullCell(n.getValue(d,u))){a=!1;break}if(!a)break}return a}offset(n,e,t,i){const{startRow:o,startColumn:a,endRow:d,endColumn:u}=this._range,l=o+n,m=a+e,_=t?l+t-1:d+n,k=i?m+i-1:u+e;if(l<0||m<0||_<0||k<0)throw new Error("The row or column index is out of range");return this._injector.createInstance(c.FRange,this._workbook,this._worksheet,{startRow:l,startColumn:m,endRow:_,endColumn:k})}setFormula(n){return this.setValue({f:n})}setFormulas(n){return this.setValues(n.map(e=>e.map(t=>({f:t}))))}getRangePermission(){const n=this._injector.createInstance(c.FWorksheet,this._injector.createInstance(c.FWorkbook,this._workbook),this._workbook,this._worksheet);return this._injector.createInstance(K,this._workbook.getUnitId(),this._worksheet.getSheetId(),this,n)}},D._enableManualInit(),D),c.FRange=Ie([Y(3,h.Inject(h.Injector)),Y(4,h.ICommandService),Y(5,h.Inject(P.FormulaDataModel))],c.FRange);var be=Object.getOwnPropertyDescriptor,fe=(r,n,e,t)=>{for(var i=t>1?void 0:t?be(n,e):n,o=r.length-1,a;o>=0;o--)(a=r[o])&&(i=a(i)||i);return i},q=(r,n)=>(e,t)=>n(e,t,r);let J=class{constructor(r,n,e,t){w(this,"_permissionSubject");w(this,"_collaboratorChangeSubject",new j.Subject);w(this,"permission$");w(this,"pointChange$");w(this,"collaboratorChange$");w(this,"_subscriptions",[]);w(this,"_fPermission");this._unitId=r,this._injector=n,this._permissionService=e,this._authzIoService=t,this._fPermission=this._injector.createInstance(c.FPermission),this._permissionSubject=new j.BehaviorSubject(this._buildSnapshot()),this.permission$=this._createPermissionStream(),this.pointChange$=this._createPointChangeStream(),this.collaboratorChange$=this._collaboratorChangeSubject.asObservable().pipe(C.shareReplay({bufferSize:1,refCount:!0}))}_createPermissionStream(){const r=this._permissionService.permissionPointUpdate$.pipe(C.filter(n=>n.id.includes(this._unitId))).subscribe(()=>{this._permissionSubject.next(this._buildSnapshot())});return this._subscriptions.push(r),this._permissionSubject.asObservable().pipe(C.distinctUntilChanged((n,e)=>JSON.stringify(n)===JSON.stringify(e)),C.shareReplay({bufferSize:1,refCount:!0}))}_createPointChangeStream(){const r=new Map;for(const n in g){const e=g[n];r.set(e,this.getPoint(e))}return this._permissionService.permissionPointUpdate$.pipe(C.filter(n=>n.id.includes(this._unitId)),C.map(n=>{const e=this._extractWorkbookPointType(n.id);if(!e)return null;const t=!!n.value,i=r.get(e);return r.set(e,t),i===t?null:{point:e,value:t,oldValue:i}}),C.filter(n=>n!==null),C.shareReplay({bufferSize:1,refCount:!0}))}_extractWorkbookPointType(r){for(const n in g){const e=g[n],t=x[e];if(!t)continue;if(new t(this._unitId).id===r)return e}return null}_buildSnapshot(){const r={};for(const n in g){const e=g[n];r[e]=this.getPoint(e)}return r}async setMode(r){const n=this._getModePermissions(r);await this._batchSetPermissionPoints(n)}_getModePermissions(r){const n={};switch(Object.values(g).forEach(e=>{n[e]=!1}),r){case"owner":Object.values(g).forEach(e=>{n[e]=!0});break;case"editor":n[g.Edit]=!0,n[g.View]=!0,n[g.Print]=!0,n[g.Export]=!0,n[g.CopyContent]=!0,n[g.Comment]=!0,n[g.CreateSheet]=!0,n[g.DeleteSheet]=!0,n[g.RenameSheet]=!0,n[g.MoveSheet]=!0,n[g.HideSheet]=!0,n[g.InsertRow]=!0,n[g.InsertColumn]=!0,n[g.DeleteRow]=!0,n[g.DeleteColumn]=!0,n[g.CopySheet]=!0,n[g.CreateProtection]=!0;break;case"viewer":n[g.View]=!0,n[g.Print]=!0;break;case"commenter":n[g.View]=!0,n[g.Comment]=!0,n[g.Print]=!0;break}return n}async _batchSetPermissionPoints(r){const n=[];for(const[e,t]of Object.entries(r)){const i=e,o=x[i];if(!o)throw new Error(`Unknown workbook permission point: ${i}`);const a=this.getPoint(i);a!==t&&(this._fPermission.setWorkbookPermissionPoint(this._unitId,o,t),n.push({point:i,value:t,oldValue:a}))}if(n.length>0){const e=this._buildSnapshot();this._permissionSubject.next(e)}}async setReadOnly(){await this.setMode("viewer")}async setEditable(){await this.setMode("editor")}canEdit(){return this.getPoint(g.Edit)}async setPoint(r,n){const e=x[r];if(!e)throw new Error(`Unknown workbook permission point: ${r}`);if(this.getPoint(r)===n)return;this._fPermission.setWorkbookPermissionPoint(this._unitId,e,n);const i=this._buildSnapshot();this._permissionSubject.next(i)}getPoint(r){var i;const n=x[r];if(!n)throw new Error(`Unknown workbook permission point: ${r}`);const e=new n(this._unitId),t=this._permissionService.getPermissionPoint(e.id);return(i=t==null?void 0:t.value)!=null?i:!0}getSnapshot(){return this._buildSnapshot()}async setCollaborators(r){const n=r.map(e=>({id:e.user.userID,subject:e.user,role:e.role}));await this._authzIoService.putCollaborators({objectID:this._unitId,unitID:this._unitId,collaborators:n}),r.forEach(e=>{this._collaboratorChangeSubject.next({type:"add",collaborator:{user:{id:e.user.userID},role:e.role}})})}async addCollaborator(r,n){await this._authzIoService.createCollaborator({objectID:this._unitId,unitID:this._unitId,collaborators:[{id:r.userID,subject:r,role:n}]}),this._collaboratorChangeSubject.next({type:"add",collaborator:{user:{id:r.userID},role:n}})}async updateCollaborator(r,n){await this._authzIoService.updateCollaborator({objectID:this._unitId,unitID:this._unitId,collaborator:{id:r.userID,subject:r,role:n}}),this._collaboratorChangeSubject.next({type:"update",collaborator:{user:{id:r.userID},role:n}})}async removeCollaborator(r){await this._authzIoService.deleteCollaborator({objectID:this._unitId,unitID:this._unitId,collaboratorID:r}),this._collaboratorChangeSubject.next({type:"delete",collaborator:{user:{id:r},role:M.Reader}})}async removeCollaborators(r){for(const n of r)await this.removeCollaborator(n)}async listCollaborators(){return(await this._authzIoService.listCollaborators({objectID:this._unitId,unitID:this._unitId})).map(n=>{var e,t;return{user:{id:((e=n.subject)==null?void 0:e.userID)||n.id,displayName:((t=n.subject)==null?void 0:t.name)||""},role:n.role}})}subscribe(r){const n=this.permission$.subscribe(r);return()=>n.unsubscribe()}dispose(){this._subscriptions.forEach(r=>r.unsubscribe()),this._permissionSubject.complete(),this._collaboratorChangeSubject.complete()}};J=fe([q(1,h.Inject(h.Injector)),q(2,h.IPermissionService),q(3,h.IAuthzIoService)],J);var ve=Object.getOwnPropertyDescriptor,Re=(r,n,e,t)=>{for(var i=t>1?void 0:t?ve(n,e):n,o=r.length-1,a;o>=0;o--)(a=r[o])&&(i=a(i)||i);return i},y=(r,n)=>(e,t)=>n(e,t,r);c.FWorkbook=class extends b.FBaseInitialable{constructor(e,t,i,o,a,d,u,l,m,_){super(t);w(this,"id");this._workbook=e,this._injector=t,this._resourceLoaderService=i,this._selectionManagerService=o,this._univerInstanceService=a,this._commandService=d,this._permissionService=u,this._logService=l,this._localeService=m,this._definedNamesService=_,this.id=this._workbook.getUnitId()}getWorkbook(){return this._workbook}dispose(){super.dispose(),this._workbook=null}getId(){return this.id}getName(){return this._workbook.name}setName(e){return this._commandService.syncExecuteCommand(s.SetWorkbookNameCommand.id,{unitId:this._workbook.getUnitId(),name:e}),this}save(){return this._resourceLoaderService.saveUnit(this._workbook.getUnitId())}getSnapshot(){return this._logService.warn("use 'save' instead of 'getSnapshot'"),this.save()}getActiveSheet(){const e=this._workbook.getActiveSheet();return this._injector.createInstance(c.FWorksheet,this,this._workbook,e)}getSheets(){return this._workbook.getSheets().map(e=>this._injector.createInstance(c.FWorksheet,this,this._workbook,e))}create(e,t,i,o){var l,m,_;const a=h.mergeWorksheetSnapshotWithDefault(h.Tools.deepClone((l=o==null?void 0:o.sheet)!=null?l:{}));a.name=e,a.rowCount=t,a.columnCount=i,a.id=(m=o==null?void 0:o.sheet)==null?void 0:m.id;const d=(_=o==null?void 0:o.index)!=null?_:this._workbook.getSheets().length;this._commandService.syncExecuteCommand(s.InsertSheetCommand.id,{unitId:this.id,index:d,sheet:a}),this._commandService.syncExecuteCommand(s.SetWorksheetActiveOperation.id,{unitId:this.id,subUnitId:this._workbook.getSheets()[d].getSheetId()});const u=this._workbook.getActiveSheet();if(!u)throw new Error("No active sheet found");return this._injector.createInstance(c.FWorksheet,this,this._workbook,u)}getSheetBySheetId(e){const t=this._workbook.getSheetBySheetId(e);return t?this._injector.createInstance(c.FWorksheet,this,this._workbook,t):null}getSheetByName(e){const t=this._workbook.getSheetBySheetName(e);return t?this._injector.createInstance(c.FWorksheet,this,this._workbook,t):null}setActiveSheet(e){return this._commandService.syncExecuteCommand(s.SetWorksheetActiveOperation.id,{unitId:this.id,subUnitId:typeof e=="string"?e:e.getSheetId()}),typeof e=="string"?this.getSheetBySheetId(e):e}insertSheet(e,t){var d,u,l;const i=h.mergeWorksheetSnapshotWithDefault(h.Tools.deepClone((d=t==null?void 0:t.sheet)!=null?d:{}));i.name=e,i.id=(u=t==null?void 0:t.sheet)==null?void 0:u.id;const o=(l=t==null?void 0:t.index)!=null?l:this._workbook.getSheets().length;this._commandService.syncExecuteCommand(s.InsertSheetCommand.id,{unitId:this.id,index:o,sheet:i}),this._commandService.syncExecuteCommand(s.SetWorksheetActiveOperation.id,{unitId:this.id,subUnitId:this._workbook.getSheets()[o].getSheetId()});const a=this._workbook.getActiveSheet();if(!a)throw new Error("No active sheet found");return this._injector.createInstance(c.FWorksheet,this,this._workbook,a)}deleteSheet(e){const t=this.id,i=typeof e=="string"?e:e.getSheetId();return this._commandService.syncExecuteCommand(s.RemoveSheetCommand.id,{unitId:t,subUnitId:i})}undo(){return this._univerInstanceService.focusUnit(this.id),this._commandService.syncExecuteCommand(h.UndoCommand.id),this}redo(){return this._univerInstanceService.focusUnit(this.id),this._commandService.syncExecuteCommand(h.RedoCommand.id),this}onBeforeCommandExecute(e){return this._commandService.beforeCommandExecuted(t=>{var i;((i=t.params)==null?void 0:i.unitId)===this.id&&e(t)})}onCommandExecuted(e){return this._commandService.onCommandExecuted(t=>{var i;((i=t.params)==null?void 0:i.unitId)===this.id&&e(t)})}onSelectionChange(e){return h.toDisposable(this._selectionManagerService.selectionMoveEnd$.subscribe(t=>{this._univerInstanceService.getCurrentUnitForType(h.UniverInstanceType.UNIVER_SHEET).getUnitId()===this.id&&(t!=null&&t.length?e(t.map(i=>i.range)):e([]))}))}setEditable(e){const t=new s.WorkbookEditablePermission(this._workbook.getUnitId());return this._permissionService.getPermissionPoint(t.id)||this._permissionService.addPermissionPoint(t),this._permissionService.updatePermissionPoint(t.id,e),this}setActiveRange(e){const t=this.getActiveSheet(),i=e.getRange().sheetId||t.getSheetId(),o=i?this._workbook.getSheetBySheetId(i):this._workbook.getActiveSheet(!0);if(!o)throw new Error("No active sheet found");o.getSheetId()!==t.getSheetId()&&this.setActiveSheet(this._injector.createInstance(c.FWorksheet,this,this._workbook,o));const a={unitId:this.getId(),subUnitId:i,selections:[e].map(d=>({range:d.getRange(),primary:s.getPrimaryForRange(d.getRange(),o),style:null}))};return this._commandService.syncExecuteCommand(s.SetSelectionsOperation.id,a),this}getActiveRange(){const e=this._workbook.getActiveSheet(),i=this._selectionManagerService.getCurrentSelections().find(o=>!!o.primary);return i?this._injector.createInstance(c.FRange,this._workbook,e,i.range):null}getActiveCell(){const e=this._workbook.getActiveSheet(),i=this._selectionManagerService.getCurrentSelections().find(a=>!!a.primary);if(!i)return null;const o={...i.primary,rangeType:h.RANGE_TYPE.NORMAL};return this._injector.createInstance(c.FRange,this._workbook,e,o)}deleteActiveSheet(){const e=this.getActiveSheet();return this.deleteSheet(e)}duplicateSheet(e){return this._commandService.syncExecuteCommand(s.CopySheetCommand.id,{unitId:e.getWorkbook().getUnitId(),subUnitId:e.getSheetId()}),this._injector.createInstance(c.FWorksheet,this,this._workbook,this._workbook.getActiveSheet())}duplicateActiveSheet(){const e=this.getActiveSheet();return this.duplicateSheet(e)}getNumSheets(){return this._workbook.getSheets().length}getLocale(){return this._localeService.getCurrentLocale()}setLocale(e){this._localeService.setLocale(e)}setSpreadsheetLocale(e){return this._localeService.setLocale(e),this}getUrl(){return location.href}moveSheet(e,t){let i=t;return i<0?i=0:i>this._workbook.getSheets().length-1&&(i=this._workbook.getSheets().length-1),this._commandService.syncExecuteCommand(s.SetWorksheetOrderCommand.id,{unitId:e.getWorkbook().getUnitId(),order:i,subUnitId:e.getSheetId()}),this}moveActiveSheet(e){const t=this.getActiveSheet();return this.moveSheet(t,e)}getPermission(){return this._injector.createInstance(c.FPermission)}getWorkbookPermission(){return this._injector.createInstance(J,this._workbook.getUnitId())}getDefinedName(e){const t=this._definedNamesService.getValueByName(this.id,e);return t?this._injector.createInstance(A,{...t,unitId:this.id}):null}getDefinedNames(){const e=this._definedNamesService.getDefinedNameMap(this.id);return e?Object.values(e).map(t=>this._injector.createInstance(A,{...t,unitId:this.id})):[]}insertDefinedName(e,t){const o=this._injector.createInstance(V).setName(e).setRef(t).build();return o.localSheetId=s.SCOPE_WORKBOOK_VALUE_DEFINED_NAME,this.insertDefinedNameBuilder(o),this}deleteDefinedName(e){const t=this.getDefinedName(e);return t?(t.delete(),!0):!1}insertDefinedNameBuilder(e){e.unitId=this.getId(),this._commandService.syncExecuteCommand(s.SetDefinedNameCommand.id,e)}updateDefinedNameBuilder(e){this._commandService.syncExecuteCommand(s.SetDefinedNameCommand.id,e)}getRegisteredRangeThemes(){return this._injector.get(s.SheetRangeThemeService).getRegisteredRangeThemes()}registerRangeTheme(e){this._commandService.syncExecuteCommand(s.RegisterWorksheetRangeThemeStyleCommand.id,{unitId:this.getId(),rangeThemeStyle:e})}unregisterRangeTheme(e){this._commandService.syncExecuteCommand(s.UnregisterWorksheetRangeThemeStyleCommand.id,{unitId:this.getId(),themeName:e})}createRangeThemeStyle(e,t){return new s.RangeThemeStyle(e,t)}setCustomMetadata(e){return this._workbook.setCustomMetadata(e),this}getCustomMetadata(){return this._workbook.getCustomMetadata()}addStyles(e){this._workbook.addStyles(e)}removeStyles(e){this._workbook.removeStyles(e)}},c.FWorkbook=Re([y(1,h.Inject(h.Injector)),y(2,h.Inject(h.IResourceLoaderService)),y(3,h.Inject(s.SheetsSelectionsService)),y(4,h.IUniverInstanceService),y(5,h.ICommandService),y(6,h.IPermissionService),y(7,h.ILogService),y(8,h.Inject(h.LocaleService)),y(9,P.IDefinedNamesService)],c.FWorkbook);class pe extends b.FUniver{getCommandSheetTarget(n){var o;const e=n.params;if(!e)return this.getActiveSheet();const t=e.unitId?this.getUniverSheet(e.unitId):(o=this.getActiveWorkbook)==null?void 0:o.call(this);if(!t)return;const i=t.getSheetBySheetId(e.subUnitId||e.sheetId)||t.getActiveSheet();if(i)return{workbook:t,worksheet:i}}getSheetTarget(n,e){const t=this.getUniverSheet(n);if(!t)return;const i=t.getSheetBySheetId(e);if(i)return{workbook:t,worksheet:i}}_initWorkbookEvent(n){const e=n.get(h.IUniverInstanceService);this.registerEventHandler(this.Event.WorkbookDisposed,()=>e.unitDisposed$.subscribe(t=>{t.type===h.UniverInstanceType.UNIVER_SHEET&&this.fireEvent(this.Event.WorkbookDisposed,{unitId:t.getUnitId(),unitType:t.type,snapshot:t.getSnapshot()})})),this.registerEventHandler(this.Event.WorkbookCreated,()=>e.unitAdded$.subscribe(t=>{if(t.type===h.UniverInstanceType.UNIVER_SHEET){const i=t,o=n.createInstance(c.FWorkbook,i);this.fireEvent(this.Event.WorkbookCreated,{unitId:t.getUnitId(),type:t.type,workbook:o,unit:o})}}))}_initialize(n){const e=n.get(h.ICommandService);this.registerEventHandler(this.Event.BeforeSheetCreate,()=>e.beforeCommandExecuted(t=>{var i;if(t.id===s.InsertSheetCommand.id){const o=t.params,{unitId:a,index:d,sheet:u}=o||{},l=a?this.getUniverSheet(a):(i=this.getActiveWorkbook)==null?void 0:i.call(this);if(!l)return;const m={workbook:l,index:d,sheet:u};if(this.fireEvent(this.Event.BeforeSheetCreate,m),m.cancel)throw new h.CanceledError}})),this.registerEventHandler(this.Event.BeforeActiveSheetChange,()=>e.beforeCommandExecuted(t=>{var i;if(t.id===s.SetWorksheetActiveOperation.id){const{subUnitId:o,unitId:a}=t.params,d=a?this.getUniverSheet(a):(i=this.getActiveWorkbook)==null?void 0:i.call(this);if(!d||!o)return;const u=d.getSheetBySheetId(o),l=d.getActiveSheet();if(!u||!l)return;const m={workbook:d,activeSheet:u,oldActiveSheet:l};if(this.fireEvent(this.Event.BeforeActiveSheetChange,m),m.cancel)throw new h.CanceledError}})),this.registerEventHandler(this.Event.BeforeSheetDelete,()=>e.beforeCommandExecuted(t=>{if(t.id===s.RemoveSheetCommand.id){const i=this.getCommandSheetTarget(t);if(!i)return;const{workbook:o,worksheet:a}=i,d={workbook:o,worksheet:a};if(this.fireEvent(this.Event.BeforeSheetDelete,d),d.cancel)throw new h.CanceledError}})),this.registerEventHandler(this.Event.BeforeSheetMove,()=>e.beforeCommandExecuted(t=>{if(t.id===s.SetWorksheetOrderMutation.id){const{fromOrder:i,toOrder:o}=t.params,a=this.getCommandSheetTarget(t);if(!a)return;const d={workbook:a.workbook,worksheet:a.worksheet,newIndex:o,oldIndex:i};if(this.fireEvent(this.Event.BeforeSheetMove,d),d.cancel)throw new h.CanceledError}})),this.registerEventHandler(this.Event.BeforeSheetNameChange,()=>e.beforeCommandExecuted(t=>{if(t.id===s.SetWorksheetNameCommand.id){const{name:i}=t.params,o=this.getCommandSheetTarget(t);if(!o)return;const a={workbook:o.workbook,worksheet:o.worksheet,newName:i,oldName:o.worksheet.getSheetName()};if(this.fireEvent(this.Event.BeforeSheetNameChange,a),a.cancel)throw new h.CanceledError}})),this.registerEventHandler(this.Event.BeforeSheetTabColorChange,()=>e.beforeCommandExecuted(t=>{if(t.id===s.SetTabColorMutation.id){const{color:i}=t.params,o=this.getCommandSheetTarget(t);if(!o)return;const a={workbook:o.workbook,worksheet:o.worksheet,newColor:i,oldColor:o.worksheet.getTabColor()};if(this.fireEvent(this.Event.BeforeSheetTabColorChange,a),a.cancel)throw new h.CanceledError}})),this.registerEventHandler(this.Event.BeforeSheetHideChange,()=>e.beforeCommandExecuted(t=>{if(t.id===s.SetWorksheetHideMutation.id){const{hidden:i}=t.params,o=this.getCommandSheetTarget(t);if(!o)return;const a={workbook:o.workbook,worksheet:o.worksheet,hidden:!!i};if(this.fireEvent(this.Event.BeforeSheetHideChange,a),a.cancel)throw new h.CanceledError}})),this.registerEventHandler(this.Event.BeforeGridlineColorChange,()=>e.beforeCommandExecuted(t=>{var i;if(t.id===s.SetGridlinesColorCommand.id){const o=this.getCommandSheetTarget(t);if(!o)return;const a={...o,color:(i=t.params)==null?void 0:i.color};if(this.fireEvent(this.Event.BeforeGridlineColorChange,a),a.cancel)throw new h.CanceledError}})),this.registerEventHandler(this.Event.BeforeGridlineEnableChange,()=>e.beforeCommandExecuted(t=>{var i;if(t.id===s.ToggleGridlinesCommand.id){const o=this.getCommandSheetTarget(t);if(!o)return;const a={...o,enabled:!!((i=t.params)!=null&&i.showGridlines)};if(this.fireEvent(this.Event.BeforeGridlineEnableChange,a),a.cancel)throw new h.CanceledError}})),this.registerEventHandler(this.Event.SheetValueChanged,()=>e.onCommandExecuted(t=>{if(s.COMMAND_LISTENER_VALUE_CHANGE.indexOf(t.id)>-1){if(!this.getActiveSheet())return;const o=s.getValueChangedEffectedRange(t).map(a=>{var d,u;return(u=(d=this.getWorkbook(a.unitId))==null?void 0:d.getSheetBySheetId(a.subUnitId))==null?void 0:u.getRange(a.range)}).filter(Boolean);if(!o.length)return;this.fireEvent(this.Event.SheetValueChanged,{payload:t,effectedRanges:o})}})),this.registerEventHandler(this.Event.SheetCreated,()=>e.onCommandExecuted(t=>{var i;if(t.id===s.InsertSheetCommand.id){const o=t.params,{unitId:a}=o||{},d=a?this.getUniverSheet(a):(i=this.getActiveWorkbook)==null?void 0:i.call(this);if(!d)return;const u=d.getActiveSheet();if(!u)return;const l={workbook:d,worksheet:u};this.fireEvent(this.Event.SheetCreated,l)}})),this.registerEventHandler(this.Event.ActiveSheetChanged,()=>e.onCommandExecuted(t=>{if(t.id===s.SetWorksheetActiveOperation.id){const i=this.getActiveSheet();if(!i)return;const{workbook:o,worksheet:a}=i;this._fireActiveSheetChanged(o,a)}})),this.registerEventHandler(this.Event.SheetDeleted,()=>e.onCommandExecuted(t=>{var i;if(t.id===s.RemoveSheetCommand.id){const{subUnitId:o,unitId:a}=t.params,d=a?this.getUniverSheet(a):(i=this.getActiveWorkbook)==null?void 0:i.call(this);if(!d||!o)return;this._fireSheetDeleted(d,o)}})),this.registerEventHandler(this.Event.SheetMoved,()=>e.onCommandExecuted(t=>{if(t.id===s.SetWorksheetOrderMutation.id){const{toOrder:i}=t.params,o=this.getCommandSheetTarget(t);if(!o)return;this._fireSheetMoved(o.workbook,o.worksheet,i)}})),this.registerEventHandler(this.Event.SheetNameChanged,()=>e.onCommandExecuted(t=>{if(t.id===s.SetWorksheetNameCommand.id){const{name:i}=t.params,o=this.getCommandSheetTarget(t);if(!o)return;this._fireSheetNameChanged(o.workbook,o.worksheet,i)}})),this.registerEventHandler(this.Event.SheetTabColorChanged,()=>e.onCommandExecuted(t=>{if(t.id===s.SetTabColorMutation.id){const{color:i}=t.params,o=this.getCommandSheetTarget(t);if(!o)return;this._fireSheetTabColorChanged(o.workbook,o.worksheet,i)}})),this.registerEventHandler(this.Event.SheetHideChanged,()=>e.onCommandExecuted(t=>{if(t.id===s.SetWorksheetHideMutation.id){const{hidden:i}=t.params,o=this.getCommandSheetTarget(t);if(!o)return;this._fireSheetHideChanged(o.workbook,o.worksheet,!!i)}})),this.registerEventHandler(this.Event.GridlineChanged,()=>e.onCommandExecuted(t=>{if(t.id===s.SetGridlinesColorCommand.id||t.id===s.ToggleGridlinesCommand.id){const i=this.getCommandSheetTarget(t);if(!i)return;this.fireEvent(this.Event.GridlineChanged,{...i,enabled:!i.worksheet.hasHiddenGridLines(),color:i.worksheet.getGridLinesColor()})}})),this._initWorkbookEvent(n)}createUniverSheet(n,e){const i=this._injector.get(h.IUniverInstanceService).createUnit(h.UniverInstanceType.UNIVER_SHEET,n,e);return this._injector.createInstance(c.FWorkbook,i)}createWorkbook(n,e){return this.createUniverSheet(n,e)}getActiveWorkbook(){const n=this._univerInstanceService.getCurrentUnitForType(h.UniverInstanceType.UNIVER_SHEET);return n?this._injector.createInstance(c.FWorkbook,n):null}getActiveUniverSheet(){return this.getActiveWorkbook()}getUniverSheet(n){const e=this._univerInstanceService.getUnit(n,h.UniverInstanceType.UNIVER_SHEET);return e?this._injector.createInstance(c.FWorkbook,e):null}getWorkbook(n){return this.getUniverSheet(n)}getPermission(){return this._injector.createInstance(c.FPermission)}onUniverSheetCreated(n){const e=this._univerInstanceService.getTypeOfUnitAdded$(h.UniverInstanceType.UNIVER_SHEET).subscribe(t=>{const i=this._injector.createInstance(c.FWorkbook,t);n(i)});return h.toDisposable(e)}newDefinedName(){return this._injector.createInstance(V)}getActiveSheet(){const n=this.getActiveWorkbook();if(!n)return null;const e=n.getActiveSheet();return e?{workbook:n,worksheet:e}:null}setFreezeSync(n){this._injector.get(s.SheetsFreezeSyncController).setEnabled(n)}_fireActiveSheetChanged(n,e){this.fireEvent(this.Event.ActiveSheetChanged,{workbook:n,activeSheet:e})}_fireSheetDeleted(n,e){this.fireEvent(this.Event.SheetDeleted,{workbook:n,sheetId:e})}_fireSheetMoved(n,e,t){this.fireEvent(this.Event.SheetMoved,{workbook:n,worksheet:e,newIndex:t})}_fireSheetNameChanged(n,e,t){this.fireEvent(this.Event.SheetNameChanged,{workbook:n,worksheet:e,newName:t})}_fireSheetTabColorChanged(n,e,t){this.fireEvent(this.Event.SheetTabColorChanged,{workbook:n,worksheet:e,newColor:t})}_fireSheetHideChanged(n,e,t){this.fireEvent(this.Event.SheetHideChanged,{workbook:n,worksheet:e,hidden:t})}}b.FUniver.extend(pe);class X{get SheetValueChangeType(){return s.SheetValueChangeType}get SheetSkeletonChangeType(){return s.SheetSkeletonChangeType}get SplitDelimiterType(){return s.SplitDelimiterEnum}get UnitRole(){return M}get WorkbookPermissionPoint(){return g}get WorksheetPermissionPoint(){return S}get RangePermissionPoint(){return I}}b.FEnum.extend(X);class ee{get SheetCreated(){return"SheetCreated"}get BeforeSheetCreate(){return"BeforeSheetCreate"}get WorkbookCreated(){return"WorkbookCreated"}get WorkbookDisposed(){return"WorkbookDisposed"}get GridlineChanged(){return"GridlineChanged"}get BeforeGridlineEnableChange(){return"BeforeGridlineEnableChange"}get BeforeGridlineColorChange(){return"BeforeGridlineColorChange"}get BeforeActiveSheetChange(){return"BeforeActiveSheetChange"}get ActiveSheetChanged(){return"ActiveSheetChanged"}get SheetDeleted(){return"SheetDeleted"}get BeforeSheetDelete(){return"BeforeSheetDelete"}get SheetMoved(){return"SheetMoved"}get BeforeSheetMove(){return"BeforeSheetMove"}get SheetNameChanged(){return"SheetNameChanged"}get BeforeSheetNameChange(){return"BeforeSheetNameChange"}get SheetTabColorChanged(){return"SheetTabColorChanged"}get BeforeSheetTabColorChange(){return"BeforeSheetTabColorChange"}get SheetHideChanged(){return"SheetHideChanged"}get BeforeSheetHideChange(){return"BeforeSheetHideChange"}get SheetValueChanged(){return"SheetValueChanged"}}b.FEventName.extend(ee);var Ee=Object.getOwnPropertyDescriptor,ye=(r,n,e,t)=>{for(var i=t>1?void 0:t?Ee(n,e):n,o=r.length-1,a;o>=0;o--)(a=r[o])&&(i=a(i)||i);return i},Pe=(r,n)=>(e,t)=>n(e,t,r);c.FSheetHooks=class extends b.FBase{constructor(n){super(),this._injector=n}},c.FSheetHooks=ye([Pe(0,h.Inject(h.Injector))],c.FSheetHooks),c.FSheetEventName=ee,c.FSheetsEnum=X,Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})}));


// @univerjs/sheets-ui/index
(function(y,q){typeof exports=="object"&&typeof module<"u"?q(exports,require("@univerjs/docs-ui"),require("@univerjs/core"),require("@univerjs/sheets"),require("@univerjs/engine-render"),require("rxjs"),require("@univerjs/ui"),require("@univerjs/docs"),require("react"),require("@univerjs/engine-formula"),require("react/jsx-runtime"),require("@univerjs/design"),require("rxjs/operators"),require("@univerjs/telemetry")):typeof define=="function"&&define.amd?define(["exports","@univerjs/docs-ui","@univerjs/core","@univerjs/sheets","@univerjs/engine-render","rxjs","@univerjs/ui","@univerjs/docs","react","@univerjs/engine-formula","react/jsx-runtime","@univerjs/design","rxjs/operators","@univerjs/telemetry"],q):(y=typeof globalThis<"u"?globalThis:y||self,q(y.UniverSheetsUi={},y.UniverDocsUi,y.UniverCore,y.UniverSheets,y.UniverEngineRender,y.rxjs,y.UniverUi,y.UniverDocs,y.React,y.UniverEngineFormula,y.React,y.UniverDesign,y.rxjs.operators,y.UniverTelemetry))})(this,(function(y,q,a,m,M,N,I,Ce,x,K,b,X,de,gd){"use strict";var yp=Object.defineProperty;var Rp=(y,q,a)=>q in y?yp(y,q,{enumerable:!0,configurable:!0,writable:!0,value:a}):y[q]=a;var R=(y,q,a)=>Rp(y,typeof q!="symbol"?q+"":q,a);function xi(n,o){if(n==null)return;const e=o.getRenderById(n);if(e==null)return;const{mainComponent:t,scene:i,engine:r,components:s}=e,l=t,c=s.get(q.DOCS_VIEW_KEY.BACKGROUND);return{document:l,docBackground:c,scene:i,engine:r}}const Yo=[10,400],jo="RANGE_SELECTOR_COMPONENT_KEY",Ui="EMBEDDING_FORMULA_EDITOR_COMPONENT_KEY";var he=(n=>(n.MAIN="__SpreadsheetRender__",n.ROW="__SpreadsheetRowHeader__",n.COLUMN="__SpreadsheetColumnHeader__",n.LEFT_TOP="__SpreadsheetLeftTopPlaceholder__",n))(he||{});const Vs=0,Bi=1,st=10,Sd=11,Ws=12,jn={id:"sheet.command.set-row-header-width",type:a.CommandType.COMMAND,handler:async(n,o)=>{if(!o)return!1;const e=n.get(M.IRenderManagerService);if(!e)return!1;const{unitId:t,subUnitId:i,size:r}=o,s=e.getRenderById(t);if(s){e.getRenderById(t).with(y.SheetSkeletonManagerService).setRowHeaderSize(s,i,r);const{components:c}=s,d=c.get(he.ROW);d&&d.setCustomHeader({headerStyle:{size:r}},i)}return!0}},Zn={id:"sheet.command.set-col-header-height",type:a.CommandType.COMMAND,handler:async(n,o)=>{if(!o)return!1;const e=n.get(M.IRenderManagerService);if(!e)return!1;const{unitId:t,subUnitId:i,size:r}=o,s=e.getRenderById(t);if(s){e.getRenderById(t).with(y.SheetSkeletonManagerService).setColumnHeaderSize(s,i,r);const{components:c}=s,d=c.get(he.COLUMN);d&&d.setCustomHeader({headerStyle:{size:r}},i)}return!0}},Zo=a.createInterceptorKey("rangeMovePermissionCheck"),Go=a.createInterceptorKey("rangeFillPermissionCheck");var Ko=(n=>(n[n.FORMULA_EDITOR_SHOW=100]="FORMULA_EDITOR_SHOW",n[n.MARK_SELECTION=1e4]="MARK_SELECTION",n))(Ko||{});function qe(n){const o=n.getColorFromTheme("primary.600"),e=n.getColorFromTheme("white"),t=new a.ColorKit(o).setAlpha(.07).toRgbString();return{strokeWidth:1,stroke:o,fill:t,widgets:{},widgetSize:6,widgetStrokeWidth:1,widgetStroke:e,autofillSize:6,autofillStrokeWidth:1,autofillStroke:e,rowHeaderFill:t,rowHeaderStroke:o,rowHeaderStrokeWidth:1,columnHeaderFill:t,columnHeaderStroke:o,columnHeaderStrokeWidth:1,expandCornerSize:40}}class fd{constructor(){R(this,"_startColumn",-1);R(this,"_startRow",-1);R(this,"_endColumn",-1);R(this,"_endRow",-1);R(this,"_startX",0);R(this,"_startY",0);R(this,"_endX",0);R(this,"_endY",0);R(this,"_primary");R(this,"_rangeType",a.RANGE_TYPE.NORMAL)}get startColumn(){return this._startColumn}get startRow(){return this._startRow}get endColumn(){return this._endColumn}get endRow(){return this._endRow}get startX(){return this._startX}get startY(){return this._startY}get endX(){return this._endX}get endY(){return this._endY}get currentCell(){return this._primary}get rangeType(){return this._rangeType}isEqual(o){const{startColumn:e,startRow:t,endColumn:i,endRow:r}=this,{startColumn:s,startRow:l,endColumn:c,endRow:d}=o;return e===s&&t===l&&i===c&&r===d}highlightToSelection(){if(this._primary)return a.convertCellToRange(this._primary)}getRange(){return{startColumn:this._startColumn,startRow:this._startRow,endColumn:this._endColumn,endRow:this._endRow,startX:this._startX,startY:this._startY,endX:this._endX,endY:this._endY,rangeType:this.rangeType}}getCell(){return this._primary}getRangeType(){return this._rangeType}setRangeType(o){this._rangeType=o}getValue(){return{rangeWithCoord:this.getRange(),primaryWithCoord:this._primary}}setValue(o,e){const{startColumn:t,startRow:i,endColumn:r,endRow:s,startX:l,startY:c,endX:d,endY:u,rangeType:h}=o;this._startColumn=t,this._startRow=i,this._endColumn=r,this._endRow=s,this._startX=l,this._startY=c,this._endX=d,this._endY=u,h!==void 0&&(this._rangeType=h),e!==void 0&&this.setCurrentCell(e)}setCurrentCell(o){this._primary=o}clearCurrentCell(){this._primary=null}}function Jt(n,o){const{startRow:e,startColumn:t,endRow:i,endColumn:r,rangeType:s}=o,l=i<e?i:e,c=i<e?e:i,d=r<t?r:t,u=r<t?t:r,h=n.getNoMergeCellWithCoordByIndex(l,d),g=n.getNoMergeCellWithCoordByIndex(c,u);return{startRow:e,startColumn:t,endRow:i,endColumn:r,rangeType:s,startY:(h==null?void 0:h.startY)||0,endY:(g==null?void 0:g.endY)||0,startX:(h==null?void 0:h.startX)||0,endX:(g==null?void 0:g.endX)||0}}function Re(n,o){const{range:e,primary:t,style:i}=n,r=Jt(o,e),s=t&&Gn(o,t);return{rangeWithCoord:r,primaryWithCoord:s,style:i}}function Gn(n,o){const{actualRow:e,actualColumn:t,isMerged:i,isMergedMainCell:r,startRow:s,startColumn:l,endRow:c,endColumn:d}=o,u=n.getNoMergeCellWithCoordByIndex(e,t),h=n.getNoMergeCellWithCoordByIndex(s,l),g=n.getNoMergeCellWithCoordByIndex(c,d);return{actualRow:e,actualColumn:t,isMerged:i,isMergedMainCell:r,startX:u.startX,startY:u.startY,endX:u.endX,endY:u.endY,mergeInfo:{startRow:s,startColumn:l,endRow:c,endColumn:d,startY:(h==null?void 0:h.startY)||0,endY:(g==null?void 0:g.endY)||0,startX:(h==null?void 0:h.startX)||0,endX:(g==null?void 0:g.endX)||0}}}const Ls="__SpreadsheetHelperSelectionTempRect",vd=35;class xs{constructor(o,e){R(this,"_startOffsetX",0);R(this,"_startOffsetY",0);R(this,"_relativeSelectionPositionRow",0);R(this,"_relativeSelectionPositionColumn",0);R(this,"_relativeSelectionRowLength",0);R(this,"_relativeSelectionColumnLength",0);R(this,"_scenePointerMoveSub");R(this,"_scenePointerUpSub");R(this,"_disabled",!1);R(this,"_helperSelection");R(this,"_scrollTimer");R(this,"_activeViewport");R(this,"_targetSelection",{startY:0,endY:0,startX:0,endX:0,startRow:-1,endRow:-1,startColumn:-1,endColumn:-1});R(this,"_isInMergeState",!1);R(this,"_fillControlColors",[]);R(this,"_skeleton");R(this,"_scene");R(this,"_themeService");R(this,"_injector");R(this,"_selectionHooks");this._control=o,this._skeleton=e.skeleton,this._scene=e.scene,this._themeService=e.themeService,this._injector=e.injector,this._selectionHooks=e.selectionHooks,this._initialControl(),this._initialWidget(),this._initialAutoFill(),this._control.dispose$.subscribe(()=>{this.dispose()})}get isHelperSelection(){return this._control.isHelperSelection}dispose(){var o,e;(o=this._scrollTimer)==null||o.dispose(),this._fillControlColors=[],this._clearObserverEvent(),(e=this._helperSelection)==null||e.dispose()}setDisabled(o){this._disabled=o}_getFreeze(){var e,t;return(t=(e=M.withCurrentTypeOfRenderer(a.UniverInstanceType.UNIVER_SHEET,y.SheetSkeletonManagerService,this._injector.get(a.IUniverInstanceService),this._injector.get(M.IRenderManagerService)))==null?void 0:e.getCurrentParam())==null?void 0:t.skeleton.getWorksheetConfig().freeze}_isSelectionInViewport(o,e){const t=this._getFreeze()||{startRow:-1,startColumn:-1};switch(e.viewportKey){case M.SHEET_VIEWPORT_KEY.VIEW_MAIN:return o.endRow>=t.startRow&&o.endColumn>=t.startColumn;case M.SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP:case M.SHEET_VIEWPORT_KEY.VIEW_COLUMN_RIGHT:return o.endColumn>=t.startColumn&&o.startRow<t.startRow;case M.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT:case M.SHEET_VIEWPORT_KEY.VIEW_ROW_BOTTOM:return o.endRow>=t.startRow&&o.startColumn<t.startColumn;case M.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP:case M.SHEET_VIEWPORT_KEY.VIEW_COLUMN_LEFT:case M.SHEET_VIEWPORT_KEY.VIEW_ROW_TOP:case M.SHEET_VIEWPORT_KEY.VIEW_LEFT_TOP:return o.startRow<t.startRow&&o.startColumn<t.startColumn}}_clearObserverEvent(){var o,e;(o=this._scenePointerMoveSub)==null||o.unsubscribe(),(e=this._scenePointerUpSub)==null||e.unsubscribe(),this._scenePointerMoveSub=null,this._scenePointerUpSub=null}_initialControl(){const{leftControl:o,rightControl:e,topControl:t,bottomControl:i}=this._control;[o,e,t,i].forEach(r=>{r.onPointerEnter$.subscribeEvent(()=>{var l;((l=this._injector.get(Ie,a.Quantity.OPTIONAL))==null?void 0:l.interceptor.fetchThroughInterceptors(Zo)(!1,null))!==!1&&r.setCursor(M.CURSOR_TYPE.MOVE)}),r.onPointerLeave$.subscribeEvent(()=>{r.resetCursor()}),r.onPointerDown$.subscribeEvent(this._controlPointerDownHandler.bind(this))})}_controlMoving(o,e){var D;const t=this._scene,i=t.getScrollXYInfoByViewport(M.Vector2.FromArray([o,e])),{scaleX:r,scaleY:s}=t.getAncestorScale(),l=this._skeleton.getCellIndexByOffset(o,e,r,s,i),{row:c,column:d}=l,u=this._skeleton.getRowCount()-1,h=this._skeleton.getColumnCount()-1;let g=Math.max(0,c+this._relativeSelectionPositionRow),S=g+this._relativeSelectionRowLength;S>u&&(S=u,S-g<this._relativeSelectionRowLength&&(g=S-this._relativeSelectionRowLength));let f=Math.max(0,d+this._relativeSelectionPositionColumn),v=f+this._relativeSelectionColumnLength;v>h&&(v=h,v-f<this._relativeSelectionColumnLength&&(f=v-this._relativeSelectionColumnLength));const p=this._skeleton.worksheet.getCellInfoInMergeData(g,f),_=Re({range:{startRow:g,endRow:S,startColumn:f,endColumn:v},primary:p,style:null},this._skeleton),w=this._skeleton.getNoMergeCellWithCoordByIndex(g,f),E=this._skeleton.getNoMergeCellWithCoordByIndex(S,v),O=(w==null?void 0:w.startY)||0,T=(E==null?void 0:E.endY)||0,P=(w==null?void 0:w.startX)||0,A=(E==null?void 0:E.endX)||0;(D=this._helperSelection)==null||D.transformByState({left:P,top:O,width:A-P,height:T-O}),this._targetSelection={..._.rangeWithCoord},this._control.selectionMoving$.next(_.rangeWithCoord)}_controlPointerDownHandler(o){const{offsetX:e,offsetY:t}=o,i=this._scene,r=i.getCoordRelativeToViewport(M.Vector2.FromArray([e,t])),{x:s,y:l}=r,c=i.getScrollXYInfoByViewport(r),{scaleX:d,scaleY:u}=i.getAncestorScale(),h=this._skeleton.getCellIndexByOffset(s,l,d,u,c);this._startOffsetX=s,this._startOffsetY=l;const{row:g,column:S}=h,{startRow:f,startColumn:v,endRow:p,endColumn:C}=this._control.model;let _=0,w=0;g<f?_-=1:g>p&&(_+=1),S<v?w-=1:S>C&&(w+=1),this._relativeSelectionPositionRow=f-g+_,this._relativeSelectionPositionColumn=v-S+w,this._relativeSelectionRowLength=p-f,this._relativeSelectionColumnLength=C-v;const E=this._control.currentStyle,O=this._getScale();this.isHelperSelection&&(this._helperSelection=new M.Rect(Ls,{stroke:E.stroke,strokeWidth:E.strokeWidth/O}),i.addObject(this._helperSelection));const T=i.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN),P=M.ScrollTimer.create(i);this._scrollTimer=P,P.startScroll(s,l,T),i.disableObjectsEvent(),this._scenePointerMoveSub=i.onPointerMove$.subscribeEvent(A=>{var W;if(this._disabled)return;const{offsetX:D,offsetY:k}=A;if(((W=this._injector.get(Ie,a.Quantity.OPTIONAL))==null?void 0:W.interceptor.fetchThroughInterceptors(Zo)(!1,null))===!1)return;const{x:V,y:L}=i.getCoordRelativeToViewport(M.Vector2.FromArray([D,k]));this._controlMoving(V,L),i.setCursor(M.CURSOR_TYPE.MOVE),P.scrolling(V,L,()=>{this._controlMoving(V,L)})}),this._scenePointerUpSub=i.onPointerUp$.subscribeEvent(()=>{var D,k,H,V;(D=this._helperSelection)==null||D.dispose();const A=this._scene;A.resetCursor(),this._clearObserverEvent(),A.enableObjectsEvent(),(k=this._scrollTimer)==null||k.dispose(),this._control.selectionMoveEnd$.next(this._targetSelection),(V=(H=this._selectionHooks).selectionMoveEnd)==null||V.call(H)})}_initialWidget(){const{topLeftWidget:o,topCenterWidget:e,topRightWidget:t,middleLeftWidget:i,middleRightWidget:r,bottomLeftWidget:s,bottomCenterWidget:l,bottomRightWidget:c}=this._control,d=[M.CURSOR_TYPE.NORTH_WEST_RESIZE,M.CURSOR_TYPE.NORTH_RESIZE,M.CURSOR_TYPE.NORTH_EAST_RESIZE,M.CURSOR_TYPE.WEST_RESIZE,M.CURSOR_TYPE.EAST_RESIZE,M.CURSOR_TYPE.SOUTH_WEST_RESIZE,M.CURSOR_TYPE.SOUTH_RESIZE,M.CURSOR_TYPE.SOUTH_EAST_RESIZE];[o,e,t,i,r,s,l,c].forEach((u,h)=>{u.onPointerEnter$.subscribeEvent(()=>{u.setCursor(d[h])}),u.onPointerLeave$.subscribeEvent(()=>{u.resetCursor()}),u.onPointerDown$.subscribeEvent(g=>{this._widgetPointerDownEvent(g,d[h])})})}_widgetPointerDownEvent(o,e){const t=this._scene,{offsetX:i,offsetY:r}=o,s=t.getCoordRelativeToViewport(M.Vector2.FromArray([i,r])),{x:l,y:c}=s;this._startOffsetX=i,this._startOffsetY=r;const{startRow:d,startColumn:u,endRow:h,endColumn:g}=this._control.model,S=Math.min(d,h),f=Math.min(u,g),v=Math.max(d,h),p=Math.max(u,g);this._relativeSelectionPositionRow=S,this._relativeSelectionPositionColumn=f,this._relativeSelectionRowLength=v-S,this._relativeSelectionColumnLength=p-f,e===M.CURSOR_TYPE.NORTH_WEST_RESIZE?(this._relativeSelectionPositionRow=v,this._relativeSelectionPositionColumn=p):e===M.CURSOR_TYPE.NORTH_RESIZE?this._relativeSelectionPositionRow=v:e===M.CURSOR_TYPE.NORTH_EAST_RESIZE?this._relativeSelectionPositionRow=v:e===M.CURSOR_TYPE.WEST_RESIZE?this._relativeSelectionPositionColumn=p:e===M.CURSOR_TYPE.SOUTH_WEST_RESIZE?this._relativeSelectionPositionColumn=p:e===M.CURSOR_TYPE.SOUTH_RESIZE&&(this._relativeSelectionPositionRow=S);const C=M.ScrollTimer.create(t),_=t.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN);C.startScroll(l,c,_),this._scrollTimer=C,t.disableObjectsEvent(),this._scenePointerMoveSub=t.onPointerMove$.subscribeEvent(w=>{const{offsetX:E,offsetY:O}=w,{x:T,y:P}=t.getCoordRelativeToViewport(M.Vector2.FromArray([E,O]));this._widgetMoving(T,P,e),t.setCursor(e),C.scrolling(T,P,()=>{this._widgetMoving(T,P,e)})}),this._scenePointerUpSub=t.onPointerUp$.subscribeEvent(()=>{var E,O,T;const w=this._scene;w.resetCursor(),this._clearObserverEvent(),w.enableObjectsEvent(),(E=this._scrollTimer)==null||E.dispose(),this._control.selectionScaled$.next(this._targetSelection),(T=(O=this._selectionHooks).selectionMoveEnd)==null||T.call(O)})}_widgetMoving(o,e,t){const i=this._scene,r=i.getScrollXYInfoByViewport(M.Vector2.FromArray([this._startOffsetX,this._startOffsetY])),{scaleX:s,scaleY:l}=i.getAncestorScale(),c=this._skeleton.getCellIndexByOffset(o,e,s,l,r),{row:d,column:u}=c;let h=this._relativeSelectionPositionRow,g=this._relativeSelectionPositionColumn,S=d,f=u;t===M.CURSOR_TYPE.NORTH_WEST_RESIZE?(h=d,g=u,S=this._relativeSelectionPositionRow,f=this._relativeSelectionPositionColumn):t===M.CURSOR_TYPE.NORTH_RESIZE?(h=d,g=this._relativeSelectionPositionColumn,S=this._relativeSelectionPositionRow,f=this._relativeSelectionPositionColumn+this._relativeSelectionColumnLength):t===M.CURSOR_TYPE.NORTH_EAST_RESIZE?(h=d,g=this._relativeSelectionPositionColumn,S=this._relativeSelectionPositionRow,f=u):t===M.CURSOR_TYPE.WEST_RESIZE?(h=this._relativeSelectionPositionRow,g=u,S=this._relativeSelectionPositionRow+this._relativeSelectionRowLength,f=this._relativeSelectionPositionColumn):t===M.CURSOR_TYPE.EAST_RESIZE?S=this._relativeSelectionPositionRow+this._relativeSelectionRowLength:t===M.CURSOR_TYPE.SOUTH_WEST_RESIZE?(h=this._relativeSelectionPositionRow,g=u,S=d,f=this._relativeSelectionPositionColumn):t===M.CURSOR_TYPE.SOUTH_RESIZE&&(h=this._relativeSelectionPositionRow,g=this._relativeSelectionPositionColumn,S=d,f=this._relativeSelectionPositionColumn+this._relativeSelectionColumnLength);const v=this._swapPositions(h,g,S,f),p=this._skeleton.getCellWithMergeInfoByIndex(h,g),_=Re({range:v,primary:p,style:null},this._skeleton);this._targetSelection={..._.rangeWithCoord},this._control.updateRangeBySelectionWithCoord(_),this._control.selectionScaling$.next(this._targetSelection)}_initialAutoFill(){const{fillControl:o}=this._control;o.onPointerEnter$.subscribeEvent(e=>{this._injector.get(Ie).interceptor.fetchThroughInterceptors(Go)(!1,{x:e.offsetX,y:e.offsetY,skeleton:this._skeleton,scene:this._scene})&&o.setCursor(M.CURSOR_TYPE.CROSSHAIR)}),o.onPointerLeave$.subscribeEvent(()=>{o.resetCursor()}),o.onPointerDown$.subscribeEvent(this._autoFillForPointerdown.bind(this))}_autoFillMoving(o,e){var k,H,V;const t=this._scene,i=t.getViewportScrollXY(this._activeViewport),{scaleX:r,scaleY:s}=t.getAncestorScale(),l=this._skeleton.getCellIndexByOffset(o,e,r,s,i),{row:c,column:d}=l,u=t.getCoordRelativeToViewport(M.Vector2.FromArray([o,e])),h=this._skeleton.getRowCount()-1,g=this._skeleton.getColumnCount()-1;let S=this._relativeSelectionPositionRow,f=this._relativeSelectionPositionColumn,v=this._relativeSelectionPositionRow+this._relativeSelectionRowLength,p=this._relativeSelectionPositionColumn+this._relativeSelectionColumnLength,C=!1,_=!0;if((d<f||d>p)&&c>=S&&c<=v){const L=this._fillRuler(d,f,p,this._relativeSelectionColumnLength,g);f=L.startRowOrColumn,p=L.endRowOrColumn,C=L.isLighten,_=!1}else if((c<S||c>v)&&d>=f&&d<=p){const L=this._fillRuler(c,S,v,this._relativeSelectionRowLength,h);S=L.startRowOrColumn,v=L.endRowOrColumn,C=L.isLighten}else if(Math.abs(this._startOffsetX-u.x-i.x)/2>Math.abs(this._startOffsetY-u.y-i.y)){const L=this._fillRuler(d,f,p,this._relativeSelectionColumnLength,g);f=L.startRowOrColumn,p=L.endRowOrColumn,C=L.isLighten,_=!1}else{const L=this._fillRuler(c,S,v,this._relativeSelectionRowLength,h);S=L.startRowOrColumn,v=L.endRowOrColumn,C=L.isLighten}const w=this._skeleton.getNoMergeCellWithCoordByIndex(S,f),E=this._skeleton.getNoMergeCellWithCoordByIndex(v,p),O=(w==null?void 0:w.startY)||0,T=(E==null?void 0:E.endY)||0,P=(w==null?void 0:w.startX)||0,A=(E==null?void 0:E.endX)||0;C?this._controlHandler((L,W)=>{const B=new a.ColorKit(this._fillControlColors[W]).lighten(vd).toRgbString();L.setProps({fill:B})}):this._controlHandler((L,W)=>{L.setProps({fill:this._fillControlColors[W]})});const D=m.SELECTION_CONTROL_BORDER_BUFFER_WIDTH/this._getScale();S===v&&_===!0||f===p&&_===!1?(k=this._helperSelection)==null||k.hide():((H=this._helperSelection)==null||H.transformByState({left:P-D/2,top:O-D/2,width:A-P,height:T-O}),(V=this._helperSelection)==null||V.show()),this._targetSelection={startY:O,endY:T,startX:P,endX:A,startRow:S,endRow:v,startColumn:f,endColumn:p},this._control.selectionFilling$.next(this._targetSelection)}_autoFillForPointerdown(o){const{offsetX:e,offsetY:t}=o,i=this._scene,r=i.getCoordRelativeToViewport(M.Vector2.FromArray([e,t])),{x:s,y:l}=r;this._startOffsetX=s,this._startOffsetY=l;const{startRow:c,startColumn:d,endRow:u,endColumn:h}=this._control.model;this._isInMergeState=this._hasMergeInRange(c,d,u,h),this._relativeSelectionPositionRow=c,this._relativeSelectionPositionColumn=d,this._relativeSelectionRowLength=u-c,this._relativeSelectionColumnLength=h-d;const g=this._control.currentStyle;let S=g==null?void 0:g.stroke,f=g==null?void 0:g.strokeWidth;const v=qe(this._themeService);S==null&&(S=v.stroke),f==null&&(f=v.strokeWidth);const p=this._getScale();f/=p;const C=m.SELECTION_CONTROL_BORDER_BUFFER_WIDTH/p,_=new a.ColorKit(S).darken(2).toRgbString();this.isHelperSelection&&(this._helperSelection=new M.Rect(Ls,{stroke:_,strokeWidth:f+C/2}),i.addObject(this._helperSelection)),this._activeViewport=i.getActiveViewportByCoord(M.Vector2.FromArray([e,t]));const w=i.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN),E=M.ScrollTimer.create(i,this._activeViewport.viewportKey===M.SHEET_VIEWPORT_KEY.VIEW_MAIN?M.ScrollTimerType.ALL:M.ScrollTimerType.NONE);E.startScroll(s,l,w),this._scrollTimer=E,i.disableObjectsEvent(),this._controlHandler(O=>{this._fillControlColors.push(O.fill)}),this._scenePointerMoveSub=i.onPointerMove$.subscribeEvent(O=>{var L;const{offsetX:T,offsetY:P}=O,A=i.getActiveViewportByCoord(M.Vector2.FromArray([T,P]));if(!this._injector.get(Ie).interceptor.fetchThroughInterceptors(Go)(!1,{x:o.offsetX,y:o.offsetY,skeleton:this._skeleton,scene:this._scene}))return;const{x:k,y:H}=i.getCoordRelativeToViewport(M.Vector2.FromArray([T,P]));this._autoFillMoving(k,H),i.setCursor(M.CURSOR_TYPE.CROSSHAIR);const V=this._targetSelection;if(w&&A&&((L=this._activeViewport)==null?void 0:L.viewportKey)!==(A==null?void 0:A.viewportKey)){let W;V.startRow!==c?(E.scrollTimerType=M.ScrollTimerType.Y,W={...V,endRow:V.startRow}):V.endRow!==u?(E.scrollTimerType=M.ScrollTimerType.Y,W={...V,startRow:V.endRow}):V.startColumn!==d?(E.scrollTimerType=M.ScrollTimerType.X,W={...V,endColumn:V.startColumn}):(E.scrollTimerType=M.ScrollTimerType.X,W={...V,startColumn:V.endColumn}),this._isSelectionInViewport(W,A)&&(this._viewportMainScrollBarNeedResetPosition(E.scrollTimerType,this._activeViewport.viewportKey,A.viewportKey)&&w.scrollToBarPos({x:E.scrollTimerType===M.ScrollTimerType.X?0:void 0,y:E.scrollTimerType===M.ScrollTimerType.Y?0:void 0}),this._activeViewport=A)}E.scrolling(k,H,()=>{this._autoFillMoving(k,H)})}),this._scenePointerUpSub=i.onPointerUp$.subscribeEvent(()=>{var T,P;(T=this._helperSelection)==null||T.dispose();const O=this._scene;O.resetCursor(),this._clearObserverEvent(),O.enableObjectsEvent(),(P=this._scrollTimer)==null||P.dispose(),this._control.refreshSelectionFilled(this._targetSelection),this._isInMergeState=!1,this._controlHandler((A,D)=>{A.setProps({fill:this._fillControlColors[D]})}),this._fillControlColors=[]})}_viewportMainScrollBarNeedResetPosition(o,e,t){return o===M.ScrollTimerType.X&&(e===M.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT||e===M.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP)&&(t===M.SHEET_VIEWPORT_KEY.VIEW_MAIN||t===M.SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP)||o===M.ScrollTimerType.Y&&(e===M.SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP||e===M.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP)&&(t===M.SHEET_VIEWPORT_KEY.VIEW_MAIN||t===M.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT)}_hasMergeInRange(o,e,t,i){return this._skeleton.worksheet.getMergedCellRange(o,e,t,i).length>0}_swapPositions(o,e,t,i){const r=Math.min(o,t),s=Math.min(e,i),l=Math.max(o,t),c=Math.max(e,i);return{startRow:r,startColumn:s,endRow:l,endColumn:c}}_controlHandler(o){const{leftControl:e,rightControl:t,topControl:i,bottomControl:r,backgroundControlTop:s,backgroundControlMiddleLeft:l,backgroundControlMiddleRight:c,backgroundControlBottom:d,fillControl:u}=this._control,h=[e,t,i,r,s,l,c,d,u];for(let g=0,S=h.length;g<S;g++){const f=h[g];o(f,g)}}_fillRuler(o,e,t,i,r){let s=!1;if(o<e)if(this._isInMergeState&&o<e){const l=e-o,c=i+1,d=Math.ceil(l/c);let u=e-d*c;u<0&&(u=e-(d-1)*c),e=u}else e=o;else if(o>=e&&o<=t)s=!0,this._isInMergeState||(t=o);else if(this._isInMergeState&&o>t){const l=o-t,c=i+1,d=Math.ceil(l/c);let u=t+d*c;u>r&&(u=t+(d-1)*c),t=u}else t=o;return{rowOrColumn:o,startRowOrColumn:e,endRowOrColumn:t,isLighten:s}}_getScale(){const{scaleX:o,scaleY:e}=this._scene.getAncestorScale();return Math.max(o,e)}}var qo=(n=>(n.Selection="__SpreadsheetSelectionShape__",n.top="__SpreadsheetSelectionTopControl__",n.bottom="__SpreadsheetSelectionBottomControl__",n.left="__SpreadsheetSelectionShapeLeftControl__",n.right="__SpreadsheetSelectionShapeRightControl__",n.backgroundTop="__SpreadsheetSelectionBackgroundControlTop__",n.backgroundMiddleLeft="__SpreadsheetSelectionBackgroundControlMiddleLeft__",n.backgroundMiddleRight="__SpreadsheetSelectionBackgroundControlMiddleRight__",n.backgroundBottom="__SpreadsheetSelectionBackgroundControlBottom__",n.fill="__SpreadsheetSelectionFillControl__",n.fillTopLeft="__SpreadsheetSelectionFillControlTopLeft__",n.fillBottomRight="__SpreadsheetSelectionFillControlBottomRight__",n.fillTopLeftInner="__SpreadsheetSelectionFillControlTopLeftInner__",n.fillBottomRightInner="__SpreadsheetSelectionFillControlBottomRightInner__",n.lineMain="__SpreadsheetDragLineMainControl__",n.lineContent="__SpreadsheetDragLineContentControl__",n.line="__SpreadsheetDragLineControl__",n.dash="__SpreadsheetDragDashControl__",n.rowHeaderBackground="__SpreadSheetSelectionRowHeaderBackground__",n.rowHeaderBorder="__SpreadSheetSelectionRowHeaderBorder__",n.rowHeaderGroup="__SpreadSheetSelectionRowHeaderGroup__",n.columnHeaderBackground="__SpreadSheetSelectionColumnHeaderBackground__",n.columnHeaderBorder="__SpreadSheetSelectionColumnHeaderBorder__",n.columnHeaderGroup="__SpreadSheetSelectionColumnHeaderGroup__",n.topLeftWidget="__SpreadSheetSelectionTopLeftWidget__",n.topCenterWidget="__SpreadSheetSelectionTopCenterWidget__",n.topRightWidget="__SpreadSheetSelectionTopRightWidget__",n.middleLeftWidget="__SpreadSheetSelectionMiddleLeftWidget__",n.middleRightWidget="__SpreadSheetSelectionMiddleRightWidget__",n.bottomLeftWidget="__SpreadSheetSelectionBottomLeftWidget__",n.bottomCenterWidget="__SpreadSheetSelectionBottomCenterWidget__",n.bottomRightWidget="__SpreadSheetSelectionBottomRightWidget__",n))(qo||{});const Us=.3;class Kn extends a.Disposable{constructor(e,t,i,r){var s,l,c,d;super();R(this,"_isHelperSelection",!0);R(this,"_enableAutoFill",!0);R(this,"_showAutoFill",!1);R(this,"_highlightHeader",!0);R(this,"_selectionRenderModel");R(this,"_leftBorder");R(this,"_rightBorder");R(this,"_topBorder");R(this,"_bottomBorder");R(this,"_backgroundControlTop");R(this,"_backgroundControlBottom");R(this,"_backgroundControlMiddleLeft");R(this,"_backgroundControlMiddleRight");R(this,"_autoFillControl");R(this,"_selectionShapeGroup");R(this,"_rowHeaderBackground");R(this,"_rowHeaderBorder");R(this,"_rowHeaderGroup");R(this,"_columnHeaderBackground");R(this,"_columnHeaderBorder");R(this,"_columnHeaderGroup");R(this,"_dashedRect");R(this,"_topLeftWidget");R(this,"_topCenterWidget");R(this,"_topRightWidget");R(this,"_middleLeftWidget");R(this,"_middleRightWidget");R(this,"_bottomLeftWidget");R(this,"_bottomCenterWidget");R(this,"_bottomRightWidget");R(this,"_defaultStyle");R(this,"_currentStyle");R(this,"_rowHeaderWidth",0);R(this,"_columnHeaderHeight",0);R(this,"_widgetRects",[]);R(this,"_controlExtension");R(this,"_dispose$",new N.BehaviorSubject(this));R(this,"dispose$",this._dispose$.asObservable());R(this,"selectionMoving$",new N.Subject);R(this,"selectionMoveEnd$",new N.Subject);R(this,"selectionScaling$",new N.Subject);R(this,"selectionScaled$",new N.Subject);R(this,"selectionFilling$",new N.Subject);R(this,"_selectionFilled$",new N.Subject);R(this,"selectionFilled$",this._selectionFilled$.asObservable());R(this,"_antLineOffset",0);R(this,"_antRequestNewFrame",-1);this._scene=e,this._zIndex=t,this._themeService=i,this._enableAutoFill=(s=r==null?void 0:r.enableAutoFill)!=null?s:!0,this._highlightHeader=(l=r==null?void 0:r.highlightHeader)!=null?l:!0,this._rowHeaderWidth=(c=r==null?void 0:r.rowHeaderWidth)!=null?c:0,this._columnHeaderHeight=(d=r==null?void 0:r.columnHeaderHeight)!=null?d:0,this._initializeSheetBody(),this._initialHeader()}_initializeSheetBody(){this._defaultStyle=qe(this._themeService),this._currentStyle=qe(this._themeService),this._selectionRenderModel=new fd;const e=this._zIndex;this._leftBorder=new M.Rect("__SpreadsheetSelectionShapeLeftControl__"+e,{zIndex:e}),this._rightBorder=new M.Rect("__SpreadsheetSelectionShapeRightControl__"+e,{zIndex:e}),this._topBorder=new M.Rect("__SpreadsheetSelectionTopControl__"+e,{zIndex:e}),this._bottomBorder=new M.Rect("__SpreadsheetSelectionBottomControl__"+e,{zIndex:e}),this._backgroundControlTop=new M.Rect("__SpreadsheetSelectionBackgroundControlTop__"+e,{zIndex:e-1,evented:!1}),this._backgroundControlBottom=new M.Rect("__SpreadsheetSelectionBackgroundControlBottom__"+e,{zIndex:e-1,evented:!1}),this._backgroundControlMiddleLeft=new M.Rect("__SpreadsheetSelectionBackgroundControlMiddleLeft__"+e,{zIndex:e-1,evented:!1}),this._backgroundControlMiddleRight=new M.Rect("__SpreadsheetSelectionBackgroundControlMiddleRight__"+e,{zIndex:e-1,evented:!1}),this._autoFillControl=new M.Rect("__SpreadsheetSelectionFillControl__"+e,{zIndex:e+1}),this._autoFillControl.hide(),this._dashedRect=new M.DashedRect("__SpreadsheetDragDashControl__"+e,{zIndex:e+2,evented:!1,stroke:"#fff"});const t=[this._autoFillControl,this._leftBorder,this._rightBorder,this._topBorder,this._bottomBorder,this._backgroundControlTop,this._backgroundControlMiddleLeft,this._backgroundControlMiddleRight,this._backgroundControlBottom,this._dashedRect];this._widgetRects=this._initialWidget(),this._selectionShapeGroup=new M.Group("__SpreadsheetSelectionShape__"+e,...t,...this._widgetRects),this._selectionShapeGroup.hide(),this._selectionShapeGroup.evented=!1,this._selectionShapeGroup.zIndex=e;const i=this.getScene();i.addObject(this._selectionShapeGroup,Bi),this.disposeWithMe(a.toDisposable(i.onTransformChange$.subscribeEvent(r=>{r.type===M.TRANSFORM_CHANGE_OBSERVABLE_TYPE.scale&&(this._updateLayoutOfSelectionControl(this._currentStyle),this._updateControlCoord())})))}_initialHeader(){const e=this._zIndex;this._rowHeaderBackground=new M.Rect("__SpreadSheetSelectionRowHeaderBackground__"+e,{zIndex:e-1,evented:!1}),this._rowHeaderBorder=new M.Rect("__SpreadSheetSelectionRowHeaderBorder__"+e,{zIndex:e-1,evented:!1}),this._rowHeaderGroup=new M.Group("__SpreadSheetSelectionRowHeaderGroup__"+e,this._rowHeaderBackground,this._rowHeaderBorder),this._rowHeaderGroup.hide(),this._rowHeaderGroup.evented=!1,this._rowHeaderGroup.zIndex=e,this._columnHeaderBackground=new M.Rect("__SpreadSheetSelectionColumnHeaderBackground__"+e,{zIndex:e-1,evented:!1}),this._columnHeaderBorder=new M.Rect("__SpreadSheetSelectionColumnHeaderBorder__"+e,{zIndex:e-1,evented:!1}),this._columnHeaderGroup=new M.Group("__SpreadSheetSelectionColumnHeaderGroup__"+e,this._columnHeaderBackground,this._columnHeaderBorder),this._columnHeaderGroup.hide(),this._columnHeaderGroup.evented=!1,this._columnHeaderGroup.zIndex=e,this.getScene().addObjects([this._rowHeaderGroup,this._columnHeaderGroup],Sd)}_initialWidget(){const e=this._zIndex;return this._topLeftWidget=new M.Rect("__SpreadSheetSelectionTopLeftWidget__"+e,{zIndex:e+1}),this._topCenterWidget=new M.Rect("__SpreadSheetSelectionTopCenterWidget__"+e,{zIndex:e+1}),this._topRightWidget=new M.Rect("__SpreadSheetSelectionTopRightWidget__"+e,{zIndex:e+1}),this._middleLeftWidget=new M.Rect("__SpreadSheetSelectionMiddleLeftWidget__"+e,{zIndex:e+1}),this._middleRightWidget=new M.Rect("__SpreadSheetSelectionMiddleRightWidget__"+e,{zIndex:e+1}),this._bottomLeftWidget=new M.Rect("__SpreadSheetSelectionBottomLeftWidget__"+e,{zIndex:e+1}),this._bottomCenterWidget=new M.Rect("__SpreadSheetSelectionBottomCenterWidget__"+e,{zIndex:e+1}),this._bottomRightWidget=new M.Rect("__SpreadSheetSelectionBottomRightWidget__"+e,{zIndex:e+1}),[this._topLeftWidget,this._topCenterWidget,this._topRightWidget,this._middleLeftWidget,this._middleRightWidget,this._bottomLeftWidget,this._bottomCenterWidget,this._bottomRightWidget]}get zIndex(){return this._zIndex}get leftControl(){return this._leftBorder}get rightControl(){return this._rightBorder}get topControl(){return this._topBorder}get bottomControl(){return this._bottomBorder}get fillControl(){return this._autoFillControl}get backgroundControlTop(){return this._backgroundControlTop}get backgroundControlBottom(){return this._backgroundControlBottom}get backgroundControlMiddleLeft(){return this._backgroundControlMiddleLeft}get backgroundControlMiddleRight(){return this._backgroundControlMiddleRight}get selectionShape(){return this._selectionShapeGroup}get columnHeaderGroup(){return this._columnHeaderGroup}get rowHeaderGroup(){return this._rowHeaderGroup}get selectionShapeGroup(){return this._selectionShapeGroup}get model(){return this._selectionRenderModel}get topLeftWidget(){return this._topLeftWidget}get topCenterWidget(){return this._topCenterWidget}get topRightWidget(){return this._topRightWidget}get middleLeftWidget(){return this._middleLeftWidget}get middleRightWidget(){return this._middleRightWidget}get bottomLeftWidget(){return this._bottomLeftWidget}get bottomCenterWidget(){return this._bottomCenterWidget}get bottomRightWidget(){return this._bottomRightWidget}get themeService(){return this._themeService}get selectionModel(){return this._selectionRenderModel}set selectionModel(e){this._selectionRenderModel=e}get currentStyle(){return this._currentStyle}set currentStyle(e){this._currentStyle=e}get dashedRect(){return this._dashedRect}get isHelperSelection(){return this._isHelperSelection}get rowHeaderWidth(){return this._rowHeaderWidth}set rowHeaderWidth(e){this._rowHeaderWidth=e}get columnHeaderHeight(){return this._columnHeaderHeight}set columnHeaderHeight(e){this._columnHeaderHeight=e}setControlExtension(e){this._controlExtension=new xs(this,e)}setControlExtensionDisable(e){this._controlExtension&&this._controlExtension.setDisabled(e)}setEvent(e){this.leftControl.evented=e,this.rightControl.evented=e,this.topControl.evented=e,this.bottomControl.evented=e}refreshSelectionFilled(e){this._selectionFilled$.next(e)}_updateLayoutOfSelectionControl(e){e&&(this.currentStyle=Object.assign({},this._defaultStyle,e));const t=this.currentStyle,{stroke:i,widgets:r,autofillStroke:s,strokeDash:l,isAnimationDash:c}=t;let d=t.autofillSize,u=t.strokeWidth,h=t.autofillStrokeWidth;const g=this._getScale(),S=(u+m.SELECTION_CONTROL_BORDER_BUFFER_WIDTH)/2/g;u/=g,d/=g,h/=g<1?1:g;const f=m.SELECTION_CONTROL_BORDER_BUFFER_WIDTH/g,v=M.FIX_ONE_PIXEL_BLUR_OFFSET/g,{startX:p,startY:C,endX:_,endY:w}=this._selectionRenderModel;if(this.leftControl.transformByState({height:w-C,left:-S+v,width:u,strokeWidth:f,top:-f/2+v}),this.leftControl.setProps({fill:i,stroke:m.SELECTION_CONTROL_BORDER_BUFFER_COLOR}),this.rightControl.transformByState({height:w-C,left:_-p-S+v,width:u,strokeWidth:f,top:-f/2+v}),this.rightControl.setProps({fill:i,stroke:m.SELECTION_CONTROL_BORDER_BUFFER_COLOR}),this.topControl.transformByState({width:_-p+u,top:-S+v,left:-S+v,height:u,strokeWidth:f}),this.topControl.setProps({fill:i,stroke:m.SELECTION_CONTROL_BORDER_BUFFER_COLOR}),this.bottomControl.transformByState({width:_-p+u,top:w-C-S+v,height:u,left:-S+v,strokeWidth:f}),this.bottomControl.setProps({fill:i,stroke:m.SELECTION_CONTROL_BORDER_BUFFER_COLOR}),l==null)this.dashedRect.hide(),this._stopAntLineAnimation();else{const E=t.strokeWidth*2/g;this.dashedRect.transformByState({height:w-C,width:_-p,strokeWidth:E,left:-E/2+v,top:-E/2+v}),this.dashedRect.setProps({strokeDashArray:[0,l/g]}),this._stopAntLineAnimation(),c!==!1&&this._startAntLineAnimation(),this.dashedRect.show()}if(this._showAutoFill=this._showAutoFill&&this._enableAutoFill,this._showAutoFill&&!this._hasWidgets(r)){const E={fill:i,stroke:s,strokeScaleEnabled:!1},O={width:d-h,height:d-h,left:_-p-d/2+h/2-v,top:w-C-d/2+h/2-v,strokeWidth:h};this._autoFillControl.setProps(E),this._autoFillControl.transformByState(O),this._autoFillControl.show()}else this._autoFillControl.hide();this._updateBackgroundControl(t),this._updateHeaderBackground(t),this._updateWidgets(t)}_updateControlCoord(){const{startX:e,startY:t}=this._selectionRenderModel;this.selectionShapeGroup.show(),this.selectionShapeGroup.translate(e,t),this.selectionShapeGroup.makeDirtyNoDebounce(!0)}updateStyle(e){this._updateLayoutOfSelectionControl(e),this._updateControlCoord()}updateRange(e,t){this._selectionRenderModel.setValue(e,t),this._showAutoFill=t!==null,this._updateLayoutOfSelectionControl(),this._updateControlCoord()}updateRangeBySelectionWithCoord(e,t){t&&(this._rowHeaderWidth=t.rowHeaderWidth,this._columnHeaderHeight=t.columnHeaderHeight),this._selectionRenderModel.setValue(e.rangeWithCoord,e.primaryWithCoord),this._showAutoFill=e.primaryWithCoord!==null,this._updateLayoutOfSelectionControl(e.style),this._updateControlCoord()}update(e,t=0,i=0,r,s){this._rowHeaderWidth=t,this._columnHeaderHeight=i,this.updateRangeBySelectionWithCoord({rangeWithCoord:e,primaryWithCoord:s,style:r}),r&&this.updateStyle(r)}updateCurrCell(e){this._showAutoFill=e!==null,this._selectionRenderModel.setCurrentCell(e)}clearHighlight(){this._showAutoFill=!1,this._selectionRenderModel.clearCurrentCell(),this._updateLayoutOfSelectionControl(this._currentStyle)}getScene(){return this._scene}dispose(){var e,t,i,r,s,l,c,d,u,h,g,S,f,v,p,C,_,w,E,O,T,P,A,D,k;(e=this._leftBorder)==null||e.dispose(),(t=this._rightBorder)==null||t.dispose(),(i=this._topBorder)==null||i.dispose(),(r=this._bottomBorder)==null||r.dispose(),(s=this._backgroundControlTop)==null||s.dispose(),(l=this._backgroundControlMiddleLeft)==null||l.dispose(),(c=this._backgroundControlMiddleRight)==null||c.dispose(),(d=this._backgroundControlBottom)==null||d.dispose(),this._autoFillControl.dispose(),(u=this._selectionShapeGroup)==null||u.dispose(),(h=this._rowHeaderBackground)==null||h.dispose(),(g=this._rowHeaderBorder)==null||g.dispose(),(S=this._rowHeaderGroup)==null||S.dispose(),(f=this._rowHeaderBackground)==null||f.dispose(),(v=this._columnHeaderBackground)==null||v.dispose(),(p=this._columnHeaderBorder)==null||p.dispose(),(C=this._columnHeaderGroup)==null||C.dispose(),(_=this._topLeftWidget)==null||_.dispose(),(w=this._topCenterWidget)==null||w.dispose(),(E=this._topRightWidget)==null||E.dispose(),(O=this._middleLeftWidget)==null||O.dispose(),(T=this._middleRightWidget)==null||T.dispose(),(P=this._bottomLeftWidget)==null||P.dispose(),(A=this._bottomCenterWidget)==null||A.dispose(),(D=this._bottomRightWidget)==null||D.dispose(),(k=this._controlExtension)==null||k.dispose(),super.dispose(),this._dispose$.next(this),this._dispose$.complete()}getCurrentCellInfo(){const e=this.model.currentCell;if(e){let t;if(e.isMerged){const i=e.mergeInfo;t={startRow:i.startRow,endRow:i.endRow,startColumn:i.startColumn,endColumn:i.endColumn,startX:i.startX,endX:i.endX,startY:i.startY,endY:i.endY}}else{const{actualRow:i,actualColumn:r,startX:s,endX:l,startY:c,endY:d}=e;t={startRow:i,endRow:i,startColumn:r,endColumn:r,startX:s,endX:l,startY:c,endY:d}}return t}}getValue(){return{...this._selectionRenderModel.getValue(),style:this._currentStyle}}getRange(){return this._selectionRenderModel.getValue().rangeWithCoord}enableHelperSelection(){this._isHelperSelection=!0}disableHelperSelection(){this._isHelperSelection=!1}_updateHeaderBackground(e){const{startX:t,startY:i,endX:r,endY:s,rangeType:l}=this._selectionRenderModel,c=this._currentStyle,d=this._getScale(),{stroke:u,rowHeaderFill:h=c.rowHeaderFill,rowHeaderStroke:g=c.rowHeaderStroke,columnHeaderFill:S=c.columnHeaderFill,columnHeaderStroke:f=c.columnHeaderStroke}=e;let{rowHeaderStrokeWidth:v=c.rowHeaderStrokeWidth,columnHeaderStrokeWidth:p=c.columnHeaderStrokeWidth}=e;v/=d,p/=d;const C=this._rowHeaderWidth,_=this._columnHeaderHeight;if(this._highlightHeader&&_>0){let w=S;l===a.RANGE_TYPE.COLUMN&&(w=new a.ColorKit(u).setAlpha(Us).toString()),this._columnHeaderBackground.setProps({fill:w}),this._columnHeaderBackground.resize(r-t,_),this._columnHeaderBorder.setProps({fill:f}),this._columnHeaderBorder.transformByState({width:r-t,height:p,top:_-p+1/d}),this._columnHeaderGroup.show(),this._columnHeaderGroup.translate(t,0)}else this._columnHeaderGroup.hide();if(this._columnHeaderGroup.makeDirty(!0),this._highlightHeader&&C>0){let w=h;l===a.RANGE_TYPE.ROW&&(w=new a.ColorKit(u).setAlpha(Us).toString()),this._rowHeaderBackground.setProps({fill:w}),this._rowHeaderBackground.resize(C,s-i),this._rowHeaderBorder.setProps({fill:g}),this._rowHeaderBorder.transformByState({width:v,height:s-i,left:C-v+1/d}),this._rowHeaderGroup.show(),this._rowHeaderGroup.translate(0,i)}else this._rowHeaderGroup.hide();this._rowHeaderGroup.makeDirty(!0)}_updateBackgroundControl(e){const{startX:t,startY:i,endX:r,endY:s}=this._selectionRenderModel,l=this._getScale(),{fill:c=e.fill}=e;let{strokeWidth:d}=e;d/=l;const u=this._selectionRenderModel.highlightToSelection();if(!u){this._backgroundControlTop.resize(r-t,s-i),this._backgroundControlTop.setProps({fill:c}),this._backgroundControlBottom.resize(0,0),this._backgroundControlMiddleLeft.resize(0,0),this._backgroundControlMiddleRight.resize(0,0);return}const{startX:h,startY:g,endX:S,endY:f}=u,v=d/2,p={left:-v,top:-v,width:r-t+v*2,height:g-i+v};p.height<0&&(p.width=0,p.height=0),this._backgroundControlTop.transformByState(p);const C={left:-v,top:g-i,width:h-t+v,height:f-g};C.width<0&&(C.width=0,C.height=0),this._backgroundControlMiddleLeft.transformByState(C);const _={left:S-t-v,top:g-i,width:r-S+v*2,height:f-g};_.width<0&&(_.width=0,_.height=0),this._backgroundControlMiddleRight.transformByState(_);const w={left:-v,top:f-i,width:r-t+v*2,height:s-f+v};w.height<0&&(w.width=0,w.height=0),this._backgroundControlBottom.transformByState(w),this._backgroundControlTop.setProps({fill:c}),this._backgroundControlMiddleLeft.setProps({fill:c}),this._backgroundControlMiddleRight.setProps({fill:c}),this._backgroundControlBottom.setProps({fill:c})}_updateWidgets(e){const{startX:t,startY:i,endX:r,endY:s}=this._selectionRenderModel,{stroke:l=e.stroke,widgets:c=e.widgets,widgetStroke:d=e.widgetStroke}=e,u=this._getScale();let{widgetSize:h,widgetStrokeWidth:g}=e;h/=u,g/=u;const S={left:-h/2+g/2,center:(r-t)/2-h/2+g/2,right:r-t-h/2+g/2,top:-h/2,middle:(s-i)/2-h/2,bottom:s-i-h/2+g/2},f=h-g;this._widgetRects.forEach(v=>{v.setProps({fill:l,stroke:d})}),c.tl===!0?(this._topLeftWidget.transformByState({height:f,width:f,left:S.left,top:S.top,strokeWidth:g}),this._topLeftWidget.show()):this._topLeftWidget.hide(),c.tc===!0?(this._topCenterWidget.transformByState({height:f,width:f,left:S.center,top:S.top,strokeWidth:g}),this._topCenterWidget.show()):this._topCenterWidget.hide(),c.tr===!0?(this._topRightWidget.transformByState({height:f,width:f,left:S.right,top:S.top,strokeWidth:g}),this._topRightWidget.show()):this._topRightWidget.hide(),c.ml===!0?(this._middleLeftWidget.transformByState({height:f,width:f,left:S.left,top:S.middle,strokeWidth:g}),this._middleLeftWidget.show()):this._middleLeftWidget.hide(),c.mr===!0?(this._middleRightWidget.transformByState({height:f,width:f,left:S.right,top:S.middle,strokeWidth:g}),this._middleRightWidget.show()):this._middleRightWidget.hide(),c.bl===!0?(this._bottomLeftWidget.transformByState({height:f,width:f,left:S.left,top:S.bottom,strokeWidth:g}),this._bottomLeftWidget.show()):this._bottomLeftWidget.hide(),c.bc===!0?(this._bottomCenterWidget.transformByState({height:f,width:f,left:S.center,top:S.bottom,strokeWidth:g}),this._bottomCenterWidget.show()):this._bottomCenterWidget.hide(),c.br===!0?(this._bottomRightWidget.transformByState({height:f,width:f,left:S.right,top:S.bottom,strokeWidth:g}),this._bottomRightWidget.show()):this._bottomRightWidget.hide()}_hasWidgets(e){if(e==null)return!1;const t=Object.keys(e);if(t.length===0)return!1;for(const i of t)if(e[i]===!0)return!0;return!1}_getScale(){const{scaleX:e,scaleY:t}=this._scene.getAncestorScale();return Math.max(e,t)}_stopAntLineAnimation(){this._antLineOffset=0,M.cancelRequestFrame(this._antRequestNewFrame)}_startAntLineAnimation(){const e=this._getScale();this._antLineOffset+=.6/e,this._antLineOffset>160/e&&(this._antLineOffset=0),this.dashedRect.setProps({strokeDashOffset:-this._antLineOffset}),this._antRequestNewFrame=M.requestNewFrame(()=>{this._startAntLineAnimation()})}}class pd extends M.Layer{render(o,e=!1){const t=a.Tools.now();return super.render(o,e),this._afterRender(t),this}_afterRender(o){this.scene.getEngine().renderFrameTimeMetric$.next(["selectionLayer",a.Tools.now()-o])}}const Ie=a.createIdentifier("univer.sheet.selection-render-service");class Qo extends a.Disposable{constructor(e,t,i,r,s){super();R(this,"_downObserver");R(this,"_scenePointerMoveSub");R(this,"_scenePointerUpSub");R(this,"_controlFillConfig$",new N.BehaviorSubject(null));R(this,"controlFillConfig$",this._controlFillConfig$.asObservable());R(this,"_selectionControls",[]);R(this,"_startRangeWhenPointerDown",{startY:0,endY:0,startX:0,endX:0,startRow:-1,endRow:-1,startColumn:-1,endColumn:-1});R(this,"_activeControlIndex",-1);R(this,"_startViewportPosX",0);R(this,"_startViewportPosY",0);R(this,"_scrollTimer");R(this,"_cancelDownSubscription");R(this,"_cancelUpSubscription");R(this,"_skeleton");R(this,"_scene");R(this,"_highlightHeader",!0);R(this,"_rangeType",a.RANGE_TYPE.NORMAL);R(this,"_selectionStyle");R(this,"_remainLastEnabled",!1);R(this,"_skipLastEnabled",!1);R(this,"_singleSelectionEnabled",!1);R(this,"_selectionMoveEnd$",new N.BehaviorSubject([]));R(this,"selectionMoveEnd$",this._selectionMoveEnd$.asObservable());R(this,"_selectionMoving$",new N.Subject);R(this,"selectionMoving$",this._selectionMoving$.asObservable());R(this,"_selectionMoveStart$",new N.Subject);R(this,"selectionMoveStart$",this._selectionMoveStart$.asObservable());R(this,"_selectionMoving",!1);R(this,"_selectionTheme");R(this,"_activeViewport");R(this,"interceptor",new a.InterceptorManager({RANGE_MOVE_PERMISSION_CHECK:Zo,RANGE_FILL_PERMISSION_CHECK:Go}));R(this,"_escapeShortcutDisposable",null);this._injector=e,this._themeService=t,this._shortcutService=i,this._sheetSkeletonManagerService=r,this.contextService=s,this._initSelectionThemeFromThemeService(),this._initMoving()}get selectionMoving(){return this._selectionMoving}get _shouldDetectMergedCells(){return this._rangeType===a.RANGE_TYPE.NORMAL}_initMoving(){this.disposeWithMe(this._selectionMoving$.subscribe(()=>{this._selectionMoving=!0})),this.disposeWithMe(this._selectionMoveEnd$.subscribe(()=>{this._selectionMoving=!1}))}_setSelectionStyle(e){this._selectionStyle=e}getViewPort(){return this._activeViewport}setSingleSelectionEnabled(e=!1){this._singleSelectionEnabled=e}newSelectionControl(e,t,i){const r=this.getSelectionControls().length,{rowHeaderWidth:s,columnHeaderHeight:l}=t,c=new Kn(e,r,this._selectionTheme,{highlightHeader:this._highlightHeader,rowHeaderWidth:s,columnHeaderHeight:l});this._selectionControls.push(c);const d=Re(i,t);return c.updateRangeBySelectionWithCoord(d,t),c.setControlExtension({skeleton:t,scene:e,themeService:this._selectionTheme,injector:this._injector,selectionHooks:{selectionMoveEnd:()=>{this._selectionMoveEnd$.next(this.getSelectionDataWithStyle())}}}),c}resetSelectionsByModelData(e){const t=this.getSelectionControls(),i=this._skeleton;if(!(!t||!i)){for(let r=0,s=e.length;r<s;r++){const l=e[r],c=Re(l,this._skeleton),d=t[r];d?d.updateRangeBySelectionWithCoord(c,i):this.isSelectionEnabled()&&this.newSelectionControl(this._scene,i,l)}e.length<t.length&&t.splice(e.length).forEach(s=>s.dispose())}}refreshSelectionMoveStart(){this._selectionMoveStart$.next(this.getSelectionDataWithStyle())}refreshSelectionMoveEnd(){this._selectionMoveEnd$.next(this.getSelectionDataWithStyle())}_initSelectionThemeFromThemeService(){const e=this._themeService.getCurrentTheme();this._selectionTheme=new a.ThemeService,this._selectionTheme.setTheme(e)}setSelectionTheme(e){this._selectionTheme.setTheme(e)}_changeRuntime(e,t,i){this._skeleton=e,this._scene=t,this._activeViewport=i||(t==null?void 0:t.getViewports()[0]),t.findLayerByZIndex(Bi)||t.addLayer(new pd(t,[],Bi))}getSkeleton(){return this._skeleton}getSelectionDataWithStyle(){const e=this._selectionControls;if(this._skeleton.worksheet){const[t,i]=this._skeleton.getLocation();return e.map(r=>{const s=r.getValue();return s.rangeWithCoord.sheetId=i,s.rangeWithCoord.unitId=t,s})}return[]}getSelectionControls(){return this._selectionControls}_addSelectionControlByModelData(e){var l;const t=this._skeleton,i=(l=e.style)!=null?l:qe(this._selectionTheme),r=this._scene;return e.style=i,this.newSelectionControl(r,t,e)}_clearAllSelectionControls(){const e=this._selectionControls;for(const t of e)t.dispose();this._selectionControls.length=0}_getFreeze(){var t;return(t=this._sheetSkeletonManagerService.getCurrentParam())==null?void 0:t.skeleton.getWorksheetConfig().freeze}_getViewportByCell(e,t){if(e===void 0||t===void 0)return null;const i=this._getFreeze();if(!i||i.startRow<=0&&i.startColumn<=0)return this._scene.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN);if(e>i.startRow&&t>i.startColumn)return this._scene.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN);if(e<=i.startRow&&t<=i.startColumn)return this._scene.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP);if(e<=i.startRow&&t>i.startColumn)return this._scene.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP);if(e>i.startRow&&t<=i.startColumn)return this._scene.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT)}getActiveRange(){const e=this.getSelectionControls(),t=e&&e[e.length-1].model;return t&&{startRow:t.startRow,startColumn:t.startColumn,endRow:t.endRow,endColumn:t.endColumn}}setActiveSelectionIndex(e){this._activeControlIndex=e}resetActiveSelectionIndex(){this._activeControlIndex=-1}getActiveSelectionControl(){const e=this.getSelectionControls();if(e)return this._activeControlIndex<0?e[e.length-1]:e[this._activeControlIndex]}endSelection(){var e;this._clearUpdatingListeners(),this._selectionMoveEnd$.next(this.getSelectionDataWithStyle()),(e=this._escapeShortcutDisposable)==null||e.dispose(),this._escapeShortcutDisposable=null}_reset(){var e;this._clearAllSelectionControls(),(e=this._downObserver)==null||e.unsubscribe(),this._downObserver=null}_setupPointerMoveListener(e,t,i,r=M.ScrollTimerType.ALL,s,l){var f,v;let c=0,d=0,u=s,h=l;this._scrollTimer=M.ScrollTimer.create(this._scene,r),this._scrollTimer.startScroll((f=e==null?void 0:e.left)!=null?f:0,(v=e==null?void 0:e.top)!=null?v:0,e);const g=this._scene,S=g.getActiveViewportByCoord(M.Vector2.FromArray([s,l]));this._scenePointerMoveSub=g.onPointerMove$.subscribeEvent(p=>{var V,L,W,B,U,z,F,j,Y;const{offsetX:C,offsetY:_}=p,{x:w,y:E}=g.getCoordRelativeToViewport(M.Vector2.FromArray([C,_]));this._movingHandler(w,E,t,i);let O=w,T=E;const P=this.getActiveSelectionControl(),A=this._getFreeze(),D=P==null?void 0:P.model,k=(V=g.getActiveViewportByCoord(M.Vector2.FromArray([C,_])))!=null?V:this._getViewportByCell(D==null?void 0:D.endRow,D==null?void 0:D.endColumn);if((()=>{if(!S||!k||!e)return!1;const Q=[M.SHEET_VIEWPORT_KEY.VIEW_MAIN,M.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP,M.SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP,M.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT];return Q.includes(S.viewportKey)&&Q.includes(k.viewportKey)})()){if(!S||!k||!e)return!1;const Q=u<e.left&&w>e.left||u>e.left&&w<e.left,oe=h<e.top&&E>e.top||h>e.top&&E<e.top;Q&&(c+=1),oe&&(d+=1);const re=S.viewportKey,ce=k.viewportKey;if(re===M.SHEET_VIEWPORT_KEY.VIEW_ROW_TOP)_<e.top&&((L=D==null?void 0:D.endRow)!=null?L:0)<((W=A==null?void 0:A.startRow)!=null?W:0)?T=e.top:oe&&d%2===1&&e.scrollToViewportPos({viewportScrollY:0});else if(re===M.SHEET_VIEWPORT_KEY.VIEW_COLUMN_LEFT)C<e.left&&((B=D==null?void 0:D.endColumn)!=null?B:0)<((U=A==null?void 0:A.startColumn)!=null?U:0)?O=e.left:Q&&c%2===1&&e.scrollToViewportPos({viewportScrollX:0});else if(re===ce){let G=!1,Z=!1;re===M.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP?(G=!0,Z=!0):re===M.SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP?Z=!0:re===M.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT&&(G=!0),((z=D==null?void 0:D.endRow)!=null?z:0)>((F=A==null?void 0:A.startRow)!=null?F:0)&&(Z=!1),((j=D==null?void 0:D.endColumn)!=null?j:0)>((Y=A==null?void 0:A.startColumn)!=null?Y:0)&&(G=!1),G&&(O=e.left),Z&&(T=e.top)}else{const G={x:S.scrollX,y:S.scrollY},Z={x:k.scrollX,y:k.scrollY},J=G.x!==Z.x&&Q&&c%2===1,ne=G.y!==Z.y&&oe&&d%2===1;(J||ne)&&(e.scrollToBarPos({x:J?G.x:void 0,y:ne?G.y:void 0}),J||(O=e.left),ne||(T=e.top)),(re===M.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP&&ce===M.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT||ce===M.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP&&re===M.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT)&&(O=e.left),(re===M.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP&&ce===M.SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP||ce===M.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP&&re===M.SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP)&&(T=e.top)}u=w,h=E}this._scrollTimer.scrolling(O,T,()=>{this._movingHandler(w,E,t,i)})})}attachSelectionWithCoord(e){return Re(e,this._skeleton)}attachPrimaryWithCoord(e){return Gn(this._skeleton,e)}getSelectionCellByPosition(e,t){return this.getCellWithCoordByOffset(e,t)}getCellWithCoordByOffset(e,t,i){const r=this._scene,s=i!=null?i:this._skeleton,l=r.getViewportScrollXY(r.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN)),{scaleX:c,scaleY:d}=r.getAncestorScale();return s.getCellWithCoordByOffset(e,t,c,d,l)}_movingHandler(e,t,i,r){var O,T,P,A,D;const s=this._skeleton,l=this._scene,[c,d]=s.getLocation(),u={startRow:(O=i==null?void 0:i.model.startRow)!=null?O:-1,endRow:(T=i==null?void 0:i.model.endRow)!=null?T:-1,startColumn:(P=i==null?void 0:i.model.startColumn)!=null?P:-1,endColumn:(A=i==null?void 0:i.model.endColumn)!=null?A:-1},h=l.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN),g=(D=this._getViewportByCell(u.endRow,u.endColumn))!=null?D:h,S=l.getScrollXYInfoByViewport(M.Vector2.FromArray([this._startViewportPosX,this._startViewportPosY]),g),{scaleX:f,scaleY:v}=l.getAncestorScale();r===a.RANGE_TYPE.ROW?e=Number.POSITIVE_INFINITY:r===a.RANGE_TYPE.COLUMN&&(t=Number.POSITIVE_INFINITY);const p=this._skeleton.getCellByOffset(e,t,f,v,S);if(!p)return;let C={startRow:Math.min(p.startRow,this._startRangeWhenPointerDown.startRow),startColumn:Math.min(p.startColumn,this._startRangeWhenPointerDown.startColumn),endRow:Math.max(p.endRow,this._startRangeWhenPointerDown.endRow),endColumn:Math.max(p.endColumn,this._startRangeWhenPointerDown.endColumn)};this._shouldDetectMergedCells&&(C=s.expandRangeByMerge(C,this.inRefSelectionMode()));const w=Re({range:C,primary:void 0,style:null},s);w.rangeWithCoord.unitId=c,w.rangeWithCoord.sheetId=d,w.rangeWithCoord.rangeType=r;const E=u.startRow!==C.startRow||u.startColumn!==C.startColumn||u.endRow!==C.endRow||u.endColumn!==C.endColumn;i!=null&&E&&(i.updateRangeBySelectionWithCoord(w),this._selectionMoving$.next(this.getSelectionDataWithStyle()))}_clearUpdatingListeners(){var t,i,r,s,l;this._scene.enableObjectsEvent(),(t=this._scenePointerMoveSub)==null||t.unsubscribe(),this._scenePointerMoveSub=null,(i=this._scenePointerUpSub)==null||i.unsubscribe(),this._scenePointerUpSub=null,(r=this._cancelDownSubscription)==null||r.unsubscribe(),this._cancelDownSubscription=null,(s=this._cancelUpSubscription)==null||s.unsubscribe(),this._cancelUpSubscription=null,(l=this._scrollTimer)==null||l.dispose()}_addEndingListeners(){var i,r,s;const e=this._scene,t=(i=e.getEngine())==null?void 0:i.activeScene;!t||t===e||((r=this._cancelDownSubscription)==null||r.unsubscribe(),this._cancelDownSubscription=null,(s=this._cancelUpSubscription)==null||s.unsubscribe(),this._cancelUpSubscription=null,this._cancelDownSubscription=t.onPointerDown$.subscribeEvent(()=>this._clearUpdatingListeners()),this._cancelUpSubscription=t.onPointerUp$.subscribeEvent(()=>this._clearUpdatingListeners()))}_getSelectionWithCoordByOffset(e,t,i,r,s){const l=this._skeleton;if(l==null)return null;if(this._shouldDetectMergedCells){const C=l==null?void 0:l.getCellWithCoordByOffset(e,t,i,r,s,{firstMatch:!0});if(!C)return;const _=a.convertCellToRange(C);return{primaryWithCoord:C,rangeWithCoord:_}}const{row:c,column:d}=l.getCellIndexByOffset(e,t,i,r,s),u=l.getNoMergeCellWithCoordByIndex(c,d),{startX:h,startY:g,endX:S,endY:f}=u,v={startY:g,endY:f,startX:h,endX:S,startRow:c,endRow:c,startColumn:d,endColumn:d};return{primaryWithCoord:{mergeInfo:v,actualRow:c,actualColumn:d,isMerged:!1,isMergedMainCell:!1,startY:g,endY:f,startX:h,endX:S},rangeWithCoord:v}}_checkClearPreviousControls(e){this.getSelectionControls().length!==0&&(!e.ctrlKey&&!e.shiftKey&&!this._remainLastEnabled||this._singleSelectionEnabled&&!e.shiftKey)&&this._clearAllSelectionControls()}_makeSelectionByTwoCells(e,t,i,r,s){const{actualRow:l,actualColumn:c,mergeInfo:d}=e;this._startRangeWhenPointerDown={...e.mergeInfo};const u=Math.min(l,t.startRow,d.startRow),h=Math.max(l,t.endRow,d.endRow),g=Math.min(c,t.startColumn,d.startColumn),S=Math.max(c,t.endColumn,d.endColumn),v={range:i.expandRangeByMerge({startRow:u,startColumn:g,endRow:h,endColumn:S}),primary:m.convertPrimaryWithCoordToPrimary(e),style:null},p=Re(v,i);s.updateRangeBySelectionWithCoord(p)}isSelectionEnabled(){return this.contextService.getContextValue(m.SELECTIONS_ENABLED)}isSelectionDisabled(){return this.contextService.getContextValue(m.SELECTIONS_ENABLED)===!1}inRefSelectionMode(){return this.contextService.getContextValue(m.REF_SELECTIONS_ENABLED)}}function Jo(n){return{range:{startRow:0,startColumn:0,endRow:n.getRowCount()-1,endColumn:n.getColumnCount()-1,rangeType:a.RANGE_TYPE.ALL},primary:Fi(n).primary,style:null}}function Fi(n){return Bs(n,{startRow:0,startColumn:0,endRow:0,endColumn:0})}function Bs(n,o){const e=n.worksheet.getCellInfoInMergeData(o.startRow,o.startColumn),t=n.worksheet.getCellInfoInMergeData(o.endRow,o.endColumn);return{range:{startRow:e.startRow,startColumn:e.startColumn,endRow:t.endRow,endColumn:t.endColumn,rangeType:a.RANGE_TYPE.NORMAL},primary:{actualRow:e.startRow,actualColumn:e.startColumn,startRow:e.startRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn,isMerged:e.isMerged,isMergedMainCell:e.isMergedMainCell},style:null}}var Cd=Object.getOwnPropertyDescriptor,Id=(n,o,e,t)=>{for(var i=t>1?void 0:t?Cd(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Fs=(n,o)=>(e,t)=>o(e,t,n);y.SheetSkeletonManagerService=class extends a.Disposable{constructor(e,t,i){super();R(this,"_sheetId","");R(this,"_sheetSkeletonParamStore",new Map);R(this,"_currentSkeleton$",new N.BehaviorSubject(null));R(this,"currentSkeleton$",this._currentSkeleton$.asObservable());R(this,"_currentSkeletonBefore$",new N.BehaviorSubject(null));R(this,"currentSkeletonBefore$",this._currentSkeletonBefore$.asObservable());this._context=e,this._injector=t,this._sheetSkService=i,this.disposeWithMe(()=>{this._currentSkeletonBefore$.complete(),this._currentSkeleton$.complete(),this._sheetSkeletonParamStore.forEach(r=>this.disposeSkeleton(r.sheetId)),this._sheetSkeletonParamStore.clear()}),this._initRemoveSheet()}_initRemoveSheet(){this.disposeWithMe(this._context.unit.sheetDisposed$.subscribe(e=>{this.disposeSkeleton(e.getSheetId())}))}getCurrentSkeleton(){var e;return(e=this.getCurrentParam())==null?void 0:e.skeleton}getCurrent(){return this.getCurrentParam()}getCurrentParam(){return this._getSkeletonParam(this._sheetId)}getSkeleton(e){return this._getSkeleton(e)}getSkeletonParam(e){return this._getSkeletonParam(e)}getWorksheetSkeleton(e){return this.getSkeletonParam(e)}getUnitSkeleton(e,t){const i=this._getSkeletonParam(t);return i!=null&&(i.unitId=e),i}setCurrent(e){this._setCurrent(e.sheetId)}setSkeletonParam(e,t){this._sheetSkService.setSkeleton(t.unitId,e,t.skeleton),this._sheetSkeletonParamStore.set(e,t)}_setCurrent(e){this._sheetId=e;const t=this._getSkeletonParam(e),i=this._context.unitId;if(t!=null)this.reCalculate(t);else{const l=this._context.unit.getSheetBySheetId(e);if(l==null)return;const c=this._context.scene,d=this._buildSkeleton(l,c);this.setSkeletonParam(e,{unitId:i,sheetId:e,skeleton:d,dirty:!1})}const r=this._getSkeletonParam(e);this._currentSkeletonBefore$.next(r),this._currentSkeleton$.next(r)}reCalculate(e){e||(e=this.getCurrentParam()),e!=null&&(e.dirty&&(e.skeleton.makeDirty(!0),e.dirty=!1),e.skeleton.calculate())}makeDirty(e,t=!0){const i=this._getSkeletonParam(e.sheetId);i!=null&&(i.dirty=t)}getOrCreateSkeleton(e){return this.ensureSkeleton(e.sheetId)}ensureSkeleton(e){const t=this._getSkeletonParam(e);if(t)return t.skeleton;const r=this._context.unit.getSheetBySheetId(e);if(!r)return;const s=this._buildSkeleton(r);return this.setSkeletonParam(e,{unitId:this._context.unitId,sheetId:e,skeleton:s,dirty:!1}),s}disposeSkeleton(e){const t=this.getSkeletonParam(e);t&&(t.skeleton.dispose(),this._sheetSkeletonParamStore.delete(e),this._sheetSkService.deleteSkeleton(t.unitId,e))}attachRangeWithCoord(e){const t=this.getCurrentSkeleton();return t?Jt(t,e):null}_getSkeletonParam(e){return this._sheetSkeletonParamStore.get(e)}_getSkeleton(e){const t=this._getSkeletonParam(e);return t?t.skeleton:null}_buildSkeleton(e,t){return this._injector.createInstance(M.SpreadsheetSkeleton,e,this._context.unit.getStyles())}setColumnHeaderSize(e,t,i){var u;if(!e)return;const r=(u=this.getWorksheetSkeleton(t))==null?void 0:u.skeleton;if(!r)return;r.columnHeaderHeight=i,e.scene.getViewports()[0].top=i,e.scene.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_COLUMN_RIGHT).setViewportSize({height:i}),e.scene.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_COLUMN_LEFT).setViewportSize({height:i}),e.scene.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_ROW_BOTTOM).setViewportSize({top:i}),e.scene.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_ROW_TOP).setViewportSize({top:i}),e.scene.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_LEFT_TOP).setViewportSize({height:i});const s=e==null?void 0:e.with(m.SheetsSelectionsService),l=e==null?void 0:e.with(Ie),c=s.getCurrentSelections();l.resetSelectionsByModelData(c);const d=this.getUnitSkeleton(e.unitId,t);d&&(d.commandId=Zn.id,this._currentSkeleton$.next(d))}setRowHeaderSize(e,t,i){var f;const r=(f=this.getWorksheetSkeleton(t))==null?void 0:f.skeleton;if(!e||!r)return;r.rowHeaderWidth=i;const s=e.scene.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_LEFT_TOP).width||46,l=i-s,c=e.scene.getViewports()[0].left;e.scene.getViewports()[0].left=c+l,e.scene.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_ROW_BOTTOM).setViewportSize({width:i}),e.scene.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_ROW_TOP).setViewportSize({width:i}),e.scene.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_COLUMN_LEFT).setViewportSize({left:i});const d=e.scene.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_COLUMN_RIGHT).left||0;e.scene.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_COLUMN_RIGHT).setViewportSize({left:d+l}),e.scene.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_LEFT_TOP).setViewportSize({width:i});const u=e==null?void 0:e.with(m.SheetsSelectionsService),h=e==null?void 0:e.with(Ie),g=u.getCurrentSelections();h.resetSelectionsByModelData(g);const S=this.getCurrent();S&&(S.commandId=jn.id,this._currentSkeleton$.next(S))}},y.SheetSkeletonManagerService=Id([Fs(1,a.Inject(a.Injector)),Fs(2,a.Inject(m.SheetSkeletonService))],y.SheetSkeletonManagerService);var _d=Object.getOwnPropertyDescriptor,bd=(n,o,e,t)=>{for(var i=t>1?void 0:t?_d(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},qn=(n,o)=>(e,t)=>o(e,t,n);const zs=["ff","fs","tr","tb"];y.AutoHeightController=class extends a.Disposable{constructor(o,e,t,i,r){super(),this._renderManagerService=o,this._sheetInterceptorService=e,this._selectionManagerService=t,this._univerInstanceService=i,this._configService=r,this._initialize()}_processLazyAutoHeight(o,e,t,i){if(i!=null&&i.length){const r={id:m.MarkDirtyRowAutoHeightMutation.id,params:{unitId:e,subUnitId:t,ranges:i,id:a.generateRandomId()},options:{onlyLocal:!0}},s={id:m.CancelMarkDirtyRowAutoHeightMutation.id,params:{unitId:e,subUnitId:t,id:r.params.id},options:{onlyLocal:!0}};return{redos:[...o.redos,r],undos:[...o.undos,s]}}return o}getUndoRedoParamsOfAutoHeight(o,e,t){const{_univerInstanceService:i}=this,r=i.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),s=r.getUnitId();let l=r.getActiveSheet(),c=l.getSheetId();if(e){const v=m.getSheetCommandTarget(i,{unitId:s,subUnitId:e});v&&(l=v.worksheet,c=l.getSheetId())}const u=this._renderManagerService.getRenderById(s).with(y.SheetSkeletonManagerService).ensureSkeleton(c);if(!u)return{redos:[],undos:[]};const g=u.calculateAutoHeightInRange(o,t).filter(v=>{const{row:p,autoHeight:C}=v;return!(!C||l.getRowHeight(p)===C)});if(g.length===0)return{redos:[],undos:[]};const S={subUnitId:c,unitId:s,rowsAutoHeightInfo:g},f=m.SetWorksheetRowAutoHeightMutationFactory(S,l);return{undos:[{id:m.SetWorksheetRowAutoHeightMutation.id,params:f}],redos:[{id:m.SetWorksheetRowAutoHeightMutation.id,params:S}]}}_initialize(){this.disposeWithMe(this._sheetInterceptorService.interceptAutoHeight({getMutations:o=>{const{unitId:e,subUnitId:t,ranges:i,autoHeightRanges:r,lazyAutoHeightRanges:s,cellHeights:l}=o,c=this.getUndoRedoParamsOfAutoHeight(r!=null?r:i,t,l);return this._processLazyAutoHeight(c,e,t,s)}}))}},y.AutoHeightController=bd([qn(0,M.IRenderManagerService),qn(1,a.Inject(m.SheetInterceptorService)),qn(2,a.Inject(m.SheetsSelectionsService)),qn(3,a.Inject(a.IUniverInstanceService)),qn(4,a.IConfigService)],y.AutoHeightController);function at(n){const{rows:o,cols:e}=n;return{startRow:o[0],endRow:o[o.length-1],startColumn:e[0],endColumn:e[e.length-1]}}function lt(n){let o=[],e=[];const t=[];return n.forEach(i=>{o=o.concat(i.rows),e=e.concat(i.cols)}),o=Array.from(new Set(o)).sort((i,r)=>i-r),e=Array.from(new Set(e)).sort((i,r)=>i-r),n.forEach(i=>{t.push({startRow:o.findIndex(r=>r===i.rows[0]),endRow:o.findIndex(r=>r===i.rows[i.rows.length-1]),startColumn:e.findIndex(r=>r===i.cols[0]),endColumn:e.findIndex(r=>r===i.cols[i.cols.length-1])})}),{ranges:t,mapFunc:(i,r)=>({row:o[i],col:e[r]})}}function wd(n){const o=new a.ObjectMatrix;return n.forEach(e=>{const{rows:t,cols:i}=e;t.forEach(r=>{i.forEach(s=>{o.setValue(r,s,{v:null,p:null,f:null,si:null,custom:null})})})}),o.getData()}const $o={:0,:1,:2,:3,:4,:5,:6,:7,:8,:9},zi=["","","","","","","","","",""],Xs=["","","","",""],Ed=["","","",""],Ys={:{value:10,secUnit:!1},:{value:100,secUnit:!1},:{value:1e3,secUnit:!1},:{value:1e4,secUnit:!0},:{value:1e8,secUnit:!0}};function Qe(n){if(!n)return 0;let o=0,e=0,t=0,i=!1;const r=n.split("");for(let s=0;s<r.length;s++){const l=$o[r[s]];if(typeof l<"u")t=l,s===r.length-1&&(e+=t);else{const c=Ys[r[s]],d=c.value;i=c.secUnit,i?(e=(e+t)*d,o+=e,e=0):e+=t*d,t=0}}return o+e}function Td(n){let o="",e="",t=0,i=!0;for(;n>0;){const r=n%10;r===0?i||(i=!0,e=zi[r]+e):(i=!1,o=zi[r],o+=Ed[t],e=o+e),t++,n=Math.floor(n/10)}return e}function yd(n){let o=0,e="",t="",i=!1;if(n===0)return zi[0];for(;n>0;){const r=n%1e4;i&&(t=zi[0]+t),e=Td(r),e+=r!==0?Xs[o]:Xs[0],t=e+t,i=r<1e3&&r>0,n=Math.floor(n/1e4),o++}return t}function Rd(n){if(!n)return!1;let o=!0;if(n)if(n.length===1)n===""||n in $o?o=!0:o=!1;else{const e=n.split("");for(let t=0;t<e.length;t++)if(!(e[t]in $o||e[t]in Ys)){o=!1;break}}return o}function Xi(n){if(!n)return{isExtendNumber:!1};const o=/0|([1-9]+[0-9]*)/g,e=o.test(n);if(e){const t=n.match(o);if(t&&t.length>0){const i=t[t.length-1],r=n.lastIndexOf(i),s=n.substr(0,r),l=n.substr(r+i.length);return{isExtendNumber:!0,matchTxt:Number(i),beforeTxt:s,afterTxt:l}}return{isExtendNumber:!1}}return{isExtendNumber:e}}function Md(n){let o;return n.length===2&&(n===""||n===""||n===""||n===""||n===""||n===""||n==="")?o=!0:o=!1,o}function Pd(n){let o;return n.length===3&&(n===""||n===""||n===""||n===""||n===""||n===""||n==="")?o=!0:o=!1,o}function Od(n,o){let e=0;for(let t=0;t<n.length&&n[t]<o;t++)e++;return e}function Qn(n){let o=!0;const e=n[1]-n[0];for(let t=1;t<n.length;t++)if(n[t]-n[t-1]!==e){o=!1;break}return o}function Ad(n,o,e){const t=[],i=Math.floor(o/n),r=o%n;let s=0;if(i>0){for(let l=0;l<i;l++)for(let c=0;c<e.length;c++)t[e[c]+l*n]=s,s++;for(let l=0;l<e.length&&e[l]<r;l++)t[e[l]+n*i]=s,s++}else for(let l=0;l<e.length&&e[l]<r;l++)t[e[l]]=s,s++;return t}function Et(n,o){const e=[];for(let t=1;t<=o;t++){const i=(t-1)%n.length,r=a.Tools.deepClone(n[i]);Tt(r),e.push({v:null,s:null,p:null,f:null,si:null,t:null,...r})}return e}function Dd(n,o){var t;const e=[];for(let i=1;i<=o;i++){const r=(i-1)%n.length,s={s:(t=n[r])==null?void 0:t.s};e.push(s)}return e}function Nd(n){let o=!0;const e=n[1]/n[0];for(let t=1;t<n.length;t++)if(n[t]/n[t-1]!==e){o=!1;break}return o}function kd(n){const o=[];for(let e=1;e<=n;e++)o.push(e);return o}function Yi(n,o,e){var r,s,l,c;const t=[],i=[];for(let d=0;d<n.length;d++)i.push(Number((r=n[d])==null?void 0:r.v));if(n.length>2&&Nd(i))for(let d=1;d<=o;d++){const u=(d-1)%n.length,h=a.Tools.deepClone(n[u]);Tt(h);const g=Number((s=n[n.length-1])==null?void 0:s.v)*(Number((l=n[1])==null?void 0:l.v)/Number((c=n[0])==null?void 0:c.v))**d;h&&(Ks(h)&&(h.v=g),t.push(h))}else{const d=kd(n.length);for(let u=1;u<=o;u++){const h=(u-1)%n.length,g=a.Tools.deepClone(n[h]);Tt(g);const S=e===a.Direction.DOWN||e===a.Direction.RIGHT,f=Hd(n.length+u,i,d,S);g&&(Ks(g)&&(g.v=f),t.push(g))}}return t}function Hd(n,o,e,t=!0){function i(h){let g=0;for(let S=0;S<h.length;S++)g+=h[S];return g/h.length}const r=i(e),s=i(o);let l=0,c=0;for(let h=0;h<e.length;h++)l+=(e[h]-r)*(o[h]-s),c+=(e[h]-r)*(e[h]-r);let d;c===0?d=t?1:-1:d=l/c;const u=s-d*r;return Math.round((u+d*n)*1e5)/1e5}function js(n,o,e){var r;const t=[],i=/0|([1-9]+[0-9]*)/g;for(let s=1;s<=o;s++){const l=(s-1)%n.length,c=a.Tools.deepClone(n[l]);Tt(c);const d=`${(r=n[n.length-1])==null?void 0:r.v}`;if(!d)continue;const u=d==null?void 0:d.match(i),h=u==null?void 0:u[u.length-1];if(!h)continue;const g=Math.abs(Number(h)+e*s),S=d.lastIndexOf(h),f=d.substr(0,S)+g.toString()+d.substr(S+h.length);c&&(c.v=f,t.push(c))}return t}function $t(n,o,e,t=0){var l,c;const i=[["","","","","","",""],["","","","","","",""],["","","","","","",""]];if(t>=i.length)return[];const r=i[t],s=[];for(let d=1;d<=o;d++){const u=(d-1)%n.length,h=a.Tools.deepClone(n[u]);Tt(h);let g=0;if(((l=n[n.length-1])==null?void 0:l.v)===r[0])g=7+e*d;else{const f=`${(c=n[n.length-1])==null?void 0:c.v}`;if(f){const v=f.substr(f.length-1,1);g=Qe(v)+e*d}}g<0&&(g=Math.ceil(Math.abs(g)/7)*7+g);const S=g%7;h&&(h.v=r[S],s.push(h))}return s}function Zs(n,o,e){var i;const t=[];for(let r=1;r<=o;r++){const s=(r-1)%n.length,l=a.Tools.deepClone(n[s]);Tt(l);const c=`${(i=n[n.length-1])==null?void 0:i.v}`,d=Qe(c)+e*r;let u;d<=0?u="":u=yd(d),l&&(l.v=u,t.push(l))}return t}const Jn={enWeek1:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],enWeek2:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],enMonth1:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],enMonth2:["January","February","March","April","May","June","July","August","September","October","November","December"],chnMonth1:["","","","","","","","","","","",""],chnMonth2:["","","","","","","","","","","",""],chHour1:["","","","","","","","","","","",""],chHour2:["","","","","","","","","","","",""],chYear1:["","","","","","","","","",""],chSeason1:["","","",""],chSeason2:["","","",""]};function Vd(n){let o=!1;return Object.keys(Jn).forEach(e=>{Jn[e].includes(n)&&(o=!0)}),o}function er(n){let o="";const e=[];return Object.keys(Jn).forEach(t=>{Jn[t].includes(n)&&(o=t,e.push(...Jn[t]))}),{name:o,series:e}}function Gs(n,o,e,t){var s;const i=t.length,r=[];for(let l=1;l<=o;l++){const c=(l-1)%n.length,d=a.Tools.deepClone(n[c]);Tt(d);const u=`${(s=n[n.length-1])==null?void 0:s.v}`;let h=t.indexOf(u)+e*l;h<0&&(h+=Math.abs(e)*i);const g=h%i;d&&(d.v=t[g],r.push(d))}return r}function Wd(n,o){const e=[];let t;if(o.startRow<n.startRow)t=a.Direction.UP;else if(o.endRow>n.endRow)t=a.Direction.DOWN;else if(o.startColumn<n.startColumn)t=a.Direction.LEFT;else if(o.endColumn>n.endColumn)t=a.Direction.RIGHT;else return[];if(t===a.Direction.DOWN||t===a.Direction.UP){const i=n.endRow-n.startRow+1,r=o.endRow-o.startRow+1,s=Math.floor(r/i),l=r%i,c={startRow:0,startColumn:0,endRow:n.endRow-n.startRow,endColumn:n.endColumn-n.startColumn};if(t===a.Direction.DOWN){for(let d=0;d<s;d++)e.push({repeatStartCell:{row:n.startRow+(d+1)*i,col:n.startColumn},relativeRange:c});l>0&&e.push({repeatStartCell:{row:n.startRow+(s+1)*i,col:n.startColumn},relativeRange:{startRow:0,startColumn:0,endRow:l-1,endColumn:n.endColumn-n.startColumn}})}else{for(let d=0;d<s;d++)e.push({repeatStartCell:{row:n.startRow-(d+1)*i,col:n.startColumn},relativeRange:c});l>0&&e.push({repeatStartCell:{row:n.startRow-(s+1)*i,col:n.startColumn},relativeRange:{startRow:i-l,endRow:i-1,startColumn:0,endColumn:n.endColumn-n.startColumn}})}}if(t===a.Direction.RIGHT||t===a.Direction.LEFT){const i=n.endColumn-n.startColumn+1,r=o.endColumn-o.startColumn+1,s=Math.floor(r/i),l=r%i,c={startRow:0,startColumn:0,endRow:n.endRow-n.startRow,endColumn:n.endColumn-n.startColumn};if(t===a.Direction.RIGHT){for(let d=0;d<s;d++)e.push({repeatStartCell:{row:n.startRow,col:n.startColumn+(d+1)*i},relativeRange:c});l>0&&e.push({repeatStartCell:{row:n.startRow,col:n.startColumn+(s+1)*i},relativeRange:{startRow:0,startColumn:0,endRow:n.endRow-n.startRow,endColumn:l-1}})}else{for(let d=0;d<s;d++)e.push({repeatStartCell:{row:n.startRow,col:n.startColumn-(d+1)*i},relativeRange:c});l>0&&e.push({repeatStartCell:{row:n.startRow,col:n.startColumn-(s+1)*i},relativeRange:{startRow:0,startColumn:i-l,endRow:n.endRow-n.startRow,endColumn:i-1}})}}return e}function Ks(n){return!(a.isFormulaString(n.f)||a.isFormulaId(n.si)||n.t===a.CellValueType.BOOLEAN)}function Tt(n){n&&"custom"in n&&delete n.custom}var en=(n=>(n.Append="APPEND",n.Default="DEFAULT",n.Only="ONLY",n))(en||{}),_e=(n=>(n.NUMBER="number",n.DATE="date",n.EXTEND_NUMBER="extendNumber",n.CHN_NUMBER="chnNumber",n.CHN_WEEK2="chnWeek2",n.CHN_WEEK3="chnWeek3",n.LOOP_SERIES="loopSeries",n.FORMULA="formula",n.OTHER="other",n))(_e||{}),le=(n=>(n.COPY="COPY",n.SERIES="SERIES",n.ONLY_FORMAT="ONLY_FORMAT",n.NO_FORMAT="NO_FORMAT",n))(le||{});const Ld={type:_e.DATE,priority:1100,match:(n,o)=>{var e;if(n!=null&&n.f||n!=null&&n.si)return!1;if((typeof(n==null?void 0:n.v)=="number"||(n==null?void 0:n.t)===a.CellValueType.NUMBER)&&n.s){if(typeof n.s=="string"){const i=o.get(a.IUniverInstanceService).getFocusedUnit().getStyles().get(n.s),r=(e=i==null?void 0:i.n)==null?void 0:e.pattern;if(r)return a.numfmt.getFormatInfo(r).isDate}else if(n.s.n&&a.numfmt.getFormatInfo(n.s.n.pattern).isDate)return!0}return!1},isContinue:(n,o)=>n.type===_e.DATE,applyFunctions:{[le.SERIES]:(n,o,e)=>{const{data:t}=n;return e===a.Direction.LEFT||e===a.Direction.UP?(t.reverse(),Yi(t,o,e).reverse()):Yi(t,o,e)}}},xd={type:_e.NUMBER,priority:1e3,match:n=>typeof(n==null?void 0:n.v)=="number"||(n==null?void 0:n.t)===a.CellValueType.NUMBER,isContinue:(n,o)=>n.type===_e.NUMBER,applyFunctions:{[le.SERIES]:(n,o,e)=>{const{data:t}=n;return e===a.Direction.LEFT||e===a.Direction.UP?(t.reverse(),Yi(t,o,e).reverse()):Yi(t,o,e)}}},qs={type:_e.OTHER,priority:0,match:()=>!0,isContinue:(n,o)=>n.type===_e.OTHER},Ud={type:_e.EXTEND_NUMBER,priority:900,match:n=>Xi(`${n==null?void 0:n.v}`||"").isExtendNumber,isContinue:(n,o)=>{var e;if(n.type===_e.EXTEND_NUMBER){const{beforeTxt:t,afterTxt:i}=Xi(`${(e=n.cellData)==null?void 0:e.v}`||""),{beforeTxt:r,afterTxt:s}=Xi(`${o==null?void 0:o.v}`||"");if(t===r&&i===s)return!0}return!1},applyFunctions:{[le.SERIES]:(n,o,e)=>{var l;const{data:t}=n,i=e===a.Direction.UP||e===a.Direction.LEFT;let r;if(t.length===1)return r=i?-1:1,Ne(js(t,o,r),i);const s=[];for(let c=0;c<t.length;c++){const d=`${(l=t[c])==null?void 0:l.v}`;d&&s.push(Number(Xi(d).matchTxt))}return i&&(t.reverse(),s.reverse()),Qn(s)?(r=s[1]-s[0],Ne(js(t,o,r),i)):Et(t,o)}}},Bd={type:_e.CHN_NUMBER,priority:830,match:n=>!!Rd(`${n==null?void 0:n.v}`||""),isContinue:(n,o)=>n.type===_e.CHN_NUMBER,applyFunctions:{[le.SERIES]:(n,o,e)=>{var c,d,u;const{data:t}=n,i=e===a.Direction.LEFT||e===a.Direction.UP;if(t.length===1){const h=`${(c=t[0])==null?void 0:c.v}`;let g;return i?g=-1:g=1,h&&(h===""||Qe(h)<7)?Ne($t(t,o,g),i):Ne(Zs(t,o,g),i)}let r=!1;for(let h=0;h<t.length;h++)if(((d=t[h])==null?void 0:d.v)===""){r=!0;break}const s=[];let l=0;for(let h=0;h<t.length;h++){const g=`${(u=t[h])==null?void 0:u.v}`;g===""?h===0?s.push(0):(l++,s.push(l*7)):r&&Qe(g)>0&&Qe(g)<7?s.push(Qe(g)+l*7):s.push(Qe(g))}if(i&&(t.reverse(),s.reverse()),Qn(s)){if(r||s[s.length-1]<6&&s[0]>0||s[0]<6&&s[s.length-1]>0){const g=s[1]-s[0];return Ne($t(t,o,g),i)}const h=s[1]-s[0];return Ne(Zs(t,o,h),i)}return Et(t,o)}}},Fd={type:_e.CHN_WEEK2,priority:820,match:n=>!!Md(`${n==null?void 0:n.v}`||""),isContinue:(n,o)=>n.type===_e.CHN_WEEK2,applyFunctions:{[le.SERIES]:(n,o,e)=>{var l;const{data:t}=n,i=e===a.Direction.LEFT||e===a.Direction.UP;if(t.length===1){let c;return i?c=-1:c=1,Ne($t(t,o,c,1),i)}const r=[];let s=0;for(let c=0;c<t.length;c++){const d=`${(l=t[c])==null?void 0:l.v}`,u=d==null?void 0:d.substr(d.length-1,1);d===""?c===0?r.push(0):(s++,r.push(s*7)):r.push(Qe(u)+s*7)}if(i&&(t.reverse(),r.reverse()),Qn(r)){const c=r[1]-r[0];return Ne($t(t,o,c,1),i)}return Et(t,o)}}},zd={type:_e.CHN_WEEK3,priority:810,match:n=>Pd(`${n==null?void 0:n.v}`||""),isContinue:(n,o)=>n.type===_e.CHN_WEEK3,applyFunctions:{[le.SERIES]:(n,o,e)=>{var l;const{data:t}=n,i=e===a.Direction.LEFT||e===a.Direction.UP;if(t.length===1){let c;return i?c=-1:c=1,Ne($t(t,o,c,2),i)}const r=[];let s=0;for(let c=0;c<t.length;c++){const d=`${(l=t[c])==null?void 0:l.v}`;if(d){const u=d.substr(d.length-1,1);d===""?c===0?r.push(0):(s++,r.push(s*7)):r.push(Qe(u)+s*7)}}if(i&&(t.reverse(),r.reverse()),Qn(r)){const c=r[1]-r[0];return Ne($t(t,o,c,2),i)}return Et(t,o)}}},Xd={type:_e.LOOP_SERIES,priority:800,match:n=>Vd(`${n==null?void 0:n.v}`||""),isContinue:(n,o)=>{var e;return n.type===_e.LOOP_SERIES?er(`${(e=n.cellData)==null?void 0:e.v}`||"").name===er(`${o==null?void 0:o.v}`||"").name:!1},applyFunctions:{[le.SERIES]:(n,o,e)=>{var c,d;const{data:t}=n,i=e===a.Direction.LEFT||e===a.Direction.UP,{series:r}=er(`${(c=t[0])==null?void 0:c.v}`||"");if(t.length===1){let u;return i?u=-1:u=1,Ne(Gs(t,o,u,r),i)}const s=[];let l=0;for(let u=0;u<t.length;u++){const h=`${(d=t[u])==null?void 0:d.v}`;h&&(h===r[0]?u===0?s.push(0):(l++,s.push(l*r.length)):s.push(r.indexOf(h)+l*7))}if(i&&(t.reverse(),s.reverse()),Qn(s)){const u=s[1]-s[0];return Ne(Gs(t,o,u,r),i)}return Et(t,o)}}};function Ne(n,o){return o?n.reverse():n}var Yd=Object.getOwnPropertyDescriptor,jd=(n,o,e,t)=>{for(var i=t>1?void 0:t?Yd(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},tn=(n,o)=>(e,t)=>o(e,t,n);y.AutoFillService=class extends a.Disposable{constructor(e,t,i,r,s,l){super();R(this,"_rules",[]);R(this,"_hooks",[]);R(this,"_applyType$",new N.BehaviorSubject(le.SERIES));R(this,"_isFillingStyle",!0);R(this,"_prevUndos",[]);R(this,"_autoFillLocation$",new N.BehaviorSubject(null));R(this,"autoFillLocation$",this._autoFillLocation$.asObservable());R(this,"_showMenu$",new N.BehaviorSubject(!1));R(this,"showMenu$",this._showMenu$.asObservable());R(this,"_direction",a.Direction.DOWN);R(this,"applyType$",this._applyType$.asObservable());R(this,"_menu$",new N.BehaviorSubject([{label:"autoFill.copy",value:le.COPY,disable:!1},{label:"autoFill.series",value:le.SERIES,disable:!1},{label:"autoFill.formatOnly",value:le.ONLY_FORMAT,disable:!1},{label:"autoFill.noFormat",value:le.NO_FORMAT,disable:!1}]));R(this,"menu$",this._menu$.asObservable());this._commandService=e,this._undoRedoService=t,this._renderManagerService=i,this._univerInstanceService=r,this._selectionManagerService=s,this._injector=l,this._init()}_init(){this._rules=[Ld,xd,Ud,Bd,Fd,zd,Xd,qs].sort((e,t)=>t.priority-e.priority),this._isFillingStyle=!0}_getOneByPriority(e){return e.length<=0?[]:[e.reduce((i,r)=>(r.priority||0)>(i.priority||0)?r:i,e[0])]}_initPrevUndo(){this._prevUndos=[]}async triggerAutoFill(e,t,i,r,s){var f;if(i.startColumn===r.startColumn&&i.startRow===r.startRow&&i.endColumn===r.endColumn&&i.endRow===r.endRow)return!1;if(r.endColumn<i.endColumn&&r.endColumn>i.startColumn)return this._commandService.executeCommand(nn.id,{clearRange:{startRow:r.startRow,endRow:r.endRow,startColumn:r.endColumn+1,endColumn:i.endColumn},selectionRange:r});if(r.endRow<i.endRow&&r.endRow>i.startRow)return this._commandService.executeCommand(nn.id,{clearRange:{startRow:r.endRow+1,endRow:i.endRow,startColumn:r.startColumn,endColumn:r.endColumn},selectionRange:r});const l={startRow:r.startRow,endRow:r.endRow,startColumn:r.startColumn,endColumn:r.endColumn};let c=null;if(r.startRow<i.startRow)c=a.Direction.UP,l.endRow=i.startRow-1;else if(r.endRow>i.endRow)c=a.Direction.DOWN,l.startRow=i.endRow+1;else if(r.startColumn<i.startColumn)c=a.Direction.LEFT,l.endColumn=i.startColumn-1;else if(r.endColumn>i.endColumn)c=a.Direction.RIGHT,l.startColumn=i.endColumn+1;else return!1;this.direction=c;const d=this._injector.invoke(v=>m.rangeToDiscreteRange(i,v)),u=this._injector.invoke(v=>m.rangeToDiscreteRange(l,v));if(!d||!u)return!1;this.autoFillLocation={source:d,target:u,unitId:e,subUnitId:t};const h=[];if(this.getActiveHooks().forEach(v=>{var C;const p=(C=v==null?void 0:v.onBeforeFillData)==null?void 0:C.call(v,{source:d,target:u,unitId:e,subUnitId:t},c);p&&h.unshift(p)}),this._initPrevUndo(),s)return this.fillData(s);for(let v=0;v<h.length;v++){const p=this.menu.find(C=>C.value===h[v]);if(p&&!p.disable)return this.fillData(h[v])}const S=(f=this.menu.find(v=>v.disable===!1))==null?void 0:f.value;return S?this.fillData(S):!1}addHook(e){if(this._hooks.find(t=>t.id===e.id))throw new Error(`Add hook failed, hook id '${e.id}' already exist!`);return e.priority===void 0&&(e.priority=0),e.type===void 0&&(e.type=en.Append),this._hooks.push(e),a.toDisposable(()=>{const t=this._hooks.findIndex(i=>i===e);t>-1&&this._hooks.splice(t,1)})}registerRule(e){if(this._rules.find(i=>i.type===e.type))throw new Error(`Registry rule failed, type '${e.type}' already exist!`);const t=this._rules.findIndex(i=>i.priority<e.priority);this._rules.splice(t===-1?this._rules.length:t,0,e)}getRules(){return this._rules}getAllHooks(){return this._hooks}getActiveHooks(){const{source:e,target:t,unitId:i,subUnitId:r}=this.autoFillLocation||{};if(!e||!t||!i||!r)return[];const s=this._hooks.filter(u=>{var h;return!((h=u.disable)!=null&&h.call(u,{source:e,target:t,unitId:i,subUnitId:r},this._direction,this.applyType))}),l=s.filter(u=>u.type===en.Only);if(l.length>0)return this._getOneByPriority(l);const c=this._getOneByPriority(s.filter(u=>u.type===en.Default)),d=s.filter(u=>u.type===en.Append)||[];return[...c,...d]}get applyType(){return this._applyType$.getValue()}set applyType(e){this._applyType$.next(e)}get menu(){return this._menu$.getValue()}get direction(){return this._direction}set direction(e){this._direction=e}isFillingStyle(){return this._isFillingStyle}setFillingStyle(e){this._isFillingStyle=e}get autoFillLocation(){return this._autoFillLocation$.getValue()}set autoFillLocation(e){this._autoFillLocation$.next(e)}setDisableApplyType(e,t){this._menu$.next(this._menu$.getValue().map(i=>i.value===e?{...i,disable:t}:i))}setShowMenu(e){this._showMenu$.next(e)}fillData(e){var E,O,T;this.applyType=e;const t=this._univerInstanceService.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),i=t==null?void 0:t.getUnitId(),r=(E=t==null?void 0:t.getActiveSheet())==null?void 0:E.getSheetId(),{source:s,target:l,unitId:c=i,subUnitId:d=r}=this.autoFillLocation||{};if(!s||!l||!c||!d)return!1;const u=this.direction;this._prevUndos.length>0&&this._prevUndos.forEach(P=>{this._commandService.syncExecuteCommand(P.id,P.params)}),this._prevUndos=[];const h=a.Rectangle.union(at(s),at(l)),g=this.getActiveHooks(),S=this._univerInstanceService.getUnit(c,a.UniverInstanceType.UNIVER_SHEET);c===i&&d===r&&this._commandService.syncExecuteCommand(m.SetSelectionsOperation.id,{selections:[{primary:{...(T=(O=this._selectionManagerService.getCurrentLastSelection())==null?void 0:O.primary)!=null?T:h},range:{...h,rangeType:a.RANGE_TYPE.NORMAL}}],unitId:c,subUnitId:d});const f=[],v=[];g.forEach(P=>{var k;const{undos:A,redos:D}=((k=P.onFillData)==null?void 0:k.call(P,{source:s,target:l,unitId:c,subUnitId:d},u,e))||{};A&&f.push(...A),D&&v.push(...D)});const p=v.every(P=>this._commandService.syncExecuteCommand(P.id,P.params)),C=[];e!==le.NO_FORMAT&&v.forEach(P=>{if(P.id===m.SetRangeValuesMutation.id){const{cellValue:A}=P.params;new a.ObjectMatrix(A).forValue((k,H,V)=>{const L=Object.keys(S.getStyles().get(V==null?void 0:V.s)||{});(V!=null&&V.p||L.length&&zs.some(W=>L.includes(W)))&&C.push({startRow:k,endRow:k,startColumn:H,endColumn:H})})}});const _=this._getAutoHeightUndoRedos(c,d,C);return _.redos.every(P=>this._commandService.syncExecuteCommand(P.id,P.params))&&(f.push(..._.undos),v.push(..._.redos)),p&&(this._prevUndos=f,this._undoRedoService.pushUndoRedo({unitID:c,undoMutations:f,redoMutations:v})),g.forEach(P=>{var A;(A=P.onAfterFillData)==null||A.call(P,{source:s,target:l,unitId:c,subUnitId:d},u,e)}),this.setShowMenu(!0),!0}_getAutoHeightUndoRedos(e,t,i){var h,g;const r=(h=this._renderManagerService.getRenderById(e))==null?void 0:h.with(y.SheetSkeletonManagerService),s=(g=r==null?void 0:r.getCurrentParam())==null?void 0:g.skeleton;if(!s)return{redos:[],undos:[]};const l=s.calculateAutoHeightInRange(i),c={subUnitId:t,unitId:e,rowsAutoHeightInfo:l},d=s.worksheet,u=m.SetWorksheetRowAutoHeightMutationFactory(c,d);return{undos:[{id:m.SetWorksheetRowAutoHeightMutation.id,params:u}],redos:[{id:m.SetWorksheetRowAutoHeightMutation.id,params:c}]}}},y.AutoFillService=jd([tn(0,a.ICommandService),tn(1,a.IUndoRedoService),tn(2,M.IRenderManagerService),tn(3,a.Inject(a.IUniverInstanceService)),tn(4,a.Inject(m.SheetsSelectionsService)),tn(5,a.Inject(a.Injector))],y.AutoFillService);const ct=a.createIdentifier("univer.auto-fill-service"),dt={type:a.CommandType.COMMAND,id:"sheet.command.auto-fill",handler:async(n,o)=>{const e=n.get(ct),t=n.get(a.IUniverInstanceService),{sourceRange:i,targetRange:r,applyType:s}=o,l=m.getSheetCommandTarget(t,o);if(!l)return!1;const{subUnitId:c,unitId:d}=l;return e.triggerAutoFill(d,c,i,r,s)}},nn={id:"sheet.command.auto-clear-content",type:a.CommandType.COMMAND,handler:async(n,o)=>{const e=n.get(a.IUniverInstanceService),t=n.get(a.ICommandService),i=n.get(a.IUndoRedoService),r=n.get(m.SheetInterceptorService),s=m.getSheetCommandTarget(e);if(!s)return!1;const{unitId:l,subUnitId:c}=s,{clearRange:d,selectionRange:u}=o,h={subUnitId:c,unitId:l,cellValue:m.generateNullCellValue([d])},g=m.SetRangeValuesUndoMutationFactory(n,h),{startColumn:S,startRow:f}=u,v={selections:[{primary:{startColumn:S,startRow:f,endColumn:S,endRow:f,actualRow:f,actualColumn:S,isMerged:!1,isMergedMainCell:!1},range:{...u}}],unitId:l,subUnitId:c};if(t.executeCommand(m.SetSelectionsOperation.id,v),t.syncExecuteCommand(m.SetRangeValuesMutation.id,h)){const C=r.afterCommandExecute({id:m.SetRangeValuesMutation.id,params:h});return a.sequenceExecute(C.redos,t),i.pushUndoRedo({unitID:l,undoMutations:[{id:m.SetRangeValuesMutation.id,params:g},...C.undos],redoMutations:[{id:m.SetRangeValuesMutation.id,params:h},...C.redos]}),!0}return!1}};function tr(n){return n.getContextValue(a.FOCUSING_SHEET)}function ae(n){return n.getContextValue(a.FOCUSING_SHEET)&&n.getContextValue(a.FOCUSING_UNIVER_EDITOR)&&!n.getContextValue(a.EDITOR_ACTIVATED)&&!n.getContextValue(a.FOCUSING_COMMON_DRAWINGS)}function Qs(n){return n.getContextValue(a.FOCUSING_SHEET)&&n.getContextValue(a.FOCUSING_UNIVER_EDITOR)&&!n.getContextValue(a.EDITOR_ACTIVATED)&&!n.getContextValue(a.FOCUSING_FX_BAR_EDITOR)&&!n.getContextValue(a.FOCUSING_COMMON_DRAWINGS)}function Zd(n){return n.getContextValue(a.FOCUSING_SHEET)&&n.getContextValue(a.FOCUSING_UNIVER_EDITOR)&&n.getContextValue(a.EDITOR_ACTIVATED)}function nr(n){return n.getContextValue(a.FOCUSING_UNIVER_EDITOR)&&n.getContextValue(a.EDITOR_ACTIVATED)}function ji(n){return n.getContextValue(a.FOCUSING_FX_BAR_EDITOR)&&n.getContextValue(a.FOCUSING_UNIVER_EDITOR)}function Gd(n){return n.getContextValue(a.FOCUSING_SHEET)&&n.getContextValue(a.EDITOR_ACTIVATED)&&n.getContextValue(a.FOCUSING_EDITOR_INPUT_FORMULA)&&n.getContextValue(a.FOCUSING_UNIVER_EDITOR)}function on(n){return n.getContextValue(a.FOCUSING_SHEET)&&n.getContextValue(a.FOCUSING_UNIVER_EDITOR)&&n.getContextValue(a.EDITOR_ACTIVATED)&&!n.getContextValue(a.FOCUSING_EDITOR_INPUT_FORMULA)&&!n.getContextValue(a.FOCUSING_EDITOR_STANDALONE)}var Kd=Object.getOwnPropertyDescriptor,qd=(n,o,e,t)=>{for(var i=t>1?void 0:t?Kd(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},ir=(n,o)=>(e,t)=>o(e,t,n);const Js=Ko.MARK_SELECTION,yt=a.createIdentifier("univer.mark-selection-service");y.MarkSelectionService=class extends a.Disposable{constructor(e,t,i){super();R(this,"_shapeMap",new Map);this._currentService=e,this._renderManagerService=t,this._themeService=i}addShape(e,t=[],i=Js){var d;const r=this._currentService.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),s=(d=r.getActiveSheet())==null?void 0:d.getSheetId();if(!s)return null;const l=a.generateRandomId(),c={selection:e,subUnitId:s,unitId:r.getUnitId(),zIndex:i,control:null,exits:t};return this._shapeMap.set(l,c),this.refreshShapes(),l}addShapeWithNoFresh(e,t=[],i=Js){var c;const r=this._currentService.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),s=(c=r.getActiveSheet())==null?void 0:c.getSheetId();if(!s)return null;const l=a.generateRandomId();return this._shapeMap.set(l,{selection:e,subUnitId:s,unitId:r.getUnitId(),zIndex:i,control:null,exits:t}),l}refreshShapes(){var r;const e=this._currentService.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET);if(!e)return;const t=e.getUnitId(),i=(r=e.getActiveSheet())==null?void 0:r.getSheetId();this._shapeMap.forEach(s=>{const{unitId:l,subUnitId:c,selection:d,control:u,zIndex:h}=s;if(u==null||u.dispose(),l!==t||c!==i)return;const g=this._renderManagerService.getRenderById(l);if(!g)return;const S=g.with(y.SheetSkeletonManagerService).getCurrentSkeleton();if(!S)return;const{scene:f}=g,{rowHeaderWidth:v,columnHeaderHeight:p}=S,C=new Kn(f,h,this._themeService,{enableAutoFill:!1,highlightHeader:!1,rowHeaderWidth:v,columnHeaderHeight:p}),_=Re(d,S);C.updateRangeBySelectionWithCoord(_),s.control=C})}getShapeMap(){return this._shapeMap}removeShape(e){const t=this._shapeMap.get(e);if(!t)return;const{control:i}=t;i==null||i.dispose(),this._shapeMap.delete(e)}removeAllShapes(){for(const e of this._shapeMap.values()){const{control:t}=e;t==null||t.dispose()}this._shapeMap.clear()}},y.MarkSelectionService=qd([ir(0,a.IUniverInstanceService),ir(1,M.IRenderManagerService),ir(2,a.Inject(a.ThemeService))],y.MarkSelectionService);function $s(n){return{strokeWidth:1.5,stroke:n.getColorFromTheme("primary.600"),fill:"rgba(178, 178, 178, 0.10)",widgets:{},strokeDash:8}}function Qd(n){if(n==null)return n;const o={};return n.p!==void 0&&(o.p=n.p===null?null:a.cloneValue(n.p)),n.s!==void 0&&(n.s===null||typeof n.s=="string"?o.s=n.s:o.s=a.cloneValue(n.s)),n.v!==void 0&&(o.v=n.v),n.t!==void 0&&(o.t=n.t),n.f!==void 0&&(o.f=n.f),n.ref!==void 0&&(o.ref=n.ref),n.xf!==void 0&&(o.xf=n.xf),n.si!==void 0&&(o.si=n.si),n.custom!==void 0&&(o.custom=n.custom===null?null:a.cloneValue(n.custom)),n.rowSpan!==void 0&&(o.rowSpan=n.rowSpan),n.colSpan!==void 0&&(o.colSpan=n.colSpan),n.plain!==void 0&&(o.plain=n.plain),o}const Jd=10,$d=6;function eu(){return a.generateRandomId($d)}function tu(n){const o=n.match(/data-copy-id="([^\s]+)"/);return o&&o[1]?o[1]:null}class nu{constructor(){R(this,"_cache",new a.LRUMap(Jd))}set(o,e){this._cache.set(o,e)}get(o){return this._cache.get(o)}del(o){this._cache.delete(o)}clear(){this._cache.clear()}clearWithUnitId(o){this._cache.forEach((e,t)=>{e.unitId===o&&this._cache.delete(t)})}}function Zi(n,o){const e=o!=null?o:n.style,t={},i=n.tagName.toLowerCase();switch(i){case"b":case"em":case"strong":{t.bl=a.BooleanNumber.TRUE;break}case"s":{t.st={s:a.BooleanNumber.TRUE};break}case"u":{t.ul={s:a.BooleanNumber.TRUE};break}case"i":{t.it=a.BooleanNumber.TRUE;break}case"sub":case"sup":{t.va=i==="sup"?a.BaselineOffset.SUPERSCRIPT:a.BaselineOffset.SUBSCRIPT;break}}return iu(e,t),t}function iu(n,o){if(n instanceof CSSStyleDeclaration)for(let e=0;e<n.length;e++){const t=n[e],i=n.getPropertyValue(t);ea(t,i,o)}else for(const e in n){const t=n[e];ea(e,t,o)}}function ea(n,o,e){switch(n){case"font-family":e.ff=o;break;case"font-size":{const t=Number.parseInt(o);Number.isNaN(t)||(o.endsWith("pt")?e.fs=t:o.endsWith("px")&&(e.fs=t*.75));break}case"font-style":o==="italic"&&(e.it=a.BooleanNumber.TRUE);break;case"font-weight":{(Number(o)>400||o==="bold")&&(e.bl=a.BooleanNumber.TRUE);break}case"text-decoration":{/underline/.test(o)?e.ul={s:a.BooleanNumber.TRUE}:/overline/.test(o)?e.ol={s:a.BooleanNumber.TRUE}:/line-through/.test(o)&&(e.st={s:a.BooleanNumber.TRUE});break}case"color":{try{const t=new a.ColorKit(o);t.isValid&&(e.cl={rgb:t.toRgbString()})}catch{}break}case"background-color":{const t=new a.ColorKit(o);t.isValid&&(e.bg={rgb:t.toRgbString()});break}}}function ou(n){const o=document.createElement("body");return o.innerHTML=n,o}function ta(n){const o=n.style,e={};for(let t=0;t<o.length;t++){const i=o[t],r=o.getPropertyValue(i);switch(i){case"margin-top":{const s=Number.parseInt(r);e.spaceAbove={v:/pt/.test(r)?M.ptToPixel(s):s};break}case"margin-bottom":{const s=Number.parseInt(r);e.spaceBelow={v:/pt/.test(r)?M.ptToPixel(s):s};break}case"line-height":{const s=Number.parseFloat(r);e.lineSpacing=s;break}}}return Object.getOwnPropertyNames(e).length?e:null}function or(n,o){const e=[];for(let t=0,i=n.length;t<i;t++)n[t]===a.DataStreamTreeTokenType.PARAGRAPH&&e.push({startIndex:t});return e}function na(n,o,e){var s,l,c;const t=o.length,r=((s=e==null?void 0:e.length)!=null?s:0)===1&&e[0].st===0&&e[0].ed===t;return n.p?r&&((c=(l=n.p.body)==null?void 0:l.textRuns)!=null&&c.length)?(n.p.body.textRuns=[],{...n,s:e[0].ts}):n:r?{...n,s:e[0].ts}:n}const ia=["color","background","font-size","text-align","vertical-align","font-weight","font-style","font-family","text-decoration","white-space","word-wrap","border-left","border-right","border-top","border-bottom","--data-rotate"];function oa(n,o){const e=n.tagName.toLowerCase();return typeof o=="string"?e===o:Array.isArray(o)?o.some(t=>t===e):o(n)}const zo=class zo{constructor(o){R(this,"_styleMap",new Map);R(this,"_styleCache",new Map);R(this,"_styleRules",[]);R(this,"_afterProcessRules",[]);R(this,"_dom",null);R(this,"_getCurrentSkeleton");this._getCurrentSkeleton=o.getCurrentSkeleton}static use(o){if(this._pluginList.includes(o))throw new Error(`Univer paste plugin ${o.name} already added`);this._pluginList.push(o)}convert(o){const e=zo._pluginList.find(v=>v.checkPasteType(o));e&&(this._styleRules=[...e.stylesRules],this._afterProcessRules=[...e.afterProcessRules]);const t=new a.ObjectMatrix;this._dom=ou(o);const i=this._dom.querySelector("style");if(i){const v=document.createElement("div"),p=v.attachShadow({mode:"open"});document.body.appendChild(v),p.appendChild(i);for(const C of i.sheet.cssRules){const _=C,w=_.selectorText,E=_.style;this._styleMap.set(w,E)}i.remove(),v.remove()}const r={dataStream:"",textRuns:[]},s=[],l=[],c=o.match(/<table\b[^>]*>([\s\S]*?)<\/table>/gi),d=[];this.process(null,this._dom.childNodes,r,d);const{paragraphs:u,dataStream:h,textRuns:g,payloads:S,customRanges:f}=r;if(u){const v=u.map(p=>p.startIndex+1);v.unshift(0);for(let p=0;p<v.length;p++){let C;if(p===v.length-1){if(C=`${h.substring(v[p])}\r
`,C===`\r
`)continue}else C=`${h.substring(v[p],v[p+1]-1)}\r
`;const _=[];g==null||g.forEach(T=>{T.st>=v[p]&&T.ed<=v[p+1]&&_.push({st:T.st-v[p],ed:T.ed-v[p],ts:T.ts})});const w=[];f==null||f.forEach(T=>{T.startIndex>=v[p]&&T.endIndex<=v[p+1]&&w.push({...T,startIndex:T.startIndex-v[p],endIndex:T.endIndex-v[p]})});const E=this._generateDocumentDataModelSnapshot({body:{dataStream:C,textRuns:_,paragraphs:or(C),customRanges:w}}),O=Object.keys(t.getMatrix()).length===0;t.setValue(O?0:t.getLength(),0,{v:C,p:E}),s.push({})}}else if(h){const v=`${h}\r
`,p={dataStream:v,textRuns:g,paragraphs:or(v),payloads:S,customRanges:f};if(!(f!=null&&f.length))t.setValue(0,0,na({v:h},h,g));else{const C=this._generateDocumentDataModelSnapshot({body:p});t.setValue(0,0,na({v:h,p:C},h,g))}s.push({})}return c&&c.forEach((v,p)=>{const C=t.getDataRange().endRow+1,{cellMatrix:_,rowProperties:w,colProperties:E}=this._parseTable(v,p);_&&_.forValue((O,T,P)=>{t.setValue(C+O,T,P)}),E&&l.push(...E),s.push(...w)}),this.dispose(),{rowProperties:s,colProperties:l,cellMatrix:t}}_getStyleBySelectorText(o,e){var i;const t=(i=this._styleMap.get(o))==null?void 0:i.getPropertyValue(e);return t||""}_getStyle(o,e){const t=ra(e),i=o.style;let r="";for(let s=0;s<ia.length;s++){const l=ia[s];if(l==="background"){let d="";o.classList.forEach(h=>{d=this._getStyleBySelectorText(`.${h}`,"background-color")||this._getStyleBySelectorText(`.${h}`,l)});const u=i.getPropertyValue("background-color")||d||this._getStyleBySelectorText(`#${o.id}`,"background-color")||this._getStyleBySelectorText(`#${o.id}`,l)||this._getStyleBySelectorText(o.nodeName.toLowerCase(),l)||this._getStyleBySelectorText(o.nodeName,"background-color")||t["background-color"]||"";u&&(r+=`background:${u};`);continue}if(l==="text-decoration"){let d="";o.classList.forEach(h=>{d=this._getStyleBySelectorText(`.${h}`,"text-decoration-line")||this._getStyleBySelectorText(`.${h}`,l)});const u=i.getPropertyValue("text-decoration-line")||i.getPropertyValue("text-decoration")||d||this._getStyleBySelectorText(`#${o.id}`,"text-decoration-line")||this._getStyleBySelectorText(`#${o.id}`,l)||this._getStyleBySelectorText(o.nodeName.toLowerCase(),l)||this._getStyleBySelectorText(o.nodeName,"text-decoration-line")||t["text-decoration-line"]||"";u&&(r+=`text-decoration:${u};`);continue}let c="";o.classList.forEach(d=>{c=this._getStyleBySelectorText(`.${d}`,l)}),c=i.getPropertyValue(l)||this._getStyleBySelectorText(`#${o.id}`,l)||c||this._getStyleBySelectorText(o.nodeName.toLowerCase(),l)||t[l]||"",c&&(r+=`${l}:${c};`)}return r}_parseTable(o,e){var l,c;const t=new a.ObjectMatrix,i=(l=su(o))!=null?l:[],{rowProperties:r=[]}=ru(o),s=this._parseTableByHtml(this._dom,e,(c=this._getCurrentSkeleton())==null?void 0:c.skeleton);return s&&s.forValue((d,u,h)=>{var f,v,p,C,_,w,E,O,T,P,A,D,k,H,V,L,W,B,U,z,F,j,Y,Q;let g=I.handleStringToStyle(void 0,h.style);if((C=(p=(v=(f=h==null?void 0:h.richTextParma)==null?void 0:f.p)==null?void 0:v.body)==null?void 0:p.textRuns)!=null&&C.length){const oe=(w=(_=h==null?void 0:h.richTextParma)==null?void 0:_.v)==null?void 0:w.length;for(let re=0;re<((P=(T=(O=(E=h==null?void 0:h.richTextParma)==null?void 0:E.p)==null?void 0:O.body)==null?void 0:T.textRuns)==null?void 0:P.length);re++){const ce=(k=(D=(A=h==null?void 0:h.richTextParma)==null?void 0:A.p)==null?void 0:D.body)==null?void 0:k.textRuns[re];ce.st===0&&ce.ed===oe&&(g={...ce.ts,...g},(L=(V=(H=h==null?void 0:h.richTextParma)==null?void 0:H.p)==null?void 0:V.body)==null||L.textRuns.splice(re,1),re--)}((z=(U=(B=(W=h==null?void 0:h.richTextParma)==null?void 0:W.p)==null?void 0:B.body)==null?void 0:U.textRuns)==null?void 0:z.length)===0&&(h.content=(F=h==null?void 0:h.richTextParma)==null?void 0:F.v,delete h.richTextParma)}const S=(Q=(Y=(j=h==null?void 0:h.richTextParma)==null?void 0:j.p)==null?void 0:Y.body)!=null&&Q.textRuns?{v:h.richTextParma.v,p:h.richTextParma.p,s:g,rowSpan:h.rowSpan,colSpan:h.colSpan}:{v:h.content,s:g,rowSpan:h.rowSpan,colSpan:h.colSpan};t.setValue(d,u,S)}),{rowProperties:r,colProperties:i,cellMatrix:t}}_parseTableByHtml(o,e,t){var c,d;const i=new a.ObjectMatrix,r=o.querySelectorAll("table")[e];if(!r)return i;const s=this._getStyle(r,""),l=r==null?void 0:r.querySelectorAll("tr");for(let u=0;u<l.length;u++){const h=l[u],g=this._getStyle(h,s),S=h.querySelectorAll("td, th");let f=0;for(let v=0;v<S.length;){const p=S[v];let C="";const _=Number(p.getAttribute("rowSpan"))||1,w=Number(p.getAttribute("colSpan"))||1;if(C=this._getStyle(p,g),u>0){const P=i.getValue(u-1,f);if((c=P==null?void 0:P.style)!=null&&c.includes("border-bottom")&&C.includes("border-top")){const A=aa(P.style,"border-bottom");A&&I.textTrim(A.substr(A.indexOf(":")+1))!=="none"&&(C=C.replace(/border-top:[^;]+;/,""))}}if(v>0){const P=i.getValue(u,f-1);if((d=P==null?void 0:P.style)!=null&&d.includes("border-right")&&C.includes("border-left")){const A=aa(P.style,"border-right");A&&I.textTrim(A.substr(A.indexOf(":")+1))!=="none"&&(C=C.replace(/border-left:[^;]+;/,""))}}const{cellText:E,cellRichStyle:O}=this._getCellTextAndRichText(p,C,t),T={rowSpan:_,colSpan:w,content:E,style:C,richTextParma:{p:O,v:E}};if(i.getValue(u,f)){f+=1;continue}else _>1||w>1?lu(i,C,T,{colSpan:w,rowSpan:_,rowIndex:u,colSetValueIndex:f}):i.setValue(u,f,T),f+=w,v++}}return i}_parseCellHtml(o,e,t,i=new Map,r){var s;for(const l of e)if(l.nodeType===Node.TEXT_NODE){const c=(s=l.nodeValue)==null?void 0:s.replace(/[\r\n]/g,"");let d;o&&i.has(o)&&(d=i.get(o)),t.dataStream+=c,d&&Object.getOwnPropertyNames(d).length&&t.textRuns.push({st:t.dataStream.length-c.length,ed:t.dataStream.length,ts:d})}else{if(l.nodeType===Node.COMMENT_NODE||l.nodeName==="STYLE")continue;if(l.nodeName.toLowerCase()==="br")t.paragraphs||(t.paragraphs=[]),t.paragraphs.push({startIndex:t.dataStream.length}),t.dataStream+="\r";else if(l.nodeType===Node.ELEMENT_NODE){const c=this._getStyle(l,r),d=o?i.get(o):{},u=ra(c),h=Zi(l,u);i.set(l,{...d,...h});const{childNodes:g}=l;this._parseCellHtml(l,g,t,i,c)}}}_getCellTextAndRichText(o,e,t){var l;if(o.innerHTML.includes("mso-spacerun:yes")){const c=o.innerHTML.replace(/<span[^>]*mso-spacerun:yes[^>]*>[\s\S]*?<\/span>/gi,"").replace(/\s/g,""),d=a.getNumfmtParseValueFilter(c);if(d&&d.v!==void 0&&d.v!==null)return{cellText:c,cellRichStyle:void 0}}let i="",r;if(/<[^>]+>/.test(o.innerHTML)&&t){const c={dataStream:"",textRuns:[]};this._parseCellHtml(null,o.childNodes,c,void 0,e);const d=(l=t.getBlankCellDocumentModel())==null?void 0:l.documentModel,u=d==null?void 0:d.getSnapshot(),h=`${c.dataStream}\r
`,g={...u,body:{dataStream:h,textRuns:c.textRuns,paragraphs:or(h)}};d==null||d.reset(g),r=d==null?void 0:d.getSnapshot(),i=c.dataStream}else i=au(o.innerHTML.replace(/[\r\n]/g,""));return{cellText:i,cellRichStyle:r}}_generateDocumentDataModelSnapshot(o){var l;const e=this._getCurrentSkeleton();if(e==null)return null;const{skeleton:t}=e,i=(l=t.getBlankCellDocumentModel())==null?void 0:l.documentModel,s={...i==null?void 0:i.getSnapshot(),...o};return i==null||i.reset(s),i==null?void 0:i.getSnapshot()}process(o,e,t,i){var r,s,l;for(const c of e)if(c.nodeName.toLowerCase()==="table")i.push({index:((r=t==null?void 0:t.paragraphs)==null?void 0:r.length)||0});else if(c.nodeType===Node.TEXT_NODE){if(((s=c.nodeValue)==null?void 0:s.trim())==="")continue;const d=(l=c.nodeValue)==null?void 0:l.replace(/[\r\n]/g,"");let u;o&&this._styleCache.has(o)&&(u=this._styleCache.get(o));const h={dataStream:"",textRuns:[]};t.dataStream+=d,h.dataStream+=d,u&&Object.getOwnPropertyNames(u).length&&(t.textRuns.push({st:t.dataStream.length-d.length,ed:t.dataStream.length,ts:u}),h.textRuns.push({st:t.dataStream.length-d.length,ed:t.dataStream.length,ts:u}))}else{if(a.skipParseTagNames.includes(c.nodeName.toLowerCase()))continue;if(c.nodeName.toLowerCase()==="br")t.paragraphs||(t.paragraphs=[]),t.paragraphs.push({startIndex:t.dataStream.length}),t.dataStream+="\r";else if(c.nodeType===Node.ELEMENT_NODE){if(c.nodeName==="STYLE")continue;const d=c,u=this._processBeforeLink(d,{body:t}),h=o?this._styleCache.get(o):{},g=this._styleRules.find(({filter:p})=>oa(c,p)),S=g?g.getStyle(c):Zi(c);this._styleCache.set(c,{...h,...S});const{childNodes:f}=c;this.process(c,f,t,i);const v=this._afterProcessRules.find(({filter:p})=>oa(c,p));v&&v.handler(t,c),this._processAfterLink(d,{body:t},u)}}}_processBeforeLink(o,e){return e.body.dataStream.length}_processAfterLink(o,e,t){var s,l;const i=e.body,r=o;r.tagName.toUpperCase()==="A"&&(i.customRanges=(s=i.customRanges)!=null?s:[],i.customRanges.push({startIndex:t,endIndex:i.dataStream.length-1,rangeId:(l=r.dataset.rangeid)!=null?l:a.generateRandomId(),rangeType:a.CustomRangeType.HYPERLINK,properties:{url:r.href}}))}dispose(){this._dom=null,this._styleCache.clear(),this._styleMap.clear()}};R(zo,"_pluginList",[]);let rn=zo;function ru(n){const o=/<tr([\s\S]*?)>([\s\S]*?)<\/tr>/gi,e=n.matchAll(o);if(!e)return{rowProperties:[],rowCount:0};const i=Array.from(e).map(r=>sa(r[1])).map(r=>{if(!r.height){const s=r.style,l=s&&s.match(/height\s*:\s*(\d+(\.\d+)?)px/);r.height=`${l?Number.parseInt(l[1],10):a.DEFAULT_WORKSHEET_ROW_HEIGHT}`}return r});return{rowProperties:i,rowCount:i.length}}function ra(n){const o={};return n.split(";").forEach(t=>{const[i,r]=t.split(":");o[i]=r}),o}function sa(n){if(!n)return{};const o={},e=/([\w-]+)\s*=\s*(?:(['"])([^'"]*)\2|(\S+))/g;let t;for(;(t=e.exec(n))!==null;){const[,i,,r,s]=t,l=r!==void 0?r:s;o[i]=l}return o}function su(n){const o=/<colgroup([\s\S]*?)>(.*?)<\/colgroup>/,e=n.match(o),t=/<col([\s\S]*?)>/g;let i;if(e!=null&&e[2]?i=e[2].matchAll(t):i=n.matchAll(t),!i)return null;const r=Array.from(i).map(l=>sa(l[1])),s=[];return r.forEach(l=>{const c=Number(l.span);if(c)for(let d=0;d<c;d++){const u={...l};delete u.span,s.push(u)}else s.push(l)}),s}function au(n){const o={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&#39;":"'","&nbsp;":" "};return n.replace(/&lt;|&gt;|&amp;|&quot;|&#39;|&nbsp;|<br>/g,e=>o[e])}function aa(n,o){if(!n||!o)return null;const e=new RegExp(`(${o}\\s*:\\s*[^;]+);`,"i"),t=n.match(e);return t?t[1]:null}function lu(n,o,e,t){const{rowSpan:i,colSpan:r,rowIndex:s,colSetValueIndex:l}=t;for(let c=s;c<s+i;c++)for(let d=l;d<l+r;d++)c===s&&d===l?n.setValue(c,d,{...e,style:o}):n.setValue(c,d,{style:o})}const cu={name:"univer-doc-paste-plugin-lark",checkPasteType(n){return/lark-record-clipboard/i.test(n)},stylesRules:[{filter:["s"],getStyle(n){const o=Zi(n);return{st:{s:a.BooleanNumber.TRUE},...o}}}],afterProcessRules:[{filter(n){return n.tagName==="DIV"&&/ace-line/i.test(n.className)},handler(n){n.paragraphs==null&&(n.paragraphs=[]),n.paragraphs.push({startIndex:n.dataStream.length}),n.dataStream+="\r"}}]},du={name:"univer-doc-paste-plugin-univer",checkPasteType(n){return/UniverNormal/i.test(n)},stylesRules:[],afterProcessRules:[{filter(n){return n.tagName==="P"&&/UniverNormal/i.test(n.className)},handler(n,o){n.paragraphs==null&&(n.paragraphs=[]);const e={startIndex:n.dataStream.length},t=ta(o);t&&(e.paragraphStyle=t),n.paragraphs.push(e),n.dataStream+="\r"}}]},uu={name:"univer-doc-paste-plugin-word",checkPasteType(n){return/word|mso/i.test(n)},stylesRules:[{filter:["b"],getStyle(n){const o=Zi(n);return{bl:a.BooleanNumber.TRUE,...o}}}],afterProcessRules:[{filter(n){return n.tagName==="P"&&/mso/i.test(n.className)},handler(n,o){n.paragraphs==null&&(n.paragraphs=[]);const e={startIndex:n.dataStream.length},t=ta(o);t&&(e.paragraphStyle=t),n.paragraphs.push(e),n.dataStream+="\r"}}]};var xe=(n=>(n.COPY="COPY",n.CUT="CUT",n))(xe||{});function hu(n,o,e,t,i){const r=e.map(d=>{var u;return(u=d.onCopyRow)==null?void 0:u.call(d,n)}).filter(d=>!!d),s=rr(r),l=sr(s),c=o.map(d=>{if(!i.has(`${n}-${d}`)){const u=t.getValue(n,d);if(u!=null&&u.rowSpan&&(u!=null&&u.colSpan))for(let h=n;h<n+u.rowSpan;h++)for(let g=d;g<d+u.colSpan;g++)i.add(`${h}-${g}`);return mu(n,d,e,t)}return null}).filter(d=>!!d).join("");return`<tr${l}>${c}</tr>`}function mu(n,o,e,t){const i=t.getValue(n,o),r=e.map(d=>{var u;return(u=d.onCopyCellStyle)==null?void 0:u.call(d,n,o,i==null?void 0:i.rowSpan,i==null?void 0:i.colSpan)}).filter(d=>!!d),s=rr(r),l=sr(s),c=e.reduce((d,u)=>{var h;return d||((h=u.onCopyCellContent)==null?void 0:h.call(u,n,o))||""},"");return`<td${l}>${c}</td>`}function gu(n,o){return`<colgroup>${n.map(t=>{const i=o.map(l=>{var c;return(c=l.onCopyColumn)==null?void 0:c.call(l,t)}).filter(l=>!!l),r=rr(i);return`<col ${sr(r)} />`}).join("")}</colgroup>`}function rr(n){return n.reduce((o,e)=>(Object.keys(e).forEach(i=>{o[i]?o[i]+=`;${e[i]}`:o[i]=e[i]}),o),{})}function sr(n){return Object.keys(n).reduce((o,e)=>`${o} ${e}="${n[e]}"`,"")}class Su{convert(o,e,t){const{cols:i,rows:r}=e;if(!i.length)return"";const s=gu(i,t),l=[],c=new Set;return r.forEach(u=>{l.push(hu(u,i,t,o,c))}),`<google-sheets-html-origin><table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" cellpadding="0" dir="ltr" style="table-layout:fixed;font-size:10pt;font-family:Arial;width:0px;border-collapse:collapse;border:none">${s}
<tbody>${l.join("")}</tbody></table>`}}const fu=(n,o,e=!1)=>{const t=h=>h.endRow-h.startRow+1,i=h=>h.endColumn-h.startColumn+1,r=t(o)%t(n),s=i(o)%i(n),l={startRow:0,endRow:t(n)-1,startColumn:0,endColumn:i(n)-1},c=Math.floor(t(o)/t(n)),d=Math.floor(i(o)/i(n)),u=[];if(!r&&!s)for(let h=1;h<=c;h++)for(let g=1;g<=d;g++){const S=t(n)*(h-1),f=i(n)*(g-1),v={startRow:S+o.startRow,endRow:S+o.startRow,startColumn:f+o.startColumn,endColumn:f+o.startColumn};u.push({repeatRelativeRange:l,startRange:v})}else if(!r&&s&&!e)for(let h=1;h<=c;h++){const g=t(n)*(h-1),S=0,f={startRow:g+o.startRow,endRow:g+o.startRow,startColumn:S+o.startColumn,endColumn:S+o.startColumn};u.push({repeatRelativeRange:l,startRange:f})}else if(r&&!s&&!e)for(let h=1;h<=d;h++){const S=i(n)*(h-1),f={startRow:0+o.startRow,endRow:0+o.startRow,startColumn:S+o.startColumn,endColumn:S+o.startColumn};u.push({repeatRelativeRange:l,startRange:f})}else{const h={startRow:o.startRow,endRow:o.startRow,startColumn:o.startColumn,endColumn:o.startColumn};u.push({startRange:h,repeatRelativeRange:l})}return u};function la(n){return n?[/<td[^>]*class=".*?xl.*?"[^>]*>/i,/xmlns:x="urn:schemas-microsoft-com:office:excel"/i,/ProgId="Excel.Sheet"/i,/xmlns:o="urn:schemas-microsoft-com:office:office"/i,/@mso-|mso-excel/i,/<x:ExcelWorkbook>/i].some(e=>e.test(n)):!1}function vu(n){if(!n)return!1;const o=/<img[^>]*src\s*=\s*["']data:image\/[^;]+;base64,[^"']*["'][^>]*>/i;return(n.match(o)||[]).length>0}function pu(...n){if(n.length===1)return n[0];const o=new a.ObjectMatrix;return n.forEach(e=>{e&&new a.ObjectMatrix(e).forValue((i,r,s)=>{o.setValue(i,r,{...o.getValue(i,r),...s})})}),o.getMatrix()}function Cu(n,o){return n.id===o.id&&n.params.unitId===o.params.unitId&&n.params.subUnitId===o.params.subUnitId}function ar(n){const o=[];for(let e=0;e<n.length;){let t=1;if(n[e].id===m.SetRangeValuesMutation.id){const i=n[e],r=[i];for(;e+t<n.length&&Cu(i,n[e+t]);)r.push(n[e+t]),t+=1;const s=pu(...r.map(l=>l.params.cellValue||{}));o.push({...i,params:{...i.params,cellValue:s}})}else o.push(n[e]);e+=t}return o}function ca(n,o={}){const{maxCellsPerChunk:e=2500,threshold:t=6e3,maxChunks:i=10}=o;if(n.id!==m.SetRangeValuesMutation.id)return[n];const{cellValue:r}=n.params;if(!r)return[n];const s=new a.ObjectMatrix(r);let l=0,c=1/0,d=-1/0,u=1/0,h=-1/0;if(s.forValue((C,_)=>{l++,c=Math.min(c,C),d=Math.max(d,C),u=Math.min(u,_),h=Math.max(h,_)}),c===1/0||l<=t)return[n];const g=[],S=h-u+1;let f=Math.max(1,Math.floor(e/S));const v=d-c+1;Math.ceil(v/f)>i&&(f=Math.ceil(v/i));for(let C=c;C<=d;C+=f){const _=Math.min(C+f-1,d),w=new a.ObjectMatrix;let E=!1;for(let O=C;O<=_;O++)for(let T=u;T<=h;T++){const P=s.getValue(O,T);P!==void 0&&(w.setValue(O,T,P),E=!0)}E&&g.push({...n,params:{...n.params,cellValue:w.getMatrix(),__splitChunk__:!0}})}return g.length>0?g:[n]}function lr(n,o){const{startRow:e,endRow:t,startColumn:i,endColumn:r}=n;for(let s=e;s<=t;s++)for(let l=i;l<=r;l++)if(o.rows.includes(s)&&o.cols.includes(l))return!0}function da(n,o){const{startRow:e,endRow:t,startColumn:i,endColumn:r}=o;for(let s=e;s<=t;s++)if(!n.rows.includes(s))return!1;for(let s=i;s<=r;s++)if(!n.cols.includes(s))return!1;return!0}function Iu(n){const o=n.trim().split(`
`);let e="<table>";return o.forEach(t=>{const i=t.split("	");e+="<tr>",i.forEach(r=>{e+=`<td>${r}</td>`}),e+="</tr>"}),e+="</table>",e}var _u=Object.getOwnPropertyDescriptor,bu=(n,o,e,t)=>{for(var i=t>1?void 0:t?_u(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Me=(n,o)=>(e,t)=>o(e,t,n);const ut={DEFAULT_COPY:"default-copy",SPECIAL_COPY_FORMULA_ONLY:"special-copy-formula-only"},ge={DEFAULT_PASTE:"default-paste",SPECIAL_PASTE_VALUE:"special-paste-value",SPECIAL_PASTE_FORMAT:"special-paste-format",SPECIAL_PASTE_COL_WIDTH:"special-paste-col-width",SPECIAL_PASTE_BESIDES_BORDER:"special-paste-besides-border",SPECIAL_PASTE_FORMULA:"special-paste-formula"},wu={...ut,...ge},Eu={[I.FILE_PNG_CLIPBOARD_MIME_TYPE]:"png",[I.FILE__JPEG_CLIPBOARD_MIME_TYPE]:"jpg",[I.FILE__WEBP_CLIPBOARD_MIME_TYPE]:"webp",[I.FILE__BMP_CLIPBOARD_MIME_TYPE]:"bmp"};rn.use(uu),rn.use(cu),rn.use(du);const ke=a.createIdentifier("sheet.clipboard-service");y.SheetClipboardService=class extends a.Disposable{constructor(e,t,i,r,s,l,c,d,u,h,g,S,f,v){super();R(this,"_clipboardHooks",[]);R(this,"_clipboardHooks$",new N.BehaviorSubject([]));R(this,"clipboardHooks$",this._clipboardHooks$.asObservable());R(this,"_htmlToUSM");R(this,"_usmToHtml");R(this,"_copyContentCache");R(this,"_copyMarkId",null);R(this,"_pasteOptionsCache$",new N.BehaviorSubject(null));R(this,"pasteOptionsCache$",this._pasteOptionsCache$.asObservable());R(this,"_showMenu$",new N.BehaviorSubject(!1));R(this,"showMenu$",this._showMenu$.asObservable());this._logService=e,this._univerInstanceService=t,this._selectionManagerService=i,this._clipboardInterfaceService=r,this._undoRedoService=s,this._commandService=l,this._markSelectionService=c,this._notificationService=d,this._platformService=u,this._renderManagerService=h,this._themeService=g,this._localeService=S,this._errorService=f,this._injector=v,this._htmlToUSM=new rn({getCurrentSkeleton:()=>{var p;return(p=M.withCurrentTypeOfRenderer(a.UniverInstanceType.UNIVER_SHEET,y.SheetSkeletonManagerService,this._univerInstanceService,this._renderManagerService))==null?void 0:p.getCurrentParam()}}),this._usmToHtml=new Su,this._copyContentCache=new nu,this.disposeWithMe(this._htmlToUSM),this._initUnitDisposed()}setShowMenu(e){this._showMenu$.next(e)}getPasteMenuVisible(){return this._showMenu$.getValue()}getPasteOptionsCache(){return this._pasteOptionsCache$.getValue()}copyContentCache(){return this._copyContentCache}generateCopyContent(e,t,i,r){const{copyType:s=xe.COPY,copyHookType:l=ut.DEFAULT_COPY}=r||{};let c=this._clipboardHooks;l===ut.SPECIAL_COPY_FORMULA_ONLY&&(c=this._clipboardHooks.filter(u=>u.id===l)),c.forEach(u=>{var h;return(h=u.onBeforeCopy)==null?void 0:h.call(u,e,t,i,s)});const d=this._generateCopyContent(e,t,i,c,l);return c.forEach(u=>{var h;return(h=u.onAfterCopy)==null?void 0:h.call(u)}),d}async copy(e){const t=this._selectionManagerService.getCurrentLastSelection();if(!t)return!1;const i=this._univerInstanceService.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),r=i==null?void 0:i.getActiveSheet();if(!i||!r)return!1;const s=i.getUnitId(),l=r.getSheetId(),{copyType:c=xe.COPY,copyHookType:d=ut.DEFAULT_COPY}=e||{},u=this.generateCopyContent(s,l,t.range,{copyType:c,copyHookType:d});if(!u)return!1;const{html:h,plain:g,matrixFragment:S,copyId:f,discreteRange:v}=u;this._copyContentCache.set(f,{unitId:i.getUnitId(),subUnitId:r.getSheetId(),range:v,matrix:S,copyType:c}),await this._clipboardInterfaceService.write(g,h),this._markSelectionService.removeAllShapes();const p=$s(this._themeService);return this._copyMarkId=this._markSelectionService.addShape({...t,style:p}),!0}async cut(){return this.copy({copyType:xe.CUT})}async paste(e,t=ge.DEFAULT_PASTE){const i=e.types,r=i.indexOf(I.PLAIN_TEXT_CLIPBOARD_MIME_TYPE)!==-1?await e.getType(I.PLAIN_TEXT_CLIPBOARD_MIME_TYPE).then(d=>d&&d.text()):"",s=i.indexOf(I.HTML_CLIPBOARD_MIME_TYPE)!==-1?await e.getType(I.HTML_CLIPBOARD_MIME_TYPE).then(d=>d&&d.text()):"",l=i.findIndex(d=>I.imageMimeTypeSet.has(d)),c=l===-1||!vu(s);if(s&&c)return this._platformService.isWindows&&la(s)&&this._notificationService.show({type:"warning",title:this._localeService.t("clipboard.shortCutNotify.title"),content:this._localeService.t("clipboard.shortCutNotify.useShortCutInstead")}),this._pasteHTML(s,t);if(l!==-1){const d=i[l],u=await e.getType(d);if(u){const h=Eu[d],g=new File([u],`clipboard-image.${h}`,{type:d});return this._pasteFiles([g],t)}}return r?this._pastePlainText(r,t):(this._logService.error("[SheetClipboardService]","No valid data on clipboard"),!1)}async legacyPaste(e,t,i){const r=la(e!=null?e:"");return i&&!r?this._pasteFiles(i,ge.DEFAULT_PASTE):e?this._pasteHTML(e,ge.DEFAULT_PASTE):t?/[\n\t]/.test(t)?this._pasteHTML(Iu(t),ge.DEFAULT_PASTE):this._pastePlainText(t,ge.DEFAULT_PASTE):this._pasteUnrecognized()}rePasteWithPasteType(e){const t=this._pasteOptionsCache$.getValue();if(!t)return!1;const i=this._injector.get(a.IUndoRedoService),r=i.pitchTopUndoElement();r&&a.sequenceExecute(r.undoMutations,this._commandService)&&i.popUndoToRedo();const{cellMatrix:s,rowProperties:l=[],colProperties:c=[],source:d,target:u}=t;return this._pasteUSM({cellMatrix:s,colProperties:c,rowProperties:l},u,ge[e],d),!0}updatePasteOptionsCache(e){this._pasteOptionsCache$.next(e)}addClipboardHook(e){if(this._clipboardHooks.findIndex(i=>i.id===e.id)!==-1)return this._logService.error("[SheetClipboardService]","hook already exists",e.id),{dispose:()=>{}};const t=this._clipboardHooks.findIndex(i=>{const r=i.priority||0;return(e.priority||0)<r});return this._clipboardHooks.splice(t!==-1?t:this._clipboardHooks.length,0,e),this._notifyClipboardHook(),a.toDisposable(()=>{const i=this._clipboardHooks.indexOf(e);i>-1&&(this._clipboardHooks.splice(i,1),this._notifyClipboardHook())})}getClipboardHooks(){return this._clipboardHooks}_generateCopyContent(e,t,i,r,s=ut.DEFAULT_COPY){var P;const l=this._univerInstanceService.getUniverSheetInstance(e),c=l==null?void 0:l.getSheetBySheetId(t);if(!l||!c)return null;const d=r.reduce((A,D)=>{var H;const k=(H=D.getFilteredOutRows)==null?void 0:H.call(D,e,t,i);return k==null||k.forEach(V=>A.add(V)),A},new Set),{startColumn:u,startRow:h,endColumn:g,endRow:S}=i;let f=h;const v=c.getMatrixWithMergedCells(h,u,S,g,a.CellModeEnum.Both),p=new a.ObjectMatrix,C=new a.ObjectMatrix,_={rows:[],cols:[]},w=s===ut.SPECIAL_COPY_FORMULA_ONLY?r.find(A=>A.handleMatrixOnCell):void 0;for(let A=h;A<=S;A++)if(!d.has(A)){_.rows.push(A);for(let D=u;D<=g;D++){if(w){(P=w.handleMatrixOnCell)==null||P.call(w,A,D,f-h,D-u,v,p,C);continue}const k=v.getValue(A,D);if(k){const H=a.cloneCellDataWithSpanAndDisplay(k);C.setValue(f-h,D-u,{...a.getEmptyCell(),...H}),delete H.displayV,p.setValue(f-h,D-u,{...a.getEmptyCell(),...H})}else C.setValue(f-h,D-u,a.getEmptyCell()),p.setValue(f-h,D-u,a.getEmptyCell()),v.setValue(A,D,a.getEmptyCell())}f+=1}for(let A=u;A<=g;A++)_.cols.push(A);let E=this._usmToHtml.convert(v,_,r);const O=ua(C),T=eu();return E=E.replace(/(<[a-z]+)/,(A,D)=>`${D} data-copy-id="${T}"`),{copyId:T,plain:O,html:E,matrixFragment:p,discreteRange:_}}_notifyClipboardHook(){this._clipboardHooks$.next(this._clipboardHooks)}async _executePaste(e){const t=this._getPastingTarget();if(!t.subUnitId||!t.selection)return!1;const i=this._injector.invoke(S=>m.rangeToDiscreteRange(t.selection.range,S,t.unitId,t.subUnitId));if(!i)return!1;const{unitId:r,subUnitId:s}=t,l=this._clipboardHooks,c=[];if(l.some(S=>{var f;return c.push(S)&&((f=S.onBeforePaste)==null?void 0:f.call(S,{unitId:r,subUnitId:s,range:i}))===!1}))return c.forEach(S=>{var f;return(f=S.onAfterPaste)==null?void 0:f.call(S,!1)}),!1;const u=[],h=[];c.forEach(S=>{const f=e(S,{unitId:r,subUnitId:s,range:i});f&&(u.push(...f.redos),h.push(...f.undos))});const g=u.every(S=>this._commandService.executeCommand(S.id,S.params));return g&&this._undoRedoService.pushUndoRedo({unitID:this._univerInstanceService.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET).getUnitId(),undoMutations:h,redoMutations:u}),g}async _pasteFiles(e,t){return this._executePaste((i,r)=>{var s;return(s=i.onPasteFiles)==null?void 0:s.call(i,r,e,{pasteType:t})})}async _pastePlainText(e,t){return this._executePaste((i,r)=>{var s;return(s=i.onPastePlainText)==null?void 0:s.call(i,r,e,{pasteType:t})})}_pasteUnrecognized(){return this._executePaste((e,t)=>{var i;return(i=e.onPasteUnrecognized)==null?void 0:i.call(e,t)})}async _pasteHTML(e,t){const i=tu(e);return i&&this._copyContentCache.get(i)?this._pasteInternal(i,t):this._pasteExternal(e,t)}async _pasteExternal(e,t){var h;const{rowProperties:i,colProperties:r,cellMatrix:s}=this._htmlToUSM.convert(e);if(!s)return!1;const l=this._getPastedRange(s);if(!l)return!1;const c=(h=this._univerInstanceService.getUniverSheetInstance(l.unitId))==null?void 0:h.getSheetBySheetId(l.subUnitId);if(!c)return!1;const d=c==null?void 0:c.getMergeData();return d.length&&d.some(S=>lr(S,l.pastedRange)&&!da(l.pastedRange,S))?(this._errorService.emit(this._localeService.t("clipboard.paste.overlappingMergedCells")),!1):this._pasteUSM({rowProperties:i,colProperties:r,cellMatrix:s},l,t)}async _pasteInternal(e,t){var T,P;const i=this._copyContentCache.get(e),{range:r,matrix:s,unitId:l,subUnitId:c}=i||{};if(!s||!i||!r||!l||!c)return!1;const{mapFunc:d}=lt([r]),u=(T=this._univerInstanceService.getUniverSheetInstance(l))==null?void 0:T.getSheetBySheetId(c),h=new a.ObjectMatrix;s.forValue((A,D,k)=>{const{row:H,col:V}=d(A,D),L=u==null?void 0:u.getComposedCellStyle(H,V),W=Qd(k);if(W.s=L,h.setValue(A,D,W),k.colSpan||k.rowSpan)for(let B=0;B<k.rowSpan;B++)for(let U=0;U<k.colSpan;U++){if(B===0&&U===0)continue;const z=A+B,F=D+U;h.setValue(z,F,{s:L})}});const g=this._getPastedRange(h);if(!g)return!1;const S=(P=this._univerInstanceService.getUniverSheetInstance(g.unitId))==null?void 0:P.getSheetBySheetId(g.subUnitId);if(!S)return!1;const f=S==null?void 0:S.getMergeData();if(f&&f.some(D=>lr(D,g.pastedRange)&&!da(g.pastedRange,D)))return this._errorService.emit(this._localeService.t("clipboard.paste.overlappingMergedCells")),!1;const v=this._univerInstanceService.getUnit(l);if(!v)return!1;const p=v.getSheetBySheetId(c);if(!p)return!1;const C=p.getColumnManager(),_=p.getRowManager(),w=[],E=[];if(r.cols.forEach(A=>{w.push({width:`${C.getColumnWidth(A)}`})}),r.rows.forEach(A=>{E.push({height:`${_.getRowHeight(A)}`})}),i.copyType===xe.CUT){const A=g.pastedRange.rows[0],D=r.rows[r.rows.length-1]-r.rows[0]+A;g.pastedRange.rows=Array.from(new Array(D+1).keys()).slice(A)}const O=this._pasteUSM({cellMatrix:h,colProperties:w,rowProperties:E},g,t,{range:r,unitId:i.unitId,subUnitId:i.subUnitId,copyType:i.copyType,copyId:e});return i.copyType===xe.CUT&&(this._copyContentCache.set(e,{...i,matrix:null}),this._copyMarkId&&this._markSelectionService.removeShape(this._copyMarkId),this._copyMarkId=null),O}_pasteUSM(e,t,i,r){const{rowProperties:s,colProperties:l,cellMatrix:c}=e,{unitId:d,subUnitId:u,pastedRange:h}=t,g=h.cols.length,S=this._clipboardHooks,f=[];if(S.some(T=>{var P;return f.push(T)&&((P=T.onBeforePaste)==null?void 0:P.call(T,{unitId:d,subUnitId:u,range:h}))===!1}))return f.forEach(T=>{var P;return(P=T.onAfterPaste)==null?void 0:P.call(T,!1)}),!1;if(!c)return!1;const p=r?{unitId:r.unitId,subUnitId:r.subUnitId,range:r.range}:null,C={copyType:(r==null?void 0:r.copyType)||xe.COPY,copyId:r==null?void 0:r.copyId,pasteType:i};let _=[],w=[];const E=f.filter(T=>!T.specialPasteInfo&&T.id!==ge.DEFAULT_PASTE||i===T.id);if(E.forEach(T=>{var D,k,H;if(s){const V=(D=T.onPasteRows)==null?void 0:D.call(T,{range:h,unitId:d,subUnitId:u},s,{pasteType:i});V&&(_.push(...V.redos),w.push(...V.undos))}const P=(k=T.onPasteColumns)==null?void 0:k.call(T,{range:h,unitId:d,subUnitId:u},l||new Array(g).map(()=>({})),{pasteType:i});P&&(_.push(...P.redos),w.push(...P.undos));const A=(H=T.onPasteCells)==null?void 0:H.call(T,p,{range:h,unitId:d,subUnitId:u},c,C);A&&(_.push(...A.redos),w.push(...A.undos))}),C.copyType===xe.COPY){const T=this._getSetSelectionOperation(d,u,h,c,i);T&&_.push(T)}_=ar(_),w=ar(w),_=_.flatMap(T=>ca(T,{threshold:2e4,maxCellsPerChunk:1e4})),w=w.flatMap(T=>ca(T,{threshold:2e4,maxCellsPerChunk:1e4})),w.push({id:m.SetWorksheetActiveOperation.id,params:{unitId:t.unitId,subUnitId:t.subUnitId}}),this._logService.log("[SheetClipboardService]","pasting mutations",{undoMutationsInfo:w,redoMutationsInfo:_});const O=_.every(T=>this._commandService.syncExecuteCommand(T.id,T.params));return O&&(this._undoRedoService.pushUndoRedo({unitID:d,undoMutations:w,redoMutations:_}),this.updatePasteOptionsCache({target:{pastedRange:h,unitId:d,subUnitId:u},cellMatrix:c,rowProperties:s,colProperties:l,pasteType:i,source:r}),this.setShowMenu(!0)),E.forEach(T=>{var P;return(P=T.onAfterPaste)==null?void 0:P.call(T,O)}),O}_getSetSelectionOperation(e,t,i,r,s){var O;const l=(O=this._univerInstanceService.getUniverSheetInstance(e))==null?void 0:O.getSheetBySheetId(t);if(!l)return null;const{rows:c,cols:d}=i,u=c[0],h=d[0],g=c[c.length-1],S=d[d.length-1],f={startRow:u,endRow:u,startColumn:h,endColumn:h},v=m.getPrimaryForRange(f,l),p=r.getValue(0,0),C=(p==null?void 0:p.rowSpan)||1,_=(p==null?void 0:p.colSpan)||1;if((s===ge.DEFAULT_PASTE||s===ge.SPECIAL_PASTE_BESIDES_BORDER||s===ge.SPECIAL_PASTE_FORMAT)&&(C>1||_>1)){const T={startRow:u,endRow:u+C-1,startColumn:h,endColumn:h+_-1};v.startRow=T.startRow,v.endRow=T.endRow,v.startColumn=T.startColumn,v.endColumn=T.endColumn,v.isMerged=!0,v.isMergedMainCell=!0}const E={unitId:e,subUnitId:t,selections:[{range:{startRow:u,endRow:g,startColumn:h,endColumn:S},primary:v,style:null}]};return{id:m.SetSelectionsOperation.id,params:E}}_getPastingTarget(){const e=this._univerInstanceService.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),t=e.getActiveSheet(),i=this._selectionManagerService.getCurrentLastSelection();return{unitId:e.getUnitId(),subUnitId:t==null?void 0:t.getSheetId(),selection:i}}_transformPastedData(e,t,i){const r=this._getPastingTarget(),{selection:s,unitId:l,subUnitId:c}=r;if(!c||!s)return null;const d=this._injector.invoke(H=>m.rangeToDiscreteRange(s.range,H,l,c));if(!d)return null;const{ranges:[u],mapFunc:h}=lt([d]),{startRow:g,startColumn:S,endRow:f,endColumn:v}=u,p=f-g+1,C=v-S+1,_=this._univerInstanceService.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),w=_==null?void 0:_.getActiveSheet();if(!w)return null;const O=w.getMergeData().filter(H=>d.rows.includes(H.startRow)&&d.cols.includes(H.startColumn)),T=O[0];let P=0,A=0,D=0,k=0;if(T&&(P=T.startRow,A=T.startColumn,D=T.endRow,k=T.endColumn),p%e===0&&C%t===0)if(O.length>0&&(p!==e||C!==t))if(P===d.rows[0]&&A===d.cols[0]&&D===d.rows[p-1]&&k===d.cols[C-1])if(Mu(i))for(let V=0;V<p;V++)for(let L=0;L<C;L++){const W=i.getValue(V%e,L%t);W&&i.setValue(V,L,W)}else i.forValue((V,L,W)=>{W.s=null,delete W.colSpan,delete W.rowSpan});else for(let H=0;H<p;H++)for(let V=0;V<C;V++){const L=i.getValue(H%e,V%t);L&&i.setValue(H,V,L)}else for(let H=0;H<p;H++)for(let V=0;V<C;V++){const L=i.getValue(H%e,V%t);L&&i.setValue(H,V,L)}else if(O.length>0){const{row:H,col:V}=h(g,S);if(this._topLeftCellsMatch(e,t,{topRow:H,leftCol:V})){const W=this._expandOrShrinkRowsCols(l,c,d,t,e);d.rows=W.rows,d.cols=W.cols}else{if(f>T.endRow||v>T.endColumn)return null;i.forValue((W,B,U)=>{U.s=null,delete U.colSpan,delete U.rowSpan})}}else{const H=this._expandOrShrinkRowsCols(l,c,d,t,e);d.rows=H.rows,d.cols=H.cols}return{pastedRange:d,unitId:l,subUnitId:c}}_getPastedRange(e){var w;const t=this._getPastingTarget(),{selection:i,unitId:r,subUnitId:s}=t;if(!s||!i)return null;const l=this._injector.invoke(E=>m.rangeToDiscreteRange(i.range,E,r,s));if(!l)return null;const{startColumn:c,endColumn:d,startRow:u,endRow:h}=e.getDataRange(),g=h-u+1,S=d-c+1;if(g<=0||S<=0)return null;const f=l.rows.length,v=l.cols.length,p=(w=this._univerInstanceService.getUniverSheetInstance(r))==null?void 0:w.getSheetBySheetId(s);if(!p)return null;const C=p==null?void 0:p.getMergeData();if(f%g===0&&v%S===0&&!(C==null?void 0:C.some(O=>lr(O,l)))){for(let O=0;O<f;O++)for(let T=0;T<v;T++){const P=e.getValue(O%g,T%S);P&&e.setValue(O,T,P)}return{pastedRange:l,unitId:r,subUnitId:s}}const _=this._expandOrShrinkRowsCols(r,s,l,S,g);return l.rows=_.rows,l.cols=_.cols,{pastedRange:l,unitId:r,subUnitId:s}}_expandOrShrinkRowsCols(e,t,i,r,s){const{rows:l,cols:c}=i,d=this._univerInstanceService.getUniverSheetInstance(e),u=d==null?void 0:d.getSheetBySheetId(t);let h,g;if(l.length>=s)h=l.slice(0,s);else{h=l.slice(0);let S=l[l.length-1]+1;for(;h.length<s;)u.getRowFiltered(S)||h.push(S),S++}if(c.length>=r)g=c.slice(0,r);else{g=c.slice(0);let S=c[c.length-1]+1;for(;g.length<r;)g.push(S),S++}return{rows:h,cols:g}}_topLeftCellsMatch(e,t,i){const r=this._univerInstanceService.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),s=r==null?void 0:r.getActiveSheet();if(!s)return!1;const{topRow:l,leftCol:c}=i,d=yu(l+e-1,c,c+t-1,s),u=Ru(c+t-1,l,l+e-1,s);return!d&&!u}removeMarkSelection(){this._copyMarkId&&(this._markSelectionService.removeShape(this._copyMarkId),this._copyMarkId=null)}_initUnitDisposed(){this.disposeWithMe(this._univerInstanceService.getTypeOfUnitDisposed$(a.UniverInstanceType.UNIVER_SHEET).subscribe(e=>{e&&this.copyContentCache().clearWithUnitId(e.getUnitId())}))}disposePasteOptionsCache(){this.setShowMenu(!1),this.updatePasteOptionsCache(null)}},y.SheetClipboardService=bu([Me(0,a.ILogService),Me(1,a.IUniverInstanceService),Me(2,a.Inject(m.SheetsSelectionsService)),Me(3,I.IClipboardInterfaceService),Me(4,a.IUndoRedoService),Me(5,a.ICommandService),Me(6,yt),Me(7,I.INotificationService),Me(8,I.IPlatformService),Me(9,M.IRenderManagerService),Me(10,a.Inject(a.ThemeService)),Me(11,a.Inject(a.LocaleService)),Me(12,a.Inject(a.ErrorService)),Me(13,a.Inject(a.Injector))],y.SheetClipboardService);function ua(n){let o="";const e=n.getLength();return n.forRow((t,i)=>{const r=[];i.forEach(s=>{const l=n.getValue(t,s);if(l){const c=Tu(l);r.push(c)}}),o+=r.join("	"),t!==e-1&&(o+=`
`)}),o}function Tu(n){return a.isNotNullOrUndefined(n.displayV)?n.displayV:a.extractPureTextFromCell(n)}function yu(n,o,e,t){return t.getMergeData().some(i=>i.startRow<=n&&n<i.endRow&&o<=i.startColumn&&i.startColumn<=e)}function Ru(n,o,e,t){return t.getMergeData().some(i=>i.startColumn<=n&&n<i.endColumn&&o<=i.startRow&&i.startRow<=e)}function Mu(n){let o=0;return n.forValue((e,t,i)=>{if(i&&o++,o>1)return!1}),o>1}const cr=998,Ve={id:I.CopyCommand.id,name:"sheet.command.copy",type:a.CommandType.COMMAND,multi:!0,priority:cr,preconditions:tr,handler:async n=>n.get(ke).copy()},ht={id:I.CutCommand.id,name:"sheet.command.cut",type:a.CommandType.COMMAND,multi:!0,priority:cr,preconditions:tr,handler:async n=>n.get(ke).cut()},We={id:I.PasteCommand.id,type:a.CommandType.COMMAND,multi:!0,name:"sheet.command.paste",priority:cr,preconditions:tr,handler:async(n,o)=>{const t=await n.get(I.IClipboardInterfaceService).read(),i=n.get(ke);return t.length!==0?i.paste(t[0],o==null?void 0:o.value):!1}},Gi={id:I.SheetPasteShortKeyCommandName,type:a.CommandType.COMMAND,handler:async(n,o)=>{const e=n.get(ke),{htmlContent:t,textContent:i,files:r}=o;return e.legacyPaste(t,i,r),!0}},sn={id:"sheet.command.paste-value",type:a.CommandType.COMMAND,handler:async n=>n.get(a.ICommandService).executeCommand(We.id,{value:ge.SPECIAL_PASTE_VALUE})},an={id:"sheet.command.paste-format",type:a.CommandType.COMMAND,handler:async n=>n.get(a.ICommandService).executeCommand(We.id,{value:ge.SPECIAL_PASTE_FORMAT})},Rt={id:"sheet.command.paste-col-width",type:a.CommandType.COMMAND,handler:async n=>n.get(a.ICommandService).executeCommand(We.id,{value:ge.SPECIAL_PASTE_COL_WIDTH})},ln={id:"sheet.command.paste-besides-border",type:a.CommandType.COMMAND,handler:async n=>n.get(a.ICommandService).executeCommand(We.id,{value:ge.SPECIAL_PASTE_BESIDES_BORDER})},ha={id:"sheet.command.optional-paste",type:a.CommandType.COMMAND,handler:async(n,{type:o})=>n.get(ke).rePasteWithPasteType(o)},cn={type:a.CommandType.COMMAND,id:"sheet.command.delete-range-move-left-confirm",handler:async n=>{const o=n.get(I.IConfirmService),e=n.get(a.ICommandService),t=n.get(a.LocaleService),i=n.get(m.SheetsSelectionsService),r=n.get(a.IUniverInstanceService),s=i.getCurrentSelections();if(!s)return!1;const l=m.getSheetCommandTarget(r);if(!l)return!1;const{worksheet:c}=l;let d=s[0].range;if(!d)return!1;d={...d,endColumn:c.getColumnCount()-1};const u=S=>S.endRow-S.startRow;return!c.getMergeData().find(S=>{const f=a.Rectangle.getIntersects(S,d);return f?u(S)>u(f):!1})||await o.confirm({id:cn.id,title:{title:t.t("merge.confirm.warning")},children:{title:t.t("merge.confirm.dismantleMergeCellWarning")},cancelText:t.t("button.cancel"),confirmText:t.t("button.confirm")})?e.executeCommand(m.DeleteRangeMoveLeftCommand.id):!0}},Mt={type:a.CommandType.COMMAND,id:"sheet.command.delete-range-move-up-confirm",handler:async n=>{const o=n.get(I.IConfirmService),e=n.get(a.ICommandService),t=n.get(a.LocaleService),i=n.get(m.SheetsSelectionsService),r=n.get(a.IUniverInstanceService),s=i.getCurrentSelections();if(!s)return!1;const l=m.getSheetCommandTarget(r);if(!l)return!1;const{worksheet:c}=l;let d=s[0].range;if(!d)return!1;d={...d,endRow:c.getRowCount()-1};for(let S=d.startRow;S<=d.endRow;S++)if(c.getRowFiltered(S)&&await o.confirm({id:Mt.id,title:{title:t.t("filter.confirm.error")},children:{title:t.t("filter.confirm.notAllowedToInsertRange")},confirmText:t.t("button.confirm")}))return!1;const u=S=>S.endColumn-S.startColumn;return!c.getMergeData().find(S=>{const f=a.Rectangle.getIntersects(S,d);return f?u(S)>u(f):!1})||await o.confirm({id:Mt.id,title:{title:t.t("merge.confirm.warning")},children:{title:t.t("merge.confirm.dismantleMergeCellWarning")},cancelText:t.t("button.cancel"),confirmText:t.t("button.confirm")})?e.executeCommand(m.DeleteRangeMoveUpCommand.id):!0}};var Ki=(n=>(n.MergeAll="mergeAll",n.MergeVertical="mergeVertical",n.MergeHorizontal="mergeHorizontal",n))(Ki||{});function mt(n,o,e,t,i=!0,r=1,s=!0){let l={...n};t==null&&(t={startRow:0,endRow:e.getRowCount()-1,startColumn:0,endColumn:e.getColumnCount()-1});let c;switch(o){case a.Direction.UP:for(c=n.startRow-r;c>-1&&!e.getRowVisible(c);)c-=1;c>=t.startRow?(l.startRow=c,l.endRow=c):s&&(l.startRow=t.endRow,l.endRow=t.endRow,i&&(l=mt(l,a.Direction.LEFT,e,t,!1)));break;case a.Direction.DOWN:for(c=n.endRow+r;c<e.getRowCount()&&!e.getRowVisible(c);)c+=1;c<=t.endRow?(l.startRow=c,l.endRow=c):s&&(l.startRow=t.startRow,l.endRow=t.startRow,i&&(l=mt(l,a.Direction.RIGHT,e,t,!1)));break;case a.Direction.LEFT:for(c=n.startColumn-r;c>-1&&!e.getColVisible(c);)c-=1;c>=t.startColumn?(l.startColumn=c,l.endColumn=c):s&&(l.startColumn=t.endColumn,l.endColumn=t.endColumn,i&&(l=mt(l,a.Direction.UP,e,t,!1)));break;case a.Direction.RIGHT:for(c=n.endColumn+r;c<e.getColumnCount()&&!e.getColVisible(c);)c+=1;c<=t.endColumn?(l.startColumn=c,l.endColumn=c):s&&(l.startColumn=t.startColumn,l.endColumn=t.startColumn,i&&(l=mt(l,a.Direction.DOWN,e,t,!1)));break}return l}function dr(n,o,e){const t={...n},{startRow:i,startColumn:r,endRow:s,endColumn:l}=$n(n,o,e);let c=ei(e,i,r,s,l).hasValue,d=!0,u=!0;for(;u;){if(a.Direction.UP===o){let h=t.startRow-1;for(;h>-1&&!e.getRowVisible(h);)h-=1;if(h===-1){u=!1;break}const{hasValue:g,matrix:S}=ei(e,h,t.startColumn,h,t.endColumn);if(c&&!g&&!d){u=!1;break}else{if(S.getLength()!==0){let f=h;S.forValue(v=>{f=Math.min(v,f)}),t.startRow=f}else t.startRow=h;if(t.endRow=t.startRow,!c&&g){u=!1;break}c=g,d=!1}}if(a.Direction.DOWN===o){let h=t.endRow+1;for(;h<e.getRowCount()&&!e.getRowVisible(h);)h+=1;if(h===e.getRowCount()){u=!1;break}const{hasValue:g,matrix:S}=ei(e,h,t.startColumn,h,t.endColumn);if(c&&!g&&!d){u=!1;break}else{if(S.getLength()!==0){let f=h;S.forValue((v,p,C)=>{f=Math.max(v+(C.rowSpan||1)-1,f)}),t.endRow=f}else t.endRow=h;if(t.startRow=t.endRow,!c&&g){u=!1;break}c=g,d=!1}}if(a.Direction.LEFT===o){let h=t.startColumn-1;for(;h>-1&&!e.getColVisible(h);)h-=1;if(h===-1){u=!1;break}const{hasValue:g,matrix:S}=ei(e,t.startRow,h,t.endRow,h);if(c&&!g&&!d){u=!1;break}else{if(S.getLength()!==0){let f=h;S.forValue((v,p)=>{f=Math.min(p,f)}),t.startColumn=f}else t.startColumn=h;if(t.endColumn=t.startColumn,!c&&g){u=!1;break}c=g,d=!1}}if(a.Direction.RIGHT===o){let h=t.endColumn+1;for(;h<e.getColumnCount()&&!e.getColVisible(h);)h+=1;if(h===e.getColumnCount()){u=!1;break}const{hasValue:g,matrix:S}=ei(e,t.startRow,h,t.endRow,h);if(c&&!g&&!d){u=!1;break}else{if(S.getLength()!==0){let f=h;S.forValue((v,p,C)=>{f=Math.max(p+(C.colSpan||1)-1,f)}),t.endColumn=f}else t.endColumn=h;if(t.startColumn=t.endColumn,!c&&g){u=!1;break}c=g,d=!1}}}return m.alignToMergedCellsBorders(t,e,!0)}function ma(n,o,e){return mt(n,o,e,void 0,!1,1,!1)}function Pu(n,o,e){const t=dr(n,o,e);return m.alignToMergedCellsBorders(a.Rectangle.union(t,n),e,!0)}function Ou(n,o,e){const t=ma(n,o,e),i={startRow:Math.min(n.startRow,t.startRow),startColumn:Math.min(n.startColumn,t.startColumn),endRow:Math.max(n.endRow,t.endRow),endColumn:Math.max(n.endColumn,t.endColumn)};return m.alignToMergedCellsBorders(a.Rectangle.union(n,i),e)}function Au(n,o,e,t){const i=a.getReverseDirection(e),r=dr($n(n,i,t),e,t);return e===a.Direction.UP&&r.startRow<=n.startRow?m.alignToMergedCellsBorders({...o,startColumn:n.startColumn,endColumn:n.endColumn},t,!0):e===a.Direction.DOWN&&r.endRow>=n.endRow?m.alignToMergedCellsBorders({...o,startColumn:n.startColumn,endColumn:n.endColumn},t,!0):e===a.Direction.LEFT&&r.startColumn<=n.startColumn?m.alignToMergedCellsBorders({...o,startRow:n.startRow,endRow:n.endRow},t,!0):e===a.Direction.RIGHT&&r.endColumn>=n.endColumn?m.alignToMergedCellsBorders({...o,startRow:n.startRow,endRow:n.endRow},t,!0):a.Rectangle.union(a.Rectangle.clone(o),r)}function Du(n,o,e){const t=a.getReverseDirection(o),i=$n(n,t,e),r=$n(n,o,e),s=ma(i,o,e);return m.alignToMergedCellsBorders(a.Rectangle.union(r,s),e,!1)}function ga(n){return{startRow:0,startColumn:0,endRow:n.getRowCount()-1,endColumn:n.getColumnCount()-1,rangeType:a.RANGE_TYPE.ALL}}function $n(n,o,e){let t;switch(o){case a.Direction.UP:t={startRow:n.startRow,startColumn:n.startColumn,endRow:n.startRow,endColumn:n.endColumn,rangeType:a.RANGE_TYPE.NORMAL};break;case a.Direction.DOWN:t={startRow:n.endRow,startColumn:n.startColumn,endRow:n.endRow,endColumn:n.endColumn,rangeType:a.RANGE_TYPE.NORMAL};break;case a.Direction.LEFT:t={startRow:n.startRow,startColumn:n.startColumn,endRow:n.endRow,endColumn:n.startColumn,rangeType:a.RANGE_TYPE.NORMAL};break;case a.Direction.RIGHT:t={startRow:n.startRow,startColumn:n.endColumn,endRow:n.endRow,endColumn:n.endColumn,rangeType:a.RANGE_TYPE.NORMAL};break;default:throw new Error("Invalid direction")}return m.alignToMergedCellsBorders(t,e,!1)}function ei(n,o,e,t,i){let r=!1;const s=n.getMatrixWithMergedCells(o,e,t,i).forValue((l,c,d)=>{if(ku(d))return r=!0,!1});return{hasValue:r,matrix:s}}function ur(n,o,e){const t=a.Rectangle.clone(n);if(o==null)return t;switch(e){case a.Direction.UP:case a.Direction.DOWN:t.startColumn=t.endColumn=o.actualColumn;break;case a.Direction.LEFT:case a.Direction.RIGHT:t.startRow=t.endRow=o.actualRow;break}return t}function Nu(n,o,e){var l,c,d,u;const{primary:t,range:i}=n,r=a.Rectangle.clone(i);switch(o){case a.Direction.UP:case a.Direction.DOWN:r.startRow=(l=t==null?void 0:t.startRow)!=null?l:i.startRow,r.endRow=(c=t==null?void 0:t.endRow)!=null?c:i.startRow;break;case a.Direction.LEFT:case a.Direction.RIGHT:r.startColumn=(d=t==null?void 0:t.startColumn)!=null?d:i.startColumn,r.endColumn=(u=t==null?void 0:t.endColumn)!=null?u:i.startColumn;break}const s=$n(r,o,e);switch(o){case a.Direction.DOWN:return i.startRow<s.startRow;case a.Direction.UP:return i.endRow>s.endRow;case a.Direction.LEFT:return s.endColumn<i.endColumn;case a.Direction.RIGHT:return s.startColumn>i.startColumn}}function Sa(n,o){let e=n[0].startRow,t=n[0].endRow;n.forEach(r=>{const{startRow:s,endRow:l}=r;e=Math.min(e,s),t=Math.max(t,l)});const i=new Array(t-e+1).fill(!1);return o.forEach(r=>{const{startRow:s,endRow:l}=r;for(let c=Math.max(s,e);c<=Math.min(l,t);c++)i[c-e]=!0}),n.every(r=>{const{startRow:s,endRow:l}=r;for(let c=s;c<=l;c++)if(!i[c-e])return!1;return!0})}function fa(n,o){let e=n[0].startColumn,t=n[0].endColumn;n.forEach(r=>{const{startColumn:s,endColumn:l}=r;e=Math.min(e,s),t=Math.max(t,l)});const i=new Array(t-e+1).fill(!1);return o.forEach(r=>{const{startColumn:s,endColumn:l}=r;for(let c=Math.max(s,e);c<=Math.min(l,t);c++)i[c-e]=!0}),n.every(r=>{const{startColumn:s,endColumn:l}=r;for(let c=s;c<=l;c++)if(!i[c-e])return!1;return!0})}function hr(n,o){return o?n==="mergeAll"?o.filter(e=>!(e.startRow===e.endRow&&e.startColumn===e.endColumn)):n==="mergeVertical"?o.filter(e=>e.startRow!==e.endRow):n==="mergeHorizontal"?o.filter(e=>e.startColumn!==e.endColumn):o:null}function ku(n){return n.v!==void 0&&n.v!==null&&n.v!==""||n.p!==void 0}const ti={id:"sheet.command.hide-row-confirm",type:a.CommandType.COMMAND,handler:async n=>{var c;const e=(c=n.get(m.SheetsSelectionsService).getCurrentSelections())==null?void 0:c.map(d=>d.range);if(!(e!=null&&e.length))return!1;const t=n.get(a.ICommandService),i=n.get(a.IUniverInstanceService),r=m.getSheetCommandTarget(i);if(!r)return!1;const{worksheet:s}=r,l=s.getVisibleRows();if(Sa(l,e)){const d=n.get(I.IConfirmService),u=n.get(a.LocaleService);return await d.confirm({id:"sheet.confirm.hide-row",title:{title:u.t("info.problem")},children:{title:u.t("rightClick.hideAllRowsAlert")},cancelText:u.t("button.cancel"),confirmText:u.t("button.confirm")}),!1}return await t.executeCommand(m.SetRowHiddenCommand.id),!0}},ni={id:"sheet.command.hide-col-confirm",type:a.CommandType.COMMAND,handler:async n=>{var c;const e=(c=n.get(m.SheetsSelectionsService).getCurrentSelections())==null?void 0:c.map(d=>d.range);if(!(e!=null&&e.length))return!1;const t=n.get(a.ICommandService),i=n.get(a.IUniverInstanceService),r=m.getSheetCommandTarget(i);if(!r)return!1;const{worksheet:s}=r,l=s.getVisibleCols();if(fa(l,e)){const d=n.get(I.IConfirmService),u=n.get(a.LocaleService);return await d.confirm({id:"sheet.confirm.hide-col",title:{title:u.t("info.problem")},children:{title:u.t("rightClick.hideAllColumnsAlert")},cancelText:u.t("button.cancel"),confirmText:u.t("button.confirm")}),!1}return await t.executeCommand(m.SetColHiddenCommand.id),!0}};function Pt(n){var d;const o=n.get(a.IUniverInstanceService),e=n.get(Ce.DocSelectionManagerService),t=o.getUnit(a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY),i=e.getActiveTextRange();if(t==null||i==null)return null;const r=(d=t.getBody())==null?void 0:d.textRuns;if(r==null)return;const{startOffset:s,endOffset:l}=i;return r.find(({st:u,ed:h})=>s>=u&&l<=h)}const Ot={type:a.CommandType.COMMAND,id:"sheet.command.set-range-bold",handler:async n=>{const o=n.get(a.ICommandService);return n.get(a.IContextService).getContextValue(a.EDITOR_ACTIVATED)?o.executeCommand(q.SetInlineFormatBoldCommand.id):o.executeCommand(m.SetBoldCommand.id)}},At={type:a.CommandType.COMMAND,id:"sheet.command.set-range-italic",handler:async n=>{const o=n.get(a.ICommandService);return n.get(a.IContextService).getContextValue(a.EDITOR_ACTIVATED)?o.executeCommand(q.SetInlineFormatItalicCommand.id):o.executeCommand(m.SetItalicCommand.id)}},Dt={type:a.CommandType.COMMAND,id:"sheet.command.set-range-underline",handler:async n=>{const o=n.get(a.ICommandService);return n.get(a.IContextService).getContextValue(a.EDITOR_ACTIVATED)?o.executeCommand(q.SetInlineFormatUnderlineCommand.id):o.executeCommand(m.SetUnderlineCommand.id)}},Nt={type:a.CommandType.COMMAND,id:"sheet.command.set-range-stroke",handler:async n=>{const o=n.get(a.ICommandService);return n.get(a.IContextService).getContextValue(a.EDITOR_ACTIVATED)?o.executeCommand(q.SetInlineFormatStrikethroughCommand.id):o.executeCommand(m.SetStrikeThroughCommand.id)}},mr={type:a.CommandType.COMMAND,id:"sheet.command.set-range-subscript",handler:async n=>{const o=n.get(a.ICommandService);return n.get(a.IContextService).getContextValue(a.EDITOR_ACTIVATED)?o.executeCommand(q.SetInlineFormatSubscriptCommand.id):!1}},gr={type:a.CommandType.COMMAND,id:"sheet.command.set-range-superscript",handler:async n=>{const o=n.get(a.ICommandService);return n.get(a.IContextService).getContextValue(a.EDITOR_ACTIVATED)?o.executeCommand(q.SetInlineFormatSuperscriptCommand.id):!1}},ii={type:a.CommandType.COMMAND,id:"sheet.command.set-range-fontsize",handler:async(n,o)=>{const e=n.get(a.ICommandService);return n.get(a.IContextService).getContextValue(a.EDITOR_ACTIVATED)?e.executeCommand(q.SetInlineFormatFontSizeCommand.id,o):e.executeCommand(m.SetFontSizeCommand.id,o)}},qi={type:a.CommandType.COMMAND,id:"sheet.command.set-range-font-increase",handler:async n=>{var h,g,S,f;const o=n.get(a.IUniverInstanceService),e=n.get(a.ICommandService),i=n.get(a.IContextService).getContextValue(a.EDITOR_ACTIVATED),r=n.get(m.SheetsSelectionsService),s=a.DEFAULT_STYLES.fs,c=o.getCurrentUnitOfType(a.UniverInstanceType.UNIVER_SHEET).getActiveSheet(),d=(h=r.getCurrentLastSelection())==null?void 0:h.primary,u={value:s};if(i){const v=Pt(n);if(v!=null){const p=(S=(g=v.ts)==null?void 0:g.fs)!=null?S:s;u.value=p>=400?400:p+1}return e.executeCommand(q.SetInlineFormatFontSizeCommand.id,u)}if(d!=null){const p=(f=c.getComposedCellStyle(d.startRow,d.startColumn).fs)!=null?f:s;return u.value=p>=400?400:p+1,e.executeCommand(m.SetFontSizeCommand.id,u)}return!1}},Qi={type:a.CommandType.COMMAND,id:"sheet.command.set-range-font-decrease",handler:async n=>{var h,g,S,f;const o=n.get(a.IUniverInstanceService),e=n.get(a.ICommandService),i=n.get(a.IContextService).getContextValue(a.EDITOR_ACTIVATED),r=n.get(m.SheetsSelectionsService),s=a.DEFAULT_STYLES.fs,c=o.getCurrentUnitOfType(a.UniverInstanceType.UNIVER_SHEET).getActiveSheet(),d=(h=r.getCurrentLastSelection())==null?void 0:h.primary,u={value:s};if(i){const v=Pt(n);if(v!=null){const p=(S=(g=v.ts)==null?void 0:g.fs)!=null?S:s;u.value=p<=6?6:p-1}return e.executeCommand(q.SetInlineFormatFontSizeCommand.id,u)}if(d!=null){const p=(f=c.getComposedCellStyle(d.startRow,d.startColumn).fs)!=null?f:s;return u.value=p<=6?6:p-1,e.executeCommand(m.SetFontSizeCommand.id,u)}return!1}},dn={type:a.CommandType.COMMAND,id:"sheet.command.set-range-font-family",handler:async(n,o)=>{const e=n.get(a.ICommandService);return n.get(a.IContextService).getContextValue(a.EDITOR_ACTIVATED)?e.executeCommand(q.SetInlineFormatFontFamilyCommand.id,o):e.executeCommand(m.SetFontFamilyCommand.id,o)}},un={type:a.CommandType.COMMAND,id:"sheet.command.set-range-text-color",handler:async(n,o)=>{const e=n.get(a.ICommandService);return n.get(a.IContextService).getContextValue(a.EDITOR_ACTIVATED)?e.executeCommand(q.SetInlineFormatTextColorCommand.id,o):e.executeCommand(m.SetTextColorCommand.id,o)}},Ji={type:a.CommandType.COMMAND,id:"sheet.command.reset-range-text-color",handler:async n=>{const o=n.get(a.ICommandService),t=n.get(a.IContextService).getContextValue(a.EDITOR_ACTIVATED),i=n.get(a.ThemeService);return t?o.executeCommand(q.SetInlineFormatTextColorCommand.id,{value:null}):o.executeCommand(m.SetTextColorCommand.id,{value:i.getColorFromTheme("gray.900")})}},kt={type:a.CommandType.COMMAND,id:"sheet.command.insert-range-move-down-confirm",handler:async n=>{const o=n.get(I.IConfirmService),e=n.get(a.ICommandService),t=n.get(a.LocaleService),i=n.get(m.SheetsSelectionsService),r=n.get(a.IUniverInstanceService),s=i.getCurrentSelections();if(!s)return!1;const l=m.getSheetCommandTarget(r);if(!l)return!1;const{worksheet:c}=l;let d=s[0].range;if(!d)return!1;d={...d,endRow:c.getRowCount()-1};for(let S=d.startRow;S<=d.endRow;S++)if(c.getRowFiltered(S)&&await o.confirm({id:kt.id,title:{title:t.t("filter.confirm.error")},children:{title:t.t("filter.confirm.notAllowedToInsertRange")},confirmText:t.t("button.confirm")}))return!1;const u=S=>S.endColumn-S.startColumn;return!c.getMergeData().find(S=>{const f=a.Rectangle.getIntersects(S,d);return f?u(S)>u(f):!1})||await o.confirm({id:kt.id,title:{title:t.t("merge.confirm.warning")},children:{title:t.t("merge.confirm.dismantleMergeCellWarning")},cancelText:t.t("button.cancel"),confirmText:t.t("button.confirm")})?e.executeCommand(m.InsertRangeMoveDownCommand.id):!0}},hn={type:a.CommandType.COMMAND,id:"sheet.command.insert-range-move-right-confirm",handler:async n=>{const o=n.get(I.IConfirmService),e=n.get(a.ICommandService),t=n.get(a.LocaleService),i=n.get(m.SheetsSelectionsService),r=n.get(a.IUniverInstanceService),s=i.getCurrentSelections();if(!s)return!1;const l=m.getSheetCommandTarget(r);if(!l)return!1;const{worksheet:c}=l;let d=s[0].range;if(!d)return!1;d={...d,endColumn:c.getColumnCount()-1};const u=S=>S.endRow-S.startRow;return!c.getMergeData().find(S=>{const f=a.Rectangle.getIntersects(S,d);return f?u(S)>u(f):!1})||await o.confirm({id:hn.id,title:{title:t.t("merge.confirm.warning")},children:{title:t.t("merge.confirm.dismantleMergeCellWarning")},cancelText:t.t("button.cancel"),confirmText:t.t("button.confirm")})?e.executeCommand(m.InsertRangeMoveRightCommand.id):!0}};var va=(n=>(n[n.UNIVER_UNKNOWN=0]="UNIVER_UNKNOWN",n[n.UNIVER_DOC=1]="UNIVER_DOC",n[n.UNIVER_SHEET=2]="UNIVER_SHEET",n[n.UNIVER_SLIDE=3]="UNIVER_SLIDE",n[n.UNIVER_PROJECT=4]="UNIVER_PROJECT",n[n.UNRECOGNIZED=-1]="UNRECOGNIZED",n))(va||{}),$=(n=>(n[n.View=0]="View",n[n.Edit=1]="Edit",n[n.ManageCollaborator=2]="ManageCollaborator",n[n.Print=3]="Print",n[n.Duplicate=4]="Duplicate",n[n.Comment=5]="Comment",n[n.Copy=6]="Copy",n[n.Share=7]="Share",n[n.Export=8]="Export",n[n.MoveWorksheet=9]="MoveWorksheet",n[n.DeleteWorksheet=10]="DeleteWorksheet",n[n.HideWorksheet=11]="HideWorksheet",n[n.RenameWorksheet=12]="RenameWorksheet",n[n.CreateWorksheet=13]="CreateWorksheet",n[n.SetWorksheetStyle=14]="SetWorksheetStyle",n[n.EditWorksheetCell=15]="EditWorksheetCell",n[n.InsertHyperlink=16]="InsertHyperlink",n[n.Sort=17]="Sort",n[n.Filter=18]="Filter",n[n.PivotTable=19]="PivotTable",n[n.FloatImg=20]="FloatImg",n[n.History=21]="History",n[n.RwHgtClWdt=22]="RwHgtClWdt",n[n.ViemRwHgtClWdt=23]="ViemRwHgtClWdt",n[n.ViewFilter=24]="ViewFilter",n[n.MoveSheet=25]="MoveSheet",n[n.DeleteSheet=26]="DeleteSheet",n[n.HideSheet=27]="HideSheet",n[n.CopySheet=28]="CopySheet",n[n.RenameSheet=29]="RenameSheet",n[n.CreateSheet=30]="CreateSheet",n[n.SelectProtectedCells=31]="SelectProtectedCells",n[n.SelectUnProtectedCells=32]="SelectUnProtectedCells",n[n.SetCellStyle=33]="SetCellStyle",n[n.SetCellValue=34]="SetCellValue",n[n.SetRowStyle=35]="SetRowStyle",n[n.SetColumnStyle=36]="SetColumnStyle",n[n.InsertRow=37]="InsertRow",n[n.InsertColumn=38]="InsertColumn",n[n.DeleteRow=39]="DeleteRow",n[n.DeleteColumn=40]="DeleteColumn",n[n.EditExtraObject=41]="EditExtraObject",n[n.Delete=42]="Delete",n[n.RecoverHistory=43]="RecoverHistory",n[n.ViewHistory=44]="ViewHistory",n[n.CreatePermissionObject=45]="CreatePermissionObject",n[n.UNRECOGNIZED=-1]="UNRECOGNIZED",n))($||{}),Oe=(n=>(n[n.Reader=0]="Reader",n[n.Editor=1]="Editor",n[n.Owner=2]="Owner",n[n.UNRECOGNIZED=-1]="UNRECOGNIZED",n))(Oe||{}),Je=(n=>(n[n.Unkonwn=0]="Unkonwn",n[n.Workbook=1]="Workbook",n[n.Worksheet=2]="Worksheet",n[n.SelectRange=3]="SelectRange",n[n.Document=4]="Document",n[n.Slide=5]="Slide",n[n.UNRECOGNIZED=-1]="UNRECOGNIZED",n))(Je||{}),Ue=(n=>(n[n.SomeCollaborator=0]="SomeCollaborator",n[n.AllCollaborator=1]="AllCollaborator",n[n.OneSelf=2]="OneSelf",n[n.UNRECOGNIZED=-1]="UNRECOGNIZED",n))(Ue||{});const oi="UNIVER_SHEET_PERMISSION_PANEL",ri="UNIVER_SHEET_PERMISSION_USER_PART",pa="UNIVER_SHEET_PERMISSION_USER_DIALOG",Ca="UNIVER_SHEET_PERMISSION_DIALOG",$i="UNIVER_SHEET_PERMISSION_USER_DIALOG_ID",eo="UNIVER_SHEET_PERMISSION_DIALOG_ID",to={[$.Copy]:"Copy",[$.SetCellStyle]:"SetCellStyle",[$.SetCellValue]:"SetCellValue",[$.SetRowStyle]:"SetRowStyle",[$.SetColumnStyle]:"SetColumnStyle",[$.InsertRow]:"InsertRow",[$.InsertColumn]:"InsertColumn",[$.InsertHyperlink]:"InsertHyperlink",[$.DeleteRow]:"DeleteRow",[$.DeleteColumn]:"DeleteColumn",[$.Sort]:"Sort",[$.Filter]:"Filter",[$.PivotTable]:"PivotTable",[$.EditExtraObject]:"EditExtraObject"},Hu=[$.Copy,$.SetCellStyle,$.SetCellValue,$.SetRowStyle,$.SetColumnStyle,$.InsertRow,$.InsertColumn,$.InsertHyperlink,$.DeleteRow,$.DeleteColumn,$.Sort,$.Filter,$.PivotTable,$.EditExtraObject,$.View],Ia="sheet-permission-menu-icon",Vu="sheet-permission-delete-icon",Wu="sheet-permission-edit-icon",Lu="sheet-permission-check-icon",_a="sheet-permission-lock-icon",xu={unitId:"",subUnitId:"",permissionId:"",unitType:m.UnitObject.SelectRange,id:"",ranges:[],viewState:m.ViewStateEnum.OthersCanView,editState:m.EditStateEnum.OnlyMe};class Ht{constructor(){R(this,"_rule",xu);R(this,"_visible",!1)}setVisible(o){this._visible=o}getVisible(){return this._visible}reset(){this.setVisible(!1)}}class gt{constructor(){R(this,"_userList",[]);R(this,"_userList$",new N.BehaviorSubject(this._userList));R(this,"userList$",this._userList$.asObservable());R(this,"_oldCollaboratorList",[]);R(this,"_selectUserList",[]);R(this,"_selectUserList$",new N.BehaviorSubject(this._selectUserList));R(this,"selectUserList$",this._selectUserList$.asObservable())}get userList(){return this._userList}setCanEditUserList(o){this._userList=o,this._userList$.next(o)}reset(){this._userList=[],this._oldCollaboratorList=[],this._selectUserList=[],this._selectUserList$.next([])}get oldCollaboratorList(){return this._oldCollaboratorList}setOldCollaboratorList(o){this._oldCollaboratorList=o}get selectUserList(){return this._selectUserList}setSelectUserList(o){this._selectUserList=o,this._selectUserList$.next(o)}}const Be={type:a.CommandType.OPERATION,id:"sheet-permission.operation.openPanel",async handler(n,o={}){const e=n.get(I.ISidebarService),t=n.get(Ht),i=n.get(gt),{showDetail:r=!0,fromSheetBar:s=!1,rule:l,oldRule:c}=o,d={header:{title:"permission.panel.title"},children:{label:oi,showDetail:r,fromSheetBar:s,rule:l,oldRule:c},width:330,onClose:()=>{t.reset(),i.reset()}};return t.setVisible(!0),e.open(d),!0}},si={type:a.CommandType.COMMAND,id:"sheet.command.add-range-protection-from-toolbar",async handler(n){return await n.get(a.ICommandService).executeCommand(Be.id,{showDetail:!0}),!0}},Vt={type:a.CommandType.COMMAND,id:"sheet.command.add-range-protection-from-context-menu",async handler(n){return await n.get(a.ICommandService).executeCommand(Be.id,{showDetail:!0}),!0}},Wt={type:a.CommandType.COMMAND,id:"sheet.command.view-sheet-permission-from-context-menu",async handler(n){return await n.get(a.ICommandService).executeCommand(Be.id,{showDetail:!1}),!0}},ai={type:a.CommandType.COMMAND,id:"sheet.command.add-range-protection-from-sheet-bar",async handler(n){return await n.get(a.ICommandService).executeCommand(Be.id,{fromSheetBar:!0,showDetail:!0}),!0}},li={type:a.CommandType.COMMAND,id:"sheet.command.view-sheet-permission-from-sheet-bar",async handler(n){return await n.get(a.ICommandService).executeCommand(Be.id,{showDetail:!1}),!0}},Lt={type:a.CommandType.COMMAND,id:"sheet.command.delete-range-protection-from-context-menu",async handler(n){var h;const o=n.get(a.ICommandService),e=n.get(a.IUniverInstanceService),t=n.get(a.IUndoRedoService),i=n.get(m.SheetsSelectionsService),r=n.get(m.WorksheetProtectionRuleModel),s=e.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),l=s.getActiveSheet(),c=s.getUnitId(),d=l.getSheetId(),u=r.getRule(c,d);if(u!=null&&u.permissionId)return o.executeCommand(m.DeleteWorksheetProtectionCommand.id,{unitId:c,subUnitId:d,rule:u});{const g=(h=i.getCurrentLastSelection())==null?void 0:h.range;if(!g)return!1;const v=n.get(m.RangeProtectionRuleModel).getSubunitRuleList(c,d).find(p=>p.ranges.some(C=>a.Rectangle.intersects(C,g)));if(v){const p={unitId:c,subUnitId:d,ruleIds:[v.id]};return await o.executeCommand(m.DeleteRangeProtectionMutation.id,p)&&t.pushUndoRedo({unitID:c,redoMutations:[{id:m.DeleteRangeProtectionMutation.id,params:p}],undoMutations:[{id:m.AddRangeProtectionMutation.id,params:{unitId:c,subUnitId:d,rules:[v]}}]}),!0}else return!1}}},xt={type:a.CommandType.COMMAND,id:"sheet.command.set-range-protection-from-context-menu",async handler(n){var u;const o=n.get(a.ICommandService),e=n.get(a.IUniverInstanceService),t=n.get(m.SheetsSelectionsService),i=n.get(m.WorksheetProtectionRuleModel),r=e.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),s=r.getActiveSheet(),l=r.getUnitId(),c=s.getSheetId(),d=i.getRule(l,c);if(d!=null&&d.permissionId){const h={...d,unitId:l,subUnitId:c,ranges:[]};return await o.executeCommand(Be.id,{showDetail:!0,rule:a.Tools.deepClone(h),oldRule:a.Tools.deepClone(h)}),!0}else{const h=(u=t.getCurrentLastSelection())==null?void 0:u.range;if(!h)return!1;const f=n.get(m.RangeProtectionRuleModel).getSubunitRuleList(l,c).find(v=>{var p;return(p=v==null?void 0:v.ranges)==null?void 0:p.some(C=>a.Rectangle.intersects(C,h))});if(f){const v={...f,unitId:l,subUnitId:c};return await o.executeCommand(Be.id,{showDetail:!0,rule:a.Tools.deepClone(v),oldRule:a.Tools.deepClone(v)}),!0}else return!1}}},ci={id:"sheet.command.refill",type:a.CommandType.COMMAND,handler:async(n,o)=>n.get(ct).fillData(o.type)},mn={id:"sheet.command.remove-row-confirm",type:a.CommandType.COMMAND,handler:async(n,o)=>{var d;const e=n.get(m.SheetsSelectionsService);let t=o==null?void 0:o.range;if(t||(t=(d=e.getCurrentLastSelection())==null?void 0:d.range),!t)return!1;const i=n.get(a.ICommandService),r=n.get(a.IUniverInstanceService),s=m.getSheetCommandTarget(r);if(!s)return!1;const{worksheet:l}=s,c=l.getVisibleRows();if(Sa(c,[t])){const u=n.get(I.IConfirmService),h=n.get(a.LocaleService);return await u.confirm({id:"sheet.confirm.remove-row",title:{title:h.t("info.problem")},children:{title:h.t("rightClick.deleteAllRowsAlert")},cancelText:h.t("button.cancel"),confirmText:h.t("button.confirm")}),!1}return await i.executeCommand(m.RemoveRowCommand.id,{range:t}),!0}},gn={id:"sheet.command.remove-col-confirm",type:a.CommandType.COMMAND,handler:async(n,o)=>{var d;const e=n.get(m.SheetsSelectionsService);let t=o==null?void 0:o.range;if(t||(t=(d=e.getCurrentLastSelection())==null?void 0:d.range),!t)return!1;const i=n.get(a.ICommandService),r=n.get(a.IUniverInstanceService),s=m.getSheetCommandTarget(r);if(!s)return!1;const{worksheet:l}=s,c=l.getVisibleCols();if(fa(c,[t])){const u=n.get(I.IConfirmService),h=n.get(a.LocaleService);return await u.confirm({id:"sheet.confirm.remove-col",title:{title:h.t("info.problem")},children:{title:h.t("rightClick.deleteAllColumnsAlert")},cancelText:h.t("button.cancel"),confirmText:h.t("button.confirm")}),!1}return await i.executeCommand(m.RemoveColCommand.id,{range:t}),!0}},di={id:"sheet.command.remove-sheet-confirm",type:a.CommandType.COMMAND,handler:async(n,o)=>{const{subUnitId:e}=o,t=n.get(I.IConfirmService),i=n.get(a.ICommandService),r=n.get(a.LocaleService),s=n.get(a.IConfigService),l=n.get(a.IUniverInstanceService),c=m.getSheetCommandTarget(l,{subUnitId:e});if(!c)return!1;const{worksheet:d}=c,u=s.getConfig(m.SHEETS_PLUGIN_CONFIG_KEY),h={...m.defaultLargeSheetOperationConfig,...u==null?void 0:u.largeSheetOperation},S=m.countCells(d.getCellMatrix())>=h.largeSheetCellCountThreshold;return await t.confirm({id:"sheet.confirm.remove-sheet",title:{title:r.t("sheetConfig.deleteSheet")},children:{title:S?r.t("sheetConfig.deleteLargeSheetContent"):r.t("sheetConfig.deleteSheetContent")},cancelText:r.t("button.cancel"),confirmText:r.t("button.confirm")})?(await i.executeCommand(m.RemoveSheetCommand.id,{subUnitId:e}),!0):!1}};var Uu=Object.getOwnPropertyDescriptor,Bu=(n,o,e,t)=>{for(var i=t>1?void 0:t?Uu(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Sn=(n,o)=>(e,t)=>o(e,t,n),Ae=(n=>(n[n.OFF=0]="OFF",n[n.ONCE=1]="ONCE",n[n.INFINITE=2]="INFINITE",n))(Ae||{});const Fe=a.createIdentifier("univer.format-painter-service");let no=class extends a.Disposable{constructor(o,e,t,i,r,s){super();R(this,"status$");R(this,"_selectionFormat");R(this,"_markId",null);R(this,"_status$");R(this,"_defaultHook",null);R(this,"_extendHooks",[]);this._selectionManagerService=o,this._themeService=e,this._markSelectionService=t,this._logService=i,this._commandService=r,this._undoRedoService=s,this._status$=new N.BehaviorSubject(0),this.status$=this._status$.asObservable(),this._selectionFormat={styles:new a.ObjectMatrix,merges:[]}}addHook(o){var e,t,i;o.isDefaultHook&&((e=o.priority)!=null?e:0)>((i=(t=this._defaultHook)==null?void 0:t.priority)!=null?i:-1)?this._defaultHook=o:(this._extendHooks.push(o),this._extendHooks.sort((r,s)=>(r.priority||0)-(s.priority||0)))}getHooks(){return this._defaultHook?[this._defaultHook,...this._extendHooks]:this._extendHooks}setStatus(o){this._updateRangeMark(o),this._status$.next(o),this.getHooks().forEach(t=>{t.onStatusChange!==void 0&&t.onStatusChange(o)})}getStatus(){return this._status$.getValue()}setSelectionFormat(o){this._selectionFormat=o}getSelectionFormat(){return this._selectionFormat}applyFormatPainter(o,e,t){const i=this.getHooks(),r=[],s=[];i.forEach(c=>{if(c.onApply!==void 0){const d=c.onApply(o,e,t,this._selectionFormat);d&&(r.push(...d.redos),s.push(...d.undos))}});for(const c of i)if(c.onBeforeApply!==void 0&&!c.onBeforeApply({unitId:o,subUnitId:e,range:t,redoMutationsInfo:r,format:this._selectionFormat,undoMutationsInfo:s}))return!1;this._logService.log("[FormatPainterService]","apply mutations",{undoMutationsInfo:s,redoMutationsInfo:r});const l=r.every(c=>this._commandService.executeCommand(c.id,c.params));return l&&this._undoRedoService.pushUndoRedo({unitID:o,undoMutations:s,redoMutations:r}),l}_updateRangeMark(o){if(this._markSelectionService.removeAllShapes(),o!==0){const e=this._selectionManagerService.getCurrentLastSelection();if(e){const t=$s(this._themeService);o===2?this._markId=this._markSelectionService.addShape({...e,style:t}):this._markId=this._markSelectionService.addShape({...e,style:t},[m.SetRangeValuesMutation.id])}}}};no=Bu([Sn(0,a.Inject(m.SheetsSelectionsService)),Sn(1,a.Inject(a.ThemeService)),Sn(2,yt),Sn(3,a.ILogService),Sn(4,a.ICommandService),Sn(5,a.IUndoRedoService)],no);const ui={id:"sheet.operation.set-format-painter",type:a.CommandType.OPERATION,handler:(n,o)=>o?(n.get(Fe).setStatus(o.status),!0):!1},io={type:a.CommandType.COMMAND,id:"sheet.command.set-infinite-format-painter",handler:async n=>{const e=n.get(Fe).getStatus();let t;return e!==Ae.OFF?t=Ae.OFF:t=Ae.INFINITE,n.get(a.ICommandService).executeCommand(ui.id,{status:t})}},fn={type:a.CommandType.COMMAND,id:"sheet.command.set-once-format-painter",handler:async n=>{const e=n.get(Fe).getStatus();let t;return e!==Ae.OFF?t=Ae.OFF:t=Ae.ONCE,n.get(a.ICommandService).executeCommand(ui.id,{status:t})}},hi={type:a.CommandType.COMMAND,id:"sheet.command.apply-format-painter",handler:async(n,o)=>n.get(Fe).applyFormatPainter(o.unitId,o.subUnitId,o.range)};var Fu=Object.getOwnPropertyDescriptor,zu=(n,o,e,t)=>{for(var i=t>1?void 0:t?Fu(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Xu=(n,o)=>(e,t)=>o(e,t,n);y.SheetScrollManagerService=class{constructor(o,e){R(this,"_scrollStateMap",new Map);R(this,"_rawScrollInfo$",new N.BehaviorSubject(null));R(this,"rawScrollInfo$",this._rawScrollInfo$.asObservable());R(this,"validViewportScrollInfo$",new N.BehaviorSubject(null));R(this,"_searchParamForScroll",null);this._context=o,this._sheetSkeletonManagerService=e}dispose(){this._rawScrollInfo$.complete()}calcViewportScrollFromRowColOffset(o){if(!o)return{viewportScrollX:0,viewportScrollY:0};let{sheetViewStartColumn:e,sheetViewStartRow:t,offsetX:i,offsetY:r}=o;t=t||0,r=r||0;const s=this._sheetSkeletonManagerService.getCurrentSkeleton(),l=(s==null?void 0:s.rowHeightAccumulation[t-1])||0,d=((s==null?void 0:s.columnWidthAccumulation[e-1])||0)+i,u=l+r;return{viewportScrollX:d,viewportScrollY:u}}setSearchParam(o){this._searchParamForScroll=o}getScrollStateByParam(o){return this._getCurrentScroll(o)}getCurrentScrollState(){return this._getCurrentScroll(this._searchParamForScroll)}setValidScrollState(o){this._setScrollState(o)}emitRawScrollParam(o){this._emitRawScroll(o)}setValidScrollStateToCurrSheet(o){if(this._searchParamForScroll==null)return;this._setScrollState({...this._searchParamForScroll,...o});const e=this._searchParamForScroll.sheetId,t=this._sheetSkeletonManagerService.getSkeleton(e);t&&t.setScroll(o.viewportScrollX,o.viewportScrollY)}clear(){this._searchParamForScroll!=null&&this._clearByParamAndNotify(this._searchParamForScroll)}_setScrollState(o){const{unitId:e,sheetId:t,sheetViewStartColumn:i,sheetViewStartRow:r,offsetX:s,offsetY:l}=o;this._scrollStateMap.has(e)||this._scrollStateMap.set(e,new Map);const c=this._scrollStateMap.get(e),d={sheetViewStartRow:r,sheetViewStartColumn:i,offsetX:s,offsetY:l};c.set(t,d)}_clearByParamAndNotify(o){this._setScrollState({...o,sheetViewStartRow:0,sheetViewStartColumn:0,offsetX:0,offsetY:0}),this._emitRawScroll({sheetViewStartRow:0,sheetViewStartColumn:0,offsetX:0,offsetY:0})}_getCurrentScroll(o){var s;const e={sheetViewStartRow:0,sheetViewStartColumn:0,offsetX:0,offsetY:0};if(o==null)return e;const{unitId:t,sheetId:i}=o;return((s=this._scrollStateMap.get(t))==null?void 0:s.get(i))||e}_emitRawScroll(o){this._rawScrollInfo$.next(o)}},y.SheetScrollManagerService=zu([Xu(1,a.Inject(y.SheetSkeletonManagerService))],y.SheetScrollManagerService);const $e={type:a.CommandType.COMMAND,id:"sheet.command.set-selection-frozen",handler:async(n,o)=>{const{type:e}=o||{},t=n.get(a.IUniverInstanceService),i=n.get(a.IUndoRedoService),r=m.getSheetCommandTarget(t);if(!r)return!1;const{unitId:s,subUnitId:l}=r,c=n.get(a.ICommandService),u=n.get(m.SheetsSelectionsService).getCurrentSelections();if(!u)return!1;const h=u[(u==null?void 0:u.length)-1],{range:g}=h,f=n.get(M.IRenderManagerService).getRenderById(s).with(y.SheetScrollManagerService),{sheetViewStartRow:v=0,sheetViewStartColumn:p=0}=f.getCurrentScrollState()||{};let C,_,w,E;const{startRow:O,startColumn:T,rangeType:P}=g;if(P===a.RANGE_TYPE.ROW||e===1)C=O,w=O-v,_=-1,E=0;else if(P===a.RANGE_TYPE.COLUMN||e===2)C=-1,w=0,_=T,E=T-p;else if(P===a.RANGE_TYPE.NORMAL)C=O,w=O-v,_=T,E=T-p;else return!1;const A={unitId:s,subUnitId:l,startRow:C,startColumn:_,xSplit:_>0?Math.max(1,E):E,ySplit:C>0?Math.max(1,w):w},D=m.SetFrozenMutationFactory(n,A);return c.syncExecuteCommand(m.SetFrozenMutation.id,A)&&i.pushUndoRedo({unitID:s,undoMutations:[{id:m.SetFrozenMutation.id,params:D}],redoMutations:[{id:m.SetFrozenMutation.id,params:A}]}),!0}},mi={type:a.CommandType.COMMAND,id:"sheet.command.set-row-frozen",handler:async n=>(n.get(a.ICommandService).executeCommand($e.id,{type:1}),!0)},gi={type:a.CommandType.COMMAND,id:"sheet.command.set-col-frozen",handler:async n=>(n.get(a.ICommandService).executeCommand($e.id,{type:2}),!0)};class Sr extends a.Disposable{constructor(){super(...arguments);R(this,"rangesStack",[]);R(this,"selectedRangeWorksheet","")}}var Yu=Object.getOwnPropertyDescriptor,ju=(n,o,e,t)=>{for(var i=t>1?void 0:t?Yu(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},ba=(n,o)=>(e,t)=>o(e,t,n);let vn=class{constructor(n,o){R(this,"_current",null);R(this,"_shortcutParam",[]);this._univerInstanceService=n,this._localeService=o}dispose(){this._shortcutParam=[]}getCurrentBySearch(n){return this._getCurrentBySearch(n)}getCurrent(){return this._getCurrentBySearch(this._current)}addOrUpdate(n){const o=this._getCurrentBySearch({unitId:n.unitId,sheetId:n.sheetId,keycode:n.keycode});if(o!=null){const e=this._shortcutParam.indexOf(o);this._shortcutParam.splice(e,1)}return this._shortcutParam.push(n),o}remove(n){if(n==null)return;const o=this._getCurrentBySearch(n);if(o==null)return;const e=this._shortcutParam.indexOf(o);return this._shortcutParam.splice(e,1)[0]}_getCurrentBySearch(n){return n==null?void 0:this._shortcutParam.find(e=>e.unitId===n.unitId&&e.sheetId===n.sheetId&&e.keycode===n.keycode)}};vn=ju([ba(0,a.IUniverInstanceService),ba(1,a.Inject(a.LocaleService))],vn);var ze=(n=>(n[n.moveStopeOne=0]="moveStopeOne",n[n.moveGap=1]="moveGap",n[n.moveStepPage=2]="moveStepPage",n[n.moveStepEnd=3]="moveStepEnd",n))(ze||{});const Pe={id:"sheet.command.move-selection",type:a.CommandType.COMMAND,handler:(n,o)=>{if(!o)return!1;const e=m.getSheetCommandTarget(n.get(a.IUniverInstanceService));if(!e)return!1;const{workbook:t,worksheet:i}=e,r=m.getSelectionsService(n,o.fromCurrentSelection).getCurrentLastSelection();if(!r)return!1;const{direction:s,jumpOver:l,extra:c}=o,{range:d,primary:u}=r,h=ur(d,u,s),g=l===1?dr(h,s,i):mt(h,s,i),S=m.getCellAtRowCol(g.startRow,g.startColumn,i);if(a.Rectangle.equals(S,h))return!1;const f=t.getUnitId();n.get(vn).remove({unitId:f,sheetId:i.getSheetId(),keycode:I.KeyCode.TAB});const v=[{range:a.Rectangle.clone(S),primary:{startRow:S.startRow,startColumn:S.startColumn,endRow:S.endRow,endColumn:S.endColumn,actualRow:g.startRow,actualColumn:g.startColumn,isMerged:S.isMerged,isMergedMainCell:S.startRow===g.startRow&&S.startColumn===g.startColumn}}];return n.get(a.ICommandService).executeCommand(m.SetSelectionsOperation.id,{unitId:t.getUnitId(),subUnitId:i.getSheetId(),selections:v,type:m.SelectionMoveType.MOVE_END,extra:c,reveal:!0})}},Xe={id:"sheet.command.move-selection-enter-tab",type:a.CommandType.COMMAND,handler:(n,o)=>{var B;if(!o)return!1;const e=m.getSheetCommandTarget(n.get(a.IUniverInstanceService));if(!e)return!1;const{workbook:t,worksheet:i}=e,r=m.getSelectionsService(n),{direction:s,keycode:l}=o,c=s===a.Direction.LEFT||s===a.Direction.UP,d=r.getCurrentSelections().concat(),u=d.findIndex(U=>U.primary),h=d[u];if(!h)return!1;const g=c?-1:1,S=u+g!==d.length?d[u+g]:d[0],f=d.findIndex(U=>U===S),v=t.getUnitId(),p=i.getSheetId();if(!h)return!1;const{range:C}=h,_=h.primary;let w=ur(C,_,s);const E=n.get(vn),O=E.getCurrentBySearch({unitId:v,sheetId:p,keycode:I.KeyCode.TAB});let T;const{startRow:P,endRow:A,startColumn:D,endColumn:k}=C,H=c?_.startRow===P&&_.startColumn===D:_.endRow===A&&_.endColumn===k;if(a.Rectangle.equals(C,_)){if(l===I.KeyCode.TAB)O==null&&E.addOrUpdate({unitId:v,sheetId:p,keycode:I.KeyCode.TAB,selection:h});else{const Y=O==null?void 0:O.selection;if(Y!=null){const{range:Q,primary:oe}=Y;w=ur(Q,oe,s)}E.remove({unitId:v,sheetId:p,keycode:I.KeyCode.TAB})}const U=l===I.KeyCode.ENTER&&s===a.Direction.DOWN&&w.endRow===i.getMaxRows()-1,z=l===I.KeyCode.TAB&&s===a.Direction.RIGHT&&w.endColumn===i.getMaxColumns()-1,F=U||z?w:mt(w,s,i),j=m.getCellAtRowCol(F.startRow,F.startColumn,i);if(a.Rectangle.equals(j,w))return!1;T={range:a.Rectangle.clone(j),primary:{startRow:j.startRow,startColumn:j.startColumn,endRow:j.endRow,endColumn:j.endColumn,actualRow:F.startRow,actualColumn:F.startColumn,isMerged:j.isMerged,isMergedMainCell:j.startRow===F.startRow&&j.startColumn===F.startColumn}}}else{E.remove({unitId:v,sheetId:p,keycode:I.KeyCode.TAB});const U=a.Tools.deepClone(_),z=H?S.range:mt({startRow:U.startRow,startColumn:U.startColumn,endRow:U.endRow,endColumn:U.endColumn},s,i,{startRow:P,endRow:A,startColumn:D,endColumn:k}),F=H&&c,j=F?m.getCellAtRowCol(z.endRow,z.endColumn,i):m.getCellAtRowCol(z.startRow,z.startColumn,i);T={range:H?S.range:a.Rectangle.clone(C),primary:{startRow:j.startRow,startColumn:j.startColumn,endRow:j.endRow,endColumn:j.endColumn,actualRow:F?j.startRow:z.startRow,actualColumn:F?j.startColumn:z.startColumn,isMerged:j.isMerged,isMergedMainCell:j.startRow===z.startRow&&j.startColumn===z.startColumn},style:H?S.style:h.style}}H?(d[u].primary=null,d[f]=T,r.setSelections(v,p,[],m.SelectionMoveType.MOVE_END)):d[u]=T;const V=n.get(a.ICommandService).executeCommand(m.SetSelectionsOperation.id,{unitId:v,subUnitId:p,type:m.SelectionMoveType.MOVE_END,selections:d,reveal:!0,extra:o.extra}),W=(B=n.get(M.IRenderManagerService).getRenderById(v))==null?void 0:B.with(Ie);return W==null||W.refreshSelectionMoveEnd(),V}},De={id:"sheet.command.expand-selection",type:a.CommandType.COMMAND,handler:(n,o)=>{if(!o)return!1;const e=m.getSheetCommandTarget(n.get(a.IUniverInstanceService));if(!e)return!1;const{worksheet:t,unitId:i,subUnitId:r}=e,s=m.getSelectionsService(n).getCurrentLastSelection();if(!s)return!1;const{range:l,primary:c}=s,{jumpOver:d,direction:u,extra:h}=o,S=Nu(s,u,t)?d===1?Au(l,{...a.Rectangle.clone(c),rangeType:a.RANGE_TYPE.NORMAL},u,t):Du(l,u,t):d===1?Pu(l,u,t):Ou(l,u,t);return S.rangeType=s.range.rangeType,a.Rectangle.equals(S,l)?!1:n.get(a.ICommandService).syncExecuteCommand(m.SetSelectionsOperation.id,{unitId:i,subUnitId:r,type:m.SelectionMoveType.MOVE_END,selections:[{range:S,primary:c}],extra:h,reveal:!0})}},Si={id:"sheet.command.select-all",type:a.CommandType.COMMAND,handler:async(n,o={expandToGapFirst:!0,loop:!1})=>{const e=m.getSheetCommandTarget(n.get(a.IUniverInstanceService));if(!e)return!1;const t=m.getSelectionsService(n).getCurrentLastSelection();if(!t)return!1;const i=n.get(Sr),{worksheet:r,unitId:s,subUnitId:l}=e,c=`${s}|${l}`;c!==i.selectedRangeWorksheet&&(i.rangesStack=[],i.selectedRangeWorksheet=c);const d=r.getMaxRows(),u=r.getMaxColumns(),{expandToGapFirst:h,loop:g}=o,{range:S,primary:f}=t,v=S.endColumn===u-1&&S.endRow===d-1&&S.startRow===0&&S.startColumn===0;i.rangesStack.some(O=>a.Rectangle.equals(O,S))||(i.rangesStack=[],i.rangesStack.push(S));let p;if(v)if(g){if(i.rangesStack.findIndex(T=>a.Rectangle.equals(T,S))!==i.rangesStack.length-1)return!1;p=i.rangesStack[0]}else return!1;else h?(p=m.expandToContinuousRange(S,{left:!0,right:!0,up:!0,down:!0},r),a.Rectangle.equals(p,S)&&(p=ga(r))):p=ga(r);i.rangesStack.some(O=>a.Rectangle.equals(O,p))||i.rangesStack.push(p);const C=[];C.push({id:m.SetSelectionsOperation.id,params:{unitId:s,subUnitId:l,reveal:!0,selections:[{range:p,primary:f}]}});const w=n.get(m.SheetInterceptorService).onCommandExecute({id:Si.id,params:{range:S}});w.redos.length&&C.push(...w.redos);const E=n.get(a.ICommandService);return a.sequenceExecute(C,E),!0}};function Zu(n){return typeof n.isMainScene>"u"}function He(n,o){const e=n instanceof a.Workbook?n:n.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET);if(!e)return null;const t=e.getUnitId();let i,r,s,l;if(Zu(o)){const g=o.getRenderById(t);if(g==null)return null;i=g.components,i=g.components,r=g.mainComponent,s=g.scene,l=g.engine}else i=o.components,r=o.mainComponent,s=o.scene,l=o.engine;if(!i||!r)return null;const c=r,d=i.get(he.ROW),u=i.get(he.COLUMN),h=i.get(he.LEFT_TOP);return{spreadsheet:c,spreadsheetRowHeader:d,spreadsheetColumnHeader:u,spreadsheetLeftTopPlaceholder:h,scene:s,engine:l}}function fr(n,o,e,t){const{startX:i,startY:r,endX:s,endY:l}=t.getCellWithCoordByIndex(n,o);return{startX:i,startY:r,endX:s,endY:l}}function Ye(n,o,e,t,i,r){const s=e.getCoordRelativeToViewport(M.Vector2.FromArray([n,o])),{x:l,y:c}=s,d=e.getScrollXYInfoByViewport(s,i),{scaleX:u,scaleY:h}=e.getAncestorScale(),g=t.getCellIndexByOffset(l,c,u,h,d,{closeFirst:r}),{row:S,column:f}=g,v=t.getNoMergeCellWithCoordByIndex(S,f),{startX:p,startY:C,endX:_,endY:w}=v;return{startX:p,startY:C,endX:_,endY:w,row:S,column:f}}function fi(n,o,e,t){const i=e.getCoordRelativeToViewport(M.Vector2.FromArray([n,o])),r=e.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN),s=e.getScrollXYInfoByViewport(i,r),{scaleX:l,scaleY:c}=e.getAncestorScale(),{x:d,y:u}=s,h=n/l+d,g=o/c+u;return{x:h,y:g}}var Gu=Object.getOwnPropertyDescriptor,Ku=(n,o,e,t)=>{for(var i=t>1?void 0:t?Gu(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},pn=(n,o)=>(e,t)=>o(e,t,n);Pe.id,Xe.id;const qu=3;y.SheetsScrollRenderController=class extends a.Disposable{constructor(o,e,t,i,r,s,l){super(),this._context=o,this._injector=e,this._sheetSkeletonManagerService=t,this._contextService=i,this._commandService=r,this._renderManagerService=s,this._scrollManagerService=l,this._initCommandListener(),this._wheelEventListener(),this._scrollBarEventListener(),this._initSkeletonListener()}_wheelEventListener(){const{scene:o}=this._context;if(!o)return;const e=o.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN);e&&this.disposeWithMe(o.onMouseWheel$.subscribeEvent((t,i)=>{if(t.ctrlKey||!this._contextService.getContextValue(a.FOCUSING_SHEET))return;let r=0,s=0;r=t.deltaX,t.shiftKey?r=(t.deltaY||t.deltaX)*qu:s=t.deltaY,this._commandService.executeCommand(Cn.id,{offsetX:r,offsetY:s}),this._context.scene.makeDirty(!0);const l=e.limitedScroll(e.scrollX+r,e.scrollY+s);l&&!l.isLimitedX&&!l.isLimitedY&&(t.preventDefault(),o.getParent().classType===M.RENDER_CLASS_TYPE.SCENE_VIEWER&&i.stopPropagation()),e.isWheelPreventDefaultX&&e.isWheelPreventDefaultY&&t.preventDefault()}))}_scrollBarEventListener(){const{scene:o}=this._context;if(o==null)return;const e=o.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN);e&&(this.disposeWithMe(a.toDisposable(this._scrollManagerService.rawScrollInfo$.subscribe(t=>{var f;const i=(f=this._sheetSkeletonManagerService.getCurrentParam())==null?void 0:f.skeleton;if(!i)return;if(t==null){e.scrollToViewportPos({viewportScrollX:0,viewportScrollY:0});return}const{sheetViewStartRow:r,sheetViewStartColumn:s,offsetX:l,offsetY:c,duration:d}=t,{startX:u,startY:h}=i.getCellWithCoordByIndex(r,s,!1),g=u+l,S=h+c;e.scrollAnimationFrameId!==null&&cancelAnimationFrame(e.scrollAnimationFrameId),d?this._smoothScrollToViewportPos({viewportMain:e,viewportScrollX:g,viewportScrollY:S,duration:d}):e.scrollToViewportPos({viewportScrollX:g,viewportScrollY:S})}))),this.disposeWithMe(e.onScrollAfter$.subscribeEvent(t=>{var v;const i=(v=this._sheetSkeletonManagerService.getCurrentParam())==null?void 0:v.skeleton;if(i==null||t.isTrigger===!1)return;const r=this._getSheetObject();if(i==null||r==null)return;const{viewportScrollX:s,viewportScrollY:l,scrollX:c,scrollY:d}=t,{row:u,column:h,rowOffset:g,columnOffset:S}=i.getOffsetRelativeToRowCol(s,l),f={sheetViewStartRow:u,sheetViewStartColumn:h,offsetX:S,offsetY:g,viewportScrollX:s,viewportScrollY:l,scrollX:c,scrollY:d};this._scrollManagerService.setValidScrollStateToCurrSheet(f),this._scrollManagerService.validViewportScrollInfo$.next({...f,viewportScrollX:s,viewportScrollY:l,scrollX:c,scrollY:d})})),this.disposeWithMe(e.onScrollByBar$.subscribeEvent(t=>{var g;const i=(g=this._sheetSkeletonManagerService.getCurrentParam())==null?void 0:g.skeleton;if(i==null||t.isTrigger===!1)return;const r=this._getSheetObject();if(i==null||r==null)return;const{viewportScrollX:s=0,viewportScrollY:l=0}=t;this._getFreeze();const{row:c,column:d,rowOffset:u,columnOffset:h}=i.getOffsetRelativeToRowCol(s,l);this._commandService.executeCommand(Le.id,{sheetViewStartRow:c,sheetViewStartColumn:d,offsetX:h,offsetY:u})})))}_initSkeletonListener(){this.disposeWithMe(a.toDisposable(this._sheetSkeletonManagerService.currentSkeletonBefore$.subscribe(o=>{if(o==null)return;const e={unitId:o.unitId,sheetId:o.sheetId};if(this._scrollManagerService.setSearchParam(e),!this._getSheetObject())return;const i=this._scrollManagerService.getScrollStateByParam(e),{viewportScrollX:r,viewportScrollY:s}=this._scrollManagerService.calcViewportScrollFromRowColOffset(i);i&&this._updateViewportScroll(r,s)})))}_smoothScrollToViewportPos(o){const{viewportMain:e,viewportScrollX:t,viewportScrollY:i,duration:r}=o,s=performance.now(),l=e.viewportScrollX,c=e.viewportScrollY,d=t-l,u=i-c;function h(g){const S=g-s,f=Math.min(S/r,1),v=1-(1-f)**3,p=l+d*v,C=c+u*v;e.scrollToViewportPos({viewportScrollX:p,viewportScrollY:C}),f<1?e.scrollAnimationFrameId=requestAnimationFrame(h):e.scrollAnimationFrameId=null}e.scrollAnimationFrameId=requestAnimationFrame(h)}_updateViewportScroll(o=0,e=0){const t=this._getSheetObject();if(!t)return;const i=t.scene,r=i.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN),s=i.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_COLUMN_RIGHT),l=i.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_ROW_BOTTOM),c=i.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT),d=i.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP);r&&(r.viewportScrollX=o,r.viewportScrollY=e),l&&(l.viewportScrollY=e),s&&(s.viewportScrollX=o),c&&(c.viewportScrollY=e),d&&(d.viewportScrollX=o)}scrollToRange(o,e,t){let{endRow:i,endColumn:r,startColumn:s,startRow:l}=o;const c=this._getViewportBounding();if(o.rangeType===a.RANGE_TYPE.ROW?(s=0,r=0):o.rangeType===a.RANGE_TYPE.COLUMN&&(l=0,i=0),c&&!e&&!t){const d=c.startRow>i?l:i,u=c.startColumn>r?s:r;return this._scrollToCell(d,u)}else return this._scrollToCell(l,s,e,t)}scrollToCell(o,e,t){const i=this._context.unit.getActiveSheet(),{ySplit:r,xSplit:s}=i.getFreeze();return this._commandService.syncExecuteCommand(Le.id,{sheetViewStartRow:o-r,sheetViewStartColumn:e-s,offsetX:0,offsetY:0,duration:t})}_initCommandListener(){this.disposeWithMe(this._commandService.onCommandExecuted(o=>{switch(o.id){case m.SetSelectionsOperation.id:{const e=o.params;e.unitId===this._context.unitId&&e.reveal&&this._scrollToSelection()}break;case m.ScrollToCellOperation.id:{const e=o.params;if(e.unitId===this._context.unitId){const t=e.range;this.scrollToRange(t)}}break;case De.id:{const e=o.params;this._scrollToSelectionForExpand(e)}break}}))}_scrollToSelectionForExpand(o){setTimeout(()=>{const e=this._getSelectionsService().getCurrentLastSelection();if(e==null)return;const{startRow:t,startColumn:i,endRow:r,endColumn:s}=e.range,l=this._getViewportBounding();if(l==null)return;const{startRow:c,startColumn:d,endRow:u,endColumn:h}=l;let g=0,S=0;t>c?g=r:r<u?g=t:g=c,i>d?S=s:s<h?S=i:S=d,o.direction===a.Direction.DOWN?g=r:o.direction===a.Direction.UP?g=t:o.direction===a.Direction.RIGHT?S=s:o.direction===a.Direction.LEFT&&(S=i),this._scrollToCell(g,S)},0)}_getFreeze(){var e;const o=(e=this._sheetSkeletonManagerService.getCurrentParam())==null?void 0:e.skeleton.getWorksheetConfig();if(o!=null)return o.freeze}_updateSceneSize(o){var h;if(o==null)return;const{unitId:e}=this._context,{skeleton:t}=o,i=(h=this._renderManagerService.getRenderById(e))==null?void 0:h.scene;if(t==null||i==null)return;const{rowTotalHeight:r,columnTotalWidth:s,rowHeaderWidthAndMarginLeft:l,columnHeaderHeightAndMarginTop:c}=t;this._context.unit.getActiveSheet()&&(i==null||i.transformByState({width:l+s,height:c+r}))}_getSheetObject(){return He(this._context.unit,this._context)}_scrollToSelectionByDirection(o){const e=this._getViewportBounding();if(e==null)return!1;const{startRow:t,startColumn:i,endRow:r,endColumn:s}=e;let l=0,c=0;const{startRow:d,startColumn:u,endRow:h,endColumn:g}=o;d>=t&&(l=h),h<=r&&(l=d),u>=i&&(c=g),g<=s&&(c=u),this._scrollToCell(l,c)}_scrollToSelection(o=!0){var d;const e=this._getSelectionsService().getCurrentLastSelection();if(!e)return;const{startRow:t,startColumn:i,actualRow:r,actualColumn:s}=(d=e.primary)!=null?d:e.range,l=o&&r!=null?r:t,c=o&&s!=null?s:i;this._scrollToCell(l,c)}_getSelectionsService(){return m.getSelectionsService(this._injector)}_getViewportBounding(){var r,s;const o=(r=this._getSheetObject())==null?void 0:r.scene;if(o==null)return;const e=o.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN);if(e==null)return;const t=(s=this._sheetSkeletonManagerService.getCurrentParam())==null?void 0:s.skeleton;if(t==null)return;const i=e.calcViewportInfo();return t.getRangeByViewBound(i.viewBound)}_scrollToCell(o,e,t=!1,i=!1){var k,H,V;const{rowHeightAccumulation:r,columnWidthAccumulation:s}=(k=this._sheetSkeletonManagerService.getCurrentSkeleton())!=null?k:{};if(r==null||s==null)return!1;const l=(H=this._getSheetObject())==null?void 0:H.scene;if(l==null)return!1;const c=l.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN);if(c==null)return!1;const d=(V=this._sheetSkeletonManagerService.getCurrentParam())==null?void 0:V.skeleton;if(d==null)return!1;const u=this._context.unit.getActiveSheet();if(!u)return!1;o=a.Tools.clamp(o,0,r.length-1),e=a.Tools.clamp(e,0,s.length-1);const{startColumn:h,startRow:g,ySplit:S,xSplit:f}=u.getFreeze(),v=this._getViewportBounding();if(v==null)return!1;const{startRow:p,startColumn:C,endRow:_,endColumn:w}=v;let E,O;if(o>=g&&e>=h-S&&(o<=p&&(E=o,t=!0),o>=_)){const L=r[o]-c.height;for(let W=p;W<=o&&(E=W+1,!(r[W]>=L));W++);}if(e>=h&&o>=g-S&&(e<=C&&(O=e,i=!0),e>=w)){const L=s[e]-c.width;for(let W=C;W<=e&&(O=W+1,!(s[W]>=L));W++);}if(E===void 0&&O===void 0)return!1;let{offsetX:T,offsetY:P,sheetViewStartRow:A,sheetViewStartColumn:D}=this._scrollManagerService.getCurrentScrollState()||{};if(E=E?Math.min(E,o):A+S,O=O?Math.min(O,e):D+f,i){T=0,O=e;const L=d.getHiddenColumnsInRange({startColumn:O-f,endColumn:O});O=O-L.length}if(t){P=0,E=o;const L=d.getHiddenRowsInRange({startRow:E-S,endRow:E});E=E-L.length}return this._commandService.syncExecuteCommand(Le.id,{sheetViewStartRow:Math.max(0,E-S),sheetViewStartColumn:Math.max(0,O-f),offsetX:T,offsetY:P})}},y.SheetsScrollRenderController=Ku([pn(1,a.Inject(a.Injector)),pn(2,a.Inject(y.SheetSkeletonManagerService)),pn(3,a.IContextService),pn(4,a.ICommandService),pn(5,M.IRenderManagerService),pn(6,a.Inject(y.SheetScrollManagerService))],y.SheetsScrollRenderController);const et={id:"sheet.operation.set-scroll",type:a.CommandType.OPERATION,handler:(n,o)=>{if(!o)return!1;const{unitId:e,sheetId:t,offsetX:i=0,offsetY:r=0,sheetViewStartColumn:s,sheetViewStartRow:l,duration:c,screenRatioX:d,screenRatioY:u}=o,h=n.get(M.IRenderManagerService),g=h.getRenderById(e).with(y.SheetScrollManagerService),S=h.getRenderById(e);if(!S)return!1;const f=S.engine,v=f.width,p=f.height,C=d!==void 0?v*d+i:i,_=u!==void 0?p*u+r:r;return g.emitRawScrollParam({unitId:e,sheetId:t,offsetX:C,offsetY:_,sheetViewStartRow:l,sheetViewStartColumn:s,duration:c}),!0}},Cn={id:"sheet.command.set-scroll-relative",type:a.CommandType.COMMAND,handler:async(n,o)=>{const e=n.get(a.ICommandService),t=n.get(a.IUniverInstanceService),i=n.get(M.IRenderManagerService),r=m.getSheetCommandTarget(t);if(!r)return!1;const{unitId:s,subUnitId:l}=r,d=i.getRenderById(s).with(y.SheetScrollManagerService).getCurrentScrollState(),{offsetX:u=0,offsetY:h=0}=o||{},{sheetViewStartRow:g=0,sheetViewStartColumn:S=0,offsetX:f=0,offsetY:v=0}=d||{};return e.executeCommand(et.id,{unitId:s,sheetId:l,sheetViewStartRow:g,sheetViewStartColumn:S,offsetX:f+u,offsetY:v+h})}},Le={id:"sheet.command.scroll-view",type:a.CommandType.COMMAND,handler:(n,o)=>{if(!o)return!1;const e=n.get(a.IUniverInstanceService),t=n.get(M.IRenderManagerService),i=m.getSheetCommandTarget(e);if(!i)return!1;const{workbook:r,worksheet:s,unitId:l}=i,d=t.getRenderById(l).with(y.SheetScrollManagerService).getCurrentScrollState();if(!s)return!1;const{sheetViewStartRow:u,sheetViewStartColumn:h,offsetX:g,offsetY:S,duration:f}=o,{sheetViewStartColumn:v,sheetViewStartRow:p,offsetX:C,offsetY:_}=d||{},{xSplit:w,ySplit:E}=i.worksheet.getConfig().freeze;return n.get(a.ICommandService).syncExecuteCommand(et.id,{unitId:r.getUnitId(),sheetId:s.getSheetId(),sheetViewStartRow:u!=null?u:p!=null?p:0+E,sheetViewStartColumn:h!=null?h:v!=null?v:0+w,offsetX:g!=null?g:C,offsetY:S!=null?S:_,duration:f})}},oo={id:"sheet.command.scroll-to-cell",type:a.CommandType.COMMAND,handler:(n,o)=>{const e=n.get(a.IUniverInstanceService);return n.get(M.IRenderManagerService).getRenderById(e.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET).getUnitId()).with(y.SheetsScrollRenderController).scrollToRange(o.range,o.forceTop,o.forceLeft)}},Qu={id:"sheet.command.scroll-view-reset",type:a.CommandType.COMMAND,handler:async n=>{const o=n.get(a.IUniverInstanceService),e=m.getSheetCommandTarget(o);if(!e)return!1;const{subUnitId:t,unitId:i}=e;return n.get(a.ICommandService).executeCommand(et.id,{unitId:i,sheetId:t,sheetViewStartRow:0,sheetViewStartColumn:0})}};var Ju=Object.getOwnPropertyDescriptor,$u=(n,o,e,t)=>{for(var i=t>1?void 0:t?Ju(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},wa=(n,o)=>(e,t)=>o(e,t,n);const eh=(n,o)=>{const{unitId:e,subUnitId:t,ranges:i}=n,r={},s=o.getColumnManager();for(let l=0;l<i.length;l++){const c=i[l];for(let d=c.startColumn;d<c.endColumn+1;d++)r[d]=s.getColumnWidth(d)}return{unitId:e,subUnitId:t,ranges:i,colWidth:r}};y.AutoWidthController=class extends a.Disposable{constructor(o,e){super(),this._renderManagerService=o,this._univerInstanceService=e}getUndoRedoParamsOfColWidth(o){const e={redos:[],undos:[]},{_univerInstanceService:t}=this,i=m.getSheetCommandTarget(t);if(!i)return e;const{unitId:r,subUnitId:s,worksheet:l}=i,c=this._renderManagerService.getRenderById(r).with(y.SheetSkeletonManagerService);if(!c.getCurrentParam())return e;const{skeleton:d}=c.getCurrentParam(),u=d.calculateAutoWidthInRange(o.ranges),h={};for(const{col:f,width:v}of u)h[f]=v;const g={subUnitId:s,unitId:r,ranges:o.ranges,colWidth:h},S=eh(g,l);return{undos:[{id:m.SetWorksheetColWidthMutation.id,params:S}],redos:[{id:m.SetWorksheetColWidthMutation.id,params:g}]}}},y.AutoWidthController=$u([wa(0,M.IRenderManagerService),wa(1,a.Inject(a.IUniverInstanceService))],y.AutoWidthController);const In={type:a.CommandType.COMMAND,id:"sheet.command.set-col-auto-width",handler:(n,o)=>{const e=n.get(a.ICommandService),t=n.get(a.IUndoRedoService),i=n.get(m.SheetsSelectionsService),r=n.get(a.IUniverInstanceService),s=m.getSheetCommandTarget(r,o);if(!s)return!1;const{unitId:l,subUnitId:c}=s;let d=[];if(o!=null&&o.ranges)d=[...o.ranges];else{const f=i.getCurrentSelections();for(let v=0;v<f.length;v++)d.push(f[v].range)}if(!(d!=null&&d.length))return!1;const u={unitId:l,subUnitId:c,ranges:d},{redos:h,undos:g}=n.get(y.AutoWidthController).getUndoRedoParamsOfColWidth(u);return a.sequenceExecute([...h],e).result?(t.pushUndoRedo({unitID:l,undoMutations:[...g],redoMutations:[...h]}),!0):!1}};var th=Object.getOwnPropertyDescriptor,nh=(n,o,e,t)=>{for(var i=t>1?void 0:t?th(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},_n=(n,o)=>(e,t)=>o(e,t,n);y.EditorBridgeService=class extends a.Disposable{constructor(e,t,i,r,s,l){super();R(this,"_editorUnitId",a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY);R(this,"_editorIsDirty",!1);R(this,"_visibleParams",{visible:!1,eventType:M.DeviceInputEventType.Dblclick,unitId:""});R(this,"_currentEditCell",null);R(this,"_currentEditCellState",null);R(this,"_currentEditCellLayout",null);R(this,"helpFunctionVisible$",new N.BehaviorSubject(!0));R(this,"_currentEditCellState$",new N.BehaviorSubject(null));R(this,"currentEditCellState$",this._currentEditCellState$.asObservable());R(this,"_currentEditCellLayout$",new N.BehaviorSubject(null));R(this,"currentEditCellLayout$",this._currentEditCellLayout$.asObservable());R(this,"currentEditCell$",this._currentEditCellState$.pipe(N.switchMap(e=>this._currentEditCellLayout$.pipe(N.map(t=>e&&t?{...e,...t}:null)))));R(this,"_visibleParams$",new N.BehaviorSubject(this._visibleParams));R(this,"visible$",this._visibleParams$.asObservable());R(this,"_afterVisibleParams$",new N.BehaviorSubject(this._visibleParams));R(this,"afterVisible$",this._afterVisibleParams$.asObservable());R(this,"_forceKeepVisible$",new N.BehaviorSubject(!1));R(this,"forceKeepVisible$",this._forceKeepVisible$.asObservable());this._sheetInterceptorService=e,this._renderManagerService=t,this._themeService=i,this._univerInstanceService=r,this._editorService=s,this._contextService=l,this.disposeWithMe(a.toDisposable(()=>{this._currentEditCellState$.complete(),this._currentEditCell=null})),this._univerInstanceService.getTypeOfUnitDisposed$(a.UniverInstanceType.UNIVER_SHEET).subscribe(c=>{var d;c.getUnitId()===((d=this._currentEditCellState)==null?void 0:d.unitId)&&this._clearCurrentEditCellState()})}refreshEditCellState(){const e=this.getLatestEditCellState();if(!e){this._currentEditCellState=null,this._currentEditCellLayout=null,this._currentEditCellState$.next(null),this._currentEditCellLayout$.next(null);return}const{position:t,scaleX:i,scaleY:r,canvasOffset:s,...l}=e;this._currentEditCellState=l,this._currentEditCellLayout={position:t,scaleX:i,scaleY:r,canvasOffset:s},this._currentEditCellState$.next(this._currentEditCellState),this._currentEditCellLayout$.next(this._currentEditCellLayout)}refreshEditCellPosition(e){var O;const t=this._currentEditCell;if(t==null)return;const i=this._univerInstanceService.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET);if(!i)return;const r=this._renderManagerService.getRenderUnitById(i.getUnitId());if(!r)return;const s=(O=r.with(y.SheetSkeletonManagerService).getSkeletonParam(t.sheetId))==null?void 0:O.skeleton,l=r.with(Ie);if(!s||!this._currentEditCellState)return;const{primary:c,scene:d,engine:u}=t,h=Gn(s,c);if(h==null)return;const g=a.convertCellToRange(h),S=q.getCanvasOffsetByEngine(u);let{startX:f,startY:v,endX:p,endY:C}=g;const{scaleX:_,scaleY:w}=d.getAncestorScale(),E=d.getViewportScrollXY(l.getViewPort());f=M.convertTransformToOffsetX(f,_,E),v=M.convertTransformToOffsetY(v,w,E),p=M.convertTransformToOffsetX(p,_,E),C=M.convertTransformToOffsetY(C,w,E),e&&this._currentEditCellLayout&&(p=p-f+this._currentEditCellLayout.position.startX,C=C-v+this._currentEditCellLayout.position.startY,f=this._currentEditCellLayout.position.startX,v=this._currentEditCellLayout.position.startY),this._currentEditCellLayout={position:{startX:f,startY:v,endX:p,endY:C},canvasOffset:S,scaleX:_,scaleY:w},this._currentEditCellLayout$.next(this._currentEditCellLayout)}setEditCell(e){this._currentEditCell=e,this._editorService.getFocusEditor()||(this._editorService.focus(a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY),this._contextService.setContextValue(a.EDITOR_ACTIVATED,!1),this._contextService.setContextValue(a.FOCUSING_EDITOR_STANDALONE,!1));const t=this.getLatestEditCellState();if(!t){this._currentEditCellState=t,this._currentEditCellLayout=t,this._currentEditCellState$.next(t),this._currentEditCellLayout$.next(t);return}const{position:i,canvasOffset:r,scaleX:s,scaleY:l,...c}=t;this._currentEditCellState=c,this._currentEditCellLayout={position:i,canvasOffset:r,scaleX:s,scaleY:l},this._currentEditCellState$.next(this._currentEditCellState),this._currentEditCellLayout$.next(this._currentEditCellLayout)}_clearCurrentEditCellState(){this._currentEditCellState=null,this._currentEditCellState$.next(null),this._currentEditCellLayout=null,this._currentEditCellLayout$.next(null)}getEditCellState(){return this._currentEditCellState==null||this._currentEditCellLayout==null?null:{...this._currentEditCellState,...this._currentEditCellLayout}}getEditCellLayout(){return this._currentEditCellLayout}getEditLocation(){return this._currentEditCellState}updateEditLocation(e,t){this._currentEditCellState&&(this._currentEditCellState={...this._currentEditCellState,row:e,column:t})}getLatestEditCellState(){var L,W,B;const e=this._currentEditCell;if(e==null)return;const t=this._univerInstanceService.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET);if(!t)return;const i=this._renderManagerService.getRenderUnitById(t.getUnitId());if(!i)return;const r=i.with(y.SheetSkeletonManagerService).getCurrentSkeleton(),s=i.with(Ie);if(!r)return;const{primary:l,unitId:c,sheetId:d,scene:u,engine:h}=e,{startRow:g,startColumn:S}=l,f=Gn(r,l);if(f==null)return;const v=a.convertCellToRange(f),p=q.getCanvasOffsetByEngine(h);let{startX:C,startY:_,endX:w,endY:E}=v;const{scaleX:O,scaleY:T}=u.getAncestorScale(),P=u.getViewportScrollXY(s.getViewPort());C=M.convertTransformToOffsetX(C,O,P),_=M.convertTransformToOffsetY(_,T,P),w=M.convertTransformToOffsetX(w,O,P),E=M.convertTransformToOffsetY(E,T,P);const A=t.getActiveSheet();if(!A)return;const D={workbook:t,worksheet:A,unitId:t.getUnitId(),subUnitId:A.getSheetId(),row:g,col:S,origin:A.getCellRaw(g,S)};let k;const H=this._sheetInterceptorService.writeCellInterceptor.fetchThroughInterceptors(m.BEFORE_CELL_EDIT)(A.getCell(g,S),D);k=H&&A.getCellDocumentModelWithFormula(H,D.row,D.col);const V=(L=k==null?void 0:k.documentModel)==null?void 0:L.documentStyle.renderConfig;if(V!=null&&(V.cellValueType=a.CellValueType.STRING),!k||k.documentModel==null){const U=A.getBlankCellDocumentModel(H,D.row,D.col);if(k!=null){const{verticalAlign:z,horizontalAlign:F,wrapStrategy:j,textRotation:Y,fill:Q}=k,{centerAngle:oe,vertexAngle:re}=M.convertTextRotation(Y);U.documentModel.documentStyle.renderConfig={...V,verticalAlign:z,horizontalAlign:F,wrapStrategy:j,background:{rgb:Q},centerAngle:oe,vertexAngle:re}}k=U}if(k.fill=k.fill||"#fff",(W=k.documentModel)==null||W.setZoomRatio(Math.max(O,T)),(H==null?void 0:H.isInArrayFormulaRange)===!0){const U=(B=k.documentModel)==null?void 0:B.getBody();U&&(U.textRuns=[{st:0,ed:U.dataStream.length-2,ts:{cl:{rgb:this._themeService.getColorFromTheme("gray.300")}}}])}return{position:{startX:C,startY:_,endX:w,endY:E},scaleX:O,scaleY:T,canvasOffset:p,row:g,column:S,unitId:c,sheetId:d,documentLayoutObject:k,editorUnitId:this._editorUnitId,isInArrayFormulaRange:H==null?void 0:H.isInArrayFormulaRange}}getCurrentEditorId(){return this._editorUnitId}changeVisible(e){this._visibleParams=e,e.visible&&(this._editorIsDirty=!1),this._visibleParams$.next(this._visibleParams),this._afterVisibleParams$.next(this._visibleParams)}isVisible(){return this._visibleParams}enableForceKeepVisible(){this._forceKeepVisible$.next(!0)}disableForceKeepVisible(){this._forceKeepVisible$.next(!1)}isForceKeepVisible(){return this._forceKeepVisible$.getValue()}changeEditorDirty(e){this._editorIsDirty=e}getEditorDirty(){return this._editorIsDirty}},y.EditorBridgeService=nh([_n(0,a.Inject(m.SheetInterceptorService)),_n(1,M.IRenderManagerService),_n(2,a.Inject(a.ThemeService)),_n(3,a.IUniverInstanceService),_n(4,q.IEditorService),_n(5,a.IContextService)],y.EditorBridgeService);const me=a.createIdentifier("univer.sheet-editor-bridge.service");var ih=Object.getOwnPropertyDescriptor,oh=(n,o,e,t)=>{for(var i=t>1?void 0:t?ih(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},ro=(n,o)=>(e,t)=>o(e,t,n);let vi=class extends a.Disposable{constructor(o,e,t,i,r){super();R(this,"_zoom");this._context=o,this._sheetSkeletonManagerService=e,this._commandService=t,this._contextService=i,this._editorBridgeService=r,this._initSkeletonListener(),this._initZoomEventListener()}updateZoom(o,e){const t=this._context.unit.getSheetBySheetId(o);return t?(t.getConfig().zoomRatio=e,t===this._context.unit.getActiveSheet()&&this._updateViewZoom(e),!0):!1}_initZoomEventListener(){const o=He(this._context.unit,this._context).scene;this.disposeWithMe(o.onMouseWheel$.subscribeEvent(e=>{if(!e.ctrlKey||!this._contextService.getContextValue(a.FOCUSING_SHEET))return;if(this._editorBridgeService){const d=this._editorBridgeService.isVisible();if((d.unitId===this._context.unitId||d.unitId===a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY)&&d.visible)return}const t=Math.abs(e.deltaX);let i=t<40?.2:t<80?.4:.2;i*=e.deltaY>0?-1:1,o.scaleX<1&&(i/=2);const r=this._context.unit,s=r.getActiveSheet();if(!s)return;const l=s.getZoomRatio();let c=+Number.parseFloat(`${l+i}`).toFixed(1);c=c>=4?4:c<=.1?.1:c,this._commandService.executeCommand(wn.id,{zoomRatio:Math.round(c*10)/10,unitId:r.getUnitId(),subUnitId:s.getSheetId()}),e.preventDefault()}))}_initSkeletonListener(){this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(o=>{if(o==null)return;const t=this._context.unit.getActiveSheet();if(!t)return;const i=t.getZoomRatio()||1;this._zoom!==i&&this._updateViewZoom(i)}))}_updateViewZoom(o){this._zoom=o;const e=He(this._context.unit,this._context);e==null||e.scene.scale(o,o),e==null||e.spreadsheet.makeForceDirty()}};vi=oh([ro(1,a.Inject(y.SheetSkeletonManagerService)),ro(2,a.ICommandService),ro(3,a.IContextService),ro(4,a.Optional(me))],vi);const je={id:"sheet.operation.set-zoom-ratio",type:a.CommandType.OPERATION,handler:(n,o)=>{const t=n.get(M.IRenderManagerService).getRenderById(o.unitId);return t?t.with(vi).updateZoom(o.subUnitId,o.zoomRatio):!1}},bn={id:"sheet.command.change-zoom-ratio",type:a.CommandType.COMMAND,handler:(n,o)=>{if(!o)return!1;const e=n.get(a.IUniverInstanceService),t=m.getSheetCommandTarget(e);if(!t)return!1;const{worksheet:i,subUnitId:r,unitId:s}=t,{delta:l,reset:c}=o;let d=c?100:Math.round((i.getConfig().zoomRatio+l)*100);d=Math.max(Yo[0],d),d=Math.min(Yo[1],d);const u=d/100,g=n.get(me).isVisible();return(g.unitId===s||g.unitId===a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY)&&g.visible?!1:n.get(a.ICommandService).executeCommand(je.id,{unitId:s,subUnitId:r,zoomRatio:u})}},wn={id:"sheet.command.set-zoom-ratio",type:a.CommandType.COMMAND,handler:(n,o)=>{if(!o)return!1;const{unitId:e,subUnitId:t,zoomRatio:i}=o,s=n.get(me).isVisible();return(s.unitId===e||s.unitId===a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY)&&s.visible?!1:n.get(a.ICommandService).executeCommand(je.id,{unitId:e,subUnitId:t,zoomRatio:i})}},Ut=a.createIdentifier("univer.sheetbar-service");class Ea extends a.Disposable{constructor(){super();R(this,"renameId$");R(this,"removeId$");R(this,"scroll$");R(this,"scrollX$");R(this,"addSheet$");R(this,"_renameId$");R(this,"_removeId$");R(this,"_scroll$");R(this,"_scrollX$");R(this,"_addSheet$");R(this,"_currentHandler",null);this._renameId$=new N.Subject,this.renameId$=this._renameId$.asObservable(),this._removeId$=new N.Subject,this.removeId$=this._removeId$.asObservable(),this._scroll$=new N.Subject,this.scroll$=this._scroll$.asObservable(),this._scrollX$=new N.Subject,this.scrollX$=this._scrollX$.asObservable(),this._addSheet$=new N.Subject,this.addSheet$=this._addSheet$.asObservable()}setRenameId(e){this._renameId$.next(e)}setRemoveId(e){this._removeId$.next(e)}setScroll(e){this._scroll$.next(e)}setScrollX(e){this._scrollX$.next(e)}setAddSheet(e){this._addSheet$.next(e)}triggerSheetBarMenu(){var e;(e=this._currentHandler)==null||e.handleSheetBarMenu()}registerSheetBarMenuHandler(e){if(this._currentHandler)throw new Error("There is already a context menu handler!");return this._currentHandler=e,a.toDisposable(()=>{this._currentHandler=null})}}const pi={id:"ui-sheet.command.show-menu-list",type:a.CommandType.OPERATION,handler:async n=>(n.get(Ut).triggerSheetBarMenu(),!0)},Ci={type:a.CommandType.COMMAND,id:"sheet.command.delete-worksheet-protection-from-sheet-bar",async handler(n,o){if(!o)return!1;const e=n.get(a.ICommandService),t=n.get(a.IUndoRedoService),i=n.get(m.WorksheetProtectionRuleModel),s=n.get(a.IUniverInstanceService).getCurrentUnitForType(va.UNIVER_SHEET),l=s==null?void 0:s.getActiveSheet(),c=s.getUnitId();if(!l)return!1;const d=l.getSheetId(),u=i.getRule(c,d);if(await e.executeCommand(m.DeleteWorksheetProtectionCommand.id,{unitId:c,subUnitId:d})){const g=[{id:m.DeleteWorksheetProtectionCommand.id,params:{unitId:c,subUnitId:d}}],S=[{id:m.AddWorksheetProtectionCommand.id,params:{unitId:c,rule:u}}];t.pushUndoRedo({unitID:c,redoMutations:g,undoMutations:S})}return!0}},Ii={type:a.CommandType.COMMAND,id:"sheet.command.change-sheet-protection-from-sheet-bar",async handler(n){return await n.get(a.ICommandService).executeCommand("sheet-permission.operation.openDialog"),!0}},so={id:"sheet.operation.set-activate-cell-edit",type:a.CommandType.OPERATION,handler:(n,o)=>(n.get(me).setEditCell(o),!0)},Se={id:"sheet.operation.set-cell-edit-visible",type:a.CommandType.OPERATION,handler:(n,o)=>{if(!o)return!1;const{unitId:e}=o,i=n.get(a.IUniverInstanceService).getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET);return i?(n.get(me).changeVisible({...o,unitId:e!=null?e:i.getUnitId()}),!0):!1}},_i={id:"sheet.operation.set-cell-edit-visible-f2",type:a.CommandType.OPERATION,handler:(n,o)=>{const e=n.get(a.ICommandService),i=n.get(a.IUniverInstanceService).getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET);return i?e.syncExecuteCommand(Se.id,{...o,unitId:i.getUnitId()}):!1}},Bt={id:"sheet.operation.set-cell-edit-visible-arrow",type:a.CommandType.OPERATION,handler:()=>!0},bi={id:"sheet.operation.rename-sheet",type:a.CommandType.OPERATION,handler:async(n,o)=>{const e=n.get(Ut);return o&&e.setRenameId(o.subUnitId),!0}},ao={id:"sheet.operation.scroll-to-range",type:a.CommandType.OPERATION,handler:(n,o)=>{if(!o)return!1;const e=n.get(a.IUniverInstanceService);return n.get(M.IRenderManagerService).getRenderById(e.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET).getUnitId()).with(y.SheetsScrollRenderController).scrollToRange(o.range,o.forceTop,o.forceLeft)}},vr={type:a.CommandType.OPERATION,id:"sheet-permission.operation.openDialog",async handler(n,o){const e=n.get(I.IDialogService);return e.close("DESKTOP_FIND_REPLACE_DIALOG"),e.open({id:eo,title:{title:"permission.dialog.allowedPermissionType"},children:{label:Ca},width:393,destroyOnClose:!0,onClose:()=>e.close(eo)}),!0}},wi="DefinedNameContainer",lo={id:"sidebar.operation.defined-name",type:a.CommandType.COMMAND,handler:async(n,o)=>{const e=n.get(I.ISidebarService);n.get(q.IEditorService);const t=n.get(a.LocaleService),i=n.get(a.IUniverInstanceService),r=m.getSheetCommandTarget(i);if(!r)return!1;const{unitId:s}=r;switch(o.value){case"open":e.open({id:wi,header:{title:t.t("definedName.featureTitle")},children:{label:wi},onClose:()=>{},width:333});break;case"close":default:e.close();break}return!0}};function rh(n,o){if(n.length!==o.length)return!1;const e=n.sort((i,r)=>i.id.localeCompare(r.id)),t=o.sort((i,r)=>i.id.localeCompare(r.id));return e.every((i,r)=>{var s,l;return((s=i.subject)==null?void 0:s.userID)===((l=t[r].subject)==null?void 0:l.userID)&&i.role===t[r].role})}function Ta(n,o){return o.some(e=>sh(n,e))}function sh(n,o){const{startRow:e,startColumn:t,endColumn:i,endRow:r}=o,s=n.getMatrixWithMergedCells(e,t,r,i);let l=!1;return s.forValue((c,d,u)=>{if(u&&(c!==e||d!==t)&&n.cellHasValue(u))return l=!0,!1}),l}function ya(n,o,e,t){const i=[],r=[],s=e.getSheetId();return t.forEach(l=>{const c=ah(e,l),d={unitId:o,subUnitId:s,cellValue:c.getData()},u=m.SetRangeValuesUndoMutationFactory(n,d);i.push({id:m.SetRangeValuesMutation.id,params:u}),r.push({id:m.SetRangeValuesMutation.id,params:d})}),{undos:i,redos:r}}function ah(n,o){const{startRow:e,startColumn:t,endColumn:i,endRow:r}=o,s=n.getMatrixWithMergedCells(e,t,r,i,a.CellModeEnum.Raw),l=new a.ObjectMatrix;let c=null;return s.forValue((d,u,h)=>{var g,S,f,v;h&&d>=e&&u>=t&&(!c&&n.cellHasValue(h)&&(h.v!==""||((v=(f=(S=(g=h.p)==null?void 0:g.body)==null?void 0:S.dataStream)==null?void 0:f.length)!=null?v:0)>2)&&(c=h),l.setValue(d,u,null))}),l.setValue(e,t,c),l}function lh(n,o,e,t){const i=e.getActiveViewportByCoord(M.Vector2.FromArray([n,o]));if(!i)return;const{scaleX:r,scaleY:s}=e.getAncestorScale(),l={x:i.viewportScrollX,y:i.viewportScrollY},c=t.getCellIndexByOffset(n,o,r,s,l),d=t.worksheet.getMergedCell(c.row,c.column);return{actualRow:d?d.startRow:c.row,actualCol:d?d.startColumn:c.column,mergeCell:d,row:c.row,col:c.column}}function Ra(n,o,e,t){const i=t.getFreeze();if(!i||i.startRow<=0&&i.startColumn<=0||n>=i.startRow&&o>=i.startColumn)return e.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN);if(n<i.startRow&&o<i.startColumn)return e.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP);if(n<i.startRow&&o>=i.startColumn)return e.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP);if(n>=i.startRow&&o<i.startColumn)return e.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT)}function ch(n,o,e,t){const i=Ma(n.left,n.top,o,e,t),r=Ma(n.right,n.bottom,o,e,t);return{left:i.x,top:i.y,right:r.x,bottom:r.y}}function Ma(n,o,e,t,i){const{scaleX:r,scaleY:s}=e.getAncestorScale(),l=e.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN);if(!l)return{x:n,y:o};const c=i.getFreeze(),{startColumn:d,startRow:u,xSplit:h,ySplit:g}=c,S=t.getNoMergeCellWithCoordByIndex(u-g,d-h,!1),f=t.getNoMergeCellWithCoordByIndex(u,d,!1),{rowHeaderWidth:v,columnHeaderHeight:p}=t,C=f.startX-S.startX,_=f.startY-S.startY,{top:w,left:E,viewportScrollX:O,viewportScrollY:T}=l;let P;n>E?P=(n-O)*r:P=(C+v-(E-n))*r;let A;return o>w?A=(o-T)*s:A=(_+p-(w-o))*r,{x:P,y:A}}function Pa(n,o,e,t,i){let r=t,s=i;e.overflowCache.forValue((d,u,h)=>{h.startRow<=r&&h.endRow>=r&&h.startColumn<=s&&h.endColumn>=s&&(s=u,r=d)});const l=e.getCellWithCoordByIndex(r,s);return{unitId:n.getUnitId(),subUnitId:o.getSheetId(),workbook:n,worksheet:o,row:l.actualRow,col:l.actualColumn}}function Oa(n,o,e,t,i,r){const{scene:s}=n,l=o.getUnitId(),{skeleton:c,sheetId:d}=t,u=lh(i,r,s,c);if(!u)return null;let{actualCol:h,actualRow:g}=u;const S={unitId:l,subUnitId:d,workbook:o,worksheet:e,row:g,col:h};c.overflowCache.forValue((T,P,A)=>{A.startRow<=g&&A.endRow>=g&&A.startColumn<=h&&A.endColumn>=h&&(h=P,g=T)});const f=c.getCellWithCoordByIndex(g,h),v=Pa(o,e,c,g,h);let p;f.mergeInfo?p=f.mergeInfo:p={startRow:v.row,endRow:v.row,startColumn:v.col,endColumn:v.col};const C=s.getActiveViewportByCoord(M.Vector2.FromArray([i,r]));if(!C)return;const{scaleX:_,scaleY:w}=s.getAncestorScale(),E={x:C.viewportScrollX,y:C.viewportScrollY};return{position:{startX:(c.getOffsetByColumn(p.startColumn-1)-E.x)*_,endX:(c.getOffsetByColumn(p.endColumn)-E.x)*_,startY:(c.getOffsetByRow(p.startRow-1)-E.y)*w,endY:(c.getOffsetByRow(p.endRow)-E.y)*w},location:S,overflowLocation:v}}function St(){const n=I.useDependency(a.IUniverInstanceService),o=I.useObservable(()=>n.getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET),void 0,void 0,[]);return o!=null?o:null}function dh(n){return I.useObservable(()=>{var e;return(e=n==null?void 0:n.activeSheet$)!=null?e:N.of(null)},void 0,void 0,[n])}function uh(){const n=I.useDependency(a.IUniverInstanceService);return I.useObservable(()=>N.merge([n.getTypeOfUnitAdded$(a.UniverInstanceType.UNIVER_SHEET),n.getTypeOfUnitDisposed$(a.UniverInstanceType.UNIVER_SHEET)]).pipe(N.map(()=>n.getAllUnitsForType(a.UniverInstanceType.UNIVER_SHEET)),N.startWith(n.getAllUnitsForType(a.UniverInstanceType.UNIVER_SHEET))),[],void 0,[n])}const hh="SheetUI";var pr=(n=>(n.FILTER_PANEL_EMBED_POINT="filter-panel-embed-point",n.SHEETS_FOOTER="sheets-footer",n.FORMULA_AUX="formula-aux",n))(pr||{}),mh=Object.getOwnPropertyDescriptor,gh=(n,o,e,t)=>{for(var i=t>1?void 0:t?mh(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},co=(n,o)=>(e,t)=>o(e,t,n);const Aa="univer-sheet-main-canvas";y.SheetsRenderService=class extends a.RxDisposable{constructor(e,t,i,r){super();R(this,"_skeletonChangeMutations",new Set);this._contextService=e,this._instanceSrv=t,this._renderManagerService=i,this._themeService=r,Promise.resolve().then(()=>this._init())}registerSkeletonChangingMutations(e){return this._skeletonChangeMutations.has(e)?a.toDisposable(()=>{}):(this._skeletonChangeMutations.add(e),a.toDisposable(()=>this._skeletonChangeMutations.delete(e)))}checkMutationShouldTriggerRerender(e){return this._skeletonChangeMutations.has(e)}_init(){this._initWorkbookListener(),this._initContextListener()}_initWorkbookListener(){this._instanceSrv.getTypeOfUnitAdded$(a.UniverInstanceType.UNIVER_SHEET).pipe(N.takeUntil(this.dispose$)).subscribe(e=>this._createRenderer(e)),this._instanceSrv.getAllUnitsForType(a.UniverInstanceType.UNIVER_SHEET).forEach(e=>this._createRenderer(e)),this._instanceSrv.getTypeOfUnitDisposed$(a.UniverInstanceType.UNIVER_SHEET).pipe(N.takeUntil(this.dispose$)).subscribe(e=>this._disposeRenderer(e))}_createRenderer(e){const t=e.getUnitId();this._renderManagerService.created$.subscribe(i=>{i.unitId===t&&(i.engine.getCanvas().setId(`${Aa}_${t}`),i.engine.getCanvas().getContext().setId(`${Aa}_${t}`))}),this._renderManagerService.createRender(t)}_disposeRenderer(e){const t=e.getUnitId();this._renderManagerService.removeRender(t)}_initContextListener(){this.disposeWithMe(this._contextService.subscribeContextValue$(M.RENDER_RAW_FORMULA_KEY).pipe(N.distinctUntilChanged()).subscribe(()=>{this._renderManagerService.getRenderAll().forEach(e=>{e.mainComponent instanceof M.Spreadsheet&&e.mainComponent.makeForceDirty(!0)})}))}},y.SheetsRenderService=gh([co(0,a.IContextService),co(1,a.IUniverInstanceService),co(2,M.IRenderManagerService),co(3,a.Inject(a.ThemeService))],y.SheetsRenderService);var Sh=Object.getOwnPropertyDescriptor,fh=(n,o,e,t)=>{for(var i=t>1?void 0:t?Sh(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Ft=(n,o)=>(e,t)=>o(e,t,n);y.AutoFillController=class extends a.Disposable{constructor(e,t,i,r,s,l,c){super();R(this,"_beforeApplyData",[]);R(this,"_currentLocation",null);R(this,"_copyData",[]);R(this,"_defaultHook");this._univerInstanceService=e,this._commandService=t,this._autoFillService=i,this._editorBridgeService=r,this._renderManagerService=s,this._injector=l,this._sheetsRenderService=c,this._defaultHook={id:"default",type:en.Default,priority:0,onBeforeFillData:(d,u)=>this._presetAndCacheData(d,u),onFillData:(d,u,h)=>this._fillData(d,u,h)},this._init()}_init(){this._initDefaultHook(),this._initSelectionControlFillChanged(),this._initQuitListener(),this._initSkeletonChange()}_initSkeletonChange(){this.disposeWithMe(this._sheetsRenderService.registerSkeletonChangingMutations(dt.id))}_initDefaultHook(){this.disposeWithMe(this._autoFillService.addHook(this._defaultHook))}_initQuitListener(){const e=[Se.id,nn.id,m.SetRangeValuesCommand.id,je.id,m.SetWorksheetActiveOperation.id,m.MoveRangeMutation.id,m.RemoveRowMutation.id,m.RemoveColMutation.id,m.InsertRowMutation.id,m.InsertColMutation.id,m.MoveRowsMutation.id,m.MoveColsMutation.id,m.SetWorksheetColWidthMutation.id,m.SetWorksheetRowHeightMutation.id,m.SetRangeValuesMutation.id];this.disposeWithMe(this._commandService.onCommandExecuted((t,i)=>{var c,d;const r=i==null?void 0:i.fromCollab,s=i==null?void 0:i.fromSync,l=i==null?void 0:i.fromFormula;e.includes(t.id)&&!r&&!s&&!l&&t.params.trigger!==dt.id&&t.params.trigger!==ci.id&&this._quit(),t.id===m.RemoveSheetMutation.id&&t.params.unitId===((c=this._currentLocation)==null?void 0:c.unitId)&&t.params.subUnitId===((d=this._currentLocation)==null?void 0:d.subUnitId)&&this._quit()})),this.disposeWithMe(this._univerInstanceService.unitDisposed$.subscribe(t=>{var i;t.getUnitId()===((i=this._currentLocation)==null?void 0:i.unitId)&&this._quit()}))}_quit(){this._currentLocation=null,this._beforeApplyData=[],this._copyData=[],this._autoFillService.setShowMenu(!1)}_initSelectionControlFillChanged(){const e=new a.DisposableCollection,t=()=>{e.dispose();const i=M.getCurrentTypeOfRenderer(a.UniverInstanceType.UNIVER_SHEET,this._univerInstanceService,this._renderManagerService);if(!i)return;i.with(Ie).getSelectionControls().forEach(l=>{e.add(l.selectionFilled$.subscribe(c=>{if(c==null||c.startColumn===-1||c.startRow===-1||c.endColumn===-1||c.endRow===-1)return;const d={startColumn:l.model.startColumn,endColumn:l.model.endColumn,startRow:l.model.startRow,endRow:l.model.endRow},u={startColumn:c.startColumn,endColumn:c.endColumn,startRow:c.startRow,endRow:c.endRow};this._commandService.executeCommand(dt.id,{sourceRange:d,targetRange:u})})),e.add(l.fillControl.onDblclick$.subscribeEvent(()=>{const c={startColumn:l.model.startColumn,endColumn:l.model.endColumn,startRow:l.model.startRow,endRow:l.model.endRow};this._handleDbClickFill(c)})),e.add(l.fillControl.onPointerDown$.subscribeEvent(()=>{this._editorBridgeService.isVisible().visible&&this._commandService.syncExecuteCommand(Se.id,{visible:!1,eventType:M.DeviceInputEventType.PointerDown,unitId:i.unitId})}))})};t(),this.disposeWithMe(this._commandService.onCommandExecuted(i=>{i.id===m.SetSelectionsOperation.id&&t()})),this.disposeWithMe(this._univerInstanceService.getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET).subscribe(()=>t()))}_handleDbClickFill(e){const t=this._detectFillRange(e);t.endRow<=e.endRow||this._commandService.executeCommand(dt.id,{sourceRange:e,targetRange:t})}_detectFillRange(e){var g,S,f,v,p,C;const{startRow:t,endRow:i,startColumn:r,endColumn:s}=e,l=(g=this._univerInstanceService.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET))==null?void 0:g.getActiveSheet();if(!l)return e;const c=l.getCellMatrix(),d=l.getMaxRows()-1,u=l.getMaxColumns()-1;let h=i;if(r>0&&((S=c.getValue(t,r-1))==null?void 0:S.v)!=null){let _=t;for(;((f=c.getValue(_,r-1))==null?void 0:f.v)!=null&&_<d;)_+=1;h=_-1}else if(s<u&&((v=c.getValue(i,s+1))==null?void 0:v.v)!=null){let _=t;for(;((p=c.getValue(_,s+1))==null?void 0:p.v)!=null&&_<d;)_+=1;h=_-1}for(let _=i+1;_<=h;_++)for(let w=r;w<=s;w++)if(((C=c.getValue(_,w))==null?void 0:C.v)!=null){h=_-1;break}return{startColumn:r,endColumn:s,startRow:t,endRow:h}}_getApplyData(e,t,i,r,s,l=!0,c){const d=[],u=Math.floor(i/t),h=i%t,g=this._autoFillService.getRules();if(!l&&s===le.ONLY_FORMAT)return console.error("ERROR: only format can not be applied when hasStyle is false"),[];const S={};g.forEach(f=>{S[f.type]=[]}),g.forEach(f=>{const{type:v,applyFunctions:p={}}=f,C=e[v];C&&C.forEach(_=>{const w=Od(_.index,h),E=_.index.length*u+w,O=this._applyFunctions(_,E,r,s,p,e,c),T=Ad(t,i,_.index);S[v].push({data:O,index:T})})});for(let f=0;f<i;f++)g.forEach(v=>{const{type:p}=v,C=S[p];for(let _=0;_<C.length;_++)f in C[_].index&&d.push(C[_].data[C[_].index[f]])});return d}_applyFunctions(e,t,i,r,s,l,c){const{data:d}=e,u=i===a.Direction.UP||i===a.Direction.LEFT;if(r===le.COPY){const h=s==null?void 0:s[le.COPY];return h?h(e,t,i,l,c):(u&&d.reverse(),Et(d,t))}if(r===le.SERIES){const h=s==null?void 0:s[le.SERIES];return h?h(e,t,i,l):(u&&d.reverse(),s!=null&&s[le.COPY]?s[le.COPY](e,t,i,l,c):Et(d,t))}if(r===le.ONLY_FORMAT){const h=s==null?void 0:s[le.ONLY_FORMAT];return h?h(e,t,i,l):Dd(d,t)}}_getCopyData(e,t){var f;const{unitId:i,subUnitId:r,source:s}=e,l=(f=this._univerInstanceService.getUnit(i))==null?void 0:f.getSheetBySheetId(r);if(!l)throw new Error("No worksheet found");const c=l.getCellMatrix(),d=this._autoFillService.getRules(),u=[],h=t===a.Direction.DOWN||t===a.Direction.UP;let g,S;return h?(g=s.cols,S=s.rows):(g=s.rows,S=s.cols),g.forEach(v=>{const p=this._getEmptyCopyDataPiece(),C={type:void 0,cellData:void 0};S.forEach(_=>{let w;h?w=c.getValue(_,v):w=c.getValue(v,_);const{type:E,isContinue:O}=d.find(T=>T.match(w,this._injector))||qs;if(O(C,w)){const T=p[E],P=T[T.length-1];P.data.push(w),P.index.push(_-S[0])}else{const T=p[E];T?T.push({data:[w],index:[_-S[0]]}):p[E]=[{data:[w],index:[_-S[0]]}]}C.type=E,C.cellData=w}),u.push(p)}),u}_getEmptyCopyDataPiece(){const e={};return this._autoFillService.getRules().forEach(t=>{e[t.type]=[]}),e}_getMergeApplyData(e,t,i,r,s){var h;const{unitId:l,subUnitId:c}=s,d=(h=this._univerInstanceService.getUnit(l))==null?void 0:h.getSheetBySheetId(c);if(!d)throw new Error("No active sheet found");const u=[];for(let g=e.startRow;g<=e.endRow;g++)for(let S=e.startColumn;S<=e.endColumn;S++){const{isMergedMainCell:f,startRow:v,startColumn:p,endRow:C,endColumn:_}=d.getCellInfoInMergeData(g,S);if(f){if(i===a.Direction.DOWN){let w=v+r,E=C+r;for(;E<=t.endRow;)u.push({startRow:w,startColumn:p,endRow:E,endColumn:_}),w+=r,E+=r}else if(i===a.Direction.UP){let w=v-r,E=C-r;for(;w>=t.startRow;)u.push({startRow:w,startColumn:p,endRow:E,endColumn:_}),w-=r,E-=r}else if(i===a.Direction.RIGHT){let w=p+r,E=_+r;for(;E<=t.endColumn;)u.push({startRow:v,startColumn:w,endRow:C,endColumn:E}),w+=r,E+=r}else if(i===a.Direction.LEFT){let w=p-r,E=_-r;for(;w>=t.startColumn;)u.push({startRow:v,startColumn:w,endRow:C,endColumn:E}),w-=r,E-=r}}}return u}_presetAndCacheData(e,t){var u;const{unitId:i,subUnitId:r,target:s}=e,l=(u=this._univerInstanceService.getUnit(i))==null?void 0:u.getSheetBySheetId(r);if(!l)throw new Error("No active sheet found");const c=l.getCellMatrix(),d=[];return s.rows.forEach(h=>{const g=[];s.cols.forEach(S=>{g.push(a.Tools.deepClone(c.getValue(h,S)))}),d.push(g)}),this._beforeApplyData=d,this._copyData=this._getCopyData(e,t),this._currentLocation=e,this._shouldDisableSeries(this._copyData)?(this._autoFillService.setDisableApplyType(le.SERIES,!0),le.COPY):(this._autoFillService.setDisableApplyType(le.SERIES,!1),this._getPreferredApplyType(this._copyData))}_fillData(e,t,i){var L,W,B;const r=[],s=[];let l=!0;i===le.NO_FORMAT&&(l=!1,i=le.SERIES);const{source:c,target:d,unitId:u,subUnitId:h}=e;if(!c||!d||t==null)return{undos:r,redos:s};const g=at(c),S=at(d),{cols:f,rows:v}=d,{cols:p,rows:C}=c,_=this._copyData;let w;t===a.Direction.DOWN||t===a.Direction.UP?w=C.length:w=p.length;const E=[];if(t===a.Direction.DOWN||t===a.Direction.UP){const U=v.length,z=[];f.forEach((F,j)=>{const Y=_[j],Q=this._getApplyData(Y,w,U,t,i,l,e);z.push(Q)});for(let F=0;F<z[0].length;F++){const j=[];for(let Y=0;Y<z.length;Y++)j.push({s:null,...z[Y][F]});E.push(j)}}else{const U=f.length;v.forEach((z,F)=>{const j=_[F],Y=this._getApplyData(j,w,U,t,i,l,e),Q=[];for(let oe=0;oe<Y.length;oe++)Q.push({s:null,...Y[oe]});E.push(Q)})}let O=[];const T=(L=this._univerInstanceService.getUnit(u))==null?void 0:L.getStyles();if(l?(O=this._getMergeApplyData(g,S,t,w,e),E.forEach(U=>{U.forEach(z=>{z&&T&&T&&(z.s=T.getStyleByCell(z))})})):E.forEach((U,z)=>{U.forEach((F,j)=>{F&&T&&(F.s=T.getStyleByCell(this._beforeApplyData[z][j])||null)})}),i===le.ONLY_FORMAT&&E.forEach((U,z)=>{U.forEach((F,j)=>{if(F){const Y=this._beforeApplyData[z][j]||{};F.f=Y.f,F.si=Y.si,F.t=Y.t,F.v=Y.v}})}),l){const U=[],z=(B=(W=this._univerInstanceService.getUniverSheetInstance(u))==null?void 0:W.getSheetBySheetId(h))==null?void 0:B.getMergeData();z&&z.forEach(Y=>{a.Rectangle.intersects(Y,S)&&U.push(Y)});const F={unitId:u,subUnitId:h,ranges:U},j=this._injector.invoke(m.RemoveMergeUndoMutationFactory,F);U.length&&(s.push({id:m.RemoveWorksheetMergeMutation.id,params:F}),r.unshift({id:m.AddWorksheetMergeMutation.id,params:j}))}const P={subUnitId:h,unitId:u,cellValue:wd([d])},A=this._injector.invoke(m.SetRangeValuesUndoMutationFactory,P);s.push({id:m.SetRangeValuesMutation.id,params:P}),r.unshift({id:m.SetRangeValuesMutation.id,params:A});const D=new a.ObjectMatrix;v.forEach((U,z)=>{f.forEach((F,j)=>{E[z][j]&&D.setValue(U,F,E[z][j])})});const k=D.getMatrix(),H={subUnitId:h,unitId:u,cellValue:k},V=this._injector.invoke(m.SetRangeValuesUndoMutationFactory,H);if(this._autoFillService.getActiveHooks().forEach(U=>{var z;(z=U.onBeforeSubmit)==null||z.call(U,e,t,i,k)}),r.unshift({id:m.SetRangeValuesMutation.id,params:V}),s.push({id:m.SetRangeValuesMutation.id,params:H}),O!=null&&O.length){const U=m.getAddMergeMutationRangeByType(O),z={unitId:u,subUnitId:h,ranges:U},F=this._injector.invoke(m.AddMergeUndoMutationFactory,z);r.unshift({id:m.RemoveWorksheetMergeMutation.id,params:F}),s.push({id:m.AddWorksheetMergeMutation.id,params:z})}return{undos:r,redos:s}}_shouldDisableSeries(e){return e.every(t=>Object.keys(t).every(i=>{var r;return((r=t[i])==null?void 0:r.length)===0||[_e.OTHER,_e.FORMULA].includes(i)}))}_getPreferredApplyType(e){return e.every(i=>Object.keys(i).every(r=>{var s,l;return((s=i[r])==null?void 0:s.length)===0||((l=i[r])==null?void 0:l.length)===1&&i[r][0].data.length===1&&_e.NUMBER===r}))?le.COPY:le.SERIES}},y.AutoFillController=fh([Ft(0,a.IUniverInstanceService),Ft(1,a.ICommandService),Ft(2,ct),Ft(3,me),Ft(4,M.IRenderManagerService),Ft(5,a.Inject(a.Injector)),Ft(6,a.Inject(y.SheetsRenderService))],y.AutoFillController);var vh=Object.getOwnPropertyDescriptor,ph=(n,o,e,t)=>{for(var i=t>1?void 0:t?vh(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Cr=(n,o)=>(e,t)=>o(e,t,n);y.CellCustomRenderController=class extends a.Disposable{constructor(e,t,i,r){super();R(this,"_enterActiveRender");this._context=e,this._sheetSkeletonManagerService=t,this._renderManagerService=i,this._permissionService=r,this._initEventBinding()}_initEventBinding(){const e=new a.DisposableCollection,t=this._context.unit,i=r=>{if(e.dispose(),!r)return;const s=this._context.unitId,{skeleton:l}=r,c=this._renderManagerService.getRenderById(s);if(c&&c.mainComponent){const d=c.mainComponent,u=S=>{const{offsetX:f,offsetY:v}=S,p=c.scene,C=t.getActiveSheet();if(!C)return;const _=p.getActiveViewportByCoord(M.Vector2.FromArray([f,v]));if(!_)return;const{scaleX:w,scaleY:E}=p.getAncestorScale(),O={x:_.viewportScrollX,y:_.viewportScrollY},T=l.getCellIndexByOffset(f,v,w,E,O),P=l.worksheet.getMergedCell(T.row,T.column),A={actualRow:P?P.startRow:T.row,actualCol:P?P.startColumn:T.column,row:T.row,col:T.column};if(!A||!l)return;const D=C.getCell(A.actualRow,A.actualCol);if(!D)return;const k=D.customRender;if(!(k!=null&&k.length))return;const H=A.actualRow,V=A.actualCol,L=k.sort(a.sortRules),W=C.getSheetId(),B={data:D,style:l.getStyles().getStyleByCell(D),primaryWithCoord:l.getCellWithCoordByIndex(A.actualRow,A.actualCol),unitId:s,subUnitId:W,row:H,col:V,workbook:t,worksheet:C},U={x:O.x+f/w,y:O.y+v/E},z=L.find(F=>{var j;return(j=F.isHit)==null?void 0:j.call(F,U,B)});if(z)return[z,B]},h=d.onPointerDown$.subscribeEvent(S=>{var v,p,C,_;const f=u(S);if(f){const[w,E]=f,{row:O,col:T,worksheet:P,unitId:A,subUnitId:D}=E;if(!((v=this._permissionService.composePermission([new m.WorkbookEditablePermission(A).id,new m.WorksheetEditPermission(A,D).id]))==null?void 0:v.every(V=>V.value)))return!1;const H=(C=(p=P.getCell(O,T))==null?void 0:p.selectionProtection)==null?void 0:C[0];if((H==null?void 0:H[m.UnitAction.Edit])===!1)return!1;(_=w.onPointerDown)==null||_.call(w,E,S)}}),g=a.fromEventSubject(d.onPointerMove$).pipe(N.throttleTime(30)).subscribe(S=>{var v,p,C,_,w,E;const f=u(S);if(f){const[O,T]=f;this._enterActiveRender?this._enterActiveRender.render!==O&&((p=(v=this._enterActiveRender.render).onPointerLeave)==null||p.call(v,this._enterActiveRender.cellContext,S),this._enterActiveRender={render:O,cellContext:T},(C=O.onPointerEnter)==null||C.call(O,T,S)):(this._enterActiveRender={render:O,cellContext:T},(_=O.onPointerEnter)==null||_.call(O,T,S))}else this._enterActiveRender&&((E=(w=this._enterActiveRender.render).onPointerLeave)==null||E.call(w,this._enterActiveRender.cellContext,S),this._enterActiveRender=null)});h&&e.add(h),g&&e.add(g)}};this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(i)),i(this._sheetSkeletonManagerService.getCurrentParam()),this.disposeWithMe(e)}},y.CellCustomRenderController=ph([Cr(1,a.Inject(y.SheetSkeletonManagerService)),Cr(2,M.IRenderManagerService),Cr(3,a.IPermissionService)],y.CellCustomRenderController);var Ch=Object.getOwnPropertyDescriptor,Ih=(n,o,e,t)=>{for(var i=t>1?void 0:t?Ch(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Da=(n,o)=>(e,t)=>o(e,t,n);y.DragManagerService=class extends a.Disposable{constructor(e,t){super();R(this,"_currentCell$",new N.Subject);R(this,"currentCell$",this._currentCell$.asObservable().pipe(N.distinctUntilChanged((e,t)=>{var i,r,s,l,c,d,u,h;return((i=e==null?void 0:e.location)==null?void 0:i.unitId)===((r=t==null?void 0:t.location)==null?void 0:r.unitId)&&((s=e==null?void 0:e.location)==null?void 0:s.subUnitId)===((l=t==null?void 0:t.location)==null?void 0:l.subUnitId)&&((c=e==null?void 0:e.location)==null?void 0:c.row)===((d=t==null?void 0:t.location)==null?void 0:d.row)&&((u=e==null?void 0:e.location)==null?void 0:u.col)===((h=t==null?void 0:t.location)==null?void 0:h.col)})));R(this,"_endCell$",new N.Subject);R(this,"endCell$",this._endCell$.asObservable());this._univerInstanceService=e,this._renderManagerService=t,this._initCellDisposableListener()}dispose(){super.dispose(),this._currentCell$.complete(),this._endCell$.complete()}_initCellDisposableListener(){this.disposeWithMe(this._univerInstanceService.getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET).subscribe(e=>{e||(this._currentCell$.next(null),this._endCell$.next(null))}))}_calcActiveCell(e,t){const i=this._univerInstanceService.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET);if(!i)return null;const r=i.getActiveSheet();if(!r)return;const s=this._renderManagerService.getRenderById(i.getUnitId());if(!s)return;const l=s.with(y.SheetSkeletonManagerService).getCurrentParam(),d=s.with(y.SheetScrollManagerService).getCurrentScrollState();if(!(!l||!d||!s))return Oa(s,i,r,l,e,t)}onDragOver(e){const{offsetX:t,offsetY:i,dataTransfer:r}=e,s=this._calcActiveCell(t,i);if(!s){this._currentCell$.next(null);return}const{location:l,position:c}=s;this._currentCell$.next({location:l,position:c,dataTransfer:r})}onDrop(e){const{offsetX:t,offsetY:i,dataTransfer:r}=e,s=this._calcActiveCell(t,i);if(!s){this._endCell$.next(null);return}const{location:l,position:c}=s;this._endCell$.next({location:l,position:c,dataTransfer:r})}},y.DragManagerService=Ih([Da(0,a.IUniverInstanceService),Da(1,M.IRenderManagerService)],y.DragManagerService);var _h=Object.getOwnPropertyDescriptor,bh=(n,o,e,t)=>{for(var i=t>1?void 0:t?_h(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Ir=(n,o)=>(e,t)=>o(e,t,n);y.DragRenderController=class extends a.Disposable{constructor(o,e,t,i){super(),this._context=o,this._renderManagerService=e,this._dragManagerService=t,this._sheetSkeletonManagerService=i,this._initDragEvent()}_initDragEvent(){const o=new a.DisposableCollection,e=t=>{if(o.dispose(),!t)return;const{scene:i}=this._context,r=i.onDragOver$.subscribeEvent(l=>{this._dragManagerService.onDragOver(l)}),s=i.onDrop$.subscribeEvent(l=>{this._dragManagerService.onDrop(l)});o.add({dispose(){r.unsubscribe(),s.unsubscribe()}})};e(this._sheetSkeletonManagerService.getCurrentParam()),this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(t=>{e(t)}))}},y.DragRenderController=bh([Ir(1,M.IRenderManagerService),Ir(2,a.Inject(y.DragManagerService)),Ir(3,a.Inject(y.SheetSkeletonManagerService))],y.DragRenderController);class _r{constructor(){R(this,"_state",null);R(this,"_rect",null);R(this,"_state$",new N.BehaviorSubject(null));R(this,"state$",this._state$.asObservable());R(this,"_rect$",new N.BehaviorSubject(null));R(this,"rect$",this._rect$.asObservable());R(this,"_focus",!1);R(this,"_focus$",new N.BehaviorSubject(this._focus));R(this,"focus$",this._focus$.asObservable())}dispose(){this._state$.complete(),this._state=null,this._rect$.complete(),this._rect=null}setState(o){this._state=o,this._refresh(o)}getRect(){return this._rect}setRect(o){this._rect=o,this._rect$.next(o)}getState(){return this._state}setFocus(o=!1){this._focus=o,this._focus$.next(o)}_refresh(o){this._state$.next(o)}}const En=a.createIdentifier("univer.sheet-cell-editor-manager.service"),Te="sheets-ui.config",uo={formulaBar:!0,statusBarStatistic:!0,protectedRangeShadow:!0,maxAutoHeightCount:1e3};function br(n){return n===!0?"always":n===!1?"none":n||"always"}function pe({ref:n,...o}){const{icon:e,id:t,className:i,extend:r,...s}=o,l=`univerjs-icon univerjs-icon-${t} ${i||""}`.trim(),c=x.useRef(`_${Th()}`);return Na(e,`${t}`,{defIds:e.defIds,idSuffix:c.current},{ref:n,className:l,...s},r)}function Na(n,o,e,t,i){return x.createElement(n.tag,{key:o,...wh(n,e,i),...t},(Eh(n,e).children||[]).map((r,s)=>Na(r,`${o}-${n.tag}-${s}`,e,void 0,i)))}function wh(n,o,e){const t={...n.attrs};e!=null&&e.colorChannel1&&t.fill==="colorChannel1"&&(t.fill=e.colorChannel1),n.tag==="mask"&&t.id&&(t.id=t.id+o.idSuffix),Object.entries(t).forEach(([r,s])=>{r==="mask"&&typeof s=="string"&&(t[r]=s.replace(/url\(#(.*)\)/,`url(#$1${o.idSuffix})`))});const{defIds:i}=o;return!i||i.length===0||(n.tag==="use"&&t["xlink:href"]&&(t["xlink:href"]=t["xlink:href"]+o.idSuffix),Object.entries(t).forEach(([r,s])=>{typeof s=="string"&&(t[r]=s.replace(/url\(#(.*)\)/,`url(#$1${o.idSuffix})`))})),t}function Eh(n,o){var t;const{defIds:e}=o;return!e||e.length===0?n:n.tag==="defs"&&((t=n.children)!=null&&t.length)?{...n,children:n.children.map(i=>typeof i.attrs.id=="string"&&e&&e.includes(i.attrs.id)?{...i,attrs:{...i.attrs,id:i.attrs.id+o.idSuffix}}:i)}:n}function Th(){return Math.random().toString(36).substring(2,8)}pe.displayName="UniverIcon";const yh={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M14.1544 3.75557C14.3887 3.98988 14.3887 4.36978 14.1544 4.6041L6.51409 12.2444C6.40157 12.3569 6.24896 12.4201 6.08983 12.4201C5.9307 12.4201 5.77808 12.3569 5.66556 12.2444L1.84541 8.42425C1.6111 8.18993 1.6111 7.81003 1.84541 7.57572C2.07973 7.34141 2.45963 7.34141 2.69394 7.57572L6.08983 10.9716L13.3059 3.75557C13.5402 3.52126 13.9201 3.52126 14.1544 3.75557Z",fillRule:"evenodd",clipRule:"evenodd"}}]},zt=x.forwardRef(function(o,e){return x.createElement(pe,Object.assign({},o,{id:"check-mark-icon",ref:e,icon:yh}))});zt.displayName="CheckMarkIcon";const Rh={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.71274 2.86421C3.47843 2.6299 3.09853 2.6299 2.86421 2.86421C2.6299 3.09853 2.6299 3.47843 2.86421 3.71274L7.15154 8.00007L2.86421 12.2874C2.6299 12.5217 2.6299 12.9016 2.86421 13.1359C3.09853 13.3702 3.47843 13.3702 3.71274 13.1359L8.00007 8.84859L12.2874 13.1359C12.5217 13.3702 12.9016 13.3702 13.1359 13.1359C13.3702 12.9016 13.3702 12.5217 13.1359 12.2874L8.84859 8.00007L13.1359 3.71274C13.3702 3.47843 13.3702 3.09853 13.1359 2.86421C12.9016 2.6299 12.5217 2.6299 12.2874 2.86421L8.00007 7.15154L3.71274 2.86421Z"}}]},ka=x.forwardRef(function(o,e){return x.createElement(pe,Object.assign({},o,{id:"close-icon",ref:e,icon:Rh}))});ka.displayName="CloseIcon";const Mh={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"g",attrs:{fill:"currentColor",clipPath:"url(#convert-icon_clip0_911_593)"},children:[{tag:"path",attrs:{d:"M2.44766 0.848145C1.564 0.848145 0.847656 1.56449 0.847656 2.44814V6.44814C0.847656 7.3318 1.564 8.04814 2.44766 8.04814H6.44766C7.33131 8.04814 8.04766 7.3318 8.04766 6.44814V2.44814C8.04766 1.56449 7.33131 0.848145 6.44766 0.848145H2.44766ZM2.04766 6.44814V5.04824H3.84775V6.84814H2.44766C2.22674 6.84814 2.04766 6.66906 2.04766 6.44814ZM2.04766 3.84824H3.84775V2.04814H2.44766C2.22674 2.04814 2.04766 2.22723 2.04766 2.44814V3.84824ZM5.04775 6.84814V5.04824H6.84766V6.44814C6.84766 6.66906 6.66857 6.84814 6.44766 6.84814H5.04775ZM5.04775 3.84824H6.84766V2.44814C6.84766 2.22723 6.66857 2.04814 6.44766 2.04814H5.04775V3.84824Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{d:"M9.55215 7.95166C8.66849 7.95166 7.95215 8.668 7.95215 9.55166V13.5517C7.95215 14.4353 8.66849 15.1517 9.55215 15.1517L11.5522 15.1517L13.5521 15.1517C14.4358 15.1517 15.1521 14.4353 15.1521 13.5517L15.1521 11.5518L15.1521 9.55166C15.1521 8.668 14.4358 7.95166 13.5521 7.95166H9.55215ZM13.9521 10.9518V9.55166C13.9521 9.33075 13.7731 9.15166 13.5521 9.15166H12.1522V10.9518H13.9521ZM10.9522 10.9518V9.15166H9.55215C9.33123 9.15166 9.15215 9.33075 9.15215 9.55166V10.9518H10.9522ZM9.15215 12.1518H10.9522V13.9517H9.55215C9.33123 13.9517 9.15215 13.7726 9.15215 13.5517V12.1518ZM12.1522 12.1518H13.9521V13.5517C13.9521 13.7726 13.7731 13.9517 13.5521 13.9517H12.1522V12.1518Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{d:"M9.62158 2.44912C9.62158 2.11775 9.89021 1.84912 10.2216 1.84912H12.7516C13.6352 1.84912 14.3516 2.56547 14.3516 3.44912V5.9791C14.3516 6.31047 14.0829 6.5791 13.7516 6.5791C13.4202 6.5791 13.1516 6.31047 13.1516 5.9791V3.44912C13.1516 3.22821 12.9725 3.04912 12.7516 3.04912H10.2216C9.89021 3.04912 9.62158 2.78049 9.62158 2.44912Z"}},{tag:"path",attrs:{d:"M5.77871 14.1507C6.11008 14.1507 6.37871 13.8821 6.37871 13.5507C6.37871 13.2193 6.11008 12.9507 5.77871 12.9507L3.24873 12.9507C3.02782 12.9507 2.84873 12.7716 2.84873 12.5507L2.84873 10.0207C2.84873 9.68933 2.5801 9.4207 2.24873 9.4207C1.91736 9.4207 1.64873 9.68933 1.64873 10.0207L1.64873 12.5507C1.64873 13.4343 2.36507 14.1507 3.24873 14.1507H5.77871Z"}}]},{tag:"defs",attrs:{},children:[{tag:"clipPath",attrs:{id:"convert-icon_clip0_911_593"},children:[{tag:"path",attrs:{fill:"white",d:"M0 0H16V16H0z"}}]}]}],defIds:["convert-icon_clip0_911_593"]},Ha=x.forwardRef(function(o,e){return x.createElement(pe,Object.assign({},o,{id:"convert-icon",ref:e,icon:Mh}))});Ha.displayName="ConvertIcon";const Ph={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.3313 1.4667C5.3313 1.13533 5.59993 0.866699 5.9313 0.866699H10.069C10.4004 0.866699 10.669 1.13533 10.669 1.4667C10.669 1.79807 10.4004 2.0667 10.069 2.0667H5.9313C5.59993 2.0667 5.3313 1.79807 5.3313 1.4667Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.09985 3.64443C1.09985 3.31306 1.36848 3.04443 1.69985 3.04443H14.2999C14.6312 3.04443 14.8999 3.31306 14.8999 3.64443C14.8999 3.9758 14.6312 4.24443 14.2999 4.24443H1.69985C1.36848 4.24443 1.09985 3.9758 1.09985 3.64443Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M6.12398 8.30171C6.35829 8.0674 6.73819 8.0674 6.97251 8.30171L8.00007 9.32928L9.02764 8.30171C9.26195 8.0674 9.64185 8.0674 9.87617 8.30171C10.1105 8.53603 10.1105 8.91593 9.87617 9.15024L8.8486 10.1778L9.87617 11.2054C10.1105 11.4397 10.1105 11.8196 9.87617 12.0539C9.64185 12.2882 9.26195 12.2882 9.02764 12.0539L8.00007 11.0263L6.97251 12.0539C6.73819 12.2882 6.35829 12.2882 6.12398 12.0539C5.88966 11.8196 5.88966 11.4397 6.12398 11.2054L7.15154 10.1778L6.12398 9.15024C5.88966 8.91593 5.88966 8.53603 6.12398 8.30171Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.75332 5.22217C3.86966 5.22217 3.15332 5.93851 3.15332 6.82217V12.5331C3.15332 13.9691 4.31738 15.1332 5.75332 15.1332H10.2465C11.6825 15.1332 12.8465 13.9691 12.8465 12.5331V6.82217C12.8465 5.93851 12.1302 5.22217 11.2465 5.22217H4.75332ZM4.35332 6.82217C4.35332 6.60125 4.53241 6.42217 4.75332 6.42217H11.2465C11.4674 6.42217 11.6465 6.60125 11.6465 6.82217V12.5331C11.6465 13.3063 11.0197 13.9332 10.2465 13.9332H5.75332C4.98012 13.9332 4.35332 13.3063 4.35332 12.5331V6.82217Z",fillRule:"evenodd",clipRule:"evenodd"}}]},ho=x.forwardRef(function(o,e){return x.createElement(pe,Object.assign({},o,{id:"delete-icon",ref:e,icon:Ph}))});ho.displayName="DeleteIcon";const Oh={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.85869 12.9216C8.38445 13.4708 7.61555 13.4708 7.14131 12.9216L0.358114 5.06726C-0.406895 4.18144 0.134916 2.66683 1.2168 2.66683L14.7832 2.66683C15.8651 2.66683 16.4069 4.18144 15.6419 5.06726L8.85869 12.9216Z"}}]},Va=x.forwardRef(function(o,e){return x.createElement(pe,Object.assign({},o,{id:"dropdown-icon",ref:e,icon:Oh}))});Va.displayName="DropdownIcon";const Ah={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M15 8C15 11.866 11.866 15 8 15C4.13401 15 1 11.866 1 8C1 4.13401 4.13401 1 8 1C11.866 1 15 4.13401 15 8ZM10.3097 5.69014C10.544 5.92445 10.544 6.30435 10.3097 6.53867L8.84843 7.9999L10.3099 9.46137C10.5442 9.69569 10.5442 10.0756 10.3099 10.3099C10.0756 10.5442 9.69569 10.5442 9.46137 10.3099L7.9999 8.84843L6.53842 10.3099C6.30411 10.5442 5.92421 10.5442 5.6899 10.3099C5.45558 10.0756 5.45558 9.69569 5.6899 9.46137L7.15137 7.9999L5.69014 6.53867C5.45583 6.30435 5.45583 5.92445 5.69014 5.69014C5.92445 5.45583 6.30435 5.45583 6.53867 5.69014L7.9999 7.15137L9.46113 5.69014C9.69544 5.45583 10.0753 5.45583 10.3097 5.69014Z",fillRule:"evenodd",clipRule:"evenodd"}}]},wr=x.forwardRef(function(o,e){return x.createElement(pe,Object.assign({},o,{id:"error-icon",ref:e,icon:Ah}))});wr.displayName="ErrorIcon";const Dh={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.28096 4.6541C1.57489 4.50109 1.93721 4.61533 2.09022 4.90926C2.27315 5.26067 2.55999 5.60455 2.94829 5.92278C4.04628 6.82266 5.87505 7.44865 7.99828 7.44865C10.1215 7.44865 11.9503 6.82267 13.0482 5.92279C13.4366 5.60455 13.7234 5.26067 13.9063 4.90927C14.0594 4.61533 14.4217 4.50109 14.7156 4.65409C15.0095 4.8071 15.1238 5.16941 14.9708 5.46334C14.6995 5.98445 14.2981 6.44997 13.8089 6.8509C13.7298 6.91575 13.6481 6.97914 13.564 7.041L15.2245 8.70153C15.4588 8.93585 15.4588 9.31575 15.2245 9.55006C14.9902 9.78438 14.6103 9.78438 14.376 9.55006L12.5041 7.67822C11.8977 7.97568 11.2181 8.21208 10.4884 8.37706L11.0996 10.6581C11.1853 10.9782 10.9954 11.3072 10.6753 11.393C10.3552 11.4787 10.0262 11.2888 9.94045 10.9687L9.29949 8.57652C8.8758 8.62404 8.44081 8.64865 7.99828 8.64865C7.55276 8.64865 7.11487 8.62371 6.68846 8.57555L6.04723 10.9687C5.96147 11.2888 5.63247 11.4788 5.31239 11.393C4.99231 11.3073 4.80236 10.9783 4.88812 10.6582L5.49983 8.37516C4.7743 8.2105 4.09843 7.9752 3.49498 7.67947L1.62436 9.55009C1.39005 9.78441 1.01015 9.78441 0.775835 9.5501C0.54152 9.31578 0.541518 8.93588 0.775832 8.70157L2.43478 7.04261C2.34987 6.98024 2.26746 6.91632 2.18764 6.8509C1.69842 6.44997 1.29706 5.98445 1.0258 5.46335C0.872791 5.16942 0.987031 4.80711 1.28096 4.6541Z"}}]},Wa=x.forwardRef(function(o,e){return x.createElement(pe,Object.assign({},o,{id:"eyelash-icon",ref:e,icon:Dh}))});Wa.displayName="EyelashIcon";const Nh={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M6.06409 5.53454C5.93592 5.53454 5.84083 5.41567 5.86897 5.29063L5.95442 4.9109C6.05444 4.48178 6.23806 4.11547 6.51182 3.81952C6.81082 3.49628 7.25398 3.35405 7.79738 3.35405C7.99847 3.35405 8.21359 3.37775 8.44188 3.42245C8.46089 3.42617 8.47974 3.43006 8.49846 3.4341C8.7099 3.4798 8.93698 3.38478 9.02031 3.18514L9.24767 2.6404C9.33457 2.43219 9.23178 2.19404 9.01582 2.12874C8.98358 2.11899 8.95028 2.10912 8.91591 2.09914C8.62745 2.01631 8.28392 1.97217 7.88074 1.97217C6.82015 1.97217 6.02714 2.23936 5.4746 2.7444C4.90987 3.26069 4.50889 3.99917 4.28413 4.9762L2.83703 11.1909C2.76126 11.5286 2.666 11.8917 2.54844 12.2812C2.42975 12.6734 2.2873 13.0595 2.12221 13.4373C1.95577 13.8159 1.76813 14.1762 1.55955 14.5171C1.49345 14.6251 1.42515 14.7282 1.35467 14.8263C1.26508 14.9509 1.3347 15.133 1.48655 15.1554C2.13635 15.2509 2.8179 15.0763 3.18197 14.5296C3.32661 14.3124 3.46779 14.0646 3.60509 13.7851C3.96635 13.0497 4.30522 12.0103 4.61867 10.6574L5.469 7.01534C5.49013 6.92483 5.57082 6.86081 5.66376 6.86081H7.62478C7.8097 6.86081 7.97051 6.73405 8.01371 6.55425L8.14014 6.02798C8.20057 5.77642 8.00992 5.53454 7.75121 5.53454H6.06409Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M14.3211 5.72037L12.5124 7.96963L11.4089 5.77754C11.3422 5.63012 11.1954 5.5354 11.0336 5.5354H10.3129C10.0085 5.5354 9.80921 5.85428 9.9427 6.1279L11.4089 9.05502L8.79783 12.1493C8.56587 12.4158 8.75519 12.8315 9.10855 12.8315H9.68607C9.80672 12.8315 9.9605 12.7822 10.0388 12.6904L12.1108 10.2648L13.1176 12.561C13.1786 12.7231 13.333 12.8315 13.5061 12.8315H14.3C14.5831 12.8315 14.7417 12.6175 14.6426 12.3524L13.1728 9.28628C13.1728 9.28628 15.4009 6.45542 15.6013 6.17892C15.7966 5.90929 15.6023 5.5354 15.2693 5.5354H14.6661C14.5275 5.5354 14.4333 5.58887 14.3211 5.72037Z"}}]},La=x.forwardRef(function(o,e){return x.createElement(pe,Object.assign({},o,{id:"fx-icon",ref:e,icon:Nh}))});La.displayName="FxIcon";const kh={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.6 1.99991C8.60001 1.66854 8.33138 1.39991 8.00001 1.3999C7.66864 1.3999 7.40001 1.66853 7.4 1.9999L7.39996 7.3999H1.9999C1.66853 7.3999 1.3999 7.66853 1.3999 7.9999C1.3999 8.33127 1.66853 8.5999 1.9999 8.5999H7.39995L7.3999 13.9999C7.3999 14.3313 7.66853 14.5999 7.9999 14.5999C8.33127 14.5999 8.5999 14.3313 8.5999 13.9999L8.59995 8.5999H13.9999C14.3313 8.5999 14.5999 8.33127 14.5999 7.9999C14.5999 7.66853 14.3313 7.3999 13.9999 7.3999H8.59996L8.6 1.99991Z"}}]},Er=x.forwardRef(function(o,e){return x.createElement(pe,Object.assign({},o,{id:"increase-icon",ref:e,icon:kh}))});Er.displayName="IncreaseIcon";const Hh={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.00016 1.33203C6.68162 1.33203 5.39269 1.72302 4.29636 2.45557C3.20004 3.18811 2.34555 4.2293 1.84097 5.44747C1.33638 6.66565 1.20436 8.00609 1.4616 9.2993C1.71883 10.5925 2.35377 11.7804 3.28612 12.7127C4.21847 13.6451 5.40636 14.28 6.69956 14.5373C7.99277 14.7945 9.33321 14.6625 10.5514 14.1579C11.7696 13.6533 12.8108 12.7988 13.5433 11.7025C14.2758 10.6062 14.6668 9.31724 14.6668 7.9987C14.6649 6.23118 13.9619 4.53662 12.7121 3.2868C11.4622 2.03697 9.76768 1.33397 8.00016 1.33203ZM7.66683 3.9987C7.86461 3.9987 8.05795 4.05735 8.2224 4.16723C8.38685 4.27711 8.51502 4.43329 8.59071 4.61601C8.6664 4.79874 8.6862 4.99981 8.64762 5.19379C8.60903 5.38777 8.51379 5.56595 8.37394 5.7058C8.23409 5.84566 8.0559 5.9409 7.86192 5.97948C7.66794 6.01807 7.46687 5.99826 7.28415 5.92258C7.10142 5.84689 6.94524 5.71872 6.83536 5.55427C6.72548 5.38982 6.66683 5.19648 6.66683 4.9987C6.66683 4.73348 6.77219 4.47913 6.95972 4.29159C7.14726 4.10405 7.40162 3.9987 7.66683 3.9987ZM9.3335 11.332H6.66683C6.49002 11.332 6.32045 11.2618 6.19543 11.1368C6.0704 11.0117 6.00016 10.8422 6.00016 10.6654C6.00016 10.4886 6.0704 10.319 6.19543 10.194C6.32045 10.0689 6.49002 9.9987 6.66683 9.9987H7.3335V7.9987H6.66683C6.49002 7.9987 6.32045 7.92846 6.19543 7.80343C6.0704 7.67841 6.00016 7.50884 6.00016 7.33203C6.00016 7.15522 6.0704 6.98565 6.19543 6.86063C6.32045 6.7356 6.49002 6.66536 6.66683 6.66536H8.00016C8.17698 6.66536 8.34655 6.7356 8.47157 6.86063C8.59659 6.98565 8.66683 7.15522 8.66683 7.33203V9.9987H9.3335C9.51031 9.9987 9.67988 10.0689 9.8049 10.194C9.92993 10.319 10.0002 10.4886 10.0002 10.6654C10.0002 10.8422 9.92993 11.0117 9.8049 11.1368C9.67988 11.2618 9.51031 11.332 9.3335 11.332Z"}}]},xa=x.forwardRef(function(o,e){return x.createElement(pe,Object.assign({},o,{id:"info-icon",ref:e,icon:Hh}))});xa.displayName="InfoIcon";const Vh={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.62402 7.72905C2.58427 7.72905 2.55205 7.76127 2.55205 7.80102V13.6782C2.55205 13.7179 2.58427 13.7502 2.62402 13.7502H13.3755C13.4152 13.7502 13.4474 13.7179 13.4474 13.6782V7.80102C13.4474 7.76127 13.4152 7.72905 13.3755 7.72905H2.62402ZM1.35205 7.80102C1.35205 7.09853 1.92153 6.52905 2.62402 6.52905H13.3755C14.0779 6.52905 14.6474 7.09853 14.6474 7.80102V13.6782C14.6474 14.3807 14.0779 14.9502 13.3755 14.9502H2.62402C1.92153 14.9502 1.35205 14.3807 1.35205 13.6782V7.80102Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M8 2.25005C6.69847 2.25003 5.64336 3.30513 5.64336 4.60666V7.12895C5.64336 7.46032 5.37473 7.72895 5.04336 7.72895C4.71199 7.72895 4.44336 7.46032 4.44336 7.12895V4.60666C4.44336 2.64239 6.04451 1.05565 8.00879 1.05566M8 2.25005L8.00879 1.05566L8 2.25005ZM8.00879 1.05566L8 2.25005C9.30154 2.25003 10.3567 3.30513 10.3567 4.60666V7.12895C10.3567 7.46032 10.6253 7.72895 10.9567 7.72895C11.288 7.72895 11.5567 7.46032 11.5567 7.12895V4.60666C11.5567 2.64239 9.97306 1.05565 8.00879 1.05566Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M8.00039 9.4668C8.33176 9.4668 8.60039 9.73543 8.60039 10.0668V12.0827C8.60039 12.4141 8.33176 12.6827 8.00039 12.6827C7.66902 12.6827 7.40039 12.4141 7.40039 12.0827V10.0668C7.40039 9.73543 7.66902 9.4668 8.00039 9.4668Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Tr=x.forwardRef(function(o,e){return x.createElement(pe,Object.assign({},o,{id:"lock-icon",ref:e,icon:Vh}))});Tr.displayName="LockIcon";const Wh={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M11.3536 6.14645C11.5488 6.34171 11.5488 6.65829 11.3536 6.85355L8.35355 9.85355C8.15829 10.0488 7.84171 10.0488 7.64645 9.85355L4.64645 6.85355C4.45118 6.65829 4.45118 6.34171 4.64645 6.14645C4.84171 5.95118 5.15829 5.95118 5.35355 6.14645L8 8.79289L10.6464 6.14645C10.8417 5.95118 11.1583 5.95118 11.3536 6.14645Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Tn=x.forwardRef(function(o,e){return x.createElement(pe,Object.assign({},o,{id:"more-down-icon",ref:e,icon:Wh}))});Tn.displayName="MoreDownIcon";const Lh={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.90913 3.57564C6.14345 3.34132 6.52335 3.34132 6.75766 3.57564L10.7577 7.57564C10.992 7.80995 10.992 8.18985 10.7577 8.42417L6.75766 12.4242C6.52335 12.6585 6.14345 12.6585 5.90913 12.4242C5.67482 12.1899 5.67482 11.81 5.90913 11.5756L9.48487 7.9999L5.90913 4.42417C5.67482 4.18985 5.67482 3.80995 5.90913 3.57564Z",fillRule:"evenodd",clipRule:"evenodd"}}]},yr=x.forwardRef(function(o,e){return x.createElement(pe,Object.assign({},o,{id:"more-icon",ref:e,icon:Lh}))});yr.displayName="MoreIcon";const xh={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M12.666 2.70571C11.7769 1.76476 10.3295 1.76476 9.4404 2.70571L3.37843 9.12427C3.31779 9.18848 3.27756 9.26409 3.24979 9.3439C3.24809 9.3493 3.24299 9.3529 3.24129 9.3583L2.02912 13.2097C1.96112 13.4251 2.01439 13.6633 2.16626 13.8236C2.27393 13.9382 2.41901 14 2.56692 14C2.62699 14 2.68762 13.9898 2.74599 13.9688L6.3825 12.6846C6.3876 12.6828 6.391 12.678 6.39553 12.6762C6.47147 12.6474 6.54287 12.6042 6.60351 12.54L12.666 6.12202C13.5558 5.18048 13.5558 3.64725 12.666 2.70571ZM8.62832 5.26209L9.04031 5.69836C9.03918 5.69956 9.03748 5.70016 9.03634 5.70136L4.99182 9.9836L4.58096 9.54853L8.62832 5.26209ZM3.46287 12.4512L4.02673 10.6593L5.15446 11.8535L3.46287 12.4512ZM6.20342 11.2672L5.79256 10.8321L9.83709 6.54988C9.83822 6.54868 9.83879 6.54688 9.83992 6.54568L10.2513 6.98135L6.20342 11.2672ZM11.8647 5.27349L11.0532 6.13282L9.42963 4.41356L10.2411 3.55423C10.6888 3.08016 11.417 3.08076 11.8642 3.55423C12.3124 4.0283 12.3124 4.79942 11.8647 5.27349Z"}}]},Ua=x.forwardRef(function(o,e){return x.createElement(pe,Object.assign({},o,{id:"pen-icon",ref:e,icon:xh}))});Ua.displayName="PenIcon";const Uh={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.785 6.77762C5.78908 6.7777 5.79316 6.77774 5.79725 6.77774C5.80134 6.77774 5.80543 6.7777 5.8095 6.77762H10.0184C10.0225 6.7777 10.0266 6.77774 10.0307 6.77774C10.0347 6.77774 10.0388 6.7777 10.0429 6.77762H13.6638V7.63727C13.6638 7.96864 13.9324 8.23727 14.2638 8.23727C14.5951 8.23727 14.8638 7.96864 14.8638 7.63727V3.9999C14.8638 2.56395 13.6997 1.39989 12.2637 1.3999L3.56389 1.39999C2.12797 1.40001 0.96393 2.56405 0.96392 3.99998L0.963867 11.6666C0.963857 13.1025 2.12792 14.2666 3.56387 14.2666H8.0542C8.38557 14.2666 8.6542 13.9979 8.6542 13.6666C8.6542 13.3352 8.38557 13.0666 8.0542 13.0666H3.56387C2.79067 13.0666 2.16386 12.4398 2.16387 11.6666L2.1639 6.77762H5.785ZM6.39725 2.59996L9.43065 2.59993V5.57762H6.39725V2.59996ZM5.19725 5.57762V2.59998L3.56391 2.59999C2.79072 2.6 2.16393 3.22679 2.16392 3.99998L2.16391 5.57762H5.19725ZM13.6638 5.57762V3.9999C13.6638 3.2267 13.037 2.59989 12.2638 2.5999L10.6307 2.59992V5.57762H13.6638Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M14.1223 10.2333V10.7496C14.7087 10.9869 15.1223 11.5618 15.1223 12.2333V12.8999C15.1223 13.7836 14.406 14.4999 13.5223 14.4999H11.5223C10.6387 14.4999 9.92235 13.7836 9.92235 12.8999V12.2333C9.92235 11.5618 10.336 10.9869 10.9223 10.7496V10.2333C10.9223 9.34961 11.6387 8.63328 12.5223 8.63328C13.406 8.63328 14.1223 9.34961 14.1223 10.2333ZM11.1223 12.2333C11.1223 12.0124 11.3014 11.8333 11.5223 11.8333H13.5223C13.7433 11.8333 13.9223 12.0124 13.9223 12.2333V12.8999C13.9223 13.1209 13.7433 13.2999 13.5223 13.2999H11.5223C11.3014 13.2999 11.1223 13.1209 11.1223 12.8999V12.2333ZM12.9223 10.2333V10.6333H12.1223V10.2333C12.1223 10.0124 12.3014 9.83328 12.5223 9.83328C12.7433 9.83328 12.9223 10.0124 12.9223 10.2333Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Ba=x.forwardRef(function(o,e){return x.createElement(pe,Object.assign({},o,{id:"protect-icon",ref:e,icon:Uh}))});Ba.displayName="ProtectIcon";const Bh={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M15 8C15 11.866 11.866 15 8 15C4.13401 15 1 11.866 1 8C1 4.13401 4.13401 1 8 1C11.866 1 15 4.13401 15 8ZM8.00008 12.3671C8.46031 12.3671 8.83342 11.994 8.83342 11.5338C8.83342 11.0735 8.46031 10.7004 8.00008 10.7004C7.53985 10.7004 7.16675 11.0735 7.16675 11.5338C7.16675 11.994 7.53985 12.3671 8.00008 12.3671ZM8.5999 4.4335C8.5999 4.10213 8.33127 3.8335 7.9999 3.8335C7.66853 3.8335 7.3999 4.10213 7.3999 4.4335V9.36683C7.3999 9.6982 7.66853 9.96683 7.9999 9.96683C8.33127 9.96683 8.5999 9.6982 8.5999 9.36683V4.4335Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Fa=x.forwardRef(function(o,e){return x.createElement(pe,Object.assign({},o,{id:"warning-icon",ref:e,icon:Bh}))});Fa.displayName="WarningIcon";const Fh={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M12.6551 1.98906C11.7476 1.08113 10.2757 1.08149 9.3686 1.98987L4.82542 6.53955C4.75087 6.61421 4.69336 6.70411 4.65682 6.80309L3.2461 10.625C3.16506 10.8446 3.21909 11.0912 3.3845 11.2568C3.54991 11.4224 3.79651 11.4767 4.01616 11.3959L7.85031 9.98517C7.94979 9.94856 8.04014 9.89077 8.11508 9.81579L12.6552 5.27327C13.5618 4.36621 13.5618 2.89607 12.6551 1.98906ZM10.2177 2.83779C10.6562 2.39869 11.3677 2.39851 11.8064 2.8374C12.2447 3.27584 12.2447 3.9865 11.8065 4.42497L7.3392 8.89457L4.82213 9.82068L5.74706 7.31487L10.2177 2.83779Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.79238 13.2999C1.46101 13.2999 1.19238 13.5685 1.19238 13.8999C1.19238 14.2313 1.46101 14.4999 1.79238 14.4999H14.4924C14.8238 14.4999 15.0924 14.2313 15.0924 13.8999C15.0924 13.5685 14.8238 13.2999 14.4924 13.2999H1.79238Z"}}]},Rr=x.forwardRef(function(o,e){return x.createElement(pe,Object.assign({},o,{id:"write-icon",ref:e,icon:Fh}))});Rr.displayName="WriteIcon";const zh={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M11.0363 12.2367V14.0367C11.0363 14.3681 11.3049 14.6367 11.6363 14.6367C11.9676 14.6367 12.2363 14.3681 12.2363 14.0367V12.2367H14.0364C14.3677 12.2367 14.6364 11.9681 14.6364 11.6367C14.6364 11.3054 14.3677 11.0367 14.0364 11.0367H12.2363V9.23672C12.2363 8.90535 11.9676 8.63672 11.6363 8.63672C11.3049 8.63672 11.0363 8.90535 11.0363 9.23672V11.0367H9.23635C8.90498 11.0367 8.63635 11.3054 8.63635 11.6367C8.63635 11.9681 8.90498 12.2367 9.23635 12.2367H11.0363Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.56365 1.36377C1.90091 1.36377 1.36365 1.90103 1.36365 2.56377V6.16377C1.36365 6.82651 1.90091 7.36377 2.56365 7.36377H6.16365C6.82639 7.36377 7.36365 6.82651 7.36365 6.16377V2.56377C7.36365 1.90103 6.82639 1.36377 6.16365 1.36377H2.56365ZM6.16365 2.56377H2.56365L2.56365 6.16377H6.16365V2.56377Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.56365 8.63647C1.90091 8.63647 1.36365 9.17373 1.36365 9.83647V13.4365C1.36365 14.0992 1.90091 14.6365 2.56365 14.6365H6.16365C6.82639 14.6365 7.36365 14.0992 7.36365 13.4365V9.83647C7.36365 9.17373 6.82639 8.63647 6.16365 8.63647H2.56365ZM6.16365 9.83647H2.56365L2.56365 13.4365H6.16365V9.83647Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M9.83635 7.36377C9.17361 7.36377 8.63635 6.82651 8.63635 6.16377V2.56377C8.63635 1.90103 9.17361 1.36377 9.83635 1.36377H13.4364C14.0991 1.36377 14.6364 1.90103 14.6364 2.56377V6.16377C14.6364 6.82651 14.0991 7.36377 13.4364 7.36377H9.83635ZM9.83635 6.16377V2.56377L13.4364 2.56377V6.16377H9.83635Z",fillRule:"evenodd",clipRule:"evenodd"}}]},za=x.forwardRef(function(o,e){return x.createElement(pe,Object.assign({},o,{id:"autofill-double-icon",ref:e,icon:zh}))});za.displayName="AutofillDoubleIcon";const Xh={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M6.4833 1.65005C6.4833 1.31868 6.21467 1.05005 5.8833 1.05005C5.55193 1.05005 5.2833 1.31868 5.2833 1.65005V5.28345H1.65029C1.31892 5.28345 1.05029 5.55208 1.05029 5.88345C1.05029 6.21482 1.31892 6.48345 1.65029 6.48345H5.2833V9.51684H1.65029C1.31892 9.51684 1.05029 9.78547 1.05029 10.1168C1.05029 10.4482 1.31892 10.7168 1.65029 10.7168H5.2833V14.35C5.2833 14.6814 5.55193 14.95 5.8833 14.95C6.21467 14.95 6.4833 14.6814 6.4833 14.35V10.7168H9.5167V14.35C9.5167 14.6814 9.78533 14.95 10.1167 14.95C10.4481 14.95 10.7167 14.6814 10.7167 14.35V10.7168H14.3503C14.6817 10.7168 14.9503 10.4482 14.9503 10.1168C14.9503 9.78547 14.6817 9.51685 14.3503 9.51685H10.7167V6.48345H14.3503C14.6817 6.48345 14.9503 6.21482 14.9503 5.88345C14.9503 5.55208 14.6817 5.28345 14.3503 5.28345H10.7167V1.65005C10.7167 1.31868 10.4481 1.05005 10.1167 1.05005C9.78533 1.05005 9.5167 1.31868 9.5167 1.65005V5.28345L6.4833 5.28345V1.65005ZM6.4833 6.48345V9.51684L9.5167 9.51685V6.48345L6.4833 6.48345Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.0498 3.65005C1.0498 2.21411 2.21386 1.05005 3.6498 1.05005H12.3498C13.7857 1.05005 14.9498 2.21411 14.9498 3.65005V12.3501C14.9498 13.786 13.7857 14.95 12.3498 14.95H3.6498C2.21386 14.95 1.0498 13.786 1.0498 12.35V3.65005ZM3.6498 2.25005C2.87661 2.25005 2.2498 2.87685 2.2498 3.65005V12.35C2.2498 13.1232 2.87661 13.75 3.6498 13.75H12.3498C13.123 13.75 13.7498 13.1232 13.7498 12.3501V3.65005C13.7498 2.87685 13.123 2.25005 12.3498 2.25005H3.6498Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Mr=x.forwardRef(function(o,e){return x.createElement(pe,Object.assign({},o,{id:"hide-gridlines-double-icon",ref:e,icon:Xh}))});Mr.displayName="HideGridlinesDoubleIcon";const Yh={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.01281 1.36643C8.79386 0.585377 10.0602 0.585378 10.8412 1.36643L12.9223 3.44752C13.7034 4.22857 13.7034 5.4949 12.9223 6.27595L9.36445 9.83383C8.5834 10.6149 7.31707 10.6149 6.53602 9.83383L4.45493 7.75273C3.67388 6.97168 3.67388 5.70535 4.45493 4.9243L8.01281 1.36643ZM9.9927 2.21495C9.68028 1.90253 9.17375 1.90253 8.86133 2.21495L5.30346 5.77283L5.29671 5.77966L10.839 6.66224L12.0738 5.42742C12.3862 5.115 12.3862 4.60847 12.0738 4.29605L9.9927 2.21495Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M14.5179 9.48875C14.5179 9.99175 14.1101 10.3995 13.607 10.3995C13.1041 10.3995 12.6963 9.99175 12.6963 9.48875C12.6963 9.1773 13.0455 8.59966 13.3114 8.20487C13.4549 7.99177 13.7591 7.99177 13.9027 8.20486C14.1687 8.59965 14.5179 9.1773 14.5179 9.48875Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M1.98682 13.4992C1.98682 12.5603 2.74793 11.7992 3.68682 11.7992H14.2868C15.2257 11.7992 15.9868 12.5603 15.9868 13.4992V13.4992C15.9868 14.4381 15.2257 15.1992 14.2868 15.1992H3.68682C2.74793 15.1992 1.98682 14.4381 1.98682 13.4992V13.4992Z"}}]},Xa=x.forwardRef(function(o,e){return x.createElement(pe,Object.assign({},o,{id:"paint-bucket-double-icon",ref:e,icon:Yh}))});Xa.displayName="PaintBucketDoubleIcon";const jh={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M7.74692 9.12463C7.74692 9.46018 8.01893 9.73219 8.35448 9.73219H11.4933C11.8288 9.73219 12.1009 9.46018 12.1009 9.12463C12.1009 8.78909 11.8288 8.51707 11.4933 8.51707H8.35448C8.01893 8.51707 7.74692 8.78909 7.74692 9.12463Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M10.8636 10.8523C10.8636 11.1879 10.5915 11.4599 10.256 11.4599H8.35448C8.01893 11.4599 7.74692 11.1879 7.74692 10.8523C7.74692 10.5168 8.01893 10.2447 8.35448 10.2447H10.256C10.5915 10.2447 10.8636 10.5168 10.8636 10.8523Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M5.4791 1.98268C5.47913 1.71529 5.87912 1.49854 6.37252 1.49854C6.86593 1.49854 7.26592 1.71529 7.26595 1.98268H7.62187C8.22277 1.98268 8.72459 2.39534 8.84412 2.9452H9.39563C10.0856 2.9452 10.6449 3.48923 10.6449 4.16032V6.00569H12.1261C13.161 6.00569 14 6.82174 14 7.82838V11.334C14 11.8174 13.8025 12.281 13.4511 12.6228L12.0693 13.9647C11.7179 14.3065 11.2412 14.4985 10.7442 14.4985H7.91116C7.05024 14.4985 6.32492 14.0431 6.10535 13.2737H3.34925C2.6593 13.2737 2.09998 12.7297 2.09998 12.0586V4.16032C2.09998 3.48923 2.6593 2.9452 3.34925 2.9452H3.90107C4.0206 2.39534 4.52241 1.98268 5.12332 1.98268H5.4791ZM3.97249 4.16032H3.24925L3.24925 12.0586H6.03725V7.82838C6.03725 6.82174 6.87623 6.00569 7.91116 6.00569H9.49563V4.16032H8.7727C8.58289 4.59611 8.13909 4.90183 7.62187 4.90183H5.12332C4.6061 4.90183 4.1623 4.59611 3.97249 4.16032ZM5.12332 2.89403H7.62187C7.79436 2.89403 7.93419 3.03003 7.93419 3.19781V3.68671C7.93419 3.85448 7.79436 3.99049 7.62187 3.99049H5.12332C4.95083 3.99049 4.811 3.85448 4.811 3.68671V3.19781C4.811 3.03003 4.95083 2.89403 5.12332 2.89403ZM7.91116 7.11157C7.56618 7.11157 7.28652 7.38359 7.28652 7.71913V12.7851C7.28652 13.1206 7.56618 13.3927 7.91116 13.3927H10.7442C10.8401 13.3927 10.9337 13.3712 11.0182 13.3311C11.1373 13.2746 11.1859 13.1423 11.1859 13.0134V12.0066C11.1859 11.8724 11.2978 11.7636 11.4358 11.7636H12.4709C12.6034 11.7636 12.7394 11.7163 12.7975 11.6004C12.8388 11.5182 12.8608 11.4272 12.8608 11.334V7.71913C12.8608 7.38359 12.5811 7.11157 12.2362 7.11157H7.91116Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Ya=x.forwardRef(function(o,e){return x.createElement(pe,Object.assign({},o,{id:"paste-special-double-icon",ref:e,icon:jh}))});Ya.displayName="PasteSpecialDoubleIcon";const Zh=()=>{const[,n]=x.useState({});return x.useCallback(()=>n(o=>!o),[])};function Gh(){const n=I.useDependency(a.ICommandService),o=I.useDependency(a.IUniverInstanceService),e=I.useDependency(M.IRenderManagerService),t=I.useDependency(ct),i=I.useDependency(a.LocaleService),[r,s]=x.useState([]),[l,c]=x.useState(!1),[d,u]=x.useState({row:-1,col:-1}),[h,g]=x.useState(le.SERIES),[S,f]=x.useState(!1),v=St(),{sheetSkeletonManagerService:p,selectionRenderService:C}=x.useMemo(()=>{if(v){const Y=e.getRenderById(v.getUnitId());return{sheetSkeletonManagerService:Y==null?void 0:Y.with(y.SheetSkeletonManagerService),selectionRenderService:Y==null?void 0:Y.with(Ie)}}return{sheetSkeletonManagerService:null,selectionRenderService:null}},[v,e]),_=()=>{f(!0)},w=()=>{f(!1)},E=Zh();if(x.useEffect(()=>n.onCommandExecuted((Q,oe)=>{Q.id===et.id&&E()}).dispose,[E,n]),x.useEffect(()=>{const Y=p&&a.toDisposable(p.currentSkeleton$.subscribe(Q=>{Q&&E()}));return Y==null?void 0:Y.dispose},[p,E]),x.useEffect(()=>a.toDisposable(t.menu$.subscribe(Q=>{s(Q.map(oe=>({...oe,index:Q.indexOf(oe)})))})).dispose,[t]),x.useEffect(()=>a.toDisposable(t.showMenu$.subscribe(Q=>{const{source:oe,target:re}=t.autoFillLocation||{source:null,target:null};if(Q&&oe&&re){const ce=Math.max(oe.rows[oe.rows.length-1],re.rows[re.rows.length-1]),G=Math.max(oe.cols[oe.cols.length-1],re.cols[re.cols.length-1]);u({row:ce,col:G})}else u({row:-1,col:-1})})).dispose,[t]),x.useEffect(()=>a.toDisposable(t.applyType$.subscribe(Q=>{g(Q)})).dispose,[t]),x.useEffect(()=>{function Y(){c(!1)}return document.addEventListener("wheel",Y),()=>{document.removeEventListener("wheel",Y)}},[l]),d.col<0||d.row<0)return null;const O=He(o,e);if(!O||!C)return null;const{scene:T}=O,P=p==null?void 0:p.getCurrentSkeleton(),A=C.getViewPort(),D=T==null?void 0:T.scaleX,k=T==null?void 0:T.scaleY,H=T==null?void 0:T.getViewportScrollXY(A);if(!D||!T||!D||!k||!H)return null;const V=(P==null?void 0:P.getNoMergeCellWithCoordByIndex(d.row,d.col).endX)||0,L=(P==null?void 0:P.getNoMergeCellWithCoordByIndex(d.row,d.col).endY)||0,W=M.convertTransformToOffsetX(V,D,H),B=M.convertTransformToOffsetY(L,k,H);if(W==null||B==null)return null;const U=Y=>{c(Y)},z=Y=>{n.executeCommand(ci.id,{type:Y.value}),c(!1)},F=l||S,j=r.filter(Y=>!Y.disable);return b.jsx("div",{className:"univer-absolute univer-inset-0 univer-z-10 univer-size-0",children:b.jsx("div",{className:"univer-absolute",style:{left:`${W+2}px`,top:`${B+2}px`},onMouseEnter:_,onMouseLeave:w,children:b.jsx(X.DropdownMenu,{align:"start",items:j.map(Y=>({type:"radio",value:h,options:[{label:i.t(Y.label),value:Y.value}],onSelect:()=>z(Y)})),open:l,onOpenChange:U,children:b.jsxs("div",{className:X.clsx("univer-flex univer-items-center univer-gap-2 univer-rounded univer-p-1 hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-800",X.borderClassName,{"univer-bg-gray-100 dark:!univer-bg-gray-800":l,"univer-bg-white dark:!univer-bg-gray-900":!l}),children:[b.jsx(za,{className:"univer-fill-primary-600 univer-text-gray-900 dark:!univer-text-white"}),F&&b.jsx(Tn,{className:"dark:!univer-text-white"})]})})})})}function Pr(n,o){const e=I.useDependency(me),t=I.useDependency(a.ICommandService);return x.useMemo(()=>({keyCodes:[{keyCode:I.KeyCode.ENTER},{keyCode:I.KeyCode.ESC},{keyCode:I.KeyCode.TAB}],handler:r=>{(r===I.KeyCode.ENTER||r===I.KeyCode.ESC||r===I.KeyCode.TAB)&&(e.disableForceKeepVisible(),t.syncExecuteCommand(Se.id,{visible:!1,eventType:M.DeviceInputEventType.Keyboard,keycode:r,unitId:o}))}}),[t,e,o])}const mo=-1e3,ja={width:0,height:0,top:mo,left:mo},Kh=()=>{const[n,o]=x.useState({...ja}),e=I.useDependency(En),t=I.useDependency(q.IEditorService),i=I.useDependency(a.IContextService),r=I.useDependency(I.ComponentManager),s=I.useDependency(me),l=I.useObservable(s.visible$),c=I.useDependency(a.ICommandService),d=x.useRef(0),u=I.useObservable(()=>i.subscribeContextValue$(I.DISABLE_AUTO_FOCUS_KEY),!1,void 0,[i,I.DISABLE_AUTO_FOCUS_KEY]),h=r.get(Ui),g=s.getEditLocation();x.useEffect(()=>{const p=e.state$.subscribe(C=>{if(C==null)return;const{startX:_=mo,startY:w=mo,endX:E=0,endY:O=0,show:T=!1}=C;if(!T)o({...ja});else{o({width:E-_,height:O-w,left:_,top:w});const P=t.getEditor(a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY);if(P==null)return;const{left:A,top:D,width:k,height:H}=P.getBoundingClientRect();e.setRect({left:A,top:D,width:k,height:H})}});return()=>{p.unsubscribe()}},[]),x.useEffect(()=>{u||e.setFocus(!0)},[u,n]);const S=I.useEvent(()=>{s.isVisible().visible&&c.executeCommand(Se.id,{visible:!1,eventType:M.DeviceInputEventType.PointerUp,unitId:g==null?void 0:g.unitId})});I.useSidebarClick(S);const f=Pr(d,g==null?void 0:g.unitId),v=I.useEvent((p,C)=>{c.executeCommand(Bt.id,{keycode:p,visible:!1,eventType:M.DeviceInputEventType.Keyboard,isShift:C===I.MetaKeys.SHIFT||C===(I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT),unitId:g==null?void 0:g.unitId})});return b.jsx("div",{className:"univer-absolute univer-z-10 univer-flex",style:{left:n.left,top:n.top,width:n.width,height:n.height},children:h&&b.jsx(h,{editorId:a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY,className:"univer-relative univer-flex univer-h-full univer-w-full [&_canvas]:univer-absolute",initValue:"",onChange:()=>{},isFocus:l==null?void 0:l.visible,unitId:g==null?void 0:g.unitId,subUnitId:g==null?void 0:g.sheetId,keyboardEventConfig:f,onMoveInEditor:v,isSupportAcrossSheet:!0,resetSelectionOnBlur:!1,isSingle:!1,autoScrollbar:!1,onFormulaSelectingChange:(p,C)=>{d.current=p,C&&(p?s.enableForceKeepVisible():s.disableForceKeepVisible())},disableSelectionOnClick:!0,disableContextMenu:!1})})};class Za{constructor(){R(this,"_position",null);R(this,"_position$",new N.BehaviorSubject(null));R(this,"position$",this._position$.asObservable());R(this,"_focus",!1);R(this,"_focus$",new N.BehaviorSubject(this._focus));R(this,"focus$",this._focus$.asObservable());R(this,"_fxBtnClick$",new N.Subject);R(this,"fxBtnClick$",this._fxBtnClick$.asObservable());R(this,"_foldBtnStatus$",new N.Subject);R(this,"foldBtnStatus$",this._foldBtnStatus$.asObservable())}dispose(){this._position$.complete(),this._focus$.complete(),this._position=null,this._focus=!1}setPosition(o){this._position=o,this._refresh(o)}getPosition(){return this._position}setFocus(o=!1){this._focus=o,this._focus$.next(o)}handleFxBtnClick(o){this._fxBtnClick$.next(o)}handleFoldBtnClick(o){this._foldBtnStatus$.next(o)}_refresh(o){this._position$.next(o)}}const yn=a.createIdentifier("univer.sheet-formula-editor-manager.service");function qh(){const n=I.useDependency(a.ICommandService),o=I.useDependency(a.LocaleService),e=I.useDependency(K.IDefinedNamesService),t=I.useDependency(a.IUniverInstanceService),i=I.useDependency(I.ISidebarService),s=t.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET).getUnitId(),l=()=>{const g=e.getDefinedNameMap(s);return g?Array.from(Object.values(g)):[]},[c,d]=x.useState(l());x.useEffect(()=>{const g=e.update$.subscribe(()=>{d(l())});return()=>{g.unsubscribe()}},[]),x.useEffect(()=>{const g=i.sidebarOptions$.subscribe(S=>{S.id===wi&&(S.visible||setTimeout(()=>{i.sidebarOptions$.next({visible:!1})}))});return()=>{g.unsubscribe()}},[]);const u=()=>{n.executeCommand(lo.id,{value:"open"})},h=async g=>{const{formulaOrRefString:S,id:f}=g,v=e.getWorksheetByRef(s,S);if(!v)return;v.isSheetHidden()&&await n.executeCommand(m.SetWorksheetShowCommand.id,{unitId:s,subUnitId:v.getSheetId()}),e.focusRange(s,f)};return b.jsxs("div",{className:"univer-w-[300px]",children:[b.jsx("ul",{className:X.clsx("univer-m-0 univer-max-h-[360px] univer-list-none univer-overflow-y-auto univer-p-0",X.scrollbarClassName),children:c.map((g,S)=>b.jsx("li",{className:"univer-cursor-pointer univer-px-2 univer-transition-colors univer-duration-200 hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-600",onClick:()=>{h(g)},children:b.jsxs("div",{className:X.clsx("univer-flex univer-items-center univer-justify-between univer-gap-2 univer-py-1",X.borderBottomClassName),children:[b.jsx("div",{className:"univer-w-[50%] univer-flex-shrink-0 univer-truncate univer-text-sm univer-text-gray-600 dark:!univer-text-gray-200",title:g.name,children:g.name}),b.jsx("div",{className:"univer-w-[50%] univer-flex-shrink-0 univer-truncate univer-text-xs univer-text-gray-400",title:g.formulaOrRefString,children:g.formulaOrRefString})]})},S))}),b.jsxs("div",{className:"univer-cursor-pointer univer-p-2 univer-transition-colors univer-duration-200 hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-600",onClick:u,children:[b.jsx("div",{className:"univer-mb-2 univer-text-sm univer-font-semibold univer-text-gray-600 dark:!univer-text-gray-200",children:o.t("definedName.managerTitle")}),b.jsx("div",{className:"univer-text-xs univer-text-gray-400",children:o.t("definedName.managerDescription")})]})]})}function Qh({disable:n}){const[o,e]=x.useState(""),[t,i]=x.useState(""),r=I.useDependency(K.IDefinedNamesService),s=I.useDependency(a.ICommandService),c=I.useDependency(a.IUniverInstanceService).getCurrentUnitOfType(a.UniverInstanceType.UNIVER_SHEET).getActiveSheet(),d=c==null?void 0:c.getUnitId(),u=c==null?void 0:c.getSheetId(),h=I.useDependency(a.ThemeService);x.useEffect(()=>{const C=r.currentRange$.subscribe(()=>{const _=r.getCurrentRangeForString();e(_),i(_)});return()=>{C.unsubscribe()}},[]);function g(C){i(C.target.value.trim())}function S(){if(t!==o){if(!K.isReferenceString(t)){v();return}e(t),p(c,t).then(C=>{C&&(s.executeCommand(m.SetSelectionsOperation.id,{unitId:d,subUnitId:u,selections:C}),s.executeCommand(oo.id,{range:C[0].range}))})}}function f(C){n||(C.key==="Enter"?S():C.key==="Escape"&&(C.preventDefault(),v()))}function v(){i(o)}async function p(C,_){if(!C)return;const w=K.deserializeRangeWithSheet(_.trim()),E=w.range,{startRow:O,startColumn:T,endRow:P,endColumn:A}=E,D=m.getPrimaryForRange({startRow:O,startColumn:T,endRow:P,endColumn:A},C),k=[];return k.push({range:w.range,style:qe(h),primary:D}),k}return b.jsxs("div",{"data-u-comp":"defined-name",className:"univer-relative univer-box-border univer-flex univer-h-full univer-w-24 univer-border-r-gray-200 univer-py-1.5 univer-transition-all",children:[b.jsx("input",{className:X.clsx("univer-box-border univer-h-full univer-w-full univer-appearance-none univer-px-1.5 univer-text-gray-900 focus:univer-outline-none dark:!univer-border-r-gray-700 dark:!univer-bg-gray-900 dark:!univer-text-white",X.borderRightClassName,{"univer-cursor-not-allowed":n}),type:"text",value:t,onChange:g,onKeyDown:f}),b.jsx(X.Dropdown,{overlay:b.jsx("div",{className:"univer-z-[1001]",children:b.jsx(qh,{})}),disabled:n,children:b.jsx("a",{className:X.clsx("univer-absolute univer-right-0 univer-top-0 univer-flex univer-h-full univer-cursor-pointer univer-items-center univer-justify-center univer-px-1 univer-transition-colors univer-duration-200 hover:univer-bg-gray-100 dark:!univer-text-white dark:hover:!univer-bg-gray-800",{"univer-cursor-not-allowed univer-text-gray-300 hover:univer-bg-transparent dark:!univer-text-gray-700":n}),children:b.jsx(Tn,{})})})]})}function Ga(n){var J,ne,ue,ie;const{className:o,disableDefinedName:e}=n,[t,i]=x.useState(!1),[r,s]=x.useState(0),l=I.useDependency(yn),c=I.useDependency(me),d=I.useDependency(m.WorksheetProtectionRuleModel),u=I.useDependency(m.RangeProtectionRuleModel),h=I.useDependency(a.IUniverInstanceService),g=I.useDependency(m.SheetsSelectionsService),S=I.useDependency(a.IPermissionService),f=I.useDependency(m.RangeProtectionCache),v=I.useDependency(a.ICommandService),[p,C]=x.useState({editDisable:!1,viewDisable:!1}),[_,w]=x.useState(!1),E=I.useDependency(I.ComponentManager),O=I.useObservable(()=>h.getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET),void 0,void 0,[]),T=x.useRef(0),P=I.useObservable(c.currentEditCellState$),A=Pr(T,(J=P==null?void 0:P.unitId)!=null?J:""),D=E.get(Ui),k=I.useComponentsOfPart(pr.FORMULA_AUX),H=I.useDependency(a.IContextService);I.useObservable(x.useMemo(()=>H.subscribeContextValue$(a.FOCUSING_FX_BAR_EDITOR),[H]));const V=H.getContextValue(a.FOCUSING_FX_BAR_EDITOR),L=x.useRef(null),W=I.useDependency(q.IEditorService);x.useLayoutEffect(()=>{const se=O.activeSheet$.pipe(N.switchMap(te=>te?N.merge(d.ruleChange$,u.ruleChange$,g.selectionMoveEnd$,g.selectionSet$).pipe(N.switchMap(()=>{var bt,wt;const fe=O.getUnitId(),ve=te.getSheetId();if(!((bt=g.getCurrentLastSelection())==null?void 0:bt.range))return N.EMPTY;const Ee=(wt=g.getCurrentLastSelection())==null?void 0:wt.primary;return Ee?N.of({unitId:fe,subUnitId:ve,primary:Ee}):N.of(null)})):N.EMPTY)).subscribe(te=>{var fe,ve,we,Ee,bt,wt;if(te){const{unitId:Qt,subUnitId:Xo,primary:_p}=te;if(d.getRule(Qt,Xo)){const Ep=!((ve=(fe=S.getPermissionPoint(new m.WorksheetEditPermission(Qt,Xo).id))==null?void 0:fe.value)==null||ve),Tp=!((Ee=(we=S.getPermissionPoint(new m.WorksheetViewPermission(Qt,Xo).id))==null?void 0:we.value)==null||Ee);C({viewDisable:Tp,editDisable:Ep});return}const{actualRow:bp,actualColumn:wp}=_p,Yn=f.getCellInfo(Qt,Xo,bp,wp);C({editDisable:!((bt=Yn==null?void 0:Yn[m.UnitAction.Edit])==null||bt),viewDisable:!((wt=Yn==null?void 0:Yn[m.UnitAction.View])==null||wt)})}else C({viewDisable:!1,editDisable:!1})});return()=>{se.unsubscribe()}},[O]),x.useEffect(()=>{const se=c.visible$.subscribe(te=>{i(te.visible)});return()=>se.unsubscribe()},[c.visible$]),x.useEffect(()=>{const se=c.currentEditCellState$.subscribe(te=>{var fe,ve,we;(we=(ve=(fe=te==null?void 0:te.documentLayoutObject.documentModel)==null?void 0:fe.getBody())==null?void 0:ve.customBlocks)!=null&&we.length?w(!0):w(!1)});return()=>se.unsubscribe()},[c.currentEditCellState$]),x.useEffect(()=>{const se=()=>{if(!L.current)return;const te=L.current.getBoundingClientRect();l.setPosition(te)};if(L.current){se();const te=new ResizeObserver(se);return te.observe(L.current),()=>te.disconnect()}},[l]);function B(){s(r===0?1:0),setTimeout(()=>{l.handleFoldBtnClick(r===1)},150)}function U(){c.isVisible().visible&&v.executeCommand(Se.id,{visible:!1,eventType:M.DeviceInputEventType.Keyboard,keycode:I.KeyCode.ESC,unitId:P.unitId})}function z(){c.isVisible().visible&&v.executeCommand(Se.id,{visible:!1,eventType:M.DeviceInputEventType.PointerDown,unitId:P.unitId})}function F(){l.handleFxBtnClick(!0)}const{viewDisable:j,editDisable:Y}=p,Q=Y||_,oe=x.useRef(!1),re=()=>{try{if(c.isVisible().visible===!1&&!v.syncExecuteCommand(Se.id,{visible:!0,eventType:M.DeviceInputEventType.PointerDown,unitId:P.unitId})){oe.current=!0;return}H.setContextValue(a.FOCUSING_FX_BAR_EDITOR,!0)}catch(se){throw oe.current=!0,se}},ce=()=>{oe.current&&setTimeout(()=>{W.blur(!0)},30),oe.current=!1},Z=((ie=(ue=(ne=P==null?void 0:P.documentLayoutObject.documentModel)==null?void 0:ne.getDrawingsOrder())==null?void 0:ue.length)!=null?ie:0)>0||j;return b.jsxs("div",{"data-u-comp":"formula-bar",className:X.clsx("univer-box-border univer-flex univer-bg-white univer-transition-[height] univer-ease-linear dark:!univer-bg-gray-900",X.borderBottomClassName,o,{"univer-h-7":r===0,"univer-h-20":r===1,"univer-pointer-events-none":Y}),children:[b.jsx("div",{className:"univer-relative univer-box-border univer-h-full univer-w-[100px]",children:b.jsx(Qh,{disable:e!=null?e:Y})}),b.jsxs("div",{className:"univer-flex univer-h-full univer-w-full",children:[b.jsx("div",{className:X.clsx("univer-py-1.5",{"univer-cursor-not-allowed univer-text-gray-200":Q}),children:b.jsxs("div",{className:X.clsx("univer-relative univer-box-border univer-flex univer-h-full univer-w-20 univer-items-center univer-justify-center univer-text-xs",X.borderRightClassName),children:[b.jsx("span",{className:X.clsx("univer-flex univer-items-center univer-justify-center univer-rounded univer-p-1 univer-text-base dark:!univer-text-white",{"univer-cursor-pointer univer-text-red-600 hover:univer-bg-gray-100 dark:!univer-text-green-400 dark:hover:!univer-bg-gray-700":t}),onClick:U,children:b.jsx(ka,{})}),b.jsx("span",{className:X.clsx("univer-flex univer-items-center univer-justify-center univer-rounded univer-p-1 univer-text-base dark:!univer-text-white",{"univer-cursor-pointer univer-text-green-600 hover:univer-bg-gray-100 dark:!univer-text-red-400 dark:hover:!univer-bg-gray-700":t}),onClick:z,children:b.jsx(zt,{})}),b.jsx("span",{className:"univer-flex univer-cursor-pointer univer-items-center univer-justify-center univer-rounded univer-p-1 univer-text-base hover:univer-bg-gray-100 dark:!univer-text-white dark:hover:!univer-bg-gray-700",onClick:F,children:b.jsx(La,{})})]})}),b.jsxs("div",{className:"univer-flex univer-w-full univer-flex-1 univer-overflow-hidden univer-pl-3",children:[b.jsxs("div",{ref:L,className:"univer-relative univer-flex-1",onPointerDown:re,onPointerUp:ce,style:{pointerEvents:Z?"none":"auto"},children:[D&&b.jsx(D,{className:"univer-relative univer-h-full univer-w-full univer-break-words univer-outline-none [&>div]:univer-ring-transparent",disableSelectionOnClick:!0,editorId:a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY,initValue:"",onChange:()=>{},isFocus:V,unitId:P==null?void 0:P.unitId,subUnitId:P==null?void 0:P.sheetId,isSupportAcrossSheet:!0,resetSelectionOnBlur:!1,isSingle:!1,keyboardEventConfig:A,onFormulaSelectingChange:(se,te)=>{T.current=se,te&&(se?c.enableForceKeepVisible():c.disableForceKeepVisible())},autoScrollbar:!1,disableContextMenu:!1}),Z&&b.jsx("div",{className:"univer-pointer-events-none univer-relative univer-left-0 univer-top-0 univer-z-[100] univer-h-full univer-w-full univer-cursor-not-allowed univer-bg-white"})]}),b.jsx("div",{className:X.clsx("univer-flex univer-h-full univer-w-5 univer-cursor-pointer univer-items-center univer-justify-center univer-text-xs univer-text-gray-700 dark:!univer-text-gray-200",{"univer-cursor-not-allowed univer-text-gray-200 dark:!univer-text-gray-700":Y}),onClick:B,children:b.jsx(Va,{className:X.clsx({"univer-rotate-180":r===1})})})]})]}),b.jsx(I.ComponentContainer,{components:k},"formula-aux")]})}function go(n){const{children:o,className:e,style:t,disabled:i=!1,onClick:r,...s}=n,l=c=>{if(i){c.preventDefault();return}r&&r(c)};return b.jsx(X.Button,{"data-u-comp":"sheet-bar-append-button",className:e,size:"small",disabled:i,style:t,variant:"text",onClick:l,...s,children:o})}function Jh(){const[n,o]=x.useState([]),[e,t]=x.useState(!1),i=I.useDependency(a.IUniverInstanceService),r=I.useDependency(a.ICommandService),s=I.useDependency(Ut),l=I.useDependency(m.WorksheetProtectionRuleModel),c=I.useObservable(()=>i.getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET),null,!1,[]),d=v=>{const{sheetId:p}=v;!p||!c||(v.hidden?r.executeCommand(m.SetWorksheetShowCommand.id,{unitId:c.getUnitId(),subUnitId:p,value:p}):v.selected||r.executeCommand(m.SetWorksheetActivateCommand.id,{unitId:c.getUnitId(),subUnitId:p}),t(!1))},u=x.useCallback(()=>{if(!c)return;const v=c.getSheets(),p=c.getActiveSheet(),C=v.map((_,w)=>({label:_.getName(),index:`${w}`,sheetId:_.getSheetId(),hidden:_.isSheetHidden()===a.BooleanNumber.TRUE,selected:p===_}));o(C)},[c,l]),h=x.useCallback(()=>r.onCommandExecuted(v=>{switch(v.id){case m.SetWorksheetHideMutation.id:case m.RemoveSheetMutation.id:case m.SetWorksheetNameMutation.id:case m.InsertSheetMutation.id:case m.SetWorksheetOrderMutation.id:case m.SetWorksheetActiveOperation.id:u();break}}),[r,u]);function g(){t(!0)}const S=v=>{t(v)};x.useEffect(()=>{u();const v=new a.DisposableCollection;return v.add(h()),v.add(s.registerSheetBarMenuHandler({handleSheetBarMenu:g})),()=>v.dispose()},[h,s,u,c]);const f=x.useMemo(()=>n.map(v=>({type:"item",children:b.jsxs("div",{className:"univer-relative univer-box-border univer-pl-6",children:[(v.selected||v.hidden)&&b.jsxs("span",{className:"univer-absolute univer-left-1 univer-top-0.5",children:[v.selected&&b.jsx(zt,{className:"univer-size-4 univer-text-primary-600"}),v.hidden&&b.jsx(Wa,{className:"univer-size-4 univer-text-gray-400"})]}),b.jsx("span",{className:X.clsx({"univer-text-primary-600":v.selected}),children:v.label})]}),onSelect:()=>{d(v)}})),[n]);return b.jsx(X.DropdownMenu,{align:"start",items:f,open:e,onOpenChange:S,children:b.jsx("div",{children:b.jsx(go,{children:b.jsx(Ha,{})})})})}function $h(n){const{sheetId:o,label:e,color:t,selected:i,menuOverlay:r}=n,[s,l]=x.useState(i),c=I.useDependency(a.ThemeService);x.useEffect(()=>{l(i)},[i]);const d=u=>{const h=c.getColorFromTheme("gray.900"),g=c.getColorFromTheme("white");return new a.ColorKit(u).isDark()?g:h};return b.jsx("div",{"data-u-comp":"slide-tab-item","data-id":o,className:X.clsx("univer-mx-1 univer-box-border univer-flex univer-flex-grow univer-cursor-pointer univer-select-none univer-flex-row univer-items-center univer-rounded univer-text-xs univer-transition-[colors,box-shadow]",{"dark:!univer-text-white":!t||t&&!d(t),"univer-justify-center univer-bg-white univer-font-bold univer-text-primary-700 univer-shadow":s,"dark:!univer-bg-gray-900":s&&!t,"univer-font-medium univer-text-gray-900 hover:univer-bg-gray-100":!s,"dark:hover:!univer-bg-gray-700":!s&&!t}),style:{backgroundColor:!s&&t?t:"",color:!s&&t?d(t):"",boxShadow:s&&t?`0px 0px 8px rgba(0, 0, 0, 0.08), inset 0px -2px 0px 0px ${t}`:""},children:b.jsx("div",{className:"univer-box-border univer-flex univer-items-center univer-gap-1 univer-whitespace-nowrap univer-rounded univer-border-2 univer-border-solid univer-border-transparent univer-px-1.5 univer-py-1",children:e})},o)}const em={easeOutStrong(n,o,e,t){return-e*((n=n/t-1)*n*n*n-1)+o},backOut(n,o,e,t,i){return typeof i>"u"&&(i=.7),e*((n=n/t-1)*n*((i+1)*n+i)+1)+o}},tm={loop:!1,begin:0,end:0,duration:300,delay:0,type:"easeOutStrong",receive(n){},success(n){},cancel(n){},complete(n){}};class nm{constructor(o){R(this,"_config");R(this,"_status",0);R(this,"_start",0);R(this,"_handle",0);R(this,"_delayHandle",null);this._config={...tm,...o},this._config.loop&&(this._config.complete=()=>{},this._config.success=()=>{this.request()})}static success(...o){let e=0;return new Promise(t=>{for(let i=0;i<o.length;i++){const r=o[i],s=r._config,l=s.success;s.loop||(s.success=d=>{e++,l&&l.call(r,d),e===o.length&&t()})}})}request(){this._config.delay===0?(this._status=0,this._start=Date.now(),this._fakeHandle()):(this._delayHandle&&clearTimeout(this._delayHandle),this._delayHandle=setTimeout(()=>{this._status=0,this._start=Date.now(),this._fakeHandle()},this._config.delay))}cancel(){this._status=1,this._delayHandle&&clearTimeout(this._delayHandle),cancelAnimationFrame(this._handle)}_fakeHandle(){let o=Date.now()-this._start;o=o>=this._config.duration?this._config.duration:o;const t=em[this._config.type](o,this._config.begin,this._config.end-this._config.begin,this._config.duration,.7).toFixed(2);if(this._config.receive(t),this._status===1){this._config.cancel(t),this._config.complete(t);return}if(o===this._config.duration){this._config.success(t),this._config.complete(t);return}this._handle=requestAnimationFrame(()=>{this._fakeHandle()})}}class Xt{constructor(o,e){R(this,"_slideTabItem");R(this,"_animate");R(this,"_midline",0);R(this,"_translateX");R(this,"_scrollbar");R(this,"_slideTabBar");R(this,"_editMode");R(this,"_placeholder");this._slideTabItem=o,this._animate=null,this._translateX=0,this._editMode=!1,this._slideTabBar=e,this._placeholder=null,this._scrollbar=e.getScrollbar(),this.update()}static midline(o){return o.getBoundingRect().x+o.getBoundingRect().width/2}static leftLine(o){return o.getBoundingRect().x}static rightLine(o){return o.getBoundingRect().x+o.getBoundingRect().width}static make(o,e){const t=[];return o.forEach(i=>t.push(new Xt(i,e))),t}getSlideTabItem(){return this._slideTabItem}getEditor(){return this._slideTabItem.querySelector("span")}focus(){var o;(o=this.getEditor())==null||o.focus()}selectAll(){const o=this.getEditor();o&&Rn.keepSelectAll(o)}isEditMode(){return this._editMode}classList(){return this._slideTabItem.classList}translateX(o){return this._translateX=o,this._slideTabItem.style.transform=`translateX(${o}px)`,this.getTranslateXDirection()}setEditor(o){if(!this._slideTabBar.getConfig().onNameChangeCheck())return;let e=!0;if(this._editMode===!1){const t=this._slideTabItem.querySelector("span"),i=d=>{if(!this.nameCheck()){if(this._editMode=!1,t&&(t.removeAttribute("contentEditable"),t.removeEventListener("focusout",i),t.removeEventListener("compositionstart",s),t.removeEventListener("compositionend",l),t.removeEventListener("input",c),t.removeEventListener("keydown",r)),this._slideTabBar.removeListener(),this._slideTabBar.updateItems(),this._slideTabBar.getConfig().onChangeName){const u=(t==null?void 0:t.innerText)||"",h=this.getId();this._slideTabBar.getConfig().onChangeName(h,u)}o&&o(d)}};let r=d=>{t&&(d.stopPropagation(),d.key==="Enter"&&t.blur())};const s=d=>{e=!1},l=d=>{e=!0},c=d=>{if(!t)return;const u=31;setTimeout(()=>{if(e){const h=t.innerText;h.length>u&&(t.innerText=h.substring(0,u),Rn.keepLastIndex(t))}},0)};t&&(t.setAttribute("contentEditable","true"),t.addEventListener("focusout",i),t.addEventListener("compositionstart",s),t.addEventListener("compositionend",l),t.addEventListener("input",c),t.addEventListener("keydown",r),this._editMode=!0,Rn.keepSelectAll(t))}}nameCheck(){const o=this._slideTabItem.querySelector("span");if(!o)return!1;const e=o.innerText;return this._slideTabBar.getConfig().onNameCheckAlert(e)}animate(){return{translateX:o=>{this._translateX!==o&&(this._animate&&(this._animate.cancel(),this._animate=null),this._animate=new nm({begin:this._translateX,end:o,receive:e=>{this._slideTabItem.style.transform=`translateX(${e}px)`}}),this._translateX=o,this._animate.request())},cancel:()=>{this._animate&&(this._animate.cancel(),this._animate=null)}}}after(o){this._slideTabItem.after(o._slideTabItem||o)}update(){this._midline=Xt.midline(this)}disableFixed(){if(this._placeholder){const o=this._slideTabBar.primeval();this._slideTabItem.style.removeProperty("position"),this._slideTabItem.style.removeProperty("left"),this._slideTabItem.style.removeProperty("top"),this._slideTabItem.style.removeProperty("width"),this._slideTabItem.style.removeProperty("height"),this._slideTabItem.style.removeProperty("background"),this._slideTabItem.style.removeProperty("padding"),this._slideTabItem.style.removeProperty("box-sizing"),this._slideTabItem.style.removeProperty("font-size"),this._slideTabItem.style.removeProperty("font-family"),this._slideTabItem.style.removeProperty("font-weight"),this._slideTabItem.style.removeProperty("color"),this._slideTabItem.style.removeProperty("border-radius"),this._placeholder.after(this._slideTabItem),o.removeChild(this._placeholder),this._placeholder=null}}enableFixed(){const o=document.createElement("div"),e=this.getBoundingRect(),t=getComputedStyle(this._slideTabItem),i=this._slideTabItem.querySelector("span");if(this._placeholder=o,this._placeholder.style.width=`${e.width}px`,this._placeholder.style.height=`${e.height}px`,this._placeholder.style.flexShrink="0",this._placeholder.style.margin=t.margin,this._slideTabItem.style.background=t.background,i){const r=getComputedStyle(i).padding;this._slideTabItem.style.padding=r}this._slideTabItem.style.boxSizing=t.boxSizing,this._slideTabItem.style.fontSize=t.fontSize,this._slideTabItem.style.fontFamily=t.fontFamily,this._slideTabItem.style.fontWeight=t.fontWeight,this._slideTabItem.style.color=t.color,this._slideTabItem.style.borderRadius=t.borderRadius,this._slideTabItem.style.left=`${e.x-this.getScrollbar().getScrollX()}px`,this._slideTabItem.style.top=`${e.y}px`,this._slideTabItem.style.width=`${e.width}px`,this._slideTabItem.style.height=`${e.height}px`,this._slideTabItem.style.position="fixed",this._slideTabItem.after(o),document.body.appendChild(this._slideTabItem)}addEventListener(o,e,t){this._slideTabItem.addEventListener(o,e,t)}removeEventListener(o,e,t){this._slideTabItem.removeEventListener(o,e,t)}getScrollbar(){return this._scrollbar}getMidLine(){return this._midline}getBoundingRect(){const o=this._slideTabItem.getBoundingClientRect();return o.x+=this._scrollbar.getScrollX(),o}getWidth(){return this.getBoundingRect().width}getTranslateXDirection(){const o=Xt.midline(this);return o>this._midline?1:o<this._midline?-1:0}equals(o){return o&&o._slideTabItem===this._slideTabItem}getId(){return this._slideTabItem.dataset.id||""}}class im{constructor(o){R(this,"_slideTabBar");R(this,"_scrollX");const e=o.primeval();this._scrollX=e.scrollLeft,this._slideTabBar=o}scrollX(o){const e=this._slideTabBar.primeval();e.scrollLeft=o,this._scrollX=e.scrollLeft}scrollRight(){const o=this._slideTabBar.primeval();o.scrollLeft=o.scrollWidth,this._scrollX=o.scrollLeft}getScrollX(){return this._scrollX}}const Xn=class Xn{constructor(o){R(this,"_activeTabItemIndex",0);R(this,"_slideTabBar");R(this,"_slideTabItems",[]);R(this,"_config");R(this,"_downActionX",0);R(this,"_moveActionX",0);R(this,"_compareIndex",0);R(this,"_activeTabItem",null);R(this,"_moveAction");R(this,"_upAction");R(this,"_downAction");R(this,"_wheelAction");R(this,"_scrollIncremental",0);R(this,"_compareDirection",0);R(this,"_autoScrollTime",null);R(this,"_slideScrollbar");R(this,"_longPressTimer",null);R(this,"_leftBoundingLine",0);R(this,"_rightBoundingLine",0);R(this,"_leftMoveX",0);R(this,"_rightMoveX",0);if(o.slideTabBarContainer==null)throw new Error("not found slide-tab-bar root element");const e=o.slideTabBarContainer.querySelector(`${o.slideTabBarSelector}`);if(e==null)throw new Error("not found slide-tab-bar");this._slideTabBar=e,this._slideScrollbar=new im(this),this._config=o,this._initConfig();let t=0,i=0,r=0;this._downAction=s=>{var O,T,P,A,D,k;if((O=this._activeTabItem)!=null&&O.isEditMode())return;this._longPressTimer&&(clearTimeout(this._longPressTimer),this._longPressTimer=null);const l=(P=(T=s.target)==null?void 0:T.closest(`${o.slideTabBarItemSelector}`))==null?void 0:P.getAttribute("data-id"),c=this._slideTabItems.findIndex(H=>H.getId()===l);if(l==null||c===-1)return;if(this._activeTabItemIndex!==c){(A=this._activeTabItem)==null||A.removeEventListener("pointermove",this._moveAction),(D=this._activeTabItem)==null||D.removeEventListener("pointerup",this._upAction),this.removeListener(),this._config.onChangeTab(s,l);return}if(this._compareIndex=c,this._downActionX=s.pageX,this._moveActionX=0,this._scrollIncremental=0,this._activeTabItem=this._slideTabItems[c],!this._activeTabItem){console.error("Not found active slide-tab-item in sheet bar");return}const d=this._activeTabItem.getSlideTabItem();d==null||d.setPointerCapture(s.pointerId),(k=this._activeTabItem)==null||k.addEventListener("pointerup",this._upAction);const{x:u,width:h}=this._activeTabItem.getBoundingRect(),{x:g,width:S}=this.getBoundingRect(),f=this._slideScrollbar.getScrollX();if(this._leftBoundingLine=this._downActionX-(u-f),this._rightBoundingLine=u-f+h-this._downActionX,this._leftMoveX=u-g-f,this._rightMoveX=g+S-(u+h)+f,s.button===2||this._hasEditItem())return;const{pageX:v,pageY:p}=s,C=Date.now(),_=C-r<=Xn.DoubleClickDelay,w=Math.abs(v-t)<10,E=Math.abs(p-i)<10;_&&w&&E&&this._activeTabItem.setEditor(),t=v,i=p,r=C,this._longPressTimer=setTimeout(()=>{var H,V,L;!d||(H=this._activeTabItem)!=null&&H.isEditMode()||((V=this._activeTabItem)==null||V.enableFixed(),this._startAutoScroll(),d.setPointerCapture(s.pointerId),d.style.cursor="move",(L=this._activeTabItem)==null||L.addEventListener("pointermove",this._moveAction))},Xn.LongPressDelay)},this._upAction=s=>{var d,u,h,g;if((d=this._activeTabItem)!=null&&d.isEditMode()||(this._longPressTimer&&(clearTimeout(this._longPressTimer),this._longPressTimer=null),!this._activeTabItem))return;const l=this._autoScrollTime!==null;this._closeAutoScroll(),this._activeTabItem.disableFixed(),this.updateItems();const c=(u=this._activeTabItem)==null?void 0:u.getSlideTabItem();c&&(c.style.cursor="",c.releasePointerCapture(s.pointerId),(h=this._activeTabItem)==null||h.removeEventListener("pointermove",this._moveAction),(g=this._activeTabItem)==null||g.removeEventListener("pointerup",this._upAction),this._config.onSlideEnd&&this._activeTabItemIndex!==this._compareIndex&&l&&(this.removeListener(),this._config.onSlideEnd(s,this._compareIndex||0)),this._scrollIncremental=0,this._downActionX=0,this._moveActionX=0,this._compareIndex=0)},this._moveAction=s=>{this._activeTabItem&&(this._moveActionX=s.pageX-this._downActionX,this._moveActionX<=-this._leftMoveX?this._moveActionX=-this._leftMoveX:this._moveActionX>=this._rightMoveX&&(this._moveActionX=this._rightMoveX),this._scrollIncremental=0,this._scrollLeft(s),this._scrollRight(s))},this._wheelAction=s=>{this.setScroll(s.deltaY)},this.addListener()}static checkedSkipSlide(o){let e=o.target;for(;e!=null&&e!==document.body;){if(e.getAttribute("data-slide-skip"))return!0;e=e.parentElement}return!1}static keepLastIndex(o){setTimeout(()=>{const e=window.getSelection();e&&(e.selectAllChildren(o),e.collapseToEnd())})}static keepSelectAll(o){setTimeout(()=>{const e=window.getSelection();if(!e)return;const t=document.createRange();t.selectNodeContents(o),e.removeAllRanges(),e.addRange(t)})}update(o){this._config.currentIndex=o,this._initConfig(),this.removeListener(),this.addListener(),this.scrollToItem(o)}primeval(){return this._slideTabBar}updateItems(){for(let o=0;o<this._slideTabItems.length;o++)this._slideTabItems[o].animate().cancel(),this._slideTabItems[o].translateX(0),this._slideTabItems[o].update()}getScrollbar(){return this._slideScrollbar}getConfig(){return this._config}getBoundingRect(){return this._slideTabBar.getBoundingClientRect()}getSlideTabItems(){return this._slideTabItems}getActiveItem(){return this._activeTabItem}isLeftEnd(){return this._slideTabBar.scrollLeft===0}isRightEnd(){const o=this._slideTabBar.parentElement;return o?this._slideTabBar.scrollWidth-o.clientWidth===this._slideTabBar.scrollLeft:!1}addListener(){this._slideTabBar.addEventListener("wheel",this._wheelAction),this._slideTabItems.forEach(o=>{o.addEventListener("pointerdown",this._downAction)})}removeListener(){this._slideTabBar.removeEventListener("wheel",this._wheelAction),this._slideTabItems.forEach(o=>{o.removeEventListener("pointerdown",this._downAction)})}setScroll(o){if(this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+o),o>0){const e=this.calculateLeftScrollX();this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+e)}else if(o<0){const e=this.calculateRightScrollX();this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+e)}this._config.onScroll({leftEnd:this.isLeftEnd(),rightEnd:this.isRightEnd()})}flipPage(o){if(o>0){const e=this.calculateLeftScrollX(!0);this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+e)}else if(o<0){const e=this.calculateRightScrollX(!0);this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+e)}this._config.onScroll({leftEnd:this.isLeftEnd(),rightEnd:this.isRightEnd()})}scrollToItem(o){if(o=o!=null?o:this._config.currentIndex,o<0||o>=this._slideTabItems.length){console.error("Index out of bounds");return}const e=this.calculateTabItemScrollX(o);this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+e),this._config.onScroll({leftEnd:this.isLeftEnd(),rightEnd:this.isRightEnd()})}calculateLeftScrollX(o){let e=0;const t=4;return this._slideTabItems.some(i=>{const r=this._slideTabBar.getBoundingClientRect(),s=r.left+r.width,l=i.getSlideTabItem().getBoundingClientRect(),c=l.left,d=l.width;return c<s&&c+d+t*2>s?(e=o?c-r.left-t:c+d-s+t,!0):!1}),e}calculateRightScrollX(o){let e=0;const t=4;return this._slideTabItems.some(i=>{const r=this._slideTabBar.getBoundingClientRect(),s=r.left,l=i.getSlideTabItem().getBoundingClientRect(),c=l.left,d=l.width;return c-t*2<s&&c+d>s?(e=o?c+d-r.left-r.width+t:c-s-t,!0):!1}),e}calculateTabItemScrollX(o){let e=0;const t=4,i=this._slideTabBar.getBoundingClientRect(),r=i.left,s=i.left+i.width,l=this._slideTabItems[o].getSlideTabItem().getBoundingClientRect(),c=l.left,d=l.width;return c-t*2<r&&(e=c-r-t),c+d+t*2>s&&(e=c+d-s+t),e}calculateActiveTabItemScrollX(){var d;let o=0;const e=4,t=this._slideTabBar.getBoundingClientRect(),i=t.left,r=t.left+t.width,s=(d=this._activeTabItem)==null?void 0:d.getSlideTabItem().getBoundingClientRect();if(!s)return 0;const l=s.left,c=s.width;return l-e*2<i&&l+c>i&&(o=l-i-e),l<r&&l+c+e*2>r&&(o=l+c-r+e),o}destroy(){this.removeListener(),this._downActionX=0,this._moveActionX=0,this._compareDirection=0,this._compareIndex=0,this._slideTabItems=[],this._activeTabItem=null}_hasEditItem(){for(let o=0;o<this._slideTabItems.length;o++)if(this._slideTabItems[o].isEditMode())return!0;return!1}_autoScrollFrame(){if(this._activeTabItem)switch(this._compareDirection=this._activeTabItem.translateX(this._moveActionX),this._compareDirection){case 1:{this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+this._scrollIncremental),this._compareRight();break}case 0:{this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+this._scrollIncremental),this._compareIndex=this._activeTabItemIndex;break}case-1:{this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+this._scrollIncremental),this._compareLeft();break}}this._autoScrollTime=requestAnimationFrame(()=>{this._autoScrollFrame()})}_startAutoScroll(){this._autoScrollTime==null&&this._autoScrollFrame()}_closeAutoScroll(){this._autoScrollTime&&cancelAnimationFrame(this._autoScrollTime),this._autoScrollTime=null}_scrollLeft(o){const e=this.getBoundingRect(),t=o.pageX-e.x;t<this._leftBoundingLine&&(this._scrollIncremental=-Math.min(Math.abs(t-this._leftBoundingLine)*.1,50))}_scrollRight(o){const e=this.getBoundingRect(),t=o.pageX-e.x;t>e.width-this._rightBoundingLine&&(this._scrollIncremental=Math.min(Math.abs(t-(e.width-this._rightBoundingLine))*.1,50))}_sortedItems(){if(this._activeTabItem!=null&&this._activeTabItemIndex!=null&&this._compareIndex!=null&&(this._slideTabItems.splice(this._activeTabItemIndex,1),this._slideTabItems.splice(this._compareIndex,0,this._activeTabItem),this._config.slideTabBarItemAutoSort))for(let o=0;o<this._slideTabItems.length;o++){const e=this._slideTabItems[o],t=this._slideTabItems[o+1];t&&e.after(t)}}_compareLeft(){if(this._activeTabItem&&this._activeTabItemIndex){const o=this._slideTabItems.findIndex(r=>r.equals(this._activeTabItem)),e=this._slideTabItems.length,t=[];for(let r=0;r<o&&!(r>=o);r++)t.push(this._slideTabItems[r]);for(let r=o+1;r<e;r++)this._slideTabItems[r].animate().translateX(0);let i=!0;for(let r=t.length-1;r>=0;r--){const s=t[r];Xt.leftLine(this._activeTabItem)<s.getMidLine()?(s.animate().translateX(this._activeTabItem.getWidth()),this._compareIndex=r,i=!1):(s.animate().translateX(0),i&&(this._compareIndex=this._activeTabItemIndex))}}}_compareRight(){if(this._activeTabItem){const o=this._slideTabItems.findIndex(r=>r.equals(this._activeTabItem)),e=this._slideTabItems.length,t=[];for(let r=o+1;r<e;r++)t.push(this._slideTabItems[r]);for(let r=0;r<o;r++)this._slideTabItems[r].animate().translateX(0);let i=!0;for(let r=0;r<t.length;r++){const s=t[r];Xt.rightLine(this._activeTabItem)>s.getMidLine()?(s.animate().translateX(-this._activeTabItem.getWidth()),this._compareIndex=o+r+1,i=!1):(s.animate().translateX(0),i&&(this._compareIndex=this._activeTabItemIndex))}}}_initConfig(){const o=this._slideTabBar.querySelectorAll(`${this._config.slideTabBarItemSelector}`);this._downActionX=0,this._moveActionX=0,this._compareDirection=0,this._compareIndex=0,this._slideTabItems=Xt.make(o,this),this._activeTabItemIndex=this._config.currentIndex,this._activeTabItem=this._slideTabItems[this._activeTabItemIndex]}};R(Xn,"LongPressDelay",500),R(Xn,"DoubleClickDelay",300);let Rn=Xn;function om(){var ce;const[n,o]=x.useState([]),[e,t]=x.useState(""),[i,r]=x.useState(""),[s,l]=x.useState(!1),[c,d]=x.useState([0,0]),u=x.useRef({slideTabBar:null}),h=x.useRef(null),g=I.useDependency(a.ICommandService),S=I.useDependency(Ut),f=I.useDependency(a.LocaleService),v=I.useDependency(I.IConfirmService),p=I.useDependency(me,a.Quantity.OPTIONAL),C=I.useDependency(m.WorksheetProtectionRuleModel),_=I.useDependency(m.RangeProtectionRuleModel),w=I.useObservable(C.resetOrder$),E=St(),O=I.useDependency(a.IPermissionService),T=x.useCallback(()=>{var ue;const G=((ue=E.getActiveSheet())==null?void 0:ue.getSheetId())||"";t(G);const Z=E.getSheets(),J=E.getActiveSheet(),ne=Z.filter(ie=>!ie.isSheetHidden()).map((ie,se)=>{var Ee;const te=C.getRule(E.getUnitId(),ie.getSheetId()),fe=_.getSubunitRuleList(E.getUnitId(),ie.getSheetId()).length>0,we=(te==null?void 0:te.permissionId)||fe?b.jsxs(b.Fragment,{children:[b.jsx(Tr,{}),b.jsx("span",{className:"univer-outline-none",children:ie.getName()})]}):b.jsx("span",{className:"univer-outline-none",children:ie.getName()});return{sheetId:ie.getSheetId(),label:we,index:se,selected:J===ie,color:(Ee=ie.getTabColor())!=null?Ee:void 0}});o(ne),t(G)},[_,E,C]);x.useEffect(()=>{T();const{slideTabBar:G,disconnectResizeObserver:Z}=P(),J=U(),ne=[z(),F(),j()];return()=>{J.dispose(),G.destroy(),ne.forEach(ue=>ue.unsubscribe()),Z&&Z()}},[w,E]),x.useEffect(()=>{n.length>0&&B()},[n]),x.useEffect(()=>{const G=N.merge(C.ruleChange$,_.ruleChange$).subscribe(()=>{T()});return()=>{G.unsubscribe()}},[C,T]);const P=()=>{const G=new Rn({slideTabBarSelector:"[data-u-comp=slide-tab-bar]",slideTabBarItemSelector:"[data-u-comp=slide-tab-item]",slideTabBarItemAutoSort:!0,slideTabBarContainer:h.current,currentIndex:0,onChangeName:(J,ne)=>{g.executeCommand(m.SetWorksheetNameCommand.id,{subUnitId:J,name:ne})},onSlideEnd:async(J,ne)=>{await g.executeCommand(m.SetWorksheetOrderCommand.id,{order:ne})},onChangeTab:(J,ne)=>{g.executeCommand(m.SetWorksheetActiveOperation.id,{subUnitId:ne,unitId:E.getUnitId()}).then(()=>{J.button===2&&re(!0)})},onScroll:J=>{S.setScroll(J)},onNameCheckAlert:J=>k(J)||H(J)||V(J),onNameChangeCheck:()=>{var te,fe,ve,we;const J=E.getUnitId(),ne=E==null?void 0:E.getActiveSheet();if(!ne)throw new Error("No active sheet found");const ue=ne.getSheetId(),ie=C.getRule(J,ue),se=_.getSubunitRuleList(J,ue).length>0;return ie||se?(fe=(te=O.getPermissionPoint(new m.WorkbookManageCollaboratorPermission(J).id))==null?void 0:te.value)!=null?fe:!1:(we=(ve=O.getPermissionPoint(new m.WorkbookRenameSheetPermission(J).id))==null?void 0:ve.value)!=null?we:!1}});u.current.slideTabBar=G;const Z=oe(G);return{slideTabBar:G,disconnectResizeObserver:Z}},A=I.useConfigValue(I.UI_PLUGIN_CONFIG_KEY),D=(ce=A==null?void 0:A.contextMenu)!=null?ce:!0,k=G=>{if(G.trim()===""){const Z="sheetNameEmptyAlert";return v.open({id:Z,title:{title:f.t("sheetConfig.sheetNameErrorTitle")},children:{title:f.t("sheetConfig.sheetNameCannotIsEmptyError")},cancelText:f.t("button.cancel"),confirmText:f.t("button.confirm"),onClose(){L(),v.close(Z)},onConfirm(){L(),v.close(Z)}}),!0}return!1},H=G=>{if(!a.nameCharacterCheck(G)){const Z="sheetNameSpecCharAlert";return v.open({id:Z,title:{title:f.t("sheetConfig.sheetNameErrorTitle")},children:{title:f.t("sheetConfig.sheetNameSpecCharError")},cancelText:f.t("button.cancel"),confirmText:f.t("button.confirm"),onClose(){L(),v.close(Z)},onConfirm(){L(),v.close(Z)}}),!0}return!1},V=G=>{const Z=E.getActiveSheet();if((Z==null?void 0:Z.getName())===G)return!1;const ne=E.checkSheetName(G);if(ne){const ue="sheetNameRepeatAlert";v.open({id:ue,title:{title:f.t("sheetConfig.sheetNameErrorTitle")},children:{title:f.t("sheetConfig.sheetNameAlreadyExistsError")},cancelText:f.t("button.cancel"),confirmText:f.t("button.confirm"),onClose(){v.close(ue),L()},onConfirm(){v.close(ue),L()}})}return ne},L=()=>{setTimeout(()=>{var Z;const G=(Z=u.current.slideTabBar)==null?void 0:Z.getActiveItem();G&&(G.focus(),G.selectAll())},0)},W=()=>{var G,Z;(Z=(G=u.current.slideTabBar)==null?void 0:G.getActiveItem())==null||Z.setEditor()},B=()=>{var Z;const G=n.findIndex(J=>J.selected);(Z=u.current.slideTabBar)==null||Z.update(G)},U=()=>g.onCommandExecuted(G=>{switch(G.id){case m.SetTabColorMutation.id:case m.SetWorksheetHideMutation.id:case m.RemoveSheetMutation.id:case m.SetWorksheetNameMutation.id:case m.InsertSheetMutation.id:case m.SetWorksheetOrderMutation.id:case m.SetWorksheetActiveOperation.id:T();break}}),z=()=>S.scroll$.subscribe(G=>{Y(G)}),F=()=>S.scrollX$.subscribe(G=>{var Z;(Z=u.current.slideTabBar)==null||Z.flipPage(G)}),j=()=>S.renameId$.subscribe(()=>{W()}),Y=G=>{const{leftEnd:Z,rightEnd:J}=G;let ne="";Z&&J?ne="":Z&&!J?ne="inset -10px 0px 10px -10px rgba(0, 0, 0, 0.2)":!Z&&J?ne="inset 10px 0px 10px -10px rgba(0, 0, 0, 0.2)":!Z&&!J&&(ne="inset 10px 0px 10px -10px rgba(0, 0, 0, 0.2), inset -10px 0px 10px -10px rgba(0, 0, 0, 0.2)"),r(ne)},Q=G=>{const Z=G.calculateActiveTabItemScrollX();if(Z){const J=G.getScrollbar();J.scrollX(J.getScrollX()+Z)}S.setScroll({leftEnd:G.isLeftEnd(),rightEnd:G.isRightEnd()})},oe=G=>{var ne;const Z=(ne=h.current)==null?void 0:ne.querySelector("[data-u-comp=slide-tab-bar]");if(!Z)return;const J=new ResizeObserver(()=>{Q(G)});return J.observe(Z),()=>J.disconnect()},re=G=>{var Z,J,ne,ue,ie;if(D&&!(p!=null&&p.isForceKeepVisible())){if(G){const{left:se}=(J=(Z=h.current)==null?void 0:Z.getBoundingClientRect())!=null?J:{},{left:te}=(ie=(ue=(ne=u.current.slideTabBar)==null?void 0:ne.getActiveItem())==null?void 0:ue.getSlideTabItem().getBoundingClientRect())!=null?ie:{};se!==void 0&&te!==void 0&&d([te-se,0])}l(G)}};return b.jsx(X.DropdownLegacy,{className:"univer-select-none",visible:s,align:{offset:c},trigger:["contextMenu"],overlay:b.jsx(I.UIMenu,{menuType:I.ContextMenuPosition.FOOTER_TABS,onOptionSelect:G=>{const{label:Z,value:J,commandId:ne}=G;g.executeCommand(ne!=null?ne:Z,{value:J,subUnitId:e}),l(!1)}}),onVisibleChange:re,children:b.jsx("div",{className:"univer-max-w-[calc(100%-112px)] univer-overflow-hidden",ref:h,onDragStart:G=>G.preventDefault(),onContextMenu:G=>G.preventDefault(),children:b.jsx("div",{"data-u-comp":"slide-tab-bar",className:"univer-flex univer-select-none univer-flex-row univer-items-center univer-overflow-hidden univer-px-1.5 univer-py-1",style:{boxShadow:i},children:n.map(G=>x.createElement($h,{...G,key:G.sheetId,selected:e===G.sheetId}))})})})}const Ka=100,qa=()=>{var v,p;const[n,o]=x.useState(!0),[e,t]=x.useState(!0),i=I.useDependency(a.ICommandService),r=I.useDependency(Ut),s=I.useDependency(a.IPermissionService),c=St().getUnitId(),d=I.useObservable(s.getPermissionPoint$((v=new m.WorkbookEditablePermission(c))==null?void 0:v.id)),u=I.useObservable(s.getPermissionPoint$((p=new m.WorkbookCreateSheetPermission(c))==null?void 0:p.id)),h=C=>{const{leftEnd:_,rightEnd:w}=C;o(_),t(w)};x.useEffect(()=>{const C=r.scroll$.subscribe(a.throttle(_=>{h(_)},100));return()=>{C.unsubscribe()}},[]);const g=()=>{i.executeCommand(m.InsertSheetCommand.id),setTimeout(()=>{r.setAddSheet(0)},0)},S=()=>{r.setScrollX(-Ka)},f=()=>{r.setScrollX(Ka)};return b.jsxs("div",{className:"univer-relative univer-flex univer-h-full univer-min-w-0 univer-flex-1",children:[b.jsxs("div",{className:"univer-flex univer-items-center",children:[b.jsx(go,{className:"univer-mr-2",onClick:g,disabled:!(u!=null&&u.value&&(d!=null&&d.value)),children:b.jsx(Er,{})}),b.jsx(Jh,{})]}),b.jsx(om,{}),(!n||!e)&&b.jsxs("div",{className:'univer-relative univer-flex univer-items-center univer-px-2 after:univer-absolute after:univer-right-0 after:univer-top-1/2 after:univer-h-4 after:univer-w-px after:-univer-translate-y-1/2 after:univer-bg-gray-200 after:univer-content-[""]',children:[b.jsx(go,{disabled:n,onClick:S,children:b.jsx(yr,{className:"univer-rotate-180"})}),b.jsx(go,{disabled:e,onClick:f,children:b.jsx(yr,{})})]})]})},rm=[50,75,100,125,150,175,200,400];function sm(){const n=I.useDependency(a.ICommandService),o=I.useDependency(a.IUniverInstanceService),e=St(),t=I.useDependency(me),i=I.useObservable(t.visible$),r=x.useCallback(()=>{if(!e)return 100;const u=e.getActiveSheet(),h=u&&u.getZoomRatio()*100||100;return Math.round(h)},[e]),[s,l]=x.useState(()=>r());x.useEffect(()=>(l(r()),n.onCommandExecuted(h=>{if(h.id===je.id||h.id===m.SetWorksheetActiveOperation.id){const g=r();l(g)}}).dispose),[n,r]);function c(u){l(u);const h=o.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),g=h==null?void 0:h.getActiveSheet();if(g==null)return;const S=u/100;n.executeCommand(wn.id,{unitId:h.getUnitId(),subUnitId:g.getSheetId(),zoomRatio:S})}const d=(i==null?void 0:i.visible)&&(i.unitId===(e==null?void 0:e.getUnitId())||i.unitId===a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY);return b.jsx(I.Slider,{disabled:d,min:Yo[0],value:s,shortcuts:rm,onChange:c})}function am(){return b.jsx("section",{className:"univer-flex univer-flex-shrink-0 univer-justify-end",children:b.jsx(sm,{})})}class Or{constructor(){R(this,"_functions",[{func:K.FUNCTION_NAMES_STATISTICAL.MAX,filter:o=>{var e,t,i,r;return((t=(e=o.values.find(s=>s.func===K.FUNCTION_NAMES_STATISTICAL.COUNTA))==null?void 0:e.value)!=null?t:0)>1&&((r=(i=o.values.find(s=>s.func===K.FUNCTION_NAMES_STATISTICAL.COUNT))==null?void 0:i.value)!=null?r:0)>0}},{func:K.FUNCTION_NAMES_STATISTICAL.MIN,filter:o=>{var e,t,i,r;return((t=(e=o.values.find(s=>s.func===K.FUNCTION_NAMES_STATISTICAL.COUNTA))==null?void 0:e.value)!=null?t:0)>1&&((r=(i=o.values.find(s=>s.func===K.FUNCTION_NAMES_STATISTICAL.COUNT))==null?void 0:i.value)!=null?r:0)>0}},{func:K.FUNCTION_NAMES_MATH.SUM,filter:o=>{var e,t,i,r;return((t=(e=o.values.find(s=>s.func===K.FUNCTION_NAMES_STATISTICAL.COUNTA))==null?void 0:e.value)!=null?t:0)>1&&((r=(i=o.values.find(s=>s.func===K.FUNCTION_NAMES_STATISTICAL.COUNT))==null?void 0:i.value)!=null?r:0)>0}},{func:K.FUNCTION_NAMES_STATISTICAL.COUNTA,filter:o=>{var e,t;return((t=(e=o.values.find(i=>i.func===K.FUNCTION_NAMES_STATISTICAL.COUNTA))==null?void 0:e.value)!=null?t:0)>1}},{func:K.FUNCTION_NAMES_STATISTICAL.COUNT,filter:o=>{var e,t,i,r;return((t=(e=o.values.find(s=>s.func===K.FUNCTION_NAMES_STATISTICAL.COUNTA))==null?void 0:e.value)!=null?t:0)>1&&((r=(i=o.values.find(s=>s.func===K.FUNCTION_NAMES_STATISTICAL.COUNT))==null?void 0:i.value)!=null?r:0)>0}},{func:K.FUNCTION_NAMES_STATISTICAL.AVERAGE,filter:o=>{var e,t,i,r;return((t=(e=o.values.find(s=>s.func===K.FUNCTION_NAMES_STATISTICAL.COUNTA))==null?void 0:e.value)!=null?t:0)>1&&((r=(i=o.values.find(s=>s.func===K.FUNCTION_NAMES_STATISTICAL.COUNT))==null?void 0:i.value)!=null?r:0)>0}}]);R(this,"_state$",new N.BehaviorSubject(null));R(this,"state$",this._state$.asObservable())}dispose(){this._state$.complete()}setState(o){var t;const e={values:[],pattern:null};o==null||o.values.forEach(i=>{const r=this._functions.find(s=>s.func===i.func);r&&(r.filter===void 0||r.filter(o))&&e.values.push(i)}),e.pattern=(t=o==null?void 0:o.pattern)!=null?t:null,this._state$.next(e)}getState(){return this._state$.getValue()}getFunctions(){return this._functions}addFunctions(o){this._functions.push(...o)}}const Ei=a.createIdentifier("univer.sheet-status-bar.service"),lm=[K.FUNCTION_NAMES_MATH.SUM,K.FUNCTION_NAMES_STATISTICAL.AVERAGE,K.FUNCTION_NAMES_STATISTICAL.MIN,K.FUNCTION_NAMES_STATISTICAL.MAX],So={[K.FUNCTION_NAMES_MATH.SUM]:"statusbar.sum",[K.FUNCTION_NAMES_STATISTICAL.AVERAGE]:"statusbar.average",[K.FUNCTION_NAMES_STATISTICAL.MIN]:"statusbar.min",[K.FUNCTION_NAMES_STATISTICAL.MAX]:"statusbar.max",[K.FUNCTION_NAMES_STATISTICAL.COUNT]:"statusbar.count",[K.FUNCTION_NAMES_STATISTICAL.COUNTA]:"statusbar.countA",[K.FUNCTION_NAMES_TEXT.CONCATENATE]:"concatenate"},cm=n=>{const o=I.useDependency(a.LocaleService),e=I.useDependency(I.IMessageService),t=I.useDependency(I.IClipboardInterfaceService),i=dm(n),r=async()=>{await t.writeText(n.value.toString()),e.show({type:X.MessageType.Success,content:o.t("statusbar.copied")})};return b.jsx(X.Tooltip,{title:o.t("statusbar.clickToCopy"),placement:"top",children:b.jsx("div",{className:"univer-flex univer-cursor-pointer univer-truncate univer-text-center univer-text-xs univer-text-gray-400",onClick:r,children:b.jsx("span",{children:`${o.t((So==null?void 0:So[n.name])||n.name)}: ${i}`})},n.name)})};function dm(n){const{pattern:o,value:e}=n;return typeof e!="number"?0:e>=1e8?e.toExponential(2):o&&lm.includes(n.name)?a.numfmt.format(o,e,{throws:!1}):e.toLocaleString()}const Qa=800,um=3,hm=()=>{var h,g;const n=(g=(h=I.useConfigValue(Te))==null?void 0:h.statusBarStatistic)!=null?g:!0,[o,e]=x.useState(window.innerWidth<Qa),t=I.useDependency(Ei),i=t.getFunctions().map((S,f)=>({name:S.func,value:0,show:!0,disable:!1,pattern:null})),r=(S,f,v,p)=>{const[C,_]=x.useState(S),[w,E]=x.useState(!0),O=x.useMemo(()=>C.filter(D=>D.show&&!D.disable),[C]),T=x.useMemo(()=>O.find(D=>D.show&&!D.disable),[O]),P=x.useMemo(()=>v&&T?[T]:O,[v,T,O]),A=x.useCallback(D=>{const k=D==null?void 0:D.values;if(!(k!=null&&k.length)){E(!1);return}E(!0),_(H=>H.map(V=>{var L,W,B;return{...V,value:(W=(L=k.find(U=>U.func===V.name))==null?void 0:L.value)!=null?W:V.value,disable:!k.some(U=>U.func===V.name),pattern:(B=D==null?void 0:D.pattern)!=null?B:null}}))},[]);return x.useEffect(()=>{if(!p)return;const D=f.state$.subscribe(A);return()=>D.unsubscribe()},[p,f,A]),{statistics:C,showList:P,show:w}},{showList:s,show:l}=r(i,t,o,n),c=a.debounce(()=>{const S=window.innerWidth<Qa;o!==S&&e(S)},100);x.useEffect(()=>(window.addEventListener("resize",c),()=>{window.removeEventListener("resize",c)}),[o]);const u=((S,f,v)=>n?x.useMemo(()=>S.length>f?S.reduce((_,w,E)=>(E%2===0&&_.push(S.slice(E,E+2)),_),[]).map((_,w)=>b.jsxs("div",{className:"univer-grid univer-h-full univer-items-center",children:[_[0]&&b.jsx(v,{..._[0]},_[0].name),_[1]&&b.jsx(v,{..._[1]},_[1].name)]},`stat-col-${w}`)):S.map(C=>b.jsx("div",{className:"univer-grid univer-h-full univer-items-center",children:b.jsx(v,{...C})},C.name)),[S,f,v]):null)(s,um,cm);return l&&b.jsx("div",{className:X.clsx('univer-relative univer-box-border univer-flex univer-h-full univer-items-center univer-overflow-hidden univer-px-2 after:univer-absolute after:univer-right-0 after:univer-top-1/2 after:univer-block after:univer-h-4 after:univer-w-px after:-univer-translate-y-1/2 after:univer-bg-gray-200 after:univer-content-[""]',{"univer-max-w-32":o,"univer-max-w-fit":!o}),children:b.jsx("div",{className:"univer-flex univer-h-full univer-gap-x-2",children:u})})},Ja=36;function $a(){var d;const n=I.useConfigValue(Te),o=I.useDependency(I.IMenuManagerService),e=(d=n==null?void 0:n.footer)!=null?d:!0;if(!St()||!e)return null;const i=o.getMenuByPositionKey(I.ContextMenuPosition.FOOTER_MENU),{sheetBar:r=!0,statisticBar:s=!0,menus:l=!0,zoomSlider:c=!0}=(n==null?void 0:n.footer)||{};return!r&&!s&&!l&&!c?null:b.jsxs("section",{className:"univer-box-border univer-grid univer-w-full univer-grid-flow-col univer-grid-cols-[1fr,auto,auto,auto] univer-items-center univer-justify-between univer-bg-white univer-px-5 univer-text-gray-900 dark:!univer-bg-gray-900 dark:!univer-text-gray-200",style:{height:Ja},"data-range-selector":!0,children:[r&&b.jsx(qa,{}),s&&b.jsx(hm,{}),l&&i.length>0&&b.jsx("div",{className:"univer-box-border univer-flex univer-gap-2 univer-px-2",children:i.map(u=>{var h;return(h=u.children)==null?void 0:h.map(g=>(g==null?void 0:g.item)&&b.jsx(I.ToolbarItem,{...g.item},g.key))})}),c&&b.jsx(am,{})]})}function el(){const n=I.useConfigValue(Te);return tl()&&(n==null?void 0:n.formulaBar)!==!1?b.jsx(Ga,{}):null}function Ar(){return tl()?b.jsxs(b.Fragment,{children:[b.jsx(Kh,{}),b.jsx(Gh,{})]}):null}function tl(){const n=I.useDependency(a.IUniverInstanceService),e=!!I.useObservable(()=>n.getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET),null,!1,[]);return x.useMemo(()=>n.getAllUnitsForType(a.UniverInstanceType.UNIVER_SHEET).length>0,[n,e])}var mm=Object.getOwnPropertyDescriptor,gm=(n,o,e,t)=>{for(var i=t>1?void 0:t?mm(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Mn=(n,o)=>(e,t)=>o(e,t,n);const nl=5,il=2;y.SheetCellEditorResizeService=class extends a.Disposable{constructor(o,e,t,i,r,s){super(),this._layoutService=o,this._cellEditorManagerService=e,this._editorBridgeService=t,this._renderManagerService=i,this._univerInstanceService=r,this._configService=s}get _currentRenderer(){return M.getCurrentTypeOfRenderer(a.UniverInstanceType.UNIVER_SHEET,this._univerInstanceService,this._renderManagerService)}get _editingUnitId(){var o,e;return(e=(o=this._editorBridgeService.getEditCellState())==null?void 0:o.unitId)!=null?e:""}get _editingRenderer(){return this._renderManagerService.getRenderById(this._editingUnitId)}get _renderer(){var e;const o=(e=this._univerInstanceService.getCurrentUnitOfType(a.UniverInstanceType.UNIVER_SHEET))==null?void 0:e.getUnitId();return this._editingUnitId===o?this._editingRenderer:this._currentRenderer}get _sheetSkeletonManagerService(){var o;return(o=this._renderer)==null?void 0:o.with(y.SheetSkeletonManagerService)}get engine(){var o;return(o=this._renderer)==null?void 0:o.engine}fitTextSize(o){var D,k,H,V;const e=this._editorBridgeService.getEditCellState();if(!e)return;const{position:t,documentLayoutObject:i,canvasOffset:r,scaleX:s,scaleY:l}=e,{startX:c,startY:d,endX:u,endY:h}=t,g=this._univerInstanceService.getUnit(a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY,a.UniverInstanceType.UNIVER_DOC);if(g==null)return;const S=this._getEditorSkeleton();if(!S)return;const f=this._predictingSize(t,r,S,i,s,l);if(!f||f.actualWidth<=0)return;let{actualWidth:v,actualHeight:p}=f;const{verticalAlign:C,horizontalAlign:_,paddingData:w,fill:E}=i;v=v+((D=w.l)!=null?D:0)+((k=w.r)!=null?k:0),p=p+((H=w.t)!=null?H:0)+((V=w.b)!=null?V:0);let O=u-c,T=h-d;O<v&&(O=Math.ceil(v)),T<p&&(T=Math.ceil(p));let P=0;C===a.VerticalAlign.MIDDLE?P=(T-p)/2/l:C===a.VerticalAlign.TOP?P=w.t||0:P=(T-p)/l;let A=0;_===a.HorizontalAlign.CENTER||(_===a.HorizontalAlign.RIGHT?A=(O-v)/s:A=w.l||0),P=P<(w.t||0)?w.t||0:P,A=A<(w.l||0)?w.l||0:A,g.updateDocumentDataMargin({t:P,l:A}),S.calculate(),this._editAreaProcessing(O,T,t,r,E,s,l,_,o)}_predictingSize(o,e,t,i,r=1,s=1){const{startX:l,endX:c}=o,{textRotation:d,wrapStrategy:u,paddingData:h}=i,g=this._univerInstanceService.getUnit(a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY,a.UniverInstanceType.UNIVER_DOC),{vertexAngle:S}=M.convertTextRotation(d);if(u===a.WrapStrategy.WRAP&&S===0){g==null||g.updateDocumentDataPageSize(c-l),g==null||g.updateDocumentDataMargin({l:h.l,t:h.t}),t.calculate();const{actualWidth:C,actualHeight:_}=t.getActualSize();return{actualWidth:C*r,actualHeight:_*s}}const f=this._getEditorMaxSize(o,e,i.horizontalAlign);if(!f)return;g==null||g.updateDocumentDataPageSize(f.width/r),t.calculate();const v=t.getActualSize();let p=c-l;return p<v.actualWidth*r+nl*r&&(p=v.actualWidth*r+nl*r),g==null||g.updateDocumentDataPageSize(p/r),g==null||g.updateDocumentRenderConfig({horizontalAlign:a.HorizontalAlign.UNSPECIFIED,cellValueType:void 0}),{actualWidth:v.actualWidth*r,actualHeight:v.actualHeight*s}}_getEditorMaxSize(o,e,t){var w,E,O,T;if(this._getEditorObject()==null)return;function r(P){return Number.parseInt(P.replace("px",""))}const s=this.engine;if(!s)return;const l=s.getCanvasElement(),c=l.getBoundingClientRect(),d=r(l.style.width),{width:u}=c,h=u/d,{startX:g,startY:S,endX:f}=o,v=s.width,p=((E=(w=this._configService.getConfig(I.UI_PLUGIN_CONFIG_KEY))==null?void 0:w.footer)==null||E)&&((T=(O=this._configService.getConfig(Te))==null?void 0:O.footer)==null||T)?Ja:0,C=document.body.clientHeight-S-p-e.top-il*2;let _=u-g;if(t===a.HorizontalAlign.CENTER){const P=v-f,A=g;_=f-g+Math.min(A,P)*2}else t===a.HorizontalAlign.RIGHT&&(_=f);return{height:C,width:_-il,scaleAdjust:h}}_editAreaProcessing(o,e,t,i,r,s=1,l=1,c,d){var W;const u=this._getEditorObject();if(u==null)return;const h=this.engine;if(!h)return;const g=h.getCanvasElement();let{startX:S,startY:f}=t;const{document:v,scene:p,engine:C}=u,_=p.getViewport(q.VIEWPORT_KEY.VIEW_MAIN),w=this._getEditorMaxSize(t,i,c),{height:E,width:O,scaleAdjust:T}=w;let P=e,A=_==null?void 0:_.getScrollBar();P>E?(A==null?_&&new M.ScrollBar(_,{enableHorizontal:!1,barSize:8}):_==null||_.resetCanvasSizeAndUpdateScroll(),_==null||_.scrollToViewportPos({viewportScrollY:P-E}),P=E):(A=null,(W=_==null?void 0:_.getScrollBar())==null||W.dispose()),o+=(A==null?void 0:A.barSize)||0,o>O&&(o=O),this._addBackground(p,o/s,e/l,r);const{scaleX:D,scaleY:k}=p.getPrecisionScale();p.transformByState({width:o*T/s,height:e*T/l,scaleX:s*T,scaleY:l*T}),v.resize(o*T/s,e*T/l),setTimeout(()=>{C.resizeBySize(M.fixLineWidthByScale(o,D),M.fixLineWidthByScale(P,k)),d==null||d()},0);const H=this._layoutService.getContentElement().getBoundingClientRect(),V=g.getBoundingClientRect();S=S*T+(V.left-H.left),f=f*T+(V.top-H.top);const L=t.endX-t.startX;c===a.HorizontalAlign.RIGHT?S+=(L-o)*T:c===a.HorizontalAlign.CENTER&&(S+=(L-o*T)/2),this._cellEditorManagerService.setState({startX:S,startY:f,endX:o*T+S,endY:P*T+f,show:!0})}_addBackground(o,e,t,i){const r="_backgroundRectHelperColor_",s=o.getObject(r);s==null&&i==null||(s==null?o.addObjects([new M.Rect(r,{width:e,height:t,fill:i,evented:!1})],q.DOCS_COMPONENT_MAIN_LAYER_INDEX):i==null?s.dispose():(s.setProps({fill:i}),s.transformByState({width:e,height:t})))}resizeCellEditor(o){var T,P;const e=this._cellEditorManagerService.getState();if(!e||!this._editorBridgeService.isVisible().visible)return;this._editorBridgeService.refreshEditCellPosition(!0);const t=this._editorBridgeService.getEditCellState();if(!t)return;const i=(P=(T=this._sheetSkeletonManagerService)==null?void 0:T.getSkeletonParam(t.sheetId))==null?void 0:P.skeleton;if(!i)return;const{row:r,column:s,scaleX:l,scaleY:c,position:d,canvasOffset:u,documentLayoutObject:h}=t,{horizontalAlign:g}=h,S=this._getEditorMaxSize(d,u,g);if(!S)return;const{height:f,width:v,scaleAdjust:p}=S,C=i.getCellWithCoordByIndex(r,s),_=Math.min((C.mergeInfo.endY-C.mergeInfo.startY)*c,f)*p,w=Math.min((C.mergeInfo.endX-C.mergeInfo.startX)*l,v)*p,E=e.endY-e.startY,O=e.endX-e.startX;if(E!==_||O!==w){if(this._editorBridgeService.refreshEditCellPosition(!0),!this._getEditorSkeleton())return;this.fitTextSize(o)}}_getEditorObject(){return xi(this._editorBridgeService.getCurrentEditorId(),this._renderManagerService)}_getEditorSkeleton(){var o;return(o=this._renderManagerService.getRenderById(a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY))==null?void 0:o.with(Ce.DocSkeletonManagerService).getSkeleton()}},y.SheetCellEditorResizeService=gm([Mn(0,I.ILayoutService),Mn(1,En),Mn(2,me),Mn(3,M.IRenderManagerService),Mn(4,a.IUniverInstanceService),Mn(5,a.IConfigService)],y.SheetCellEditorResizeService);var Sm=Object.getOwnPropertyDescriptor,fm=(n,o,e,t)=>{for(var i=t>1?void 0:t?Sm(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Yt=(n,o)=>(e,t)=>o(e,t,n);let Ti=class extends a.RxDisposable{constructor(o,e,t,i,r,s,l,c){super();R(this,"_d");this._context=o,this._instanceSrv=e,this._commandService=t,this._editorBridgeService=i,this._selectionManagerService=r,this._contextService=s,this._renderManagerService=l,this._sheetSkeletonManagerService=c,this.disposeWithMe(this._instanceSrv.getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET).subscribe(d=>{d&&d.getUnitId()===this._context.unitId?this._d=this._init():this._disposeCurrent()}))}_init(){const o=new a.DisposableCollection;return this._initSelectionChangeListener(o),this._initEventListener(o),this._commandExecutedListener(o),this._initialKeyboardListener(o),o}_disposeCurrent(){var o;(o=this._d)==null||o.dispose(),this._d=null}_initSelectionChangeListener(o){o.add(N.merge(this._selectionManagerService.selectionMoveEnd$,this._selectionManagerService.selectionSet$,this._selectionManagerService.selectionMoveStart$).subscribe(e=>this._updateEditorPosition(e)))}_updateEditorPosition(o){var t,i,r;if(this._editorBridgeService.isVisible().visible)return;const e=(t=o==null?void 0:o[o.length-1])==null?void 0:t.primary;if(e){const s=this._getSheetObject(),{scene:l,engine:c}=s,d=this._context.unitId,u=(i=this._context.unit.getActiveSheet())==null?void 0:i.getSheetId();if(!u)return;const h=(r=this._sheetSkeletonManagerService.getSkeletonParam(u))==null?void 0:r.skeleton.getCellWithCoordByIndex(e.actualRow,e.actualColumn),g=h?{actualRow:h.actualRow,actualColumn:h.actualColumn,isMerged:h.isMerged,startRow:h.mergeInfo.startRow,startColumn:h.mergeInfo.startColumn,endRow:h.mergeInfo.endRow,endColumn:h.mergeInfo.endColumn,isMergedMainCell:h.isMergedMainCell}:e;this._commandService.executeCommand(so.id,{scene:l,engine:c,primary:g,unitId:d,sheetId:u})}}refreshEditorPosition(){const o=this._selectionManagerService.getWorkbookSelections(this._context.unitId);if(o){const e=o.getCurrentSelections();e&&this._updateEditorPosition([...e])}}_initEventListener(o){const e=this._getSheetObject(),{spreadsheet:t,spreadsheetColumnHeader:i,spreadsheetLeftTopPlaceholder:r,spreadsheetRowHeader:s}=e;o.add(t.onDblclick$.subscribeEvent(l=>{l.button!==2&&this._commandService.executeCommand(Se.id,{visible:!0,eventType:M.DeviceInputEventType.Dblclick,unitId:this._context.unitId})})),o.add(t.onPointerDown$.subscribeEvent({next:this._tryHideEditor.bind(this),priority:-1})),o.add(i.onPointerDown$.subscribeEvent({next:this._tryHideEditor.bind(this),priority:-1})),o.add(r.onPointerDown$.subscribeEvent({next:this._tryHideEditor.bind(this),priority:-1})),o.add(s.onPointerDown$.subscribeEvent({next:this._tryHideEditor.bind(this),priority:-1}))}_initialKeyboardListener(o){let e=null;const t=r=>{const s=r.with(q.DocSelectionRenderService);s&&(e=a.toDisposable(s.onInputBefore$.subscribe(l=>{if(!this._isCurrentSheetFocused())return;const c=this._contextService.getContextValue(a.FOCUSING_FX_BAR_EDITOR),d=this._contextService.getContextValue(a.FOCUSING_SHEET),u=r.unitId;this._editorBridgeService.isVisible().visible||u&&d&&!c&&this._showEditorByKeyboard(l)})),o.add(e))},i=this._renderManagerService.getRenderById(a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY);i?t(i):this.disposeWithMe(this._renderManagerService.created$.pipe(N.filter(r=>r.unitId===a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY)).subscribe(r=>{e==null||e.dispose(),t(r)}))}_commandExecutedListener(o){const e=new Set([m.ClearSelectionFormatCommand.id,wn.id]);o.add(this._commandService.onCommandExecuted(t=>{if(e.has(t.id)){if(this._editorBridgeService.isVisible().visible)return;this._editorBridgeService.refreshEditCellState()}if(t.id===m.SetRangeValuesMutation.id){const i=t.params,{cellValue:r,unitId:s,subUnitId:l}=i;if(!r)return;const c=this._editorBridgeService.getEditLocation();if(c){const{unitId:d,sheetId:u,row:h,column:g}=c;s===d&&l===u&&r&&r[h]&&Object.prototype.hasOwnProperty.call(r[h],g)&&this._editorBridgeService.refreshEditCellState()}}})),o.add(this._commandService.beforeCommandExecuted((t,i)=>{i!=null&&i.fromCollab||t.id===m.SetWorksheetActiveOperation.id&&this._tryHideEditor()}))}_showEditorByKeyboard(o){const e=o==null?void 0:o.event;o==null||!e.data&&e.inputType!=="InsertParagraph"||this._commandService.syncExecuteCommand(Se.id,{visible:!0,eventType:M.DeviceInputEventType.Keyboard,keycode:e.which,unitId:this._context.unitId})}_tryHideEditor(){this._editorBridgeService.isForceKeepVisible()||this._hideEditor()}_hideEditor(){this._editorBridgeService.isVisible().visible===!0&&this._commandService.syncExecuteCommand(Se.id,{visible:!1,eventType:M.DeviceInputEventType.PointerDown,unitId:this._context.unitId})}_getSheetObject(){return He(this._context.unit,this._context)}_isCurrentSheetFocused(){var o;return((o=this._instanceSrv.getFocusedUnit())==null?void 0:o.getUnitId())===this._context.unitId}};Ti=fm([Yt(1,a.IUniverInstanceService),Yt(2,a.ICommandService),Yt(3,me),Yt(4,a.Inject(m.SheetsSelectionsService)),Yt(5,a.IContextService),Yt(6,M.IRenderManagerService),Yt(7,a.Inject(y.SheetSkeletonManagerService))],Ti);const ol=[I.KeyCode.ARROW_DOWN,I.KeyCode.ARROW_UP,I.KeyCode.ARROW_LEFT,I.KeyCode.ARROW_RIGHT],vm=[I.KeyCode.ENTER,I.KeyCode.TAB,...ol];function rl(){const n=[];for(const o of ol)n.push({id:Bt.id,binding:o,preconditions:e=>on(e),staticParameters:{visible:!1,eventType:M.DeviceInputEventType.Keyboard,keycode:o,isShift:!1}}),n.push({id:Bt.id,binding:o|I.MetaKeys.SHIFT,preconditions:e=>on(e),staticParameters:{visible:!1,eventType:M.DeviceInputEventType.Keyboard,keycode:o,isShift:!0}});return n}const sl={id:_i.id,binding:I.KeyCode.F2,description:"shortcut.sheet.start-editing",group:"4_sheet-edit",preconditions:ae,staticParameters:{visible:!0,eventType:M.DeviceInputEventType.Keyboard,keycode:I.KeyCode.F2}},al={id:Se.id,binding:I.KeyCode.ENTER,description:"shortcut.sheet.toggle-editing",group:"4_sheet-edit",preconditions:n=>on(n),staticParameters:{visible:!1,eventType:M.DeviceInputEventType.Keyboard,keycode:I.KeyCode.ENTER}},ll={id:Se.id,binding:I.KeyCode.TAB,preconditions:n=>on(n),staticParameters:{visible:!1,eventType:M.DeviceInputEventType.Keyboard,keycode:I.KeyCode.TAB}},cl={id:Se.id,binding:I.KeyCode.ESC,description:"shortcut.sheet.abort-editing",group:"4_sheet-edit",preconditions:n=>on(n),staticParameters:{visible:!1,eventType:M.DeviceInputEventType.Keyboard,keycode:I.KeyCode.ESC}},dl={id:Se.id,binding:I.KeyCode.ENTER|I.MetaKeys.CTRL_COMMAND,mac:I.KeyCode.ENTER|I.MetaKeys.MAC_CTRL,preconditions:n=>on(n),staticParameters:{visible:!1,eventType:M.DeviceInputEventType.Keyboard,keycode:I.KeyCode.ENTER|I.MetaKeys.CTRL_COMMAND}},ul={id:q.BreakLineCommand.id,description:"shortcut.sheet.break-line",group:"4_sheet-edit",preconditions:n=>Zd(n),binding:I.KeyCode.ENTER|I.MetaKeys.ALT},hl={id:q.DeleteLeftCommand.id,preconditions:n=>nr(n)||ji(n),binding:I.KeyCode.BACKSPACE},ml={id:q.DeleteRightCommand.id,preconditions:n=>nr(n)||ji(n),binding:I.KeyCode.DELETE},gl={id:q.DeleteLeftCommand.id,preconditions:n=>nr(n)||ji(n),binding:I.KeyCode.BACKSPACE|I.MetaKeys.SHIFT},Sl={id:Se.id,description:"shortcut.sheet.delete-and-start-editing",group:"4_sheet-edit",preconditions:n=>ae(n)&&!ji(n),binding:I.KeyCode.BACKSPACE,staticParameters:{visible:!0,eventType:M.DeviceInputEventType.Keyboard,keycode:I.KeyCode.BACKSPACE}};function pm(n){return n.startsWith("'")}function Cm(n){return n.slice(1)}const Im={"":"0","":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9",:"A",:"B",:"C",:"D",:"E",:"F",:"G",:"H",:"I",:"J",:"K",:"L",:"M",:"N",:"O",:"P",:"Q",:"R",:"S",:"T",:"U",:"V",:"W",:"X",:"Y",:"Z",:"a",:"b",:"c",:"d",:"e",:"f",:"g",:"h",:"i",:"j",:"k",:"l",:"m",:"n",:"o",:"p",:"q",:"r",:"s",:"t",:"u",:"v",:"w",:"x",:"y",:"z","":"%","":"-","":".","":":","":"/","":"+","":"@","":"&","":"*","":"#","":"=","":">","":"<","":"$","":'"',"":"'","":"(","":")","":" ","":",","":"!","":"?","":";","":"[","":"]","":"{","":"}"},Dr={true:"TRUE",false:"FALSE"};function _m(n){return[a.LocaleType.ZH_CN,a.LocaleType.ZH_TW].includes(n)}function bm(n,o,e,t){let i=n;if(_m(e)){if(n.startsWith("")||n.startsWith("'"))return`'${n.slice(1)}`;i=wm(i)}if(i.startsWith("="))return Em(n,i,o,t);const r=i.toLowerCase();return Dr[r]?Dr[r]:a.getNumfmtParseValueFilter(i)==null?n:i}function wm(n){const o=/['"].*?['"]/g,e=[],t=n.split(o);n.replace(o,r=>(e.push(r),""));let i=t.join("").split("").map(Rm).join("");return e.forEach((r,s)=>{i=i.slice(0,s*2)+r+i.slice((s+1)*2)}),i}function Em(n,o,e,t){const i=e.sequenceNodesBuilder(o);if(!i)return n;let r=o,s=0;return i.forEach((l,c)=>{if(typeof l=="object"){const d=l.token;if(Dr[d.toLowerCase()]){const u=l.startIndex+s+1,h=l.endIndex+s+2;r=Pn(d.toLocaleUpperCase(),r,u,h)}else if(l.nodeType===K.sequenceNodeType.FUNCTION&&Tm(d,t,i,c)||l.nodeType===K.sequenceNodeType.REFERENCE){const u=d.indexOf("!");if(u>-1){const h=d.substring(u+1),g=l.startIndex+s+(u+1)+1,S=l.endIndex+s+2;r=Pn(h.toLocaleUpperCase(),r,g,S)}else{const h=l.startIndex+s+1,g=l.endIndex+s+2;r=Pn(d.toLocaleUpperCase(),r,h,g)}}else if(d.startsWith('"')&&d.endsWith('"')||d.startsWith("'")&&d.endsWith("'")){const u=l.startIndex+s+2,h=l.endIndex+s+1;r=Pn(n.slice(u,h),r,u,h)}else if(l.nodeType!==K.sequenceNodeType.ARRAY){const u=a.getNumfmtParseValueFilter(d);if(u==null){const h=l.startIndex+s+1,g=l.endIndex+s+2;r=Pn(n.slice(h,g),r,h,g)}else if(typeof u.v=="number"&&(u.z===void 0||!a.numfmt.getFormatInfo(u.z).isDate)){const h=`${u.v}`,g=l.startIndex+s+1,S=l.endIndex+s+2,{processedString:f,offset:v}=Mm(d,h);r=Pn(f,r,g,S),s+=v}}}}),r}function Tm(n,o,e,t){const i=o.getDescriptions();return e[t+1]!==K.matchToken.OPEN_BRACKET?!1:i.get(ym(n).toLocaleUpperCase())!==void 0}function ym(n){const o=/^@+/;return n.replace(o,"")}function Rm(n){return Im[n]||n}function Pn(n,o,e,t){return o.substring(0,e)+n+o.substring(t)}function Mm(n,o){var s,l;const e=((s=n.match(/^\s*/))==null?void 0:s[0])||"",t=((l=n.match(/\s*$/))==null?void 0:l[0])||"",i=e+o+t,r=i.length-n.length;return{processedString:i,offset:r}}const fl="range_selector",vl=n=>n.includes(fl);var Pm=Object.getOwnPropertyDescriptor,Om=(n,o,e,t)=>{for(var i=t>1?void 0:t?Pm(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},ye=(n,o)=>(e,t)=>o(e,t,n);const pl=-1e3;y.EditingRenderController=class extends a.Disposable{constructor(e,t,i,r,s,l,c,d,u,h,g,S,f,v,p){super();R(this,"_cursorChange",0);R(this,"_editingUnit","");R(this,"_cursorTimeout");this._undoRedoService=e,this._contextService=t,this._renderManagerService=i,this._editorBridgeService=r,this._cellEditorManagerService=s,this._lexerTreeBuilder=l,this._functionService=c,this._textSelectionManagerService=d,this._commandService=u,this._localService=h,this._editorService=g,this._univerInstanceService=S,this._sheetInterceptorService=f,this._sheetCellEditorResizeService=v,this._selectionManagerService=p,this.disposeWithMe(this._init()),this._initEditorVisibilityListener()}dispose(){super.dispose()}get _workbookSelections(){return this._selectionManagerService.getWorkbookSelections(this._editingUnit)}_init(){const e=new a.DisposableCollection;return this._subscribeToCurrentCell(e),this._initialCursorSync(e),this._listenEditorFocus(e),this._commandExecutedListener(e),this._initSkeletonListener(e),e.add(()=>{clearTimeout(this._cursorTimeout)}),this._cursorTimeout=setTimeout(()=>{this._cursorStateListener(e)},1e3),e}_initEditorVisibilityListener(){this.disposeWithMe(this._univerInstanceService.getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET).subscribe(async e=>{var t;if(this._editingUnit&&(e==null?void 0:e.getUnitId())!==this._editingUnit&&!this._editorBridgeService.isForceKeepVisible()){this._commandService.syncExecuteCommand(Se.id,{visible:!1,eventType:M.DeviceInputEventType.Keyboard,keycode:I.KeyCode.ESC,unitId:this._editingUnit});const i=(t=this._renderManagerService.getRenderById(e.getUnitId()))==null?void 0:t.with(Ti);i&&i.refreshEditorPosition()}})),this.disposeWithMe(this._editorBridgeService.visible$.pipe(N.distinctUntilChanged((e,t)=>e.visible===t.visible)).subscribe(async e=>{e.visible?(this._editingUnit=e.unitId,this._handleEditorVisible(e)):this._editingUnit&&(await this._handleEditorInvisible(e),this._editingUnit="")}))}_listenEditorFocus(e){const t=this._getEditorObject();t&&e.add(t.document.onPointerDown$.subscribeEvent(()=>{var i;if(this._editingUnit&&this._editorBridgeService.isVisible()){const r=this._editorBridgeService.getEditCellState(),s=this._editorBridgeService.getCurrentEditorId();if(!r||!s)return;(i=this._sheetCellEditorResizeService)==null||i.fitTextSize()}}))}_initialCursorSync(e){e.add(this._cellEditorManagerService.focus$.pipe(N.filter(t=>!!t)).subscribe(()=>{var r;const t=this._univerInstanceService.getCurrentUnitForType(a.UniverInstanceType.UNIVER_DOC);if(!t)return;const i=(r=this._renderManagerService.getRenderById(t==null?void 0:t.getUnitId()))==null?void 0:r.with(q.DocSelectionRenderService);i&&i.sync()}))}_initSkeletonListener(e){const t=new Set(m.COMMAND_LISTENER_SKELETON_CHANGE);t.delete(m.SetWorksheetActiveOperation.id),e.add(this._commandService.onCommandExecuted(i=>{var r;if(t.has(i.id)){switch(i.id){case m.MoveRowsMutation.id:case m.MoveColsMutation.id:case m.RemoveColMutation.id:case m.RemoveRowMutation.id:case m.InsertColMutation.id:case m.InsertRowMutation.id:{const s=this._editorBridgeService.getEditLocation();if(!s)break;const l={startRow:s.row,startColumn:s.column,endRow:s.row,endColumn:s.column},c=m.adjustRangeOnMutation(l,i);if(!c)break;const d=c.startRow,u=c.startColumn;this._editorBridgeService.updateEditLocation(d,u);break}}(r=this._sheetCellEditorResizeService)==null||r.resizeCellEditor(()=>{this._textSelectionManagerService.refreshSelection({unitId:a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY,subUnitId:a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY})})}}))}_subscribeToCurrentCell(e){e.add(this._editorBridgeService.currentEditCellState$.subscribe(t=>{var _,w;if(t==null||this._editorBridgeService.isForceKeepVisible())return;const i=this._editorBridgeService.getEditCellState();if(i==null)return;const{position:r,documentLayoutObject:s,scaleX:l,editorUnitId:c}=i;if(this._contextService.getContextValue(a.FOCUSING_EDITOR_STANDALONE))return;const d=this._getDocumentDataModel();if(d==null)return;const{startX:u,endX:h}=r,{textRotation:g,wrapStrategy:S,documentModel:f}=s,{vertexAngle:v}=M.convertTextRotation(g);S===a.WrapStrategy.WRAP&&v===0&&d.updateDocumentDataPageSize((h-u)/l),this._commandService.syncExecuteCommand(q.ReplaceSnapshotCommand.id,{unitId:c,snapshot:f.getSnapshot()}),this._contextService.setContextValue(a.FOCUSING_EDITOR_BUT_HIDDEN,!0),this._textSelectionManagerService.replaceDocRanges([{startOffset:0,endOffset:0}],{unitId:a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY,subUnitId:a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY});const p=(_=this._renderManagerService.getRenderById(a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY))==null?void 0:_.with(q.DocSelectionRenderService),C=(w=this._renderManagerService.getRenderById(a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY))==null?void 0:w.with(q.DocSelectionRenderService);(p!=null&&p.canFocusing||C!=null&&C.canFocusing)&&(this._univerInstanceService.setCurrentUnitForType(a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY),p==null||p.activate(pl,pl,!0))}))}_commandExecutedListener(e){e.add(this._commandService.onCommandExecuted(i=>{var r;if(i.id===Ce.RichTextEditingMutation.id){const s=i.params,{unitId:l}=s;if(vl(l)||(this._editorBridgeService.changeEditorDirty(!0),!this._editorBridgeService.isVisible().visible))return;l===a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY&&((r=this._sheetCellEditorResizeService)==null||r.fitTextSize())}}));const t=[Bt.id];e.add(this._commandService.onCommandExecuted(i=>{if(t.includes(i.id)){const r=i.params,{keycode:s,isShift:l}=r;if(s!=null&&(this._cursorChange===2||this._contextService.getContextValue(a.FOCUSING_FX_BAR_EDITOR))){this._moveInEditor(s,l);return}this._commandService.syncExecuteCommand(Se.id,r)}i.id===_i.id&&(this._cursorChange=2)}))}_handleEditorVisible(e){var f,v,p,C;const{eventType:t,keycode:i}=e;this._cursorChange=t===M.DeviceInputEventType.PointerDown||t===M.DeviceInputEventType.Dblclick?2:1;const r=this._editorBridgeService.getEditLocation();if(r==null)return;this._commandService.syncExecuteCommand(ao.id,{range:{startRow:r.row,startColumn:r.column,endRow:r.row,endColumn:r.column}}),this._editorBridgeService.refreshEditCellPosition(!1);const{unitId:s,isInArrayFormulaRange:l=!1}=r,c=this._getEditorObject();if(c==null)return;const{document:d,scene:u}=c;this._contextService.setContextValue(a.EDITOR_ACTIVATED,!0);const h=this._getDocumentDataModel(),g=this._getEditorSkeleton(a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY);if(!g||!h)return;(f=this._sheetCellEditorResizeService)==null||f.fitTextSize(()=>{const _=u.getViewport(q.VIEWPORT_KEY.VIEW_MAIN);_==null||_.scrollToViewportPos({viewportScrollX:Number.POSITIVE_INFINITY,viewportScrollY:Number.POSITIVE_INFINITY})});const S=()=>{this._emptyDocumentDataModel(h.getSnapshot().documentStyle,!!l),d.makeDirty(),(i===I.KeyCode.BACKSPACE||t===M.DeviceInputEventType.Dblclick)&&(g.calculate(),this._editorBridgeService.changeEditorDirty(!0)),this._textSelectionManagerService.replaceDocRanges([{startOffset:0,endOffset:0}],{unitId:a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY,subUnitId:a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY})};if(this._isCellImageData(h.getSnapshot()))S();else if(t===M.DeviceInputEventType.Keyboard&&i===I.KeyCode.F2){d.makeDirty(),this._textSelectionManagerService.replaceDocRanges([{startOffset:0,endOffset:0}]);const _=((p=(v=h.getBody())==null?void 0:v.dataStream.length)!=null?p:2)-2;this._textSelectionManagerService.replaceDocRanges([{startOffset:_,endOffset:_}],{unitId:a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY,subUnitId:a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY})}else if(t===M.DeviceInputEventType.Keyboard||t===M.DeviceInputEventType.Dblclick&&l)S();else if(t===M.DeviceInputEventType.Dblclick){if(this._contextService.getContextValue(a.FOCUSING_EDITOR_INPUT_FORMULA))return;const _=h.getBody().dataStream.length-2||0;this._textSelectionManagerService.replaceDocRanges([{startOffset:_,endOffset:_}])}(C=this._renderManagerService.getRenderById(s))==null||C.scene.resetCursor()}_refreshCurrentSelections(e){const t=this._workbookSelections.getSelectionsOfWorksheet(e);t&&(this._contextService.setContextValue(m.REF_SELECTIONS_ENABLED,!1),this._commandService.syncExecuteCommand(m.SetSelectionsOperation.id,{unitId:this._editingUnit,subUnitId:e,selections:t}))}async _handleEditorInvisible(e){var p,C;const t=this._editorBridgeService.getEditCellState(),i=this._univerInstanceService.getUnit(a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY),r=a.Tools.deepClone(i==null?void 0:i.getSnapshot()),{keycode:s}=e;this._cursorChange=0;const l=(p=t==null?void 0:t.unitId)!=null?p:"";if(this._exitInput(e),t==null)return;const c=this._univerInstanceService.getUnit(l,a.UniverInstanceType.UNIVER_SHEET);if(!c)return;const d=c.getActiveSheet(),u=c.getUnitId(),h=d.getSheetId(),{unitId:g,sheetId:S}=t;if(u===g&&S!==h&&await this._commandService.executeCommand(m.SetWorksheetActivateCommand.id,{subUnitId:S,unitId:g}),s===I.KeyCode.ESC){this._editorBridgeService.isForceKeepVisible()&&this._editorBridgeService.disableForceKeepVisible(),this._refreshCurrentSelections(S);return}const f=((C=r==null?void 0:r.body)==null?void 0:C.dataStream.length)===2,v=t.documentLayoutObject.documentModel?this._isCellImageData(t.documentLayoutObject.documentModel.getSnapshot()):!1;r&&!(f&&v)&&await this._submitEdit(r,s===(I.MetaKeys.CTRL_COMMAND|I.KeyCode.ENTER)||s===(I.MetaKeys.MAC_CTRL|I.KeyCode.ENTER))===!1||s!==void 0&&this._moveSelection(s,l,h)}_getEditorObject(){return xi(this._editorBridgeService.getCurrentEditorId(),this._renderManagerService)}_isCellImageData(e){var i,r;return((r=(i=e.drawingsOrder)==null?void 0:i.length)!=null?r:0)>0}submitCellData(e){return this._submitEdit(e.getSnapshot())}async _submitEdit(e,t=!1){var C;const i=this._editorBridgeService.getEditCellState();if(i==null)return!0;const{unitId:r,sheetId:s,row:l,column:c}=i,d=this._univerInstanceService.getUnit(r,a.UniverInstanceType.UNIVER_SHEET);if(!d)return!0;let u=d.getActiveSheet();if(!d.getSheetBySheetId(s))return!0;u=d.getActiveSheet();const g=Am({...u.getCellRaw(l,c)||{}},e,this._lexerTreeBuilder,this._localService,this._functionService,d.getStyles());if(!g)return!0;this._removeComposedCellStyleInCellData(g,u.getComposedCellStyle(l,c));const S=this._sheetInterceptorService.onWriteCell(d,u,l,c,g);if(a.Tools.diffValue(Il(S),Il(u.getCellRaw(l,c))))return!0;const f=t?(C=this._workbookSelections.getCurrentLastSelection())==null?void 0:C.range:{startRow:l,startColumn:c,endRow:l,endColumn:c},v=a.generateRandomId(6);return this._commandService.syncExecuteCommand(m.SetRangeValuesCommand.id,{subUnitId:s,unitId:r,range:f,value:S,redoUndoId:v})&&await this._sheetInterceptorService.onValidateCell(d,u,l,c)===!1?(this._undoRedoService.rollback(v,r),!1):!0}_removeComposedCellStyleInCellData(e,t){if(!e.s||typeof e.s=="string")return;const i=Object.keys(e.s);for(const r of i)t[r]!==void 0&&a.Tools.diffValue(e.s[r],t[r])&&delete e.s[r]}_exitInput(e){var r,s;this._contextService.setContextValue(a.FOCUSING_EDITOR_INPUT_FORMULA,!1),this._contextService.setContextValue(a.EDITOR_ACTIVATED,!1),this._contextService.setContextValue(a.FOCUSING_EDITOR_BUT_HIDDEN,!1),this._contextService.setContextValue(a.FOCUSING_FX_BAR_EDITOR,!1),this._cellEditorManagerService.setState({show:e.visible});const t=this._getEditorObject();(r=t==null?void 0:t.scene.getViewport(q.VIEWPORT_KEY.VIEW_MAIN))==null||r.scrollToViewportPos({viewportScrollX:0,viewportScrollY:0});const i=this._editorBridgeService.getCurrentEditorId();i==null||!this._editorService.isSheetEditor(i)||(i===a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY&&((s=this._getEditorSkeleton(a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY))==null||s.resetInitialWidth()),this._undoRedoService.clearUndoRedo(i),this._undoRedoService.clearUndoRedo(a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY))}_moveSelection(e,t,i){if(e==null||!vm.includes(e)){this._refreshCurrentSelections(i);return}let r=a.Direction.LEFT;switch(e){case I.KeyCode.ENTER:r=a.Direction.DOWN;break;case I.KeyCode.TAB:r=a.Direction.RIGHT;break;case I.KeyCode.ARROW_DOWN:r=a.Direction.DOWN;break;case I.KeyCode.ARROW_UP:r=a.Direction.UP;break;case I.KeyCode.ARROW_LEFT:r=a.Direction.LEFT;break;case I.KeyCode.ARROW_RIGHT:r=a.Direction.RIGHT;break}const s=this._univerInstanceService.getCurrentUnitOfType(a.UniverInstanceType.UNIVER_SHEET);t&&(s==null?void 0:s.getUnitId())!==t&&this._univerInstanceService.setCurrentUnitForType(t),e===I.KeyCode.ENTER||e===I.KeyCode.TAB?this._commandService.executeCommand(Xe.id,{keycode:e,direction:r}):this._commandService.executeCommand(Pe.id,{direction:r})}_cursorStateListener(e){const t=this._getEditorObject();if(!(t!=null&&t.document))return;const{document:i}=t;e.add(a.toDisposable(i.onPointerDown$.subscribeEvent(()=>{this._cursorChange===1&&(this._cursorChange=2)})))}_moveInEditor(e,t){let i=a.Direction.LEFT;e===I.KeyCode.ARROW_DOWN?i=a.Direction.DOWN:e===I.KeyCode.ARROW_UP?i=a.Direction.UP:e===I.KeyCode.ARROW_RIGHT&&(i=a.Direction.RIGHT),t?this._commandService.executeCommand(q.MoveSelectionOperation.id,{direction:i}):this._commandService.executeCommand(q.MoveCursorOperation.id,{direction:i})}_getDocumentDataModel(){return this._univerInstanceService.getUnit(a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY,a.UniverInstanceType.UNIVER_DOC)}_getEditorSkeleton(e){var t;return(t=this._renderManagerService.getRenderById(e))==null?void 0:t.with(Ce.DocSkeletonManagerService).getSkeleton()}_getEditorViewModel(e){var t;return(t=this._renderManagerService.getRenderById(e))==null?void 0:t.with(Ce.DocSkeletonManagerService).getViewModel()}_getEditingUnit(){return this._editingUnit?this._univerInstanceService.getUnit(this._editingUnit,a.UniverInstanceType.UNIVER_SHEET):null}_emptyDocumentDataModel(e,t){const i=(l,c)=>{const d=a.Tools.deepClone(l.getSnapshot()),u=this._getEditorViewModel(l.getUnitId());u!=null&&(Dm(d.body,t),c&&(d.documentStyle=e),d.drawings={},d.drawingsOrder=[],l.reset(d),u.reset(l))},r=this._getDocumentDataModel();r&&i(r,!0);const s=this._univerInstanceService.getUnit(a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY,a.UniverInstanceType.UNIVER_DOC);s&&i(s)}},y.EditingRenderController=Om([ye(0,a.IUndoRedoService),ye(1,a.IContextService),ye(2,M.IRenderManagerService),ye(3,me),ye(4,En),ye(5,a.Inject(K.LexerTreeBuilder)),ye(6,K.IFunctionService),ye(7,a.Inject(Ce.DocSelectionManagerService)),ye(8,a.ICommandService),ye(9,a.Inject(a.LocaleService)),ye(10,q.IEditorService),ye(11,a.IUniverInstanceService),ye(12,a.Inject(m.SheetInterceptorService)),ye(13,a.Inject(y.SheetCellEditorResizeService)),ye(14,a.Inject(m.SheetsSelectionsService))],y.EditingRenderController);function Am(n,o,e,t,i,r){var h,g,S;if((o==null?void 0:o.body)==null)return null;const{body:s}=o;n.t=void 0;const l=s.dataStream;let d=l.substring(l.length-2,l.length)===a.DEFAULT_EMPTY_DOCUMENT_VALUE?l.substring(0,l.length-2):l;const u=t.getCurrentLocale();if(d=bm(d,e,u,i),(h=o.drawingsOrder)!=null&&h.length)n.v="",n.f=null,n.si=null,n.p=o,n.t=a.CellValueType.STRING;else if(n.s&&a.isTextFormat((S=(g=r==null?void 0:r.get(n.s))==null?void 0:g.n)==null?void 0:S.pattern)){n.v=d,n.f=null,n.si=null,n.p=null,n.t=a.CellValueType.STRING,Nr(s)&&s.dataStream!==`\r
`&&(n.p=o);const f=Cl(o);f&&(n.s=f)}else if(a.isFormulaString(d)){if(n.f===d)return null;const f=e.checkIfAddBracket(d);for(let v=0;v<f;v++)d+=K.matchToken.CLOSE_BRACKET;n.f=d,n.si=null,n.v=null,n.p=null}else if(pm(d)){const f=Cm(d);n.v=f,n.f=null,n.si=null,n.p=null,n.t=a.CellValueType.FORCE_STRING}else if(Nr(s))s.dataStream===`\r
`?(n.v="",n.f=null,n.si=null,n.p=null):(n.p=o,n.v=null,n.f=null,n.si=null);else{if(d===""&&n.v==null&&n.p==null)return null;n.v=d,n.f=null,n.si=null,n.p=null;const f=Cl(o);f&&(n.s=f)}return n}function Nr(n){const{textRuns:o=[],paragraphs:e=[],customRanges:t,customBlocks:i=[]}=n,r=n.dataStream.replace(/(\r\n)+$/,""),s=["va"];return o.filter(l=>l.st<r.length).some(l=>{var d;return!!(l.ts&&Object.keys(l.ts).some(u=>s.includes(u)))||Object.keys((d=l.ts)!=null?d:{}).length&&l.ed-l.st<r.length})||e.some(l=>l.bullet)||e.length>=2||!!(t!=null&&t.length)||i.length>0}function Cl(n){const{body:o}=n;if(!o)return null;const{textRuns:e=[]}=o;let t={};const i=o.dataStream.replace(`\r
`,"");return e.forEach(r=>{const{st:s,ed:l,ts:c}=r;l-s>=i.length&&(t={...t,...c})}),Object.keys(t).length?t:null}function Dm(n,o=!1){n.dataStream=a.DEFAULT_EMPTY_DOCUMENT_VALUE,n.textRuns!=null&&(n.textRuns.length===1&&!o?(n.textRuns[0].st=0,n.textRuns[0].ed=1):n.textRuns=void 0),n.paragraphs!=null&&(n.paragraphs=[{startIndex:0}]),n.sectionBreaks!=null&&(n.sectionBreaks=void 0),n.tables!=null&&(n.tables=void 0),n.customRanges!=null&&(n.customRanges=void 0),n.customBlocks!=null&&(n.customBlocks=void 0)}function Il(n){return n&&Object.fromEntries(Object.entries(n).filter(([o,e])=>!(e==null||Array.isArray(e)&&e.length===0||typeof e=="object"&&Object.keys(e).length===0)))}var Nm=Object.getOwnPropertyDescriptor,km=(n,o,e,t)=>{for(var i=t>1?void 0:t?Nm(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},tt=(n,o)=>(e,t)=>o(e,t,n);y.FormulaEditorController=class extends a.RxDisposable{constructor(e,t,i,r,s,l,c,d,u){super();R(this,"_loadedMap",new WeakSet);R(this,"_scheduledCallback",-1);this._univerInstanceService=e,this._renderManagerService=t,this._editorBridgeService=i,this._commandService=r,this._contextService=s,this._formulaEditorManagerService=l,this._undoRedoService=c,this._textSelectionManagerService=d,this._editorService=u,this._initialize()}_initialize(){this._syncEditorSize(),this._listenFxBtnClick(),this._handleContentChange(),this._univerInstanceService.focused$.pipe(N.takeUntil(this.dispose$)).subscribe(e=>{this._create(e)}),this._create(a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY),this.disposeWithMe(this._editorService.focus$.subscribe(()=>{var t;((t=this._editorService.getFocusEditor())==null?void 0:t.getEditorId())!==a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY?this._contextService.setContextValue(a.FOCUSING_FX_BAR_EDITOR,!1):this._contextService.setContextValue(a.FOCUSING_FX_BAR_EDITOR,!0)}))}_handleContentChange(){this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(e.id===Ce.RichTextEditingMutation.id){const t=e.params,{unitId:i}=t;i===a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY&&this.autoScroll()}}))}_create(e){if(e!==a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY)return;const t=this._renderManagerService.getRenderById(e);if(t==null)return;const{mainComponent:i}=t;i!=null&&(this._loadedMap.has(i)||this._loadedMap.add(i))}_listenFxBtnClick(){this._formulaEditorManagerService.fxBtnClick$.pipe(N.takeUntil(this.dispose$)).subscribe(()=>{var t;if(this._contextService.getContextValue(a.FOCUSING_EDITOR_BUT_HIDDEN)&&!this._contextService.getContextValue(a.EDITOR_ACTIVATED)){this._univerInstanceService.setCurrentUnitForType(a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY);const i=this._univerInstanceService.getUniverDocInstance(a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY);this._editorBridgeService.isVisible().visible===!1&&this._commandService.syncExecuteCommand(Se.id,{visible:!0,eventType:M.DeviceInputEventType.PointerDown,unitId:a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY});const s=(t=i==null?void 0:i.getBody())==null?void 0:t.dataStream;if(s==null)return;let l=s.startsWith("=")?s:`=${s}`;l=l.replace(/\r\n$/,"");const c=[{startOffset:l.length,endOffset:l.length}],d={unitId:a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY,body:{dataStream:l},segmentId:"",textRanges:c};this._commandService.syncExecuteCommand(q.CoverContentCommand.id,d),requestAnimationFrame(()=>{this._textSelectionManagerService.replaceDocRanges([],{unitId:a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY,subUnitId:a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY}),this._textSelectionManagerService.replaceDocRanges(c,{unitId:a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY,subUnitId:a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY}),this._contextService.setContextValue(a.FOCUSING_FX_BAR_EDITOR,!0)})}})}_syncEditorSize(){const e=this._univerInstanceService.unitAdded$.pipe(N.filter(t=>t.getUnitId()===a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY));this.disposeWithMe(N.combineLatest([this._formulaEditorManagerService.position$,e]).subscribe(([t])=>{if(!t)return this._clearScheduledCallback();const i=xi(a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY,this._renderManagerService),r=this._univerInstanceService.getUniverDocInstance(a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY);if(i==null||r==null)return this._clearScheduledCallback();const{width:s,height:l}=t;if(s===0||l===0)return this._clearScheduledCallback();const{engine:c}=i;r.updateDocumentDataPageSize(s),this.autoScroll(),this._scheduledCallback=requestIdleCallback(()=>c.resizeBySize(s,l))}))}_clearScheduledCallback(){this._scheduledCallback!==-1&&cancelIdleCallback(this._scheduledCallback),this._scheduledCallback=-1}autoScroll(){var v,p;const e=this._formulaEditorManagerService.getPosition(),t=(v=this._renderManagerService.getRenderById(a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY))==null?void 0:v.with(Ce.DocSkeletonManagerService).getSkeleton(),i=this._renderManagerService.getRenderById(a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY),r=this._univerInstanceService.getUniverDocInstance(a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY);if(t==null||e==null||i==null||r==null)return;const{marginTop:s=0,marginBottom:l=0}=r.getSnapshot().documentStyle,{scene:c,mainComponent:d}=i;let{actualHeight:u}=t.getActualSize();u+=s+l;const{width:h,height:g}=e,S=c.getViewport(q.VIEWPORT_KEY.VIEW_MAIN);let f=S==null?void 0:S.getScrollBar();c.transformByState({width:h,height:u}),d==null||d.resize(h,u),u>g?f==null?S&&new M.ScrollBar(S,{enableHorizontal:!1,barSize:8}):S==null||S.resetCanvasSizeAndUpdateScroll():(f=null,S==null||S.scrollToViewportPos({viewportScrollX:0,viewportScrollY:0}),(p=S==null?void 0:S.getScrollBar())==null||p.dispose())}},y.FormulaEditorController=km([tt(0,a.IUniverInstanceService),tt(1,M.IRenderManagerService),tt(2,me),tt(3,a.ICommandService),tt(4,a.IContextService),tt(5,yn),tt(6,a.IUndoRedoService),tt(7,a.Inject(Ce.DocSelectionManagerService)),tt(8,q.IEditorService)],y.FormulaEditorController);const _l="embedding_formula_editor",Hm=n=>n.includes(_l),kr=(n,o)=>{var h,g,S,f,v;const t=o.findNodePositionByCharIndex(n.startOffset,!0,n.segmentId,-1),i=o.getSkeletonData();let r=n.endOffset;if(n.segmentId){const p=(v=Array.from((g=(h=i==null?void 0:i.skeFooters.get(n.segmentId))==null?void 0:h.values())!=null?g:[])[0])!=null?v:Array.from((f=(S=i==null?void 0:i.skeHeaders.get(n.segmentId))==null?void 0:S.values())!=null?f:[])[0];p&&(r=Math.min(p.ed,r))}const s=o.findNodePositionByCharIndex(r,!0,n.segmentId,-1);if(!s||!t)return;const l={docsLeft:0,docsTop:0,pageMarginLeft:0,pageMarginTop:0},c=new q.NodePositionConvertToCursor(l,o),{borderBoxPointGroup:d}=c.getRangePointData(t,s);return q.getLineBounding(d).map(p=>({top:p.top,bottom:p.bottom,left:p.left,right:p.right}))},Vm=(n,o,e=-1)=>{const t=o.findPositionByGlyph(n,e);if(!t)return;const i={...t,isBack:!0},r={docsLeft:0,docsTop:0,pageMarginLeft:0,pageMarginTop:0},s=new q.NodePositionConvertToCursor(r,o),{borderBoxPointGroup:l}=s.getRangePointData(i,i),d=q.getLineBounding(l)[0];return{top:d.top,bottom:d.bottom,left:d.left,right:d.right}},Wm=(n,o,e=0,t=0)=>{const i=kr({startOffset:o.startIndex,endOffset:o.endIndex+1},n);if(i)return{rects:i.map(r=>({top:r.top+t,bottom:r.bottom+t,left:r.left+e,right:r.right+e})),range:o}},Lm=(n,o,e=0,t=0)=>{var h,g,S;const i=n.findNodeByCharIndex(o.startIndex),r=i==null?void 0:i.parent,s=r==null?void 0:r.parent,l=s==null?void 0:s.parent,c=l==null?void 0:l.lines.find(f=>f.paragraphStart&&f.paragraphIndex===o.startIndex),d=(S=(g=(h=c==null?void 0:c.divides)==null?void 0:h[0])==null?void 0:g.glyphGroup)==null?void 0:S[0];if(!d||!d)return;const u=Vm(d,n);if(u)return{rect:{top:u.top+t,bottom:u.bottom+t,left:u.left+e,right:u.right+e},segmentId:void 0,segmentPageIndex:-1,paragraph:o}},bl=(n,o=0,e=0)=>{var l,c,d,u,h,g,S;const t=n.getViewModel().getDataModel(),i=(d=(c=(l=t.getBody())==null?void 0:l.customRanges)==null?void 0:c.filter(f=>f.rangeType===a.CustomRangeType.HYPERLINK))!=null?d:[],r=(g=(h=(u=t.getBody())==null?void 0:u.paragraphs)==null?void 0:h.filter(f=>{var v;return((v=f.bullet)==null?void 0:v.listType.indexOf(a.PresetListType.CHECK_LIST))===0}))!=null?g:[],s=(S=n.getSkeletonData())==null?void 0:S.pages[0].skeDrawings;return{links:i.map(f=>Wm(n,f,o,e)).filter(Boolean),checkLists:r.map(f=>Lm(n,f,o,e)).filter(Boolean),drawings:s?Array.from(s.keys()).map(f=>({drawingId:f,rect:{top:s.get(f).aTop,bottom:s.get(f).aTop+s.get(f).width,left:s.get(f).aLeft,right:s.get(f).aLeft+s.get(f).height},drawing:s.get(f)})):[]}};function wl(n,o,e){var d,u,h,g,S,f;const t=(h=(u=(d=o.documentSkeleton)==null?void 0:d.getSkeletonData())==null?void 0:u.pages[0].height)!=null?h:0,i=(f=(S=(g=o.documentSkeleton)==null?void 0:g.getSkeletonData())==null?void 0:S.pages[0].width)!=null?f:0,r=o.verticalAlign,s=o.horizontalAlign;let l=0;switch(r){case a.VerticalAlign.UNSPECIFIED:case a.VerticalAlign.BOTTOM:l=n.mergeInfo.endY-n.mergeInfo.startY-t;break;case a.VerticalAlign.MIDDLE:l=(n.mergeInfo.endY-n.mergeInfo.startY-t)/2;break}let c=0;switch(s){case a.HorizontalAlign.RIGHT:c=n.mergeInfo.endX-n.mergeInfo.startX-i;break;case a.HorizontalAlign.CENTER:c=(n.mergeInfo.endX-n.mergeInfo.startX-i)/2;break;case a.HorizontalAlign.UNSPECIFIED:{e&&(c=n.mergeInfo.endX-n.mergeInfo.startX-i);break}}return{paddingLeft:c,paddingTop:l}}const xm=(n,o,e,t,i,r)=>{var H,V,L;const s=n.get(a.IUniverInstanceService),l=n.get(M.IRenderManagerService),c=s.getUnit(o,a.UniverInstanceType.UNIVER_SHEET);if(!c)return null;const d=c.getSheetBySheetId(e);if(!d)return null;const u=l.getRenderById(c.getUnitId()),h=u==null?void 0:u.with(y.SheetSkeletonManagerService).getSkeletonParam(d.getSheetId()),g=h==null?void 0:h.skeleton;if(!g||!u)return;const S=g.getFont(t,i),f=S==null?void 0:S.documentSkeleton;if(!f)return null;const v=(V=(H=f.getViewModel().getBody())==null?void 0:H.customRanges)==null?void 0:V.find(W=>W.rangeId===r);if(!v)return null;const p=q.DOC_VERTICAL_PADDING,C=g.getCellWithCoordByIndex(t,i);let{actualColumn:_,actualRow:w}=C;g.overflowCache.forValue((W,B,U)=>{U.startRow<=w&&U.endRow>=w&&U.startColumn<=_&&U.endColumn>=_&&(_=B,w=W)});const E=g.getCellWithCoordByIndex(w,_),O=d.getCell(E.actualRow,E.actualColumn),{topOffset:T=0,leftOffset:P=0}=(L=O==null?void 0:O.fontRenderExtension)!=null?L:{},{paddingLeft:A,paddingTop:D}=wl(E,S,!1),k=kr({startOffset:v.startIndex,endOffset:v.endIndex},f);return{rects:k==null?void 0:k.map(W=>({top:W.top+E.mergeInfo.startY+D+T+p,bottom:W.bottom+E.mergeInfo.startY+D+T+p,left:W.left+E.mergeInfo.startX+A+P,right:W.right+E.mergeInfo.startX+A+P})),customRange:v,label:f.getViewModel().getBody().dataStream.slice(v.startIndex,v.endIndex+1)}},Um=(n,o,e,t,i,r)=>{var P,A,D;const s=n.get(me),l=s.getEditCellState();if(!l||!s.isVisible().visible)return null;const{editorUnitId:d,unitId:u,sheetId:h,row:g,column:S}=l;if(o!==u||e!==h||g!==t||S!==i)return null;const f=n.get(M.IRenderManagerService),v=f.getRenderById(d),p=f.getRenderById(o);if(!v||!p)return null;const C=v.with(Ce.DocSkeletonManagerService).getSkeleton(),_=(P=p.with(y.SheetSkeletonManagerService).getSkeletonParam(h))==null?void 0:P.skeleton;if(!C||!_)return null;const w=(D=(A=C.getViewModel().getBody())==null?void 0:A.customRanges)==null?void 0:D.find(k=>k.rangeId===r);if(!w)return null;const E=4,O=kr({startOffset:w.startIndex,endOffset:w.endIndex},C),T=v.engine.getCanvasElement().getBoundingClientRect();return{rects:O==null?void 0:O.map(k=>({top:k.top+T.top-E,bottom:k.bottom+T.top+E,left:k.left+T.left,right:k.right+T.left})),customRange:w,label:C.getViewModel().getBody().dataStream.slice(w.startIndex,w.endIndex+1)}};var Bm=Object.getOwnPropertyDescriptor,Fm=(n,o,e,t)=>{for(var i=t>1?void 0:t?Bm(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},El=(n,o)=>(e,t)=>o(e,t,n);function jt(n){const{workbook:o,worksheet:e,...t}=n;return t}y.HoverManagerService=class extends a.Disposable{constructor(e,t){super();R(this,"_currentCell$",new N.BehaviorSubject(null));R(this,"_currentRichText$",new N.BehaviorSubject(null));R(this,"_currentClickedCell$",new N.Subject);R(this,"_currentDbClickedCell$",new N.Subject);R(this,"_currentCellWithEvent$",new N.Subject);R(this,"_currentPointerDownCell$",new N.Subject);R(this,"_currentPointerUpCell$",new N.Subject);R(this,"_currentHoveredRowHeader$",new N.BehaviorSubject(null));R(this,"_currentHoveredColHeader$",new N.BehaviorSubject(null));R(this,"_currentRowHeaderClick$",new N.Subject);R(this,"_currentColHeaderClick$",new N.Subject);R(this,"_currentRowHeaderDbClick$",new N.Subject);R(this,"_currentColHeaderDbClick$",new N.Subject);R(this,"_currentRowHeaderPointerDown$",new N.Subject);R(this,"_currentColHeaderPointerDown$",new N.Subject);R(this,"_currentRowHeaderPointerUp$",new N.Subject);R(this,"_currentColHeaderPointerUp$",new N.Subject);R(this,"currentCell$",this._currentCell$.asObservable().pipe(N.distinctUntilChanged((e,t)=>{var i,r,s,l,c,d,u,h;return((i=e==null?void 0:e.location)==null?void 0:i.unitId)===((r=t==null?void 0:t.location)==null?void 0:r.unitId)&&((s=e==null?void 0:e.location)==null?void 0:s.subUnitId)===((l=t==null?void 0:t.location)==null?void 0:l.subUnitId)&&((c=e==null?void 0:e.location)==null?void 0:c.row)===((d=t==null?void 0:t.location)==null?void 0:d.row)&&((u=e==null?void 0:e.location)==null?void 0:u.col)===((h=t==null?void 0:t.location)==null?void 0:h.col)})));R(this,"currentRichTextNoDistinct$",this._currentRichText$.pipe(N.map(e=>e&&{unitId:e.location.unitId,subUnitId:e.location.subUnitId,row:e.location.row,col:e.location.col,customRange:e.customRange,bullet:e.bullet,rect:e.rect,drawing:e.drawing})));R(this,"currentRichText$",this._currentRichText$.pipe(N.distinctUntilChanged((e,t)=>{var i,r,s,l,c,d,u,h,g,S,f,v,p,C,_,w,E,O;return((i=e==null?void 0:e.location)==null?void 0:i.unitId)===((r=t==null?void 0:t.location)==null?void 0:r.unitId)&&((s=e==null?void 0:e.location)==null?void 0:s.subUnitId)===((l=t==null?void 0:t.location)==null?void 0:l.subUnitId)&&((c=e==null?void 0:e.location)==null?void 0:c.row)===((d=t==null?void 0:t.location)==null?void 0:d.row)&&((u=e==null?void 0:e.location)==null?void 0:u.col)===((h=t==null?void 0:t.location)==null?void 0:h.col)&&((g=e==null?void 0:e.customRange)==null?void 0:g.rangeId)===((S=t==null?void 0:t.customRange)==null?void 0:S.rangeId)&&((f=e==null?void 0:e.bullet)==null?void 0:f.startIndex)===((v=t==null?void 0:t.bullet)==null?void 0:v.startIndex)&&((p=e==null?void 0:e.customRange)==null?void 0:p.startIndex)===((C=t==null?void 0:t.customRange)==null?void 0:C.startIndex)&&((_=e==null?void 0:e.customRange)==null?void 0:_.endIndex)===((w=t==null?void 0:t.customRange)==null?void 0:w.endIndex)&&((E=e==null?void 0:e.drawing)==null?void 0:E.drawingId)===((O=t==null?void 0:t.drawing)==null?void 0:O.drawingId)}),N.map(e=>e&&{unitId:e.location.unitId,subUnitId:e.location.subUnitId,row:e.location.row,col:e.location.col,customRange:e.customRange,bullet:e.bullet,rect:e.rect,drawing:e.drawing})));R(this,"currentCellPosWithEvent$",this._currentCellWithEvent$.pipe(N.distinctUntilChanged((e,t)=>{var i,r,s,l,c,d,u,h;return((i=e==null?void 0:e.location)==null?void 0:i.unitId)===((r=t==null?void 0:t.location)==null?void 0:r.unitId)&&((s=e==null?void 0:e.location)==null?void 0:s.subUnitId)===((l=t==null?void 0:t.location)==null?void 0:l.subUnitId)&&((c=e==null?void 0:e.location)==null?void 0:c.row)===((d=t==null?void 0:t.location)==null?void 0:d.row)&&((u=e==null?void 0:e.location)==null?void 0:u.col)===((h=t==null?void 0:t.location)==null?void 0:h.col)}),N.map(e=>e&&{unitId:e.location.unitId,subUnitId:e.location.subUnitId,row:e.location.row,col:e.location.col,event:e.event})));R(this,"currentPosition$",this._currentCell$.asObservable());R(this,"currentClickedCell$",this._currentClickedCell$.asObservable());R(this,"currentDbClickedCell$",this._currentDbClickedCell$.asObservable());R(this,"currentPointerDownCell$",this._currentPointerDownCell$.asObservable());R(this,"currentPointerUpCell$",this._currentPointerUpCell$.asObservable());R(this,"currentHoveredRowHeader$",this._currentHoveredRowHeader$.asObservable());R(this,"currentHoveredColHeader$",this._currentHoveredColHeader$.asObservable());R(this,"currentRowHeaderClick$",this._currentRowHeaderClick$.asObservable());R(this,"currentColHeaderClick$",this._currentColHeaderClick$.asObservable());R(this,"currentRowHeaderDbClick$",this._currentRowHeaderDbClick$.asObservable());R(this,"currentColHeaderDbClick$",this._currentColHeaderDbClick$.asObservable());R(this,"currentRowHeaderPointerDown$",this._currentRowHeaderPointerDown$.asObservable());R(this,"currentColHeaderPointerDown$",this._currentColHeaderPointerDown$.asObservable());R(this,"currentRowHeaderPointerUp$",this._currentRowHeaderPointerUp$.asObservable());R(this,"currentColHeaderPointerUp$",this._currentColHeaderPointerUp$.asObservable());this._univerInstanceService=e,this._renderManagerService=t,this._initCellDisposableListener()}dispose(){super.dispose(),this._currentCell$.complete(),this._currentClickedCell$.complete(),this._currentPointerDownCell$.complete(),this._currentPointerUpCell$.complete(),this._currentCellWithEvent$.complete(),this._currentRichText$.complete(),this._currentDbClickedCell$.complete(),this._currentHoveredRowHeader$.complete(),this._currentHoveredColHeader$.complete(),this._currentRowHeaderClick$.complete(),this._currentColHeaderClick$.complete(),this._currentRowHeaderDbClick$.complete(),this._currentColHeaderDbClick$.complete(),this._currentRowHeaderPointerDown$.complete(),this._currentColHeaderPointerDown$.complete(),this._currentRowHeaderPointerUp$.complete(),this._currentColHeaderPointerUp$.complete(),this.currentCellPosWithEvent$=N.of(null),this.currentRichText$=N.of(null)}_initCellDisposableListener(){this.disposeWithMe(this._univerInstanceService.getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET).subscribe(e=>{e||this._currentCell$.next(null)})),this.disposeWithMe(this._univerInstanceService.unitDisposed$.subscribe(e=>{var t,i;((t=this._currentCell$.getValue())==null?void 0:t.location.unitId)===e.getUnitId()&&this._currentCell$.next(null),((i=this._currentRichText$.getValue())==null?void 0:i.location.unitId)===e.getUnitId()&&this._currentRichText$.next(null)}))}_getCalcDeps(e){const t=this._univerInstanceService.getUnit(e,a.UniverInstanceType.UNIVER_SHEET);if(!t)return null;const i=t.getActiveSheet();if(!i)return null;const r=this._renderManagerService.getRenderById(t.getUnitId());if(!r)return null;const s=r.with(y.SheetSkeletonManagerService).getSkeletonParam(i.getSheetId());if(!s)return null;const l=r.with(y.SheetScrollManagerService);if(!(!(l!=null&&l.getCurrentScrollState())||!r))return{currentRender:r,workbook:t,worksheet:i,skeletonParam:s}}_calcActiveCell(e,t,i,r,s,l){var P,A,D;const c=Oa(e,t,i,r,s,l),d=r.skeleton;if(!c)return null;const{position:u,overflowLocation:h,location:g}=c,S=d.getFont(h.row,h.col);let f=null,v=null,p=null;const C=d.getCellWithCoordByIndex(h.row,h.col),_=i.getCell(h.row,h.col),{topOffset:w=0,leftOffset:E=0}=(P=_==null?void 0:_.fontRenderExtension)!=null?P:{};if(S!=null&&S.documentSkeleton){const{paddingLeft:k,paddingTop:H}=wl(C,S,(_==null?void 0:_.v)!==null&&(_==null?void 0:_.v)!==void 0?!Number.isNaN(+_.v):!1),V=bl(S.documentSkeleton,k,H),L=s-u.startX-E,W=l-u.startY-w;f=V.links.find(B=>B.rects.some(U=>U.left<=L&&L<=U.right&&U.top<=W&&W<=U.bottom)),v=V.checkLists.find(B=>B.rect.left<=L&&L<=B.rect.right&&B.rect.top<=W&&W<=B.rect.bottom),p=V.drawings.find(B=>B.rect.left<=L&&L<=B.rect.right&&B.rect.top<=W&&W<=B.rect.bottom)}const O=(D=(A=f==null?void 0:f.rects.pop())!=null?A:v==null?void 0:v.rect)!=null?D:p==null?void 0:p.rect,T=O&&(()=>{const k=O.top+C.mergeInfo.startY+w,H=O.bottom+C.mergeInfo.startY+w,V=O.left+C.mergeInfo.startX+E,L=O.right+C.mergeInfo.startX+E,W=C.mergeInfo.startY+w,B=C.mergeInfo.endY+w,U=C.mergeInfo.startX+E,z=C.mergeInfo.endX+E,F=Math.min(Math.max(k,W),W),j=Math.min(H,B),Y=Math.min(Math.max(V,U),U),Q=Math.min(L,z);return{top:F,bottom:j,left:Y,right:Q}})();return{location:g,position:u,overflowLocation:h,customRange:f==null?void 0:f.range,bullet:v==null?void 0:v.paragraph,drawing:p,rect:T}}_calcActiveRowHeader(e,t,i){const r=this._getCalcDeps(e);if(!r)return;const{currentRender:s,worksheet:l,skeletonParam:c}=r,{scaleY:d}=s.scene.getAncestorScale(),u=s.scene.getViewports().find(S=>S.isHit(new M.Vector2(t,i)));if(!u||u.viewportKey!==M.SHEET_VIEWPORT_KEY.VIEW_ROW_TOP&&u.viewportKey!==M.SHEET_VIEWPORT_KEY.VIEW_ROW_BOTTOM)return;const h={x:u.viewportScrollX,y:u.viewportScrollY},g=c.skeleton.getRowIndexByOffsetY(i,d,h);return{unitId:e,index:g,subUnitId:l.getSheetId()}}_calcActiveColHeader(e,t,i){const r=this._getCalcDeps(e);if(!r)return;const{currentRender:s,worksheet:l,skeletonParam:c}=r,{scaleX:d}=s.scene.getAncestorScale(),u=s.scene.getViewports().find(S=>S.isHit(new M.Vector2(t,i)));if(!u||u.viewportKey!==M.SHEET_VIEWPORT_KEY.VIEW_COLUMN_LEFT&&u.viewportKey!==M.SHEET_VIEWPORT_KEY.VIEW_COLUMN_RIGHT)return;const h={x:u.viewportScrollX,y:u.viewportScrollY},g=c.skeleton.getColumnIndexByOffsetX(t,d,h);return{unitId:e,index:g,subUnitId:l.getSheetId()}}triggerPointerDown(e,t){const i=this._getCalcDeps(e);if(!i)return;const{currentRender:r,workbook:s,worksheet:l,skeletonParam:c}=i,d=this._calcActiveCell(r,s,l,c,t.offsetX,t.offsetY);if(d&&d.location){const{unitId:u,subUnitId:h,row:g,col:S}=jt(d.location);this._currentPointerDownCell$.next({unitId:u,subUnitId:h,row:g,col:S,event:t})}}triggerPointerUp(e,t){const i=this._getCalcDeps(e);if(!i)return;const{currentRender:r,workbook:s,worksheet:l,skeletonParam:c}=i,d=this._calcActiveCell(r,s,l,c,t.offsetX,t.offsetY);if(d){const u=jt(d.location);this._currentPointerUpCell$.next({...u,event:t})}}triggerMouseMove(e,t){const i=this._getCalcDeps(e);if(!i)return;const{currentRender:r,workbook:s,worksheet:l,skeletonParam:c}=i,d=this._calcActiveCell(r,s,l,c,t.offsetX,t.offsetY);this._currentCell$.next(d&&{location:jt(d.location),position:d.position}),this._currentRichText$.next(d&&{...d,location:jt(d.overflowLocation)}),this._currentCellWithEvent$.next(d&&{...d,location:jt(d.location),event:t})}triggerClick(e,t,i){const r=this._getCalcDeps(e);if(!r)return;const{currentRender:s,workbook:l,worksheet:c,skeletonParam:d}=r,u=this._calcActiveCell(s,l,c,d,t,i);u&&this._currentClickedCell$.next({...u,location:jt(u.location)})}triggerDbClick(e,t,i){const r=this._getCalcDeps(e);if(!r)return;const{currentRender:s,workbook:l,worksheet:c,skeletonParam:d}=r,u=this._calcActiveCell(s,l,c,d,t,i);u&&this._currentDbClickedCell$.next({...u,location:jt(u.location)})}triggerScroll(){this._currentCell$.next(null)}triggerRowHeaderClick(e,t,i){const r=this._calcActiveRowHeader(e,t,i);r&&this._currentRowHeaderClick$.next(r)}triggerColHeaderClick(e,t,i){const r=this._calcActiveColHeader(e,t,i);r&&this._currentColHeaderClick$.next(r)}triggerRowHeaderDbClick(e,t,i){const r=this._calcActiveRowHeader(e,t,i);r&&this._currentRowHeaderDbClick$.next(r)}triggerColHeaderDbClick(e,t,i){const r=this._calcActiveColHeader(e,t,i);r&&this._currentColHeaderDbClick$.next(r)}triggerRowHeaderMouseMove(e,t,i){this._currentHoveredRowHeader$.next(this._calcActiveRowHeader(e,t,i))}triggerColHeaderMouseMove(e,t,i){this._currentHoveredColHeader$.next(this._calcActiveColHeader(e,t,i))}triggerRowHeaderPoniterDown(e,t,i){const r=this._calcActiveRowHeader(e,t,i);r&&this._currentRowHeaderPointerDown$.next(r)}triggerColHeaderPoniterDown(e,t,i){const r=this._calcActiveColHeader(e,t,i);r&&this._currentColHeaderPointerDown$.next(r)}triggerRowHeaderPoniterUp(e,t,i){const r=this._calcActiveRowHeader(e,t,i);r&&this._currentRowHeaderPointerUp$.next(r)}triggerColHeaderPoniterUp(e,t,i){const r=this._calcActiveColHeader(e,t,i);r&&this._currentColHeaderPointerUp$.next(r)}},y.HoverManagerService=Fm([El(0,a.IUniverInstanceService),El(1,M.IRenderManagerService)],y.HoverManagerService);var zm=Object.getOwnPropertyDescriptor,Xm=(n,o,e,t)=>{for(var i=t>1?void 0:t?zm(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Hr=(n,o)=>(e,t)=>o(e,t,n);y.HoverRenderController=class extends a.Disposable{constructor(e,t,i,r){super();R(this,"_active",!1);this._context=e,this._hoverManagerService=t,this._sheetSkeletonManagerService=i,this._scrollManagerService=r,this._initPointerEvent(),this._initScrollEvent()}get active(){return this._active}_initPointerEvent(){const e=new a.DisposableCollection,t=i=>{if(e.dispose(),!i)return;const{mainComponent:r,unitId:s,components:l}=this._context;if(!r)return;e.add(r.onPointerEnter$.subscribeEvent(u=>{this._active=!0})),e.add(a.fromEventSubject(r.onPointerMove$).subscribe(u=>{this._active=!0,this._hoverManagerService.triggerMouseMove(s,u)})),e.add(r.onPointerDown$.subscribeEvent(u=>{this._hoverManagerService.triggerPointerDown(s,u)})),e.add(r.onPointerUp$.subscribeEvent(u=>{this._hoverManagerService.triggerPointerUp(s,u)})),e.add(r.onClick$.subscribeEvent(u=>{this._hoverManagerService.triggerClick(s,u.offsetX,u.offsetY)})),e.add(r.onDblclick$.subscribeEvent(u=>{this._hoverManagerService.triggerDbClick(s,u.offsetX,u.offsetY)})),e.add(r.onPointerLeave$.subscribeEvent(()=>{this._active=!1}));const c=l.get(he.ROW),d=l.get(he.COLUMN);c&&(e.add(c.onPointerMove$.subscribeEvent(u=>{this._hoverManagerService.triggerRowHeaderMouseMove(s,u.offsetX,u.offsetY)})),e.add(c.onPointerDown$.subscribeEvent(u=>{this._hoverManagerService.triggerRowHeaderPoniterDown(s,u.offsetX,u.offsetY)})),e.add(c.onPointerUp$.subscribeEvent(u=>{this._hoverManagerService.triggerRowHeaderPoniterUp(s,u.offsetX,u.offsetY),this._hoverManagerService.triggerRowHeaderClick(s,u.offsetX,u.offsetY)})),e.add(c.onDblclick$.subscribeEvent(u=>{this._hoverManagerService.triggerRowHeaderDbClick(s,u.offsetX,u.offsetY)}))),d&&(e.add(d.onPointerMove$.subscribeEvent(u=>{this._hoverManagerService.triggerColHeaderMouseMove(s,u.offsetX,u.offsetY)})),e.add(d.onPointerDown$.subscribeEvent(u=>{this._hoverManagerService.triggerColHeaderPoniterDown(s,u.offsetX,u.offsetY)})),e.add(d.onPointerUp$.subscribeEvent(u=>{this._hoverManagerService.triggerColHeaderPoniterUp(s,u.offsetX,u.offsetY),this._hoverManagerService.triggerColHeaderClick(s,u.offsetX,u.offsetY)})),e.add(d.onDblclick$.subscribeEvent(u=>{this._hoverManagerService.triggerColHeaderDbClick(s,u.offsetX,u.offsetY)})))};t(this._sheetSkeletonManagerService.getCurrentParam()),this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(i=>{t(i)}))}_initScrollEvent(){this.disposeWithMe(this._scrollManagerService.validViewportScrollInfo$.subscribe(()=>this._hoverManagerService.triggerScroll()))}},y.HoverRenderController=Xm([Hr(1,a.Inject(y.HoverManagerService)),Hr(2,a.Inject(y.SheetSkeletonManagerService)),Hr(3,a.Inject(y.SheetScrollManagerService))],y.HoverRenderController);const Tl="UI_PLUGIN_SHEETS",Vr=`${Tl}_BORDER_PANEL_COMPONENT`,yl=[{label:"borderLine.borderTop",icon:"UpBorderDoubleIcon",value:"top"},{label:"borderLine.borderBottom",icon:"DownBorderDoubleIcon",value:"bottom"},{label:"borderLine.borderLeft",icon:"LeftBorderDoubleIcon",value:"left"},{label:"borderLine.borderRight",icon:"RightBorderDoubleIcon",value:"right"},{label:"borderLine.borderNone",icon:"NoBorderIcon",value:"none"},{label:"borderLine.borderAll",icon:"AllBorderIcon",value:"all"},{label:"borderLine.borderOutside",icon:"OuterBorderDoubleIcon",value:"outside"},{label:"borderLine.borderInside",icon:"InnerBorderDoubleIcon",value:"inside"},{label:"borderLine.borderHorizontal",icon:"HorizontalBorderDoubleIcon",value:"horizontal"},{label:"borderLine.borderVertical",icon:"VerticalBorderDoubleIcon",value:"vertical"},{label:"borderLine.borderTlbr",icon:"BackSlashDoubleIcon",value:"tlbr"},{label:"borderLine.borderTlbcTlmr",icon:"LeftDoubleDiagonalDoubleIcon",value:"tlbc_tlmr"},{label:"borderLine.borderTlbrTlbcTlmr",icon:"LeftTridiagonalDoubleIcon",value:"tlbr_tlbc_tlmr"},{label:"borderLine.borderBlTr",icon:"SlashDoubleIcon",value:"bltr"},{label:"borderLine.borderMltrBctr",icon:"RightDoubleDiagonalDoubleIcon",value:"mltr_bctr"}];function Ym(n){return n.getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET).pipe(de.switchMap(o=>o?o.activeSheet$.pipe(de.map(e=>e?{workbook:o,worksheet:e}:null)):N.of(null)))}function be(n,o,e){return Ym(n).pipe(de.switchMap(t=>t?e(t):N.of(o)))}function Rl(n,o){const e=n.get(a.IUniverInstanceService),t=n.get(m.IExclusiveRangeService),i=n.get(m.SheetsSelectionsService);return e.getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET).pipe(de.switchMap(s=>s?N.combineLatest([i.selectionMoveEnd$,s.activeSheet$]).pipe(de.switchMap(([l,c])=>{if(!c||l.length===0)return N.of(!1);const d=t.getInterestGroupId(l);if(o){const u=d.filter(h=>o.has(h));return N.of(u.length>0)}else return N.of(d.length>0)})):N.of(!1)))}function ft(n,o,e){return N.combineLatest([o,Rl(n,e)]).pipe(de.map(([t,i])=>t||i))}function ee(n,o={},e=!1){var g;const i=n.get(a.IUniverInstanceService).getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET),r=n.get(a.UserManagerService),s=n.has(me)?n.get(me):null,l=n.get(a.IContextService),d=((g=s==null?void 0:s.visible$)!=null?g:N.of(null)).pipe(de.startWith(null),de.shareReplay(1)),u=l.subscribeContextValue$(a.FOCUSING_FX_BAR_EDITOR).pipe(de.startWith(!1),de.shareReplay(1));return N.combineLatest([r.currentUser$,i,d,u]).pipe(de.switchMap(([S,f,v,p])=>!f||v!=null&&v.visible&&v.unitId===f.getUnitId()&&!e||p&&!e?N.of(!0):f.activeSheet$.pipe(de.switchMap(C=>{if(!C)return N.of(!0);const _=n.get(m.SheetsSelectionsService),w=n.get(m.RangeProtectionRuleModel),E=n.get(m.WorksheetProtectionRuleModel),T=n.get(a.IContextService).subscribeContextValue$(a.FOCUSING_COMMON_DRAWINGS).pipe(de.startWith(!1));return N.combineLatest([_.selectionMoveEnd$,T]).pipe(de.switchMap(([P,A])=>{if(A)return N.of(!0);const D=f.getUnitId(),k=C.getSheetId(),H=n.get(a.IPermissionService),{workbookTypes:V=[m.WorkbookEditablePermission],worksheetTypes:L,rangeTypes:W}=o,B=[];if(V==null||V.forEach(j=>{B.push(new j(D).id)}),L==null||L.forEach(j=>{B.push(new j(D,k).id)}),E.getRule(D,k))return H.composePermission$(B).pipe(de.map(j=>j.some(Y=>Y.value===!1)));const z=P==null?void 0:P.map(j=>j.range),F=w.getSubunitRuleList(D,k).filter(j=>z==null?void 0:z.some(Y=>j.ranges.some(Q=>a.Rectangle.intersects(Y,Q))));return W==null||W.forEach(j=>{F.forEach(Y=>{B.push(new j(D,k,Y.permissionId).id)})}),H.composePermission$(B).pipe(de.map(j=>j.some(Y=>Y.value===!1)))}))}))))}function On(n){const o=n.get(a.IUniverInstanceService),e=n.get(m.SheetsSelectionsService),t=n.get(m.RangeProtectionRuleModel),i=n.get(a.IPermissionService);return N.merge(e.selectionMoveEnd$,i.permissionPointUpdate$.pipe(de.debounceTime(100))).pipe(de.map(()=>{var h;const r=(h=e.getCurrentLastSelection())==null?void 0:h.range;if(!r)return!0;const s=o.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),l=s==null?void 0:s.getActiveSheet();if(!s||!l)return!0;const c=s.getUnitId(),d=l.getSheetId(),u=[new m.WorkbookEditablePermission(c).id,new m.WorksheetEditPermission(c,d).id];return t.getSubunitRuleList(c,d).filter(g=>g.ranges.some(S=>a.Rectangle.intersects(r,S))).forEach(g=>{u.push(new m.RangeProtectionPermissionEditPoint(c,d,g.permissionId).id)}),i.composePermission(u).some(g=>g.value===!1)}))}function Ml(n,o){const e=n.get(a.IUniverInstanceService),t=n.get(m.SheetsSelectionsService),i=n.get(m.RangeProtectionRuleModel),r=n.get(a.IPermissionService);return N.merge(t.selectionMoveEnd$,r.permissionPointUpdate$.pipe(de.debounceTime(100))).pipe(de.map(()=>{var g;const s=(g=t.getCurrentLastSelection())==null?void 0:g.range;if(!s)return!0;const l=e.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),c=l==null?void 0:l.getActiveSheet();if(!l||!c)return!0;const d=l.getUnitId(),u=c.getSheetId(),h=[new m.WorkbookEditablePermission(d).id,new m.WorksheetEditPermission(d,u).id];return i.getSubunitRuleList(d,u).filter(S=>o==="row"?S.ranges.some(f=>s.startRow>f.startRow&&s.startRow<=f.endRow):S.ranges.some(f=>s.startColumn>f.startColumn&&s.startColumn<=f.endColumn)).forEach(S=>{h.push(new m.RangeProtectionPermissionEditPoint(d,u,S.permissionId).id)}),r.composePermission(h).some(S=>S.value===!1)}))}function Pl(n,o){const e=n.get(a.IUniverInstanceService),t=n.get(m.SheetsSelectionsService),i=n.get(m.RangeProtectionRuleModel),r=n.get(a.IPermissionService);return N.merge(t.selectionMoveEnd$,r.permissionPointUpdate$.pipe(de.debounceTime(100))).pipe(de.map(()=>{var S;const s=(S=t.getCurrentLastSelection())==null?void 0:S.range;if(!s)return!0;const l=e.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),c=l==null?void 0:l.getActiveSheet();if(!l||!c)return!0;const d=l.getUnitId(),u=c.getSheetId(),h=[new m.WorkbookEditablePermission(d).id,new m.WorksheetEditPermission(d,u).id],g=a.Tools.deepClone(s);return o==="row"?(g.startColumn=0,g.endColumn=c.getColumnCount()-1):(g.startRow=0,g.endRow=c.getRowCount()-1),i.getSubunitRuleList(d,u).filter(f=>f.ranges.some(v=>a.Rectangle.intersects(g,v))).forEach(f=>{h.push(new m.RangeProtectionPermissionEditPoint(d,u,f.permissionId).id)}),r.composePermission(h).some(f=>f.value===!1)}))}function fo(n,o){const e=n.get(a.IUniverInstanceService),t=n.get(m.SheetsSelectionsService),i=n.get(m.RangeProtectionRuleModel),r=n.get(a.IPermissionService);return N.merge(t.selectionMoveEnd$,r.permissionPointUpdate$.pipe(de.debounceTime(100))).pipe(de.map(()=>{var S;const s=(S=t.getCurrentLastSelection())==null?void 0:S.range;if(!s)return!0;const l=e.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),c=l==null?void 0:l.getActiveSheet();if(!l||!c)return!0;const d=l.getUnitId(),u=c.getSheetId(),h=[new m.WorkbookEditablePermission(d).id,new m.WorksheetEditPermission(d,u).id],g=a.Tools.deepClone(s);return o==="row"?g.endRow=c.getRowCount()-1:g.endColumn=c.getColumnCount()-1,i.getSubunitRuleList(d,u).filter(f=>f.ranges.some(v=>a.Rectangle.intersects(g,v))).forEach(f=>{h.push(new m.RangeProtectionPermissionEditPoint(d,u,f.permissionId).id)}),r.composePermission(h).some(f=>f.value===!1)}))}function An(n,o){const t=n.get(a.IUniverInstanceService).getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET),i=n.get(m.WorksheetProtectionRuleModel),r=n.get(m.RangeProtectionRuleModel),s=n.get(a.IPermissionService),l=n.get(a.UserManagerService);return N.combineLatest([l.currentUser$,t]).pipe(de.switchMap(([c,d])=>d?d.activeSheet$.pipe(de.switchMap(u=>{if(!u)return N.of(!0);const h=d.getUnitId(),g=[];return o.forEach(f=>g.push(new f(h).id)),s.composePermission$(g).pipe(de.map(f=>f.every(v=>v.value===!0))).pipe(de.map(f=>{if(!f)return!0;const v=u.getSheetId(),p=i.getRule(h,v),C=r.getSubunitRuleList(h,v);return!!(p||C.length)}))})):N.of(!0)))}function jm(n){const o=n.get(m.BorderStyleManagerService),e=ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetSetCellStylePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]});return{id:m.SetBorderBasicCommand.id,icon:new N.Observable(t=>{const i="AllBorderIcon",r=n.get(m.BorderStyleManagerService),s=n.get(a.ICommandService).onCommandExecuted(l=>{var g;if(l.id!==m.SetBorderBasicCommand.id)return;const{type:d}=r.getBorderInfo(),u=yl.find(S=>S.value===d),h=(g=u==null?void 0:u.icon)!=null?g:i;t.next(h)});return t.next(i),s.dispose}),tooltip:"toolbar.border.main",type:I.MenuItemType.BUTTON_SELECTOR,slot:!0,selections:[{label:{name:Vr,hoverable:!1,selectable:!1},value$:o.borderInfo$}],value$:o.borderInfo$,hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET),disabled$:e}}const vo="sheet.menu.clear-selection";function Wr(n){return{id:vo,type:I.MenuItemType.SUBITEMS,icon:"ClearFormatDoubleIcon",title:"rightClick.clearSelection",hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function Lr(n){return{id:m.ClearSelectionContentCommand.id,type:I.MenuItemType.BUTTON,icon:"ClearFormatDoubleIcon",title:"rightClick.clearContent",disabled$:ft(n,ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetSetCellValuePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]})),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function xr(n){return{id:m.ClearSelectionFormatCommand.id,type:I.MenuItemType.BUTTON,icon:"ClearFormatDoubleIcon",title:"rightClick.clearFormat",disabled$:ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetSetCellStylePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]}),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function po(n){return{id:m.ClearSelectionAllCommand.id,type:I.MenuItemType.BUTTON,icon:"ClearFormatDoubleIcon",title:"rightClick.clearAll",tooltip:"rightClick.clearAll",disabled$:ft(n,ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetSetCellValuePermission,m.WorksheetSetCellStylePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]})),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}const Ol="sheet.menu.delete";function Zm(n){return{id:Ol,type:I.MenuItemType.SUBITEMS,title:"rightClick.delete",icon:"ReduceDoubleIcon",hidden$:ft(n,On(n)),disabled$:ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission]})}}function Al(n){return{id:gn.id,type:I.MenuItemType.BUTTON,icon:"DeleteColumnDoubleIcon",title:"rightClick.deleteSelectedColumn",hidden$:Pl(n,"col"),disabled$:ee(n,{workbookTypes:[m.WorkbookEditablePermission,m.WorkbookDeleteColumnPermission],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetDeleteColumnPermission]})}}function Dl(n){return{id:mn.id,type:I.MenuItemType.BUTTON,icon:"DeleteRowDoubleIcon",title:"rightClick.deleteSelectedRow",disabled$:ee(n,{workbookTypes:[m.WorkbookEditablePermission,m.WorkbookDeleteRowPermission],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetDeleteRowPermission]}),hidden$:Pl(n,"row")}}function Gm(n){return{id:cn.id,type:I.MenuItemType.BUTTON,title:"rightClick.moveLeft",icon:"DeleteCellShiftLeftDoubleIcon",disabled$:ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]}),hidden$:fo(n,"col")}}function Km(n){return{id:Mt.id,type:I.MenuItemType.BUTTON,title:"rightClick.moveUp",icon:"DeleteCellShiftUpDoubleIcon",disabled$:ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]}),hidden$:fo(n,"row")}}function qm(n,o){const e=n.get(m.SheetsSelectionsService),t=n.get(a.IUniverInstanceService),i=n.get(a.ICommandService),r=n.get(a.IContextService);return be(t,o,({worksheet:s})=>new N.Observable(l=>{const c=()=>{var S;let h=o;const g=(S=e.getCurrentLastSelection())==null?void 0:S.primary;if(g!=null){const f=s.getComposedCellStyle(g.startRow,g.startColumn);f.fs&&(h=f.fs)}l.next(h)},d=()=>{var g,S;const h=Pt(n);if(h!=null){const f=(S=(g=h.ts)==null?void 0:g.fs)!=null?S:o;l.next(f)}},u=i.onCommandExecuted(h=>{const g=h.id;(g===m.SetRangeValuesMutation.id||g===m.SetSelectionsOperation.id||g===m.SetWorksheetActiveOperation.id)&&c(),(g===Ce.SetTextSelectionsOperation.id||g===q.SetInlineFormatCommand.id)&&r.getContextValue(a.EDITOR_ACTIVATED)&&r.getContextValue(a.FOCUSING_SHEET)&&d()});return c(),u.dispose}))}function Qm(n){const o=a.DEFAULT_STYLES.fs,e=ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetSetCellStylePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]},!0);return{id:ii.id,type:I.MenuItemType.SELECTOR,tooltip:"toolbar.fontSize",label:{name:I.FONT_SIZE_COMPONENT,props:{min:6,max:400,disabled$:e}},selections:I.FONT_SIZE_LIST,disabled$:e,value$:qm(n,o),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function Jm(n){const o=ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetSetCellStylePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]},!0);return{id:qi.id,type:I.MenuItemType.BUTTON,icon:"FontSizeIncreaseIcon",tooltip:"toolbar.fontSizeIncrease",disabled$:o,hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function $m(n){const o=ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetSetCellStylePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]},!0);return{id:Qi.id,type:I.MenuItemType.BUTTON,icon:"FontSizeReduceIcon",tooltip:"toolbar.fontSizeDecrease",disabled$:o,hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function eg(n){const o=n.get(a.ICommandService),e=n.get(a.IUniverInstanceService);return{id:m.ToggleGridlinesCommand.id,type:I.MenuItemType.BUTTON,tooltip:"toolbar.toggleGridlines",icon:"HideGridlinesDoubleIcon",activated$:new N.Observable(t=>{const i=()=>{const s=e.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET);return s?s.getActiveSheet().getConfig().showGridlines===a.BooleanNumber.TRUE:!1},r=new a.DisposableCollection;return r.add(o.onCommandExecuted(s=>{(s.id===m.ToggleGridlinesMutation.id||s.id===m.SetWorksheetActiveOperation.id)&&t.next(i())})),r.add(e.getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET).subscribe(()=>{t.next(i())})),t.next(i()),()=>r.dispose()}),disabled$:ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission]})}}const Ze=`${Tl}_MENU_ITEM_INPUT_COMPONENT`,Nl=n=>{const{prefix:o,suffix:e,value:t,min:i=Number.MIN_SAFE_INTEGER,max:r=Number.MAX_SAFE_INTEGER,disabled$:s,onChange:l}=n,c=I.useDependency(a.LocaleService),d=I.useDependency(I.IContextMenuService),[u,h]=x.useState(!1),[g,S]=x.useState(),f=p=>{if(!p){S(i.toString());return}const C=p.toString();S(C),l(C)};x.useEffect(()=>{if(!s)return;const p=s.subscribe(C=>{h(C)});return()=>{p.unsubscribe()}},[]),x.useEffect(()=>{d.visible||S(t)},[d.visible]),x.useEffect(()=>{+t<i?S(i.toString()):+t>r?S(r.toString()):S(t)},[t]);function v(){g&&l(g)}return b.jsxs("div",{className:"univer-inline-flex univer-items-center univer-gap-1",children:[c.t(o),b.jsx("div",{className:"univer-w-16",onClick:p=>p.stopPropagation(),children:b.jsx(X.InputNumber,{value:Number(g),size:"mini",precision:0,min:i,max:r,disabled:u,onPressEnter:v,onChange:f})}),c.t(e)]})},kl="sheet.menu.cell-insert";function tg(n){return{id:kl,type:I.MenuItemType.SUBITEMS,title:"rightClick.insert",icon:"InsertDoubleIcon",hidden$:ft(n,On(n)),disabled$:ee(n,{workbookTypes:[m.WorkbookEditablePermission,m.WorkbookInsertColumnPermission,m.WorkbookInsertRowPermission],worksheetTypes:[m.WorksheetInsertColumnPermission,m.WorksheetInsertRowPermission,m.WorksheetEditPermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]})}}function ng(n){const o=n.get(a.IUniverInstanceService),e=n.get(m.SheetsSelectionsService),t=n.get(a.ICommandService),i=1,r=ee(n,{workbookTypes:[m.WorkbookEditablePermission,m.WorkbookInsertRowPermission],worksheetTypes:[m.WorksheetInsertRowPermission,m.WorksheetEditPermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]});return{id:m.InsertRowBeforeCommand.id,type:I.MenuItemType.BUTTON,icon:"InsertRowAboveDoubleIcon",label:{name:Ze,props:{prefix:"rightClick.insertRowsAbove",min:1,max:1e3,suffix:"rightClick.insertRowsAboveSuffix",disabled$:r}},value$:be(o,i,()=>new N.Observable(s=>{function l(){var h;const d=(h=e.getCurrentLastSelection())==null?void 0:h.range;let u=i;d&&(u=(d==null?void 0:d.endRow)-(d==null?void 0:d.startRow)+1),s.next(u)}const c=t.onCommandExecuted(d=>{if(d.id===m.SetSelectionsOperation.id)return l()});return l(),c.dispose})),disabled$:r,hidden$:Ml(n,"row")}}function ig(n){const o=n.get(a.IUniverInstanceService),e=n.get(m.SheetsSelectionsService),t=n.get(a.ICommandService),i=1,r=ee(n,{workbookTypes:[m.WorkbookEditablePermission,m.WorkbookInsertColumnPermission],worksheetTypes:[m.WorksheetInsertColumnPermission,m.WorksheetEditPermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]});return{id:m.InsertColBeforeCommand.id,type:I.MenuItemType.BUTTON,icon:"LeftInsertColumnDoubleIcon",label:{name:Ze,props:{prefix:"rightClick.insertColsLeft",min:1,max:1e3,suffix:"rightClick.insertColsLeftSuffix",disabled$:r}},value$:be(o,i,()=>new N.Observable(s=>{function l(){var h;const d=(h=e.getCurrentLastSelection())==null?void 0:h.range;let u=i;d&&(u=(d==null?void 0:d.endColumn)-(d==null?void 0:d.startColumn)+1),s.next(u)}const c=t.onCommandExecuted(d=>{if(d.id===m.SetSelectionsOperation.id)return l()});return l(),c.dispose})),disabled$:r,hidden$:Ml(n,"col")}}function og(n){return{id:hn.id,type:I.MenuItemType.BUTTON,title:"rightClick.moveRight",icon:"InsertCellShiftRightDoubleIcon",disabled$:ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]}),hidden$:fo(n,"col")}}function rg(n){return{id:kt.id,type:I.MenuItemType.BUTTON,title:"rightClick.moveDown",icon:"InsertCellDownDoubleIcon",disabled$:ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]}),hidden$:fo(n,"row")}}function sg(n){const o=n.get(a.IUniverInstanceService),e=n.get(m.SheetsSelectionsService),t=n.get(a.ICommandService),i=1,r=ee(n,{workbookTypes:[m.WorkbookEditablePermission,m.WorkbookInsertRowPermission],worksheetTypes:[m.WorksheetInsertRowPermission,m.WorksheetEditPermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]});return{id:m.InsertMultiRowsAfterCommand.id,type:I.MenuItemType.BUTTON,icon:"InsertRowBelowDoubleIcon",label:{name:Ze,props:{prefix:"rightClick.insertRowsAfter",min:1,max:1e3,suffix:"rightClick.insertRowsAfterSuffix",disabled$:r}},value$:be(o,i,()=>new N.Observable(s=>{function l(){var h;const d=(h=e.getCurrentLastSelection())==null?void 0:h.range;let u=i;d&&(u=(d==null?void 0:d.endRow)-(d==null?void 0:d.startRow)+1),s.next(u)}const c=t.onCommandExecuted(d=>{if(d.id===m.SetSelectionsOperation.id)return l()});return l(),c.dispose})),disabled$:r,hidden$:On(n)}}function ag(n){const o=n.get(a.IUniverInstanceService),e=n.get(m.SheetsSelectionsService),t=n.get(a.ICommandService),i=1,r=ee(n,{workbookTypes:[m.WorkbookEditablePermission,m.WorkbookInsertRowPermission],worksheetTypes:[m.WorksheetInsertRowPermission,m.WorksheetEditPermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]});return{id:m.InsertMultiRowsAboveCommand.id,type:I.MenuItemType.BUTTON,icon:"InsertRowAboveDoubleIcon",label:{name:Ze,props:{prefix:"rightClick.insertRowsAbove",min:1,max:1e3,suffix:"rightClick.insertRowsAboveSuffix",disabled$:r}},value$:be(o,i,()=>new N.Observable(s=>{function l(){var h;const d=(h=e.getCurrentLastSelection())==null?void 0:h.range;let u=i;d&&(u=(d==null?void 0:d.endRow)-(d==null?void 0:d.startRow)+1),s.next(u)}const c=t.onCommandExecuted(d=>{if(d.id===m.SetSelectionsOperation.id)return l()});return l(),c.dispose})),disabled$:r,hidden$:On(n)}}function lg(n){const o=n.get(a.IUniverInstanceService),e=n.get(m.SheetsSelectionsService),t=n.get(a.ICommandService),i=1,r=ee(n,{workbookTypes:[m.WorkbookEditablePermission,m.WorkbookInsertColumnPermission],worksheetTypes:[m.WorksheetInsertColumnPermission,m.WorksheetEditPermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]});return{id:m.InsertMultiColsLeftCommand.id,type:I.MenuItemType.BUTTON,icon:"LeftInsertColumnDoubleIcon",label:{name:Ze,props:{prefix:"rightClick.insertColsLeft",min:1,max:1e3,suffix:"rightClick.insertColsLeftSuffix",disabled$:r}},value$:be(o,i,()=>new N.Observable(s=>{function l(){var h;const d=(h=e.getCurrentLastSelection())==null?void 0:h.range;let u=i;d&&(u=(d==null?void 0:d.endColumn)-(d==null?void 0:d.startColumn)+1),s.next(u)}const c=t.onCommandExecuted(d=>{if(d.id===m.SetSelectionsOperation.id)return l()});return l(),c.dispose})),disabled$:r,hidden$:On(n)}}function cg(n){const o=n.get(a.IUniverInstanceService),e=n.get(m.SheetsSelectionsService),t=n.get(a.ICommandService),i=1,r=ee(n,{workbookTypes:[m.WorkbookEditablePermission,m.WorkbookInsertColumnPermission],worksheetTypes:[m.WorksheetInsertColumnPermission,m.WorksheetEditPermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]});return{id:m.InsertMultiColsRightCommand.id,type:I.MenuItemType.BUTTON,icon:"RightInsertColumnDoubleIcon",label:{name:Ze,props:{prefix:"rightClick.insertColsRight",min:1,max:1e3,suffix:"rightClick.insertColsRightSuffix",disabled$:r}},value$:be(o,i,()=>new N.Observable(s=>{function l(){var h;const d=(h=e.getCurrentLastSelection())==null?void 0:h.range;let u=i;d&&(u=(d==null?void 0:d.endColumn)-(d==null?void 0:d.startColumn)+1),s.next(u)}const c=t.onCommandExecuted(d=>{if(d.id===m.SetSelectionsOperation.id)return l()});return l(),c.dispose})),disabled$:r,hidden$:On(n)}}var Hl=(n=>(n.ROW_HEADER_CONTEXT_MENU="ROW_HEADER_CONTEXT_MENU",n.COL_HEADER_CONTEXT_MENU="COL_HEADER_CONTEXT_MENU",n.SHEET_BAR="SHEET_BAR",n.SHEET_FOOTER="SHEET_FOOTER",n))(Hl||{});function dg(n){const o=n.get(Fe);return{id:fn.id,subId:io.id,type:I.MenuItemType.BUTTON,icon:"BrushIcon",title:"Format Painter",tooltip:"toolbar.formatPainter",activated$:new N.Observable(e=>{let t=!1;const i=o.status$.subscribe(r=>{t=r!==Ae.OFF,e.next(t)});return e.next(t),()=>{i.unsubscribe()}}),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET),disabled$:ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetCopyPermission,m.WorksheetEditPermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]},!0)}}function ug(n){const o=n.get(a.ICommandService),e=n.get(a.IUniverInstanceService),t=n.get(a.IContextService),i=n.get(m.SheetsSelectionsService);return{id:Ot.id,type:I.MenuItemType.BUTTON,icon:"BoldIcon",title:"Set bold",tooltip:"toolbar.bold",disabled$:ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetSetCellStylePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]},!0),activated$:be(e,!1,({worksheet:r})=>new N.Observable(s=>{var u;const l=o.onCommandExecuted(h=>{var S,f;const g=h.id;if(g===m.SetRangeValuesMutation.id||g===m.SetSelectionsOperation.id||g===m.SetWorksheetActiveOperation.id){const v=(S=i.getCurrentLastSelection())==null?void 0:S.primary;let p=a.FontWeight.NORMAL;if(v!=null){const C=r.getRange(v.startRow,v.startColumn);p=C==null?void 0:C.getFontWeight()}s.next(p===a.FontWeight.BOLD)}if((g===Ce.SetTextSelectionsOperation.id||g===q.SetInlineFormatCommand.id)&&t.getContextValue(a.EDITOR_ACTIVATED)&&t.getContextValue(a.FOCUSING_SHEET)){const v=Pt(n);if(v==null)return;const p=(f=v.ts)==null?void 0:f.bl;s.next(p===a.BooleanNumber.TRUE)}}),c=(u=i.getCurrentLastSelection())==null?void 0:u.primary;if(!r){s.next(!1);return}let d=a.FontWeight.NORMAL;if(c!=null){const h=r.getRange(c.startRow,c.startColumn);d=h==null?void 0:h.getFontWeight()}return s.next(d===a.FontWeight.BOLD),l.dispose})),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function hg(n){const o=n.get(a.ICommandService),e=n.get(a.IUniverInstanceService),t=n.get(m.SheetsSelectionsService),i=n.get(a.IContextService);return{id:At.id,type:I.MenuItemType.BUTTON,icon:"ItalicIcon",title:"Set italic",tooltip:"toolbar.italic",disabled$:ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetSetCellStylePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]},!0),activated$:be(e,!1,({worksheet:r})=>new N.Observable(s=>{var u;const l=o.onCommandExecuted(h=>{var S,f;const g=h.id;if(g===m.SetRangeValuesMutation.id||g===m.SetSelectionsOperation.id||g===m.SetWorksheetActiveOperation.id){const v=(S=t.getCurrentLastSelection())==null?void 0:S.primary;let p=a.FontItalic.NORMAL;if(v!=null){const C=r.getRange(v.startRow,v.startColumn);p=C==null?void 0:C.getFontStyle()}s.next(p===a.FontItalic.ITALIC)}if((g===Ce.SetTextSelectionsOperation.id||g===q.SetInlineFormatCommand.id)&&i.getContextValue(a.EDITOR_ACTIVATED)&&i.getContextValue(a.FOCUSING_SHEET)){const v=Pt(n);if(v==null)return;const p=(f=v.ts)==null?void 0:f.it;s.next(p===a.BooleanNumber.TRUE)}}),c=(u=t.getCurrentLastSelection())==null?void 0:u.primary;let d=a.FontItalic.NORMAL;if(c!=null){const h=r.getRange(c.startRow,c.startColumn);d=h==null?void 0:h.getFontStyle()}return s.next(d===a.FontItalic.ITALIC),l.dispose})),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function mg(n){const o=n.get(a.ICommandService),e=n.get(a.IUniverInstanceService),t=n.get(m.SheetsSelectionsService),i=n.get(a.IContextService);return{id:Dt.id,type:I.MenuItemType.BUTTON,icon:"UnderlineIcon",title:"Set underline",tooltip:"toolbar.underline",activated$:be(e,!1,({worksheet:r})=>new N.Observable(s=>{var u;const l=o.onCommandExecuted(h=>{var S,f;const g=h.id;if(g===m.SetRangeValuesMutation.id||g===m.SetSelectionsOperation.id||g===m.SetWorksheetActiveOperation.id){const v=(S=t.getCurrentLastSelection())==null?void 0:S.primary;let p;if(v!=null){const C=r.getRange(v.startRow,v.startColumn);p=C==null?void 0:C.getUnderline()}s.next(!!(p&&p.s))}if((g===Ce.SetTextSelectionsOperation.id||g===q.SetInlineFormatCommand.id)&&i.getContextValue(a.EDITOR_ACTIVATED)&&i.getContextValue(a.FOCUSING_SHEET)){const v=Pt(n);if(v==null)return;const p=(f=v.ts)==null?void 0:f.ul;s.next((p==null?void 0:p.s)===a.BooleanNumber.TRUE)}}),c=(u=t.getCurrentLastSelection())==null?void 0:u.primary;let d;if(c!=null){const h=r.getRange(c.startRow,c.startColumn);d=h==null?void 0:h.getUnderline()}return s.next(!!(d&&d.s)),l.dispose})),disabled$:ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetSetCellStylePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]},!0),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function gg(n){const o=n.get(a.ICommandService),e=n.get(a.IUniverInstanceService),t=n.get(m.SheetsSelectionsService),i=n.get(a.IContextService);return{id:Nt.id,type:I.MenuItemType.BUTTON,icon:"StrikethroughIcon",title:"Set strike through",tooltip:"toolbar.strikethrough",disabled$:ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetSetCellStylePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]},!0),activated$:be(e,!1,({worksheet:r})=>new N.Observable(s=>{var u;const l=o.onCommandExecuted(h=>{var S,f;const g=h.id;if(g===m.SetRangeValuesMutation.id||g===m.SetSelectionsOperation.id||g===m.SetWorksheetActiveOperation.id){const v=(S=t.getCurrentLastSelection())==null?void 0:S.primary;let p;if(v!=null){const C=r.getRange(v.startRow,v.startColumn);p=C==null?void 0:C.getStrikeThrough()}s.next(!!(p&&p.s))}if((g===Ce.SetTextSelectionsOperation.id||g===q.SetInlineFormatCommand.id)&&i.getContextValue(a.EDITOR_ACTIVATED)&&i.getContextValue(a.FOCUSING_SHEET)){const v=Pt(n);if(v==null)return;const p=(f=v.ts)==null?void 0:f.st;s.next((p==null?void 0:p.s)===a.BooleanNumber.TRUE)}}),c=(u=t.getCurrentLastSelection())==null?void 0:u.primary;let d;if(c!=null){const h=r.getRange(c.startRow,c.startColumn);d=h==null?void 0:h.getStrikeThrough()}return s.next(!!(d&&d.s)),l.dispose})),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function Sg(n){const o=n.get(a.ICommandService),e=n.get(a.IUniverInstanceService),t=n.get(m.SheetsSelectionsService),i=a.DEFAULT_STYLES.ff;return{id:dn.id,tooltip:"toolbar.font",type:I.MenuItemType.SELECTOR,label:I.FONT_FAMILY_COMPONENT,selections:[{label:{name:I.FONT_FAMILY_ITEM_COMPONENT,hoverable:!1,selectable:!1,props:{id:dn.id}}}],disabled$:ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetSetCellStylePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]},!0),value$:be(e,i,({worksheet:r})=>new N.Observable(s=>{const l=()=>{var h;let d=i;const u=(h=t.getCurrentLastSelection())==null?void 0:h.primary;if(u!=null){const g=r.getCellStyle(u.startRow,u.startColumn),S=r.getDefaultCellStyleInternal(),f=r.getRowStyle(u.startRow),v=r.getColumnStyle(u.startColumn),p=a.composeStyles(S,f,v,g);p.ff&&(d=p.ff)}s.next(d)},c=o.onCommandExecuted(d=>{const u=d.id;(u===m.SetRangeValuesMutation.id||u===m.SetSelectionsOperation.id||u===m.SetWorksheetActiveOperation.id)&&l()});return l(),c.dispose})),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function fg(n){return{id:Ji.id,type:I.MenuItemType.BUTTON,title:"toolbar.resetColor",icon:"NoColorDoubleIcon",disabled$:ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetSetCellStylePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]},!0),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function vg(n){const o=n.get(a.ICommandService),e=n.get(a.ThemeService),t=n.get(m.SheetsSelectionsService);return{id:un.id,icon:"FontColorDoubleIcon",tooltip:"toolbar.textColor.main",type:I.MenuItemType.BUTTON_SELECTOR,selections:[{label:{name:I.COLOR_PICKER_COMPONENT,hoverable:!1,selectable:!1},value$:new N.Observable(i=>{var c;const r=a.DEFAULT_STYLES.cl.rgb,{isAllValuesSame:s,value:l}=t.getCellStylesProperty("cl");s?i.next((c=l==null?void 0:l.rgb)!=null?c:r):i.next(r)})}],value$:new N.Observable(i=>{const r=e.getColorFromTheme("gray.900"),s=o.onCommandExecuted(l=>{if(l.id===un.id){const c=l.params.value;i.next(c!=null?c:r)}});return i.next(r),s.dispose}),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET),disabled$:ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetSetCellStylePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]},!0)}}function pg(n){return{id:m.ResetBackgroundColorCommand.id,type:I.MenuItemType.BUTTON,title:"toolbar.resetColor",icon:"NoColorDoubleIcon",disabled$:ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetSetCellStylePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]})}}function Cg(n){const o=n.get(a.ICommandService),e=n.get(a.ThemeService),t=n.get(m.SheetsSelectionsService);return{id:m.SetBackgroundColorCommand.id,tooltip:"toolbar.fillColor.main",type:I.MenuItemType.BUTTON_SELECTOR,icon:"PaintBucketDoubleIcon",selections:[{label:{name:I.COLOR_PICKER_COMPONENT,hoverable:!1,selectable:!1},value$:new N.Observable(i=>{var c;const r=a.DEFAULT_STYLES.bg.rgb,{isAllValuesSame:s,value:l}=t.getCellStylesProperty("bg");s?i.next((c=l==null?void 0:l.rgb)!=null?c:r):i.next(r)})}],value$:new N.Observable(i=>{const r=e.getColorFromTheme("primary.600"),s=o.onCommandExecuted(l=>{if(l.id===m.SetBackgroundColorCommand.id){const c=l.params.value;i.next(c!=null?c:r)}});return i.next(r),s.dispose}),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET),disabled$:ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetSetCellStylePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]})}}const Vl=[{label:"align.left",icon:"LeftJustifyingIcon",value:a.HorizontalAlign.LEFT},{label:"align.center",icon:"HorizontallyIcon",value:a.HorizontalAlign.CENTER},{label:"align.right",icon:"RightJustifyingIcon",value:a.HorizontalAlign.RIGHT}];function Ig(n){var s,l;const o=n.get(a.IUniverInstanceService),e=n.get(m.SheetsSelectionsService),t=o.getCurrentUnitOfType(a.UniverInstanceType.UNIVER_SHEET),i=t==null?void 0:t.getActiveSheet().getDefaultCellStyleInternal(),r=(s=i==null?void 0:i.ht)!=null?s:a.HorizontalAlign.LEFT;return{id:m.SetHorizontalTextAlignCommand.id,icon:(l=Vl.find(c=>c.value===r))==null?void 0:l.icon,tooltip:"toolbar.horizontalAlignMode.main",type:I.MenuItemType.SELECTOR,selections:Vl,value$:be(o,r,({worksheet:c})=>new N.Observable(d=>{var S,f;const u=n.get(a.ICommandService).onCommandExecuted(v=>{var w,E;const p=v.id;if(p!==m.SetHorizontalTextAlignCommand.id&&p!==m.SetSelectionsOperation.id&&p!==m.SetWorksheetActiveOperation.id)return;const C=(w=e.getCurrentLastSelection())==null?void 0:w.primary;let _;if(C!=null){const O=c.getRange(C.startRow,C.startColumn),T=t==null?void 0:t.getActiveSheet().getComposedCellStyle(C.startRow,C.startColumn);_=(E=T==null?void 0:T.ht)!=null?E:O==null?void 0:O.getHorizontalAlignment()}d.next(_!=null?_:r)}),h=(S=e.getCurrentLastSelection())==null?void 0:S.primary;let g;if(h!=null){const v=c.getRange(h.startRow,h.startColumn),p=t==null?void 0:t.getActiveSheet().getComposedCellStyle(h.startRow,h.startColumn);g=(f=p==null?void 0:p.ht)!=null?f:v==null?void 0:v.getHorizontalAlignment()}return d.next(g!=null?g:r),u.dispose})),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET),disabled$:ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetSetCellStylePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]})}}const Wl=[{label:"align.top",icon:"AlignTopIcon",value:a.VerticalAlign.TOP},{label:"align.middle",icon:"VerticalCenterIcon",value:a.VerticalAlign.MIDDLE},{label:"align.bottom",icon:"AlignBottomIcon",value:a.VerticalAlign.BOTTOM}];function _g(n){var s,l;const o=n.get(a.IUniverInstanceService),e=n.get(m.SheetsSelectionsService),t=o.getCurrentUnitOfType(a.UniverInstanceType.UNIVER_SHEET),i=t==null?void 0:t.getActiveSheet().getDefaultCellStyleInternal(),r=(s=i==null?void 0:i.vt)!=null?s:a.VerticalAlign.BOTTOM;return{id:m.SetVerticalTextAlignCommand.id,icon:(l=Wl.find(c=>c.value===r))==null?void 0:l.icon,tooltip:"toolbar.verticalAlignMode.main",type:I.MenuItemType.SELECTOR,selections:Wl,value$:be(o,r,({worksheet:c})=>new N.Observable(d=>{var S,f;const u=n.get(a.ICommandService).onCommandExecuted(v=>{var w,E;const p=v.id;if(p!==m.SetVerticalTextAlignCommand.id&&p!==m.SetSelectionsOperation.id&&p!==m.SetWorksheetActiveOperation.id)return;const C=(w=e.getCurrentLastSelection())==null?void 0:w.primary;let _;if(C!=null){const O=c.getRange(C.startRow,C.startColumn),T=t==null?void 0:t.getActiveSheet().getComposedCellStyle(C.startRow,C.startColumn);_=(E=T==null?void 0:T.vt)!=null?E:O==null?void 0:O.getVerticalAlignment()}d.next(_!=null?_:r)}),h=(S=e.getCurrentLastSelection())==null?void 0:S.primary;let g;if(h!=null){const v=c.getRange(h.startRow,h.startColumn),p=t==null?void 0:t.getActiveSheet().getComposedCellStyle(h.startRow,h.startColumn);g=(f=p==null?void 0:p.vt)!=null?f:v==null?void 0:v.getVerticalAlignment()}return d.next(g!=null?g:r),u.dispose})),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET),disabled$:ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetSetCellStylePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]})}}const Ll=[{label:"textWrap.overflow",icon:"OverflowIcon",value:a.WrapStrategy.OVERFLOW},{label:"textWrap.wrap",icon:"AutowrapIcon",value:a.WrapStrategy.WRAP},{label:"textWrap.clip",icon:"TruncationIcon",value:a.WrapStrategy.CLIP}];function bg(n){var s,l;const o=n.get(m.SheetsSelectionsService),e=n.get(a.IUniverInstanceService),t=e.getCurrentUnitOfType(a.UniverInstanceType.UNIVER_SHEET),i=t==null?void 0:t.getActiveSheet().getDefaultCellStyleInternal(),r=(s=i==null?void 0:i.tb)!=null?s:a.WrapStrategy.OVERFLOW;return{id:m.SetTextWrapCommand.id,tooltip:"toolbar.textWrapMode.main",icon:(l=Ll.find(c=>c.value===r))==null?void 0:l.icon,type:I.MenuItemType.SELECTOR,selections:Ll,value$:be(e,r,({worksheet:c})=>new N.Observable(d=>{var S,f;const u=n.get(a.ICommandService).onCommandExecuted(v=>{var w,E;const p=v.id;if(p!==m.SetTextWrapCommand.id&&p!==m.SetSelectionsOperation.id&&p!==m.SetWorksheetActiveOperation.id)return;const C=(w=o.getCurrentLastSelection())==null?void 0:w.primary;let _;if(C!=null){const O=c.getRange(C.startRow,C.startColumn),T=t==null?void 0:t.getActiveSheet().getComposedCellStyle(C.startRow,C.startColumn);_=(E=T==null?void 0:T.tb)!=null?E:O==null?void 0:O.getWrapStrategy()}d.next(_!=null?_:r)}),h=(S=o.getCurrentLastSelection())==null?void 0:S.primary;let g;if(h!=null){const v=c.getRange(h.startRow,h.startColumn),p=t==null?void 0:t.getActiveSheet().getComposedCellStyle(h.startRow,h.startColumn);g=(f=p==null?void 0:p.tb)!=null?f:v==null?void 0:v.getWrapStrategy()}return d.next(g!=null?g:r),u.dispose})),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET),disabled$:ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetSetCellStylePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]})}}const xl=[{label:"textRotate.none",icon:"NoRotationIcon",value:0},{label:"textRotate.angleUp",icon:"LeftRotationFortyFiveDegreesIcon",value:-45},{label:"textRotate.angleDown",icon:"RightRotationFortyFiveDegreesIcon",value:45},{label:"textRotate.vertical",icon:"VerticalTextIcon",value:"v"},{label:"textRotate.rotationUp",icon:"LeftRotationNinetyDegreesIcon",value:-90},{label:"textRotate.rotationDown",icon:"RightRotationNinetyDegreesIcon",value:90}];function wg(n){const o=n.get(m.SheetsSelectionsService),e=n.get(a.IUniverInstanceService),t=0;return{id:m.SetTextRotationCommand.id,tooltip:"toolbar.textRotateMode.main",icon:xl[0].icon,type:I.MenuItemType.SELECTOR,selections:xl,value$:be(e,t,({worksheet:i})=>new N.Observable(r=>{var d,u;const s=n.get(a.ICommandService).onCommandExecuted(h=>{var v,p;const g=h.id;if(g!==m.SetTextRotationCommand.id&&g!==m.SetSelectionsOperation.id&&g!==m.SetWorksheetActiveOperation.id)return;const S=(v=o.getCurrentLastSelection())==null?void 0:v.primary;let f;if(S!=null){const C=i.getRange(S.startRow,S.startColumn);f=C==null?void 0:C.getTextRotation()}(f==null?void 0:f.v)===a.BooleanNumber.TRUE?r.next("v"):r.next((p=f&&f.a)!=null?p:t)}),l=(d=o.getCurrentLastSelection())==null?void 0:d.primary;let c;if(l!=null){const h=i.getRange(l.startRow,l.startColumn);c=h==null?void 0:h.getTextRotation()}return(c==null?void 0:c.v)===a.BooleanNumber.TRUE?r.next("v"):r.next((u=c&&c.a)!=null?u:t),s.dispose})),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET),disabled$:ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetSetCellStylePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]})}}function yi(n){return new N.Observable(e=>e.next(!n.get(I.IClipboardInterfaceService).supportClipboard))}function Dn(n){return{id:Ve.name,commandId:Ve.id,type:I.MenuItemType.BUTTON,title:"rightClick.copy",icon:"CopyDoubleIcon",disabled$:ee(n,{workbookTypes:[m.WorkbookCopyPermission],worksheetTypes:[m.WorksheetCopyPermission],rangeTypes:[m.RangeProtectionPermissionViewPoint]}),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function Ur(n){return{id:ht.name,commandId:I.CutCommand.id,type:I.MenuItemType.BUTTON,title:"rightClick.cut",icon:"CutIcon",disabled$:ee(n,{workbookTypes:[m.WorkbookCopyPermission,m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetCopyPermission,m.WorksheetEditPermission],rangeTypes:[m.RangeProtectionPermissionViewPoint,m.RangeProtectionPermissionEditPoint]}),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function Br(n){return{id:We.name,commandId:We.id,type:I.MenuItemType.BUTTON,title:"rightClick.paste",icon:"PasteSpecialDoubleIcon",disabled$:yi(n).pipe(N.combineLatestWith(ee(n,{rangeTypes:[m.RangeProtectionPermissionEditPoint],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetSetCellStylePermission,m.WorksheetSetCellValuePermission],workbookTypes:[m.WorkbookEditablePermission]})),N.map(([o,e])=>o||e)),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}const Ri="sheet.menu.copy-special";function Fr(n){return{id:Ri,type:I.MenuItemType.SUBITEMS,icon:"CopyDoubleIcon",title:"rightClick.copySpecial",hidden$:ft(n,I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET))}}const Mi="sheet.menu.paste-special";function zr(n){return{id:Mi,type:I.MenuItemType.SUBITEMS,icon:"PasteSpecialDoubleIcon",title:"rightClick.pasteSpecial",hidden$:ft(n,I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET))}}function Xr(n){return{id:sn.id,type:I.MenuItemType.BUTTON,title:"rightClick.pasteValue",disabled$:yi(n).pipe(N.combineLatestWith(ee(n,{rangeTypes:[m.RangeProtectionPermissionEditPoint],worksheetTypes:[m.WorksheetSetCellValuePermission,m.WorksheetEditPermission],workbookTypes:[m.WorkbookEditablePermission]})),N.map(([o,e])=>o||e)),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function Yr(n){return{id:an.id,type:I.MenuItemType.BUTTON,title:"rightClick.pasteFormat",disabled$:yi(n).pipe(N.combineLatestWith(ee(n,{rangeTypes:[m.RangeProtectionPermissionEditPoint],worksheetTypes:[m.WorksheetSetCellStylePermission,m.WorksheetEditPermission],workbookTypes:[m.WorkbookEditablePermission]})),N.map(([o,e])=>o||e)),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function jr(n){return{id:Rt.id,type:I.MenuItemType.BUTTON,title:"rightClick.pasteColWidth",disabled$:yi(n).pipe(N.combineLatestWith(ee(n,{rangeTypes:[m.RangeProtectionPermissionEditPoint],worksheetTypes:[m.WorksheetSetColumnStylePermission,m.WorksheetEditPermission],workbookTypes:[m.WorkbookEditablePermission]})),N.map(([o,e])=>o||e))}}function Zr(n){return{id:ln.id,type:I.MenuItemType.BUTTON,title:"rightClick.pasteBesidesBorder",disabled$:yi(n).pipe(N.combineLatestWith(ee(n,{rangeTypes:[m.RangeProtectionPermissionEditPoint],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetSetCellStylePermission,m.WorksheetSetCellValuePermission,m.WorksheetSetRowStylePermission,m.WorksheetSetColumnStylePermission],workbookTypes:[m.WorkbookEditablePermission]})),N.map(([o,e])=>o||e)),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function Eg(n){return{id:m.SetWorksheetRowIsAutoHeightCommand.id,type:I.MenuItemType.BUTTON,icon:"AutoHeightDoubleIcon",title:"rightClick.fitContent",disabled$:ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetSetRowStylePermission,m.WorksheetEditPermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]}),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function Tg(n){return{id:In.id,type:I.MenuItemType.BUTTON,icon:"AutoWidthDoubleIcon",title:"rightClick.fitContent",disabled$:ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetSetRowStylePermission,m.WorksheetEditPermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]}),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}const Ul="sheet.menu.sheet-frozen";function yg(n){return{id:Ul,type:I.MenuItemType.SUBITEMS,title:"rightClick.freeze",icon:"FreezeToSelectedIcon",hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}const Gr="sheet.header-menu.sheet-frozen";function Bl(n){return{id:Gr,type:I.MenuItemType.SUBITEMS,title:"rightClick.freeze",icon:"FreezeToSelectedIcon",hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function Kr(n){return{id:$e.id,type:I.MenuItemType.BUTTON,title:"rightClick.freeze",icon:"FreezeToSelectedIcon",hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function Rg(n){return{id:mi.id,type:I.MenuItemType.BUTTON,title:"rightClick.freezeRow",icon:"FreezeRowIcon",hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function Mg(n){return{id:gi.id,type:I.MenuItemType.BUTTON,title:"rightClick.freezeCol",icon:"FreezeColumnIcon",hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function qr(n){return{id:m.CancelFrozenCommand.id,type:I.MenuItemType.BUTTON,title:"rightClick.cancelFreeze",icon:"CancelFreezeIcon",hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function Pg(n){return{id:ti.id,type:I.MenuItemType.BUTTON,icon:"HideDoubleIcon",title:"rightClick.hideSelectedRow",disabled$:ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetSetRowStylePermission,m.WorksheetEditPermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]}),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function Og(n){return{id:ni.id,type:I.MenuItemType.BUTTON,icon:"HideDoubleIcon",title:"rightClick.hideSelectedColumn",disabled$:ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetSetColumnStylePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]}),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function Ag(n){const o=n.get(a.IUniverInstanceService),e=n.get(m.SheetsSelectionsService),t=n.get(a.ICommandService),i=[m.SetSelectionsOperation,m.SetRowHiddenMutation,m.SetRowVisibleMutation].map(r=>r.id);return{id:m.SetSelectedRowsVisibleCommand.id,type:I.MenuItemType.BUTTON,icon:"EyeOutlineIcon",title:"rightClick.showHideRow",hidden$:be(o,!0,({worksheet:r})=>new N.Observable(s=>{function l(){var u;const d=(u=e.getCurrentSelections())==null?void 0:u.map(h=>h.range).filter(h=>h.rangeType===a.RANGE_TYPE.ROW);return!!(d!=null&&d.some(h=>{for(let g=h.startRow;g<=h.endRow;g++)if(!r.getRowRawVisible(g))return!0;return!1}))}const c=t.onCommandExecuted(d=>{i.findIndex(u=>u===d.id)!==-1&&s.next(!l())});return s.next(!l()),()=>c.dispose()})),disabled$:ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetSetRowStylePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]})}}function Dg(n){const o=n.get(a.IUniverInstanceService),e=n.get(m.SheetsSelectionsService),t=n.get(a.ICommandService),i=[m.SetSelectionsOperation,m.SetColHiddenMutation,m.SetColVisibleMutation].map(r=>r.id);return{id:m.SetSelectedColsVisibleCommand.id,type:I.MenuItemType.BUTTON,icon:"EyeOutlineIcon",title:"rightClick.showHideColumn",hidden$:be(o,!0,({worksheet:r})=>new N.Observable(s=>{function l(){var u;const d=(u=e.getCurrentSelections())==null?void 0:u.map(h=>h.range).filter(h=>h.rangeType===a.RANGE_TYPE.COLUMN);return!d||d.length===0?!1:!!d.some(h=>{for(let g=h.startColumn;g<=h.endColumn;g++)if(!r.getColVisible(g))return!0;return!1})}const c=t.onCommandExecuted(d=>{i.findIndex(u=>u===d.id)!==-1&&s.next(!l())});return s.next(!l()),()=>c.dispose()})),disabled$:ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetSetColumnStylePermission,m.WorksheetEditPermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]})}}function Ng(n){const o=n.get(a.ICommandService),e=n.get(a.IUniverInstanceService),t=n.get(m.SheetsSelectionsService),i=2;return{id:m.SetRowHeightCommand.id,type:I.MenuItemType.BUTTON,icon:"AdjustHeightDoubleIcon",label:{name:Ze,props:{prefix:"rightClick.rowHeight",suffix:"px",min:i,max:1e3}},value$:be(e,i,({worksheet:r})=>new N.Observable(s=>{function l(){var h;const d=(h=t.getCurrentLastSelection())==null?void 0:h.primary,u=d?r.getRowHeight(d.startRow):r.getConfig().defaultRowHeight;s.next(u)}const c=o.onCommandExecuted(d=>{const u=d.id;if(u===m.SetRangeValuesMutation.id||u===m.SetSelectionsOperation.id||u===m.SetWorksheetRowIsAutoHeightMutation.id)return l()});return l(),c.dispose})),hidden$:ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetSetRowStylePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]})}}function kg(n){const o=n.get(a.ICommandService),e=n.get(a.IUniverInstanceService),t=n.get(m.SheetsSelectionsService),i=2;return{id:m.SetColWidthCommand.id,type:I.MenuItemType.BUTTON,icon:"AdjustWidthDoubleIcon",label:{name:Ze,props:{prefix:"rightClick.columnWidth",suffix:"px",min:i,max:1e3}},value$:be(e,i,({worksheet:r})=>new N.Observable(s=>{function l(){var h;const d=(h=t.getCurrentLastSelection())==null?void 0:h.primary,u=d?r.getColumnWidth(d.startColumn):r.getConfig().defaultColumnWidth;s.next(u)}const c=o.onCommandExecuted(d=>{const u=d.id;if(u===m.SetRangeValuesMutation.id||u===m.SetSelectionsOperation.id||u===m.SetWorksheetColWidthMutation.id)return l()});return l(),c.dispose})),hidden$:ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetSetColumnStylePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]})}}const vt={type:a.CommandType.COMMAND,id:"sheet.command.add-worksheet-merge",handler:async(n,o)=>{const e=n.get(a.ICommandService),t=n.get(a.IUndoRedoService),i=n.get(a.IUniverInstanceService),r=n.get(I.IConfirmService),s=n.get(a.LocaleService),l=o.unitId,c=o.subUnitId,d=o.selections,u=m.getAddMergeMutationRangeByType(d,o.value),h=i.getUniverSheetInstance(l).getSheetBySheetId(c),g=[],S=[],f=Ta(h,u);if(f&&!o.defaultMerge&&!await r.confirm({id:"merge.confirm.add-worksheet-merge",title:{title:"merge.confirm.warning"},children:{title:"merge.confirm.title"},cancelText:s.t("merge.confirm.cancel"),confirmText:s.t("merge.confirm.confirm")}))return!1;const v={unitId:l,subUnitId:c,ranges:a.Tools.deepClone(u)},p={unitId:l,subUnitId:c,ranges:a.Tools.deepClone(u)},C=m.RemoveMergeUndoMutationFactory(n,v),_=m.AddMergeUndoMutationFactory(n,p);if(C.ranges.length>0&&g.push({id:m.RemoveWorksheetMergeMutation.id,params:C}),g.push({id:m.AddWorksheetMergeMutation.id,params:p}),S.push({id:m.RemoveWorksheetMergeMutation.id,params:_}),C.ranges.length>0&&S.push({id:m.AddWorksheetMergeMutation.id,params:C}),f){const A=ya(n,l,h,u);g.unshift(...A.redos),S.push(...A.undos)}const w=m.AddMergeRedoSelectionsOperationFactory(n,o,u);w&&g.push(w);const E=m.AddMergeUndoSelectionsOperationFactory(n,o);E&&S.push(E);const T=n.get(m.SheetInterceptorService).onCommandExecute({id:vt.id,params:{unitId:l,subUnitId:c,ranges:u}});return g.push(...T.redos),S.push(...T.undos),a.sequenceExecute(g,e).result?(t.pushUndoRedo({unitID:l,undoMutations:S,redoMutations:g}),!0):!1}},Qr={type:a.CommandType.COMMAND,id:"sheet.command.add-worksheet-merge-all",handler:async n=>{var u;const o=n.get(a.ICommandService),t=(u=n.get(m.SheetsSelectionsService).getCurrentSelections())==null?void 0:u.map(h=>h.range),i=hr(Ki.MergeAll,t);if(!(i!=null&&i.length))return!1;const s=n.get(a.IUniverInstanceService).getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET);if(!s)return!1;const l=s.getActiveSheet();if(!l)return!1;const c=s.getUnitId(),d=l.getSheetId();return o.executeCommand(vt.id,{selections:i,unitId:c,subUnitId:d})}},Jr={type:a.CommandType.COMMAND,id:"sheet.command.add-worksheet-merge-vertical",handler:async n=>{var u;const o=n.get(a.ICommandService),t=(u=n.get(m.SheetsSelectionsService).getCurrentSelections())==null?void 0:u.map(h=>h.range),i=hr(Ki.MergeVertical,t);if(!(i!=null&&i.length))return!1;const s=n.get(a.IUniverInstanceService).getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET);if(!s)return!1;const l=s.getActiveSheet();if(!l)return!1;const c=s.getUnitId(),d=l.getSheetId();return o.executeCommand(vt.id,{value:a.Dimension.COLUMNS,selections:i,unitId:c,subUnitId:d})}},$r={type:a.CommandType.COMMAND,id:"sheet.command.add-worksheet-merge-horizontal",handler:async n=>{var u;const o=n.get(a.ICommandService),t=(u=n.get(m.SheetsSelectionsService).getCurrentSelections())==null?void 0:u.map(h=>h.range),i=hr(Ki.MergeHorizontal,t);if(!(i!=null&&i.length))return!1;const s=n.get(a.IUniverInstanceService).getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET);if(!s)return!1;const l=s.getActiveSheet();if(!l)return!1;const c=s.getUnitId(),d=l.getSheetId();return o.executeCommand(vt.id,{value:a.Dimension.ROWS,selections:i,unitId:c,subUnitId:d})}};function Hg(n){const o=n.get(m.SheetsSelectionsService),e=n.get(m.RangeProtectionRuleModel),t=n.get(a.IUniverInstanceService),i=n.get(m.MergeCellController),r=t.getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET);return N.combineLatest([o.selectionMoveEnd$,r.pipe(N.map(s=>{var l;return(l=s==null?void 0:s.getUnitId())!=null?l:""})),r.pipe(N.switchMap(s=>{var l;return(l=s==null?void 0:s.activeSheet$)!=null?l:N.of(null)}))]).pipe(N.map(([s,l,c])=>{if(!c||!s||s.length===0)return!1;const d=c.getSheetId(),u=s.map(S=>S.range);if(i.interceptor.fetchThroughInterceptors(m.MERGE_CELL_INTERCEPTOR_CHECK)(!1,u))return!0;const g=e.getSubunitRuleList(l,d).map(S=>S.ranges).flat();if(s.length<2){const S=s[0].range;return g.some(v=>a.Rectangle.intersects(v,S)&&!a.Rectangle.contains(v,S))}for(let S=0;S<s.length;S++)for(let f=S+1;f<s.length;f++)if(a.Rectangle.intersects(s[S].range,s[f].range))return!0;return!1}))}function Fl(n,o){return!!Pi(n,o,a.RANGE_TYPE.ROW)}function zl(n,o){return!!Pi(n,o,a.RANGE_TYPE.COLUMN)}function Pi(n,o,e){return n.find(i=>{const r=i.range,{startRow:s,endRow:l,startColumn:c,endColumn:d,rangeType:u}=r;return u===a.RANGE_TYPE.ALL||u===a.RANGE_TYPE.NORMAL?!1:u===e&&(e===a.RANGE_TYPE.COLUMN&&c<=o&&o<=d||e===a.RANGE_TYPE.ROW&&s<=o&&o<=l)})}function Vg(n){const o=ft(n,ee(n,{workbookTypes:[m.WorkbookEditablePermission],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetSetCellValuePermission,m.WorksheetSetCellStylePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint]})),e=Hg(n);return{id:vt.id,icon:"MergeAllIcon",tooltip:"toolbar.mergeCell.main",type:I.MenuItemType.SUBITEMS,hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET),disabled$:o.pipe(N.combineLatestWith(e),N.map(([t,i])=>t||i))}}function Wg(n){return{id:Qr.id,type:I.MenuItemType.BUTTON,title:"merge.all",icon:"MergeAllIcon",hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function Lg(n){return{id:Jr.id,type:I.MenuItemType.BUTTON,title:"merge.vertical",icon:"VerticalIntegrationIcon",hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function xg(n){return{id:$r.id,type:I.MenuItemType.BUTTON,title:"merge.horizontal",icon:"HorizontalMergeIcon",hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function Ug(n){return{id:m.RemoveWorksheetMergeCommand.id,type:I.MenuItemType.BUTTON,title:"merge.cancel",icon:"CancelMergeIcon",hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function Bg(n){const e=n.get(a.IUniverInstanceService).getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET),t=n.get(a.UserManagerService);return N.combineLatest([e,t.currentUser$]).pipe(N.switchMap(([i,r])=>i?i.activeSheet$.pipe(N.switchMap(s=>{if(!s)return N.of(!0);const l=n.get(m.RangeProtectionRuleModel),c=n.get(m.WorksheetProtectionRuleModel),d=n.get(m.SheetsSelectionsService);return N.merge(d.selectionMoveEnd$,l.ruleChange$,c.ruleChange$).pipe(N.map(()=>{const u=i.getUnitId(),h=s.getSheetId(),g=l.getSubunitRuleList(u,h),S=d.getCurrentSelections(),f=S==null?void 0:S.map(C=>C.range),v=g.map(C=>C.ranges).flat();if(!f)return!1;const p=c.getRule(u,h);return p!=null&&p.permissionId?!0:f==null?void 0:f.some(C=>v.some(_=>a.Rectangle.intersects(C,_)))}))})):N.of(!0)))}function Fg(n){const o=n.get(a.IUniverInstanceService),e=n.get(m.RangeProtectionRuleModel),t=o.getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET),i=n.get(a.UserManagerService);return N.combineLatest([t,i.currentUser$]).pipe(N.switchMap(([r,s])=>r?r.activeSheet$.pipe(N.switchMap(l=>{if(!l)return N.of(!0);const c=n.get(m.RangeProtectionRuleModel),d=n.get(m.WorksheetProtectionRuleModel),u=n.get(a.IPermissionService),h=n.get(m.SheetsSelectionsService);return N.merge(h.selectionMoveEnd$,c.ruleChange$,d.ruleChange$).pipe(N.map(()=>{var A,D;const g=r.getUnitId(),S=l.getSheetId(),f=e.getSubunitRuleList(g,S),v=(A=h.getCurrentSelections())==null?void 0:A.map(k=>k.range);if(f.map(k=>k.ranges).flat(),!(v!=null&&v.length)||v.length>1)return!0;const p=v[0];if((p==null?void 0:p.rangeType)===a.RANGE_TYPE.ALL||(p==null?void 0:p.rangeType)===a.RANGE_TYPE.COLUMN||(p==null?void 0:p.rangeType)===a.RANGE_TYPE.ROW)return!0;const C=d.getRule(g,S);if(C!=null&&C.permissionId)return((D=u.getPermissionPoint(new m.WorksheetManageCollaboratorPermission(g,S).id))==null?void 0:D.value)===!1;if(f.filter(k=>k.ranges.some(H=>a.Rectangle.intersects(H,p))).length!==1)return!0;const{startRow:w,endRow:E,startColumn:O,endColumn:T}=p,P=n.get(m.RangeProtectionCache);for(let k=w;k<=E;k++)for(let H=O;H<=T;H++){const V=P.getCellInfo(g,S,k,H);if(V)return V[m.UnitAction.ManageCollaborator]===!1}return!1}))})):N.of(!0)))}function zg(n){const o=n.get(a.IUniverInstanceService),e=n.get(a.IPermissionService),t=o.getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET),i=n.get(a.UserManagerService);return N.combineLatest([t,i.currentUser$]).pipe(N.switchMap(([r,s])=>r?r.activeSheet$.pipe(N.switchMap(l=>{var f;if(!l)return N.of(!0);const c=r.getUnitId(),d=n.get(m.SheetsSelectionsService),u=n.get(m.RangeProtectionRuleModel),h=n.get(m.WorksheetProtectionRuleModel),g=(f=e.composePermission$([new m.WorkbookEditablePermission(c).id]).pipe(N.map(v=>v.every(p=>p.value))))!=null?f:N.of(!1),S=N.merge(u.ruleChange$,h.ruleChange$).pipe(N.startWith(null));return N.combineLatest([g,S,d.selectionMoveEnd$]).pipe(N.map(([v,p,C])=>{if(!v)return!0;const _=d.getCurrentSelections(),w=_==null?void 0:_.map(E=>E.range);return w!=null&&w.length?w.length>1:!1}))})):N.of(!0)))}function Xl(n){var d;const o=n.get(a.IUniverInstanceService),e=n.get(a.IPermissionService),t=o.getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET),i=n.get(a.UserManagerService),r=n.has(me)?n.get(me):null,l=n.get(a.IContextService).subscribeContextValue$(a.FOCUSING_FX_BAR_EDITOR).pipe(N.startWith(!1),N.shareReplay(1)),c=(d=r==null?void 0:r.visible$.pipe(N.startWith(null),N.shareReplay(1)))!=null?d:N.of(null);return N.combineLatest([t,i.currentUser$,c,l]).pipe(N.switchMap(([u,h,g,S])=>!u||g!=null&&g.visible&&g.unitId===u.getUnitId()||S?N.of(!0):u.activeSheet$.pipe(N.switchMap(f=>{var A;if(!f)return N.of(!0);const p=n.get(a.IContextService).subscribeContextValue$(a.FOCUSING_COMMON_DRAWINGS).pipe(N.startWith(!1)),C=u.getUnitId(),_=f.getSheetId(),w=n.get(m.RangeProtectionRuleModel),E=n.get(m.WorksheetProtectionRuleModel),O=n.get(m.SheetsSelectionsService),T=(A=e.composePermission$([new m.WorkbookCreateProtectPermission(C).id]).pipe(N.map(D=>D.every(k=>k.value))))!=null?A:N.of(!1),P=N.merge(w.ruleChange$,E.ruleChange$).pipe(N.startWith(null));return N.combineLatest([T,P,O.selectionMoveEnd$,p]).pipe(N.map(([D,k,H,V])=>{if(!D||V)return!0;const L=O.getCurrentSelections(),W=L==null?void 0:L.map(F=>F.range);if(!(W!=null&&W.length))return!0;const B=E.getRule(C,_);if(B!=null&&B.permissionId)return!0;const U=w.getSubunitRuleList(C,_);return W==null?void 0:W.some(F=>U.some(j=>j.ranges.some(Y=>a.Rectangle.intersects(F,Y))))}))}))))}function Xg(n){const o=n.get(a.IUniverInstanceService),e=n.get(a.IPermissionService),t=o.getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET),i=n.get(a.UserManagerService);return N.combineLatest([t,i.currentUser$]).pipe(N.switchMap(([r,s])=>r?r.activeSheet$.pipe(N.switchMap(l=>{var f;if(!l)return N.of(!0);const c=r.getUnitId(),d=l.getSheetId(),u=n.get(m.RangeProtectionRuleModel),h=n.get(m.WorksheetProtectionRuleModel),g=(f=e.composePermission$([new m.WorkbookCreateProtectPermission(c).id]).pipe(N.map(v=>v.every(p=>p.value))))!=null?f:N.of(!1),S=N.merge(u.ruleChange$,h.ruleChange$).pipe(N.startWith(null));return N.combineLatest([g,S]).pipe(N.map(([v,p])=>{var w;if(!v)return!0;const C=h.getRule(c,d);return C!=null&&C.permissionId?!0:((w=u.getSubunitRuleList(c,d))==null?void 0:w.filter(E=>E==null?void 0:E.permissionId)).length>0}))})):N.of(!0)))}function Yg(n){const o=n.get(a.IUniverInstanceService),e=n.get(a.IPermissionService),t=o.getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET),i=n.get(a.UserManagerService);return N.combineLatest([t,i.currentUser$]).pipe(N.switchMap(([r,s])=>r?r.activeSheet$.pipe(N.switchMap(l=>{if(!l)return N.of(!0);const c=r.getUnitId(),d=l.getSheetId(),u=n.get(m.WorksheetProtectionRuleModel);return u.ruleChange$.pipe(N.startWith(null)).pipe(N.map(()=>{var g;return u.getRule(c,d)?((g=e.getPermissionPoint(new m.WorksheetDeleteProtectionPermission(c,d).id))==null?void 0:g.value)===!1:!0}))})):N.of(!0)))}function jg(n){const o=n.get(a.IUniverInstanceService),e=n.get(a.IPermissionService),t=o.getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET),i=n.get(a.UserManagerService);return N.combineLatest([t,i.currentUser$]).pipe(N.switchMap(([r,s])=>r?r.activeSheet$.pipe(N.switchMap(l=>{var f;if(!l)return N.of(!0);const c=r.getUnitId(),d=n.get(m.RangeProtectionRuleModel),u=n.get(m.WorksheetProtectionRuleModel),h=(f=e.composePermission$([new m.WorkbookCreateProtectPermission(c).id,new m.WorkbookManageCollaboratorPermission(c).id]).pipe(N.map(v=>v.every(p=>p.value))))!=null?f:N.of(!1),g=u.ruleChange$.pipe(N.startWith(null)),S=d.ruleChange$.pipe(N.startWith(null));return N.combineLatest([h,g,S]).pipe(N.map(([v,p,C])=>{if(!v)return!0;const _=l.getSheetId(),w=u.getRule(c,_),E=d.getSubunitRuleList(c,_);return!(w||E.length)}))})):N.of(!0)))}function Zg(n){const o=n.get(a.IUniverInstanceService),e=n.get(a.IPermissionService),t=o.getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET),i=n.get(a.UserManagerService);return N.combineLatest([t,i.currentUser$]).pipe(N.switchMap(([r,s])=>r?r.activeSheet$.pipe(N.switchMap(l=>{if(!l)return N.of(!0);const c=r.getUnitId(),d=l.getSheetId(),u=n.get(m.SheetsSelectionsService),h=n.get(m.RangeProtectionRuleModel),g=n.get(m.WorksheetProtectionRuleModel),S=N.merge(h.ruleChange$,g.ruleChange$,u.selectionMoveEnd$).pipe(N.startWith(null));return N.combineLatest([S]).pipe(N.map(([f])=>{var D;const v=n.get(m.SheetsSelectionsService).getCurrentSelections(),p=v==null?void 0:v.map(k=>k.range);if(!(p!=null&&p.length)||p.length>1)return!0;const C=p[0];if((C==null?void 0:C.rangeType)===a.RANGE_TYPE.ALL||(C==null?void 0:C.rangeType)===a.RANGE_TYPE.COLUMN||(C==null?void 0:C.rangeType)===a.RANGE_TYPE.ROW)return!0;const _=g.getRule(c,d);if(_!=null&&_.permissionId)return((D=e.getPermissionPoint(new m.WorksheetDeleteProtectionPermission(c,d).id))==null?void 0:D.value)===!1;if(h.getSubunitRuleList(c,d).filter(k=>k.ranges.some(H=>a.Rectangle.intersects(H,C))).length!==1)return!0;const{startRow:E,endRow:O,startColumn:T,endColumn:P}=C,A=n.get(m.RangeProtectionCache);for(let k=E;k<=O;k++)for(let H=T;H<=P;H++){const V=A.getCellInfo(c,d,k,H);if(V)return V[m.UnitAction.Delete]===!1}return!1}))})):N.of(!0)))}function Yl(n){var d;const o=n.get(a.IUniverInstanceService),e=n.get(a.IPermissionService),t=o.getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET),i=n.get(a.UserManagerService),r=n.has(me)?n.get(me):null,l=n.get(a.IContextService).subscribeContextValue$(a.FOCUSING_FX_BAR_EDITOR),c=(d=r==null?void 0:r.visible$)!=null?d:N.of(null);return N.combineLatest([t,i.currentUser$,c,l]).pipe(N.switchMap(([u,h,g,S])=>!u||g!=null&&g.visible&&g.unitId===u.getUnitId()||S?N.of(!0):u.activeSheet$.pipe(N.switchMap(f=>{var C,_;if(!f)return N.of(!0);const v=u.getUnitId();return((_=(C=e.getPermissionPoint$(new m.WorkbookEditablePermission(v).id))==null?void 0:C.pipe(N.map(w=>!!w.value)))!=null?_:N.of(!1)).pipe(N.map(w=>!w))}))))}const Co="sheet.contextMenu.permission";function Gg(n){return{id:si.id,type:I.MenuItemType.BUTTON,icon:Ia,tooltip:"permission.toolbarMenu",hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET),disabled$:Xl(n)}}function es(n){return{id:Co,type:I.MenuItemType.SUBITEMS,title:"rightClick.protectRange",icon:_a,hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function ts(n){return{id:Vt.id,type:I.MenuItemType.BUTTON,title:"rightClick.turnOnProtectRange",hidden$:Bg(n),disabled$:Xl(n)}}function ns(n){return{id:xt.id,type:I.MenuItemType.BUTTON,title:"rightClick.editProtectRange",disabled$:zg(n),hidden$:Fg(n)}}function is(n){return{id:Lt.id,type:I.MenuItemType.BUTTON,title:"rightClick.removeProtectRange",disabled$:Zg(n),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function os(n){return{id:Wt.id,type:I.MenuItemType.BUTTON,title:"rightClick.viewAllProtectArea",disabled$:Yl(n),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function Kg(n){return{id:ai.id,type:I.MenuItemType.BUTTON,title:"sheetConfig.addProtectSheet",disabled$:Xg(n),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function qg(n){return{id:Ci.id,type:I.MenuItemType.BUTTON,title:"sheetConfig.removeProtectSheet",disabled$:Yg(n),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function Qg(n){return{id:Ii.id,type:I.MenuItemType.BUTTON,title:"sheetConfig.changeSheetPermission",disabled$:jg(n),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function Jg(n){return{id:li.id,type:I.MenuItemType.BUTTON,title:"sheetConfig.viewAllProtectArea",disabled$:Yl(n),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function $g(n){const o=n.get(a.IUniverInstanceService),e=n.get(a.ICommandService),t=new N.Observable(r=>{const s=e.onCommandExecuted(l=>{const c=l.id;(c===m.RemoveSheetMutation.id||c===m.InsertSheetMutation.id||c===m.SetWorksheetHideMutation.id)&&Io(o,r)});return Io(o,r),s.dispose}),i=An(n,[m.WorkbookEditablePermission,m.WorkbookDeleteSheetPermission]);return{id:di.id,type:I.MenuItemType.BUTTON,title:"sheetConfig.delete",disabled$:N.combineLatest([t,i]).pipe(N.map(([r,s])=>r||s)),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function eS(n){return{id:m.CopySheetCommand.id,type:I.MenuItemType.BUTTON,title:"sheetConfig.copy",disabled$:An(n,[m.WorkbookEditablePermission,m.WorkbookCreateSheetPermission]),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function tS(n){return{id:bi.id,type:I.MenuItemType.BUTTON,title:"sheetConfig.rename",disabled$:An(n,[m.WorkbookEditablePermission,m.WorkbookRenameSheetPermission]),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function nS(n){return{id:m.SetTabColorCommand.id,title:"sheetConfig.changeColor",type:I.MenuItemType.SELECTOR,selections:[{label:{name:I.COLOR_PICKER_COMPONENT,hoverable:!1}}],hidden$:An(n,[m.WorkbookEditablePermission])}}function iS(n){const o=n.get(a.IUniverInstanceService),e=n.get(a.ICommandService);return{id:m.SetWorksheetHideCommand.id,type:I.MenuItemType.BUTTON,title:"sheetConfig.hide",disabled$:new N.Observable(t=>{const i=e.onCommandExecuted(r=>{const s=r.id;(s===m.RemoveSheetMutation.id||s===m.InsertSheetMutation.id||s===m.SetWorksheetHideMutation.id)&&Io(o,t)});return Io(o,t),i.dispose}).pipe(N.combineLatestWith(An(n,[m.WorkbookEditablePermission,m.WorkbookHideSheetPermission])),N.map(([t,i])=>t||i)),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function oS(n){const o=n.get(a.IUniverInstanceService),e=n.get(a.ICommandService);return{id:pi.id,type:I.MenuItemType.BUTTON,title:"sheetConfig.unhide",disabled$:new N.Observable(t=>{function i(){const s=o.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET).getWorksheets(),l=Array.from(s.values());t.next(l.length===1)}const r=e.onCommandExecuted(s=>{const l=s.id;(l===m.RemoveSheetMutation.id||l===m.InsertSheetMutation.id||l===m.SetWorksheetHideMutation.id)&&i()});return i(),r.dispose}).pipe(N.combineLatestWith(An(n,[m.WorkbookEditablePermission,m.WorkbookHideSheetPermission])),N.map(([t,i])=>t||i)),hidden$:I.getMenuHiddenObservable(n,a.UniverInstanceType.UNIVER_SHEET)}}function Io(n,o){const e=n.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET).getWorksheets(),t=Array.from(e.values()).filter(i=>i.getConfig().hidden===a.BooleanNumber.FALSE);o.next(t.length===1)}const jl={[I.RibbonPosition.START]:{[I.RibbonStartGroup.HISTORY]:{[fn.id]:{order:2,menuItemFactory:dg},[m.ClearSelectionAllCommand.id]:{order:3,menuItemFactory:po}},[I.RibbonStartGroup.FORMAT]:{[dn.id]:{order:1,menuItemFactory:Sg},[ii.id]:{order:2,menuItemFactory:Qm},[qi.id]:{order:2.1,menuItemFactory:Jm},[Qi.id]:{order:2.2,menuItemFactory:$m},[Ot.id]:{order:5,menuItemFactory:ug},[At.id]:{order:6,menuItemFactory:hg},[Dt.id]:{order:7,menuItemFactory:mg},[Nt.id]:{order:8,menuItemFactory:gg},[un.id]:{order:9,menuItemFactory:vg,[m.ResetTextColorCommand.id]:{order:0,menuItemFactory:fg}},[m.SetBackgroundColorCommand.id]:{order:10,menuItemFactory:Cg,[m.ResetBackgroundColorCommand.id]:{order:0,menuItemFactory:pg}},[m.SetBorderBasicCommand.id]:{order:11,menuItemFactory:jm}},[I.RibbonStartGroup.LAYOUT]:{[m.SetHorizontalTextAlignCommand.id]:{order:0,menuItemFactory:Ig},[m.SetVerticalTextAlignCommand.id]:{order:3,menuItemFactory:_g},[m.SetTextWrapCommand.id]:{order:6,menuItemFactory:bg},[m.SetTextRotationCommand.id]:{order:7,menuItemFactory:wg},[m.AddWorksheetMergeCommand.id]:{order:8,menuItemFactory:Vg,[m.AddWorksheetMergeAllCommand.id]:{order:0,menuItemFactory:Wg},[m.AddWorksheetMergeVerticalCommand.id]:{order:1,menuItemFactory:Lg},[m.AddWorksheetMergeHorizontalCommand.id]:{order:2,menuItemFactory:xg},[m.RemoveWorksheetMergeCommand.id]:{order:3,menuItemFactory:Ug}}},[I.RibbonStartGroup.OTHERS]:{[si.id]:{order:0,menuItemFactory:Gg}}},[I.ContextMenuPosition.MAIN_AREA]:{[I.ContextMenuGroup.FORMAT]:{[Ve.name]:{order:0,menuItemFactory:Dn},[ht.name]:{order:1,menuItemFactory:Ur},[We.name]:{order:2,menuItemFactory:Br},[Ri]:{order:2.5,menuItemFactory:Fr},[Mi]:{order:3,menuItemFactory:zr,[sn.id]:{order:0,menuItemFactory:Xr},[an.id]:{order:1,menuItemFactory:Yr},[Rt.id]:{order:2,menuItemFactory:jr},[ln.id]:{order:3,menuItemFactory:Zr}},[vo]:{order:4,menuItemFactory:Wr,[m.ClearSelectionContentCommand.id]:{order:0,menuItemFactory:Lr},[m.ClearSelectionFormatCommand.id]:{order:1,menuItemFactory:xr},[m.ClearSelectionAllCommand.id]:{order:2,menuItemFactory:po}}},[I.ContextMenuGroup.LAYOUT]:{order:1,[kl]:{order:0,menuItemFactory:tg,[m.InsertRowBeforeCommand.id]:{order:0,menuItemFactory:ng},[m.InsertColBeforeCommand.id]:{order:1,menuItemFactory:ig},[hn.id]:{order:2,menuItemFactory:og},[kt.id]:{order:3,menuItemFactory:rg}},[Ol]:{order:0,menuItemFactory:Zm,[gn.id]:{order:0,menuItemFactory:Al},[mn.id]:{order:1,menuItemFactory:Dl},[cn.id]:{order:2,menuItemFactory:Gm},[Mt.id]:{order:3,menuItemFactory:Km}},[Ul]:{order:2,menuItemFactory:yg,[$e.id]:{order:0,menuItemFactory:Kr},[mi.id]:{order:1,menuItemFactory:Rg},[gi.id]:{order:2,menuItemFactory:Mg},[m.CancelFrozenCommand.id]:{order:3,menuItemFactory:qr}},[Co]:{order:3,menuItemFactory:es,[Vt.id]:{order:0,menuItemFactory:ts},[xt.id]:{order:1,menuItemFactory:ns},[Lt.id]:{order:2,menuItemFactory:is},[Wt.id]:{order:3,menuItemFactory:os}}},[I.ContextMenuGroup.DATA]:{order:2},[I.ContextMenuGroup.OTHERS]:{order:3}},[I.ContextMenuPosition.COL_HEADER]:{[I.ContextMenuGroup.FORMAT]:{[Ve.name]:{order:0,menuItemFactory:Dn},[ht.name]:{order:1,menuItemFactory:Ur},[We.name]:{order:2,menuItemFactory:Br},[Ri]:{order:2.5,menuItemFactory:Fr},[Mi]:{order:3,menuItemFactory:zr,[sn.id]:{order:0,menuItemFactory:Xr},[an.id]:{order:1,menuItemFactory:Yr},[Rt.id]:{order:2,menuItemFactory:jr},[ln.id]:{order:3,menuItemFactory:Zr}},[vo]:{order:4,menuItemFactory:Wr,[m.ClearSelectionContentCommand.id]:{order:0,menuItemFactory:Lr},[m.ClearSelectionFormatCommand.id]:{order:1,menuItemFactory:xr},[m.ClearSelectionAllCommand.id]:{order:2,menuItemFactory:po}}},[I.ContextMenuGroup.LAYOUT]:{order:1,[m.InsertMultiColsLeftCommand.id]:{order:0,menuItemFactory:lg},[m.InsertMultiColsRightCommand.id]:{order:0,menuItemFactory:cg},[ni.id]:{order:1,menuItemFactory:Og},[m.SetSelectedColsVisibleCommand.id]:{order:2,menuItemFactory:Dg},[gn.id]:{order:2,menuItemFactory:Al},[m.SetColWidthCommand.id]:{order:3,menuItemFactory:kg},[In.id]:{order:4,menuItemFactory:Tg},[Gr]:{order:5,menuItemFactory:Bl,[$e.id]:{order:0,menuItemFactory:Kr},[m.CancelFrozenCommand.id]:{order:3,menuItemFactory:qr}},[Co]:{order:6,menuItemFactory:es,[Vt.id]:{order:0,menuItemFactory:ts},[xt.id]:{order:1,menuItemFactory:ns},[Lt.id]:{order:2,menuItemFactory:is},[Wt.id]:{order:3,menuItemFactory:os}}},[I.ContextMenuGroup.DATA]:{order:2},[I.ContextMenuGroup.OTHERS]:{order:3}},[I.ContextMenuPosition.ROW_HEADER]:{[I.ContextMenuGroup.FORMAT]:{[Ve.name]:{order:0,menuItemFactory:Dn},[ht.name]:{order:1,menuItemFactory:Ur},[We.name]:{order:2,menuItemFactory:Br},[Ri]:{order:2.5,menuItemFactory:Fr},[Mi]:{order:3,menuItemFactory:zr,[sn.id]:{order:0,menuItemFactory:Xr},[an.id]:{order:1,menuItemFactory:Yr},[Rt.id]:{order:2,menuItemFactory:jr},[ln.id]:{order:3,menuItemFactory:Zr}},[vo]:{order:4,menuItemFactory:Wr,[m.ClearSelectionContentCommand.id]:{order:0,menuItemFactory:Lr},[m.ClearSelectionFormatCommand.id]:{order:1,menuItemFactory:xr},[m.ClearSelectionAllCommand.id]:{order:2,menuItemFactory:po}}},[I.ContextMenuGroup.LAYOUT]:{order:1,[m.InsertMultiRowsAboveCommand.id]:{order:0,menuItemFactory:ag},[m.InsertMultiRowsAfterCommand.id]:{order:1,menuItemFactory:sg},[mn.id]:{order:1,menuItemFactory:Dl},[ti.id]:{order:2,menuItemFactory:Pg},[m.SetSelectedRowsVisibleCommand.id]:{order:2,menuItemFactory:Ag},[m.SetRowHeightCommand.id]:{order:3,menuItemFactory:Ng},[m.SetWorksheetRowIsAutoHeightCommand.id]:{order:4,menuItemFactory:Eg},[Gr]:{order:5,menuItemFactory:Bl,[$e.id]:{order:0,menuItemFactory:Kr},[m.CancelFrozenCommand.id]:{order:3,menuItemFactory:qr}},[Co]:{order:6,menuItemFactory:es,[Vt.id]:{order:0,menuItemFactory:ts},[xt.id]:{order:1,menuItemFactory:ns},[Lt.id]:{order:2,menuItemFactory:is},[Wt.id]:{order:3,menuItemFactory:os}}},[I.ContextMenuGroup.DATA]:{order:2},[I.ContextMenuGroup.OTHERS]:{order:3}},[I.ContextMenuPosition.FOOTER_TABS]:{[I.ContextMenuGroup.OTHERS]:{order:0,[di.id]:{order:0,menuItemFactory:$g},[m.CopySheetCommand.id]:{order:1,menuItemFactory:eS},[bi.id]:{order:2,menuItemFactory:tS},[m.SetTabColorCommand.id]:{order:3,menuItemFactory:nS},[m.SetWorksheetHideCommand.id]:{order:4,menuItemFactory:iS},[pi.id]:{order:6,menuItemFactory:oS},[ai.id]:{order:7,menuItemFactory:Kg},[Ci.id]:{order:8,menuItemFactory:qg},[Ii.id]:{order:9,menuItemFactory:Qg},[li.id]:{order:10,menuItemFactory:Jg}}},[I.ContextMenuPosition.FOOTER_MENU]:{[I.ContextMenuGroup.OTHERS]:{[m.ToggleGridlinesCommand.id]:{order:1,menuItemFactory:eg}}}},rs="UNIVER_SHEET_PERMISSION_ALERT_DIALOG_ID",Zl="UNIVER_SHEET_PERMISSION_ALERT_DIALOG";var rS=Object.getOwnPropertyDescriptor,sS=(n,o,e,t)=>{for(var i=t>1?void 0:t?rS(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},nt=(n,o)=>(e,t)=>o(e,t,n);y.SheetPermissionCheckUIController=class extends a.Disposable{constructor(e,t,i,r,s,l,c,d,u){super();R(this,"disposableCollection",new a.DisposableCollection);this._commandService=e,this._univerInstanceService=t,this._permissionService=i,this._dialogService=r,this._rangeProtectionRuleModel=s,this._autoFillService=l,this._localeService=c,this._contextService=d,this._sheetPermissionCheckController=u,this._initialize(),this._initUIEvent()}_initUIEvent(){this.disposeWithMe(this._sheetPermissionCheckController.triggerPermissionUIEvent$.subscribe(e=>{this._haveNotPermissionHandle(e)}))}_haveNotPermissionHandle(e){const t={id:rs,title:{title:"permission.dialog.alert"},children:{label:Zl,errorMsg:e},width:320,destroyOnClose:!0,showOk:!0,onClose:()=>{this._dialogService.close(rs)},onOk:()=>{this._dialogService.close(rs)},className:"sheet-permission-user-dialog"};this._permissionService.getShowComponents()&&this._dialogService.open(t)}_getPermissionCheck(e,t){var s,l;let i=!0,r="";switch(e){case q.InsertCommand.id:case q.IMEInputCommand.id:if(this._contextService.getContextValue(a.FOCUSING_EDITOR_STANDALONE)===!0||this._contextService.getContextValue(a.FOCUSING_COMMENT_EDITOR)===!0)break;i=this._sheetPermissionCheckController.permissionCheckWithoutRange({workbookTypes:[m.WorkbookEditablePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint],worksheetTypes:[m.WorksheetSetCellValuePermission,m.WorksheetEditPermission]}),r=this._localeService.t("permission.dialog.editErr");break;case Se.id:if(t.visible===!1)break;i=this._sheetPermissionCheckController.permissionCheckWithoutRange({workbookTypes:[m.WorkbookEditablePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint],worksheetTypes:[m.WorksheetSetCellValuePermission,m.WorksheetEditPermission]}),r=this._localeService.t("permission.dialog.editErr");break;case Rt.id:i=this._sheetPermissionCheckController.permissionCheckWithoutRange({workbookTypes:[m.WorkbookEditablePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetSetColumnStylePermission]}),r=this._localeService.t("permission.dialog.pasteErr");break;case Gi.id:i=this._permissionCheckByPaste(t),r=this._localeService.t("permission.dialog.pasteErr");break;case hi.id:i=this._sheetPermissionCheckController.permissionCheckWithRanges({workbookTypes:[m.WorkbookEditablePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint],worksheetTypes:[m.WorksheetEditPermission,m.WorksheetSetCellValuePermission,m.WorksheetSetCellStylePermission]}),r=this._localeService.t("permission.dialog.commonErr");break;case m.SetBackgroundColorCommand.id:case Ot.id:case At.id:case Dt.id:case Nt.id:i=this._sheetPermissionCheckController.permissionCheckWithRanges({workbookTypes:[m.WorkbookEditablePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint],worksheetTypes:[m.WorksheetSetCellStylePermission,m.WorksheetEditPermission]}),r=this._localeService.t("permission.dialog.setStyleErr");break;case Ve.id:i=this._sheetPermissionCheckController.permissionCheckWithRanges({workbookTypes:[m.WorkbookCopyPermission],rangeTypes:[m.RangeProtectionPermissionViewPoint],worksheetTypes:[m.WorksheetCopyPermission]}),r=this._localeService.t("permission.dialog.copyErr"),(s=this._permissionService.getPermissionPoint(new m.WorkbookCopyPermission(this._univerInstanceService.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET).getUnitId()).id))!=null&&s.value||(r=this._localeService.t("permission.dialog.workbookCopyErr"));break;case ht.id:i=this._sheetPermissionCheckController.permissionCheckWithRanges({workbookTypes:[m.WorkbookCopyPermission,m.WorkbookEditablePermission],rangeTypes:[m.RangeProtectionPermissionViewPoint,m.RangeProtectionPermissionEditPoint],worksheetTypes:[m.WorksheetCopyPermission,m.WorksheetEditPermission]}),r=this._localeService.t("permission.dialog.copyErr"),(l=this._permissionService.getPermissionPoint(new m.WorkbookCopyPermission(this._univerInstanceService.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET).getUnitId()).id))!=null&&l.value||(r=this._localeService.t("permission.dialog.workbookCopyErr"));break;case dt.id:i=this._permissionCheckByAutoFillCommand(t),r=this._localeService.t("permission.dialog.autoFillErr");break}i||this._sheetPermissionCheckController.blockExecuteWithoutPermission(r)}_initialize(){this._commandExecutedListener()}_commandExecutedListener(){this.disposeWithMe(this._commandService.beforeCommandExecuted(e=>{this._getPermissionCheck(e.id,e==null?void 0:e.params)}))}_permissionCheckByPaste(e){return e.value===ge.SPECIAL_PASTE_VALUE||e.value===ge.SPECIAL_PASTE_FORMULA?this._sheetPermissionCheckController.permissionCheckWithRanges({workbookTypes:[m.WorkbookEditablePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint],worksheetTypes:[m.WorksheetSetCellStylePermission,m.WorksheetEditPermission]}):e.value===ge.SPECIAL_PASTE_FORMAT?this._sheetPermissionCheckController.permissionCheckWithRanges({workbookTypes:[m.WorkbookEditablePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint],worksheetTypes:[m.WorksheetSetCellStylePermission,m.WorksheetEditPermission]}):this._sheetPermissionCheckController.permissionCheckWithRanges({workbookTypes:[m.WorkbookEditablePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint],worksheetTypes:[m.WorksheetSetCellValuePermission,m.WorksheetSetCellStylePermission,m.WorksheetEditPermission]})}_permissionCheckByAutoFillCommand(e){if(!e)return!1;const{targetRange:t}=e,i=m.getSheetCommandTarget(this._univerInstanceService);if(!i)return!1;const{worksheet:r,unitId:s,subUnitId:l}=i;return!this._rangeProtectionRuleModel.getSubunitRuleList(s,l).reduce((u,h)=>[...u,...h.ranges],[]).filter(u=>a.Rectangle.intersects(u,t)).some(u=>{var h,g;for(let S=u.startRow;S<=u.endRow;S++)for(let f=u.startColumn;f<=u.endColumn;f++){const v=(g=(h=r.getCell(S,f))==null?void 0:h.selectionProtection)==null?void 0:g[0];if((v==null?void 0:v[$.Edit])===!1)return!0}return!1})}},y.SheetPermissionCheckUIController=sS([nt(0,a.ICommandService),nt(1,a.IUniverInstanceService),nt(2,a.IPermissionService),nt(3,I.IDialogService),nt(4,a.Inject(m.RangeProtectionRuleModel)),nt(5,ct),nt(6,a.Inject(a.LocaleService)),nt(7,a.IContextService),nt(8,a.Inject(m.SheetPermissionCheckController))],y.SheetPermissionCheckUIController);var aS=Object.getOwnPropertyDescriptor,lS=(n,o,e,t)=>{for(var i=t>1?void 0:t?aS(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Zt=(n,o)=>(e,t)=>o(e,t,n);const cS="__SpreadsheetFreezeRowMainName__",dS="__SpreadsheetFreezeRowHeaderName__",uS="__SpreadsheetFreezeColumnMainName__",hS="__SpreadsheetFreezeColumnHeaderName__",ss=2,mS=.01,Oi=a.createInterceptorKey("freezePermissionCheck");y.HeaderFreezeRenderController=class extends a.Disposable{constructor(e,t,i,r,s,l,c,d){super();R(this,"_rowFreezeHeaderRect");R(this,"_rowFreezeMainRect");R(this,"_columnFreezeHeaderRect");R(this,"_columnFreezeMainRect");R(this,"_freezeDownSubs");R(this,"_freezePointerEnterSubs");R(this,"_freezePointerLeaveSubs");R(this,"_scenePointerMoveSub");R(this,"_scenePointerUpSub");R(this,"_changeToRow",-1);R(this,"_changeToColumn",-1);R(this,"_changeToOffsetX",0);R(this,"_changeToOffsetY",0);R(this,"_activeViewport",null);R(this,"_freezeNormalHeaderColor","");R(this,"_freezeNormalMainColor","");R(this,"_freezeActiveColor","");R(this,"_freezeHoverColor","");R(this,"_lastFreeze");R(this,"interceptor",new a.InterceptorManager({FREEZE_PERMISSION_CHECK:Oi}));this._context=e,this._sheetSkeletonManagerService=t,this._commandService=i,this._selectionManagerService=r,this._scrollManagerService=s,this._themeService=l,this._sheetInterceptorService=c,this._injector=d,this._initialize()}dispose(){super.dispose()}_initialize(){this._skeletonListener(),this._commandExecutedListener(),this._themeChangeListener(),this._interceptorCommands(),this._bindViewportScroll(),this._zoomRefresh()}_createFreeze(e=0,t){var A;const i=t!=null?t:this._getFreeze();if(i==null)return null;const r=(A=this._sheetSkeletonManagerService.getCurrentParam())==null?void 0:A.skeleton,{startRow:s,startColumn:l}=i,c=this._getPositionByIndex(s,l);if(c==null||r==null)return null;const d=this._getSheetObject(),u=d.engine,h=(u==null?void 0:u.width)||0,g=(u==null?void 0:u.height)||0,S=d.scene,{startX:f,startY:v}=c,{rowTotalHeight:p,columnTotalWidth:C,rowHeaderWidthAndMarginLeft:_,columnHeaderHeightAndMarginTop:w}=r,E=h>C+_?h:C+w,O=g>p+w?g:p+w;this._changeToRow=s,this._changeToColumn=l,this._changeToOffsetX=f,this._changeToOffsetY=v;const T=Math.max(S.scaleX,S.scaleY);let P=ss/Math.max(1,T);if(e===0){(s===-1||s===0)&&(P=P*2);const D=P;this._rowFreezeHeaderRect=new M.Rect(dS,{fill:this._freezeNormalHeaderColor,width:_,height:P,left:0,top:v-D,zIndex:3});let k=this._freezeNormalHeaderColor;(s===-1||s===0)&&(k=this._freezeNormalMainColor),this._rowFreezeMainRect=new M.Rect(cS,{fill:k,width:E*2/T,height:P,left:_,top:v-D,zIndex:3}),S.addObjects([this._rowFreezeHeaderRect,this._rowFreezeMainRect],st)}else{(l===-1||l===0)&&(P=P*2);const D=P;this._columnFreezeHeaderRect=new M.Rect(hS,{fill:this._freezeNormalHeaderColor,width:P,height:w,left:f-D,top:0,zIndex:3});let k=this._freezeNormalHeaderColor;(l===-1||l===0)&&(k=this._freezeNormalMainColor),this._columnFreezeMainRect=new M.Rect(uS,{fill:k,width:P,height:O*2/T,left:f-D,top:w,zIndex:3}),S.addObjects([this._columnFreezeHeaderRect,this._columnFreezeMainRect],st)}this._eventBinding(e)}_eventBinding(e=0){let t=this._rowFreezeHeaderRect,i=this._rowFreezeMainRect;e===1&&(t=this._columnFreezeHeaderRect,i=this._columnFreezeMainRect);const r=this._getSheetObject();if(r==null)return;const{scene:s}=r;if(this._freezePointerEnterSubs=new N.Subscription,this._freezePointerLeaveSubs=new N.Subscription,this._freezeDownSubs=new N.Subscription,i){const d=i.onPointerEnter$.subscribeEvent(()=>{if(!this.interceptor.fetchThroughInterceptors(Oi)(!0,null))return!1;t==null||t.setProps({fill:this._freezeHoverColor,zIndex:4}),s.setCursor(M.CURSOR_TYPE.GRAB)});this._freezePointerEnterSubs.add(d);const u=i.onPointerLeave$.subscribeEvent(()=>{t==null||t.setProps({fill:this._freezeNormalHeaderColor,zIndex:3}),s.resetCursor()});this._freezePointerLeaveSubs.add(u)}if(t){const d=t.onPointerEnter$.subscribeEvent(()=>{if(!this.interceptor.fetchThroughInterceptors(Oi)(!0,null))return!1;t==null||t.setProps({fill:this._freezeHoverColor,zIndex:4}),s.setCursor(M.CURSOR_TYPE.GRAB)});this._freezePointerEnterSubs.add(d);const u=t.onPointerLeave$.subscribeEvent(()=>{t==null||t.setProps({fill:this._freezeNormalHeaderColor,zIndex:3}),s.resetCursor()});this._freezePointerLeaveSubs.add(u)}const l=t==null?void 0:t.onPointerDown$.subscribeEvent(d=>{this._freezeDown(d,t,i,e)});l&&this._freezeDownSubs.add(l);const c=i==null?void 0:i.onPointerDown$.subscribeEvent(d=>{this._freezeDown(d,t,i,e)});c&&this._freezeDownSubs.add(c)}_getCurrentLastVisible(){var C,_,w,E,O,T,P;const e=this._getSheetObject();if(e==null)return;const t=(C=this._sheetSkeletonManagerService.getCurrentParam())==null?void 0:C.skeleton;if(t==null)return;const i=e.scene,r=Math.max(i.scaleX,i.scaleY),s=this._scrollManagerService.getCurrentScrollState(),l=(e.engine.height-t.columnHeaderHeight)/r,c=(e.engine.width-t.rowHeaderWidth)/r,d=(_=s==null?void 0:s.sheetViewStartRow)!=null?_:0,u=d===0?-((w=s==null?void 0:s.offsetY)!=null?w:0):t.rowHeightAccumulation[d-1]-((E=s==null?void 0:s.offsetY)!=null?E:0);let h=0,g=!1;for(let A=d,D=t.rowHeightAccumulation.length;A<D;A++)if(t.rowHeightAccumulation[A]-u>l){h=A,g=!0;break}g||(h=t.rowHeightAccumulation.length-1);const S=(O=s==null?void 0:s.sheetViewStartColumn)!=null?O:0,f=S===0?-((T=s==null?void 0:s.offsetX)!=null?T:0):t.columnWidthAccumulation[S-1]-((P=s==null?void 0:s.offsetX)!=null?P:0);let v=0,p=!1;for(let A=S,D=t.columnWidthAccumulation.length;A<D;A++)if(t.columnWidthAccumulation[A]-f>c){v=A,p=!0;break}return p||(v=t.columnWidthAccumulation.length-1),{lastRow:h,lastColumn:v}}_getActiveViewport(e){var i;const t=(i=this._getSheetObject())==null?void 0:i.scene.getViewports();return t&&t.find(r=>r.isHit(new M.Vector2(e.offsetX,e.offsetY)))||null}_freezeDown(e,t,i,r=0){var f;const s=(f=this._sheetSkeletonManagerService.getCurrentParam())==null?void 0:f.skeleton;if(s==null)return;const l=this._getSheetObject();if(l==null)return;if(!this.interceptor.fetchThroughInterceptors(Oi)(!0,null))return!1;const{scene:d}=l;d.setCursor(M.CURSOR_TYPE.GRABBING),d.disableObjectsEvent();const u=this._getCurrentLastVisible(),h=u===void 0?Number.POSITIVE_INFINITY:s.rowHeightAccumulation[u.lastRow],g=u===void 0?Number.POSITIVE_INFINITY:s.columnWidthAccumulation[u.lastColumn-1]+s.rowHeaderWidth;this._activeViewport=null;const S=this._getFreeze();S&&(this._changeToColumn=S.startColumn,this._changeToRow=S.startRow),this._scenePointerMoveSub=d.onPointerMove$.subscribeEvent(v=>{var P,A,D,k;const p=this._getActiveViewport(v),{startX:C,startY:_,row:w,column:E}=Ye(v.offsetX,v.offsetY,d,s,p||void 0,!0);if(!this.interceptor.fetchThroughInterceptors(Oi)(!0,null))return!1;d.setCursor(M.CURSOR_TYPE.GRABBING);const T=ss/Math.max(d.scaleX,d.scaleY);r===0?((P=t.transformByState({top:Math.min(_,h)-T/2}))==null||P.setProps({fill:this._freezeActiveColor}),(A=i.transformByState({top:Math.min(_,h)-T/2}))==null||A.setProps({fill:this._freezeNormalHeaderColor}),this._changeToRow=u===void 0?w:Math.min(w,u.lastRow),this._changeToOffsetY=Math.min(_,h),this._activeViewport=p):((D=t.transformByState({left:Math.min(C,g)-T/2}))==null||D.setProps({fill:this._freezeActiveColor}),(k=i.transformByState({left:Math.min(C,g)-T/2}))==null||k.setProps({fill:this._freezeNormalHeaderColor}),this._changeToColumn=u===void 0?E:Math.min(E,u.lastColumn),this._changeToOffsetX=C,this._activeViewport=p)}),this._scenePointerUpSub=d.onPointerUp$.subscribeEvent(()=>{var H,V;d.resetCursor(),d.enableObjectsEvent(),this._clearObserverEvent();const{rowHeaderWidthAndMarginLeft:v,columnHeaderHeightAndMarginTop:p}=s;r===0&&(this._changeToRow===0||this._changeToRow===-1)||r===1&&(this._changeToColumn===0||this._changeToColumn===-1)?(t.setProps({fill:this._freezeNormalHeaderColor}),i.setProps({fill:this._freezeNormalMainColor})):(t==null||t.setProps({fill:this._freezeNormalHeaderColor}),i==null||i.setProps({fill:this._freezeNormalHeaderColor}));const C=ss/Math.max(d.scaleX,d.scaleY);r===0?(this._changeToRow===0||this._changeToRow===-1)&&(t.transformByState({top:p-C}),i.transformByState({top:p-C})):(this._changeToColumn===0||this._changeToColumn===-1)&&(t.transformByState({left:v-C}),i.transformByState({left:v-C}));const _=this._scrollManagerService.getCurrentScrollState()||{sheetViewStartRow:0,sheetViewStartColumn:0},{sheetViewStartRow:w,sheetViewStartColumn:E}=_;if(E==null||w==null)return;const O=this._context.unit,T=O.getActiveSheet();if(!T)return;const P=(H=T.getConfig())==null?void 0:H.freeze;let A=(P==null?void 0:P.xSplit)||0,D=(P==null?void 0:P.ySplit)||0;const k=(V=this._activeViewport)==null?void 0:V.viewportKey;r===0&&(!k||k===M.SHEET_VIEWPORT_KEY.VIEW_LEFT_TOP||k===M.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP||k===M.SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP||k===M.SHEET_VIEWPORT_KEY.VIEW_ROW_TOP?D=this._changeToRow-(P.startRow-P.ySplit):D=this._changeToRow-w,D=D<0?0:D),r===1&&(!k||k===M.SHEET_VIEWPORT_KEY.VIEW_LEFT_TOP||k===M.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP||k===M.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT||k===M.SHEET_VIEWPORT_KEY.VIEW_COLUMN_LEFT?A=this._changeToColumn-(P.startColumn-P.xSplit):A=this._changeToColumn-E,A=A<0?0:A),this._commandService.executeCommand(m.SetFrozenCommand.id,{startRow:D===0?-1:this._changeToRow,startColumn:A===0?-1:this._changeToColumn,ySplit:D,xSplit:A,unitId:O.getUnitId(),subUnitId:T.getSheetId()})})}_getViewports(){const e=this._getSheetObject();if(e==null)return;const{scene:t}=e,i=t.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_COLUMN_LEFT),r=t.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_COLUMN_RIGHT),s=t.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_ROW_TOP),l=t.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_ROW_BOTTOM),c=t.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_LEFT_TOP),d=t.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN),u=t.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP),h=t.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT),g=t.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP);if(!(i==null||r==null||s==null||l==null||c==null||d==null||u==null||h==null||g==null))return{viewMain:d,viewMainLeftTop:u,viewMainLeft:h,viewMainTop:g,viewColumnLeft:i,viewColumnRight:r,viewRowTop:s,viewRowBottom:l,viewLeftTop:c}}_bindViewportScroll(){const e=this._getViewports();if(!e)return;const{viewRowBottom:t,viewColumnRight:i,viewMainLeft:r,viewMainTop:s}=e;this.disposeWithMe(this._scrollManagerService.validViewportScrollInfo$.subscribe(l=>{if(!l)return;const{scrollX:c,scrollY:d,viewportScrollX:u,viewportScrollY:h}=l;t.isActive&&t.updateScrollVal({scrollY:d,viewportScrollY:h}),i.isActive&&i.updateScrollVal({scrollX:c,viewportScrollX:u}),r.isActive&&r.updateScrollVal({scrollY:d,viewportScrollY:h}),s.isActive&&s.updateScrollVal({scrollX:c,viewportScrollX:u})}))}_updateViewport(e=-1,t=-1,i=0,r=0,s=3){var A;const l=(A=this._sheetSkeletonManagerService.getCurrentParam())==null?void 0:A.skeleton;if(l==null)return;const{rowHeaderWidthAndMarginLeft:c,columnHeaderHeightAndMarginTop:d}=l,u=this._getViewports();if(!u)return;const{viewMain:h,viewMainLeftTop:g,viewMainLeft:S,viewMainTop:f,viewColumnLeft:v,viewColumnRight:p,viewRowTop:C,viewRowBottom:_,viewLeftTop:w}=u;p.resizeWhenFreezeChange({left:c,top:0,height:d+1,right:0}),_.resizeWhenFreezeChange({left:0,top:d,bottom:0,width:c+1}),w.resizeWhenFreezeChange({left:0,top:0,width:c+1,height:d});let E=!0,O=!0;g.enable(),(e===-1||e===0)&&(E=!1),(t===-1||t===0)&&(O=!1);const T=l.getNoMergeCellWithCoordByIndex(e-i,t-r,!1),P=l.getNoMergeCellWithCoordByIndex(e,t,!1);if(g.disable(),f.disable(),S.disable(),C.disable(),v.disable(),g.resetPadding(),f.resetPadding(),S.resetPadding(),C.resetPadding(),v.resetPadding(),E===!1&&O===!1)h.resizeWhenFreezeChange({left:c,top:d,bottom:0,right:0}),h.resetPadding(),S.resizeWhenFreezeChange({left:c,top:d,bottom:0,width:0}),f.resizeWhenFreezeChange({left:c,top:d,height:0,right:0}),g.resizeWhenFreezeChange({left:c,top:d,width:0,height:0}),C.resizeWhenFreezeChange({left:0,top:d,width:c+1,height:0}),v.resizeWhenFreezeChange({left:0,top:0,height:d+1,width:0});else if(E===!0&&O===!1){const D=P.startY-T.startY;h.resizeWhenFreezeChange({left:c,top:d+D,bottom:0,right:0}),h.setPadding({startY:T.startY,endY:P.startY,startX:0,endX:0}),s&2&&this._commandService.executeCommand(Le.id,{sheetViewStartRow:0,offsetY:0}),f.resizeWhenFreezeChange({left:c,top:d,height:D,right:0}),f.updateScrollVal({viewportScrollY:T.startY,rawScrollX:h.scrollX,viewportScrollX:h.viewportScrollX}),C.resizeWhenFreezeChange({left:0,top:d,width:c+1,height:D}),C.updateScrollVal({viewportScrollY:T.startY}),_.resizeWhenFreezeChange({left:0,top:d+D,bottom:0,width:c+1}),f.enable(),C.enable()}else if(E===!1&&O===!0){const D=P.startX-T.startX;h.resizeWhenFreezeChange({left:c+D,top:d,bottom:0,right:0}),h.setPadding({startX:T.startX,endX:P.startX,startY:0,endY:0}),s&1&&this._commandService.executeCommand(Le.id,{sheetViewStartColumn:0,offsetX:0}),S.resizeWhenFreezeChange({left:c,top:d,width:D,bottom:0,right:0}),S.updateScrollVal({viewportScrollX:T.startX,rawScrollY:h.scrollY,viewportScrollY:h.viewportScrollY}),v.resizeWhenFreezeChange({left:c,top:0,width:D,height:d+1}),v.updateScrollVal({viewportScrollX:T.startX}),p.resizeWhenFreezeChange({left:c+D,top:0,height:d+1,right:0}),S.enable(),v.enable()}else{const D=P.startX-T.startX,k=P.startY-T.startY;h.resizeWhenFreezeChange({left:c+D,top:d+k,bottom:0,right:0}),h.setPadding({startY:T.startY,endY:P.startY,startX:T.startX,endX:P.startX}),s&&this._commandService.executeCommand(Le.id,{...s&1?{sheetViewStartColumn:0,offsetX:0}:null,...s&2?{sheetViewStartRow:0,offsetY:0}:null}),S.resizeWhenFreezeChange({left:c,top:d+k,width:D,bottom:0}),S.updateScrollVal({viewportScrollX:T.startX,rawScrollY:h.scrollY,viewportScrollY:h.viewportScrollY}),f.resizeWhenFreezeChange({left:c+D,top:d,height:k,right:0}),f.updateScrollVal({viewportScrollY:T.startY,rawScrollX:h.scrollX,viewportScrollX:h.viewportScrollX}),g.resizeWhenFreezeChange({left:c,top:d,width:D,height:k}),g.updateScrollVal({viewportScrollX:T.startX,viewportScrollY:T.startY}),C.resizeWhenFreezeChange({left:0,top:d,width:c+1,height:k}),C.updateScrollVal({viewportScrollY:T.startY}),_.resizeWhenFreezeChange({left:0,top:d+k,bottom:0,width:c+1}),v.resizeWhenFreezeChange({left:c,top:0,width:D,height:d+1}),v.updateScrollVal({viewportScrollX:T.startX}),p.resizeWhenFreezeChange({left:c+D,top:0,height:d+1,right:0}),g.enable(),f.enable(),S.enable(),C.enable(),v.enable()}}_skeletonListener(){this.disposeWithMe(a.toDisposable(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(e=>{[m.SetWorksheetActiveOperation.id,m.InsertRangeMoveDownCommand.id,m.InsertRangeMoveRightCommand.id].includes((e==null?void 0:e.commandId)||"")&&this._refreshCurrent()})))}_refreshCurrent(){const t=this._context.unit.getActiveSheet();if(!t)return;const i=t.getConfig().freeze,{startRow:r=-1,startColumn:s=-1,ySplit:l=0,xSplit:c=0}=i;this._refreshFreeze(r,s,l,c,0)}_themeChangeListener(){this._themeChange(this._themeService.getCurrentTheme()),this.disposeWithMe(this._themeService.currentTheme$.subscribe(e=>{this._clearFreeze(),this._themeChange(e),this._refreshCurrent()}))}_themeChange(e){this._freezeNormalHeaderColor=a.get(e,"gray.300"),this._freezeNormalMainColor=new a.ColorKit(this._freezeNormalHeaderColor).setAlpha(mS).toRgbString(),this._freezeActiveColor=a.get(e,"primary.600"),this._freezeHoverColor=a.get(e,"gray.500")}_interceptorCommands(){this.disposeWithMe(this._sheetInterceptorService.interceptCommand({getMutations:e=>{const t={redos:[],undos:[]},i=this._getFreeze();if(!i)return t;const r=s=>{const l=this._context.unit,c=l.getUnitId(),d=l.getActiveSheet();if(!d)return t;const u=d.getSheetId();this._refreshFreeze(s.startRow,s.startColumn,s.ySplit,s.xSplit,0);const h={...s,unitId:c,subUnitId:u,resetScroll:!1},g=m.SetFrozenMutationFactory(this._injector,h);return{undos:[{id:m.SetFrozenMutation.id,params:g}],redos:[{id:m.SetFrozenMutation.id,params:h}]}};if(e.id===m.InsertRowCommand.id){const s=e.params,{range:l,direction:c}=s,d=l.endRow-l.startRow+1;if(l.startRow<i.startRow||l.startRow+1===i.startRow&&c===a.Direction.UP){const u={...i,startRow:Math.max(1,i.startRow+d),ySplit:Math.max(1,i.ySplit+d)};return r(u)}}if(e.id===m.InsertColCommand.id){const s=e.params,{range:l,direction:c}=s,d=l.endColumn-l.startColumn+1;if(l.startColumn<i.startColumn||l.startColumn+1===i.startColumn&&c===a.Direction.LEFT){const u={...i,startColumn:Math.max(1,i.startColumn+d),xSplit:Math.max(1,i.xSplit+d)};return r(u)}}if(e.id===m.MoveColsCommand.id){const s=this._selectionManagerService.getCurrentSelections(),{fromRange:{startColumn:l},toRange:{startColumn:c}}=e.params,d=s==null?void 0:s.filter(C=>C.range.rangeType===a.RANGE_TYPE.COLUMN&&C.range.startColumn<=l&&l<=C.range.endColumn);if(!(d!=null&&d.length))return t;const u=d[0].range,h={...u,startColumn:c,endColumn:c+u.endColumn-u.startColumn};if(!i||i.startColumn<=0||u.startColumn>=i.startColumn&&h.startColumn>=i.startColumn||u.startColumn===h.startColumn||u.endColumn<i.startColumn&&h.startColumn<i.startColumn)return t;const g=u.endColumn-u.startColumn+1,S=Math.max(Math.min(i.startColumn,u.endColumn+1)-u.startColumn,0);let f,v;h.startColumn>=i.startColumn?(f=Math.max(i.startColumn-S,1),v=Math.max(i.xSplit-S,1)):(f=i.startColumn+g-S,v=i.xSplit+g-S);const p={...i,startColumn:f,xSplit:v};return r(p)}if(e.id===m.MoveRowsCommand.id){const s=this._selectionManagerService.getCurrentSelections(),{fromRange:{startRow:l},toRange:{startRow:c}}=e.params,d=s==null?void 0:s.filter(C=>C.range.rangeType===a.RANGE_TYPE.ROW&&C.range.startRow<=l&&l<=C.range.endRow);if(!(d!=null&&d.length))return t;const u=d[0].range,h={...u,startRow:c,endRow:c+u.endRow-u.startRow};if(!i||i.startRow<=0||u.startRow>=i.startRow&&h.startRow>=i.startRow||u.startRow===h.startRow||u.endRow<i.startRow&&h.startRow<i.startRow)return t;const g=u.endRow-u.startRow+1,S=Math.max(Math.min(i.startRow,u.endRow+1)-u.startRow,0);let f,v;h.startRow>=i.startRow?(f=Math.max(i.startRow-S,1),v=Math.max(i.ySplit-S,1)):(f=i.startRow+g-S,v=i.ySplit+g-S);const p={...i,startRow:f,ySplit:v};return r(p)}if(e.id===m.RemoveColCommand.id||e.id===m.RemoveRowCommand.id){const s=e.params,l=s.range;if(l.rangeType===a.RANGE_TYPE.COLUMN&&l.startColumn<i.startColumn){const c=Math.min(i.startColumn,l.endColumn+1)-l.startColumn,d={...i,startColumn:Math.max(1,i.startColumn-c),xSplit:Math.max(1,i.xSplit-c)};return r(d)}if(s.range.rangeType===a.RANGE_TYPE.ROW&&l.startRow<i.startRow){const c=Math.min(i.startRow,l.endRow+1)-l.startRow,d={...i,startRow:Math.max(1,i.startRow-c),ySplit:Math.max(1,i.ySplit-c)};return r(d)}}return t}}))}_commandExecutedListener(){this.disposeWithMe(this._commandService.onCommandExecuted(e=>{switch(e.id){case m.SetFrozenMutation.id:case je.id:{const t=this._lastFreeze,i=this._context.unit,r=i.getActiveSheet(),s=e.params,{unitId:l,subUnitId:c}=s;if(!(l===i.getUnitId()&&c===(r==null?void 0:r.getSheetId())))return;const d=r.getConfig().freeze;if(this._lastFreeze=d,d==null)return;let u=0;const{startRow:h=-1,startColumn:g=-1,ySplit:S=0,xSplit:f=0}=d;(!t||t.startRow!==h||t.ySplit!==S)&&(u|=2),(!t||t.startColumn!==g||t.xSplit!==f)&&(u|=1),s.resetScroll===!1&&(u=0),this._refreshFreeze(h,g,S,f,u)}break;case m.SetWorksheetRowHeightMutation.id:{const t=this._getFreeze(),i=t&&e.params.ranges.some(r=>r.startRow<t.startRow);e.params&&i&&this._refreshCurrent()}break;case m.SetWorksheetColWidthMutation.id:{const t=this._getFreeze();e.params&&t&&e.params.ranges.some(i=>i.startColumn<t.startColumn)&&this._refreshCurrent()}break;case m.SetWorksheetRowAutoHeightMutation.id:{const t=e.params,i=this._getFreeze();if(i&&i.startRow>-1&&t.rowsAutoHeightInfo.some(r=>r.row<i.startRow)){const r=this._sheetSkeletonManagerService.currentSkeleton$.subscribe(()=>{this._refreshCurrent(),setTimeout(()=>{r.unsubscribe()})})}}break;case m.SetColHiddenMutation.id:case m.SetColVisibleMutation.id:{const t=e.params,i=this._getFreeze(),r=t.ranges;i&&i.startColumn>-1&&r.some(s=>s.startColumn<i.startColumn)&&this._refreshCurrent()}break;case m.SetRowHiddenMutation.id:case m.SetRowVisibleMutation.id:{const t=e.params,i=this._getFreeze(),r=t.ranges;i&&i.startRow>-1&&r.some(s=>s.startRow<i.startRow)&&this._refreshCurrent()}break;case jn.id:case Zn.id:this._refreshCurrent()}}))}_zoomRefresh(){const e=this._getSheetObject();if(e==null)return;const{scene:t}=e;this.disposeWithMe(t.onTransformChange$.subscribeEvent(i=>{[M.TRANSFORM_CHANGE_OBSERVABLE_TYPE.scale,M.TRANSFORM_CHANGE_OBSERVABLE_TYPE.all].includes(i.type)&&this._refreshCurrent()}))}_clearObserverEvent(){var t,i;this._getSheetObject()!=null&&((t=this._scenePointerMoveSub)==null||t.unsubscribe(),(i=this._scenePointerUpSub)==null||i.unsubscribe(),this._scenePointerMoveSub=null,this._scenePointerUpSub=null)}_clearFreeze(){var t,i,r,s,l,c;(t=this._rowFreezeHeaderRect)==null||t.dispose(),(i=this._rowFreezeMainRect)==null||i.dispose(),(r=this._columnFreezeHeaderRect)==null||r.dispose(),(s=this._columnFreezeMainRect)==null||s.dispose(),this._getSheetObject()!=null&&([this._freezeDownSubs,this._freezePointerEnterSubs,this._freezePointerLeaveSubs].forEach(d=>{d==null||d.unsubscribe()}),this._freezeDownSubs=null,this._freezePointerEnterSubs=null,this._freezePointerLeaveSubs=null,(l=this._scenePointerMoveSub)==null||l.unsubscribe(),(c=this._scenePointerUpSub)==null||c.unsubscribe(),this._scenePointerMoveSub=null,this._scenePointerUpSub=null)}_getPositionByIndex(e,t){var d;if(this._getSheetObject()==null)return;const r=(d=this._sheetSkeletonManagerService.getCurrentParam())==null?void 0:d.skeleton,s=r==null?void 0:r.getNoMergeCellWithCoordByIndex(e,t);if(r==null)return;if(s!=null&&(!isNaN(s.endX)||!isNaN(s.endY)))return s;const{rowHeaderWidthAndMarginLeft:l,columnHeaderHeightAndMarginTop:c}=r;return{startX:l,endX:l,startY:c,endY:c}}_getFreeze(){var t;const e=(t=this._sheetSkeletonManagerService.getCurrentParam())==null?void 0:t.skeleton.getWorksheetConfig();if(e!=null)return e.freeze}_getSheetObject(){return He(this._context.unit,this._context)}_refreshFreeze(e,t,i,r,s){var c;const l={startRow:e,startColumn:t,ySplit:i,xSplit:r};this._clearFreeze(),this._createFreeze(0,l),this._createFreeze(1,l),this._updateViewport(e,t,i,r,s),(c=this._getSheetObject())==null||c.spreadsheet.makeForceDirty()}},y.HeaderFreezeRenderController=lS([Zt(1,a.Inject(y.SheetSkeletonManagerService)),Zt(2,a.ICommandService),Zt(3,a.Inject(m.SheetsSelectionsService)),Zt(4,a.Inject(y.SheetScrollManagerService)),Zt(5,a.Inject(a.ThemeService)),Zt(6,a.Inject(m.SheetInterceptorService)),Zt(7,a.Inject(a.Injector))],y.HeaderFreezeRenderController);var gS=Object.getOwnPropertyDescriptor,SS=(n,o,e,t)=>{for(var i=t>1?void 0:t?gS(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},as=(n,o)=>(e,t)=>o(e,t,n);const fS="__SpreadsheetHeaderMoveControllerBackground__",vS="__SpreadsheetHeaderMoveControllerShapeLine__",pS="rgba(0, 0, 0, 0.1)",CS="rgb(119, 119, 119)",IS=4,ls=a.createInterceptorKey("headerMovePermissionCheck");y.HeaderMoveRenderController=class extends a.Disposable{constructor(e,t,i,r){super();R(this,"_startOffsetX",Number.NEGATIVE_INFINITY);R(this,"_startOffsetY",Number.NEGATIVE_INFINITY);R(this,"_moveHelperBackgroundShape");R(this,"_moveHelperLineShape");R(this,"_headerPointerDownSubs");R(this,"_headerPointerMoveSubs");R(this,"_headerPointerLeaveSubs");R(this,"_dragHeaderMoveSub");R(this,"_scenePointerUpSub");R(this,"_scrollTimer");R(this,"_changeFromColumn",-1);R(this,"_changeFromRow",-1);R(this,"_changeToColumn",-1);R(this,"_changeToRow",-1);R(this,"interceptor",new a.InterceptorManager({HEADER_MOVE_PERMISSION_CHECK:ls}));R(this,"_workbookSelections");this._context=e,this._sheetSkeletonManagerService=i,this._commandService=r,this._workbookSelections=t.getWorkbookSelections(this._context.unitId),this._init()}dispose(){var e,t,i,r,s,l,c,d;(e=this._moveHelperBackgroundShape)==null||e.dispose(),(t=this._moveHelperLineShape)==null||t.dispose(),(i=this._headerPointerMoveSubs)==null||i.unsubscribe(),(r=this._headerPointerLeaveSubs)==null||r.unsubscribe(),(s=this._headerPointerDownSubs)==null||s.unsubscribe(),this._headerPointerMoveSubs=null,this._headerPointerLeaveSubs=null,this._headerPointerDownSubs=null,(l=this._dragHeaderMoveSub)==null||l.unsubscribe(),(c=this._scenePointerUpSub)==null||c.unsubscribe(),this._dragHeaderMoveSub=null,this._scenePointerUpSub=null,(d=this._scrollTimer)==null||d.dispose()}_init(){this._initialRowOrColumn(a.RANGE_TYPE.ROW),this._initialRowOrColumn(a.RANGE_TYPE.COLUMN)}_initialRowOrColumn(e=a.RANGE_TYPE.ROW){const t=this._context.components.get(he.COLUMN),i=this._context.components.get(he.ROW),r=this._context.scene,s=e===a.RANGE_TYPE.ROW?i:t,l=u=>{var _,w;const h=(_=this._sheetSkeletonManagerService.getCurrentParam())==null?void 0:_.skeleton;if(h==null)return;const g=(w=this._workbookSelections.getCurrentLastSelection())==null?void 0:w.range;if(!g||!this.interceptor.fetchThroughInterceptors(ls)(!1,g))return;const f=this._workbookSelections.getCurrentSelections(),{row:v,column:p}=Ye(u.offsetX,u.offsetY,r,h);if(!Pi(f,e===a.RANGE_TYPE.ROW?v:p,e)){r.resetCursor();return}r.setCursor(M.CURSOR_TYPE.GRAB)},c=()=>{var u,h;(u=this._moveHelperBackgroundShape)==null||u.hide(),(h=this._moveHelperLineShape)==null||h.hide(),r.resetCursor()},d=(u,h)=>{var L,W;if(h.isStopPropagation)return;const g=(L=this._sheetSkeletonManagerService.getCurrentParam())==null?void 0:L.skeleton;if(g==null)return;const S=(W=this._workbookSelections.getCurrentLastSelection())==null?void 0:W.range;if(!S||!this.interceptor.fetchThroughInterceptors(ls)(!1,S))return;const{offsetX:v,offsetY:p}=u,C=r.getCoordRelativeToViewport(M.Vector2.FromArray([v,p])),{x:_,y:w}=C;this._startOffsetX=_,this._startOffsetY=w;const{row:E,column:O}=Ye(u.offsetX,u.offsetY,r,g);let T;e===a.RANGE_TYPE.ROW?(this._changeFromRow=E,T=M.ScrollTimerType.Y):(this._changeFromColumn=O,T=M.ScrollTimerType.X);const P=this._workbookSelections.getCurrentSelections(),A=Pi(P,e===a.RANGE_TYPE.ROW?E:O,e);if(!A)return;const D=r.getScrollXYInfoByViewport(M.Vector2.FromArray([this._startOffsetX,this._startOffsetY]));this._newBackgroundAndLine(),r.setCursor(M.CURSOR_TYPE.GRABBING),r.disableObjectsEvent();let k=!1,H;const V=()=>{if(k)return;H=M.ScrollTimer.create(r,T),this._scrollTimer=H;const B=r.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN);H.startScroll(_,w,B),k=!0};this._dragHeaderMoveSub=r.onPointerMove$.subscribeEvent(B=>{V();const{offsetX:U,offsetY:z}=B,{x:F,y:j}=r.getCoordRelativeToViewport(M.Vector2.FromArray([U,z]));this._rowColumnMoving(F,j,A,D,e),H.scrolling(F,j,()=>{this._rowColumnMoving(F,j,A,D,e)})}),this._scenePointerUpSub=r.onPointerUp$.subscribeEvent(()=>{var U,z,F;this._disposeBackgroundAndLine(),r.resetCursor(),r.enableObjectsEvent(),this._clearObserverEvent(),(U=this._scrollTimer)==null||U.dispose();const B=this._workbookSelections.getCurrentSelections();if(e===a.RANGE_TYPE.ROW){if(this._changeFromRow!==this._changeToRow&&this._changeToRow!==-1){const Y=(z=((B==null?void 0:B.filter(Q=>Q.range.rangeType===a.RANGE_TYPE.ROW&&Q.range.startRow<=this._changeFromRow&&this._changeFromRow<=Q.range.endRow))||[])[0])==null?void 0:z.range;Y&&this._commandService.executeCommand(m.MoveRowsCommand.id,{fromRange:Y,toRange:{...Y,startRow:this._changeToRow,endRow:this._changeToRow+Y.endRow-Y.startRow}})}this._changeToRow=this._changeFromRow=-1}else{if(this._changeFromColumn!==this._changeToColumn&&this._changeToColumn!==-1){const Y=(F=((B==null?void 0:B.filter(Q=>Q.range.rangeType===a.RANGE_TYPE.COLUMN&&Q.range.startColumn<=this._changeFromColumn&&this._changeFromColumn<=Q.range.endColumn))||[])[0])==null?void 0:F.range;Y&&this._commandService.executeCommand(m.MoveColsCommand.id,{fromRange:Y,toRange:{...Y,startColumn:this._changeToColumn,endColumn:this._changeToColumn+Y.endColumn-Y.startColumn}})}this._changeToColumn=this._changeFromColumn=-1}})};this._headerPointerMoveSubs=new N.Subscription,this._headerPointerMoveSubs.add(s.onPointerMove$.subscribeEvent(l)),this._headerPointerLeaveSubs=new N.Subscription,this._headerPointerLeaveSubs.add(s==null?void 0:s.onPointerLeave$.subscribeEvent(c)),this._headerPointerDownSubs=new N.Subscription,this._headerPointerDownSubs.add(s==null?void 0:s.onPointerDown$.subscribeEvent(d))}_rowColumnMoving(e,t,i,r,s){var j,Y,Q,oe,re,ce,G;const l=this._context.scene,c=(j=this._sheetSkeletonManagerService.getCurrentParam())==null?void 0:j.skeleton;if(c==null)return;const{rowHeaderWidth:d,columnHeaderHeight:u,rowTotalHeight:h,columnTotalWidth:g}=c,S=l.getViewportScrollXY(l.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN)),{scaleX:f,scaleY:v}=l.getAncestorScale(),p=c.getCellIndexByOffset(e,t,f,v,S),{row:C,column:_}=p,w=c.getNoMergeCellWithCoordByIndex(C,_),{startX:E,startY:O,endX:T,endY:P}=w,A=this._sheetSkeletonManagerService.attachRangeWithCoord(i.range);if(A==null)return;const D=Math.max(f,f),{startX:k,endX:H,startY:V,endY:L,startRow:W,startColumn:B,endRow:U,endColumn:z}=A;s===a.RANGE_TYPE.ROW?(Y=this._moveHelperBackgroundShape)==null||Y.transformByState({height:L-V,width:g+d,left:0,top:V+(t-this._startOffsetY)/D+S.y-r.y}):(Q=this._moveHelperBackgroundShape)==null||Q.transformByState({height:h+u,width:H-k,left:k+(e-this._startOffsetX)/D+S.x-r.x,top:0}),(oe=this._moveHelperBackgroundShape)==null||oe.show();const F=IS/D;if(s===a.RANGE_TYPE.ROW){let Z=0;if(C<=W)Z=O-F/2,this._changeToRow=C;else if(C>U)Z=P-F/2,this._changeToRow=C+1;else return;(re=this._moveHelperLineShape)==null||re.transformByState({height:F,width:g,left:d,top:Z})}else{let Z=0;if(_<=B)Z=E-F/2,this._changeToColumn=_;else if(_>z)Z=T-F/2,this._changeToColumn=_+1;else return;(ce=this._moveHelperLineShape)==null||ce.transformByState({height:h,width:F,left:Z,top:u})}(G=this._moveHelperLineShape)==null||G.show()}_clearObserverEvent(){var e,t;(e=this._dragHeaderMoveSub)==null||e.unsubscribe(),(t=this._scenePointerUpSub)==null||t.unsubscribe(),this._dragHeaderMoveSub=null,this._scenePointerUpSub=null}_newBackgroundAndLine(){const e=this._context.scene;this._moveHelperBackgroundShape=new M.Rect(fS,{fill:pS,evented:!1,zIndex:100}),this._moveHelperLineShape=new M.Rect(vS,{fill:CS,evented:!1,zIndex:100}),e.addObjects([this._moveHelperBackgroundShape,this._moveHelperLineShape],st)}_disposeBackgroundAndLine(){var e,t;(e=this._moveHelperBackgroundShape)==null||e.dispose(),(t=this._moveHelperLineShape)==null||t.dispose()}},y.HeaderMoveRenderController=SS([as(1,a.Inject(m.SheetsSelectionsService)),as(2,a.Inject(y.SheetSkeletonManagerService)),as(3,a.ICommandService)],y.HeaderMoveRenderController);var cs=(n=>(n[n.VERTICAL=0]="VERTICAL",n[n.HORIZONTAL=1]="HORIZONTAL",n))(cs||{});const _S="rgba(120, 120, 120, 0.01)",ds="rgb(68, 71, 70)",Ai=12,bS=44,us=4;class Gl extends M.Shape{constructor(e,t){super(e,t);R(this,"_size",Ai);R(this,"_color",ds);R(this,"_mode",0);this.setShapeProps(t)}get size(){return this._size}get mode(){return this._mode}get color(){return this._color}_draw(e){const t=this.getScene();if(!t)return;const{scaleX:i,scaleY:r}=t.getAncestorScale(),s=Math.max(i,r),l=Ai/s,c=us/s;let{width:d,height:u}=this,h=0,g=0;this.mode===0?(d=c,h=l-c):(u=c,g=l-c),M.Rect.drawWith(e,{width:this.width,height:this.height,left:0,top:0,fill:_S}),M.Rect.drawWith(e,{width:d,height:u,fill:ds,radius:c}),e.save(),e.transform(1,0,0,1,h,g),M.Rect.drawWith(e,{width:d,height:u,fill:ds,radius:c}),e.restore()}setShapeProps(e){return e!=null&&e.size&&(this._size=e.size),e!=null&&e.mode&&(this._mode=e.mode),e!=null&&e.color&&(this._color=e.color),this.mode===0?this.transformByState({width:Ai,height:this.size}):this.transformByState({width:this.size,height:Ai}),this}}var wS=Object.getOwnPropertyDescriptor,ES=(n,o,e,t)=>{for(var i=t>1?void 0:t?wS(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},hs=(n,o)=>(e,t)=>o(e,t,n);const TS="__SpreadsheetHeaderResizeControllerShapeRow__",yS="__SpreadsheetHeaderResizeControllerShapeColumn__",Kl="__SpreadsheetHeaderResizeControllerShapeHelper__",ql="rgb(199, 199, 199)",RS=2,ms=a.createInterceptorKey("headerResizePermissionCheck");y.HeaderResizeRenderController=class extends a.Disposable{constructor(e,t,i,r){super();R(this,"_currentRow",0);R(this,"_currentColumn",0);R(this,"_rowResizeRect");R(this,"_columnResizeRect");R(this,"_headerPointerSubs");R(this,"_scenePointerMoveSub");R(this,"_scenePointerUpSub");R(this,"_resizeHelperShape");R(this,"_startOffsetX",Number.POSITIVE_INFINITY);R(this,"_startOffsetY",Number.POSITIVE_INFINITY);R(this,"interceptor",new a.InterceptorManager({HEADER_RESIZE_PERMISSION_CHECK:ms}));this._context=e,this._sheetSkeletonManagerService=t,this._selectionManagerService=i,this._commandService=r,this._init()}dispose(){var e,t,i;(e=this._rowResizeRect)==null||e.dispose(),this._rowResizeRect=null,(t=this._columnResizeRect)==null||t.dispose(),this._columnResizeRect=null,(i=this._headerPointerSubs)==null||i.unsubscribe(),this._headerPointerSubs=null}_init(){const e=this._context.scene;this._rowResizeRect=new Gl(TS,{visible:!1,mode:cs.HORIZONTAL,zIndex:100}),this._columnResizeRect=new Gl(yS,{visible:!1,mode:cs.VERTICAL,zIndex:100}),e.addObjects([this._rowResizeRect,this._columnResizeRect],st),this._initialHover(0),this._initialHover(1),this._initialHoverResize(0),this._initialHoverResize(1)}_initialHover(e=0){const t=this._context.components.get(he.COLUMN),i=this._context.components.get(he.ROW),r=this._context.scene,s=e===0?i:t,l=(d,u)=>{var h,g;(h=this._rowResizeRect)==null||h.hide(),(g=this._columnResizeRect)==null||g.hide()},c=(d,u)=>{var D;const h=(D=this._sheetSkeletonManagerService.getCurrentParam())==null?void 0:D.skeleton;if(h==null||this._rowResizeRect==null||this._columnResizeRect==null)return;const{rowHeaderWidth:g,columnHeaderHeight:S}=h,{startX:f,startY:v,endX:p,endY:C,row:_,column:w}=Ye(d.offsetX,d.offsetY,r,h),E=fi(d.offsetX,d.offsetY,r),{scaleX:O,scaleY:T}=r.getAncestorScale(),P=Math.max(O,T),A=Ai/P;if(e===0){let k=v-A/2;if(E.y<=v+A/2&&E.y>=v)this._currentRow=_-1;else if(E.y>=C-A/2&&E.y<=C)this._currentRow=_,k=C-A/2;else{this._rowResizeRect.hide();return}if(this._currentRow===-1)return;if(!this.interceptor.fetchThroughInterceptors(ms)(null,{row:this._currentRow}))return!1;const V=Math.min(bS,g/3);this._rowResizeRect.transformByState({left:g/2-V/2,top:k}),this._rowResizeRect.setShapeProps({size:V}),this._rowResizeRect.show()}else{let k=f-A/2;if(E.x<=f+A/2&&E.x>=f)this._currentColumn=w-1;else if(E.x>=p-A/2&&E.x<=p)this._currentColumn=w,k=p-A/2;else{this._columnResizeRect.hide();return}if(this._currentColumn===-1)return;if(!this.interceptor.fetchThroughInterceptors(ms)(null,{col:this._currentColumn}))return!1;const V=S*.7;this._columnResizeRect.transformByState({left:k,top:S/2-V/2}),this._columnResizeRect.setShapeProps({size:V}),this._columnResizeRect.show()}};this._headerPointerSubs=new N.Subscription,this._headerPointerSubs.add(s==null?void 0:s.onPointerMove$.subscribeEvent(c)),this._headerPointerSubs.add(s==null?void 0:s.onPointerLeave$.subscribeEvent(l))}_initialHoverResize(e=0){const t=this._context.scene,i=e===0?this._rowResizeRect:this._columnResizeRect;i!=null&&(this.disposeWithMe(i.onPointerEnter$.subscribeEvent(()=>{i!=null&&(i.show(),t.setCursor(e===0?M.CURSOR_TYPE.ROW_RESIZE:M.CURSOR_TYPE.COLUMN_RESIZE))})),this.disposeWithMe(i.onPointerLeave$.subscribeEvent(()=>{i!=null&&(i.hide(),t.resetCursor())})),this.disposeWithMe(i.onPointerDown$.subscribeEvent(r=>{var z,F,j,Y,Q,oe,re;const s=(z=this._sheetSkeletonManagerService.getCurrentParam())==null?void 0:z.skeleton;if(s==null)return;const l=this._context.scene,c=l.getEngine(),d=(c==null?void 0:c.height)||0,u=(c==null?void 0:c.width)||0,h=l.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN),g=(((j=(F=h==null?void 0:h.getScrollBar())==null?void 0:F.horizonScrollTrack)==null?void 0:j.height)||0)+10,S=(((Q=(Y=h==null?void 0:h.getScrollBar())==null?void 0:Y.verticalScrollTrack)==null?void 0:Q.width)||0)+10,f=fi(r.offsetX,r.offsetY,l),{scaleX:v,scaleY:p}=l.getAncestorScale();this._startOffsetX=f.x,this._startOffsetY=f.y;const C=s.getOffsetByColumn(this._currentColumn),_=s.getOffsetByRow(this._currentRow),w=s.getNoMergeCellWithCoordByIndex(this._currentRow,this._currentColumn);let E=!1,O=0,T=0;const{columnTotalWidth:P,rowHeaderWidth:A,rowTotalHeight:D,columnHeaderHeight:k}=s,H=u>P+A?u:P+A,V=d>D+k?d:D+k,L=Math.max(v,p),W=us/L;e===0?this._resizeHelperShape=new M.Rect(Kl,{width:H,height:W,fill:ql,left:0,top:_-W/2}):this._resizeHelperShape=new M.Rect(Kl,{width:W,height:V,fill:ql,left:C-W/2,top:0});const B=((oe=this._columnResizeRect)==null?void 0:oe.left)||0,U=((re=this._rowResizeRect)==null?void 0:re.top)||0;l.addObject(this._resizeHelperShape,st),l.disableObjectsEvent(),this._scenePointerMoveSub=l.onPointerMove$.subscribeEvent(ce=>{var ve,we,Ee,bt,wt,Qt;const G=l.getCoordRelativeToViewport(M.Vector2.FromArray([this._startOffsetX,this._startOffsetY])),Z=l.getScrollXYInfoByViewport(G,h),J=fi(ce.offsetX,ce.offsetY,l),{x:ne,y:ue}=J,{scaleX:ie,scaleY:se}=l.getAncestorScale(),te=Math.max(ie,se),fe=us/te;O=ne-this._startOffsetX-fe/2,T=ue-this._startOffsetY-fe/2,Math.abs(e===0?T:O)>=RS&&(E=!0),e===0?(T>d-g+Z.y-w.startY&&(T=d-g+Z.y-w.startY),T<-(w.endY-w.startY)+2&&(T=-(w.endY-w.startY)+2),E&&((ve=this._resizeHelperShape)==null||ve.transformByState({top:_+T}),(we=this._rowResizeRect)==null||we.transformByState({top:U+T+fe/2}),(Ee=this._rowResizeRect)==null||Ee.show(),l.setCursor(M.CURSOR_TYPE.ROW_RESIZE))):(O>u-S+Z.x-w.startX&&(O=u-S+Z.x-w.startX),O<-(w.endX-w.startX)+2&&(O=-(w.endX-w.startX)+2),E&&((bt=this._resizeHelperShape)==null||bt.transformByState({left:C+O}),(wt=this._columnResizeRect)==null||wt.transformByState({left:B+O+fe/2}),(Qt=this._columnResizeRect)==null||Qt.show(),l.setCursor(M.CURSOR_TYPE.COLUMN_RESIZE)))}),this._scenePointerUpSub=l.onPointerUp$.subscribeEvent(ce=>{var Z,J,ne;const G=this._context.scene;this._clearObserverEvent(),(Z=this._resizeHelperShape)==null||Z.dispose(),this._resizeHelperShape=null,G.enableObjectsEvent(),E&&(G.resetCursor(),(J=this._rowResizeRect)==null||J.hide(),(ne=this._columnResizeRect)==null||ne.hide(),e===0?this._commandService.executeCommand(m.DeltaRowHeightCommand.id,{deltaY:T,anchorRow:this._currentRow}):this._commandService.executeCommand(m.DeltaColumnWidthCommand.id,{deltaX:O,anchorCol:this._currentColumn}))})})),this.disposeWithMe(i.onDblclick$.subscribeEvent(()=>{var h,g,S;this._context.scene.resetCursor();const s=(h=this._sheetSkeletonManagerService.getCurrentParam())==null?void 0:h.skeleton;if(!s)return;const l=0,c=0,d=s.worksheet.getRowCount()-1||0,u=s.worksheet.getColumnCount()-1||0;switch(e){case 1:{const f=this._selectionManagerService.getCurrentSelections(),v=[];for(let p=0;p<f.length;p++){const C=f[p];C.range.rangeType===a.RANGE_TYPE.COLUMN&&this._currentColumn<=C.range.endColumn&&this._currentColumn>=C.range.startColumn&&v.push({startColumn:C.range.startColumn,endColumn:C.range.endColumn,startRow:l,endRow:d})}v.length===0&&v.push({startColumn:this._currentColumn,endColumn:this._currentColumn,startRow:l,endRow:d}),this._commandService.executeCommand(In.id,{ranges:v}),(g=this._columnResizeRect)==null||g.hide();break}case 0:this._commandService.executeCommand(m.SetWorksheetRowIsAutoHeightCommand.id,{ranges:[{startRow:this._currentRow,endRow:this._currentRow,startColumn:c,endColumn:u}]}),(S=this._rowResizeRect)==null||S.hide();break}})))}_clearObserverEvent(){var e,t;(e=this._scenePointerMoveSub)==null||e.unsubscribe(),(t=this._scenePointerUpSub)==null||t.unsubscribe(),this._scenePointerMoveSub=null,this._scenePointerUpSub=null}},y.HeaderResizeRenderController=ES([hs(1,a.Inject(y.SheetSkeletonManagerService)),hs(2,a.Inject(m.SheetsSelectionsService)),hs(3,a.ICommandService)],y.HeaderResizeRenderController);var MS=Object.getOwnPropertyDescriptor,PS=(n,o,e,t)=>{for(var i=t>1?void 0:t?MS(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Di=(n,o)=>(e,t)=>o(e,t,n);const OS=60;y.SheetRenderController=class extends a.RxDisposable{constructor(e,t,i,r,s,l){super();R(this,"_renderMetric$",new N.Subject);R(this,"renderMetric$",this._renderMetric$.asObservable());R(this,"_renderFrameTimeMetric",null);R(this,"_renderFrameTags",{});R(this,"_afterRenderMetric$",new N.Subject);this._context=e,this._configService=t,this._sheetSkeletonManagerService=i,this._sheetRenderService=r,this._commandService=s,this._telemetryService=l,this._addNewRender(),this._initRenderMetricSubscriber()}_addNewRender(){const{scene:e,engine:t,unit:i}=this._context;this._addComponent(i),this._initRerenderScheduler(),this._initCommandListener();const r=this._context.unit.getActiveSheet();if(!r)throw new Error("No active sheet found");const s=r.getSheetId();this._sheetSkeletonManagerService.setCurrent({sheetId:s});const l=()=>e.render();this.disposeWithMe(this._context.activated$.subscribe(c=>{c?t.runRenderLoop(l):t.stopRenderLoop(l)}))}_initRenderMetricSubscriber(){const{engine:e}=this._context;e.beginFrame$.subscribe(()=>{this._renderFrameTimeMetric=null,this._renderFrameTags={}}),e.endFrame$.subscribe(()=>{this._renderFrameTimeMetric&&Object.keys(this._renderFrameTimeMetric).filter(r=>r.startsWith(M.SHEET_EXTENSION_PREFIX)).length>0&&this._afterRenderMetric$.next({frameTimeMetric:this._renderFrameTimeMetric,tags:this._renderFrameTags})}),e.renderFrameTimeMetric$.subscribe(([i,r])=>{this._renderFrameTimeMetric||(this._renderFrameTimeMetric={}),this._renderFrameTimeMetric[i]||(this._renderFrameTimeMetric[i]=[]),this._renderFrameTimeMetric[i].push(Math.round(r*100)/100)}),e.renderFrameTags$.subscribe(([i,r])=>{this._renderFrameTags[i]=r});const t=[];this._afterRenderMetric$.pipe(N.withLatestFrom(e.endFrame$)).subscribe(([i,r])=>{t.push({FPS:r.FPS,elapsedTime:r.elapsedTime,frameTime:Math.round(r.frameTime*100)/100,...i.frameTimeMetric,...i.tags}),t.length>OS&&(this._captureRenderMetric(t),t.length=0)})}_captureRenderMetric(e){var g;const t=e;if(t.length===0)return;const i=S=>{let f=0;const p=Object.entries(S).filter(([_,w])=>Array.isArray(w)).map(([_])=>_).reduce((_,w)=>{const E=S[w].reduce((O,T)=>O+T,0);return _[w]=E,_},{});return Object.keys(S).filter(_=>_.startsWith(M.SHEET_EXTENSION_PREFIX)).forEach(_=>{f+=p[_]}),{...p,extensionTotal:f}},r=e.map(S=>({...S,...i(S)})),l=(S=>Object.entries(S[0]).filter(([p,C])=>!["elapsedTime"].includes(p)).filter(([p,C])=>typeof C=="number").map(([p])=>p).reduce((p,C)=>{const _=S.map(T=>T[C]),w=Math.max(..._),E=Math.min(..._),O=_.reduce((T,P)=>T+P,0)/_.length;return p[C]={max:Math.round(w*100)/100,min:Math.round(E*100)/100,avg:Math.round(O*100)/100},p},{}))(r),c=t[t.length-1].elapsedTime,d=this._context.unit.getActiveSheet().getSheetId(),u=this._context.unit.getUnitId(),h={sheetId:d,unitId:u,elapsedTimeToStart:c,...l};this._renderMetric$.next(h),(g=this._telemetryService)==null||g.capture("sheet_render_cost",h)}_addComponent(e){const{scene:t,components:i}=this._context,r=e.getActiveSheet(),s=new M.Spreadsheet(he.MAIN);this._addViewport(r);const l=new M.SpreadsheetRowHeader(he.ROW),c=new M.SpreadsheetColumnHeader(he.COLUMN),d=new M.Rect(he.LEFT_TOP,{zIndex:2,left:-1,top:-1,fill:"rgb(248, 249, 250)",stroke:"rgb(217, 217, 217)",strokeWidth:1});this._context.mainComponent=s,i.set(he.MAIN,s),i.set(he.ROW,l),i.set(he.COLUMN,c),i.set(he.LEFT_TOP,d),t.addObjects([s],Vs),t.addObjects([l,c,d],st),t.enableLayerCache(Vs,st)}_initViewports(e,t,i){const l=new M.Viewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN,e,{left:t.width,top:i.height,bottom:0,right:0,isWheelPreventDefaultX:!0,allowCache:!0,bufferEdgeX:100,bufferEdgeY:100}),c=new M.Viewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP,e,{isWheelPreventDefaultX:!0,active:!1,allowCache:!0,bufferEdgeX:0,bufferEdgeY:0}),d=new M.Viewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT,e,{isWheelPreventDefaultX:!0,active:!1,allowCache:!0,bufferEdgeX:0,bufferEdgeY:100}),u=new M.Viewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP,e,{isWheelPreventDefaultX:!0,active:!1,allowCache:!0,bufferEdgeX:100,bufferEdgeY:0}),h=new M.Viewport(M.SHEET_VIEWPORT_KEY.VIEW_ROW_TOP,e,{active:!1,isWheelPreventDefaultX:!0}),g=new M.Viewport(M.SHEET_VIEWPORT_KEY.VIEW_ROW_BOTTOM,e,{left:0,top:i.height,bottom:0,width:t.width+1,isWheelPreventDefaultX:!0}),S=new M.Viewport(M.SHEET_VIEWPORT_KEY.VIEW_COLUMN_LEFT,e,{active:!1,isWheelPreventDefaultX:!0}),f=new M.Viewport(M.SHEET_VIEWPORT_KEY.VIEW_COLUMN_RIGHT,e,{left:t.width,top:0,height:i.height+1,right:0,isWheelPreventDefaultX:!0}),v=new M.Viewport(M.SHEET_VIEWPORT_KEY.VIEW_LEFT_TOP,e,{left:0,top:0,width:t.width,height:i.height,isWheelPreventDefaultX:!0});return{viewMain:l,viewLeftTop:v,viewMainLeftTop:c,viewMainLeft:d,viewMainTop:u,viewColumnLeft:S,viewRowTop:h,viewRowBottom:g,viewColumnRight:f}}_addViewport(e){const t=this._context.scene,{rowHeader:i,columnHeader:r}=e.getConfig(),{viewMain:s}=this._initViewports(t,i,r),l=this._configService.getConfig(Te),c=l==null?void 0:l.scrollConfig;return new M.ScrollBar(s,c),t.attachControl(),s}_initRerenderScheduler(){this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(e=>{if(!e)return null;const{skeleton:t,sheetId:i}=e,r=this._context.unit,s=r==null?void 0:r.getSheetBySheetId(i);if(r==null||s==null)return;const{mainComponent:l,components:c}=this._context,d=l,u=c.get(he.ROW),h=c.get(he.COLUMN),g=c.get(he.LEFT_TOP),{rowHeaderWidth:S,columnHeaderHeight:f}=t;d==null||d.updateSkeleton(t),u==null||u.updateSkeleton(t),h==null||h.updateSkeleton(t),g==null||g.transformByState({width:S,height:f})}))}_initCommandListener(){this.disposeWithMe(this._commandService.onCommandExecuted(e=>{const{unit:t}=this._context,{id:i}=e;if(m.COMMAND_LISTENER_SKELETON_CHANGE.includes(i)||this._sheetRenderService.checkMutationShouldTriggerRerender(i)){const r=e.params,{unitId:s,subUnitId:l}=r,c=t.getActiveSheet();if(!c)return;const d=this._context.unitId,u=c.getSheetId();if(s!==d||l!==u)return;this._sheetSkeletonManagerService.makeDirty({sheetId:u,commandId:i},!0),this._sheetSkeletonManagerService.setCurrent({sheetId:u,commandId:i})}else m.COMMAND_LISTENER_VALUE_CHANGE.includes(i)&&this._sheetSkeletonManagerService.reCalculate();e.type===a.CommandType.MUTATION&&this._markUnitDirty(e)}))}_markUnitDirty(e){if(e.id.substring(0,3)==="doc")return;const{mainComponent:t,scene:i}=this._context;if(e.id===K.SetFormulaCalculationNotificationMutation.id&&e.params.stageInfo!=null||(t&&t.makeDirty(),i.makeDirty(),!e.params))return;const r=e.params,s=this._spreadsheetViewports(i);if(e.id===m.SetRangeValuesMutation.id&&r.cellValue){const l=this._cellValueToRange(r.cellValue),c=this._rangeToBounds([l]);this._markViewportDirty(s,c),t.setDirtyArea(c)}if(e.id===m.MoveRangeMutation.id&&r.from&&r.to){const l=r.fromRange||this._cellValueToRange(r.from.value),c=r.toRange||this._cellValueToRange(r.to.value),d=this._rangeToBounds([l,c]);this._markViewportDirty(s,d),t.setDirtyArea(d)}}_cellValueToRange(e){let t=0,i=0,r=0,s=0;for(const[h,g]of Object.entries(e)){for(const S in g)t>Number(S)&&(t=Number(S)),i<Number(S)&&(i=Number(S));r>Number(h)&&(r=Number(h)),s<Number(h)&&(s=Number(h))}return{startRow:r,endRow:s,startColumn:t,endColumn:i}}_rangeToBounds(e){const t=this._sheetSkeletonManagerService.getCurrentParam().skeleton,{rowHeightAccumulation:i,columnWidthAccumulation:r,rowHeaderWidth:s,columnHeaderHeight:l}=t,c=[];for(const d of e){const{startRow:u,endRow:h,startColumn:g,endColumn:S}=d,f=u===0?0:i[u-1]+l,v=i[h]+l,p=g===0?0:r[g-1]+s,C=r[S]+s;c.push({top:f,left:p,bottom:v,right:C,width:C-p,height:v-f})}return c}_markViewportDirty(e,t){const i=e.filter(r=>r.isActive&&r.cacheBound);for(const r of i)for(const s of t)a.Rectangle.hasIntersectionBetweenTwoRect(r.cacheBound,s)&&r.markDirty(!0)}_spreadsheetViewports(e){return e.getViewports().filter(t=>["viewMain","viewMainLeftTop","viewMainTop","viewMainLeft"].includes(t.viewportKey))}},y.SheetRenderController=PS([Di(1,a.Inject(a.IConfigService)),Di(2,a.Inject(y.SheetSkeletonManagerService)),Di(3,a.Inject(y.SheetsRenderService)),Di(4,a.ICommandService),Di(5,a.Optional(gd.ITelemetryService))],y.SheetRenderController);const AS=({className:n})=>b.jsxs("svg",{className:n,width:"120",height:"2",viewBox:"0 0 120 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[b.jsx("path",{d:"M0.98999 1.08218H-0.0100098V0.0821838H0.98999V1.08218Z"}),b.jsx("path",{d:"M5.78992 1.08218H2.78992V0.0821838H5.78992V1.08218Z"}),b.jsx("path",{d:"M7.58984 1.08218H8.58984V0.0821838H7.58984V1.08218Z"}),b.jsx("path",{d:"M14.9152 1.08218H13.9152V0.0821838H14.9152V1.08218Z"}),b.jsx("path",{d:"M16.7151 1.08218H19.7151V0.0821838H16.7151V1.08218Z"}),b.jsx("path",{d:"M22.515 1.08218H21.515V0.0821838H22.515V1.08218Z"}),b.jsx("path",{d:"M27.8405 1.08218H28.8405V0.0821838H27.8405V1.08218Z"}),b.jsx("path",{d:"M33.6404 1.08218H30.6404V0.0821838H33.6404V1.08218Z"}),b.jsx("path",{d:"M35.4403 1.08218H36.4403V0.0821838H35.4403V1.08218Z"}),b.jsx("path",{d:"M42.7657 1.08218H41.7657V0.0821838H42.7657V1.08218Z"}),b.jsx("path",{d:"M44.5657 1.08218H47.5657V0.0821838H44.5657V1.08218Z"}),b.jsx("path",{d:"M50.3656 1.08218H49.3656V0.0821838H50.3656V1.08218Z"}),b.jsx("path",{d:"M55.691 1.08218H56.691V0.0821838H55.691V1.08218Z"}),b.jsx("path",{d:"M61.491 1.08218H58.491V0.0821838H61.491V1.08218Z"}),b.jsx("path",{d:"M63.2909 1.08218H64.2909V0.0821838H63.2909V1.08218Z"}),b.jsx("path",{d:"M70.6163 1.08218H69.6163V0.0821838H70.6163V1.08218Z"}),b.jsx("path",{d:"M72.4163 1.08218H75.4163V0.0821838H72.4163V1.08218Z"}),b.jsx("path",{d:"M78.2162 1.08218H77.2162V0.0821838H78.2162V1.08218Z"}),b.jsx("path",{d:"M83.5416 1.08218H84.5416V0.0821838H83.5416V1.08218Z"}),b.jsx("path",{d:"M89.3416 1.08218H86.3416V0.0821838H89.3416V1.08218Z"}),b.jsx("path",{d:"M91.1415 1.08218H92.1415V0.0821838H91.1415V1.08218Z"}),b.jsx("path",{d:"M98.4669 1.08218H97.4669V0.0821838H98.4669V1.08218Z"}),b.jsx("path",{d:"M100.267 1.08218H103.267V0.0821838H100.267V1.08218Z"}),b.jsx("path",{d:"M106.067 1.08218H105.067V0.0821838H106.067V1.08218Z"}),b.jsx("path",{d:"M111.392 1.08218H112.392V0.0821838H111.392V1.08218Z"}),b.jsx("path",{d:"M117.192 1.08218H114.192V0.0821838H117.192V1.08218Z"}),b.jsx("path",{d:"M118.992 1.08218H119.992V0.0821838H118.992V1.08218Z"})]}),DS=({className:n})=>b.jsxs("svg",{className:n,width:"120",height:"2",viewBox:"0 0 120 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[b.jsx("path",{d:"M-0.0100098 1.15771H0.98999V0.157715H-0.0100098V1.15771Z"}),b.jsx("path",{d:"M2.78992 1.15771H5.78992V0.157715H2.78992V1.15771Z"}),b.jsx("path",{d:"M8.58984 1.15771H7.58984V0.157715H8.58984V1.15771Z"}),b.jsx("path",{d:"M10.3899 1.15771H11.3899V0.157715H10.3899V1.15771Z"}),b.jsx("path",{d:"M19.0903 1.15771H18.0903V0.157715H19.0903V1.15771Z"}),b.jsx("path",{d:"M20.8903 1.15771H23.8903V0.157715H20.8903V1.15771Z"}),b.jsx("path",{d:"M26.6902 1.15771H25.6902V0.157715H26.6902V1.15771Z"}),b.jsx("path",{d:"M28.4902 1.15771H29.4902V0.157715H28.4902V1.15771Z"}),b.jsx("path",{d:"M37.1907 1.15771H36.1907V0.157715H37.1907V1.15771Z"}),b.jsx("path",{d:"M38.9906 1.15771H41.9906V0.157715H38.9906V1.15771Z"}),b.jsx("path",{d:"M44.7905 1.15771H43.7905V0.157715H44.7905V1.15771Z"}),b.jsx("path",{d:"M46.5906 1.15771H47.5906V0.157715H46.5906V1.15771Z"}),b.jsx("path",{d:"M55.291 1.15771H54.291V0.157715H55.291V1.15771Z"}),b.jsx("path",{d:"M57.0909 1.15771H60.0909V0.157715H57.0909V1.15771Z"}),b.jsx("path",{d:"M62.8909 1.15771H61.8909V0.157715H62.8909V1.15771Z"}),b.jsx("path",{d:"M64.6909 1.15771H65.6909V0.157715H64.6909V1.15771Z"}),b.jsx("path",{d:"M73.3914 1.15771H72.3914V0.157715H73.3914V1.15771Z"}),b.jsx("path",{d:"M75.1913 1.15771H78.1913V0.157715H75.1913V1.15771Z"}),b.jsx("path",{d:"M80.9912 1.15771H79.9912V0.157715H80.9912V1.15771Z"}),b.jsx("path",{d:"M82.7913 1.15771H83.7913V0.157715H82.7913V1.15771Z"}),b.jsx("path",{d:"M91.4917 1.15771H90.4917V0.157715H91.4917V1.15771Z"}),b.jsx("path",{d:"M93.2916 1.15771H96.2916V0.157715H93.2916V1.15771Z"}),b.jsx("path",{d:"M99.0916 1.15771H98.0916V0.157715H99.0916V1.15771Z"}),b.jsx("path",{d:"M100.892 1.15771H101.892V0.157715H100.892V1.15771Z"}),b.jsx("path",{d:"M109.592 1.15771H108.592V0.157715H109.592V1.15771Z"}),b.jsx("path",{d:"M111.392 1.15771H114.392V0.157715H111.392V1.15771Z"}),b.jsx("path",{d:"M117.192 1.15771H116.192V0.157715H117.192V1.15771Z"}),b.jsx("path",{d:"M118.992 1.15771H119.992V0.157715H118.992V1.15771Z"})]}),NS=({className:n})=>b.jsxs("svg",{className:n,width:"120",height:"2",viewBox:"0 0 120 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[b.jsx("path",{d:"M-0.00842285 1.22449H2.99158V0.224487H-0.00842285V1.22449Z"}),b.jsx("path",{d:"M6.14941 1.22449H9.14941V0.224487H6.14941V1.22449Z"}),b.jsx("path",{d:"M15.3073 1.22449H12.3073V0.224487H15.3073V1.22449Z"}),b.jsx("path",{d:"M18.4651 1.22449H21.4651V0.224487H18.4651V1.22449Z"}),b.jsx("path",{d:"M27.6229 1.22449H24.6229V0.224487H27.6229V1.22449Z"}),b.jsx("path",{d:"M30.7808 1.22449H33.7808V0.224487H30.7808V1.22449Z"}),b.jsx("path",{d:"M39.9386 1.22449H36.9386V0.224487H39.9386V1.22449Z"}),b.jsx("path",{d:"M43.0964 1.22449H46.0964V0.224487H43.0964V1.22449Z"}),b.jsx("path",{d:"M52.2543 1.22449H49.2543V0.224487H52.2543V1.22449Z"}),b.jsx("path",{d:"M55.4121 1.22449H58.4121V0.224487H55.4121V1.22449Z"}),b.jsx("path",{d:"M64.5699 1.22449H61.5699V0.224487H64.5699V1.22449Z"}),b.jsx("path",{d:"M67.7278 1.22449H70.7278V0.224487H67.7278V1.22449Z"}),b.jsx("path",{d:"M76.8856 1.22449H73.8856V0.224487H76.8856V1.22449Z"}),b.jsx("path",{d:"M80.0435 1.22449H83.0435V0.224487H80.0435V1.22449Z"}),b.jsx("path",{d:"M89.2013 1.22449H86.2013V0.224487H89.2013V1.22449Z"}),b.jsx("path",{d:"M92.3591 1.22449H95.3591V0.224487H92.3591V1.22449Z"}),b.jsx("path",{d:"M101.517 1.22449H98.517V0.224487H101.517V1.22449Z"}),b.jsx("path",{d:"M104.675 1.22449H107.675V0.224487H104.675V1.22449Z"}),b.jsx("path",{d:"M113.833 1.22449H110.833V0.224487H113.833V1.22449Z"}),b.jsx("path",{d:"M116.99 1.22449H119.99V0.224487H116.99V1.22449Z"})]}),kS=({className:n})=>b.jsxs("svg",{className:n,width:"120",height:"8",viewBox:"0 0 120 8",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[b.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M119.991 2.06215H-0.0090332V0.862152H119.991V1.86215Z"}),b.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M119.991 6.66215H-0.0090332V5.86215H119.991V6.86215Z"})]}),HS=({className:n})=>b.jsxs("svg",{className:n,width:"120",height:"2",viewBox:"0 0 120 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[b.jsx("path",{d:"M-0.00976562 1.65707H0.990234V0.657074H-0.00976562V1.65707Z"}),b.jsx("path",{d:"M2.32361 1.65707H3.32361V0.657074H2.32361V1.65707Z"}),b.jsx("path",{d:"M5.65698 1.65707H4.65698V0.657074H5.65698V1.65707Z"}),b.jsx("path",{d:"M6.99036 1.65707H7.99036V0.657074H6.99036V1.65707Z"}),b.jsx("path",{d:"M10.3237 1.65707H9.32373V0.657074H10.3237V1.65707Z"}),b.jsx("path",{d:"M11.6571 1.65707H12.6571V0.657074H11.6571V1.65707Z"}),b.jsx("path",{d:"M14.9905 1.65707H13.9905V0.657074H14.9905V1.65707Z"}),b.jsx("path",{d:"M16.3239 1.65707H17.3239V0.657074H16.3239V1.65707Z"}),b.jsx("path",{d:"M19.6572 1.65707H18.6572V0.657074H19.6572V1.65707Z"}),b.jsx("path",{d:"M20.9906 1.65707H21.9906V0.657074H20.9906V1.65707Z"}),b.jsx("path",{d:"M24.324 1.65707H23.324V0.657074H24.324V1.65707Z"}),b.jsx("path",{d:"M25.6573 1.65707H26.6573V0.657074H25.6573V1.65707Z"}),b.jsx("path",{d:"M28.9907 1.65707H27.9907V0.657074H28.9907V1.65707Z"}),b.jsx("path",{d:"M30.3241 1.65707H31.3241V0.657074H30.3241V1.65707Z"}),b.jsx("path",{d:"M33.6575 1.65707H32.6575V0.657074H33.6575V1.65707Z"}),b.jsx("path",{d:"M34.9908 1.65707H35.9908V0.657074H34.9908V1.65707Z"}),b.jsx("path",{d:"M38.3242 1.65707H37.3242V0.657074H38.3242V1.65707Z"}),b.jsx("path",{d:"M39.6576 1.65707H40.6576V0.657074H39.6576V1.65707Z"}),b.jsx("path",{d:"M42.991 1.65707H41.991V0.657074H42.991V1.65707Z"}),b.jsx("path",{d:"M44.3243 1.65707H45.3243V0.657074H44.3243V1.65707Z"}),b.jsx("path",{d:"M47.6577 1.65707H46.6577V0.657074H47.6577V1.65707Z"}),b.jsx("path",{d:"M48.9911 1.65707H49.9911V0.657074H48.9911V1.65707Z"}),b.jsx("path",{d:"M52.3245 1.65707H51.3245V0.657074H52.3245V1.65707Z"}),b.jsx("path",{d:"M53.6578 1.65707H54.6578V0.657074H53.6578V1.65707Z"}),b.jsx("path",{d:"M56.9912 1.65707H55.9912V0.657074H56.9912V1.65707Z"}),b.jsx("path",{d:"M58.3246 1.65707H59.3246V0.657074H58.3246V1.65707Z"}),b.jsx("path",{d:"M61.658 1.65707H60.658V0.657074H61.658V1.65707Z"}),b.jsx("path",{d:"M62.9913 1.65707H63.9913V0.657074H62.9913V1.65707Z"}),b.jsx("path",{d:"M66.3247 1.65707H65.3247V0.657074H66.3247V1.65707Z"}),b.jsx("path",{d:"M67.6581 1.65707H68.6581V0.657074H67.6581V1.65707Z"}),b.jsx("path",{d:"M70.9915 1.65707H69.9915V0.657074H70.9915V1.65707Z"}),b.jsx("path",{d:"M72.3248 1.65707H73.3248V0.657074H72.3248V1.65707Z"}),b.jsx("path",{d:"M75.6582 1.65707H74.6582V0.657074H75.6582V1.65707Z"}),b.jsx("path",{d:"M76.9916 1.65707H77.9916V0.657074H76.9916V1.65707Z"}),b.jsx("path",{d:"M80.325 1.65707H79.325V0.657074H80.325V1.65707Z"}),b.jsx("path",{d:"M81.6583 1.65707H82.6583V0.657074H81.6583V1.65707Z"}),b.jsx("path",{d:"M84.9917 1.65707H83.9917V0.657074H84.9917V1.65707Z"}),b.jsx("path",{d:"M86.3251 1.65707H87.3251V0.657074H86.3251V1.65707Z"}),b.jsx("path",{d:"M89.6584 1.65707H88.6584V0.657074H89.6584V1.65707Z"}),b.jsx("path",{d:"M90.9918 1.65707H91.9918V0.657074H90.9918V1.65707Z"}),b.jsx("path",{d:"M94.3252 1.65707H93.3252V0.657074H94.3252V1.65707Z"}),b.jsx("path",{d:"M95.6586 1.65707H96.6586V0.657074H95.6586V1.65707Z"}),b.jsx("path",{d:"M98.9919 1.65707H97.9919V0.657074H98.9919V1.65707Z"}),b.jsx("path",{d:"M100.325 1.65707H101.325V0.657074H100.325V1.65707Z"}),b.jsx("path",{d:"M103.659 1.65707H102.659V0.657074H103.659V1.65707Z"}),b.jsx("path",{d:"M104.992 1.65707H105.992V0.657074H104.992V1.65707Z"}),b.jsx("path",{d:"M108.325 1.65707H107.325V0.657074H108.325V1.65707Z"}),b.jsx("path",{d:"M109.659 1.65707H110.659V0.657074H109.659V1.65707Z"}),b.jsx("path",{d:"M112.992 1.65707H111.992V0.657074H112.992V1.65707Z"}),b.jsx("path",{d:"M114.325 1.65707H115.325V0.657074H114.325V1.65707Z"}),b.jsx("path",{d:"M117.659 1.65707H116.659V0.657074H117.659V1.65707Z"}),b.jsx("path",{d:"M118.992 1.65707H119.992V0.657074H118.992V1.65707Z"})]}),VS=({className:n})=>b.jsx("svg",{className:n,width:"120",height:"3",viewBox:"0 0 120 3",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:b.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M119.991 2.42035H-0.0090332V0.420349H119.991V2.42035Z"})}),WS=({className:n})=>b.jsxs("svg",{className:n,width:"120",height:"3",viewBox:"0 0 120 3",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[b.jsx("path",{d:"M-0.0100098 2.47614H1.98999V0.476135H-0.0100098V2.47614Z"}),b.jsx("path",{d:"M3.99014 2.47614H9.99014V0.476135H3.99014V2.47614Z"}),b.jsx("path",{d:"M13.9901 2.47614H11.9901V0.476135H13.9901V2.47614Z"}),b.jsx("path",{d:"M21.1904 2.47614H23.1904V0.476135H21.1904V2.47614Z"}),b.jsx("path",{d:"M31.1906 2.47614H25.1906V0.476135H31.1906V2.47614Z"}),b.jsx("path",{d:"M33.1906 2.47614H35.1906V0.476135H33.1906V2.47614Z"}),b.jsx("path",{d:"M44.3909 2.47614H42.3909V0.476135H44.3909V2.47614Z"}),b.jsx("path",{d:"M46.391 2.47614H52.391V0.476135H46.391V2.47614Z"}),b.jsx("path",{d:"M56.391 2.47614H54.391V0.476135H56.391V2.47614Z"}),b.jsx("path",{d:"M63.5913 2.47614H65.5913V0.476135H63.5913V2.47614Z"}),b.jsx("path",{d:"M73.5915 2.47614H67.5915V0.476135H73.5915V2.47614Z"}),b.jsx("path",{d:"M75.5915 2.47614H77.5915V0.476135H75.5915V2.47614Z"}),b.jsx("path",{d:"M86.7917 2.47614H84.7917V0.476135H86.7917V2.47614Z"}),b.jsx("path",{d:"M88.7919 2.47614H94.7919V0.476135H88.7919V2.47614Z"}),b.jsx("path",{d:"M98.7919 2.47614H96.7919V0.476135H98.7919V2.47614Z"}),b.jsx("path",{d:"M105.992 2.47614H107.992V0.476135H105.992V2.47614Z"}),b.jsx("path",{d:"M115.992 2.47614H109.992V0.476135H115.992V2.47614Z"}),b.jsx("path",{d:"M117.992 2.47614H119.992V0.476135H117.992V2.47614Z"})]}),LS=({className:n})=>b.jsxs("svg",{className:n,width:"120",height:"2",viewBox:"0 0 120 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[b.jsx("path",{d:"M-0.0100098 2.00415H1.98999V0.00415039H-0.0100098V2.00415Z"}),b.jsx("path",{d:"M3.99014 2.00415H9.99014V0.00415039H3.99014V2.00415Z"}),b.jsx("path",{d:"M13.9901 2.00415H11.9901V0.00415039H13.9901V2.00415Z"}),b.jsx("path",{d:"M15.9901 2.00415H17.9901V0.00415039H15.9901V2.00415Z"}),b.jsx("path",{d:"M27.4905 2.00415H25.4905V0.00415039H27.4905V2.00415Z"}),b.jsx("path",{d:"M29.4906 2.00415H35.4906V0.00415039H29.4906V2.00415Z"}),b.jsx("path",{d:"M39.4906 2.00415H37.4906V0.00415039H39.4906V2.00415Z"}),b.jsx("path",{d:"M41.4906 2.00415H43.4906V0.00415039H41.4906V2.00415Z"}),b.jsx("path",{d:"M52.991 2.00415H50.991V0.00415039H52.991V2.00415Z"}),b.jsx("path",{d:"M54.9911 2.00415H60.9911V0.00415039H54.9911V2.00415Z"}),b.jsx("path",{d:"M64.9911 2.00415H62.9911V0.00415039H64.9911V2.00415Z"}),b.jsx("path",{d:"M66.9911 2.00415H68.9911V0.00415039H66.9911V2.00415Z"}),b.jsx("path",{d:"M78.4915 2.00415H76.4915V0.00415039H78.4915V2.00415Z"}),b.jsx("path",{d:"M80.4916 2.00415H86.4916V0.00415039H80.4916V2.00415Z"}),b.jsx("path",{d:"M90.4916 2.00415H88.4916V0.00415039H90.4916V2.00415Z"}),b.jsx("path",{d:"M92.4916 2.00415H94.4916V0.00415039H92.4916V2.00415Z"}),b.jsx("path",{d:"M103.992 2.00415H101.992V0.00415039H103.992V2.00415Z"}),b.jsx("path",{d:"M105.992 2.00415H111.992V0.00415039H105.992V2.00415Z"}),b.jsx("path",{d:"M115.992 2.00415H113.992V0.00415039H115.992V2.00415Z"}),b.jsx("path",{d:"M117.992 2.00415H119.992V0.00415039H117.992V2.00415Z"})]}),xS=({className:n})=>b.jsxs("svg",{className:n,width:"118",height:"3",viewBox:"0 0 118 3",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[b.jsx("path",{d:"M-0.00854492 2.94815H1.99146V0.948151H-0.00854492V2.94815Z"}),b.jsx("path",{d:"M6.09668 2.94815H8.09668V0.948151H6.09668V2.94815Z"}),b.jsx("path",{d:"M14.2019 2.94815H12.2019V0.948151H14.2019V2.94815Z"}),b.jsx("path",{d:"M18.3071 2.94815H20.3071V0.948151H18.3071V2.94815Z"}),b.jsx("path",{d:"M26.4124 2.94815H24.4124V0.948151H26.4124V2.94815Z"}),b.jsx("path",{d:"M30.5176 2.94815H32.5176V0.948151H30.5176V2.94815Z"}),b.jsx("path",{d:"M38.6228 2.94815H36.6228V0.948151H38.6228V2.94815Z"}),b.jsx("path",{d:"M42.728 2.94815H44.728V0.948151H42.728V2.94815Z"}),b.jsx("path",{d:"M50.8333 2.94815H48.8333V0.948151H50.8333V2.94815Z"}),b.jsx("path",{d:"M54.9385 2.94815H56.9385V0.948151H54.9385V2.94815Z"}),b.jsx("path",{d:"M63.0437 2.94815H61.0437V0.948151H63.0437V2.94815Z"}),b.jsx("path",{d:"M67.1489 2.94815H69.1489V0.948151H67.1489V2.94815Z"}),b.jsx("path",{d:"M75.2542 2.94815H73.2542V0.948151H75.2542V2.94815Z"}),b.jsx("path",{d:"M79.3594 2.94815H81.3594V0.948151H79.3594V2.94815Z"}),b.jsx("path",{d:"M87.4645 2.94815H85.4645V0.948151H87.4645V2.94815Z"}),b.jsx("path",{d:"M91.5697 2.94815H93.5697V0.948151H91.5697V2.94815Z"}),b.jsx("path",{d:"M99.6749 2.94815H97.6749V0.948151H99.6749V2.94815Z"}),b.jsx("path",{d:"M103.78 2.94815H105.78V0.948151H103.78V2.94815Z"}),b.jsx("path",{d:"M111.885 2.94815H109.885V0.948151H111.885V2.94815Z"}),b.jsx("path",{d:"M115.991 2.94815H117.991V0.948151H115.991V2.94815Z"})]}),US=({className:n})=>b.jsx("svg",{className:n,width:"120",height:"4",viewBox:"0 0 120 4",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:b.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M119.991 3.86215H-0.0090332V0.862152H119.991V3.86215Z"})}),BS=({className:n})=>b.jsx("svg",{className:n,width:"120",height:"2",viewBox:"0 0 120 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:b.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M119.991 1.15668H-0.0090332V0.156677H119.991V1.15668Z"})});function Ql(n){const{type:o=a.BorderStyleTypes.THIN,className:e}=n;switch(o){case a.BorderStyleTypes.DASH_DOT:return b.jsx(AS,{className:e});case a.BorderStyleTypes.DASH_DOT_DOT:return b.jsx(DS,{className:e});case a.BorderStyleTypes.DASHED:return b.jsx(NS,{className:e});case a.BorderStyleTypes.HAIR:return b.jsx(HS,{className:e});case a.BorderStyleTypes.MEDIUM:return b.jsx(VS,{className:e});case a.BorderStyleTypes.MEDIUM_DASH_DOT:return b.jsx(WS,{className:e});case a.BorderStyleTypes.MEDIUM_DASH_DOT_DOT:return b.jsx(LS,{className:e});case a.BorderStyleTypes.MEDIUM_DASHED:return b.jsx(xS,{className:e});case a.BorderStyleTypes.THICK:return b.jsx(US,{className:e});case a.BorderStyleTypes.DOUBLE:return b.jsx(kS,{className:e});case a.BorderStyleTypes.THIN:default:return b.jsx(BS,{className:e})}}const FS=[{label:a.BorderStyleTypes.THIN,value:a.BorderStyleTypes.THIN},{label:a.BorderStyleTypes.HAIR,value:a.BorderStyleTypes.HAIR},{label:a.BorderStyleTypes.DOTTED,value:a.BorderStyleTypes.DOTTED},{label:a.BorderStyleTypes.DASHED,value:a.BorderStyleTypes.DASHED},{label:a.BorderStyleTypes.DASH_DOT,value:a.BorderStyleTypes.DASH_DOT},{label:a.BorderStyleTypes.DASH_DOT_DOT,value:a.BorderStyleTypes.DASH_DOT_DOT},{label:a.BorderStyleTypes.MEDIUM,value:a.BorderStyleTypes.MEDIUM},{label:a.BorderStyleTypes.MEDIUM_DASHED,value:a.BorderStyleTypes.MEDIUM_DASHED},{label:a.BorderStyleTypes.MEDIUM_DASH_DOT,value:a.BorderStyleTypes.MEDIUM_DASH_DOT},{label:a.BorderStyleTypes.MEDIUM_DASH_DOT_DOT,value:a.BorderStyleTypes.MEDIUM_DASH_DOT_DOT},{label:a.BorderStyleTypes.THICK,value:a.BorderStyleTypes.THICK},{label:a.BorderStyleTypes.DOUBLE,value:a.BorderStyleTypes.DOUBLE}];function zS(n){var o;if(n)for(const e in n){const t=n[e];if((o=t==null?void 0:t.cl)!=null&&o.rgb)return t.cl.rgb}}function XS(n){var o;if(n)for(const e in n){const t=n[e];if((o=t==null?void 0:t.cl)!=null&&o.rgb)return t.s}}function Jl(n){var g;const o=I.useDependency(I.ComponentManager),e=I.useDependency(m.BorderStyleManagerService),t=I.useDependency(m.SheetsSelectionsService),{isAllValuesSame:i,value:r}=t.getCellStylesProperty("bd"),s=i?zS(r):void 0,l=i?XS(r):void 0,{onChange:c,value:d}=n;function u(S,f){c==null||c({...d,[f]:S})}function h(S){const f=o.get(S);return f&&b.jsx(f,{className:"univer-fill-primary-600"})}return b.jsxs("section",{className:"univer-box-border univer-grid univer-gap-2 univer-p-1.5",children:[b.jsx("div",{className:"univer-box-border univer-grid univer-grid-cols-5 univer-gap-2 univer-text-gray-600 dark:!univer-text-gray-200",children:yl.map(S=>b.jsx("a",{className:X.clsx("univer-flex univer-size-6 univer-cursor-pointer univer-items-center univer-justify-center univer-justify-self-center univer-rounded hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-700",{"univer-bg-gray-200 dark:!univer-bg-gray-600":e.getBorderInfo().type===S.value}),onClick:f=>{f.stopPropagation(),u(S.value,"type")},children:h(S.icon)},S.value))}),b.jsx(X.Separator,{}),b.jsxs("div",{className:"univer-flex univer-items-center univer-gap-2",children:[b.jsx("div",{children:b.jsx(X.Dropdown,{overlay:b.jsx("div",{className:"univer-rounded-lg univer-p-4",children:b.jsx(X.ColorPicker,{value:s,onChange:S=>u(S,"color")})}),children:b.jsxs("button",{className:"univer-flex univer-cursor-pointer univer-items-center univer-gap-2 univer-rounded univer-border-none univer-bg-transparent univer-p-1 hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-700",type:"button",children:[b.jsx(Xa,{className:"univer-fill-primary-600 dark:!univer-text-white",extend:{colorChannel1:(g=d==null?void 0:d.color)!=null?g:""}}),b.jsx(Tn,{className:"dark:!univer-text-white"})]})})}),b.jsx("div",{children:b.jsx(X.Dropdown,{overlay:b.jsx("section",{className:"univer-rounded-lg univer-p-1.5",children:b.jsx("ul",{className:"univer-m-0 univer-grid univer-list-none univer-gap-1 univer-p-0",children:FS.map(S=>b.jsxs("li",{className:"univer-flex univer-cursor-pointer univer-items-center univer-justify-center univer-rounded univer-px-1 univer-py-3 hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-700",onClick:()=>u(S.value,"style"),children:[S.value===l&&b.jsx(zt,{className:"univer-absolute univer-left-3 univer-text-primary-600"}),b.jsx(Ql,{className:"univer-ml-6 univer-fill-gray-900 dark:!univer-fill-white",type:S.value})]},S.value))})}),children:b.jsxs("button",{className:"univer-flex univer-cursor-pointer univer-items-center univer-gap-2 univer-rounded univer-border-none univer-bg-transparent univer-p-1 hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-700",type:"button",children:[b.jsx(Ql,{className:"univer-fill-gray-900 dark:!univer-fill-white",type:l!=null?l:a.BorderStyleTypes.THIN}),b.jsx(Tn,{className:"dark:!univer-text-white"})]})})})]})]})}const gs="sheets.component.cell-popup";var YS=Object.getOwnPropertyDescriptor,jS=(n,o,e,t)=>{for(var i=t>1?void 0:t?YS(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Gt=(n,o)=>(e,t)=>o(e,t,n);y.SheetCanvasPopManagerService=class extends a.Disposable{constructor(e,t,i,r,s,l,c){super();R(this,"_popupMenuFeatureMap",new Map);R(this,"_isSelectionMoving",!1);this._globalPopupManagerService=e,this._renderManagerService=t,this._univerInstanceService=i,this._refRangeService=r,this._commandService=s,this._refSelectionsService=l,this._selectionManagerService=c,this._initMoving()}_initMoving(){this.disposeWithMe(this._refSelectionsService.selectionMoving$.subscribe(()=>{this._isSelectionMoving=!0})),this.disposeWithMe(this._refSelectionsService.selectionMoveEnd$.subscribe(()=>{this._isSelectionMoving=!1})),this.disposeWithMe(this._selectionManagerService.selectionMoving$.subscribe(()=>{this._isSelectionMoving=!0})),this.disposeWithMe(this._selectionManagerService.selectionMoveEnd$.subscribe(()=>{this._isSelectionMoving=!1}))}registerFeatureMenu(e,t){this._popupMenuFeatureMap.set(e,t)}getFeatureMenu(e,t,i,r){const s=this._popupMenuFeatureMap.get(r);if(s)return s(e,t,i,r)}dispose(){super.dispose(),this._popupMenuFeatureMap.clear()}_createHiddenRectObserver(e){const{row:t,column:i,worksheet:r,skeleton:s,currentRender:l}=e,c=()=>{var j,Y;const g=r.getFreeze(),{startRow:S,startColumn:f,xSplit:v,ySplit:p}=g,C=S-p,_=f-v,{rowHeightAccumulation:w,columnWidthAccumulation:E,rowHeaderWidth:O,columnHeaderHeight:T}=s,P=O+(_===-1?0:E[_+v-1]-((j=E[_-1])!=null?j:0)),A=T+(C===-1?0:w[C+p-1]-((Y=w[C])!=null?Y:0)),D=l.engine.getCanvasElement(),k=D.getBoundingClientRect(),H=Ss(D.style.width),V=k.width/H,L=l.scene.getAncestorScale().scaleX,W=P*V*L,B=A*V*L,U={left:-1/0,top:-1/0,right:k.left+W,bottom:k.top+B},z={left:k.left+W,top:-1/0,right:1/0,bottom:k.top+B},F={left:-1/0,top:k.top+B,right:k.left+W,bottom:1/0};return t<S&&i<f?[]:t<S?[U]:i<f?[U]:[U,z,F]},d=c(),u=new N.BehaviorSubject(d),h=new a.DisposableCollection;return h.add(this._commandService.onCommandExecuted(g=>{g.id===m.SetFrozenMutation.id&&u.next(c())})),h.add(a.fromEventSubject(l.engine.onTransformChange$).pipe(N.throttleTime(16)).subscribe(()=>{u.next(c())})),{rects$:u,disposable:h}}_createPositionObserver(e,t,i,r){const s=()=>{const{scene:u}=t,h=ch(e,u,i,r),g=t.engine.getCanvasElement(),S=g.getBoundingClientRect(),f=Ss(g.style.width),v=S.width/f;return{left:h.left*v+S.left,right:h.right*v+S.left,top:h.top*v+S.top,bottom:h.bottom*v+S.top}},l=s(),c=new N.BehaviorSubject(l),d=new a.DisposableCollection;return d.add(this._commandService.onCommandExecuted(u=>{fs(u.id)&&c.next(s())})),{position:l,position$:c,disposable:d}}attachPopupToObject(e,t){var w;const i=this._univerInstanceService.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),r=i.getActiveSheet();if(!r||this._isSelectionMoving&&!t.showOnSelectionMoving)return{dispose:()=>{},canDispose:()=>!0};const s=i.getUnitId(),l=r.getSheetId(),c=(w=this._renderManagerService.getRenderById(s))==null?void 0:w.with(y.SheetSkeletonManagerService).ensureSkeleton(l),d=this._renderManagerService.getRenderById(s);if(!d||!c)return{dispose:()=>{},canDispose:()=>!0};const{left:u,top:h,width:g,height:S}=e,f={left:u,right:u+g,top:h,bottom:h+S},{position:v,position$:p,disposable:C}=this._createPositionObserver(f,d,c,r),_=this._globalPopupManagerService.addPopup({...t,unitId:s,subUnitId:l,anchorRect:v,anchorRect$:p,canvasElement:d.engine.getCanvasElement()});return{dispose:()=>{this._globalPopupManagerService.removePopup(_),p.complete(),C.dispose()},canDispose:()=>this._globalPopupManagerService.activePopupId!==_}}attachPopupByPosition(e,t,i){var C;let r=this._univerInstanceService.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),s=r.getActiveSheet();if(!s)return null;const l=r.getUnitId(),c=s.getSheetId();if(l!==i.unitId||i.subUnitId!==c)return null;if(this._isSelectionMoving&&!t.showOnSelectionMoving)return;const d=(C=this._renderManagerService.getRenderById(l))==null?void 0:C.with(y.SheetSkeletonManagerService).getOrCreateSkeleton({sheetId:c}),u=this._renderManagerService.getRenderById(l);if(!u||!d)return null;const{position:h,position$:g,disposable:S}=this._createPositionObserver(e,u,d,s),{rects$:f,disposable:v}=this._createHiddenRectObserver({row:i.row,column:i.col,worksheet:s,skeleton:d,currentRender:u}),p=this._globalPopupManagerService.addPopup({...t,unitId:l,subUnitId:c,anchorRect:h,anchorRect$:g,hiddenRects$:f,canvasElement:u.engine.getCanvasElement()});return{dispose:()=>{this._globalPopupManagerService.removePopup(p),g.complete(),S.dispose(),v.dispose(),r=null,s=null},canDispose:()=>this._globalPopupManagerService.activePopupId!==p}}attachPopupToAbsolutePosition(e,t,i,r){var f;const s=this._univerInstanceService.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),l=s.getActiveSheet();if(!l)return null;const c=s.getUnitId(),d=l.getSheetId();if(i&&c!==i||r&&r!==d)return null;const u=(f=this._renderManagerService.getRenderById(c))==null?void 0:f.with(y.SheetSkeletonManagerService).ensureSkeleton(d),h=this._renderManagerService.getRenderById(c);if(!h||!u)return null;if(this._isSelectionMoving&&!t.showOnSelectionMoving)return;const g=new N.BehaviorSubject(e),S=this._globalPopupManagerService.addPopup({...t,unitId:c,subUnitId:d,anchorRect:e,anchorRect$:g.asObservable(),canvasElement:h.engine.getCanvasElement()});return{dispose:()=>{this._globalPopupManagerService.removePopup(S),g.complete()},canDispose:()=>this._globalPopupManagerService.activePopupId!==S}}attachPopupToCell(e,t,i,r,s,l){let c=this._univerInstanceService.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),d=c.getActiveSheet();if(!d)return null;const u=c.getUnitId(),h=d.getSheetId();if(r&&u!==r||s&&h!==s)return null;const g=this._renderManagerService.getRenderById(u),S=g==null?void 0:g.with(y.SheetSkeletonManagerService).ensureSkeleton(h),f=g==null?void 0:g.with(Ie);if(!g||!S||!f)return null;if(this._isSelectionMoving&&!i.showOnSelectionMoving)return;const v=l!=null?l:Ra(e,t,g.scene,d);if(!v)return null;const{position:p,position$:C,disposable:_,updateRowCol:w}=this._createCellPositionObserver(e,t,g,S,v),{rects$:E,disposable:O}=this._createHiddenRectObserver({row:e,column:t,worksheet:d,skeleton:S,currentRender:g}),T=this._globalPopupManagerService.addPopup({...i,unitId:u,subUnitId:h,anchorRect:p,anchorRect$:C,canvasElement:g.engine.getCanvasElement(),hiddenRects$:E}),P=new a.DisposableCollection;P.add(_),P.add(a.toDisposable(()=>{this._globalPopupManagerService.removePopup(T),C.complete()})),P.add(O);const A={startRow:e,endRow:e,startColumn:t,endColumn:t};return P.add(this._refRangeService.watchRange(u,h,A,(D,k)=>{k?w(k.startRow,k.startColumn):P.dispose()})),{dispose(){P.dispose(),d=null,c=null},canDispose:()=>this._globalPopupManagerService.activePopupId!==T}}attachRangePopup(e,t,i,r,s,l=!1){const c=this._univerInstanceService.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),d=c.getActiveSheet();if(!d)return null;const u=c.getUnitId(),h=d.getSheetId();if(i&&u!==i||r&&h!==r)return null;const g=this._renderManagerService.getRenderById(u),S=g==null?void 0:g.with(y.SheetSkeletonManagerService).getOrCreateSkeleton({sheetId:h}),f=g==null?void 0:g.with(Ie);if(!g||!S||!f)return null;if(f.selectionMoving&&!l)return;const v=s!=null?s:Ra(e.startRow,e.startColumn,g.scene,d);if(!v)return null;const{position:p,position$:C,disposable:_,updateRange:w,topLeftPos$:E,rightBottomPos$:O}=this._createRangePositionObserver(e,g,S,v),{rects$:T,disposable:P}=this._createHiddenRectObserver({row:e.startRow,column:e.startColumn,worksheet:d,skeleton:S,currentRender:g}),A=this._globalPopupManagerService.addPopup({...t,unitId:u,subUnitId:h,anchorRect:p,anchorRect$:C,canvasElement:g.engine.getCanvasElement(),hiddenRects$:T}),D=new a.DisposableCollection;D.add(_),D.add(a.toDisposable(()=>{this._globalPopupManagerService.removePopup(A),E.complete(),O.complete()})),D.add(P);const k={...e};return D.add(this._refRangeService.watchRange(u,h,k,(H,V)=>{V?w(V):D.dispose()})),{dispose(){D.dispose()},canDispose:()=>this._globalPopupManagerService.activePopupId!==A}}_createCellPositionObserver(e,t,i,r,s){let l=e,c=t;const d=this._calcCellPositionByCell(l,c,i,r,s),u=new N.BehaviorSubject(d),h=()=>u.next(this._calcCellPositionByCell(l,c,i,r,s)),g=new a.DisposableCollection;return g.add(i.engine.clientRect$.subscribe(()=>h())),g.add(a.fromEventSubject(i.engine.onTransformChange$).pipe(N.throttleTime(16)).subscribe(()=>h())),g.add(this._commandService.onCommandExecuted(f=>{if(f.id===m.SetWorksheetRowAutoHeightMutation.id&&f.params.rowsAutoHeightInfo.findIndex(p=>p.row===l)>-1){h();return}fs(f.id)&&h()})),{position$:u,disposable:g,position:d,updateRowCol:(f,v)=>{l=f,c=v,h()}}}_calcCellPositionByCell(e,t,i,r,s){const{scene:l,engine:c}=i;if(r._disposed||l._disposed)return{left:0,right:0,top:0,bottom:0};const d=r.getCellWithCoordByIndex(e,t),u=d.isMergedMainCell?d.mergeInfo:d,{scaleX:h,scaleY:g}=l.getAncestorScale(),S={x:s.viewportScrollX,y:s.viewportScrollY},f=c.getCanvasElement();if(!f)return{left:0,right:0,top:0,bottom:0};const v=f.getBoundingClientRect(),p=Ss(f.style.width),{top:C,left:_,width:w}=v,E=w/p;return{left:(u.startX-S.x)*E*h+_,right:(u.endX-S.x)*E*h+_,top:(u.startY-S.y)*E*g+C,bottom:(u.endY-S.y)*E*g+C}}_createRangePositionObserver(e,t,i,r){let{startRow:s,startColumn:l,endRow:c,endColumn:d}=e;const u=this._calcCellPositionByCell(s,l,t,i,r),h=new N.BehaviorSubject(u),g=this._calcCellPositionByCell(c,d,t,i,r),S=new N.BehaviorSubject(g),f=()=>{const w=this._calcCellPositionByCell(s,l,t,i,r),E=this._calcCellPositionByCell(c,d,t,i,r);h.next(w),S.next(E)},v=new a.DisposableCollection;v.add(t.engine.clientRect$.subscribe(()=>f())),v.add(this._commandService.onCommandExecuted(w=>{if(w.id===m.SetWorksheetRowAutoHeightMutation.id&&w.params.rowsAutoHeightInfo.findIndex(O=>O.row===s)>-1){f();return}fs(w.id)&&f()}));const p=w=>{s=w.startRow,l=w.startColumn,c=w.endRow,d=w.endColumn,f()},C=h.pipe(N.map(w=>{const E=this._calcCellPositionByCell(c,d,t,i,r);return{top:w.top,left:w.left,right:E.right,bottom:E.bottom}})),_={top:u.top,left:u.left,right:g.right,bottom:g.bottom};return{position$:C,position:_,updateRange:p,topLeftPos$:h,rightBottomPos$:S,disposable:v}}},y.SheetCanvasPopManagerService=jS([Gt(0,a.Inject(I.ICanvasPopupService)),Gt(1,M.IRenderManagerService),Gt(2,a.IUniverInstanceService),Gt(3,a.Inject(m.RefRangeService)),Gt(4,a.ICommandService),Gt(5,m.IRefSelectionsService),Gt(6,a.Inject(m.SheetsSelectionsService))],y.SheetCanvasPopManagerService);function Ss(n){return Number.parseInt(n.replace("px",""))}const ZS=new Set([et.id,je.id,m.SetSelectionsOperation.id]);function fs(n){return ZS.has(n)||m.COMMAND_LISTENER_SKELETON_CHANGE.includes(n)}var GS=Object.getOwnPropertyDescriptor,KS=(n,o,e,t)=>{for(var i=t>1?void 0:t?GS(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},qS=(n,o)=>(e,t)=>o(e,t,n);y.CellPopupManagerService=class extends a.Disposable{constructor(e){super();R(this,"_cellPopupMap",new Map);R(this,"_change$",new N.Subject);R(this,"change$",this._change$.asObservable());this._sheetCanvasPopManagerService=e}_ensureCellPopupMap(e,t){let i=this._cellPopupMap.get(e);i||(i=new Map,this._cellPopupMap.set(e,i));let r=i.get(t);return r||(r=new a.ObjectMatrix,i.set(t,r)),r}showPopup(e,t){var g,S;const{direction:i="horizontal"}=t,{unitId:r,subUnitId:s,row:l,col:c}=e,d=this._ensureCellPopupMap(r,s),u=(g=d.getValue(l,c))==null?void 0:g[i];t.id=(S=t.id)!=null?S:a.generateRandomId();const h=()=>{var C;const f=d.getValue(l,c);if(!f)return;const v=f[i];if(!v)return;const p=v==null?void 0:v.popups.findIndex(_=>_.id===t.id&&_.componentKey===t.componentKey);v==null||v.popups.splice(p,1),v.popups.length===0&&((C=v.disposable)==null||C.dispose(),f[i]=void 0),this._change$.next({...e,direction:i})};if(u)u.popups.push(t),u.popups.sort((f,v)=>f.priority-v.priority);else{const f=this._sheetCanvasPopManagerService.attachPopupToCell(l,c,{...t,direction:i,componentKey:gs,extraProps:{...e,direction:i},noPushMinimumGap:!0,autoRelayout:!1,zIndex:90},r,s);d.setValue(l,c,{...d.getValue(l,c),[i]:{disposable:f,popups:[t]}})}return this._change$.next({...e,direction:i}),a.toDisposable(h)}getPopups(e,t,i,r,s){var c,d;return((d=(c=this._ensureCellPopupMap(e,t).getValue(i,r))==null?void 0:c[s])==null?void 0:d.popups)||[]}hidePopup(e,t,i,r){var c,d;const s=this._ensureCellPopupMap(e,t),l=s.getValue(i,r);l&&(l.horizontal&&((c=l.horizontal.disposable)==null||c.dispose(),l.horizontal=void 0,this._change$.next({unitId:e,subUnitId:t,row:i,col:r,direction:"horizontal"})),l.vertical&&((d=l.vertical.disposable)==null||d.dispose(),l.vertical=void 0,this._change$.next({unitId:e,subUnitId:t,row:i,col:r,direction:"vertical"})),!l.horizontal&&!l.vertical&&s.realDeleteValue(i,r))}},y.CellPopupManagerService=KS([qS(0,a.Inject(y.SheetCanvasPopManagerService))],y.CellPopupManagerService);const $l=n=>{const{popup:o}=n,e=o.extraProps,{row:t,col:i,direction:r,unitId:s,subUnitId:l}=e,c=I.useDependency(y.CellPopupManagerService);I.useObservable(x.useMemo(()=>c.change$.pipe(N.filter(h=>h.row===t&&h.col===i&&h.direction===r)),[c,t,i,r]));const d=c.getPopups(s,l,t,i,r),u=I.useDependency(I.ComponentManager);return b.jsx("div",{"data-u-comp":"cell-popup",className:"univer-ml-px univer-flex univer-flex-col",children:d.map(h=>{var S;const g=u.get(h.componentKey);return g?b.jsx(g,{popup:h},(S=h.id)!=null?S:h.componentKey):null})})},ec=n=>{const{inputId:o,state:e=!1,type:t="range",confirm:i,cancel:r,name:s,formulaOrRefString:l,comment:c="",localSheetId:d=m.SCOPE_WORKBOOK_VALUE_DEFINED_NAME,hidden:u=!1,id:h}=n,S=I.useDependency(a.IUniverInstanceService).getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),f=I.useDependency(a.LocaleService),v=I.useDependency(K.IDefinedNamesService),p=I.useDependency(K.IFunctionService),C=I.useDependency(K.LexerTreeBuilder),_=I.useDependency(I.ComponentManager),w=x.useMemo(()=>_.get(jo),[]),E=x.useMemo(()=>_.get(Ui),[]);if(S==null)return;const O=x.useMemo(()=>S.getUnitId(),[]),T=x.useMemo(()=>S.getActiveSheet().getSheetId(),[]),[P,A]=x.useState(s),[D,k]=x.useState(l),[H,V]=x.useState(c),[L,W]=x.useState(d),[B,U]=x.useState(""),[z,F]=x.useState(t),[j,Y]=x.useState(!0),Q=[{label:f.t("definedName.scopeWorkbook"),value:m.SCOPE_WORKBOOK_VALUE_DEFINED_NAME}],oe=ie=>!K.isReferenceStrings(ie);x.useEffect(()=>{Y(!0),A(s),V(c),W(d);let ie=l;l.substring(0,1)===K.operatorToken.EQUALS?F("formula"):oe(l)?(F("formula"),ie=K.operatorToken.EQUALS+l):F("range"),k(ie),U("")},[e]),S.getSheetOrders().forEach(ie=>{const se=S.getSheetBySheetId(ie);Q.push({label:(se==null?void 0:se.getName())||"",value:ie})});const re=ie=>{k(ie)},ce=ie=>{k(ie||"")},G=()=>{if(P.length===0){U(f.t("definedName.nameEmpty"));return}if(v.getValueByName(O,P)!=null&&(h==null||h.length===0)){U(f.t("definedName.nameDuplicate"));return}if(!a.Tools.isValidParameter(P)||K.isReferenceStringWithEffectiveColumn(P)||!a.Tools.isStartValidPosition(P)&&!M.hasCJKText(P.substring(0,1))){U(f.t("definedName.nameInvalid"));return}if(S.getSheetOrders().map(te=>{var fe;return((fe=S.getSheetBySheetId(te))==null?void 0:fe.getName())||""}).includes(P)){U(f.t("definedName.nameSheetConflict"));return}if(D.length===0){U(f.t("definedName.formulaOrRefStringEmpty"));return}if(!j){U(f.t("definedName.formulaOrRefStringInvalid"));return}if(p.hasExecutor(P.toUpperCase())){U(f.t("definedName.nameConflict"));return}const se=S.getActiveSheet().getName();i&&i({id:h||"",name:P,formulaOrRefString:C.convertRefersToAbsolute(D,a.AbsoluteRefType.ALL,a.AbsoluteRefType.ALL,se),comment:H,localSheetId:L})},Z=ie=>{const se=ie;se==="formula"?l[0]===K.operatorToken.EQUALS?k(l):k(`${K.operatorToken.EQUALS}`):l[0]===K.operatorToken.EQUALS?k(""):k(l),F(se)},J=x.useRef(null),[ne,ue]=x.useState(!1);return I.useSidebarClick(ie=>{var te;((te=J.current)==null?void 0:te.isClickOutSide(ie))&&ue(!1)}),b.jsxs("div",{className:X.clsx("univer-grid univer-space-y-2 univer-pb-1",X.borderBottomClassName,{"univer-hidden":!e}),children:[b.jsx("div",{children:b.jsx(X.Input,{className:"univer-w-full",placeholder:f.t("definedName.inputNamePlaceholder"),value:P,allowClear:!0,onChange:A})}),b.jsx("div",{children:b.jsxs(X.RadioGroup,{value:z,onChange:Z,children:[b.jsx(X.Radio,{value:"range",children:f.t("definedName.ratioRange")}),b.jsx(X.Radio,{value:"formula",children:f.t("definedName.ratioFormula")})]})}),z==="range"?w&&b.jsx(w,{unitId:O,subUnitId:T,initialValue:D,onChange:(ie,se)=>re(se),supportAcrossSheet:!0}):E&&b.jsx("div",{className:"univer-relative univer-mt-4 univer-h-full",children:b.jsx("div",{className:"univer-relative univer-h-8 univer-select-none",children:b.jsx(E,{ref:J,className:X.clsx("univer-box-border univer-h-8 univer-w-full univer-cursor-pointer univer-items-center univer-rounded-lg univer-bg-white univer-pt-2 univer-transition-colors hover:univer-border-primary-600 dark:!univer-bg-gray-700 dark:!univer-text-white [&>div:first-child]:univer-px-2.5 [&>div]:univer-h-5 [&>div]:univer-ring-transparent",X.borderClassName),initValue:D,unitId:O,subUnitId:T,isFocus:ne,isSupportAcrossSheet:!0,onChange:(ie="")=>{ce(ie||"")},onVerify:ie=>{Y(ie)},onFocus:()=>ue(!0)})})}),b.jsx("div",{children:b.jsx(X.Select,{className:"univer-w-full",value:L,options:Q,onChange:W})}),b.jsx("div",{children:b.jsx(X.Input,{className:"univer-w-full",placeholder:f.t("definedName.inputCommentPlaceholder"),value:H,onChange:V,allowClear:!0})}),b.jsxs("div",{className:X.clsx("univer-items-center univer-gap-1 univer-text-sm univer-text-red-500",{"univer-hidden":B.length===0,"univer-flex":B.length!==0}),children:[b.jsx("span",{children:B}),b.jsx(wr,{})]}),b.jsxs("div",{className:"univer-flex univer-gap-2",children:[b.jsx(X.Button,{onClick:()=>{r==null||r()},children:f.t("definedName.cancel")}),b.jsx(X.Button,{variant:"primary",onClick:G,children:f.t("definedName.confirm")})]})]})},tc=()=>{const n=I.useDependency(a.ICommandService),e=I.useDependency(a.IUniverInstanceService).getCurrentUnitOfType(a.UniverInstanceType.UNIVER_SHEET),t=I.useDependency(a.LocaleService),i=I.useDependency(K.IDefinedNamesService),r=I.useDependency(m.SheetsSelectionsService);if(e==null)return;const s=e.getUnitId(),l=()=>{const H=i.getDefinedNameMap(s);return H?Array.from(Object.values(H)):[]},[c,d]=x.useState(!1),[u,h]=x.useState(l()),[g,S]=x.useState(null),[f,v]=x.useState();x.useEffect(()=>{const H=i.update$.subscribe(()=>{h(l())});return()=>{H.unsubscribe()}},[]);const p=H=>{const{name:V,formulaOrRefString:L,comment:W,localSheetId:B,hidden:U}=H;let z=H.id;if(z==null||z.length===0)z=a.generateRandomId(10),n.executeCommand(m.InsertDefinedNameCommand.id,{id:z,unitId:s,name:V,formulaOrRefString:L,comment:W,localSheetId:B,hidden:U});else{const F={id:z,unitId:s,name:V,formulaOrRefString:L,comment:W,localSheetId:B,hidden:U};n.executeCommand(m.SetDefinedNameCommand.id,F)}d(!1),S(null)},C=H=>{v(H)};function _(){v(null)}function w(H){const V=i.getValueById(s,H);n.executeCommand(m.RemoveDefinedNameCommand.id,{...V,unitId:s}),v(null)}const E=async H=>{const{formulaOrRefString:V,id:L}=H,W=i.getWorksheetByRef(s,V);if(!W)return;W.isSheetHidden()&&await n.executeCommand(m.SetWorksheetShowCommand.id,{unitId:s,subUnitId:W.getSheetId()}),i.focusRange(s,L)},O=()=>{const H=u.length+1,V=t.t("definedName.defaultName")+H;if(i.getValueByName(s,V)==null)return V;let L=H+1;for(;;){const W=t.t("definedName.defaultName")+L;if(i.getValueByName(s,W)==null)return W;L++}},T=()=>{var W;const H=(W=e.getActiveSheet())==null?void 0:W.getName();if(!H)return"";const V=r.getCurrentSelections();return V==null?"":V.map(B=>K.serializeRangeWithSheet(H,B.range)).join(",")},P=()=>{d(!1),S(null)},A=()=>{d(!0),S(null)},D=H=>{d(!1),S(H)},k=H=>{const V=e.getSheetBySheetId(H);return V==null?"":V.getName()};return b.jsx("div",{"data-u-comp":"defined-name-container",className:"univer-relative univer-box-border univer-w-full",children:b.jsxs("div",{className:X.clsx("univer-w-full univer-overflow-hidden univer-overflow-y-auto",X.scrollbarClassName),children:[b.jsxs("div",{className:"univer-mb-4",children:[b.jsxs(X.Button,{className:X.clsx("univer-w-full",{"univer-hidden":c}),onClick:A,children:[b.jsx(Er,{}),b.jsx("span",{className:"univer-ml-1",children:t.t("definedName.addButton")})]}),c&&b.jsx(ec,{confirm:p,cancel:P,state:c,inputId:"insertDefinedName",name:O(),formulaOrRefString:T()})]},"insertDefinedName"),u.map((H,V)=>b.jsxs("div",{className:"univer-relative univer-w-full univer-divide-x-0 univer-divide-y univer-divide-solid univer-divide-gray-200 dark:!univer-divide-gray-600",children:[b.jsxs("div",{className:X.clsx("univer-group univer-relative univer-flex univer-w-full univer-cursor-default univer-select-none univer-items-center univer-justify-between univer-rounded-md univer-p-2 hover:univer-bg-gray-50 dark:hover:!univer-bg-gray-700",{"univer-hidden":H.id===g}),onClick:()=>{E(H)},children:[b.jsxs("div",{title:H.comment,children:[b.jsxs("div",{className:"univer-my-1 univer-max-h-[100px] univer-max-w-[190px] univer-truncate univer-text-sm univer-font-medium univer-text-gray-900 dark:!univer-text-white",children:[H.name,b.jsx("span",{className:"univer-text-xxs univer-ml-1 univer-text-gray-400",children:H.localSheetId===m.SCOPE_WORKBOOK_VALUE_DEFINED_NAME||H.localSheetId==null?"":k(H.localSheetId)})]}),b.jsx("div",{className:"univer-my-1 univer-max-h-[100px] univer-w-full univer-max-w-[190px] univer-truncate univer-text-xs univer-text-gray-500",title:H.formulaOrRefString,children:H.formulaOrRefString})]}),b.jsxs("div",{className:"univer-absolute univer-right-5 univer-top-1/2 univer-hidden -univer-translate-y-1/2 univer-cursor-pointer univer-items-center univer-justify-end univer-gap-7 univer-text-xs univer-text-primary-600 group-hover:univer-flex dark:hover:!univer-bg-gray-600",children:[b.jsx(X.Tooltip,{title:t.t("definedName.updateButton"),placement:"top",children:b.jsx("a",{className:"univer-rounded univer-p-1 hover:univer-bg-gray-100",onClick:L=>{L.stopPropagation(),D(H.id)},children:b.jsx(Ua,{})})}),b.jsx(X.Tooltip,{title:t.t("definedName.deleteButton"),placement:"top",children:b.jsx("a",{className:"univer-rounded univer-p-1 univer-text-red-600 hover:univer-bg-gray-100",onClick:L=>{L.stopPropagation(),C(H.id)},children:b.jsx(ho,{})})})]})]}),b.jsx(X.Confirm,{visible:f===H.id,onClose:_,onConfirm:()=>{w(H.id)},children:t.t("definedName.deleteConfirmText")}),H.id===g&&b.jsx(ec,{confirm:p,cancel:P,state:H.id===g,id:H.id,inputId:H.id+V,name:H.name,formulaOrRefString:H.formulaOrRefString,comment:H.comment,localSheetId:H.localSheetId})]},V))]})})},nc={id:m.SetRowHiddenCommand.id,preconditions:n=>ae(n),binding:I.KeyCode.Digit9|I.MetaKeys.CTRL_COMMAND},ic={id:m.SetColHiddenCommand.id,preconditions:n=>ae(n),binding:I.KeyCode.Digit0|I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT},oc={id:Pe.id,description:"shortcut.sheet.select-below-cell",group:"3_sheet-view",binding:I.KeyCode.ARROW_DOWN,priority:100,preconditions:ae,staticParameters:{direction:a.Direction.DOWN}},rc={id:Pe.id,description:"shortcut.sheet.select-up-cell",group:"3_sheet-view",binding:I.KeyCode.ARROW_UP,priority:100,preconditions:ae,staticParameters:{direction:a.Direction.UP}},sc={id:Pe.id,description:"shortcut.sheet.select-left-cell",group:"3_sheet-view",binding:I.KeyCode.ARROW_LEFT,priority:100,preconditions:Qs,staticParameters:{direction:a.Direction.LEFT}},ac={id:Pe.id,description:"shortcut.sheet.select-right-cell",group:"3_sheet-view",binding:I.KeyCode.ARROW_RIGHT,priority:100,preconditions:Qs,staticParameters:{direction:a.Direction.RIGHT}},lc={id:Xe.id,description:"shortcut.sheet.select-next-cell",group:"3_sheet-view",binding:I.KeyCode.TAB,priority:100,preconditions:ae,staticParameters:{direction:a.Direction.RIGHT,keycode:I.KeyCode.TAB}},cc={id:Xe.id,description:"shortcut.sheet.select-previous-cell",group:"3_sheet-view",binding:I.KeyCode.TAB|I.MetaKeys.SHIFT,priority:100,preconditions:ae,staticParameters:{direction:a.Direction.LEFT,keycode:I.KeyCode.TAB}},dc={id:Xe.id,description:"shortcut.sheet.select-below-cell",group:"3_sheet-view",binding:I.KeyCode.ENTER,priority:100,preconditions:ae,staticParameters:{direction:a.Direction.DOWN,keycode:I.KeyCode.ENTER}},uc={id:Xe.id,description:"shortcut.sheet.select-up-cell",group:"3_sheet-view",binding:I.KeyCode.ENTER|I.MetaKeys.SHIFT,priority:100,preconditions:ae,staticParameters:{direction:a.Direction.UP,keycode:I.KeyCode.ENTER}},hc={id:Pe.id,description:"shortcut.sheet.select-below-value-cell",group:"3_sheet-view",binding:I.KeyCode.ARROW_DOWN|I.MetaKeys.CTRL_COMMAND,preconditions:ae,staticParameters:{direction:a.Direction.DOWN,jumpOver:ze.moveGap}},mc={id:Pe.id,description:"shortcut.sheet.select-up-value-cell",group:"3_sheet-view",binding:I.KeyCode.ARROW_UP|I.MetaKeys.CTRL_COMMAND,preconditions:ae,staticParameters:{direction:a.Direction.UP,jumpOver:ze.moveGap}},gc={id:Pe.id,description:"shortcut.sheet.select-left-value-cell",group:"3_sheet-view",binding:I.KeyCode.ARROW_LEFT|I.MetaKeys.CTRL_COMMAND,preconditions:ae,staticParameters:{direction:a.Direction.LEFT,jumpOver:ze.moveGap}},Sc={id:Pe.id,description:"shortcut.sheet.select-right-value-cell",group:"3_sheet-view",binding:I.KeyCode.ARROW_RIGHT|I.MetaKeys.CTRL_COMMAND,preconditions:ae,staticParameters:{direction:a.Direction.RIGHT,jumpOver:ze.moveGap}},fc={id:De.id,description:"shortcut.sheet.expand-selection-down",group:"3_sheet-view",binding:I.KeyCode.ARROW_DOWN|I.MetaKeys.SHIFT,preconditions:ae,staticParameters:{direction:a.Direction.DOWN}},vc={id:De.id,description:"shortcut.sheet.expand-selection-up",group:"3_sheet-view",binding:I.KeyCode.ARROW_UP|I.MetaKeys.SHIFT,preconditions:ae,staticParameters:{direction:a.Direction.UP}},pc={id:De.id,description:"shortcut.sheet.expand-selection-left",group:"3_sheet-view",binding:I.KeyCode.ARROW_LEFT|I.MetaKeys.SHIFT,preconditions:ae,staticParameters:{direction:a.Direction.LEFT}},Cc={id:De.id,description:"shortcut.sheet.expand-selection-right",group:"3_sheet-view",binding:I.KeyCode.ARROW_RIGHT|I.MetaKeys.SHIFT,preconditions:ae,staticParameters:{direction:a.Direction.RIGHT}},Ic={id:De.id,description:"shortcut.sheet.expand-selection-to-below-gap",group:"3_sheet-view",binding:I.KeyCode.ARROW_DOWN|I.MetaKeys.SHIFT|I.MetaKeys.CTRL_COMMAND,preconditions:ae,staticParameters:{direction:a.Direction.DOWN,jumpOver:ze.moveGap}},_c={id:De.id,description:"shortcut.sheet.expand-selection-to-up-gap",group:"3_sheet-view",binding:I.KeyCode.ARROW_UP|I.MetaKeys.SHIFT|I.MetaKeys.CTRL_COMMAND,preconditions:ae,staticParameters:{direction:a.Direction.UP,jumpOver:ze.moveGap}},bc={id:De.id,description:"shortcut.sheet.expand-selection-to-left-gap",group:"3_sheet-view",binding:I.KeyCode.ARROW_LEFT|I.MetaKeys.SHIFT|I.MetaKeys.CTRL_COMMAND,preconditions:ae,staticParameters:{direction:a.Direction.LEFT,jumpOver:ze.moveGap}},wc={id:De.id,description:"shortcut.sheet.expand-selection-to-right-gap",group:"3_sheet-view",binding:I.KeyCode.ARROW_RIGHT|I.MetaKeys.SHIFT|I.MetaKeys.CTRL_COMMAND,preconditions:ae,staticParameters:{direction:a.Direction.RIGHT,jumpOver:ze.moveGap}},Ec={id:Si.id,description:"shortcut.sheet.select-all",group:"3_sheet-view",binding:I.KeyCode.A|I.MetaKeys.CTRL_COMMAND,preconditions:ae,staticParameters:{expandToGapFirst:!0,loop:!0}},Tc={id:Ot.id,description:"shortcut.sheet.set-bold",group:"4_sheet-edit",preconditions:n=>ae(n),binding:I.KeyCode.B|I.MetaKeys.CTRL_COMMAND},yc={id:At.id,description:"shortcut.sheet.set-italic",group:"4_sheet-edit",preconditions:n=>ae(n),binding:I.KeyCode.I|I.MetaKeys.CTRL_COMMAND},Rc={id:Dt.id,description:"shortcut.sheet.set-underline",group:"4_sheet-edit",preconditions:n=>ae(n),binding:I.KeyCode.U|I.MetaKeys.CTRL_COMMAND},Mc={id:Nt.id,description:"shortcut.sheet.set-strike-through",group:"4_sheet-edit",preconditions:n=>ae(n),binding:I.KeyCode.X|I.MetaKeys.SHIFT|I.MetaKeys.CTRL_COMMAND},Pc={id:m.ClearSelectionContentCommand.id,preconditions:n=>ae(n),binding:I.KeyCode.DELETE,mac:I.KeyCode.BACKSPACE},Oc={id:m.ClearSelectionContentCommand.id,preconditions:n=>ae(n),mac:I.KeyCode.DELETE},Ac={id:m.ClearSelectionContentCommand.id,preconditions:n=>ae(n),binding:I.MetaKeys.SHIFT+I.KeyCode.BACKSPACE},Dc={id:ht.id,preconditions:n=>ae(n),binding:I.MetaKeys.SHIFT+I.KeyCode.DELETE},Nc={id:bn.id,description:"shortcut.sheet.zoom-in",binding:I.KeyCode.EQUAL|I.MetaKeys.CTRL_COMMAND,group:"3_sheet-view",preconditions:ae,priority:1,staticParameters:{delta:.2}},kc={id:a.NilCommand.id,binding:I.KeyCode.EQUAL|I.MetaKeys.CTRL_COMMAND},Hc={id:bn.id,description:"shortcut.sheet.zoom-out",binding:I.KeyCode.MINUS|I.MetaKeys.CTRL_COMMAND,group:"3_sheet-view",preconditions:ae,priority:1,staticParameters:{delta:-.2}},Vc={id:a.NilCommand.id,binding:I.KeyCode.MINUS|I.MetaKeys.CTRL_COMMAND},Wc={id:bn.id,description:"shortcut.sheet.reset-zoom",binding:I.KeyCode.Digit0|I.MetaKeys.CTRL_COMMAND,preconditions:ae,group:"3_sheet-view",priority:1,staticParameters:{reset:!0}},Lc={id:a.NilCommand.id,binding:I.KeyCode.Digit0|I.MetaKeys.CTRL_COMMAND};var QS=Object.getOwnPropertyDescriptor,JS=(n,o,e,t)=>{for(var i=t>1?void 0:t?QS(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},pt=(n,o)=>(e,t)=>o(e,t,n);y.SheetUIController=class extends a.Disposable{constructor(o,e,t,i,r,s,l,c){super(),this._injector=o,this._componentManager=e,this._layoutService=t,this._commandService=i,this._shortcutService=r,this._menuManagerService=s,this._uiPartsService=l,this._configService=c,this._init()}_init(){this._initComponents(),this._initCommands(),this._initMenus(),this._initShortcuts(),this._initWorkbenchParts(),this._initFocusHandler()}_initComponents(){const o=this._componentManager;this.disposeWithMe(o.register(Ze,Nl)),this.disposeWithMe(o.register(Vr,Jl)),this.disposeWithMe(o.register(wi,tc)),this.disposeWithMe(o.register(gs,$l)),this.disposeWithMe(o.register("HideGridlinesDoubleIcon",Mr))}_initCommands(){[Qr,vt,$r,Jr,bn,De,Pe,Xe,bi,di,mn,gn,ti,ni,Le,oo,Si,so,m.SetBoldCommand,Bt,Se,_i,Ot,At,Dt,Nt,mr,gr,ii,qi,Qi,dn,un,Ji,m.SetItalicCommand,m.SetStrikeThroughCommand,m.SetFontFamilyCommand,m.SetFontSizeCommand,ui,io,fn,hi,et,Cn,$e,mi,gi,ao,m.SetUnderlineCommand,wn,je,pi,ci,kt,Mt,hn,cn,lo,dt,nn,Be,vr,si,Vt,Wt,ai,li,Ii,Lt,xt,Ci,In,jn,Zn].forEach(o=>{this.disposeWithMe(this._commandService.registerCommand(o))})}_initMenus(){this._menuManagerService.mergeMenu(jl)}_initShortcuts(){[oc,rc,sc,ac,lc,cc,dc,uc,hc,mc,gc,Sc,fc,vc,pc,Cc,Ic,_c,bc,wc,Ec,Nc,Hc,Wc,Lc,kc,Vc,Tc,yc,Rc,Mc,Pc,Oc,Ac,Dc,...rl(),al,sl,ll,ul,hl,ml,Sl,cl,dl,gl,nc,ic].forEach(o=>{this.disposeWithMe(this._shortcutService.registerShortcut(o))})}_initWorkbenchParts(){const o=this._uiPartsService,e=this._injector;this.disposeWithMe(o.registerComponent(I.BuiltInUIPart.HEADER,()=>I.connectInjector(el,e))),this.disposeWithMe(o.registerComponent(I.BuiltInUIPart.FOOTER,()=>I.connectInjector($a,e))),this.disposeWithMe(o.registerComponent(I.BuiltInUIPart.CONTENT,()=>I.connectInjector(Ar,e)))}_initFocusHandler(){this.disposeWithMe(this._layoutService.registerFocusHandler(a.UniverInstanceType.UNIVER_SHEET,o=>{const e=this._injector.get(M.IRenderManagerService),t=this._injector.get(a.IUniverInstanceService),i=M.getCurrentTypeOfRenderer(a.UniverInstanceType.UNIVER_DOC,t,e),r=i==null?void 0:i.with(q.DocSelectionRenderService);r==null||r.focus()}))}},y.SheetUIController=JS([pt(0,a.Inject(a.Injector)),pt(1,a.Inject(I.ComponentManager)),pt(2,I.ILayoutService),pt(3,a.ICommandService),pt(4,I.IShortcutService),pt(5,I.IMenuManagerService),pt(6,I.IUIPartsService),pt(7,a.IConfigService)],y.SheetUIController);var $S=Object.getOwnPropertyDescriptor,ef=(n,o,e,t)=>{for(var i=t>1?void 0:t?$S(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Nn=(n,o)=>(e,t)=>o(e,t,n);const tf=a.createInterceptorKey("statusBarPermissionCorrect");class nf{constructor(){R(this,"_sum",0);R(this,"_count",0);R(this,"_countNumber",0);R(this,"_min",Number.POSITIVE_INFINITY);R(this,"_max",Number.NEGATIVE_INFINITY)}add(o,e,t){if(!a.Tools.isDefine(o==null?void 0:o.v))return;const i=o==null?void 0:o.t;let{v:r}=o;const s=c=>{this._sum+=c,this._countNumber++,this._min=Math.min(this._min,c),this._max=Math.max(this._max,c)},l=(c,d,u)=>{var S;if(!((S=c==null?void 0:c.n)!=null&&S.pattern))return;const{pattern:h}=c.n;u[h]||(u[h]=a.numfmt.getFormatInfo(h)),u[h].isDate&&s(d)};if(typeof r=="string"&&i===a.CellValueType.NUMBER){const c=Number(r);Number.isNaN(c)||(r=c)}if(typeof r=="number"&&i!==a.CellValueType.STRING)s(r);else if(i===a.CellValueType.NUMBER&&o.s){const c=e.get(o.s);l(c,r,t)}this._count++}getResults(){return{sum:this._sum,count:this._countNumber,countA:this._count,min:this._min,max:this._max}}}function of(n){const{sum:o,count:e,countA:t,min:i,max:r}=n.getResults();return[{func:K.FUNCTION_NAMES_STATISTICAL.MAX,value:r},{func:K.FUNCTION_NAMES_STATISTICAL.MIN,value:i},{func:K.FUNCTION_NAMES_MATH.SUM,value:o},{func:K.FUNCTION_NAMES_STATISTICAL.COUNTA,value:t},{func:K.FUNCTION_NAMES_STATISTICAL.COUNT,value:e},{func:K.FUNCTION_NAMES_STATISTICAL.AVERAGE,value:o/e}]}y.StatusBarController=class extends a.Disposable{constructor(e,t,i,r,s,l){super();R(this,"interceptor",new a.InterceptorManager({STATUS_BAR_PERMISSION_CORRECT:tf}));this._univerInstanceService=e,this._selectionManagerService=t,this._statusBarService=i,this._commandService=r,this._numfmtService=s,this._formulaDataModel=l,this._init()}_init(){this._registerSelectionListener()}_registerSelectionListener(){const e=a.debounce(i=>{var s;const r=(s=i[i.length-1])==null?void 0:s.primary;this._calculateSelection(i.map(l=>l.range),r)},100),t=a.debounce(i=>{var s;const r=(s=i[i.length-1])==null?void 0:s.primary;this._calculateSelection(i.map(l=>l.range),r)},500);this.disposeWithMe(a.toDisposable(this._selectionManagerService.selectionMoving$.subscribe(i=>{i&&t(i)}))),this.disposeWithMe(a.toDisposable(this._selectionManagerService.selectionMoveEnd$.subscribe(i=>{i&&e(i)}))),this.disposeWithMe(this._commandService.onCommandExecuted(i=>{if(i.id===m.SetRangeValuesMutation.id){const r=this._selectionManagerService.getCurrentSelections();r&&e(r)}}))}_clearResult(){this._statusBarService.setState(null)}getRangeStartEndInfo(e,t){return e.rangeType===a.RANGE_TYPE.ALL?{startRow:0,startColumn:0,endRow:t.getRowCount()-1,endColumn:t.getColumnCount()-1}:e.rangeType===a.RANGE_TYPE.COLUMN?{startRow:0,startColumn:e.startColumn,endRow:t.getRowCount()-1,endColumn:e.endColumn}:e.rangeType===a.RANGE_TYPE.ROW?{startRow:e.startRow,startColumn:0,endRow:e.endRow,endColumn:t.getColumnCount()-1}:{startRow:e.startRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn}}_getCellValue(e,t,i,r){var c,d,u,h;const s=i.getCellRaw(e,t),l=(c=r==null?void 0:r[e])==null?void 0:c[t];return l?{t:(d=l.t)!=null?d:s==null?void 0:s.t,v:(u=l.v)!=null?u:s==null?void 0:s.v,s:(h=l.s)!=null?h:s==null?void 0:s.s}:s}_calculateSelection(e,t){var d,u;const i=this._univerInstanceService.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET);if(!i)return this._clearResult();const r=i.getUnitId(),s=i.getActiveSheet(),l=s==null?void 0:s.getSheetId();if(!l)return this._clearResult();const c={};if(this._univerInstanceService.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET).getSheets().forEach(h=>{const g=h.getConfig();c[h.getSheetId()]={cellData:new a.ObjectMatrix(g.cellData),rowCount:g.rowCount,columnCount:g.columnCount,rowData:g.rowData,columnData:g.columnData}}),e!=null&&e.length){const h=[];e.forEach(T=>{const{startRow:P,endRow:A}=T;let D=null;for(let k=P;k<=A;k++)s.getRowVisible(k)?D===null&&(D=k):D!==null&&(h.push({...T,startRow:D,endRow:k-1}),D=null);D!==null&&h.push({...T,startRow:D,endRow:A})});const g=a.splitIntoGrid(h),S=new nf,f=i.getStyles(),v={},p=this._formulaDataModel.getArrayFormulaCellData(),C=(d=p==null?void 0:p[r])==null?void 0:d[l];for(const T of g){const{startRow:P,startColumn:A,endColumn:D,endRow:k}=this.getRangeStartEndInfo(T,s);for(let H=P;H<=k;H++)for(let V=A;V<=D;V++){const L=this._getCellValue(H,V,s,C);S.add(L,f,v)}}const _=of(S);if(_.every(T=>T===void 0))return;let w=null;if(t){const{actualRow:T,actualColumn:P}=t;w=(u=this._numfmtService.getValue(r,l,T,P))==null?void 0:u.pattern}const O={values:_.filter(T=>T!==void 0),pattern:w};this._statusBarService.setState(O)}else this._clearResult()}},y.StatusBarController=ef([Nn(0,a.IUniverInstanceService),Nn(1,a.Inject(m.SheetsSelectionsService)),Nn(2,Ei),Nn(3,a.ICommandService),Nn(4,a.Inject(m.INumfmtService)),Nn(5,a.Inject(K.FormulaDataModel))],y.StatusBarController);const xc=(n=[])=>{const o=I.useDependency(yt);x.useEffect(()=>{const e=n.map(t=>o.addShape({range:t,style:{fill:"rgba(73, 184, 17, 0.05)",strokeWidth:1,stroke:"#49B811",widgets:{}},primary:null}));return()=>{e.forEach(t=>{t&&o.removeShape(t)})}},[n])};var rf=Object.getOwnPropertyDescriptor,sf=(n,o,e,t)=>{for(var i=t>1?void 0:t?rf(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Uc=(n,o)=>(e,t)=>o(e,t,n);let kn=class extends a.Disposable{constructor(o,e){super();R(this,"_previousSheetIndex",-1);this._commandService=o,this._univerInstanceService=e,this.disposeWithMe(this._commandService.beforeCommandExecuted(t=>{if(t.id===m.RemoveSheetMutation.id)return this._beforeAdjustActiveSheetOnRemoveSheet(t)})),this.disposeWithMe(this._commandService.onCommandExecuted((t,i)=>{if(t.id===m.RemoveSheetMutation.id)return this._adjustActiveSheetOnRemoveSheet(t);if(t.id===m.SetWorksheetHideMutation.id&&t.params.hidden)return this._adjustActiveSheetOnHideSheet(t);if(i!=null&&i.fromCollab)return!1;if(t.id===m.InsertSheetMutation.id)return this._adjustActiveSheetOnInsertSheet(t);if(t.id===m.SetWorksheetHideMutation.id&&!t.params.hidden)return this._adjustActiveSheetOnShowSheet(t);if(t.id===m.SetSelectionsOperation.id)return this._adjustActiveSheetOnSelection(t)}))}_adjustActiveSheetOnHideSheet(o){var c;const{unitId:e,subUnitId:t}=o.params,i=this._univerInstanceService.getUniverSheetInstance(e);if(!i||((c=i.getActiveSheet())==null?void 0:c.getSheetId())!==t)return;const s=i.getActiveSheetIndex(),l=Bc(i,s);this._switchToNextSheet(e,l)}_beforeAdjustActiveSheetOnRemoveSheet(o){const{unitId:e,subUnitId:t}=o.params,i=this._univerInstanceService.getUniverSheetInstance(e);if(!i)return;const r=i.getSheetBySheetId(t);r&&(this._previousSheetIndex=i.getSheetIndex(r))}_adjustActiveSheetOnRemoveSheet(o){if(this._previousSheetIndex===-1)return;const{unitId:e}=o.params,t=this._univerInstanceService.getUniverSheetInstance(e);if(!t)return;if(t.getActiveSheet().getSheetId()===o.params.subUnitId){const r=this._previousSheetIndex,s=r>=1?r-1:0,l=Bc(t,s);this._switchToNextSheet(e,l)}}_adjustActiveSheetOnInsertSheet(o){const{unitId:e,sheet:t}=o.params;this._switchToNextSheet(e,t.id)}_adjustActiveSheetOnShowSheet(o){const{unitId:e,subUnitId:t}=o.params;this._switchToNextSheet(e,t)}_adjustActiveSheetOnSelection(o){var i;const{unitId:e,subUnitId:t}=o.params;t!==((i=this._univerInstanceService.getUnit(e))==null?void 0:i.getActiveSheet().getSheetId())&&this._switchToNextSheet(e,t)}_switchToNextSheet(o,e){this._commandService.executeCommand(m.SetWorksheetActiveOperation.id,{unitId:o,subUnitId:e})}};kn=sf([Uc(0,a.ICommandService),Uc(1,a.IUniverInstanceService)],kn);function Bc(n,o){const e=n.getSheetSize();for(let t=o;t>-1;t--){const i=n.getSheetByIndex(t);if(!i.getConfig().hidden)return i.getSheetId()}for(let t=o;t<e;t++){const i=n.getSheetByIndex(t);if(!i.getConfig().hidden)return i.getSheetId()}throw new Error("[ActiveWorksheetController]: could not find the next unhidden sheet! Collaboration error perhaps.")}var af=Object.getOwnPropertyDescriptor,lf=(n,o,e,t)=>{for(var i=t>1?void 0:t?af(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Fc=(n,o)=>(e,t)=>o(e,t,n),Hn=(n=>(n[n.INFO=0]="INFO",n[n.WARNING=1]="WARNING",n[n.ERROR=2]="ERROR",n))(Hn||{});y.CellAlertManagerService=class extends a.Disposable{constructor(e,t){super();R(this,"_currentAlert$",new N.Subject);R(this,"_currentAlert",new Map);R(this,"currentAlert$",this._currentAlert$.asObservable());this._renderManagerService=e,this._cellPopupManagerService=t,this.disposeWithMe(()=>{this._currentAlert$.complete()})}get currentAlert(){return this._currentAlert}showAlert(e){var h;let t=this._currentAlert.get(e.key);t&&t.dispose.dispose(),t?t.dispose.dispose():(t={alert:e,dispose:{dispose(){}}},this._currentAlert.set(e.key,t));const{location:i}=e,{row:r,col:s,unitId:l,subUnitId:c}=i;if(!this._renderManagerService.getRenderById(l))return;const u=this._cellPopupManagerService.showPopup({unitId:l,subUnitId:c,row:r,col:s},{componentKey:zc,direction:"horizontal",extraProps:{alert:e},priority:1});u&&(t&&((h=t.dispose)==null||h.dispose()),t.dispose=u),this._currentAlert$.next(Array.from(this._currentAlert.entries()))}removeAlert(e){const t=this._currentAlert.get(e);t&&(this._currentAlert.delete(e),t==null||t.dispose.dispose(),this._currentAlert$.next(Array.from(this._currentAlert.entries())))}clearAlert(){this._currentAlert.forEach(e=>{e.dispose.dispose()}),this._currentAlert.clear(),this._currentAlert$.next(Array.from(this._currentAlert.entries()))}},y.CellAlertManagerService=lf([Fc(0,M.IRenderManagerService),Fc(1,a.Inject(y.CellPopupManagerService))],y.CellAlertManagerService);function cf({popup:n}){var s;const o=(s=n.extraProps)==null?void 0:s.alert;if(!o)return null;const{type:e,title:t,message:i}=o,r={[Hn.ERROR]:b.jsx(wr,{className:"univer-mr-1.5 univer-text-red-500"}),[Hn.INFO]:b.jsx(xa,{className:"univer-mr-1.5 univer-text-blue-500"}),[Hn.WARNING]:b.jsx(Fa,{className:"univer-mr-1.5 univer-text-yellow-500"})};return b.jsxs("div",{className:"univer-z-[100] univer-box-border univer-w-[156px] univer-rounded-lg univer-bg-white univer-px-2 univer-py-1 univer-text-gray-900 univer-shadow dark:!univer-bg-black dark:!univer-text-white",children:[b.jsxs("div",{className:"univer-mb-1.5 univer-flex univer-h-5 univer-flex-row univer-items-center univer-text-sm univer-font-medium",children:[e?r[e]:null,t]}),b.jsx("div",{className:"univer-text-sm",children:i})]})}const zc="univer.sheet.cell-alert";var df=Object.getOwnPropertyDescriptor,uf=(n,o,e,t)=>{for(var i=t>1?void 0:t?df(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},hf=(n,o)=>(e,t)=>o(e,t,n);let _o=class extends a.Disposable{constructor(n,o){super(),this._context=n,this._componentManager=o,this._initComponent()}_initComponent(){this.disposeWithMe(this._componentManager.register(zc,cf))}};_o=uf([hf(1,a.Inject(I.ComponentManager))],_o);var mf=Object.getOwnPropertyDescriptor,gf=(n,o,e,t)=>{for(var i=t>1?void 0:t?mf(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Xc=(n,o)=>(e,t)=>o(e,t,n);let bo=class extends a.Disposable{constructor(n,o,e){super(),this._context=n,this._editorBridgeService=o,this._cellPopupManagerService=e,this._initEditorVisibleListener()}_initEditorVisibleListener(){this.disposeWithMe(this._editorBridgeService.visible$.pipe(N.filter(n=>n.visible)).subscribe(()=>{const n=this._editorBridgeService.getEditLocation();n&&this._cellPopupManagerService.hidePopup(n.unitId,n.sheetId,n.row,n.column)}))}};bo=gf([Xc(1,me),Xc(2,a.Inject(y.CellPopupManagerService))],bo);var Sf=Object.getOwnPropertyDescriptor,ff=(n,o,e,t)=>{for(var i=t>1?void 0:t?Sf(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},wo=(n,o)=>(e,t)=>o(e,t,n);let Vn=class extends a.Disposable{constructor(o,e,t,i){super();R(this,"_isPointer",!1);this._hoverManagerService=o,this._instanceService=e,this._commandService=t,this._renderManagerService=i,this._initPointerEvent(),this._initHover()}get _mainComponent(){var o;return(o=M.getCurrentTypeOfRenderer(a.UniverInstanceType.UNIVER_SHEET,this._instanceService,this._renderManagerService))==null?void 0:o.mainComponent}_initHover(){this.disposeWithMe(this._hoverManagerService.currentRichText$.subscribe(o=>{var e,t;o!=null&&o.bullet?(this._isPointer||(e=this._mainComponent)==null||e.setCursor(M.CURSOR_TYPE.POINTER),this._isPointer=!0):(this._isPointer&&((t=this._mainComponent)==null||t.setCursor(M.CURSOR_TYPE.AUTO)),this._isPointer=!1)}))}_initPointerEvent(){this.disposeWithMe(this._hoverManagerService.currentClickedCell$.subscribe(o=>{const{location:e,bullet:t}=o;t&&this._commandService.executeCommand(m.ToggleCellCheckboxCommand.id,{unitId:e.unitId,subUnitId:e.subUnitId,row:e.row,col:e.col,paragraphIndex:t.startIndex})}))}};Vn=ff([wo(0,a.Inject(y.HoverManagerService)),wo(1,a.IUniverInstanceService),wo(2,a.ICommandService),wo(3,M.IRenderManagerService)],Vn);const Yc=2,vf=[{value:"DEFAULT_PASTE",label:"rightClick.paste"},{value:"SPECIAL_PASTE_VALUE",label:"rightClick.pasteValue"},{value:"SPECIAL_PASTE_FORMAT",label:"rightClick.pasteFormat"},{value:"SPECIAL_PASTE_COL_WIDTH",label:"rightClick.pasteColWidth"},{value:"SPECIAL_PASTE_BESIDES_BORDER",label:"rightClick.pasteBesidesBorder"},{value:"SPECIAL_PASTE_FORMULA",label:"formula.operation.pasteFormula"}],pf=n=>{var H,V,L,W,B;const o=I.useDependency(a.IUniverInstanceService),e=I.useDependency(M.IRenderManagerService),t=St();if(!n||!t)return null;const i={startRow:n.rows[0],startCol:n.cols[0],endRow:n.rows[n.rows.length-1],endCol:n.cols[n.cols.length-1]};if(i.endRow<0||i.endCol<0)return null;const r=e.getRenderById(t.getUnitId()),s=r==null?void 0:r.with(y.SheetSkeletonManagerService),l=r==null?void 0:r.with(Ie),c=He(o,e);if(!c||!l)return null;const{scene:d}=c,u=s==null?void 0:s.getCurrentSkeleton(),h=l.getViewPort(),g=d==null?void 0:d.scaleX,S=d==null?void 0:d.scaleY,f=d==null?void 0:d.getViewportScrollXY(h),v=(H=d.getEngine())==null?void 0:H.getCanvas();if(!g||!d||!g||!S||!f)return null;const p=u==null?void 0:u.getNoMergeCellPositionByIndex(i.endRow,i.endCol),C=(V=p==null?void 0:p.endX)!=null?V:0,_=(L=p==null?void 0:p.endY)!=null?L:0,w=(W=M.convertTransformToOffsetX(C,g,f))!=null?W:-9999,E=(B=M.convertTransformToOffsetY(_,S,f))!=null?B:-9999,O=v==null?void 0:v.getWidth(),T=v==null?void 0:v.getHeight();if(!O||!T)return null;const P=w+50<=O,A=E+50<=T;let D=w,k=E;return P||(D=O-100),A||(k=T-100),{positionX:D,positionY:k}},Cf=()=>{const n=I.useDependency(ke),o=I.useObservable(n.showMenu$,!1),e=I.useObservable(n.pasteOptionsCache$,null),t=I.useDependency(a.LocaleService),i=I.useDependency(a.ICommandService),[r,s]=x.useState(!1),[l,c]=x.useState(!1),d=e==null?void 0:e.target.pastedRange,u=pf(d);if(!u||!o||u.positionX<50||u.positionY<30)return null;const h=r||l,g=S=>{c(!1),i.executeCommand(ha.id,{type:S})};return b.jsx("div",{className:"univer-absolute univer-inset-0 univer-z-10 univer-size-0",children:b.jsx("div",{className:"univer-absolute",style:{left:u.positionX+Yc,top:u.positionY+Yc},onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),children:b.jsx(X.DropdownMenu,{align:"start",items:vf.map(S=>({type:"checkbox",value:S.value,label:t.t(S.label),checked:(e==null?void 0:e.pasteType)===ge[S.value],onSelect:()=>g(S.value)})),open:l,onOpenChange:c,children:b.jsxs("div",{className:X.clsx("univer-flex univer-items-center univer-gap-2 univer-rounded univer-p-1 hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-800",X.borderClassName,{"univer-bg-gray-100 dark:!univer-bg-gray-800":l,"univer-bg-white dark:!univer-bg-gray-900":!l}),children:[b.jsx(Ya,{className:"univer-fill-primary-600 univer-text-gray-900 dark:!univer-text-white"}),h&&b.jsx(Tn,{className:"dark:!univer-text-white"})]})})})})},If=[Se.id,m.SetRangeValuesCommand.id,je.id,m.MoveRangeMutation.id,m.RemoveRowMutation.id,m.RemoveColMutation.id,m.InsertRowMutation.id,m.InsertColMutation.id,m.MoveRowsMutation.id,m.MoveColsMutation.id,m.SetWorksheetColWidthMutation.id,m.SetWorksheetRowHeightMutation.id,m.SetSelectionsOperation.id,a.UndoCommandId];function _f(n,o,e,t,i){const r=[],s=[];if(t.copyType===xe.CUT){const{undos:l,redos:c}=bf(n,o,i);r.push(...c),s.push(...l)}else{const{undos:l,redos:c}=Gc(o,e,i);r.push(...c),s.push(...l);const{undos:d,redos:u}=wf(o,e,i);r.push(...u),s.push(...d);const{undos:h,redos:g}=jc(o,n,e,i);r.push(...g),s.push(...h);const{undos:S,redos:f}=Zc(o,n,e,i,!0);r.push(...f),s.push(...S);const{undos:v,redos:p}=vs(o,e,i);r.push(...p),s.push(...v)}return{undos:s,redos:r}}function bf(n,o,e){let t=[],i=[];const{range:r,subUnitId:s,unitId:l}=n,{range:c,subUnitId:d}=o,u=c?at(c):null,h=r?at(r):null;if(h&&u){const g=e.get(a.IUniverInstanceService),S=e.get(m.SheetInterceptorService),f=g.getUniverSheetInstance(l),v=f==null?void 0:f.getSheetBySheetId(s),p=f==null?void 0:f.getSheetBySheetId(d);if(v&&p){const C=new a.ObjectMatrix,_=new a.ObjectMatrix,w=v.getCellMatrix(),E=p.getCellMatrix();a.Range.foreach(h,(U,z)=>{C.setValue(U,z,a.cloneCellData(w.getValue(U,z))),_.setValue(U,z,null)});const O=new a.ObjectMatrix;a.Range.foreach(u,(U,z)=>{O.setValue(U,z,a.cloneCellData(E.getValue(U,z)))});const T=new a.ObjectMatrix;a.Range.foreach(h,(U,z)=>{const F=a.cellToRange(U,z),j=a.Rectangle.getRelativeRange(F,h),Y=a.Rectangle.getPositionRange(j,u);T.setValue(Y.startRow,Y.startColumn,w.getValue(U,z))});const P={fromRange:h,toRange:u,from:{value:_.getMatrix(),subUnitId:s},to:{value:T.getMatrix(),subUnitId:d},unitId:l},A={fromRange:u,toRange:h,from:{value:C.getMatrix(),subUnitId:s},to:{value:O.getMatrix(),subUnitId:d},unitId:l},D=S.onCommandExecute({id:m.MoveRangeCommand.id,params:{toRange:u,fromRange:h}}),k=v.getMergeData(),H=p.getMergeData(),V=k.filter(U=>a.Rectangle.intersects(U,h)),L=H.filter(U=>a.Rectangle.intersects(U,u)),W=[],B=[];if(V.length>0||L.length>0){const U=V.map(F=>a.Rectangle.getRelativeRange(F,h)).map(F=>a.Rectangle.getPositionRange(F,u)),z=m.getAddMergeMutationRangeByType(U);V.length>0&&(W.push({id:m.RemoveWorksheetMergeMutation.id,params:{unitId:l,subUnitId:s,ranges:V}}),B.push({id:m.AddWorksheetMergeMutation.id,params:{unitId:l,subUnitId:s,ranges:V}})),L.length>0&&(W.push({id:m.RemoveWorksheetMergeMutation.id,params:{unitId:l,subUnitId:s,ranges:L}}),B.push({id:m.AddWorksheetMergeMutation.id,params:{unitId:l,subUnitId:d,ranges:L}})),W.push({id:m.AddWorksheetMergeMutation.id,params:{unitId:l,subUnitId:d,ranges:z}}),B.unshift({id:m.RemoveWorksheetMergeMutation.id,params:{unitId:l,subUnitId:d,ranges:z}})}t=[{id:m.MoveRangeMutation.id,params:P},...D.redos,...W,{id:m.SetSelectionsOperation.id,params:{unitId:l,subUnitId:d,selections:[{range:u,primary:m.getPrimaryForRange(u,p)}],type:m.SelectionMoveType.MOVE_END}}],i=[{id:m.MoveRangeMutation.id,params:A},...D.undos,...B,{id:m.SetSelectionsOperation.id,params:{unitId:l,subUnitId:s,type:m.SelectionMoveType.MOVE_END,selections:[{range:h,primary:m.getPrimaryForRange(h,v)}]}}]}}return{undos:i,redos:t}}function jc(n,o,e,t){var f;const{unitId:i,subUnitId:r,range:s}=n,l=(f=t.get(a.IUniverInstanceService).getUniverSheetInstance(i))==null?void 0:f.getSheetBySheetId(r),c=[],d=[],{mapFunc:u}=lt([s]),h=new a.ObjectMatrix;e.forValue((v,p,C)=>{var O,T;const{row:_,col:w}=u(v,p),E={v:C.v,t:C.t};if(!C.p&&C.v&&!o){const P=l==null?void 0:l.getCellStyle(_,w);if(a.isTextFormat((O=P==null?void 0:P.n)==null?void 0:O.pattern))E.t=a.CellValueType.STRING;else{const A=String(C.v),D=a.getNumfmtParseValueFilter(A);(D==null?void 0:D.v)!==void 0&&typeof D.v=="number"&&(!D.z&&a.willLoseNumericPrecision(A)?E.t=a.CellValueType.FORCE_STRING:E.v=D.v)}}if((T=C.p)!=null&&T.body&&Nr(C.p.body)){const P={p:a.cloneValue(C.p),v:C.v};h.setValue(_,w,P)}else h.setValue(_,w,E&&a.cloneCellData(E))});const g={unitId:i,subUnitId:r,cellValue:a.cloneCellDataMatrix(h.getMatrix())};c.push({id:m.SetRangeValuesMutation.id,params:g});const S=m.SetRangeValuesUndoMutationFactory(t,g);return d.push({id:m.SetRangeValuesMutation.id,params:S}),{undos:d,redos:c}}function Zc(n,o,e,t,i=!1){var v;const r=[],s=[],{unitId:l,subUnitId:c,range:d}=n,u=(v=t.get(a.IUniverInstanceService).getUniverSheetInstance(l))==null?void 0:v.getSheetBySheetId(c),h=new a.ObjectMatrix,{mapFunc:g}=lt([d]);e.forValue((p,C,_)=>{var A,D;const w={s:Object.assign({},{...a.DEFAULT_STYLES,pd:M.DEFAULT_PADDING_DATA,bg:null,cl:null},_.s)},E=w.s.bd;E&&(Object.keys(E).length>0||(w.s.bd={b:null,l:null,r:null,t:null}));const{row:O,col:T}=g(p,C),P=u==null?void 0:u.getCellStyle(O,T);if(_.v&&!o&&a.isTextFormat((A=P==null?void 0:P.n)==null?void 0:A.pattern))w.s||(w.s={}),w.s.n=P==null?void 0:P.n;else{const k=String(_.v),H=a.getNumfmtParseValueFilter(k);H!=null&&H.z&&(w.s||(w.s={}),typeof w.s=="object"&&((D=w.s)!=null&&D.n?w.s.n.pattern=H.z:w.s.n={pattern:H.z}))}h.setValue(O,T,w)});const S={unitId:l,subUnitId:c,cellValue:a.cloneCellDataMatrix(h.getMatrix())};r.push({id:m.SetRangeValuesMutation.id,params:S});const f=m.SetRangeValuesUndoMutationFactory(t,S);return s.push({id:m.SetRangeValuesMutation.id,params:f}),{undos:s,redos:r}}function Gc(n,o,e){const t=[],i=[],r=new a.ObjectMatrix,{unitId:s,subUnitId:l,range:c}=n,{mapFunc:d}=lt([c]);if(o.forEach((u,h)=>{Object.keys(h).forEach(g=>{const S=Number(g),{row:f,col:v}=d(u,S);r.setValue(f,v,{s:null})})}),r.getLength()>0){const u={subUnitId:l,unitId:s,cellValue:a.cloneCellDataMatrix(r.getMatrix())};t.push({id:m.SetRangeValuesMutation.id,params:u});const h=m.SetRangeValuesUndoMutationFactory(e,u);i.push({id:m.SetRangeValuesMutation.id,params:h})}return{undos:i,redos:t}}function wf(n,o,e){const t=[],i=[],r=new a.ObjectMatrix,{unitId:s,subUnitId:l,range:c}=n,{mapFunc:d}=lt([c]);if(o.forValue((u,h,g)=>{const{row:S,col:f}=d(u,h);r.setValue(S,f,{v:null,p:null})}),r.getLength()>0){const u={subUnitId:l,unitId:s,cellValue:a.cloneCellDataMatrix(r.getMatrix())};t.push({id:m.SetRangeValuesMutation.id,params:u});const h=m.SetRangeValuesUndoMutationFactory(e,u);i.push({id:m.SetRangeValuesMutation.id,params:h})}return{undos:i,redos:t}}function vs(n,o,e){const t=[],i=[],{unitId:r,subUnitId:s,range:l}=n,{startColumn:c,startRow:d,endColumn:u,endRow:h}=at(l),g=[];o.forValue((_,w,E)=>{if(E.rowSpan&&E.rowSpan>1){const O=E.colSpan||1,T={startRow:d+_,endRow:d+_+E.rowSpan-1,startColumn:c+w,endColumn:c+w+O-1};g.push(T)}else if(E.colSpan&&E.colSpan>1){const O=E.rowSpan||1,T={startRow:d+_,endRow:d+_+O-1,startColumn:c+w,endColumn:c+w+E.colSpan-1};g.push(T)}});const f=e.get(a.IUniverInstanceService).getUniverSheetInstance(r),v=f==null?void 0:f.getSheetBySheetId(s);if(f&&v){const w=v.getMergeData().filter(T=>a.Rectangle.intersects({startRow:d,startColumn:c,endRow:h,endColumn:u},T)),E={unitId:r,subUnitId:s,ranges:w};t.push({id:m.RemoveWorksheetMergeMutation.id,params:E});const O=m.RemoveMergeUndoMutationFactory(e,E);i.push({id:m.AddWorksheetMergeMutation.id,params:O})}const p={unitId:r,subUnitId:s,ranges:g};g.length>0&&t.push({id:m.AddWorksheetMergeMutation.id,params:p});const C=m.AddMergeUndoMutationFactory(e,p);return g.length>0&&i.push({id:m.RemoveWorksheetMergeMutation.id,params:C}),{undos:i,redos:t}}function Ef(n){if(!n.includes("\r")&&a.Tools.isLegalUrl(n)){const t=a.generateRandomId(),i=`${n}`,r={startIndex:0,endIndex:i.length-1,rangeId:t,rangeType:a.CustomRangeType.HYPERLINK,properties:{url:n}};return{dataStream:`${i}\r
`,paragraphs:[{startIndex:i.length}],customRanges:[r]}}let o=n.replace(/(\r\n|\n)/g,"\r");o.endsWith(`\r
`)||(o+=`\r
`);const e=[];for(let t=0;t<o.length;t++)o[t]==="\r"&&e.push({startIndex:t});return{dataStream:o,paragraphs:e,sectionBreaks:[{startIndex:o.indexOf(`
`)}]}}var Tf=Object.getOwnPropertyDescriptor,yf=(n,o,e,t)=>{for(var i=t>1?void 0:t?Tf(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Ge=(n,o)=>(e,t)=>o(e,t,n);const Rf=[m.InsertColMutation.id,m.InsertRowMutation.id,m.RemoveColMutation.id,m.RemoveRowMutation.id,m.MoveRangeMutation.id,m.MoveRowsMutation.id,m.MoveColsMutation.id];let Kt=class extends a.RxDisposable{constructor(o,e,t,i,r,s,l,c,d,u){super();R(this,"_refreshOptionalPaste$",new N.Subject);R(this,"refreshOptionalPaste$",this._refreshOptionalPaste$.asObservable());this._injector=o,this._instanceService=e,this._renderManagerService=t,this._commandService=i,this._contextService=r,this._configService=s,this._sheetClipboardService=l,this._messageService=c,this._localService=d,this._uiPartsService=u,this._init(),this._initCommandListener(),this._initUIComponents(),this._pasteWithDoc()}refreshOptionalPaste(){this._refreshOptionalPaste$.next(Math.random())}_pasteWithDoc(){var t;const o=i=>{i.onPaste$.pipe(N.takeUntil(this.dispose$)).subscribe(r=>{var u,h;if(!ae(this._contextService))return;r.event.preventDefault();const s=r.event,l=(u=s.clipboardData)==null?void 0:u.getData("text/html"),c=(h=s.clipboardData)==null?void 0:h.getData("text/plain"),d=this._resolveClipboardFiles(s.clipboardData);this._commandService.executeCommand(Gi.id,{htmlContent:l,textContent:c,files:d})}),i==null||i.onKeydown$.subscribe(r=>{r.event.key==="Escape"&&this._sheetClipboardService.removeMarkSelection()})};let e=(t=this._renderManagerService.getRenderById(a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY))==null?void 0:t.with(q.DocSelectionRenderService);e&&o(e),this._renderManagerService.created$.subscribe(i=>{var r;i.unitId===a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY&&(e=(r=this._renderManagerService.getRenderById(a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY))==null?void 0:r.with(q.DocSelectionRenderService),e&&o(e))})}_resolveClipboardFiles(o){if(!o)return;const e=Array.from(o.items).map(t=>t.kind==="file"?t.getAsFile():void 0).filter(Boolean);return e.length>0?e:void 0}_init(){[Ve,ht,We].forEach(e=>this.disposeWithMe(this._commandService.registerMultipleCommand(e))),[sn,an,Rt,ln,Gi,ha].forEach(e=>this.disposeWithMe(this._commandService.registerCommand(e))),this.disposeWithMe(this._sheetClipboardService.addClipboardHook(this._initCopyingHooks())),this.disposeWithMe(this._sheetClipboardService.addClipboardHook(this._initPastingHook()));const o=this._initSpecialPasteHooks().map(e=>this._sheetClipboardService.addClipboardHook(e));this.disposeWithMe({dispose:()=>o.forEach(e=>e.dispose())})}_initCopyingHooks(){const o=this;let e=null;return{id:ut.DEFAULT_COPY,isDefaultHook:!0,onBeforeCopy(t,i){e=o._getWorksheet(t,i)},onCopyCellContent(t,i){var l,c,d,u;const r=e.getCell(t,i);return(c=(l=r==null?void 0:r.p)==null?void 0:l.body)!=null&&c.paragraphs||(u=(d=r==null?void 0:r.p)==null?void 0:d.body)!=null&&u.textRuns?q.convertBodyToHtml(r.p):r?a.extractPureTextFromCell(r):""},onCopyCellStyle:(t,i,r,s)=>{const l={};(r||s)&&(l.rowspan=`${r||1}`,l.colspan=`${s||1}`);const c=e.getMergedCell(t,i),d=e.getComposedCellStyle(t,i);let u="";if(d&&(u=a.handleStyleToString(d)),c){const h=c.endRow,g=c.endColumn,f=e.getRange(h,g).getTextStyle();if(f){const v=a.handleStyleToString(f);u?u+=v?`;${v}`:"":u=v}}return u&&(l.style=u),Object.keys(l).length?l:null},onCopyColumn(t){return{width:`${e.getColumnWidth(t)}`}},onCopyRow(t){return{style:`height: ${e.getRowHeight(t)}px;`}},onAfterCopy(){e=null},getFilteredOutRows(t,i,r){const s=o._getWorksheet(t,i);if(!s)return[];const{startRow:l,endRow:c}=r,d=[];for(let u=l;u<=c;u++)s.getRowFiltered(u)&&d.push(u);return d}}}_initPastingHook(){const o=this;let e=null,t=null,i=null;return{id:ge.DEFAULT_PASTE,isDefaultHook:!0,onBeforePaste({unitId:r,subUnitId:s,range:l}){i=o._getWorksheet(r,s),e=r,t=s;const c=o._configService.getConfig(m.MAX_CELL_PER_SHEET_KEY),d=l.rows[l.rows.length-1],u=l.cols[l.cols.length-1];return c&&d*u>c?(o._messageService.show({type:X.MessageType.Error,content:o._localService.t("clipboard.paste.exceedMaxCells")}),!1):!0},onPasteRows(r,s){const{range:l}=r,c=[],d=[],u=i.getMaxRows(),h=u-1,g=l.rows[l.rows.length-1]-h,S=s.length-g,f=i.getRowManager();if(g>0){const C={};s.slice(S).forEach((E,O)=>{const{height:T}=E||{};T&&(C[O]={h:Number.parseFloat(T),hd:a.BooleanNumber.FALSE})});const _={startColumn:l.cols[0],endColumn:l.cols[l.cols.length-1],endRow:l.rows[l.rows.length-1],startRow:u},w={unitId:e,subUnitId:t,range:_,rowInfo:C};c.push({id:m.InsertRowMutation.id,params:w}),d.push({id:m.RemoveRowMutation.id,params:{unitId:e,subUnitId:t,range:_}})}const v={},p={};if(s.slice(0,S).forEach((C,_)=>{var E,O;const{height:w}=C;if(w){const T=f.getRow(l.rows[0]+_),P=Number.parseFloat(w);if(T){const{h:A=a.DEFAULT_WORKSHEET_ROW_HEIGHT,ah:D=0}=T,k=Math.max(A,D);P>k?(v[_+l.rows[0]]=P,p[_+l.rows[0]]=k):(v[_+l.rows[0]]=k,p[_+l.rows[0]]=k)}else v[_+l.rows[0]]=P,p[_+l.rows[0]]=(O=(E=f.getRow(l.rows[0]+_))==null?void 0:E.h)!=null?O:a.DEFAULT_WORKSHEET_ROW_HEIGHT}}),Object.keys(v).length){const C={unitId:e,subUnitId:t,ranges:[{startRow:l.rows[0],endRow:Math.min(l.rows[l.rows.length-1],u),startColumn:l.cols[0],endColumn:l.cols[l.cols.length-1]}],rowHeight:v};c.push({id:m.SetWorksheetRowHeightMutation.id,params:C}),d.push({id:m.SetWorksheetRowHeightMutation.id,params:{...C,rowHeight:p}})}return{redos:c,undos:d}},onPasteColumns(r,s,l){var w;const{range:c}=r,d=[],u=[],h=i.getMaxColumns(),g=h-1,S=c.cols[c.cols.length-1]-g,f=s.length-S,v=(w=o._configService.getConfig(a.DEFAULT_WORKSHEET_COLUMN_WIDTH_KEY))!=null?w:a.DEFAULT_WORKSHEET_COLUMN_WIDTH,p=c.cols,C=p[0];if(S>0){const E={startRow:c.rows[0],endRow:c.rows[c.rows.length-1],endColumn:c.cols[c.cols.length-1],startColumn:h},O={unitId:e,subUnitId:t,range:E,colInfo:s.slice(f).map((T,P)=>({w:T.width?Math.max(+T.width,i.getColumnWidth(p[P])):v,hd:a.BooleanNumber.FALSE}))};d.push({id:m.InsertColMutation.id,params:O}),u.push({id:m.RemoveColMutation.id,params:{unitId:e,subUnitId:t,range:E}})}const _={unitId:e,subUnitId:t,ranges:[{startRow:c.rows[0],endRow:c.rows[c.rows.length-1],startColumn:c.cols[0],endColumn:Math.min(c.cols[c.cols.length-1],h)}]};if(s.length>0){const E={..._,colWidth:s.slice(0,f).reduce((T,P,A)=>{var D;return T[A+C]=P.width?Math.max(+P.width,(D=i.getColumnWidth(p[A]))!=null?D:v):v,T},{})},O={..._,colWidth:s.slice(0,f).reduce((T,P,A)=>{var D;return T[A+C]=(D=i.getColumnWidth(p[A]))!=null?D:v,T},{})};d.push({id:m.SetWorksheetColWidthMutation.id,params:E}),u.push({id:m.SetWorksheetColWidthMutation.id,params:O})}return{redos:d,undos:u}},onPastePlainText(r,s,l){return o._onPastePlainText(r,s,l)},onPasteCells(r,s,l,c){return o._onPasteCells(r,s,l,c)},onAfterPaste(r){i=null}}}_generateDocumentDataModelSnapshot(o){var l,c;const e=(l=M.withCurrentTypeOfRenderer(a.UniverInstanceType.UNIVER_SHEET,y.SheetSkeletonManagerService,this._instanceService,this._renderManagerService))==null?void 0:l.getCurrentParam();if(e==null)return null;const{skeleton:t}=e,i=(c=t.getBlankCellDocumentModel())==null?void 0:c.documentModel,s={...i==null?void 0:i.getSnapshot(),...o};return i==null||i.reset(s),i==null?void 0:i.getSnapshot()}_onPastePlainText(o,e,t){const{range:i,unitId:r,subUnitId:s}=o;let l;if(/\r|\n/.test(e)||a.Tools.isLegalUrl(e)){const d=Ef(e),u=this._generateDocumentDataModelSnapshot({body:d});l={[i.rows[0]]:{[i.cols[0]]:{p:u,v:null,f:null}}}}else if(a.isFormulaString(e))l={[i.rows[0]]:{[i.cols[0]]:{f:e,v:null,p:null}}};else{const d=a.getNumfmtParseValueFilter(e);d!=null&&d.z?l={[i.rows[0]]:{[i.cols[0]]:{v:d.v,s:{n:{pattern:d.z}},f:null}}}:l={[i.rows[0]]:{[i.cols[0]]:{v:e,f:null}}}}const c={unitId:r,subUnitId:s,cellValue:l};return{redos:[{id:m.SetRangeValuesMutation.id,params:c}],undos:[{id:m.SetRangeValuesMutation.id,params:m.SetRangeValuesUndoMutationFactory(this._injector,c)}]}}_onPasteCells(o,e,t,i){return this._injector.invoke(r=>_f(o,e,t,i,r))}_initSpecialPasteHooks(){const o=this,e={id:ge.SPECIAL_PASTE_VALUE,specialPasteInfo:{label:"specialPaste.value"},onPasteCells:(s,l,c)=>this._injector.invoke(d=>jc(l,s,c,d))},t={id:ge.SPECIAL_PASTE_FORMAT,specialPasteInfo:{label:"specialPaste.format"},onPasteCells:(s,l,c)=>{const d=[],u=[],{undos:h,redos:g}=this._injector.invoke(C=>Gc(l,c,C));d.push(...g),u.push(...h);const{undos:S,redos:f}=this._injector.invoke(C=>vs(l,c,C));d.push(...f),u.push(...S);const{undos:v,redos:p}=this._injector.invoke(C=>Zc(l,s,c,C));return d.push(...p),u.push(...v),{undos:u,redos:d}}},i={id:ge.SPECIAL_PASTE_COL_WIDTH,specialPasteInfo:{label:"specialPaste.colWidth"},onPasteCells(){return{undos:[],redos:[]}},onPasteColumns(s,l,c){var A,D;const d=o._instanceService.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),u=d.getUnitId(),h=(A=d.getActiveSheet())==null?void 0:A.getSheetId();if(!u||!h)throw new Error("Cannot find unitId or subUnitId");const g=[],S=[],f=o._getWorksheet(u,h),{range:v}=s,p=v.cols,C=p[0],_=f.getMaxColumns(),w=v.cols[v.cols.length-1]-_,E=l.length-w,O=(D=o._configService.getConfig(a.DEFAULT_WORKSHEET_COLUMN_WIDTH_KEY))!=null?D:a.DEFAULT_WORKSHEET_COLUMN_WIDTH,T={unitId:u,subUnitId:h,ranges:[{startRow:v.rows[0],endRow:Math.min(v.cols[v.cols.length-1],_),startColumn:v.cols[0],endColumn:v.cols[v.cols.length-1]}],colWidth:l.slice(0,E).reduce((k,H,V)=>{var L;return k[V+C]=H.width?Math.max(+H.width,(L=f.getColumnWidth(p[V]))!=null?L:O):O,k},{})},P={unitId:u,subUnitId:h,ranges:[{startRow:v.rows[0],endRow:Math.min(v.cols[v.cols.length-1],_),startColumn:v.cols[0],endColumn:v.cols[v.cols.length-1]}],colWidth:l.slice(0,E).reduce((k,H,V)=>{var L;return k[V+C]=(L=f.getColumnWidth(p[V]))!=null?L:O,k},{})};return g.push({id:m.SetWorksheetColWidthMutation.id,params:T}),S.push({id:m.SetWorksheetColWidthMutation.id,params:P}),{redos:g,undos:S}}},r={id:ge.SPECIAL_PASTE_BESIDES_BORDER,specialPasteInfo:{label:"specialPaste.besidesBorder"},onPasteCells:(s,l,c,d)=>{o._instanceService.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET);const u=[],h=[],{range:g,unitId:S,subUnitId:f}=l,v=new a.ObjectMatrix;c.forValue((E,O,T)=>{const P=T.s;if(typeof P=="object"){const A=a.Tools.deepClone(T);A.s&&(A.s={...P,bd:null}),v.setValue(g.rows[E],g.cols[O],A)}});const p={unitId:S,subUnitId:f,cellValue:v.getData()};u.push({id:m.SetRangeValuesMutation.id,params:p});const C=this._injector.invoke(m.SetRangeValuesUndoMutationFactory,p);h.push({id:m.SetRangeValuesMutation.id,params:C});const{undos:_,redos:w}=this._injector.invoke(E=>vs(l,c,E));return h.push(..._),u.push(...w),{redos:u,undos:h}}};return[e,t,i,r]}_getWorksheet(o,e){var i;const t=(i=this._instanceService.getUniverSheetInstance(o))==null?void 0:i.getSheetBySheetId(e);if(!t)throw new Error(`[SheetClipboardController]: cannot find a worksheet with unitId ${o} and subUnitId ${e}.`);return t}_initCommandListener(){var e;this.disposeWithMe(this._commandService.onCommandExecuted(t=>{t.id===vt.id?this._sheetClipboardService.removeMarkSelection():Rf.includes(t.id)&&this._sheetClipboardService.removeMarkSelection()}));const o=this._configService.getConfig(Te);(e=o==null?void 0:o.clipboardConfig)!=null&&e.hidePasteOptions||(this.disposeWithMe(this._commandService.onCommandExecuted(t=>{If.includes(t.id)&&this._sheetClipboardService.disposePasteOptionsCache()})),this.disposeWithMe(this._commandService.onCommandExecuted(t=>{if(t.id===et.id){if(!this._sheetClipboardService.getPasteMenuVisible())return;const r=t.params.unitId,s=this._sheetClipboardService.getPasteOptionsCache(),l=s==null?void 0:s.target.unitId;r===l&&this._refreshOptionalPaste$.next(Math.random())}})))}_initUIComponents(){var e;const o=this._configService.getConfig(Te);(e=o==null?void 0:o.clipboardConfig)!=null&&e.hidePasteOptions||this.disposeWithMe(this._uiPartsService.registerComponent(I.BuiltInUIPart.CONTENT,()=>I.connectInjector(Cf,this._injector)))}};Kt=yf([Ge(0,a.Inject(a.Injector)),Ge(1,a.IUniverInstanceService),Ge(2,M.IRenderManagerService),Ge(3,a.ICommandService),Ge(4,a.IContextService),Ge(5,a.IConfigService),Ge(6,ke),Ge(7,I.IMessageService),Ge(8,a.Inject(a.LocaleService)),Ge(9,I.IUIPartsService)],Kt);var Mf=Object.getOwnPropertyDescriptor,Pf=(n,o,e,t)=>{for(var i=t>1?void 0:t?Mf(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Ni=(n,o)=>(e,t)=>o(e,t,n);let Wn=class extends a.Disposable{constructor(n,o,e,t,i){super(),this._selectionManagerService=n,this._themeService=o,this._instanceSrv=e,this._cmdSrv=t,this._definedNamesService=i,this._init()}_init(){this.disposeWithMe(N.merge(this._selectionManagerService.selectionMoveStart$,this._selectionManagerService.selectionMoving$,this._selectionManagerService.selectionMoveEnd$,this._selectionManagerService.selectionSet$).pipe(N.filter(n=>!!n)).subscribe(n=>{this._syncDefinedNameRange(n)})),this.disposeWithMe(this._definedNamesService.focusRange$.subscribe(async n=>{if(n==null)return;const{unitId:o}=n;let{formulaOrRefString:e}=n;if(e.substring(0,1)===K.operatorToken.EQUALS&&(e=e.substring(1)),!K.isReferenceStrings(e))return;const i=this._instanceSrv.getUnit(o),r=await this._getSelections(i,o,e);this._selectionManagerService.setSelections(r),this._cmdSrv.executeCommand(m.ScrollToCellOperation.id,{unitId:o,range:r[0].range})}))}_syncDefinedNameRange(n){if(n.length===0)return;const o=n[n.length-1],e=this._instanceSrv.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),t=e==null?void 0:e.getActiveSheet();t&&this._definedNamesService.setCurrentRange({range:o.range,unitId:e.getUnitId(),sheetId:t.getSheetId()})}async _getSelections(n,o,e){const t=e.split(",");let i=n.getActiveSheet();if(!i)return[];const r=[];for(let s=0;s<t.length;s++){const l=t[s].trim(),c=K.deserializeRangeWithSheet(l.trim());if(s===0){const u=n.getSheetBySheetName(c.sheetName);u&&i.getSheetId()!==u.getSheetId()&&(i=u,await this._cmdSrv.executeCommand(m.SetWorksheetActivateCommand.id,{subUnitId:i.getSheetId(),unitId:o}))}if(i.getName()!==c.sheetName)continue;let d=null;if(s===t.length-1){const u=c.range,{startRow:h,startColumn:g,endRow:S,endColumn:f}=u;d=m.getPrimaryForRange({startRow:h,startColumn:g,endRow:S,endColumn:f},i)}r.push({range:c.range,style:qe(this._themeService),primary:d})}return r}};Wn=Pf([Ni(0,a.Inject(m.SheetsSelectionsService)),Ni(1,a.Inject(a.ThemeService)),Ni(2,a.IUniverInstanceService),Ni(3,a.ICommandService),Ni(4,K.IDefinedNamesService)],Wn);var Of=Object.getOwnPropertyDescriptor,Af=(n,o,e,t)=>{for(var i=t>1?void 0:t?Of(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Ct=(n,o)=>(e,t)=>o(e,t,n);const Df={pageSize:{width:Number.POSITIVE_INFINITY,height:Number.POSITIVE_INFINITY},documentFlavor:a.DocumentFlavor.UNSPECIFIED,marginTop:5,marginBottom:5,marginRight:0,marginLeft:0,paragraphLineGapDefault:0,renderConfig:{horizontalAlign:a.HorizontalAlign.UNSPECIFIED,verticalAlign:a.VerticalAlign.TOP,centerAngle:0,vertexAngle:0,wrapStrategy:a.WrapStrategy.WRAP,isRenderStyle:a.BooleanNumber.FALSE}};let Ln=class extends a.Disposable{constructor(n,o,e,t,i,r,s,l){super(),this._univerInstanceService=n,this._renderManagerService=o,this._editorBridgeService=e,this._commandService=t,this._rangeProtectionRuleModel=i,this._worksheetProtectionRuleModel=r,this._formulaEditorController=s,this._formulaEditorManagerService=l,this._initialize()}_initialize(){this._syncFormulaEditorContent(),this._commandExecutedListener()}_getEditorViewModel(n){var o;return(o=this._renderManagerService.getRenderById(n))==null?void 0:o.with(Ce.DocSkeletonManagerService).getViewModel()}_syncFormulaEditorContent(){this.disposeWithMe(this._editorBridgeService.currentEditCellState$.subscribe(n=>{n==null||this._editorBridgeService.isForceKeepVisible()||!this._rangeProtectionRuleModel.getRangeRuleInitState()||!this._worksheetProtectionRuleModel.getSheetRuleInitState()||this._editorSyncHandler(n)}))}_editorSyncHandler(n){var i,r,s;let o=a.Tools.deepClone((i=n.documentLayoutObject.documentModel)==null?void 0:i.getBody());const e=a.Tools.deepClone((r=n.documentLayoutObject.documentModel)==null?void 0:r.drawings),t=a.Tools.deepClone((s=n.documentLayoutObject.documentModel)==null?void 0:s.getDrawingsOrder());(!o||n.isInArrayFormulaRange===!0&&this._editorBridgeService.isVisible().eventType===M.DeviceInputEventType.Dblclick)&&(o={dataStream:`\r
`,paragraphs:[{startIndex:0}],textRuns:[]}),this._syncContentAndRender(a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY,o,e,t)}_commandExecutedListener(){const n=[a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY,a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY];this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(e.id===Ce.RichTextEditingMutation.id){const t=e.params,{unitId:i,trigger:r,isSync:s}=t;if(s||r===q.ReplaceSnapshotCommand.id)return;if(n.includes(i)){const l=this._univerInstanceService.getUnit(i,a.UniverInstanceType.UNIVER_DOC),c=i===a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY?a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY:a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY;this._checkAndSetRenderStyleConfig(l),this._syncActionsAndRender(c,t)}}}));const o=[m.SetRangeValuesMutation.id,m.MoveRangeMutation.id];this.disposeWithMe(this._commandService.onCommandExecuted(e=>{var t,i,r,s,l,c,d;if(o.includes(e.id)){const u=this._editorBridgeService.getLatestEditCellState();if(u==null)return;let h=!1;const{row:g,column:S}=u;if(e.id===m.SetRangeValuesMutation.id&&e.params?(i=(t=e.params.cellValue)==null?void 0:t[g])!=null&&i[S]&&(h=!0):e.id===m.MoveRangeMutation.id&&e.params&&(s=(r=e.params.to.value)==null?void 0:r[g])!=null&&s[S]&&(h=!0),h){const f=a.Tools.deepClone((l=u.documentLayoutObject.documentModel)==null?void 0:l.getBody()),v=a.Tools.deepClone((c=u.documentLayoutObject.documentModel)==null?void 0:c.drawings),p=a.Tools.deepClone((d=u.documentLayoutObject.documentModel)==null?void 0:d.getDrawingsOrder());if(f==null)return;this._syncContentAndRender(a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY,f,v,p)}}}))}_syncActionsAndRender(n,o){var l;const e=[a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY,a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY],t=this._renderManagerService.getRenderById(n);if(t==null)return;const i=t.with(Ce.DocSkeletonManagerService).getSkeleton(),r=this._univerInstanceService.getUnit(n,a.UniverInstanceType.UNIVER_DOC),s=this._getEditorViewModel(n);r==null||s==null||(this._commandService.syncExecuteCommand(Ce.RichTextEditingMutation.id,{...o,textRanges:null,isSync:!0,unitId:n,syncer:o.unitId}),s.reset(r),i.calculate(),e.includes(n)&&((l=t.mainComponent)==null||l.makeDirty()))}_syncContentAndRender(n,o,e,t){var d,u;n===a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY&&o.paragraphs&&(o.paragraphs=this._clearParagraph(o.paragraphs));const i=[a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY,a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY],r=(d=this._renderManagerService.getRenderById(n))==null?void 0:d.with(Ce.DocSkeletonManagerService).getSkeleton(),s=this._univerInstanceService.getUnit(n,a.UniverInstanceType.UNIVER_DOC),l=this._getEditorViewModel(n);if(s==null||l==null||r==null)return;s.getSnapshot().body=o,s.getSnapshot().drawings=e!=null?e:{},s.getSnapshot().drawingsOrder=t!=null?t:[],this._checkAndSetRenderStyleConfig(s),l.reset(s);const c=this._renderManagerService.getRenderById(n);c!=null&&(r.calculate(),i.includes(n)&&((u=c.mainComponent)==null||u.makeDirty()),n===a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY&&this._formulaEditorController.autoScroll())}_checkAndSetRenderStyleConfig(n){var r;const o=n.getSnapshot(),{body:e}=o;if(o.id!==a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY)return;o.documentStyle=Df;let t=o.documentStyle.renderConfig;t==null&&(t={},o.documentStyle.renderConfig=t);const i=this._formulaEditorManagerService.getPosition();if(i){const s=i.width;o.documentStyle.pageSize={width:s,height:1/0}}((r=e==null?void 0:e.dataStream)!=null?r:"").startsWith("=")?t.isRenderStyle=a.BooleanNumber.TRUE:t.isRenderStyle=a.BooleanNumber.FALSE}_clearParagraph(n){const o=a.Tools.deepClone(n);for(const e of o)e.paragraphStyle&&(e.paragraphStyle.horizontalAlign=a.HorizontalAlign.UNSPECIFIED);return o}};Ln=Af([Ct(0,a.IUniverInstanceService),Ct(1,M.IRenderManagerService),Ct(2,me),Ct(3,a.ICommandService),Ct(4,a.Inject(m.RangeProtectionRuleModel)),Ct(5,a.Inject(m.WorksheetProtectionRuleModel)),Ct(6,a.Inject(y.FormulaEditorController)),Ct(7,yn)],Ln);var Nf=Object.getOwnPropertyDescriptor,kf=(n,o,e,t)=>{for(var i=t>1?void 0:t?Nf(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},ki=(n,o)=>(e,t)=>o(e,t,n);const ps="SHEET_FORCE_STRING_ALERT";let Eo=class extends a.Disposable{constructor(n,o,e,t,i,r){super(),this._context=n,this._hoverManagerService=o,this._cellAlertManagerService=e,this._localeService=t,this._zenZoneService=i,this._configService=r,this._init()}_init(){this._initCellAlertPopup(),this._initZenService()}_initCellAlertPopup(){this.disposeWithMe(this._hoverManagerService.currentCell$.subscribe(n=>{var o,e;if(n){const t=n.location,i=this._context.unit,r=i.getActiveSheet();if(!r)return this._hideAlert();const s=r.getCell(t.row,t.col);if(!s||s.v===null||s.v===void 0)return this._hideAlert();let l;if(s!=null&&s.s){const c=i.getStyles().get(s.s);c!=null&&c.n&&(l=c.n)}if(a.isTextFormat(l==null?void 0:l.pattern)){this._hideAlert();return}if((s.t===a.CellValueType.FORCE_STRING||s.t===a.CellValueType.STRING)&&(a.isRealNum(s.v)||typeof s.v=="string"&&a.numfmt.parseNumber(s.v))){if((o=this._configService.getConfig(Te))!=null&&o.disableForceStringAlert)return;const c=this._cellAlertManagerService.currentAlert.get(ps),d=(e=c==null?void 0:c.alert)==null?void 0:e.location;if(d&&d.row===n.location.row&&d.col===n.location.col&&d.subUnitId===n.location.subUnitId&&d.unitId===n.location.unitId){this._hideAlert();return}this._cellAlertManagerService.showAlert({type:Hn.ERROR,title:this._localeService.t("info.error"),message:this._localeService.t("info.forceStringInfo"),location:t,width:200,height:74,key:ps});return}}this._hideAlert()}))}_initZenService(){this.disposeWithMe(this._zenZoneService.visible$.subscribe(n=>{n&&this._hideAlert()}))}_hideAlert(){this._cellAlertManagerService.removeAlert(ps)}};Eo=kf([ki(1,a.Inject(y.HoverManagerService)),ki(2,a.Inject(y.CellAlertManagerService)),ki(3,a.Inject(a.LocaleService)),ki(4,I.IZenZoneService),ki(5,a.IConfigService)],Eo);var Hf=Object.getOwnPropertyDescriptor,Vf=(n,o,e,t)=>{for(var i=t>1?void 0:t?Hf(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Cs=(n,o)=>(e,t)=>o(e,t,n);let To=class extends a.RxDisposable{constructor(n,o,e,t){super(),this._context=n,this._sheetSkeletonManagerService=o,this._sheetInterceptorService=e,this._configService=t,this._initViewModelIntercept()}_initViewModelIntercept(){const n={tl:{size:6,color:"#409f11"}};this.disposeWithMe(this._sheetInterceptorService.intercept(m.INTERCEPTOR_POINT.CELL_CONTENT,{priority:10,effect:a.InterceptorEffectEnum.Style,handler:(o,e,t)=>{var s,l,c;if(!((s=this._sheetSkeletonManagerService.getCurrentParam())==null?void 0:s.skeleton))return t(o);const r=e.rawData;if(!r||r.v===null||r.v===void 0)return t(o);if(((o==null?void 0:o.t)===a.CellValueType.FORCE_STRING||(o==null?void 0:o.t)===a.CellValueType.STRING)&&(a.isRealNum(r.v)||typeof r.v=="string"&&a.numfmt.parseNumber(r.v))){const d=e.workbook.getStyles().get(r.s);return a.isTextFormat((l=d==null?void 0:d.n)==null?void 0:l.pattern)||(c=this._configService.getConfig(Te))!=null&&c.disableForceStringMark||(o===r&&(o={...r}),o.markers={...o==null?void 0:o.markers,...n}),t(o)}return t(o)}}))}};To=Vf([Cs(1,a.Inject(y.SheetSkeletonManagerService)),Cs(2,a.Inject(m.SheetInterceptorService)),Cs(3,a.IConfigService)],To);var Wf=Object.getOwnPropertyDescriptor,Lf=(n,o,e,t)=>{for(var i=t>1?void 0:t?Wf(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},qt=(n,o)=>(e,t)=>o(e,t,n);let xn=class extends a.Disposable{constructor(n,o,e,t,i,r,s){super(),this._commandService=n,this._formatPainterService=o,this._univerInstanceService=e,this._renderManagerService=t,this._selectionManagerService=i,this._sheetInterceptorService=r,this._injector=s,this._initialize()}_initialize(){this._addDefaultHook()}_addDefaultHook(){const n={id:"default-format-painter",priority:0,isDefaultHook:!0,onStatusChange:o=>{if(o!==Ae.OFF){const e=this._collectSelectionRangeFormat();e&&this._formatPainterService.setSelectionFormat(e)}},onApply:(o,e,t,i)=>this._getUndoRedoMutationInfo(o,e,t,i)};this._formatPainterService.addHook(n)}_collectSelectionRangeFormat(){const n=this._selectionManagerService.getCurrentLastSelection(),o=n==null?void 0:n.range;if(!o)return null;const{startRow:e,endRow:t,startColumn:i,endColumn:r}=o,s=this._univerInstanceService.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),l=s==null?void 0:s.getActiveSheet();if(!l)return null;const c=l.getCellMatrix(),d=s.getStyles(),u=new a.ObjectMatrix,h=[];for(let g=e;g<=t;g++)for(let S=i;S<=r;S++){const f=c.getValue(g,S);u.setValue(g,S,d.getStyleByCell(f)||{});const{isMergedMainCell:v,...p}=l.getCellInfoInMergeData(g,S);v&&h.push({startRow:p.startRow,startColumn:p.startColumn,endRow:p.endRow,endColumn:p.endColumn})}return{styles:u,merges:h}}_getUndoRedoMutationInfo(n,o,e,t){const i=this._sheetInterceptorService,r=this._univerInstanceService,{merges:s,styles:l}=t;if(!l)return{undos:[],redos:[]};const{startRow:c,startColumn:d,endRow:u,endColumn:h}=l.getDataRange(),g=u-c+1,S=h-d+1,f=e.startRow===e.endRow&&e.startColumn===e.endColumn?{startRow:e.startRow,startColumn:e.startColumn,endRow:e.startRow+g-1,endColumn:e.startColumn+S-1}:e,v=Array.from({length:f.endRow-f.startRow+1},()=>Array.from({length:f.endColumn-f.startColumn+1},()=>({}))),p=[];v.forEach((L,W)=>{L.forEach((B,U)=>{const z=W%g+c,F=U%S+d,j=l.getValue(z,F);j&&(v[W][U].s=Object.keys(j).length>0?j:null)})});let C=0,_=0;s.forEach(L=>{L.startRow===c&&L.startColumn===d&&(C=L.endRow-L.startRow,_=L.endColumn-L.startColumn);const W={startRow:L.startRow-c,startColumn:L.startColumn-d,endRow:L.endRow-c,endColumn:L.endColumn-d},B=Math.max(1,Math.floor((f.endRow-f.startRow+1)/g)),U=Math.max(1,Math.floor((f.endColumn-f.startColumn+1)/S));for(let z=0;z<B;z++)for(let F=0;F<U;F++)p.push({startRow:W.startRow+z*g+f.startRow,startColumn:W.startColumn+F*S+f.startColumn,endRow:W.endRow+z*g+f.startRow,endColumn:W.endColumn+F*S+f.startColumn})});const w=[f],E=new a.ObjectMatrix,O=new a.ObjectMatrix;if(a.Tools.isArray(v))for(let L=0;L<w.length;L++){const{startRow:W,startColumn:B,endRow:U,endColumn:z}=w[L];for(let F=0;F<=U-W;F++)for(let j=0;j<=z-B;j++)E.setValue(F+W,j+B,{s:null}),O.setValue(F+W,j+B,v[F][j])}const T={subUnitId:o,unitId:n,cellValue:E.getMatrix()},P={subUnitId:o,unitId:n,cellValue:O.getMatrix()},A=this._injector.invoke(m.SetRangeValuesUndoMutationFactory,T),{undos:D,redos:k}=i.onCommandExecute({id:m.SetRangeValuesCommand.id,params:{...P,range:w}}),H=[],V=[];if(p.length>0){const L=m.getAddMergeMutationRangeByType(p),W=r.getUnit(n).getSheetBySheetId(o),B=Ta(W,L),U={unitId:n,subUnitId:o,ranges:L},z={unitId:n,subUnitId:o,ranges:L};H.push({id:m.RemoveWorksheetMergeMutation.id,params:U}),H.push({id:m.AddWorksheetMergeMutation.id,params:z});const F=this._injector.invoke(m.RemoveMergeUndoMutationFactory,U),j=this._injector.invoke(m.AddMergeUndoMutationFactory,z);if(V.push({id:m.RemoveWorksheetMergeMutation.id,params:j}),V.push({id:m.AddWorksheetMergeMutation.id,params:F}),B){const Y=this._injector.invoke(Q=>ya(Q,n,W,L));H.unshift(...Y.redos),V.push(...Y.undos)}}if(!a.Rectangle.equals(f,e)){const L={actualRow:f.startRow,actualColumn:f.startColumn,rangeType:a.RANGE_TYPE.NORMAL,isMerged:C>0||_>0,isMergedMainCell:!1,startRow:f.startRow,startColumn:f.startColumn,endRow:f.startRow+C,endColumn:f.startColumn+_};H.push({id:m.SetSelectionsOperation.id,params:{unitId:n,subUnitId:o,type:m.SelectionMoveType.ONLY_SET,selections:[{range:f,primary:L,style:null}]}}),V.unshift({id:m.SetSelectionsOperation.id,params:{unitId:n,subUnitId:o,type:m.SelectionMoveType.ONLY_SET,selections:[{range:e,primary:L,style:null}]}})}return{undos:[{id:m.SetRangeValuesMutation.id,params:T},{id:m.SetRangeValuesMutation.id,params:A},...D,...V],redos:[{id:m.SetRangeValuesMutation.id,params:T},{id:m.SetRangeValuesMutation.id,params:P},...k,...H]}}};xn=Lf([qt(0,a.ICommandService),qt(1,Fe),qt(2,a.IUniverInstanceService),qt(3,M.IRenderManagerService),qt(4,a.Inject(m.SheetsSelectionsService)),qt(5,a.Inject(m.SheetInterceptorService)),qt(6,a.Inject(a.Injector))],xn);var xf=Object.getOwnPropertyDescriptor,Uf=(n,o,e,t)=>{for(var i=t>1?void 0:t?xf(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Is=(n,o)=>(e,t)=>o(e,t,n);let yo=class extends a.Disposable{constructor(n,o,e,t){super(),this._context=n,this._markSelectionService=o,this._commandService=e,this._sheetSkeletonManagerService=t,this._initListeners()}_initListeners(){this._addRemoveListener(),this._addRefreshListener()}_addRemoveListener(){const n=[Se.id];this.disposeWithMe(this._commandService.onCommandExecuted(o=>{n.includes(o.id)?this._markSelectionService.removeAllShapes():this._markSelectionService.getShapeMap().forEach((t,i)=>{t.exits.includes(o.id)&&this._markSelectionService.removeShape(i)})}))}_addRefreshListener(){this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(n=>{n&&this._markSelectionService.refreshShapes()}))}};yo=Uf([Is(1,a.Inject(yt)),Is(2,a.ICommandService),Is(3,a.Inject(y.SheetSkeletonManagerService))],yo);function Kc(){const n=St();return n?b.jsx(Bf,{workbook:n}):null}function Bf(n){const{workbook:o}=n,[e,t]=x.useState([]),[i,r]=x.useState(""),s=x.useRef(new Map),l=I.useDependency(a.ICommandService),c=x.useCallback(()=>{const u=o.getActiveSheet().getSheetId(),h=o.getSheets(),g=o.getActiveSheet(),S=h.filter(f=>!f.isSheetHidden()).map((f,v)=>{var p;return{sheetId:f.getSheetId(),label:f.getName(),index:v,selected:g===f,color:(p=f.getTabColor())!=null?p:void 0}});if(t(S),r(u),s.current.has(u)){const f=s.current.get(u);f&&f.scrollIntoView({behavior:"smooth",block:"nearest"})}s.current.clear()},[o]);x.useEffect(()=>c(),[c]);const d=x.useCallback(u=>{l.executeCommand(m.SetWorksheetActiveOperation.id,{unitId:o.getUnitId(),subUnitId:u})},[l,o]);return x.useEffect(()=>{const u=l.onCommandExecuted(h=>{switch(h.id){case m.SetWorksheetHideMutation.id:case m.RemoveSheetMutation.id:case m.SetWorksheetNameMutation.id:case m.InsertSheetMutation.id:case m.SetWorksheetOrderMutation.id:case m.SetWorksheetActiveOperation.id:c();break}});return()=>u.dispose()},[l,c]),b.jsx("div",{className:"univer-h-8 univer-w-full univer-overflow-x-scroll univer-bg-gray-100 dark:!univer-bg-gray-900",children:b.jsx("div",{className:"univer-flex univer-h-8 univer-flex-nowrap univer-items-center",children:e.map(u=>b.jsx("div",{ref:h=>{s.current.set(u.sheetId,h)},className:X.clsx(`
                              univer-box-border univer-h-full univer-min-w-12 univer-max-w-[120px] univer-shrink-0
                              univer-flex-nowrap univer-items-center univer-truncate univer-px-1 univer-py-0.5
                              univer-text-center univer-text-xs univer-leading-7
                            `,X.borderRightClassName,{"univer-bg-white univer-text-primary-600 dark:!univer-bg-slate-600":u.sheetId===i}),onClick:()=>d(u.sheetId),children:u.label},u.sheetId))})})}const Ff={[I.ContextMenuPosition.MAIN_AREA]:{[I.ContextMenuGroup.FORMAT]:{[Ve.name]:{order:0,menuItemFactory:Dn}},[I.ContextMenuGroup.DATA]:{order:2},[I.ContextMenuGroup.OTHERS]:{order:3}},[I.ContextMenuPosition.COL_HEADER]:{[I.ContextMenuGroup.FORMAT]:{[Ve.name]:{order:0,menuItemFactory:Dn}},[I.ContextMenuGroup.LAYOUT]:{order:1},[I.ContextMenuGroup.DATA]:{order:2},[I.ContextMenuGroup.OTHERS]:{order:3}},[I.ContextMenuPosition.ROW_HEADER]:{[I.ContextMenuGroup.FORMAT]:{[Ve.name]:{order:0,menuItemFactory:Dn}},[I.ContextMenuGroup.LAYOUT]:{order:1},[I.ContextMenuGroup.DATA]:{order:2},[I.ContextMenuGroup.OTHERS]:{order:3}}};var zf=Object.getOwnPropertyDescriptor,Xf=(n,o,e,t)=>{for(var i=t>1?void 0:t?zf(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},It=(n,o)=>(e,t)=>o(e,t,n);let Ro=class extends a.Disposable{constructor(n,o,e,t,i,r,s,l){super(),this._injector=n,this._componentManager=o,this._layoutService=e,this._commandService=t,this._shortcutService=i,this._menuManagerService=r,this._uiPartsService=s,this._configService=l,this._init()}_init(){this._initComponents(),this._initCommands(),this._initMenus(),this._initShortcuts(),this._initWorkbenchParts(),this._initFocusHandler()}_initComponents(){const n=this._componentManager;this.disposeWithMe(n.register(Ze,Nl)),this.disposeWithMe(n.register(Vr,Jl)),this.disposeWithMe(n.register(wi,tc)),this.disposeWithMe(n.register(gs,$l)),this.disposeWithMe(n.register("HideGridlinesDoubleIcon",Mr))}_initCommands(){[Qr,vt,$r,Jr,bn,De,Pe,Xe,bi,di,mn,gn,ti,ni,Le,oo,Si,so,m.SetBoldCommand,Bt,Se,_i,Ot,At,Dt,Nt,mr,gr,ii,dn,un,Ji,m.SetItalicCommand,m.SetStrikeThroughCommand,m.SetFontFamilyCommand,m.SetFontSizeCommand,ui,io,fn,hi,et,Cn,$e,mi,gi,ao,m.SetUnderlineCommand,wn,je,pi,ci,kt,Mt,hn,cn,lo,dt,nn,Be,vr,si,Vt,Wt,ai,li,Ii,Lt,xt,Ci,In,jn,Zn].forEach(n=>{this.disposeWithMe(this._commandService.registerCommand(n))})}_initMenus(){this._menuManagerService.mergeMenu(Ff)}_initShortcuts(){[oc,rc,sc,ac,lc,cc,dc,uc,hc,mc,gc,Sc,fc,vc,pc,Cc,Ic,_c,bc,wc,Ec,Nc,Hc,Wc,Lc,kc,Vc,Tc,yc,Rc,Mc,Pc,Oc,Ac,Dc,...rl(),al,sl,ll,ul,hl,ml,Sl,cl,dl,gl,nc,ic].forEach(n=>{this.disposeWithMe(this._shortcutService.registerShortcut(n))})}_initWorkbenchParts(){const n=this._uiPartsService,o=this._injector;this.disposeWithMe(n.registerComponent(I.BuiltInUIPart.HEADER,()=>I.connectInjector(Kc,o))),this.disposeWithMe(n.registerComponent(I.BuiltInUIPart.CONTENT,()=>I.connectInjector(Ar,o)))}_initFocusHandler(){this.disposeWithMe(this._layoutService.registerFocusHandler(a.UniverInstanceType.UNIVER_SHEET,n=>{const o=this._injector.get(M.IRenderManagerService),e=this._injector.get(a.IUniverInstanceService),t=M.getCurrentTypeOfRenderer(a.UniverInstanceType.UNIVER_DOC,e,o),i=t==null?void 0:t.with(q.DocSelectionRenderService);i==null||i.focus()}))}};Ro=Xf([It(0,a.Inject(a.Injector)),It(1,a.Inject(I.ComponentManager)),It(2,I.ILayoutService),It(3,a.ICommandService),It(4,I.IShortcutService),It(5,I.IMenuManagerService),It(6,I.IUIPartsService),It(7,a.IConfigService)],Ro);var Yf=Object.getOwnPropertyDescriptor,jf=(n,o,e,t)=>{for(var i=t>1?void 0:t?Yf(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},_s=(n,o)=>(e,t)=>o(e,t,n);let Mo=class extends a.Disposable{constructor(o,e,t,i){super();R(this,"_disposableCollection",new a.DisposableCollection);R(this,"_initialize",()=>{const o=this._disposableCollection;this.disposeWithMe(this._selectionManagerService.selectionMoveEnd$.subscribe(()=>{o.dispose(),this._selectionRenderService.getSelectionControls().forEach(t=>{o.add(a.toDisposable(t.selectionMoveEnd$.subscribe(i=>{if(!i)return;const r=t.model.getRange(),s={startRow:r.startRow,startColumn:r.startColumn,endRow:r.endRow,endColumn:r.endColumn,rangeType:r.rangeType},l={startRow:i.startRow,startColumn:i.startColumn,endRow:i.endRow,endColumn:i.endColumn,rangeType:r.rangeType};if(s.startRow===l.startRow&&s.startColumn===l.startColumn||l.startRow<0||l.startColumn<0)return;const c={fromRange:s,toRange:l};this._commandService.executeCommand(m.MoveRangeCommand.id,c)})))})}))});this._context=o,this._selectionRenderService=e,this._selectionManagerService=t,this._commandService=i,this._initialize()}dispose(){var o;super.dispose(),(o=this._disposableCollection)==null||o.dispose()}};Mo=jf([_s(1,a.Inject(Ie)),_s(2,a.Inject(m.SheetsSelectionsService)),_s(3,a.Inject(a.ICommandService))],Mo);var Zf=Object.getOwnPropertyDescriptor,Gf=(n,o,e,t)=>{for(var i=t>1?void 0:t?Zf(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Kf=(n,o)=>(e,t)=>o(e,t,n);let Un=class extends a.Disposable{constructor(n){super(),this._sheetPermissionInitController=n,this._initPermission()}_initPermission(){this._sheetPermissionInitController.initPermission()}};Un=Gf([Kf(0,a.Inject(m.SheetPermissionInitController))],Un);var qf=Object.getOwnPropertyDescriptor,Qf=(n,o,e,t)=>{for(var i=t>1?void 0:t?qf(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},it=(n,o)=>(e,t)=>o(e,t,n);let Po=class extends a.RxDisposable{constructor(o,e,t,i,r,s,l,c,d,u){super();R(this,"disposableCollection",new a.DisposableCollection);this._context=o,this._univerInstanceService=e,this._permissionService=t,this._selectionManagerService=i,this._rangeProtectionRuleModel=r,this._headerMoveRenderController=s,this._selectionRenderService=l,this._headerFreezeRenderController=c,this._rangeProtectionCache=d,this._headerResizeRenderController=u,this._initHeaderMovePermissionInterceptor(),this._initHeaderResizePermissionInterceptor(),this._initRangeFillPermissionInterceptor(),this._initRangeMovePermissionInterceptor()}_initHeaderMovePermissionInterceptor(){const o=this._headerMoveRenderController.interceptor.getInterceptPoints().HEADER_MOVE_PERMISSION_CHECK;this.disposeWithMe(this._headerMoveRenderController.interceptor.intercept(o,{handler:(e,t)=>{const i=m.getSheetCommandTarget(this._univerInstanceService);if(!i)return!1;const{unitId:r,subUnitId:s}=i;if(!this._permissionService.composePermission([new m.WorkbookEditablePermission(r).id,new m.WorksheetEditPermission(r,s).id]).every(c=>c.value))return!1;if(!t)return!0;if(t.rangeType!==a.RANGE_TYPE.ROW&&t.rangeType!==a.RANGE_TYPE.COLUMN)return e;if(t.rangeType===a.RANGE_TYPE.ROW){for(let c=t.startRow;c<=t.endRow;c++)if(this._rangeProtectionCache.getRowPermissionInfo(r,s,c,[$.Edit])===!1)return!1}else for(let c=t.startColumn;c<=t.endColumn;c++)if(this._rangeProtectionCache.getColPermissionInfo(r,s,c,[$.Edit])===!1)return!1;return!0}}))}_initHeaderResizePermissionInterceptor(){this._headerResizeRenderController&&this.disposeWithMe(this._headerResizeRenderController.interceptor.intercept(this._headerResizeRenderController.interceptor.getInterceptPoints().HEADER_RESIZE_PERMISSION_CHECK,{handler:(o,e)=>{var s,l,c,d;const t=m.getSheetCommandTarget(this._univerInstanceService);if(!t)return!1;const{unitId:i,subUnitId:r}=t;if(e.row){if(((l=(s=this._permissionService.getPermissionPoint(new m.WorksheetSetRowStylePermission(i,r).id))==null?void 0:s.value)!=null?l:!1)===!1)return!1}else if(e.col&&((d=(c=this._permissionService.getPermissionPoint(new m.WorksheetSetColumnStylePermission(i,r).id))==null?void 0:c.value)!=null?d:!1)===!1)return!1;return!0}}))}_initRangeFillPermissionInterceptor(){this.disposeWithMe(this._selectionRenderService.interceptor.intercept(this._selectionRenderService.interceptor.getInterceptPoints().RANGE_FILL_PERMISSION_CHECK,{handler:(o,e)=>{var f,v,p;const t=m.getSheetCommandTarget(this._univerInstanceService);if(!t)return!1;const{worksheet:i,unitId:r,subUnitId:s}=t;if(!this._permissionService.composePermission([new m.WorkbookEditablePermission(r).id,new m.WorksheetEditPermission(r,s).id,new m.WorksheetSetCellValuePermission(r,s).id,new m.WorksheetSetCellStylePermission(r,s).id]).every(C=>C.value))return!1;const c=(f=this._selectionManagerService.getCurrentSelections())==null?void 0:f.map(C=>C.range),d=c==null?void 0:c.find(C=>{const _=fi(e.x,e.y,e.scene,e.skeleton),w=e.skeleton.getCellWithCoordByIndex(C.endRow,C.endColumn),E=Math.abs(w.endX-_.x),O=Math.abs(w.endY-_.y);return E<=5&&O<=5});if(!d)return!0;const{startRow:u,endRow:h,startColumn:g,endColumn:S}=d;for(let C=u;C<=h;C++)for(let _=g;_<=S;_++){const w=(p=(v=i.getCell(C,_))==null?void 0:v.selectionProtection)==null?void 0:p[0];if((w==null?void 0:w[$.Edit])===!1||(w==null?void 0:w[$.View])===!1)return!1}return!0}}))}_initRangeMovePermissionInterceptor(){this.disposeWithMe(this._selectionRenderService.interceptor.intercept(this._selectionRenderService.interceptor.getInterceptPoints().RANGE_MOVE_PERMISSION_CHECK,{handler:(o,e)=>{var g;const t=m.getSheetCommandTarget(this._univerInstanceService);if(!t)return!1;const{worksheet:i,unitId:r,subUnitId:s}=t;if(!this._permissionService.composePermission([new m.WorkbookEditablePermission(r).id,new m.WorksheetEditPermission(r,s).id]).every(S=>S.value))return!1;const c=(g=this._selectionManagerService.getCurrentSelections())==null?void 0:g.map(S=>S.range),d=this._rangeProtectionRuleModel.getSubunitRuleList(r,s).reduce((S,f)=>[...S,...f.ranges],[]),u=c==null?void 0:c.filter(S=>d.some(f=>a.Rectangle.intersects(f,S)));return!(u==null?void 0:u.some(S=>{var _,w;const{startRow:f,startColumn:v,endRow:p,endColumn:C}=S;for(let E=f;E<=p;E++)for(let O=v;O<=C;O++){const T=(w=(_=i.getCell(E,O))==null?void 0:_.selectionProtection)==null?void 0:w[0];if((T==null?void 0:T[$.Edit])===!1)return!0}return!1}))}}))}_initFreezePermissionInterceptor(){this.disposeWithMe(this._headerFreezeRenderController.interceptor.intercept(this._headerFreezeRenderController.interceptor.getInterceptPoints().FREEZE_PERMISSION_CHECK,{handler:(o,e)=>{var s,l;const t=this._univerInstanceService.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET);return!(t==null?void 0:t.getActiveSheet())||!t?!1:(l=(s=this._permissionService.getPermissionPoint(new m.WorkbookEditablePermission(t.getUnitId()).id))==null?void 0:s.value)!=null?l:!1}}))}};Po=Qf([it(1,a.IUniverInstanceService),it(2,a.IPermissionService),it(3,a.Inject(m.SheetsSelectionsService)),it(4,a.Inject(m.RangeProtectionRuleModel)),it(5,a.Inject(y.HeaderMoveRenderController)),it(6,Ie),it(7,a.Inject(y.HeaderFreezeRenderController)),it(8,a.Inject(m.RangeProtectionCache)),it(9,a.Optional(y.HeaderResizeRenderController))],Po);var Jf=Object.getOwnPropertyDescriptor,$f=(n,o,e,t)=>{for(var i=t>1?void 0:t?Jf(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Hi=(n,o)=>(e,t)=>o(e,t,n);const ev="SHEET_PERMISSION_PASTE_PLUGIN";let Bn=class extends a.Disposable{constructor(o,e,t,i,r){super();R(this,"disposableCollection",new a.DisposableCollection);this._univerInstanceService=o,this._selectionManagerService=e,this._localService=t,this._sheetClipboardService=i,this._sheetPermissionCheckController=r,this._initClipboardHook()}_initClipboardHook(){this.disposeWithMe(this._sheetClipboardService.addClipboardHook({id:ev,onBeforePaste:o=>{var g,S,f;const[e]=lt([o.range]).ranges,t=(g=this._selectionManagerService.getCurrentLastSelection())==null?void 0:g.range;if(!t)return!1;const i={startRow:t.startRow+e.startRow,endRow:t.startRow+e.endRow,startColumn:t.startColumn+e.startColumn,endColumn:t.startColumn+e.endColumn},s=this._univerInstanceService.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET).getActiveSheet();if(!s)return!1;const{startRow:l,endRow:c,startColumn:d,endColumn:u}=i;let h=!0;for(let v=l;v<=c;v++)for(let p=d;p<=u;p++){const C=(f=(S=s.getCell(v,p))==null?void 0:S.selectionProtection)==null?void 0:f[0];if((C==null?void 0:C[$.Edit])===!1){h=!1;break}}return h||this._sheetPermissionCheckController.blockExecuteWithoutPermission(this._localService.t("permission.dialog.pasteErr")),h}}))}};Bn=$f([Hi(0,a.IUniverInstanceService),Hi(1,a.Inject(m.SheetsSelectionsService)),Hi(2,a.Inject(a.LocaleService)),Hi(3,a.Inject(ke)),Hi(4,a.Inject(m.SheetPermissionCheckController))],Bn);var tv=Object.getOwnPropertyDescriptor,nv=(n,o,e,t)=>{for(var i=t>1?void 0:t?tv(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Oo=(n,o)=>(e,t)=>o(e,t,n);let Ao=class extends a.RxDisposable{constructor(o,e,t,i,r){super();R(this,"disposableCollection",new a.DisposableCollection);this._context=o,this._univerInstanceService=e,this._permissionService=t,this._statusBarController=i,this._rangeProtectionCache=r,this._initStatusBarPermissionInterceptor()}_initStatusBarPermissionInterceptor(){this.disposeWithMe(this._statusBarController.interceptor.intercept(this._statusBarController.interceptor.getInterceptPoints().STATUS_BAR_PERMISSION_CORRECT,{priority:100,handler:(o,e)=>{var c;const t=m.getSheetCommandTarget(this._univerInstanceService);if(!t)return o!=null?o:[];const{worksheet:i,unitId:r,subUnitId:s}=t;return((c=this._permissionService.getPermissionPoint(new m.WorksheetViewPermission(r,s).id))==null?void 0:c.value)===!1?e.forEach(d=>{const u=d.getArrayValue();u.forEach((h,g)=>{h.forEach((S,f)=>{u[g][f]=K.NullValueObject.create()})})}):e.forEach(d=>{const u=d.getArrayValue(),h=d.getCurrentRow(),g=d.getCurrentColumn();u.forEach((S,f)=>{S.forEach((v,p)=>{var w;if(((w=i.getCellRaw(f+h,p+g))==null?void 0:w.v)===void 0)return;const _=this._rangeProtectionCache.getCellInfo(r,s,f+h,p+g);(_==null?void 0:_[$.View])===!1&&(u[f][p]=K.NullValueObject.create())})})}),e}}))}};Ao=nv([Oo(1,a.IUniverInstanceService),Oo(2,a.IPermissionService),Oo(3,a.Inject(y.StatusBarController)),Oo(4,a.Inject(m.RangeProtectionCache))],Ao);const qc=(n,o,e,t,i)=>{const r=n.get(a.LocaleService),s=n.get(m.WorksheetProtectionRuleModel),l=n.get(m.RangeProtectionRuleModel);let c="";if(o.length===0)c=r.t("permission.panel.emptyRangeError");else if(o.length>1){let d=!1;for(let u=0;u<o.length;u++){for(let h=u+1;h<o.length;h++)if(a.Rectangle.intersects(o[u],o[h])){d=!0;break}if(d)break}d&&(c=r.t("permission.panel.rangeOverlapError"))}if(!c){if(s.getRule(t,i)&&!e)return c=r.t("permission.panel.rangeOverlapOverPermissionError"),c;const u=l.getSubunitRuleList(t,i).filter(g=>g.permissionId!==e).find(g=>g.ranges.some(S=>o.some(f=>a.Rectangle.intersects(S,f))));(u==null?void 0:u.ranges.find(g=>o.some(S=>a.Rectangle.intersects(g,S))))&&(c=r.t("permission.panel.rangeOverlapOverPermissionError"))}return c===""?void 0:c},iv=(n,o)=>{if(n.length!==1)return!1;const e=n[0],t=o.getRowCount(),i=o.getColumnCount(),{startRow:r,endRow:s,startColumn:l,endColumn:c}=e;return r===0&&l===0&&s===t-1&&c===i-1},ov=(n,o)=>{var c,d;const e=n.get(a.IUniverInstanceService),t=n.get(m.SheetsSelectionsService),i=e.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),r=i.getActiveSheet();let s=m.UnitObject.SelectRange,l=(d=(c=t.getCurrentSelections())==null?void 0:c.map(u=>u.range))!=null?d:[];return o&&(s=m.UnitObject.Worksheet,l=[{startRow:0,startColumn:0,endRow:r.getRowCount()-1,endColumn:r.getColumnCount()-1,rangeType:a.RANGE_TYPE.ALL}]),{unitId:i.getUnitId(),subUnitId:r.getSheetId(),permissionId:"",unitType:s,description:"",id:"",ranges:l,editState:m.EditStateEnum.OnlyMe,viewState:m.ViewStateEnum.OthersCanView}},rv=(n,o)=>{const i=n.get(a.IUniverInstanceService).getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET).getActiveSheet(),{unitType:r}=o;return r===m.UnitObject.Worksheet?{...o,ranges:[{startRow:0,startColumn:0,endRow:i.getRowCount()-1,endColumn:i.getColumnCount()-1,rangeType:a.RANGE_TYPE.ALL}]}:o},sv=n=>{const{viewState:o,editState:e,permissionId:t,ranges:i,rangesErrMsg:r,desc:s,oldRule:l,id:c}=n,d=I.useDependency(Ht),u=I.useDependency(I.ISidebarService),h=I.useDependency(a.IAuthzIoService),g=I.useDependency(a.LocaleService),S=I.useDependency(a.ICommandService),f=I.useDependency(gt),p=I.useDependency(a.IUniverInstanceService).getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),C=p==null?void 0:p.getActiveSheet();if(!p||!C)return null;const _=p.getUnitId(),w=C.getSheetId();return b.jsxs("div",{className:"univer-mt-auto univer-flex univer-flex-row-reverse univer-gap-2 univer-py-5",children:[b.jsx(X.Button,{variant:"primary",onClick:async()=>{if(r)return;const E={unitId:_,subUnitId:w,permissionId:t,id:c,viewState:o,editState:e,unitType:m.UnitObject.SelectRange,ranges:i,description:s};iv(i,C)&&(E.unitType=m.UnitObject.Worksheet,E.ranges=[]);let T=f.selectUserList;E.editState===m.EditStateEnum.OnlyMe&&(T=[],f.setSelectUserList([]));const P={read:E.viewState===m.ViewStateEnum.OthersCanView?Ue.AllCollaborator:Ue.SomeCollaborator,edit:E.editState===m.EditStateEnum.DesignedUserCanEdit?Ue.SomeCollaborator:Ue.OneSelf};if(E.editState===m.EditStateEnum.DesignedUserCanEdit&&T.length===0&&(T=[],P.edit=Ue.OneSelf),E.permissionId){const D=rh(T.filter(W=>W.role===Oe.Editor),f.oldCollaboratorList.filter(W=>W.role===Oe.Editor)),k=(l==null?void 0:l.viewState)===E.viewState,H=(l==null?void 0:l.editState)===E.editState,V=E.unitType===(l==null?void 0:l.unitType)&&E.description===l.description&&E.ranges===l.ranges,L=!D||!k||!H;if(V&&L)await h.update({objectType:E.unitType,objectID:E.permissionId,unitID:E.unitId,share:void 0,name:"",strategies:[],scope:P,collaborators:{collaborators:T}});else{let W=E.permissionId;L&&(E.unitType===m.UnitObject.Worksheet?W=await h.create({worksheetObject:{collaborators:T,unitID:E.unitId,name:"",strategies:[{role:Oe.Editor,action:$.Edit},{role:Oe.Reader,action:$.View}],scope:P},objectType:m.UnitObject.Worksheet}):W=await h.create({selectRangeObject:{collaborators:T,unitID:E.unitId,name:"",scope:P},objectType:m.UnitObject.SelectRange})),S.executeCommand(m.SetProtectionCommand.id,{rule:{...E,permissionId:W},oldRule:l})}}else if(E.unitType===m.UnitObject.Worksheet){const D=await h.create({worksheetObject:{collaborators:T,unitID:E.unitId,name:"",strategies:[{role:Oe.Editor,action:$.Edit},{role:Oe.Reader,action:$.View}],scope:P},objectType:m.UnitObject.Worksheet}),{ranges:k=[],...H}=E;H.permissionId=D,S.executeCommand(m.AddWorksheetProtectionCommand.id,{rule:H,unitId:E.unitId})}else if(E.unitType===m.UnitObject.SelectRange){const D=await h.create({selectRangeObject:{collaborators:T,unitID:E.unitId,name:"",scope:P},objectType:m.UnitObject.SelectRange});S.executeCommand(m.AddRangeProtectionCommand.id,{rule:E,permissionId:D})}const A={header:{title:`${g.t("permission.panel.title")}`},children:{label:oi,showDetail:!1},width:330};u.open(A)},children:g.t("permission.button.confirm")}),b.jsx(X.Button,{onClick:()=>{d.reset(),f.reset(),u.close()},children:g.t("permission.button.cancel")})]})},av=n=>{const{ranges:o,onRangesChange:e,desc:t,onDescChange:i,rangesErrMsg:r,permissionId:s}=n,l=I.useDependency(I.ComponentManager),c=x.useMemo(()=>l.get(jo),[]),d=I.useDependency(a.IUniverInstanceService),u=I.useDependency(a.LocaleService),h=I.useDependency(a.Injector),g=d.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),S=g==null?void 0:g.getActiveSheet();if(!g||!S)return null;const f=g.getUnitId(),v=S.getSheetId(),p=C=>{const _=C.split(",").map(K.deserializeRangeWithSheet).map(D=>D.range);if(_.some(D=>!a.isValidRange(D)||D.endColumn<D.startColumn||D.endRow<D.startRow))return;const w=d.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),E=w==null?void 0:w.getActiveSheet();if(!w||!E)return;const O=w.getUnitId(),T=E.getSheetId(),P=_.map(D=>{const k=E.getRowCount(),H=E.getColumnCount();return m.setEndForRange(D,k,H),D}),A=qc(h,P,s,O,T);e(P,A)};return b.jsxs(b.Fragment,{children:[b.jsx(X.FormLayout,{className:"univer-font-medium",label:u.t("permission.panel.protectedRange"),error:r,children:c&&b.jsx(c,{unitId:f,subUnitId:v,initialValue:o==null?void 0:o.map(C=>K.serializeRange(C)).join(","),onChange:(C,_)=>p(_)})}),b.jsx(X.FormLayout,{className:"univer-font-medium",label:u.t("permission.panel.permissionDirection"),children:b.jsx(X.Input,{value:t,onChange:C=>i(C),placeholder:u.t("permission.panel.permissionDirectionPlaceholder")})})]})},Qc="data:image/png;base64,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",lv=n=>{const{editState:o,onEditStateChange:e,viewState:t,onViewStateChange:i,permissionId:r}=n,s=I.useDependency(a.LocaleService),l=I.useDependency(I.IDialogService),c=I.useDependency(a.IAuthzIoService),d=I.useDependency(gt),u=I.useDependency(a.UserManagerService),h=I.useDependency(a.IUniverInstanceService),g=I.useObservable(d.selectUserList$,d.selectUserList),S=h.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),f=S==null?void 0:S.getActiveSheet();if(!S||!f)return null;const v=S.getUnitId(),p=async()=>{const C=await c.listCollaborators({objectID:v,unitID:v}),_=u.getCurrentUser();d.setCanEditUserList(C.filter(w=>{var E;return((E=w.subject)==null?void 0:E.userID)!==_.userID})),l.open({id:$i,title:{title:""},children:{label:pa},width:280,destroyOnClose:!0,closable:!1,onClose:()=>l.close($i),className:"sheet-permission-user-dialog"})};return x.useEffect(()=>{r?(async()=>{const w=(await c.listCollaborators({objectID:r,unitID:v})).filter(E=>E.role===Oe.Editor);w.length>0&&e(m.EditStateEnum.DesignedUserCanEdit),d.setSelectUserList(w),d.setOldCollaboratorList(w)})():(d.setSelectUserList([]),d.setOldCollaboratorList([]))},[]),b.jsxs(b.Fragment,{children:[b.jsx(X.FormLayout,{className:"univer-font-medium",label:s.t("permission.panel.editPermission"),children:b.jsxs(X.RadioGroup,{value:o,onChange:C=>e(C),className:"univer-flex univer-flex-col",children:[b.jsx(X.Radio,{value:m.EditStateEnum.OnlyMe,children:b.jsx("span",{children:s.t("permission.panel.onlyICanEdit")})}),b.jsx(X.Radio,{value:m.EditStateEnum.DesignedUserCanEdit,children:b.jsx("span",{children:s.t("permission.panel.designedUserCanEdit")})})]})}),o===m.EditStateEnum.DesignedUserCanEdit&&b.jsxs("div",{className:X.clsx("univer-mb-2 univer-flex univer-h-[270px] univer-flex-col univer-overflow-y-auto univer-rounded-lg univer-p-3",X.borderClassName),children:[b.jsxs("div",{className:"univer-flex univer-items-center univer-justify-between univer-text-sm",children:[b.jsx("span",{children:s.t("permission.panel.designedPerson")}),b.jsx("span",{className:"univer-cursor-pointer univer-text-primary-600",onClick:p,children:s.t("permission.panel.addPerson")})]}),b.jsx("div",{className:"univer-my-2 univer-h-px univer-bg-gray-200"}),b.jsx("div",{className:"univer-flex-1",children:(g==null?void 0:g.length)>0?g.map(C=>{var _,w,E;return b.jsxs("div",{className:"univer-mb-3 univer-flex univer-h-7 univer-items-center univer-leading-7 last:univer-mb-0",children:[b.jsx(X.Avatar,{size:24,src:(_=C.subject)==null?void 0:_.avatar}),b.jsx("span",{className:"univer-ml-1.5 univer-w-[130px] univer-truncate univer-text-gray-900 dark:!univer-text-white",children:(w=C.subject)==null?void 0:w.name}),b.jsx(X.Select,{className:"!univer-w-[90px] univer-min-w-0 univer-cursor-pointer",borderless:!0,value:"edit",options:[{label:`${s.t("permission.panel.canEdit")}`,value:"edit"},{label:`${s.t("permission.panel.delete")}`,value:"delete"}],onChange:O=>{O==="delete"&&d.setSelectUserList(g.filter(T=>{var P,A;return((P=T.subject)==null?void 0:P.userID)!==((A=C.subject)==null?void 0:A.userID)}))}})]},(E=C.subject)==null?void 0:E.userID)}):b.jsxs("div",{className:"univer-flex univer-h-full univer-flex-col univer-items-center univer-justify-center",children:[b.jsx("img",{width:240,height:120,src:Qc,alt:""}),b.jsx("p",{className:"univer-w-60 univer-break-words univer-text-sm univer-text-gray-400",children:s.t("permission.dialog.userEmpty")})]})})]}),b.jsx(X.FormLayout,{className:"univer-font-medium",label:s.t("permission.panel.viewPermission"),children:b.jsxs(X.RadioGroup,{value:t,onChange:C=>i(C),className:"univer-flex univer-flex-col last:univer-mb-0",children:[b.jsx(X.Radio,{value:m.ViewStateEnum.OthersCanView,children:b.jsx("span",{children:s.t("permission.panel.othersCanView")})}),b.jsx(X.Radio,{value:m.ViewStateEnum.NoOneElseCanView,children:b.jsx("span",{children:s.t("permission.panel.noOneElseCanView")})})]})})]})},cv=n=>{var w,E;const{fromSheetBar:o,rule:e,oldRule:t}=n,i=I.useDependency(a.Injector),r=I.useDependency(I.ComponentManager),s=e?rv(i,e):ov(i,o),[l,c]=x.useState(s.ranges),[d,u]=x.useState(()=>qc(i,s.ranges,s.permissionId,s.unitId,s.subUnitId)),[h,g]=x.useState(s.description),[S,f]=x.useState((w=s.editState)!=null?w:m.EditStateEnum.OnlyMe),[v,p]=x.useState((E=s.viewState)!=null?E:m.ViewStateEnum.OthersCanView),C=r.get(ri),_=C!=null?C:lv;return x.useEffect(()=>{const O=i.get(a.IUniverInstanceService),T=i.get(I.ISidebarService),P=O.getCurrentUnitOfType(a.UniverInstanceType.UNIVER_SHEET);if(!P)return;const A=P.getActiveSheet().getSheetId(),D=P.activeSheet$.subscribe(k=>{(k==null?void 0:k.getSheetId())!==A&&T.close()});return()=>{D.unsubscribe()}},[]),b.jsxs("div",{className:"univer-mt-4 univer-flex univer-h-[calc(100%-16px)] univer-flex-col",children:[b.jsx(av,{permissionId:s.permissionId,ranges:l,onRangesChange:(O,T)=>{c(O),u(T)},rangesErrMsg:d,desc:h,onDescChange:O=>g(O)}),b.jsx(_,{editState:S,onEditStateChange:O=>f(O),viewState:v,onViewStateChange:O=>p(O),permissionId:s.permissionId}),b.jsx(sv,{permissionId:s.permissionId,id:s.id,ranges:l,rangesErrMsg:d,desc:h,viewState:v,editState:S,oldRule:t})]})},dv="data:image/png;base64,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";function uv(){var L;const[n,o]=x.useState(!0),[e,t]=x.useState(!1),[i,r]=x.useState([]),s=I.useDependency(a.LocaleService),l=I.useDependency(m.RangeProtectionRuleModel),c=I.useDependency(m.WorksheetProtectionRuleModel),d=I.useDependency(a.IUniverInstanceService),u=I.useDependency(a.ICommandService),h=I.useDependency(I.ISidebarService),g=I.useDependency(a.IAuthzIoService),S=I.useDependency(a.IPermissionService),v=I.useDependency(a.UserManagerService).getCurrentUser(),p=I.useDependency(gt),C=I.useObservable(c.ruleRefresh$,""),_=I.useObservable(l.ruleRefresh$,""),w=d.getCurrentUnitOfType(a.UniverInstanceType.UNIVER_SHEET);if(!w)return null;const E=w.getUnitId(),O=x.useCallback(async W=>{var G;const B=w.getActiveSheet(),U=w.getUnitId(),z=B.getSheetId(),F=[],j=[];w.getSheets().forEach(Z=>{const J=Z.getSheetId();l.getSubunitRuleList(U,J).forEach(ie=>{ie.permissionId&&F.push(ie.permissionId)});const ue=c.getRule(U,J);ue!=null&&ue.permissionId&&j.push(ue.permissionId)});const Y=[...F,...j],Q=await g.list({objectIDs:Y,unitID:U,actions:m.baseProtectionActions}),oe=l.getSubunitRuleList(U,z).map(Z=>Z.permissionId),re=(G=c.getRule(U,z))==null?void 0:G.permissionId;re&&oe.push(re);const ce=Q.filter(Z=>{var J;return oe.includes(Z.objectID)||Z.objectID===((J=c.getRule(U,z))==null?void 0:J.permissionId)});return W?ce:Q},[]),[T,P]=x.useState([]);x.useEffect(()=>{const W=N.merge(l.ruleChange$,c.ruleChange$).subscribe(async()=>{const B=await O(n);P(B)});return()=>{W.unsubscribe()}},[n]),x.useEffect(()=>{const W=w.activeSheet$.pipe(N.distinctUntilChanged((B,U)=>(B==null?void 0:B.getSheetId())===(U==null?void 0:U.getSheetId()))).subscribe(async()=>{const B=await O(n);P(B)});return()=>{W.unsubscribe()}},[n]),x.useEffect(()=>{(async()=>{if(C||_){const B=await O(!0);P(B)}})()},[C,_]);function A(W){const{unitId:B,subUnitId:U,unitType:z}=W;let F;z===Je.Worksheet?F=u.executeCommand(m.DeleteWorksheetProtectionCommand.id,{unitId:B,subUnitId:U,rule:W}):z===Je.SelectRange&&(F=u.executeCommand(m.DeleteRangeProtectionCommand.id,{unitId:B,subUnitId:U,rule:W})),F&&(t(!e),W.ranges===i&&r([]))}x.useEffect(()=>{p.reset()},[]),xc(i);const D=x.useMemo(()=>{const W=new Map;return w.getSheets().forEach(B=>{const U=B.getSheetId();l.getSubunitRuleList(E,U).forEach(j=>{W.set(j.permissionId,j)});const F=c.getRule(E,U);F&&W.set(F==null?void 0:F.permissionId,F)}),W},[E,w,l,c]),k=W=>{W.subUnitId!==w.getActiveSheet().getSheetId()&&u.executeCommand(m.SetWorksheetActiveOperation.id,{unitId:W.unitId,subUnitId:W.subUnitId});const B={header:{title:"permission.panel.title"},children:{label:oi,showDetail:!0,rule:a.Tools.deepClone(W),oldRule:a.Tools.deepClone(W)},width:330};h.open(B)},H=W=>{o(W)},V=(L=S.getPermissionPoint(new m.WorkbookCreateProtectPermission(E).id))==null?void 0:L.value;return b.jsxs("div",{className:"univer-mt-2 univer-flex univer-h-[calc(100%-8px)] univer-flex-col",children:[b.jsxs("div",{className:"univer-flex univer-h-[30px] univer-py-2",children:[b.jsxs("div",{className:"univer-mr-5 univer-flex univer-cursor-pointer univer-flex-col univer-items-center",onClick:()=>H(!0),children:[b.jsxs("div",{className:X.clsx("univer-h-6 univer-text-base univer-font-medium univer-leading-6",{"univer-text-blue-500":n}),children:[" ",s.t("permission.panel.currentSheet")]}),b.jsx("div",{className:X.clsx("univer-mt-1 univer-h-0.5 univer-w-6",{"univer-bg-blue-500":n})})]}),b.jsxs("div",{className:"univer-mr-5 univer-flex univer-cursor-pointer univer-flex-col univer-items-center",onClick:()=>H(!1),children:[b.jsx("div",{className:X.clsx("univer-h-6 univer-text-base univer-font-medium univer-leading-6",{"univer-text-blue-500":!n}),children:s.t("permission.panel.allSheet")}),b.jsx("div",{className:X.clsx("univer-mt-1 univer-h-0.5 univer-w-6",{"univer-bg-blue-500":!n})})]})]}),(T==null?void 0:T.length)>0?b.jsx("div",{children:T==null?void 0:T.map(W=>{var J,ne,ue,ie,se;const B=D.get(W.objectID);if(!B)return null;const U=W.actions.find(te=>te.action===$.Edit),z=U==null?void 0:U.allowed,F=W.actions.find(te=>te.action===$.View),j=F==null?void 0:F.allowed,Y=W.actions.find(te=>te.action===$.ManageCollaborator),Q=W.actions.find(te=>te.action===$.Delete),oe=(Y==null?void 0:Y.allowed)||v.userID===((J=W.creator)==null?void 0:J.userID),re=(Q==null?void 0:Q.allowed)||v.userID===((ne=W.creator)==null?void 0:ne.userID);let ce="";const G=w.getSheetBySheetId(B.subUnitId),Z=G==null?void 0:G.getName();if(B.unitType===Je.SelectRange){const te=B.ranges,fe=te!=null&&te.length?te.map(ve=>{const we=K.serializeRange(ve);return we==="NaN"?"":we}).filter(ve=>!!ve).join(","):"";ce=`${Z}(${fe})`}else B.unitType===Je.Worksheet&&(ce=Z||"");return b.jsxs("div",{className:X.clsx("univer-mt-3 univer-rounded-lg univer-p-3 hover:univer-bg-gray-50",X.borderClassName),onMouseMove:()=>{const{subUnitId:te,unitType:fe}=B,ve=w.getActiveSheet();if(!ve)return!1;const we=ve.getSheetId();if(te!==we)return!1;if(fe===Je.SelectRange){const Ee=B.ranges||[];Ee!==i&&r(Ee)}else if(fe===Je.Worksheet){const Ee=[{startRow:0,endRow:ve.getRowCount()-1,startColumn:0,endColumn:ve.getColumnCount()-1}];Ee!==i&&r(Ee)}},onMouseLeave:()=>r([]),children:[b.jsxs("div",{className:"univer-flex univer-h-5 univer-justify-between univer-leading-5",children:[b.jsx(X.Tooltip,{title:ce,children:b.jsx("div",{className:"univer-max-w-[200px] univer-truncate univer-text-sm univer-font-medium",children:ce})}),(oe||re)&&b.jsxs("div",{className:"univer-flex univer-items-center",children:[oe&&b.jsx(X.Tooltip,{title:s.t("permission.panel.edit"),children:b.jsx("div",{className:"univer-box-border univer-h-6 univer-rounded-sm univer-p-1 hover:univer-bg-gray-200",onClick:()=>k(B),children:b.jsx(Rr,{})})}),re&&b.jsx(X.Tooltip,{title:s.t("permission.panel.delete"),children:b.jsx("div",{className:"univer-box-border univer-h-6 univer-rounded-sm univer-p-1 hover:univer-bg-gray-200",onClick:()=>A(B),children:b.jsx(ho,{})})})]})]}),b.jsx("div",{className:"univer-my-2 univer-h-px univer-bg-gray-200"}),b.jsxs("div",{children:[b.jsxs("div",{className:"univer-flex univer-items-center",children:[b.jsx(X.Tooltip,{title:(ie=(ue=W.creator)==null?void 0:ue.name)!=null?ie:"",children:b.jsx("div",{children:b.jsx(X.Avatar,{src:(se=W.creator)==null?void 0:se.avatar,className:"univer-mr-1.5",size:24})})}),b.jsx("span",{className:"univer-h-4 univer-flex-grow univer-text-xs univer-text-gray-900 dark:!univer-text-white",children:s.t("permission.panel.created")}),b.jsx("span",{className:"univer-h-4 univer-text-xs univer-text-gray-900 dark:!univer-text-white",children:z?`${s.t("permission.panel.iCanEdit")}`:`${s.t("permission.panel.iCanNotEdit")}`})]}),b.jsxs("div",{className:"univer-mt-2 univer-flex univer-items-center",children:[b.jsx("span",{className:"univer-h-4 univer-flex-grow univer-text-xs univer-text-gray-900 dark:!univer-text-white",children:s.t("permission.panel.viewPermission")}),b.jsx("span",{className:"univer-h-4 univer-text-xs univer-text-gray-900 dark:!univer-text-white",children:j?`${s.t("permission.panel.iCanView")}`:`${s.t("permission.panel.iCanNotView")}`})]}),B.description&&b.jsx(X.Tooltip,{title:B.description,children:b.jsx("div",{className:"univer-text-3 univer-mt-2 univer-max-w-64 univer-truncate univer-text-sm univer-text-gray-400",children:B.description})})]})]},W.objectID)})}):b.jsxs("div",{className:"univer-flex univer-flex-1 univer-flex-col univer-items-center univer-justify-center",children:[b.jsx("img",{width:240,height:120,src:dv,alt:"",draggable:!1}),b.jsx("p",{className:"univer-w-60 univer-break-words univer-text-sm univer-text-gray-400",children:s.t("permission.dialog.listEmpty")})]}),V&&b.jsx("div",{className:"univer-mt-auto univer-py-5",children:b.jsxs(X.Button,{className:"univer-w-full",variant:"primary",onClick:()=>{const W={header:{title:`${s.t("permission.panel.title")}`},children:{label:oi,showDetail:!0},width:330};h.open(W)},children:[b.jsx("div",{children:"+ "}),s.t("permission.button.addNewPermission")]})})]})}const hv=({showDetail:n,fromSheetBar:o,rule:e,oldRule:t})=>{var h;const i=I.useDependency(a.IUniverInstanceService),r=I.useDependency(m.SheetsSelectionsService);if(!I.useDependency(Ht).getVisible())return null;const l=m.getSheetCommandTarget(i);if(!l)return null;const{worksheet:c}=l,u=((h=r.getCurrentSelections())==null?void 0:h.map(g=>g.range)).reduce((g,S)=>g+K.serializeRangeWithSheet(c.getName(),S),"");return n?b.jsx(cv,{fromSheetBar:o,rule:e,oldRule:t},o?"sheet-bar":"normal"):b.jsx(uv,{},u)},mv=({loading:n,children:o})=>b.jsxs("div",{className:"univer-relative univer-h-full univer-w-full",children:[n&&b.jsx("div",{className:"univer-absolute -univer-bottom-0.5 -univer-left-0.5 -univer-right-0.5 -univer-top-0.5 univer-z-10 univer-flex univer-items-center univer-justify-center univer-bg-white univer-backdrop-blur dark:!univer-bg-black",children:b.jsx("div",{className:"univer-size-10 univer-animate-spin univer-rounded-full univer-border-4 univer-border-solid univer-border-gray-100 univer-border-t-primary-500"})}),b.jsx("div",{className:n?"univer-pointer-events-none univer-blur-sm":"",children:o})]}),gv=()=>{const n=I.useDependency(a.LocaleService),o=I.useDependency(a.IUniverInstanceService),e=I.useDependency(a.IAuthzIoService),t=I.useDependency(m.WorksheetProtectionPointModel),i=I.useDependency(I.IDialogService),r=I.useDependency(a.IPermissionService),s=o.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),l=s.getActiveSheet();if(!l)throw new Error("No active sheet found");const[c,d]=x.useState([]),u=I.useDependency(a.ICommandService),[h,g]=x.useState(()=>!!t.getRule(s.getUnitId(),l.getSheetId())),[S,f]=x.useState(()=>Object.keys(to).reduce((p,C)=>(p[C]={text:n.t(`permission.panel.${to[Number(C)]}`),allowed:!0},p),{}));x.useEffect(()=>{(async()=>{const C=s.getUnitId(),_=await e.listCollaborators({objectID:C,unitID:C});d(_)})()},[]),x.useEffect(()=>{(async()=>{const C=s.getUnitId(),_=t.getRule(C,l.getSheetId());if(!_)return;g(!0);const E=(await e.list({unitID:s.getUnitId(),objectIDs:[_.permissionId],actions:Hu}))[0].strategies.reduce((O,T)=>(to[T.action]&&(O[T.action]={text:n.t(`permission.panel.${to[T.action]}`),allowed:T.role!==Oe.Owner}),O),{});f(E),setTimeout(()=>{g(!1)},100)})()},[]);const v=async()=>{const p=o.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),C=p==null?void 0:p.getActiveSheet();if(!C)throw new Error("No active sheet found");const _=p.getUnitId(),w=C.getSheetId(),E=t.getRule(_,w),O=Object.keys(S).map(P=>({action:Number(P),role:S[P].allowed?Oe.Editor:Oe.Owner}));let T=E==null?void 0:E.permissionId;T?e.update({objectType:Je.Worksheet,objectID:T,unitID:_,strategies:O,share:void 0,name:"",scope:{read:Ue.AllCollaborator,edit:Ue.AllCollaborator},collaborators:void 0}).then(()=>{m.getAllWorksheetPermissionPoint().forEach(P=>{const A=new P(_,w),D=A.subType,k=O.find(H=>H.action===D);k&&r.updatePermissionPoint(A.id,k.role===Oe.Editor)})}):(T=await e.create({objectType:Je.Worksheet,worksheetObject:{unitID:_,collaborators:c,name:"",strategies:O,scope:{read:Ue.AllCollaborator,edit:Ue.AllCollaborator}}}),u.executeCommand(m.SetWorksheetPermissionPointsCommand.id,{rule:{permissionId:T,unitId:_,subUnitId:w}}))};return b.jsx(mv,{loading:h,children:b.jsxs("div",{className:X.clsx("univer-flex univer-flex-col",X.borderTopClassName),children:[Object.keys(S).map(p=>{const C=S[p],{text:_,allowed:w}=C;return b.jsxs("div",{className:"univer-my-1.5 univer-flex univer-h-5 univer-items-center univer-justify-between univer-leading-5",children:[b.jsx("div",{children:_}),b.jsx(X.Switch,{defaultChecked:w,onChange:()=>{f({...S,[p]:{...C,allowed:!w}})}})]},_)}),b.jsxs("div",{className:X.clsx("univer-flex univer-h-9 univer-items-center univer-justify-end univer-gap-2 univer-pt-2",X.borderTopClassName),children:[b.jsx(X.Button,{onClick:()=>{i.close(eo)},children:n.t("permission.button.cancel")}),b.jsx(X.Button,{variant:"primary",onClick:()=>{v(),i.close(eo)},children:n.t("permission.button.confirm")})]})]})})},Sv=()=>{var u;const[n,o]=x.useState(""),e=I.useDependency(a.LocaleService),t=I.useDependency(I.IDialogService),i=I.useDependency(gt),r=I.useObservable(i.userList$,i.userList),s=(u=r==null?void 0:r.filter(h=>{var g;return((g=h.subject)==null?void 0:g.name.toLocaleLowerCase().includes(n.toLocaleLowerCase()))&&h.role===Oe.Editor}))!=null?u:[],[l,c]=x.useState(i.selectUserList),d=h=>{if((l==null?void 0:l.findIndex(S=>{var f,v;return((f=S.subject)==null?void 0:f.userID)===((v=h.subject)==null?void 0:v.userID)}))===-1){const S={...h};c([...l,S])}else{const S=l.filter(f=>{var v,p;return((v=f.subject)==null?void 0:v.userID)!==((p=h.subject)==null?void 0:p.userID)});c(S)}};return b.jsxs("div",{children:[b.jsx("div",{children:b.jsx(X.Input,{className:"univer-w-full",placeholder:e.t("permission.dialog.search"),value:n,onChange:h=>o(h)})}),b.jsx("div",{className:X.clsx("univer-h-60 univer-overflow-y-auto",X.scrollbarClassName),children:(s==null?void 0:s.length)>0?s==null?void 0:s.map(h=>{var g,S,f;return b.jsxs("div",{className:"univer-my-2 univer-flex univer-items-center univer-rounded-md hover:univer-bg-gray-50",onClick:()=>d(h),children:[b.jsx(X.Avatar,{src:(g=h.subject)==null?void 0:g.avatar,size:24}),b.jsx("div",{className:"univer-ml-1.5 univer-flex-1",children:(S=h.subject)==null?void 0:S.name}),(l==null?void 0:l.findIndex(v=>{var p,C;return((p=v.subject)==null?void 0:p.userID)===((C=h.subject)==null?void 0:C.userID)}))!==-1&&b.jsx("div",{children:b.jsx(zt,{})})]},(f=h.subject)==null?void 0:f.userID)}):b.jsxs("div",{className:"univer-flex univer-h-full univer-flex-col univer-items-center",children:[b.jsx("img",{className:"univer-w-full",src:Qc,alt:"empty list",draggable:!1}),b.jsx("p",{className:"univer-text-sm univer-text-gray-400",children:e.t("permission.dialog.userEmpty")})]})}),b.jsx("div",{className:"univer-h-px univer-w-full univer-bg-gray-200"}),b.jsxs("div",{className:"univer-flex univer-items-center univer-justify-end univer-gap-1 univer-py-2",children:[b.jsx(X.Button,{onClick:()=>t.close($i),children:e.t("permission.button.cancel")}),b.jsx(X.Button,{variant:"primary",onClick:()=>{i.setSelectUserList(l),t.close($i)},children:e.t("permission.button.confirm")})]})]})},fv=({errorMsg:n})=>{const o=I.useDependency(a.LocaleService);return b.jsx("div",{children:b.jsx("p",{className:"univer-m-0",children:n||o.t("permission.dialog.alertContent")})})},Jc="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNCIgaGVpZ2h0PSI0IiB2aWV3Qm94PSIwIDAgNCA0IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8bWFzayBpZD0ibWFzazBfNzU5XzExMDgiIHN0eWxlPSJtYXNrLXR5cGU6YWxwaGEiIG1hc2tVbml0cz0idXNlclNwYWNlT25Vc2UiIHg9IjAiIHk9IjAiIHdpZHRoPSI0IiBoZWlnaHQ9IjQiPgo8cmVjdCB3aWR0aD0iNCIgaGVpZ2h0PSI0IiBmaWxsPSIjRDZEOEQ5Ii8+CjwvbWFzaz4KPGcgbWFzaz0idXJsKCNtYXNrMF83NTlfMTEwOCkiPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTS0zLjY0MDAyIDMuNDQxNDFMMi4wNzM5NyAtMi4yNzI1OEwyLjc4MTA4IC0xLjU2NTQ4TC0yLjkzMjkxIDQuMTQ4NTJMLTMuNjQwMDIgMy40NDE0MVoiIGZpbGw9IiNENkQ4REIiLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0tMS41MTg2OCA1LjU2Mjc1TDQuMTk1MzEgLTAuMTUxMjQ1TDQuOTAyNDIgMC41NTU4NjJMLTAuODExNTc1IDYuMjY5ODZMLTEuNTE4NjggNS41NjI3NVoiIGZpbGw9IiNENkQ4REIiLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0wLjYwMjY1NiA3LjY4NDAzTDYuMzE2NjUgMS45NzAwM0w3LjAyMzc2IDIuNjc3MTRMMS4zMDk3NiA4LjM5MTEzTDAuNjAyNjU2IDcuNjg0MDNaIiBmaWxsPSIjRDZEOERCIi8+CjwvZz4KPC9zdmc+",bs="RANGE_PROTECTION_CAN_VIEW_RENDER_EXTENSION_KEY",ws="RANGE_PROTECTION_CAN_NOT_VIEW_RENDER_EXTENSION_KEY",vv=25,pv=80;class $c extends M.SheetExtension{constructor(e){super();R(this,"_pattern",null);R(this,"_img",new Image);R(this,"renderCache",new Set);R(this,"_shadowStrategy","always");this._img.src=Jc,e&&(this._shadowStrategy=e)}clearCache(){this.renderCache.clear()}setShadowStrategy(e){this._shadowStrategy=e,this.clearCache()}getShadowStrategy(){return this._shadowStrategy}draw(e,t,i){const{worksheet:r}=i;r&&(e.save(),this._pattern||(this._pattern=e.createPattern(this._img,"repeat")),this.renderCache.clear(),a.Range.foreach(i.rowColumnSegment,(s,l)=>{if(!r.getRowVisible(s)||!r.getColVisible(l))return;const{selectionProtection:c=[]}=r.getCell(s,l)||{};this._pattern&&(e.fillStyle=this._pattern,c.forEach(d=>{if(d.ruleId&&this.shouldRender(d)){if(this.renderCache.has(d.ruleId))return;this.renderCache.add(d.ruleId),d.ranges.forEach(u=>{const h=i.getCellWithCoordByIndex(u.startRow,u.startColumn,!1),g=i.getCellWithCoordByIndex(u.endRow,u.endColumn,!1);e.fillRect(h.startX,h.startY,g.endX-h.startX,g.endY-h.startY)})}}))}),e.restore())}}class Cv extends $c{constructor(e){super(e);R(this,"uKey",bs);R(this,"Z_INDEX",vv)}shouldRender(e){return this._shadowStrategy==="none"?!1:this._shadowStrategy==="non-editable"?(e==null?void 0:e[$.View])!==!1&&(e==null?void 0:e[$.Edit])===!1:this._shadowStrategy==="non-viewable"?(e==null?void 0:e[$.View])===!1:(e==null?void 0:e[$.View])!==!1}}class Iv extends $c{constructor(e){super(e);R(this,"uKey",ws);R(this,"Z_INDEX",pv)}shouldRender(e){return this._shadowStrategy==="none"?!1:(e==null?void 0:e[$.View])===!1}}const Es="worksheet-protection",ed=25,_v=80;class bv extends M.SheetExtension{constructor(e){super();R(this,"uKey",Es);R(this,"Z_INDEX",ed);R(this,"_pattern");R(this,"_img",new Image);R(this,"_shadowStrategy","always");this._img.src=Jc,e&&(this._shadowStrategy=e)}draw(e,t,i){const{worksheet:r}=i;if(!r)return!1;e.save(),this._pattern||(this._pattern=e.createPattern(this._img,"repeat"));const{startRow:s,startColumn:l,endRow:c,endColumn:d}=i.rowColumnSegment,u=i.getCellWithCoordByIndex(s,l,!1),h=i.getCellWithCoordByIndex(c,d,!1),{hasWorksheetRule:g=!1,selectionProtection:S=[]}=r.getCell(s,l)||{};if(!this._pattern)return;if(S.length>0){const v=S[0];(v==null?void 0:v[$.View])?this.setZIndex(ed):this.setZIndex(_v)}e.fillStyle=this._pattern;let f=g;if(this._shadowStrategy==="none")f=!1;else if(g&&S.length>0){const v=S[0];this._shadowStrategy==="non-editable"?f=(v==null?void 0:v[$.Edit])===!1:this._shadowStrategy==="non-viewable"&&(f=(v==null?void 0:v[$.View])===!1)}f&&e.fillRect(u.startX,u.startY,h.endX-u.startX,h.endY-u.startY),e.restore()}setShadowStrategy(e){this._shadowStrategy=e}getShadowStrategy(){return this._shadowStrategy}setZIndex(e){this.Z_INDEX=e}}var wv=Object.getOwnPropertyDescriptor,Ts=(n,o,e,t)=>{for(var i=t>1?void 0:t?wv(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Ke=(n,o)=>(e,t)=>o(e,t,n);let Fn=class extends a.Disposable{constructor(n,o){super(),this._injector=n,this._componentManager=o,this._init()}_init(){this._initComponents(),this._initUiPartComponents()}_initComponents(){[[Ia,Ba],[Vu,ho],[Wu,Rr],[Lu,zt],[_a,Tr],[oi,hv],[pa,Sv],[Ca,gv],[Zl,fv]].forEach(([n,o])=>{this.disposeWithMe(this._componentManager.register(n,o))})}_initUiPartComponents(){const o=this._injector.get(a.IConfigService).getConfig(Te);if(o!=null&&o.protectedRangeUserSelector){const{component:e,framework:t}=o.protectedRangeUserSelector;this.disposeWithMe(this._componentManager.register(ri,e,{framework:t}))}}};Fn=Ts([Ke(0,a.Inject(a.Injector)),Ke(1,a.Inject(I.ComponentManager))],Fn);let Do=class extends a.Disposable{constructor(o,e,t,i,r){super();R(this,"_rangeProtectionCanViewRenderExtension");R(this,"_rangeProtectionCanNotViewRenderExtension");this._context=o,this._rangeProtectionRuleModel=e,this._sheetSkeletonManagerService=t,this._permissionService=i,this._configService=r;const s=this._configService.getConfig(Te),l=br(s==null?void 0:s.protectedRangeShadow);this._rangeProtectionCanViewRenderExtension=new Cv(l),this._rangeProtectionCanNotViewRenderExtension=new Iv(l),this._initSkeleton(),this._initRender(),this.disposeWithMe(this._rangeProtectionRuleModel.ruleChange$.subscribe(c=>{var d,u;((d=c.oldRule)!=null&&d.id&&this._rangeProtectionCanViewRenderExtension.renderCache.has(c.oldRule.id)||this._rangeProtectionCanViewRenderExtension.renderCache.has(c.rule.id))&&this._rangeProtectionCanViewRenderExtension.clearCache(),((u=c.oldRule)!=null&&u.id&&this._rangeProtectionCanNotViewRenderExtension.renderCache.has(c.oldRule.id)||this._rangeProtectionCanNotViewRenderExtension.renderCache.has(c.rule.id))&&this._rangeProtectionCanNotViewRenderExtension.clearCache()}))}_initRender(){const o=this._context.mainComponent;o&&(o.getExtensionByKey(bs)||o.register(this._rangeProtectionCanViewRenderExtension),o.getExtensionByKey(ws)||o.register(this._rangeProtectionCanNotViewRenderExtension))}_initSkeleton(){const o=()=>{var e;this._sheetSkeletonManagerService.reCalculate(),(e=this._context.mainComponent)==null||e.makeDirty()};this.disposeWithMe(N.merge(this._permissionService.permissionPointUpdate$.pipe(N.throttleTime(300,void 0,{trailing:!0})),this._rangeProtectionRuleModel.rangeRuleInitStateChange$,this._rangeProtectionRuleModel.ruleChange$).pipe().subscribe(o))}};Do=Ts([Ke(1,a.Inject(m.RangeProtectionRuleModel)),Ke(2,a.Inject(y.SheetSkeletonManagerService)),Ke(3,a.IPermissionService),Ke(4,a.IConfigService)],Do);let No=class extends a.Disposable{constructor(o,e,t,i,r){super();R(this,"_worksheetProtectionRenderExtension");this._context=o,this._renderManagerService=e,this._sheetSkeletonManagerService=t,this._worksheetProtectionRuleModel=i,this._configService=r;const s=this._configService.getConfig(Te),l=br(s==null?void 0:s.protectedRangeShadow);this._worksheetProtectionRenderExtension=new bv(l),this._initSkeleton(),l!=="none"&&this._initRender()}_initRender(){const o=this._context.unitId,e=o&&this._renderManagerService.getRenderById(o),t=e&&e.mainComponent;t&&(t.getExtensionByKey(Es)||t.register(this._worksheetProtectionRenderExtension))}_initSkeleton(){const o=()=>{var e;this._sheetSkeletonManagerService.reCalculate(),(e=this._context.mainComponent)==null||e.makeDirty()};this.disposeWithMe(N.merge(this._worksheetProtectionRuleModel.worksheetRuleInitStateChange$).pipe().subscribe(o))}};No=Ts([Ke(1,a.Inject(M.IRenderManagerService)),Ke(2,a.Inject(y.SheetSkeletonManagerService)),Ke(3,a.Inject(m.WorksheetProtectionRuleModel)),Ke(4,a.Inject(a.IConfigService))],No);var Ev=Object.getOwnPropertyDescriptor,Tv=(n,o,e,t)=>{for(var i=t>1?void 0:t?Ev(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},ys=(n,o)=>(e,t)=>o(e,t,n);let ko=class extends a.Disposable{constructor(n,o,e,t){super(),this._context=n,this._sheetSkeletonManagerService=o,this._sheetClipboardService=e,this._sheetClipboardController=t,this._initialize()}_initialize(){this.disposeWithMe(a.toDisposable(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(n=>{if(!(n!=null&&n.unitId)||!this._sheetClipboardService.getPasteMenuVisible())return;const o=this._sheetClipboardService.getPasteOptionsCache(),e=o==null?void 0:o.target.unitId;n.unitId===e&&this._sheetClipboardController.refreshOptionalPaste()})))}};ko=Tv([ys(1,a.Inject(y.SheetSkeletonManagerService)),ys(2,ke),ys(3,a.Inject(Kt))],ko);var yv=Object.getOwnPropertyDescriptor,Rv=(n,o,e,t)=>{for(var i=t>1?void 0:t?yv(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Rs=(n,o)=>(e,t)=>o(e,t,n);let Ho=class extends a.Disposable{constructor(n,o,e,t){super(),this._context=n,this._formatPainterService=o,this._selectionRenderService=e,this._commandService=t,this._initialize()}_initialize(){this._bindFormatPainterStatus(),this._commandExecutedListener()}_commandExecutedListener(){this.disposeWithMe(this._selectionRenderService.selectionMoveEnd$.subscribe(n=>{var o;if(this._formatPainterService.getStatus()!==Ae.OFF){const{rangeWithCoord:e}=n[n.length-1];this._commandService.executeCommand(hi.id,{unitId:this._context.unitId,subUnitId:((o=this._context.unit.getActiveSheet())==null?void 0:o.getSheetId())||"",range:{startRow:e.startRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn}}),this._formatPainterService.getStatus()===Ae.ONCE&&this._commandService.executeCommand(fn.id)}}))}_bindFormatPainterStatus(){this.disposeWithMe(a.toDisposable(this._formatPainterService.status$.subscribe(n=>{const o=this._context.scene;o&&(n!==Ae.OFF?o.setDefaultCursor(M.CURSOR_TYPE.CELL):o.setDefaultCursor(M.CURSOR_TYPE.DEFAULT))})))}};Ho=Rv([Rs(1,Fe),Rs(2,Ie),Rs(3,a.ICommandService)],Ho);var Ms=(n=>(n[n.NORMAL=0]="NORMAL",n[n.HIGHLIGHT=1]="HIGHLIGHT",n))(Ms||{});const Mv="rgba(0, 0, 0, 0.15)",ot="rgb(0, 0, 0)",Vo="rgb(255, 255, 255, 1)";class Pv extends M.Shape{constructor(e,t){super(e,t);R(this,"_size",12);R(this,"_iconRatio",.4);R(this,"_mode",0);this.setShapeProps(t)}setShapeProps(e){e!=null&&e.size&&(this._size=e.size),e!=null&&e.mode&&(this._mode=e.mode),this.transformByState({width:this._size,height:this._size})}_draw(e){this._mode===1&&M.Rect.drawWith(e,{width:this._size,height:this._size,radius:this._size,fill:Mv});const t=this._size*.5*this._iconRatio,i=Math.PI/180*60,r=t*Math.sin(i),s=t*Math.cos(i);M.RegularPolygon.drawWith(e,{pointsGroup:[[{x:-r+this._size/2,y:-s+this._size/2},{x:r+this._size/2,y:-s+this._size/2},{x:this._size/2,y:t+this._size/2}]],fill:ot})}}var Ov=Object.getOwnPropertyDescriptor,Av=(n,o,e,t)=>{for(var i=t>1?void 0:t?Ov(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Wo=(n,o)=>(e,t)=>o(e,t,n);const Dv="__SpreadsheetHeaderMenuSHAPEControllerShape__",Nv="__SpreadsheetHeaderMenuMAINControllerShape__",kv="rgba(0, 0, 0, 0.1)";let Lo=class extends a.Disposable{constructor(o,e,t,i,r){super();R(this,"_hoverRect");R(this,"_hoverMenu");R(this,"_currentColumn",Number.POSITIVE_INFINITY);R(this,"_headerPointerSubs");R(this,"_colHeaderPointerSubs");this._context=o,this._sheetSkeletonManagerService=e,this._contextMenuService=t,this._commandService=i,this._selectionManagerService=r,this._initialize()}dispose(){var o,e,t;(o=this._hoverRect)==null||o.dispose(),(e=this._hoverMenu)==null||e.dispose(),(t=this._headerPointerSubs)==null||t.unsubscribe(),this._headerPointerSubs=null}_initialize(){const o=this._context.scene;this._hoverRect=new M.Rect(Dv,{fill:kv,evented:!1}),this._hoverMenu=new Pv(Nv,{zIndex:100,visible:!1}),o.addObjects([this._hoverRect,this._hoverMenu],st),this._initialHover(0),this._initialHover(1),this._initialHoverMenu()}_initialHover(o=0){var h,g,S;const e=this._context.components.get(he.COLUMN),t=this._context.components.get(he.ROW),i=o===0?t:e,r=f=>{var P,A,D;const v=(P=this._sheetSkeletonManagerService.getCurrentParam())==null?void 0:P.skeleton;if(v==null)return;const{rowHeaderWidth:p,columnHeaderHeight:C}=v,{startX:_,startY:w,endX:E,endY:O,column:T}=Ye(f.offsetX,f.offsetY,this._context.scene,v);if(o===0)(A=this._hoverRect)==null||A.transformByState({width:p,height:O-w,left:0,top:w});else{if(this._currentColumn=T,(D=this._hoverRect)==null||D.transformByState({width:E-_,height:C,left:_,top:0}),this._hoverMenu==null)return;if(E-_<C*2){this._hoverMenu.hide();return}const k=C*.8;this._hoverMenu.transformByState({left:E-C,top:C/2-k/2}),this._hoverMenu.setShapeProps({size:k}),this._hoverMenu.show()}},s=()=>{var f;(f=this._hoverRect)==null||f.show()},l=()=>{var f,v;(f=this._hoverRect)==null||f.hide(),(v=this._hoverMenu)==null||v.hide()};this._headerPointerSubs=new N.Subscription;const c=i.onPointerMove$.subscribeEvent(r),d=i.onPointerEnter$.subscribeEvent(s),u=i.onPointerLeave$.subscribeEvent(l);(h=this._headerPointerSubs)==null||h.add(c),(g=this._headerPointerSubs)==null||g.add(d),(S=this._headerPointerSubs)==null||S.add(u)}_initialHoverMenu(){this._hoverMenu!=null&&(this._hoverMenu.onPointerEnter$.subscribeEvent(()=>{this._hoverMenu!=null&&(this._hoverMenu.setProps({mode:Ms.HIGHLIGHT,visible:!0}),this._context.scene.setCursor(M.CURSOR_TYPE.POINTER))}),this._hoverMenu.onPointerLeave$.subscribeEvent(()=>{this._hoverMenu!=null&&(this._hoverMenu.setProps({mode:Ms.NORMAL,visible:!1}),this._context.scene.resetCursor())}),this._hoverMenu.onPointerDown$.subscribeEvent(o=>{var r;const e=this._currentColumn,t=(r=this._selectionManagerService.getCurrentSelections())==null?void 0:r.map(s=>s.range);if(!!!(t!=null&&t.filter(s=>s.rangeType===a.RANGE_TYPE.COLUMN).find(s=>{const{startColumn:l,endColumn:c}=s;return e>=l&&e<=c}))){const s=this._getSelectionOnColumn(e);this._commandService.syncExecuteCommand(m.SetSelectionsOperation.id,s)}o.stopPropagation(),o.preventDefault(),this._contextMenuService.triggerContextMenu(o,I.ContextMenuPosition.COL_HEADER)}))}_getSelectionOnColumn(o){const e=this._context.unit,t=e.getActiveSheet();if(!t)throw new Error("No active worksheet");return{unitId:e.getUnitId(),subUnitId:t.getSheetId(),selections:[{range:{startRow:0,startColumn:o,endRow:t.getRowCount()-1,endColumn:o,rangeType:a.RANGE_TYPE.COLUMN},primary:{startRow:0,startColumn:o,endRow:0,endColumn:o,actualRow:0,actualColumn:o,isMerged:!1,isMergedMainCell:!1},style:null}]}}};Lo=Av([Wo(1,a.Inject(y.SheetSkeletonManagerService)),Wo(2,I.IContextMenuService),Wo(3,a.ICommandService),Wo(4,a.Inject(m.SheetsSelectionsService))],Lo);var Ps=(n=>(n[n.ROW=0]="ROW",n[n.COLUMN=1]="COLUMN",n))(Ps||{});const Vi=12,Hv=.4;class td extends M.Shape{constructor(e,t,i){super(e,t);R(this,"_size",Vi);R(this,"_iconRatio",Hv);R(this,"_hovered",!0);R(this,"_hasPrevious",!0);R(this,"_hasNext",!0);R(this,"_unhideType");t&&this.setShapeProps(t),this.onPointerEnter$.subscribeEvent(()=>this.setShapeProps({hovered:!0})),this.onPointerLeave$.subscribeEvent(()=>this.setShapeProps({hovered:!1})),this.onPointerDown$.subscribeEvent(()=>i==null?void 0:i())}setShapeProps(e){e.type!==void 0&&(this._unhideType=e.type),e.hovered!==void 0&&(this._hovered=e.hovered),e.hasPrevious!==void 0&&(this._hasPrevious=e.hasPrevious),e.hasNext!==void 0&&(this._hasNext=e.hasNext),this.transformByState({width:this._size*(this._unhideType===1?2:1),height:this._size*(this._unhideType===0?2:1)})}_draw(e){this._unhideType===0?this._drawOnRow(e):this._drawOnCol(e)}_drawOnRow(e){this._hovered&&(!this._hasNext||!this._hasPrevious?M.Rect.drawWith(e,{width:this._size,height:this._size,stroke:ot,fill:Vo}):M.Rect.drawWith(e,{width:this._size,height:2*this._size,stroke:ot,fill:Vo}));const t=this._size*.5*this._iconRatio,i=Math.PI/3,r=t*Math.cos(i),s=t*Math.sin(i);if(this._hasPrevious&&M.RegularPolygon.drawWith(e,{pointsGroup:[[{x:this._size/2,y:this._size/2-s},{x:this._size/2-s,y:this._size/2+r},{x:this._size/2+s,y:this._size/2+r}]],fill:ot}),this._hasNext){const l=this._hasPrevious?3:1;M.RegularPolygon.drawWith(e,{pointsGroup:[[{x:this._size/2,y:this._size*l/2+s},{x:this._size/2-s,y:this._size*l/2-r},{x:this._size/2+s,y:this._size*l/2-r}]],fill:ot})}}_drawOnCol(e){this._hovered&&(!this._hasNext||!this._hasPrevious?M.Rect.drawWith(e,{width:this._size,height:this._size,stroke:ot,fill:Vo}):M.Rect.drawWith(e,{width:2*this._size,height:this._size,stroke:ot,fill:Vo}));const t=this._size*.5*this._iconRatio,i=Math.PI/3,r=t*Math.cos(i),s=t*Math.sin(i);if(this._hasPrevious&&M.RegularPolygon.drawWith(e,{pointsGroup:[[{x:-r+this._size/2,y:this._size/2},{x:this._size/2+s,y:this._size/2-s},{x:this._size/2+s,y:this._size/2+s}]],fill:ot}),this._hasNext){const l=this._hasPrevious?3:1;M.RegularPolygon.drawWith(e,{pointsGroup:[[{x:r+this._size*l/2,y:this._size/2},{x:-s+this._size*l/2,y:this._size/2-s},{x:-s+this._size*l/2,y:this._size/2+s}]],fill:ot})}}}var Vv=Object.getOwnPropertyDescriptor,Wv=(n,o,e,t)=>{for(var i=t>1?void 0:t?Vv(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},nd=(n,o)=>(e,t)=>o(e,t,n);const id="__SpreadsheetHeaderUnhideSHAPEControllerShape__";let xo=class extends a.RxDisposable{constructor(o,e,t){super();R(this,"_shapes",{cols:[],rows:[]});this._context=o,this._sheetSkeletonManagerService=e,this._commandService=t,this._init()}get _workbook(){return this._context.unit}dispose(){super.dispose(),this._clearShapes()}_init(){let o="";this._context.unit.activeSheet$.pipe(N.takeUntil(this.dispose$)).subscribe(e=>{if(this._clearShapes(),!e){o="";return}o=e.getSheetId(),this._update(this._workbook,e)}),this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(e=>{if(e){const{unitId:t,sheetId:i}=e;if(t===this._workbook.getUnitId()&&i===o){const r=this._workbook.getSheetBySheetId(i);r&&this._update(this._workbook,r)}}}))}_update(o,e){var g;const t=(g=this._sheetSkeletonManagerService.getSkeletonParam(e.getSheetId()))==null?void 0:g.skeleton;if(!t)return;const i=e.getHiddenRows(),r=e.getHiddenCols(),s=this._getSheetObject(),{scene:l}=s,c=e.getRowCount(),d=i.map(S=>{const{startRow:f,endRow:v}=S,p=fr(f,0,l,t),C=f!==0,_=v!==c-1;return new td(id,{type:Ps.ROW,hovered:!1,hasPrevious:C,hasNext:_,top:p.startY-(C?Vi:0),left:p.startX-Vi},()=>this._commandService.executeCommand(m.SetSpecificRowsVisibleCommand.id,{unitId:o.getUnitId(),subUnitId:e.getSheetId(),ranges:[S]}))}),u=e.getColumnCount(),h=r.map(S=>{const{startColumn:f,endColumn:v}=S,p=fr(0,f,l,t),C=f!==0,_=v!==u-1;return new td(id,{type:Ps.COLUMN,hovered:!1,hasPrevious:C,hasNext:_,top:20-Vi,left:p.startX-(C?Vi:0)},()=>this._commandService.executeCommand(m.SetSpecificColsVisibleCommand.id,{unitId:o.getUnitId(),subUnitId:e.getSheetId(),ranges:[S]}))});l.addObjects(h,Ws),l.addObjects(d,Ws),this._clearShapes(),this._shapes={cols:h,rows:d}}_clearShapes(){this._shapes.cols.forEach(o=>o.dispose()),this._shapes.rows.forEach(o=>o.dispose()),this._shapes={cols:[],rows:[]}}_getSheetObject(){return He(this._workbook,this._context)}};xo=Wv([nd(1,a.Inject(y.SheetSkeletonManagerService)),nd(2,a.ICommandService)],xo);var Lv=Object.getOwnPropertyDescriptor,xv=(n,o,e,t)=>{for(var i=t>1?void 0:t?Lv(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},zn=(n,o)=>(e,t)=>o(e,t,n);const Uv=[Pe.id,Xe.id];let Os=class extends a.Disposable{constructor(n,o,e,t,i,r,s){super(),this._context=n,this._sheetSkeletonManagerService=o,this._commandService=e,this._renderManagerService=t,this._selectionManagerService=i,this._scrollManagerService=r,this._univerInstanceService=s,this._init()}scrollToRange(n){let{endRow:o,endColumn:e,startColumn:t,startRow:i}=n;const r=this._getViewportBounding();if(n.rangeType===a.RANGE_TYPE.ROW?(t=0,e=0):n.rangeType===a.RANGE_TYPE.COLUMN&&(i=0,o=0),r){const s=r.startRow>o?i:o,l=r.startColumn>e?t:e;return this._scrollToCell(s,l)}else return this._scrollToCell(i,t)}_init(){this._initCommandListener(),this._initScrollEventListener(),this._initPointerScrollEvent(),this._initSkeletonListener()}_initCommandListener(){this.disposeWithMe(this._commandService.onCommandExecuted(n=>{if(Uv.includes(n.id))this._scrollToSelection();else if(n.id===m.ScrollToCellOperation.id){const o=n.params.range;this.scrollToRange(o)}else if(n.id===De.id){const o=n.params;this._scrollToSelectionForExpand(o)}}))}_scrollToSelectionForExpand(n){setTimeout(()=>{const o=this._selectionManagerService.getCurrentLastSelection();if(o==null)return;const{startRow:e,startColumn:t,endRow:i,endColumn:r}=o.range,s=this._getViewportBounding();if(s==null)return;const{startRow:l,startColumn:c,endRow:d,endColumn:u}=s;let h=0,g=0;e>l?h=i:i<d?h=e:h=l,t>c?g=r:r<u?g=t:g=c,n.direction===a.Direction.DOWN?h=i:n.direction===a.Direction.UP?h=e:n.direction===a.Direction.RIGHT?g=r:n.direction===a.Direction.LEFT&&(g=t),this._scrollToCell(h,g)},0)}_getFreeze(){var o;const n=(o=this._sheetSkeletonManagerService.getCurrentParam())==null?void 0:o.skeleton.getWorksheetConfig();if(n!=null)return n.freeze}_initScrollEventListener(){const{scene:n}=this._context;if(n==null)return;const o=n.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN);o&&(this.disposeWithMe(a.toDisposable(this._scrollManagerService.rawScrollInfo$.subscribe(e=>{var g;if(e==null){o.scrollToViewportPos({viewportScrollX:0,viewportScrollY:0});return}const t=(g=this._sheetSkeletonManagerService.getCurrentParam())==null?void 0:g.skeleton;if(!t)return;const{sheetViewStartRow:i,sheetViewStartColumn:r,offsetX:s,offsetY:l}=e,{startX:c,startY:d}=t.getCellWithCoordByIndex(i,r,!1),u=c+s,h=d+l;o.scrollToViewportPos({viewportScrollX:u,viewportScrollY:h})}))),this.disposeWithMe(o.onScrollAfter$.subscribeEvent(e=>{var f;if(!e)return;const t=(f=this._sheetSkeletonManagerService.getCurrentParam())==null?void 0:f.skeleton;if(t==null)return;const i=this._getSheetObject();if(t==null||i==null)return;const{viewportScrollX:r,viewportScrollY:s,scrollX:l,scrollY:c}=e,{row:d,column:u,rowOffset:h,columnOffset:g}=t.getOffsetRelativeToRowCol(r,s),S={sheetViewStartRow:d,sheetViewStartColumn:u,offsetX:g,offsetY:h,viewportScrollX:r,viewportScrollY:s,scrollX:l,scrollY:c};this._scrollManagerService.setValidScrollStateToCurrSheet(S),this._scrollManagerService.validViewportScrollInfo$.next({...S,scrollX:l,scrollY:c,viewportScrollX:r,viewportScrollY:s})})),this.disposeWithMe(o.onScrollByBar$.subscribeEvent(e=>{var g;const t=(g=this._sheetSkeletonManagerService.getCurrentParam())==null?void 0:g.skeleton;if(t==null||e.isTrigger===!1)return;const i=this._getSheetObject();if(t==null||i==null)return;const{viewportScrollX:r=0,viewportScrollY:s=0}=e,l=this._getFreeze(),{row:c,column:d,rowOffset:u,columnOffset:h}=t.getOffsetRelativeToRowCol(r,s);this._commandService.executeCommand(Le.id,{sheetViewStartRow:c+((l==null?void 0:l.ySplit)||0),sheetViewStartColumn:d+((l==null?void 0:l.xSplit)||0),offsetX:h,offsetY:u})})))}_initSkeletonListener(){this.disposeWithMe(a.toDisposable(this._sheetSkeletonManagerService.currentSkeletonBefore$.subscribe(n=>{if(n==null)return;const o={unitId:n.unitId,sheetId:n.sheetId};this._scrollManagerService.setSearchParam(o);const e=this._getSheetObject();if(!e)return;const i=e.scene.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN),r=this._scrollManagerService.getScrollStateByParam(o),{viewportScrollX:s,viewportScrollY:l}=this._scrollManagerService.calcViewportScrollFromRowColOffset(r);i&&(r?(i.viewportScrollX=s,i.viewportScrollY=l):(i.viewportScrollX=0,i.viewportScrollY=0),this._updateSceneSize(n))})))}_initPointerScrollEvent(){const n=this._getSheetObject();if(!n)return;const o=this._scrollManagerService,e=n.scene,t=n.spreadsheet,i=e.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN),r={x:0,y:0};let s=!1;const l={x:0,y:0},c=.95;let d=null;const u=()=>{if(!i)return;l.x*=c,l.y*=c,r.x+=l.x,r.y+=l.y;const g=l.x,S=l.y;(S!==0||g!==0)&&this._commandService.executeCommand(Cn.id,{offsetY:S,offsetX:g}),Math.abs(l.x)>1||Math.abs(l.y)>1?d=requestAnimationFrame(u):d=null},h=()=>{cancelAnimationFrame(d),d=null};t.onPointerDown$.subscribeEvent((g,S)=>{h(),i&&(r.x=g.offsetX,r.y=g.offsetY,s=!0,S.stopPropagation())}),t.onPointerMove$.subscribeEvent((g,S)=>{if(!s||!i)return;const f=g,v=-(f.offsetX-r.x),p=-(f.offsetY-r.y);l.x=-(f.offsetX-r.x),l.y=-(f.offsetY-r.y);const C=v,_=p;(v!==0||p!==0)&&(_!==0||C!==0)&&this._commandService.executeCommand(Cn.id,{offsetY:_,offsetX:C}),o.getCurrentScrollState(),r.x=f.offsetX,r.y=f.offsetY,S.stopPropagation()}),t.onPointerUp$.subscribeEvent(g=>{s=!1,d=requestAnimationFrame(u)}),t.onPointerLeave$.subscribeEvent(()=>{s=!1}),t.onPointerOut$.subscribeEvent(()=>{s=!1}),e.onPointerOut$.subscribeEvent(()=>{s=!1}),e.onPointerCancel$.subscribeEvent(()=>{s=!1})}_updateSceneSize(n){var h;if(n==null)return;const{unitId:o}=this._context,{skeleton:e}=n,t=(h=this._renderManagerService.getRenderById(o))==null?void 0:h.scene;if(e==null||t==null)return;const{rowTotalHeight:i,columnTotalWidth:r,rowHeaderWidthAndMarginLeft:s,columnHeaderHeightAndMarginTop:l}=e,d=this._context.unit.getActiveSheet();if(!d)return;const u=d.getZoomRatio()||1;t==null||t.setScaleValueOnly(u,u),t==null||t.transformByState({width:s+r,height:l+i})}_getSheetObject(){return He(this._context.unit,this._context)}_scrollToSelectionByDirection(n){const o=this._getViewportBounding();if(o==null)return!1;const{startRow:e,startColumn:t,endRow:i,endColumn:r}=o;let s=0,l=0;const{startRow:c,startColumn:d,endRow:u,endColumn:h}=n;c>=e&&(s=u),u<=i&&(s=c),d>=t&&(l=h),h<=r&&(l=d),this._scrollToCell(s,l)}_scrollToSelection(n=!0){const o=this._selectionManagerService.getCurrentLastSelection();if(o==null)return;const{startRow:e,startColumn:t,actualRow:i,actualColumn:r}=o.primary,s=n?i:e,l=n?r:t;this._scrollToCell(s,l)}_getViewportBounding(){var t,i;const n=(t=this._getSheetObject())==null?void 0:t.scene;if(n==null)return;const o=n.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN);if(o==null)return;const e=(i=this._sheetSkeletonManagerService.getCurrentParam())==null?void 0:i.skeleton;if(e!=null)return e.getRangeByViewport(o.calcViewportInfo())}_scrollToCell(n,o){var O,T,P,A;const{rowHeightAccumulation:e,columnWidthAccumulation:t}=(T=(O=this._sheetSkeletonManagerService.getCurrentParam())==null?void 0:O.skeleton)!=null?T:{};if(e==null||t==null)return!1;const i=(P=this._getSheetObject())==null?void 0:P.scene;if(i==null)return!1;const r=i.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN);if(r==null||((A=this._sheetSkeletonManagerService.getCurrentParam())==null?void 0:A.skeleton)==null)return!1;const l=this._context.unit.getActiveSheet();if(!l)return!1;const{startColumn:c,startRow:d,ySplit:u,xSplit:h}=l.getFreeze(),g=this._getViewportBounding();if(g==null)return!1;const{startRow:S,startColumn:f,endRow:v,endColumn:p}=g;let C,_;if(n>=d&&o>=c-h&&(n<=S&&(C=n),n>=v)){const D=e[n]-r.height;for(let k=S;k<=n;k++)if(e[k]>=D){C=k+1;break}}if(o>=c&&n>=d-u&&(o<=f&&(_=o),o>=p)){const D=t[o]-r.width;for(let k=f;k<=o;k++)if(t[k]>=D){_=k+1;break}}if(C===void 0&&_===void 0)return!1;const{offsetX:w,offsetY:E}=this._scrollManagerService.getCurrentScrollState()||{};return this._commandService.syncExecuteCommand(Le.id,{sheetViewStartRow:C,sheetViewStartColumn:_,offsetX:_===void 0?w:0,offsetY:C===void 0?E:0})}};Os=xv([zn(1,a.Inject(y.SheetSkeletonManagerService)),zn(2,a.ICommandService),zn(3,M.IRenderManagerService),zn(4,a.Inject(m.SheetsSelectionsService)),zn(5,a.Inject(y.SheetScrollManagerService)),zn(6,a.IUniverInstanceService)],Os);var Bv=Object.getOwnPropertyDescriptor,Fv=(n,o,e,t)=>{for(var i=t>1?void 0:t?Bv(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},od=(n,o)=>(e,t)=>o(e,t,n);let Uo=class extends a.Disposable{constructor(n,o,e){super(),this._context=n,this._sheetSkeletonManagerService=o,this._renderManagerService=e,this.disposeWithMe(this._context.unit.sheetDisposed$.subscribe(t=>{this._sheetSkeletonManagerService.disposeSkeleton(t.getSheetId())})),this._sheetSkeletonManagerService.currentSkeleton$.subscribe(t=>{this._updateSceneSize(t)})}_updateSceneSize(n){var u;if(n==null)return;const{unitId:o}=this._context,{skeleton:e}=n,t=(u=this._renderManagerService.getRenderById(o))==null?void 0:u.scene;if(e==null||t==null)return;const{rowTotalHeight:i,columnTotalWidth:r,rowHeaderWidthAndMarginLeft:s,columnHeaderHeightAndMarginTop:l}=e;this._context.unit.getActiveSheet()&&(t==null||t.transformByState({width:s+r,height:l+i}))}};Uo=Fv([od(1,a.Inject(y.SheetSkeletonManagerService)),od(2,M.IRenderManagerService)],Uo);var zv=Object.getOwnPropertyDescriptor,Xv=(n,o,e,t)=>{for(var i=t>1?void 0:t?zv(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},rd=(n,o)=>(e,t)=>o(e,t,n);a.createIdentifier("sheets-ui.services.auto-height");function Yv(n,o){const e=[],t=[...n];let i=o;for(;t.length>0;){const r=t.shift();if(!r)break;const s=r.endRow-r.startRow+1;if(s>i){e.push({...r,startRow:r.startRow,endRow:r.startRow+i-1}),t.unshift({...r,startRow:r.startRow+i});break}else e.push(r),i-=s}return{result:e,lasts:t}}const jv=500;let Bo=class extends a.Disposable{constructor(o,e,t){super();R(this,"_autoHeightTasks",[]);R(this,"_calculateLoopId",null);this._context=o,this._sheetSkeletonManagerService=e,this._commandService=t,this._initMarkDirty()}_initMarkDirty(){this.disposeWithMe(this._commandService.onCommandExecuted(o=>{if(o.id===m.MarkDirtyRowAutoHeightMutation.id){const e=o.params,{unitId:t,subUnitId:i,ranges:r,id:s}=e;if(t!==this._context.unitId)return;this.startAutoHeightTask({ranges:r,sheetId:i,id:s,maxTime:1e4})}if(o.id===m.CancelMarkDirtyRowAutoHeightMutation.id){const e=o.params,{unitId:t,id:i}=e;if(t!==this._context.unitId)return;this.cancelTask(i)}}))}_loopTask(o){const e=o.skeleton;let t=[],i=[];if(o.maxTime&&o.maxTime+o.startTime<=Date.now())t=o.ranges;else{const l=Yv(o.ranges,jv);t=l.result,i=l.lasts}const s=e.calculateAutoHeightInRange(t).filter(l=>{const{row:c,autoHeight:d}=l;return!(!d||e.getRowHeight(c)===d)});if(i.length&&(o.ranges=i,this._autoHeightTasks.unshift(o)),s.length){const l={unitId:this._context.unitId,subUnitId:o.sheetId,rowsAutoHeightInfo:s};this._commandService.syncExecuteCommand(m.SetWorksheetRowAutoHeightMutation.id,l)}}_calculateLoop(o){for(;this._autoHeightTasks.length&&!(o.timeRemaining()<=0);){const e=this._autoHeightTasks.shift();if(!e){this._calculateLoopId=null;return}this._loopTask(e)}this._calculateLoopId=requestIdleCallback(e=>{this._calculateLoop(e)})}_initialCalculateLoop(){this._calculateLoopId===null&&(this._calculateLoopId=requestIdleCallback(o=>{this._calculateLoop(o)}))}startAutoHeightTask(o){const e=this._sheetSkeletonManagerService.getSkeleton(o.sheetId);if(!e)return;o.ranges=a.Rectangle.mergeRanges(o.ranges.map(i=>({...i,startColumn:0,endColumn:0})));const t=a.Rectangle.subtractMulti(o.ranges,this._autoHeightTasks.filter(i=>i.sheetId===o.sheetId).map(i=>i.ranges).flat());t.length&&(this._autoHeightTasks.push({...o,startTime:Date.now(),skeleton:e,ranges:t}),this._initialCalculateLoop())}cancelTask(o){const e=this._autoHeightTasks.findIndex(t=>t.id===o);e!==-1&&this._autoHeightTasks.splice(e,1)}};Bo=Xv([rd(1,a.Inject(y.SheetSkeletonManagerService)),rd(2,a.ICommandService)],Bo);function sd(n){const{popup:o}=n,{extraProps:e}=o,{options:t,defaultValue:i,onChange:r}=e,[s,l]=x.useState(i!=null?i:[]);return b.jsx(X.CascaderList,{options:t,value:s,onChange:r})}sd.componentKey="sheets.dropdown.cascader";function ad(n){const{popup:o}=n,{extraProps:e}=o,{defaultValue:t,onChange:i}=e;return b.jsx(X.ColorPicker,{value:t,onChange:i})}ad.componentKey="sheets.dropdown.color";function ld(n){const{popup:o}=n,{extraProps:e}=o,{hideFn:t,patternType:i,defaultValue:r,onChange:s,showTime:l}=e,[c,d]=x.useState(r),u=x.useMemo(()=>i!=="time"?a.dayjs():a.dayjs("1900-01-01 00:00:00"),[]),h=c&&c.isValid()?c:u,g=I.useDependency(a.LocaleService),S=async()=>{if(!h)return;await(s==null?void 0:s(h))&&t()};return b.jsxs("div",{className:"univer-rounded univer-bg-white univer-p-2 univer-shadow-lg dark:!univer-bg-black",children:[i==="time"?b.jsx(X.TimeInput,{value:h.toDate(),onValueChange:f=>{d(a.dayjs(f))}}):b.jsx(X.Calendar,{value:h.toDate(),showTime:l!=null?l:i==="datetime",onValueChange:f=>{d(a.dayjs(f))}}),b.jsx("footer",{className:X.clsx("univer-mt-2 univer-flex univer-justify-end univer-pt-2",X.borderTopClassName),children:b.jsx(X.Button,{size:"small",variant:"primary",onClick:S,disabled:!h||!h.isValid(),children:g.t("dataValidation.alert.ok")})})]})}ld.componentKey="sheets.dropdown.date";function Zv(n){return n.filter(Boolean).join(",")}function Gv(n){return n.split(",").filter(Boolean)}function Kv(n){const{value:o,onChange:e,multiple:t,options:i,title:r,onEdit:s,filter:l,style:c,location:d,showEdit:u}=n,h=I.useDependency(a.LocaleService),g=l==null?void 0:l.toLowerCase(),{row:S,col:f,unitId:v,subUnitId:p}=d,C=i.filter(E=>g?E.label.toLowerCase().includes(g):!0),_=I.useDependency(m.SheetPermissionCheckController),w=x.useMemo(()=>_.permissionCheckWithRanges({workbookTypes:[m.WorkbookEditablePermission],rangeTypes:[m.RangeProtectionPermissionEditPoint],worksheetTypes:[m.WorksheetEditPermission]},[{startColumn:f,startRow:S,endColumn:f,endRow:S}],v,p),[_,f,S,v,p]);return b.jsxs("div",{"data-u-comp":"sheets-dropdown-list",className:X.clsx("univer-box-border univer-rounded-lg univer-bg-white univer-py-1 univer-text-gray-900 univer-shadow dark:!univer-bg-black dark:!univer-text-white",X.borderClassName),style:c,children:[b.jsx("div",{className:"univer-px-3.5 univer-py-1 univer-pt-2 univer-text-xs",children:r}),b.jsx("div",{className:X.clsx("univer-flex univer-max-h-52 univer-flex-col univer-gap-1 univer-overflow-y-auto univer-px-2 univer-py-1",X.scrollbarClassName),children:C.map((E,O)=>{const T=o.indexOf(E.value)>-1,P=()=>{let k;T?k=new Set(o.filter(V=>V!==E.value)):k=new Set(t?[...o,E.value]:[E.value]);const H=[];i.forEach(V=>{k.has(V.value)&&H.push(V.value)}),e(H)},A=E.label.toLocaleLowerCase().indexOf(g),D=new a.ColorKit(E.color).isDark();return b.jsxs("div",{className:"univer-flex univer-cursor-pointer univer-flex-row univer-items-center univer-justify-between univer-rounded-md univer-px-1.5 univer-py-1 hover:univer-bg-gray-50 dark:hover:!univer-bg-gray-700",onClick:P,children:[b.jsx("div",{className:X.clsx("univer-inline-flex univer-h-4 univer-w-fit univer-items-center univer-truncate univer-rounded-full univer-px-1.5 univer-text-xs",{"univer-text-gray-900":!D,"univer-text-white":D}),style:{background:E.color},children:g&&E.label.toLowerCase().includes(g)?b.jsxs(b.Fragment,{children:[b.jsx("span",{children:E.label.substring(0,A)}),b.jsx("span",{className:"univer-font-semibold",children:E.label.substring(A,A+g.length)}),b.jsx("span",{children:E.label.substring(A+g.length)})]}):E.label}),b.jsx("div",{className:"univer-ml-3 univer-h-4 univer-w-4 univer-flex-shrink-0 univer-flex-grow-0 univer-text-base univer-text-primary-500",children:T&&b.jsx(zt,{className:"univer-text-primary-600"})})]},O)})},l),u&&w&&b.jsx("div",{className:X.clsx("univer-box-border univer-px-2 univer-pt-1",X.borderTopClassName),children:b.jsx("a",{className:"univer-block univer-cursor-pointer univer-rounded univer-px-1.5 univer-py-1 univer-text-xs hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-800",onClick:s,children:h.t("dataValidation.list.edit")})})]})}function cd(n){var O,T;const{popup:{extraProps:o,anchorRect:e}}=n,{location:t,hideFn:i,onChange:r,onEdit:s,options:l,defaultValue:c,multiple:d,showEdit:u}=o,{worksheet:h}=t,[g,S]=x.useState(""),f=I.useDependency(a.ICommandService),v=I.useDependency(a.LocaleService),[p,C]=x.useState(c),_=I.useDependency(me),w=I.useDependency(a.IUniverInstanceService),E=((O=e==null?void 0:e.right)!=null?O:0)-((T=e==null?void 0:e.left)!=null?T:0);return x.useEffect(()=>{const P=f.onCommandExecuted(A=>{var D,k;if(A.id===Ce.RichTextEditingMutation.id){const H=A.params,{unitId:V}=H,L=w.getUnit(V,a.UniverInstanceType.UNIVER_DOC);if(!L||!_.isVisible().visible)return;const W=a.BuildTextUtils.transform.getPlainText((k=(D=L.getSnapshot().body)==null?void 0:D.dataStream)!=null?k:"");S(W)}});return()=>{P.dispose()}},[f,_,w]),h?b.jsx(Kv,{style:{minWidth:E,maxWidth:Math.max(E,200)},title:d?v.t("dataValidation.listMultiple.dropdown"):v.t("dataValidation.list.dropdown"),value:Gv(p!=null?p:""),multiple:d,onChange:async P=>{const A=Zv(P);C(A),await(r==null?void 0:r(P))!==!1&&i()},options:l,onEdit:s,filter:g,location:t,showEdit:u}):null}cd.componentKey="sheets.dropdown.list";const dd={datepicker:ld,list:cd,color:ad,cascader:sd};var qv=Object.getOwnPropertyDescriptor,Qv=(n,o,e,t)=>{for(var i=t>1?void 0:t?qv(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Fo=(n,o)=>(e,t)=>o(e,t,n);const As=a.createIdentifier("ICellDropdownManagerService");y.SheetCellDropdownManagerService=class extends a.Disposable{constructor(o,e,t,i){super(),this._canvasPopupManagerService=o,this._zenZoneService=e,this._renderManagerService=t,this._componentManager=i,Object.values(dd).forEach(r=>{this.disposeWithMe(this._componentManager.register(r.componentKey,r))})}showDropdown(o){const{location:e,onHide:t,closeOnOutSide:i=!0}=o,{row:r,col:s,unitId:l,subUnitId:c}=e;if(this._zenZoneService.visible)throw new Error("[SheetCellDropdownManagerService]: cannot show dropdown when zen mode is visible");const d=dd[o.type],u=this._renderManagerService.getRenderById(a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY),h=new a.DisposableCollection,g=this._canvasPopupManagerService.attachPopupToCell(r,s,{componentKey:d.componentKey,onClickOutside:()=>{i&&h.dispose()},offset:[0,3],excludeOutside:[u==null?void 0:u.engine.getCanvasElement()].filter(Boolean),extraProps:{...o,...o.props,hideFn:()=>{h.dispose()}}},l,c);if(!g)throw new Error("[SheetCellDropdownManagerService]: cannot show dropdown");return h.add(g),h.add({dispose:()=>{t==null||t()}}),h}},y.SheetCellDropdownManagerService=Qv([Fo(0,a.Inject(y.SheetCanvasPopManagerService)),Fo(1,I.IZenZoneService),Fo(2,M.IRenderManagerService),Fo(3,a.Inject(I.ComponentManager))],y.SheetCellDropdownManagerService);const Jv=a.createInterceptorKey("PRINTING_RANGE"),$v=a.createInterceptorKey("PRINTING_COMPONENT_COLLECT"),ep=a.createInterceptorKey("PRINTING_DOM_COLLECT");class Ds extends a.Disposable{constructor(){super();R(this,"_printComponentMap",new Map);R(this,"interceptor",new a.InterceptorManager({PRINTING_RANGE:Jv,PRINTING_COMPONENT_COLLECT:$v,PRINTING_DOM_COLLECT:ep}));this.disposeWithMe(this.interceptor.intercept(this.interceptor.getInterceptPoints().PRINTING_RANGE,{priority:-1,handler:e=>e})),this.disposeWithMe(this.interceptor.intercept(this.interceptor.getInterceptPoints().PRINTING_COMPONENT_COLLECT,{priority:-1,handler:e=>e})),this.disposeWithMe(this.interceptor.intercept(this.interceptor.getInterceptPoints().PRINTING_DOM_COLLECT,{priority:-1,handler:e=>e}))}registerPrintComponent(e,t){this._printComponentMap.set(e,t)}getPrintComponent(e){return this._printComponentMap.get(e)}}class tp extends Kn{constructor(e,t,i,r){super(e,t,i,r);R(this,"_fillControlTopLeft");R(this,"_fillControlBottomRight");R(this,"_rangeType",a.RANGE_TYPE.NORMAL);this._scene=e,this._zIndex=t,this._themeService=i,this._rangeType=(r==null?void 0:r.rangeType)||a.RANGE_TYPE.NORMAL,this.initControlPoints()}initControlPoints(){const e=this.currentStyle,t=e.expandCornerSize||0,i=(e.expandCornerSize||0)/4,r=e.autofillStrokeWidth||0,s=e.stroke,l=e.autofillStroke,c=this.zIndex;this._fillControlTopLeft=new M.Rect(qo.fillTopLeft+c,{zIndex:c+2,width:t,height:t,radius:t/2,visualWidth:i,visualHeight:i,strokeWidth:r}),this._fillControlBottomRight=new M.Rect(qo.fillBottomRight+c,{zIndex:c+2,width:t,height:t,radius:t/2,visualHeight:i,visualWidth:i,strokeWidth:r});const d={fill:s,stroke:l,strokeScaleEnabled:!1};this._fillControlTopLeft.setProps({...d}),this._fillControlBottomRight.setProps({...d});const u=[this._fillControlTopLeft,this._fillControlBottomRight];switch(this._rangeType){case a.RANGE_TYPE.ROW:this.rowHeaderGroup.addObjects(...u);break;case a.RANGE_TYPE.COLUMN:this.columnHeaderGroup.addObjects(...u);break;case a.RANGE_TYPE.NORMAL:this.selectionShapeGroup.addObjects(...u)}this.getScene().addObjects(u,Bi)}get fillControlTopLeft(){return this._fillControlTopLeft}set fillControlTopLeft(e){this._fillControlTopLeft=e}get fillControlBottomRight(){return this._fillControlBottomRight}set fillControlBottomRight(e){this._fillControlBottomRight=e}get rangeType(){return this._rangeType}set rangeType(e){this._rangeType=e}dispose(){var e,t;(e=this._fillControlBottomRight)==null||e.dispose(),(t=this._fillControlTopLeft)==null||t.dispose(),super.dispose()}_updateLayoutOfSelectionControl(e){var r,s;super._updateLayoutOfSelectionControl(e);const t=this.currentStyle;e==null&&(e=t);const{widgets:i=t.widgets}=e;if(this.currentStyle=e,this._enableAutoFill===!0&&!super._hasWidgets(i)){const{viewportScrollX:l,viewportScrollY:c}=this.getViewportMainScrollInfo(),{endX:d,endY:u}=this.selectionModel;this.transformControlPoint(l,c,d,u),this.fillControlTopLeft.show(),this.fillControlBottomRight.show()}else(r=this.fillControlTopLeft)==null||r.hide(),(s=this.fillControlBottomRight)==null||s.hide()}getViewportMainScrollInfo(){const e=this.getScene().getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN);return{viewportScrollX:(e==null?void 0:e.viewportScrollX)||0,viewportScrollY:(e==null?void 0:e.viewportScrollY)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0}}transformControlPoint(e=0,t=0,i=0,r=0){const s=this.currentStyle,l=this.selectionModel.rangeType,c=s.expandCornerSize,{startX:d,startY:u,endX:h,endY:g}=this.selectionModel,S=this.getViewportMainScrollInfo(),f=S.width,v=S.height;switch(l){case a.RANGE_TYPE.NORMAL:this.fillControlTopLeft.transformByState({left:-c/2,top:-c/2}),this.fillControlBottomRight.transformByState({left:h-d-c/2,top:g-u-c/2});break;case a.RANGE_TYPE.ROW:{const p=Math.min(f/2+e,i),C=-c/2+p;this.fillControlTopLeft.transformByState({left:C,top:-c/2}),this.fillControlBottomRight.transformByState({left:C,top:-c/2+g-u})}break;case a.RANGE_TYPE.COLUMN:{const p=Math.min(+v/2+t,r),C=-c/2+p;this.fillControlTopLeft.transformByState({left:-c/2,top:C}),this.fillControlBottomRight.transformByState({left:-c/2+h-d,top:C})}break;default:console.error("unknown range type")}}}var np=Object.getOwnPropertyDescriptor,ip=(n,o,e,t)=>{for(var i=t>1?void 0:t?np(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},rt=(n,o)=>(e,t)=>o(e,t,n);let Ns=class extends Qo{constructor(o,e,t,i,r,s,l,c,d,u){super(e,t,i,s,d);R(this,"_workbookSelections");R(this,"_renderDisposable",null);R(this,"_expandingSelection",!1);R(this,"_selectionControls",[]);R(this,"expandingControlMode","bottom-right");this._context=o,this._logService=l,this._commandService=c,this._contextService=d,this._scrollManagerService=u,this._workbookSelections=r.getWorkbookSelections(this._context.unitId),this._init()}_init(){const o=this._getSheetObject();this._initEventListeners(o),this._initSelectionChangeListener(),this._initSkeletonChangeListener(),this._initUserActionSyncListener(),this._updateControlPointWhenScrolling()}_initSkeletonChangeListener(){this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(o=>{if(o==null){this._logService.error("[SelectionRenderService]: should not receive null!");return}const e=this._context.unitId,{sheetId:t,skeleton:i}=o,{scene:r}=this._context,s=r.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN);this._changeRuntime(i,r,s),this._workbookSelections.getCurrentLastSelection()||this._commandService.syncExecuteCommand(m.SetSelectionsOperation.id,{unitId:e,subUnitId:t,selections:[Fi(i)]})}))}_initSelectionChangeListener(){}_initEventListeners(o){const{spreadsheetRowHeader:e,spreadsheetColumnHeader:t,spreadsheet:i,spreadsheetLeftTopPlaceholder:r}=o,{scene:s}=this._context;this._initSpreadsheetEvent(o),this.disposeWithMe(e==null?void 0:e.onPointerUp$.subscribeEvent((l,c)=>{if(this._normalSelectionDisabled())return;const d=this._sheetSkeletonManagerService.getCurrentParam().skeleton,{row:u}=Ye(l.offsetX,l.offsetY,s,d);Fl(this._workbookSelections.getCurrentSelections(),u)||(this.createNewSelection(l,(i.zIndex||1)+1,a.RANGE_TYPE.ROW,this._getActiveViewport(l)),this._selectionMoveEnd$.next(this.getSelectionDataWithStyle()))})),this.disposeWithMe(t==null?void 0:t.onPointerUp$.subscribeEvent((l,c)=>{if(this._normalSelectionDisabled())return;const d=this._sheetSkeletonManagerService.getCurrentParam().skeleton,{column:u}=Ye(l.offsetX,l.offsetY,s,d);zl(this._workbookSelections.getCurrentSelections(),u)||(this.createNewSelection(l,(i.zIndex||1)+1,a.RANGE_TYPE.COLUMN,this._getActiveViewport(l)),this._selectionMoveEnd$.next(this.getSelectionDataWithStyle()))})),this.disposeWithMe(r==null?void 0:r.onPointerUp$.subscribeEvent((l,c)=>{if(this._normalSelectionDisabled())return;this._reset();const d=this._sheetSkeletonManagerService.getCurrentParam().skeleton,u=Jo(d);this._addSelectionControlByModelData(u),this.refreshSelectionMoveStart(),c.stopPropagation(),this._selectionMoveEnd$.next(this.getSelectionDataWithStyle())}))}_initSpreadsheetEvent(o){const{spreadsheet:e}=o;let t;const i=500,r={x:0,y:0},s=()=>{clearTimeout(t)},l=(u,h)=>{this.createNewSelection(u,e.zIndex+1,a.RANGE_TYPE.NORMAL,this._getActiveViewport(u)),h&&this._selectionMoveEnd$.next(this.getSelectionDataWithStyle())};e==null||e.onPointerMove$.subscribeEvent((u,h)=>{(Math.abs(u.offsetX-r.x)>10||Math.abs(u.offsetY-r.y)>10)&&s()});const c=e==null?void 0:e.onPointerDown$.subscribeEvent((u,h)=>{r.x=u.offsetX,r.y=u.offsetY,t=setTimeout(()=>{l(u,!0)},i),h.stopPropagation()}),d=e==null?void 0:e.onPointerUp$.subscribeEvent((u,h)=>{if(this._normalSelectionDisabled())return;clearTimeout(t);const g=10;Math.abs(u.offsetX-r.x)>g||Math.abs(u.offsetY-r.y)>g||(l(u,!1),h.stopPropagation())});this.disposeWithMe(a.toDisposable(c)),this.disposeWithMe(a.toDisposable(d))}_initUserActionSyncListener(){this.disposeWithMe(this.selectionMoveStart$.subscribe(o=>this._updateSelections(o,m.SelectionMoveType.MOVE_START))),this.disposeWithMe(this.selectionMoving$.subscribe(o=>this._updateSelections(o,m.SelectionMoveType.MOVING))),this.disposeWithMe(this._contextService.subscribeContextValue$(m.REF_SELECTIONS_ENABLED).pipe(N.startWith(!1),N.distinctUntilChanged()).subscribe(o=>{var e;o?((e=this._renderDisposable)==null||e.dispose(),this._renderDisposable=null,this._reset()):this._renderDisposable=a.toDisposable(this.selectionMoveEnd$.subscribe(t=>this._updateSelections(t,m.SelectionMoveType.MOVE_END)))}))}_updateSelections(o,e){const t=this._context.unit,i=t.getUnitId(),r=t.getActiveSheet().getSheetId();o.length!==0&&this._commandService.executeCommand(m.SetSelectionsOperation.id,{unitId:i,subUnitId:r,type:e,selections:o.map(s=>m.convertSelectionDataToRange(s))})}createNewSelection(o,e=0,t=a.RANGE_TYPE.NORMAL,i){this._rangeType=t;const r=this._skeleton,s=this._scene;if(!s||!r)return;i&&(this._activeViewport=i);const{offsetX:l,offsetY:c}=o,d=s.getCoordRelativeToViewport(M.Vector2.FromArray([l,c])),{x:u,y:h}=d;this._startViewportPosX=u,this._startViewportPosY=h;const g=s.getScrollXYInfoByViewport(d),{scaleX:S,scaleY:f}=s.getAncestorScale(),v=this._skeleton.getCellByOffset(u,h,S,f,g);if(!v)return;switch(t){case a.RANGE_TYPE.NORMAL:break;case a.RANGE_TYPE.ROW:v.startColumn=0,v.endColumn=this._skeleton.getColumnCount()-1;break;case a.RANGE_TYPE.COLUMN:v.startRow=0,v.endRow=this._skeleton.getRowCount()-1;break;case a.RANGE_TYPE.ALL:v.startRow=0,v.startColumn=0,v.endRow=this._skeleton.getRowCount()-1,v.endColumn=this._skeleton.getColumnCount()-1}const p={range:v,primary:v,style:null};p.range.rangeType=t;const C=Re(p,this._skeleton);this._startRangeWhenPointerDown={...C.rangeWithCoord};let _=this.getActiveSelectionControl();const w={...C.rangeWithCoord};for(const E of this.getSelectionControls())if(E.model.isEqual(w)){_=E;break}(_==null?void 0:_.model.rangeType)!==t?(this._clearAllSelectionControls(),_=this.newSelectionControl(s,r,p)):_.updateRangeBySelectionWithCoord(C),this._selectionMoveStart$.next(this.getSelectionDataWithStyle()),this._clearUpdatingListeners(),this._expandingSelection=!1}newSelectionControl(o,e,t){const i=this.getSelectionControls(),{rowHeaderWidth:r,columnHeaderHeight:s}=e,l=t.range.rangeType,c=new tp(o,i.length,this._themeService,{highlightHeader:this._highlightHeader,rowHeaderWidth:r,columnHeaderHeight:s,rangeType:l}),d=Re(t,e);c.updateRangeBySelectionWithCoord(d),this._selectionControls.push(c);const{expandingModeForTopLeft:u,expandingModeForBottomRight:h}=(()=>{switch(l){case a.RANGE_TYPE.NORMAL:return{expandingModeForTopLeft:"top-left",expandingModeForBottomRight:"bottom-right"};case a.RANGE_TYPE.ROW:return{expandingModeForTopLeft:"top",expandingModeForBottomRight:"bottom"};case a.RANGE_TYPE.COLUMN:return{expandingModeForTopLeft:"left",expandingModeForBottomRight:"right"};case a.RANGE_TYPE.ALL:return{expandingModeForTopLeft:"top-left",expandingModeForBottomRight:"bottom-right"};default:return{expandingModeForTopLeft:"top-left",expandingModeForBottomRight:"bottom-right"}}})();return c.fillControlTopLeft.onPointerDown$.subscribeEvent(g=>{this._expandingSelection=!0,this.expandingControlMode=u,this._selectionMoveStart$.next(this.getSelectionDataWithStyle()),this._fillControlPointerDownHandler(g,l,this._activeViewport)}),c.fillControlBottomRight.onPointerDown$.subscribeEvent(g=>{this._expandingSelection=!0,this.expandingControlMode=h,this._selectionMoveStart$.next(this.getSelectionDataWithStyle()),this._fillControlPointerDownHandler(g,l,this._activeViewport)}),(l===a.RANGE_TYPE.ROW||l===a.RANGE_TYPE.COLUMN)&&!o.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN),c}_getActiveViewport(o){const e=this._getSheetObject();return e==null?void 0:e.scene.getActiveViewportByCoord(M.Vector2.FromArray([o.offsetX,o.offsetY]))}_getSheetObject(){return He(this._context.unit,this._context)}_normalSelectionDisabled(){return this._contextService.getContextValue(m.REF_SELECTIONS_ENABLED)}getSelectionControls(){return this._selectionControls}_fillControlPointerDownHandler(o,e=a.RANGE_TYPE.NORMAL,t,i=M.ScrollTimerType.ALL){var h,g,S;const r=this._skeleton,s=this._scene;if(!s||!r)return;t&&(this._activeViewport=t);const l=s.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN),c=this.getActiveSelectionControl();if(!c)return;this._changeCurrCellWhenControlPointerDown(),this._selectionMoveStart$.next(this.getSelectionDataWithStyle()),this._clearUpdatingListeners(),this._addEndingListeners(),this._scrollTimer=M.ScrollTimer.create(this._scene,i),this._scrollTimer.startScroll((h=l==null?void 0:l.left)!=null?h:0,(g=l==null?void 0:l.top)!=null?g:0,l),(S=s.getTransformer())==null||S.clearSelectedObjects();const d=s.getCoordRelativeToViewport(M.Vector2.FromArray([o.offsetX,o.offsetY]));this._setupPointerMoveListener(l,c,e,i,d.x,d.y);const u=this._shortcutService.forceEscape();this._scenePointerUpSub=s.onPointerUp$.subscribeEvent(f=>{this.endSelection(),this._expandingSelection=!1,this.expandingControlMode="bottom-right",this._selectionMoveEnd$.next(this.getSelectionDataWithStyle()),u.dispose()})}_changeCurrCellWhenControlPointerDown(){const o=this.getActiveSelectionControl(),e=this._skeleton;let t;const{startRow:i,startColumn:r,endRow:s,endColumn:l}=o.model;switch(this.expandingControlMode){case"top-left":t=e.getCellWithCoordByIndex(s,l);break;case"bottom-right":t=e.getCellWithCoordByIndex(i,r);break;case"left":t=e.getCellWithCoordByIndex(i,l),t.isMerged=!1,t.isMergedMainCell=!1;break;case"right":t=e.getCellWithCoordByIndex(i,r),t.isMerged=!1,t.isMergedMainCell=!1;break;case"top":t=e.getCellWithCoordByIndex(s,r),t.isMerged=!1,t.isMergedMainCell=!1;break;case"bottom":t=e.getCellWithCoordByIndex(i,r),t.isMerged=!1,t.isMergedMainCell=!1;break;default:t=e.getCellWithCoordByIndex(i,r)}return o.updateCurrCell(t),t}_movingHandler(o,e,t,i){var A,D,k,H,V,L,W,B,U,z,F,j,Y;this._rangeType=i;const r=this._skeleton,s=this._scene,l={startRow:t.model.startRow,endRow:t.model.endRow,startColumn:t.model.startColumn,endColumn:t.model.endColumn},c=s.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN),d=(A=this._getViewportByCell(l.endRow,l.endColumn))!=null?A:c,u=s.getScrollXYInfoByViewport(M.Vector2.FromArray([this._startViewportPosX,this._startViewportPosY]),d),{scaleX:h,scaleY:g}=s.getAncestorScale();i===a.RANGE_TYPE.ROW?o=Number.POSITIVE_INFINITY:i===a.RANGE_TYPE.COLUMN&&(e=Number.POSITIVE_INFINITY);const S=this._getSelectionWithCoordByOffset(o,e,h,g,u);if(!S)return!1;const{rangeWithCoord:f}=S,v=t.model.currentCell,p=(D=v==null?void 0:v.mergeInfo.startRow)!=null?D:-1,C=(k=v==null?void 0:v.mergeInfo.endRow)!=null?k:-1,_=(H=v==null?void 0:v.mergeInfo.startColumn)!=null?H:-1,w=(V=v==null?void 0:v.mergeInfo.endColumn)!=null?V:-1;let E={startRow:Math.min(f.startRow,p),startColumn:Math.min(f.startColumn,_),endRow:Math.max(f.endRow,C),endColumn:Math.max(f.endColumn,w)};if(i===a.RANGE_TYPE.NORMAL?E=r.expandRangeByMerge(E):i===a.RANGE_TYPE.COLUMN?E={startRow:Math.min(f.startRow,(L=v==null?void 0:v.actualRow)!=null?L:-1),startColumn:Math.min(f.startColumn,(W=v==null?void 0:v.actualColumn)!=null?W:-1),endRow:Math.max(f.endRow,(B=v==null?void 0:v.actualRow)!=null?B:-1),endColumn:Math.max(f.endColumn,(U=v==null?void 0:v.actualColumn)!=null?U:-1)}:i===a.RANGE_TYPE.ROW&&(E={startRow:Math.min(f.startRow,(z=v==null?void 0:v.actualRow)!=null?z:-1),startColumn:Math.min(f.startColumn,(F=v==null?void 0:v.actualColumn)!=null?F:-1),endRow:Math.max(f.endRow,(j=v==null?void 0:v.actualRow)!=null?j:-1),endColumn:Math.max(f.endColumn,(Y=v==null?void 0:v.actualColumn)!=null?Y:-1)}),!E)return!1;const T=Re({range:E,style:null,primary:null},r);(l.startRow!==E.startRow||l.startColumn!==E.startColumn||l.endRow!==E.endRow||l.endColumn!==E.endColumn)&&t&&(t.updateRangeBySelectionWithCoord(T),this._selectionMoving$.next(this.getSelectionDataWithStyle()))}_updateControlPointWhenScrolling(){const{scene:o}=this._context;if(!o.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN))return;const t=this._scrollManagerService.validViewportScrollInfo$.subscribe(i=>{var g;if(i==null)return;const{viewportScrollX:r,viewportScrollY:s}=i,l=this.getActiveSelectionControl();if(l==null)return;const c=(g=this._sheetSkeletonManagerService.getCurrentParam())==null?void 0:g.skeleton,d=c==null?void 0:c.rowTotalHeight,u=c==null?void 0:c.columnTotalWidth,h=l.rangeType;h===a.RANGE_TYPE.COLUMN?l.transformControlPoint(0,s,u,d):h===a.RANGE_TYPE.ROW&&l.transformControlPoint(r,0,u,d)});this.disposeWithMe(a.toDisposable(t))}};Ns=ip([rt(1,a.Inject(a.Injector)),rt(2,a.Inject(a.ThemeService)),rt(3,I.IShortcutService),rt(4,a.Inject(m.SheetsSelectionsService)),rt(5,a.Inject(y.SheetSkeletonManagerService)),rt(6,a.ILogService),rt(7,a.ICommandService),rt(8,a.IContextService),rt(9,a.Inject(y.SheetScrollManagerService))],Ns);var op=Object.defineProperty,rp=Object.getOwnPropertyDescriptor,sp=(n,o,e)=>o in n?op(n,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[o]=e,ap=(n,o,e,t)=>{for(var i=t>1?void 0:t?rp(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Wi=(n,o)=>(e,t)=>o(e,t,n),ud=(n,o,e)=>sp(n,typeof o!="symbol"?o+"":o,e);y.UniverSheetsMobileUIPlugin=class extends a.Plugin{constructor(o=uo,e,t,i,r,s){super(),this._config=o,this._injector=e,this._renderManagerService=t,this._configService=i,this._univerInstanceService=r,this._componentManager=s;const{menu:l,...c}=a.merge({},uo,this._config);if(c.protectedRangeUserSelector){const{component:d,framework:u}=c.protectedRangeUserSelector;this.disposeWithMe(this._componentManager.register(ri,d,{framework:u}))}l&&this._configService.setConfig("menu",l,{merge:!0}),this._configService.setConfig(Te,{...c})}onStarting(){a.registerDependencies(this._injector,a.mergeOverrideWithDependencies([[vn],[me,{useClass:y.EditorBridgeService}],[ke,{useClass:y.SheetClipboardService}],[Ut,{useClass:Ea}],[Fe,{useClass:no}],[En,{useClass:_r}],[yn,{useClass:Za}],[m.IRefSelectionsService,{useClass:m.RefSelectionsService}],[ct,{useClass:y.AutoFillService}],[Ds],[Ei,{useClass:Or}],[yt,{useClass:y.MarkSelectionService}],[y.HoverManagerService],[y.DragManagerService],[y.SheetCanvasPopManagerService],[y.CellPopupManagerService],[y.CellAlertManagerService],[Sr],[As,{useClass:y.SheetCellDropdownManagerService}],[y.SheetCellEditorResizeService],[kn],[y.AutoHeightController],[y.AutoWidthController],[y.FormulaEditorController],[y.SheetsRenderService],[Ro],[y.StatusBarController],[y.AutoFillController],[xn],[Wn],[Ln],[Vn],[y.EditingRenderController],[Ht],[Un],[gt],[Bn],[y.SheetPermissionCheckUIController],[Fn]],this._config.override))}onReady(){this._config.disableAutoFocus||this._initAutoFocus(),a.registerDependencies(this._injector,[[Kt]]),this._registerRenderBasics(),a.touchDependencies(this._injector,[[Ro],[y.SheetsRenderService],[kn],[y.SheetPermissionCheckUIController],[Un]])}onRendered(){this._registerRenderModules(),a.touchDependencies(this._injector,[[Fn],[Ht],[Kt],[y.FormulaEditorController],[Wn],[y.StatusBarController],[y.AutoHeightController],[y.AutoWidthController],[Ln],[Vn],[y.EditingRenderController]])}onSteady(){a.touchDependencies(this._injector,[[xn],[y.AutoFillController],[Bn]])}_registerRenderBasics(){[[y.SheetSkeletonManagerService],[Uo],[y.SheetRenderController],[Ie,{useClass:Ns}],[y.SheetScrollManagerService],[Bo]].forEach(o=>{this.disposeWithMe(this._renderManagerService.registerRenderModule(a.UniverInstanceType.UNIVER_SHEET,o))})}_registerRenderModules(){var i;const o=[[y.HeaderMoveRenderController],[xo],[y.HeaderResizeRenderController],[y.SheetsScrollRenderController],[Os],[y.HeaderFreezeRenderController],[vi],[Ho],[ko],[_o],[bo],[Eo],[yo],[y.HoverRenderController],[y.DragRenderController],[To],[y.CellCustomRenderController],[Mo],[Ti],[Po],[Ao],[Do],[No]],e=this._configService.getConfig(I.UI_PLUGIN_CONFIG_KEY);((i=e==null?void 0:e.contextMenu)!=null?i:!0)&&o.push([Lo]),o.forEach(r=>{this.disposeWithMe(this._renderManagerService.registerRenderModule(a.UniverInstanceType.UNIVER_SHEET,r))})}_initAutoFocus(){const o=this._univerInstanceService;this.disposeWithMe(o.getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET).pipe(de.filter(e=>!!e)).subscribe(e=>o.focusUnit(e.getUnitId())))}},ud(y.UniverSheetsMobileUIPlugin,"pluginName","SHEET_UI_PLUGIN"),ud(y.UniverSheetsMobileUIPlugin,"type",a.UniverInstanceType.UNIVER_SHEET),y.UniverSheetsMobileUIPlugin=ap([a.DependentOn(m.UniverSheetsPlugin,I.UniverMobileUIPlugin),Wi(1,a.Inject(a.Injector)),Wi(2,M.IRenderManagerService),Wi(3,a.IConfigService),Wi(4,a.IUniverInstanceService),Wi(5,a.Inject(I.ComponentManager))],y.UniverSheetsMobileUIPlugin);var lp=Object.getOwnPropertyDescriptor,cp=(n,o,e,t)=>{for(var i=t>1?void 0:t?lp(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},ks=(n,o)=>(e,t)=>o(e,t,n);let Hs=class extends a.Disposable{constructor(n,o,e,t){super(),this._context=n,this._contextMenuService=o,this._selectionManagerService=e,this._selectionRenderService=t,this._init()}_init(){var l,c;const o=((c=(l=this._context)==null?void 0:l.mainComponent)==null?void 0:c.onPointerDown$).subscribeEvent(d=>{if(d.button===2){const u=this._selectionManagerService.getCurrentSelections(),h=u==null?void 0:u[0];if(!h)return;const g=h.range.rangeType,S=this._selectionRenderService.getSkeleton(),v=Re(h,S).rangeWithCoord,p=()=>{if(!v)return!1;const _=d.offsetX,w=d.offsetY;switch(g){case a.RANGE_TYPE.ROW:return v.startY<=w&&v.endY>=w;case a.RANGE_TYPE.COLUMN:return v.startX<=_&&v.endX>=_;default:return v.startX<=_&&v.endX>=_&&v.startY<=w&&v.endY>=w}},C=_=>{this._contextMenuService.triggerContextMenu(d,_)};p()?g===a.RANGE_TYPE.COLUMN?C(I.ContextMenuPosition.COL_HEADER):g===a.RANGE_TYPE.ROW?C(I.ContextMenuPosition.ROW_HEADER):C(I.ContextMenuPosition.MAIN_AREA):C(I.ContextMenuPosition.MAIN_AREA)}});this.disposeWithMe(o);const e=this._context.components.get(he.COLUMN),i=this._context.components.get(he.ROW).onPointerDown$.subscribeEvent(d=>{d.button===2&&this._contextMenuService.triggerContextMenu(d,I.ContextMenuPosition.ROW_HEADER)});this.disposeWithMe(i);const s=e.onPointerDown$.subscribeEvent(d=>{d.button===2&&this._contextMenuService.triggerContextMenu(d,I.ContextMenuPosition.COL_HEADER)});this.disposeWithMe(s)}};Hs=cp([ks(1,I.IContextMenuService),ks(2,a.Inject(m.SheetsSelectionsService)),ks(3,Ie)],Hs);var dp=Object.getOwnPropertyDescriptor,up=(n,o,e,t)=>{for(var i=t>1?void 0:t?dp(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},hd=(n,o)=>(e,t)=>o(e,t,n);function hp(n){return typeof n.setShadowStrategy=="function"}y.SheetPermissionRenderManagerService=class extends a.Disposable{constructor(e,t){super();R(this,"_currentStrategy");R(this,"_strategySubject");this._configService=e,this._renderManagerService=t;const i=this._configService.getConfig(Te);this._currentStrategy=br(i==null?void 0:i.protectedRangeShadow),this._strategySubject=new N.BehaviorSubject(this._currentStrategy),this.disposeWithMe({dispose:()=>{this._strategySubject.complete()}})}_updateAllWorkbooks(e){this._renderManagerService.getRenderAll().forEach(i=>{const r=i.mainComponent;if(!r)return;const s=[{key:bs},{key:ws},{key:Es}];let l=!1;for(const{key:c}of s){const d=r.getExtensionByKey(c);d&&hp(d)&&(d.setShadowStrategy(e),l=!0)}l&&r.makeDirty(!0)})}setProtectedRangeShadowStrategy(e){this._currentStrategy=e,this._strategySubject.next(e),this._updateAllWorkbooks(e)}getProtectedRangeShadowStrategy(){return this._currentStrategy}getProtectedRangeShadowStrategy$(){return this._strategySubject.asObservable()}dispose(){super.dispose(),this._strategySubject.complete()}},y.SheetPermissionRenderManagerService=up([hd(0,a.IConfigService),hd(1,M.IRenderManagerService)],y.SheetPermissionRenderManagerService);var mp=Object.getOwnPropertyDescriptor,gp=(n,o,e,t)=>{for(var i=t>1?void 0:t?mp(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},_t=(n,o)=>(e,t)=>o(e,t,n);y.SheetSelectionRenderService=class extends Qo{constructor(e,t,i,r,s,l,c,d,u){super(t,i,r,l,u);R(this,"_workbookSelections");R(this,"_renderDisposable",null);this._context=e,this._logService=c,this._commandService=d,this._contextService=u,this._workbookSelections=s.getWorkbookSelections(this._context.unitId),this._init()}_init(){const e=this._getSheetObject();this._contextService.setContextValue(m.SELECTIONS_ENABLED,!0),this._initEventListeners(e),this._initSelectionModelChangeListener(),this._initThemeChangeListener(),this._initSkeletonChangeListener(),this._initUserActionSyncListener()}dispose(){var e;super.dispose(),(e=this._renderDisposable)==null||e.dispose()}_initEventListeners(e){const{spreadsheetRowHeader:t,spreadsheetColumnHeader:i,spreadsheet:r,spreadsheetLeftTopPlaceholder:s}=e,{scene:l}=this._context;this.disposeWithMe(r==null?void 0:r.onPointerDown$.subscribeEvent((c,d)=>{this.isSelectionDisabled()||this.inRefSelectionMode()||(this._onPointerDown(c,r.zIndex+1,a.RANGE_TYPE.NORMAL,this._getActiveViewport(c)),c.button!==2&&d.stopPropagation())})),this.disposeWithMe(t==null?void 0:t.onPointerDown$.subscribeEvent((c,d)=>{if(this.isSelectionDisabled()||this.inRefSelectionMode())return;const u=this._sheetSkeletonManagerService.getCurrentParam().skeleton,{row:h}=Ye(c.offsetX,c.offsetY,l,u);Fl(this._workbookSelections.getCurrentSelections(),h)||(this._onPointerDown(c,(r.zIndex||1)+1,a.RANGE_TYPE.ROW,this._getActiveViewport(c),M.ScrollTimerType.Y),c.button!==2&&d.stopPropagation())})),this.disposeWithMe(i==null?void 0:i.onPointerDown$.subscribeEvent((c,d)=>{if(this.isSelectionDisabled()||this.inRefSelectionMode())return;const u=this._sheetSkeletonManagerService.getCurrentParam().skeleton,{column:h}=Ye(c.offsetX,c.offsetY,l,u);zl(this._workbookSelections.getCurrentSelections(),h)||(this._onPointerDown(c,(r.zIndex||1)+1,a.RANGE_TYPE.COLUMN,this._getActiveViewport(c),M.ScrollTimerType.X),c.button!==2&&d.stopPropagation())})),this.disposeWithMe(s==null?void 0:s.onPointerDown$.subscribeEvent((c,d)=>{if(this.isSelectionDisabled()||this.inRefSelectionMode())return;this._reset();const u=this._sheetSkeletonManagerService.getCurrentParam().skeleton,h=Jo(u);this._addSelectionControlByModelData(h),this.refreshSelectionMoveEnd(),c.button!==2&&d.stopPropagation()}))}_initThemeChangeListener(){this.disposeWithMe(this._themeService.currentTheme$.subscribe(()=>{this._initSelectionThemeFromThemeService();const e=this._workbookSelections.getCurrentSelections();e&&this.resetSelectionsByModelData(e)}))}_initSelectionModelChangeListener(){this.disposeWithMe(N.merge(this._workbookSelections.selectionMoveEnd$,this._workbookSelections.selectionSet$).subscribe(e=>{this.resetSelectionsByModelData(e)}))}disableSelection(){this._contextService.setContextValue(m.SELECTIONS_ENABLED,!1)}enableSelection(){this._contextService.setContextValue(m.SELECTIONS_ENABLED,!0)}transparentSelection(){const e=this._themeService.getCurrentTheme(),t=a.set(e,"primary.600","transparent");this.setSelectionTheme(t);const i=this._workbookSelections.getCurrentSelections();for(let r=0;r<i.length;r++){const s=i[r];s.style=qe(this._selectionTheme)}this.resetSelectionsByModelData(i)}showSelection(){const e=this._themeService.getCurrentTheme();this.setSelectionTheme(e);const t=this._workbookSelections.getCurrentSelections();for(let i=0;i<t.length;i++){const r=t[i];r.style&&(r.style=qe(this._selectionTheme))}this.resetSelectionsByModelData(t)}_initUserActionSyncListener(){this.disposeWithMe(this.selectionMoveStart$.subscribe(e=>this._updateSelections(e,m.SelectionMoveType.MOVE_START))),this.disposeWithMe(this.selectionMoving$.subscribe(e=>this._updateSelections(e,m.SelectionMoveType.MOVING))),this.disposeWithMe(this._contextService.subscribeContextValue$(m.REF_SELECTIONS_ENABLED).pipe(N.startWith(!1),N.distinctUntilChanged()).subscribe(e=>{e&&this._reset()})),this.disposeWithMe(this._contextService.subscribeContextValue$(m.SELECTIONS_ENABLED).pipe(N.startWith(!0),N.distinctUntilChanged()).subscribe(e=>{var t;e?this._renderDisposable=a.toDisposable(this.selectionMoveEnd$.subscribe(i=>{this._updateSelections(i,m.SelectionMoveType.MOVE_END)})):((t=this._renderDisposable)==null||t.dispose(),this._renderDisposable=null,this._reset())}))}_updateSelections(e,t){const i=this._context.unit,r=i.getUnitId(),s=i.getActiveSheet().getSheetId();if(e.length===0)return;const l=e.map(c=>m.convertSelectionDataToRange(c));this._commandService.executeCommand(m.SetSelectionsOperation.id,{unitId:r,subUnitId:s,type:t,selections:l})}_initSkeletonChangeListener(){this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(e=>{var u,h;if(e==null){this._logService.error("[SelectionRenderService]: should not receive null!");return}const t=this._context.unitId,{sheetId:i,skeleton:r}=e,{scene:s}=this._context,l=s.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN),c=(h=(u=this._skeleton)==null?void 0:u.worksheet)==null?void 0:h.getSheetId();if(this._changeRuntime(r,s,l),c!==r.worksheet.getSheetId()){const g=this._workbookSelections.getCurrentSelections();this._commandService.syncExecuteCommand(m.SetSelectionsOperation.id,{unitId:t,subUnitId:i,selections:g.length!==0?g:[Fi(r)]})}const d=this._workbookSelections.getCurrentSelections();d!=null&&this.resetSelectionsByModelData(d)}))}_getActiveViewport(e){const t=this._getSheetObject();return t==null?void 0:t.scene.getActiveViewportByCoord(M.Vector2.FromArray([e.offsetX,e.offsetY]))}_getSheetObject(){return He(this._context.unit,this._context)}_onPointerDown(e,t=0,i=a.RANGE_TYPE.NORMAL,r,s=M.ScrollTimerType.ALL){var H,V;this._rangeType=i;const l=this._skeleton,c=this._scene;if(!c||!l)return;r&&(this._activeViewport=r);const{offsetX:d,offsetY:u}=e,h=c.getViewport(M.SHEET_VIEWPORT_KEY.VIEW_MAIN);if(!h)return;const g=c.getCoordRelativeToViewport(M.Vector2.FromArray([d,u])),{x:S,y:f}=g;this._startViewportPosX=S,this._startViewportPosY=f;const v=c.getScrollXYInfoByViewport(g),{scaleX:p,scaleY:C}=c.getAncestorScale(),_=this._skeleton.getCellByOffset(S,f,p,C,v);if(!_)return;switch(i){case a.RANGE_TYPE.NORMAL:break;case a.RANGE_TYPE.ROW:_.startColumn=0,_.endColumn=this._skeleton.getColumnCount()-1,_.startRow=_.actualRow,_.endRow=_.actualRow;break;case a.RANGE_TYPE.COLUMN:_.startRow=0,_.endRow=this._skeleton.getRowCount()-1,_.startColumn=_.actualColumn,_.endColumn=_.actualColumn;break;case a.RANGE_TYPE.ALL:_.startRow=0,_.startColumn=0,_.endRow=this._skeleton.getRowCount()-1,_.endColumn=this._skeleton.getColumnCount()-1}const w={range:_,primary:_,style:null};w.range.rangeType=i;const E=Re(w,this._skeleton);this._startRangeWhenPointerDown={...E.rangeWithCoord};let O=this.getActiveSelectionControl();const T={...E.rangeWithCoord,rangeType:i},P=this.getSelectionControls();for(const L of P)if(e.button===2&&a.Rectangle.contains(L.model,T)){O=L;return}this._checkClearPreviousControls(e);const A=O==null?void 0:O.model.currentCell,D=e.shiftKey&&A,k=this._remainLastEnabled&&!e.ctrlKey&&!e.shiftKey&&!this._skipLastEnabled&&!this._singleSelectionEnabled;D?this._makeSelectionByTwoCells(A,T,l,i,O):k&&O?O.updateRangeBySelectionWithCoord(E):O=this.newSelectionControl(c,l,w);for(let L=0;L<this.getSelectionControls().length-1;L++)this.getSelectionControls()[L].clearHighlight();c.disableObjectsEvent(),this._clearUpdatingListeners(),this._addEndingListeners(),(H=c.getTransformer())==null||H.clearSelectedObjects(),this._setupPointerMoveListener(h,O,i,s,S,f),this._escapeShortcutDisposable=this._shortcutService.forceEscape(),this._selectionMoveStart$.next(this.getSelectionDataWithStyle()),this._scenePointerUpSub=c.onPointerUp$.subscribeEvent(()=>{var L;this._clearUpdatingListeners(),this._selectionMoveEnd$.next(this.getSelectionDataWithStyle()),(L=this._escapeShortcutDisposable)==null||L.dispose(),this._escapeShortcutDisposable=null}),(V=this._scene.getEngine())==null||V.setCapture()}},y.SheetSelectionRenderService=gp([_t(1,a.Inject(a.Injector)),_t(2,a.Inject(a.ThemeService)),_t(3,I.IShortcutService),_t(4,a.Inject(m.SheetsSelectionsService)),_t(5,a.Inject(y.SheetSkeletonManagerService)),_t(6,a.ILogService),_t(7,a.ICommandService),_t(8,a.IContextService)],y.SheetSelectionRenderService);var Sp=Object.defineProperty,fp=Object.getOwnPropertyDescriptor,vp=(n,o,e)=>o in n?Sp(n,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[o]=e,pp=(n,o,e,t)=>{for(var i=t>1?void 0:t?fp(o,e):o,r=n.length-1,s;r>=0;r--)(s=n[r])&&(i=s(i)||i);return i},Li=(n,o)=>(e,t)=>o(e,t,n),md=(n,o,e)=>vp(n,typeof o!="symbol"?o+"":o,e);y.UniverSheetsUIPlugin=class extends a.Plugin{constructor(o=uo,e,t,i,r,s){super(),this._config=o,this._injector=e,this._renderManagerService=t,this._configService=i,this._univerInstanceService=r,this._componentManager=s;const{menu:l,...c}=a.merge({},uo,this._config);if(c.protectedRangeUserSelector){const{component:d,framework:u}=c.protectedRangeUserSelector;this.disposeWithMe(this._componentManager.register(ri,d,{framework:u}))}l&&this._configService.setConfig("menu",l,{merge:!0}),this._configService.setConfig(Te,{...c})}onStarting(){a.registerDependencies(this._injector,a.mergeOverrideWithDependencies([[vn],[me,{useClass:y.EditorBridgeService}],[ke,{useClass:y.SheetClipboardService}],[Ut,{useClass:Ea}],[Fe,{useClass:no}],[En,{useClass:_r}],[yn,{useClass:Za}],[m.IRefSelectionsService,{useClass:m.RefSelectionsService}],[ct,{useClass:y.AutoFillService}],[Ds],[Ei,{useClass:Or}],[yt,{useClass:y.MarkSelectionService}],[y.HoverManagerService],[y.DragManagerService],[y.SheetCanvasPopManagerService],[y.CellPopupManagerService],[y.CellAlertManagerService],[Sr],[As,{useClass:y.SheetCellDropdownManagerService}],[y.SheetCellEditorResizeService],[kn],[y.AutoHeightController],[y.AutoWidthController],[y.FormulaEditorController],[y.SheetsRenderService],[y.SheetUIController],[y.StatusBarController],[y.AutoFillController],[xn],[Wn],[Ln],[Vn],[y.EditingRenderController],[Ht],[Un],[gt],[y.SheetPermissionRenderManagerService],[Bn],[y.SheetPermissionCheckUIController],[Fn]],this._config.override))}onReady(){this._config.disableAutoFocus||this._initAutoFocus(),a.registerDependencies(this._injector,[[Kt]]),this._registerRenderBasics(),a.touchDependencies(this._injector,[[y.SheetUIController],[y.SheetsRenderService],[kn],[y.SheetPermissionCheckUIController],[Un]])}onRendered(){this._registerRenderModules(),a.touchDependencies(this._injector,[[Fn],[Ht],[Kt],[y.FormulaEditorController],[Wn],[y.StatusBarController],[y.AutoHeightController],[y.AutoWidthController],[Ln],[Vn],[y.EditingRenderController]])}onSteady(){a.touchDependencies(this._injector,[[xn],[y.AutoFillController],[Bn]])}_registerRenderBasics(){[[y.SheetSkeletonManagerService],[Uo],[y.SheetRenderController],[Ie,{useClass:y.SheetSelectionRenderService}],[Bo]].forEach(o=>{this.disposeWithMe(this._renderManagerService.registerRenderModule(a.UniverInstanceType.UNIVER_SHEET,o))})}_registerRenderModules(){var i;const o=[[y.HeaderMoveRenderController],[xo],[y.HeaderResizeRenderController],[y.SheetScrollManagerService],[y.SheetsScrollRenderController],[y.HeaderFreezeRenderController],[vi],[Ho],[ko],[_o],[bo],[Eo],[yo],[y.HoverRenderController],[y.DragRenderController],[To],[y.CellCustomRenderController],[Hs],[Mo],[Ti],[Po],[Ao],[Do],[No]],e=this._configService.getConfig(I.UI_PLUGIN_CONFIG_KEY);((i=e==null?void 0:e.contextMenu)!=null?i:!0)&&o.push([Lo]),o.forEach(r=>{this.disposeWithMe(this._renderManagerService.registerRenderModule(a.UniverInstanceType.UNIVER_SHEET,r))})}_initAutoFocus(){const o=this._univerInstanceService;this.disposeWithMe(o.getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET).pipe(de.filter(e=>!!e)).subscribe(e=>o.focusUnit(e.getUnitId())))}},md(y.UniverSheetsUIPlugin,"pluginName","SHEET_UI_PLUGIN"),md(y.UniverSheetsUIPlugin,"type",a.UniverInstanceType.UNIVER_SHEET),y.UniverSheetsUIPlugin=pp([a.DependentOn(m.UniverSheetsPlugin),Li(1,a.Inject(a.Injector)),Li(2,M.IRenderManagerService),Li(3,a.IConfigService),Li(4,a.IUniverInstanceService),Li(5,a.Inject(I.ComponentManager))],y.UniverSheetsUIPlugin);function Cp(n,o,e,t){const{from:i,to:r}=e,{column:s,columnOffset:l,row:c,rowOffset:d}=i,{column:u,columnOffset:h,row:g,rowOffset:S}=r,f=t.ensureSkeleton(o);if(f==null)throw new Error("No current skeleton");const v=Jt(f,{startColumn:s,endColumn:s,startRow:c,endRow:c}),p=Jt(f,{startColumn:u,endColumn:u,startRow:g,endRow:g}),{startX:C,startY:_}=v,{startX:w,startY:E}=p,O=M.precisionTo(C+l,1),T=M.precisionTo(_+d,1);let P=M.precisionTo(w+h-O,1),A=M.precisionTo(E+S-T,1);return v.startX===p.endX&&(P=0),v.startY===p.endY&&(A=0),{unitId:n,subUnitId:o,left:O,top:T,width:P,height:A}}function Ip(n,o,e,t,i,r,s){const{column:l,columnOffset:c,row:d,rowOffset:u}=e,h=s.ensureSkeleton(o);if(h==null)throw new Error("No current skeleton");const g=Jt(h,{startColumn:l,endColumn:l,startRow:d,endRow:d}),{startX:S,startY:f}=g,v=M.precisionTo(S+c,1),p=M.precisionTo(f+u,1),C=r.getCellWithCoordByOffset(v+t,p+i,h);if(C==null)throw new Error("No end selection cell");const _={column:C.actualColumn,columnOffset:M.precisionTo(v+t-C.startX,1),row:C.actualRow,rowOffset:M.precisionTo(p+i-C.startY,1)};return{unitId:n,subUnitId:o,sheetTransform:{from:{column:l,columnOffset:c,row:d,rowOffset:u},to:_},transform:{left:v,top:p,width:t,height:i}}}y.AFFECT_LAYOUT_STYLES=zs,y.APPLY_TYPE=le,y.AddRangeProtectionFromContextMenuCommand=Vt,y.AddRangeProtectionFromSheetBarCommand=ai,y.AddRangeProtectionFromToolbarCommand=si,y.ApplyFormatPainterCommand=hi,y.AutoClearContentCommand=nn,y.AutoFillCommand=dt,y.BaseSelectionRenderService=Qo,y.COPY_SPECIAL_MENU_ID=Ri,y.COPY_TYPE=xe,y.CellAlertType=Hn,y.CellEditorManagerService=_r,y.ChangeSheetProtectionFromSheetBarCommand=Ii,y.ChangeZoomRatioCommand=bn,y.DATA_TYPE=_e,y.DeleteRangeMoveLeftConfirmCommand=cn,y.DeleteRangeMoveUpConfirmCommand=Mt,y.DeleteRangeProtectionFromContextMenuCommand=Lt,y.DeleteWorksheetProtectionFormSheetBarCommand=Ci,y.EMBEDDING_FORMULA_EDITOR=_l,y.EMBEDDING_FORMULA_EDITOR_COMPONENT_KEY=Ui,y.ExpandSelectionCommand=De,y.FormatPainterStatus=Ae,y.FormulaBar=Ga,y.HideColConfirmCommand=ni,y.HideRowConfirmCommand=ti,y.IAutoFillService=ct,y.ICellEditorManagerService=En,y.IEditorBridgeService=me,y.IFormatPainterService=Fe,y.IFormulaEditorManagerService=yn,y.IMarkSelectionService=yt,y.ISheetCellDropdownManagerService=As,y.ISheetClipboardService=ke,y.ISheetSelectionRenderService=Ie,y.IStatusBarService=Ei,y.InsertRangeMoveDownConfirmCommand=kt,y.InsertRangeMoveRightConfirmCommand=hn,y.JumpOver=ze,y.MobileSheetBar=Kc,y.MoveSelectionCommand=Pe,y.MoveSelectionEnterAndTabCommand=Xe,y.PASTE_SPECIAL_MENU_ID=Mi,y.PREDEFINED_HOOK_NAME=wu,y.PREDEFINED_HOOK_NAME_COPY=ut,y.PREDEFINED_HOOK_NAME_PASTE=ge,y.RANGE_SELECTOR_COMPONENT_KEY=jo,y.RANGE_SELECTOR_SYMBOLS=fl,y.RefillCommand=ci,y.RemoveColConfirmCommand=gn,y.RemoveRowConfirmCommand=mn,y.RemoveSheetConfirmCommand=di,y.RenameSheetOperation=bi,y.RenderSheetContent=Ar,y.RenderSheetFooter=$a,y.RenderSheetHeader=el,y.ResetRangeTextColorCommand=Ji,y.ResetScrollCommand=Qu,y.SELECTION_SHAPE_DEPTH=Ko,y.SHEET_UI_PLUGIN_NAME=hh,y.SHEET_VIEW_KEY=he,y.ScrollCommand=Le,y.ScrollToCellCommand=oo,y.ScrollToRangeOperation=ao,y.SelectAllCommand=Si,y.SelectionControl=Kn,y.SelectionShape=Kn,y.SelectionShapeExtension=xs,y.SetActivateCellEditOperation=so,y.SetCellEditVisibleArrowOperation=Bt,y.SetCellEditVisibleOperation=Se,y.SetCellEditVisibleWithF2Operation=_i,y.SetColumnFrozenCommand=gi,y.SetColumnHeaderHeightCommand=Zn,y.SetFormatPainterOperation=ui,y.SetInfiniteFormatPainterCommand=io,y.SetOnceFormatPainterCommand=fn,y.SetRangeBoldCommand=Ot,y.SetRangeFontDecreaseCommand=Qi,y.SetRangeFontFamilyCommand=dn,y.SetRangeFontIncreaseCommand=qi,y.SetRangeFontSizeCommand=ii,y.SetRangeItalicCommand=At,y.SetRangeProtectionFromContextMenuCommand=xt,y.SetRangeStrickThroughCommand=Nt,y.SetRangeSubscriptCommand=mr,y.SetRangeSuperscriptCommand=gr,y.SetRangeTextColorCommand=un,y.SetRangeUnderlineCommand=Dt,y.SetRowFrozenCommand=mi,y.SetRowHeaderWidthCommand=jn,y.SetScrollOperation=et,y.SetScrollRelativeCommand=Cn,y.SetSelectionFrozenCommand=$e,y.SetWorksheetColAutoWidthCommand=In,y.SetZoomRatioCommand=wn,y.SetZoomRatioOperation=je,y.SheetBar=qa,y.SheetCopyCommand=Ve,y.SheetCutCommand=ht,y.SheetMenuPosition=Hl,y.SheetPasteBesidesBorderCommand=ln,y.SheetPasteColWidthCommand=Rt,y.SheetPasteCommand=We,y.SheetPasteFormatCommand=an,y.SheetPasteShortKeyCommand=Gi,y.SheetPasteValueCommand=sn,y.SheetPermissionOpenDialogOperation=vr,y.SheetPermissionOpenPanelOperation=Be,y.SheetPermissionUserManagerService=gt,y.SheetPrintInterceptorService=Ds,y.SheetsUIMenuSchema=jl,y.SheetsUIPart=pr,y.ShowMenuListCommand=pi,y.SidebarDefinedNameOperation=lo,y.StatusBarService=Or,y.UNIVER_SHEET_PERMISSION_USER_PART=ri,y.ViewSheetPermissionFromContextMenuCommand=Wt,y.ViewSheetPermissionFromSheetBarCommand=li,y.attachPrimaryWithCoord=Gn,y.attachRangeWithCoord=Jt,y.attachSelectionWithCoord=Re,y.calculateDocSkeletonRects=bl,y.checkInHeaderRanges=Pi,y.convertPositionCellToSheetOverGrid=Ip,y.convertPositionSheetOverGridToAbsolute=Cp,y.deriveStateFromActiveSheet$=be,y.discreteRangeToRange=at,y.functionDisplayNames=So,y.genNormalSelectionStyle=qe,y.genSelectionByRange=Bs,y.getAllSelection=Jo,y.getAutoFillRepeatRange=Wd,y.getCellRealRange=Pa,y.getCoordByCell=fr,y.getCoordByOffset=Ye,y.getCurrentExclusiveRangeInterest$=Rl,y.getCurrentRangeDisable$=ee,y.getCustomRangePosition=xm,y.getEditingCustomRangePosition=Um,y.getEditorObject=xi,y.getMatrixPlainText=ua,y.getObservableWithExclusiveRange$=ft,y.getRepeatRange=fu,y.getSheetObject=He,y.getTopLeftSelectionOfCurrSheet=Fi,y.getTransformCoord=fi,y.isEmbeddingFormulaEditor=Hm,y.isRangeSelector=vl,y.mergeSetRangeValues=ar,y.useActiveWorkbook=St,y.useActiveWorksheet=dh,y.useHighlightRange=xc,y.useKeyEventConfig=Pr,y.useWorkbooks=uh,y.virtualizeDiscreteRanges=lt,y.whenFormulaEditorActivated=Gd,y.whenSheetEditorFocused=ae,Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})}));


// @univerjs/sheets-ui/facade
(function(p,h){typeof exports=="object"&&typeof module<"u"?h(exports,require("@univerjs/core"),require("@univerjs/core/facade"),require("@univerjs/docs"),require("@univerjs/engine-render"),require("@univerjs/sheets"),require("@univerjs/sheets-ui"),require("@univerjs/sheets/facade"),require("@univerjs/ui"),require("rxjs")):typeof define=="function"&&define.amd?define(["exports","@univerjs/core","@univerjs/core/facade","@univerjs/docs","@univerjs/engine-render","@univerjs/sheets","@univerjs/sheets-ui","@univerjs/sheets/facade","@univerjs/ui","rxjs"],h):(p=typeof globalThis<"u"?globalThis:p||self,h(p.UniverSheetsUiFacade={},p.UniverCore,p.UniverCoreFacade,p.UniverDocs,p.UniverEngineRender,p.UniverSheets,p.UniverSheetsUi,p.UniverSheetsFacade,p.UniverUi,p.rxjs))})(this,(function(p,h,P,H,u,I,a,b,C,m){"use strict";class y extends P.FUniver{_initSheetUIEvent(e){const r=e.get(h.ICommandService);this.registerEventHandler(this.Event.BeforeSheetEditStart,()=>r.beforeCommandExecuted(t=>{if(t.id!==a.SetCellEditVisibleOperation.id)return;const i=this.getActiveSheet();if(!i)return;const{workbook:o,worksheet:s}=i,l=e.get(a.IEditorBridgeService),g=t.params,{visible:v,keycode:S,eventType:c}=g,n=l.getEditLocation();if(v){const d={row:n.row,column:n.column,eventType:c,keycode:S,workbook:o,worksheet:s,isZenEditor:!1};if(this.fireEvent(this.Event.BeforeSheetEditStart,d),d.cancel)throw new h.CanceledError}})),this.registerEventHandler(this.Event.BeforeSheetEditEnd,()=>r.beforeCommandExecuted(t=>{if(t.id!==a.SetCellEditVisibleOperation.id)return;const i=this.getActiveSheet();if(!i)return;const{workbook:o,worksheet:s}=i,l=e.get(a.IEditorBridgeService),g=e.get(h.IUniverInstanceService),v=t.params,{visible:S,keycode:c,eventType:n}=v,d=l.getEditLocation();if(!S){const R={row:d.row,column:d.column,eventType:n,keycode:c,workbook:o,worksheet:s,isZenEditor:!1,value:h.RichTextValue.create(g.getUnit(h.DOCS_NORMAL_EDITOR_UNIT_ID_KEY).getSnapshot()),isConfirm:c!==C.KeyCode.ESC};if(this.fireEvent(this.Event.BeforeSheetEditEnd,R),R.cancel)throw new h.CanceledError}})),this.registerEventHandler(this.Event.SheetEditStarted,()=>r.onCommandExecuted(t=>{if(t.id!==a.SetCellEditVisibleOperation.id)return;const i=this.getCommandSheetTarget(t);if(!i)return;const{workbook:o,worksheet:s}=i,l=e.get(a.IEditorBridgeService),g=t.params,{visible:v,keycode:S,eventType:c}=g,n=l.getEditLocation();if(v){const d={row:n.row,column:n.column,eventType:c,keycode:S,workbook:o,worksheet:s,isZenEditor:!1};this.fireEvent(this.Event.SheetEditStarted,d)}})),this.registerEventHandler(this.Event.SheetEditEnded,()=>r.onCommandExecuted(t=>{if(t.id!==a.SetCellEditVisibleOperation.id)return;const i=this.getCommandSheetTarget(t);if(!i)return;const{workbook:o,worksheet:s}=i,l=e.get(a.IEditorBridgeService),g=t.params,{visible:v,keycode:S,eventType:c}=g,n=l.getEditLocation();if(!v){const d={row:n.row,column:n.column,eventType:c,keycode:S,workbook:o,worksheet:s,isZenEditor:!1,isConfirm:S!==C.KeyCode.ESC};this.fireEvent(this.Event.SheetEditEnded,d)}})),this.registerEventHandler(this.Event.SheetEditChanging,()=>r.onCommandExecuted(t=>{if(t.id!==H.RichTextEditingMutation.id)return;const i=this.getActiveSheet();if(!i)return;const{workbook:o,worksheet:s}=i,l=e.get(a.IEditorBridgeService),g=e.get(h.IUniverInstanceService),v=t.params;if(!l.isVisible().visible)return;const{unitId:S}=v;if(S===h.DOCS_NORMAL_EDITOR_UNIT_ID_KEY){const{row:c,column:n}=l.getEditLocation(),d={workbook:o,worksheet:s,row:c,column:n,value:h.RichTextValue.create(g.getUnit(h.DOCS_NORMAL_EDITOR_UNIT_ID_KEY).getSnapshot()),isZenEditor:!1};this.fireEvent(this.Event.SheetEditChanging,d)}})),this.registerEventHandler(this.Event.BeforeSheetZoomChange,()=>r.beforeCommandExecuted(t=>{if(t.id!==a.SetZoomRatioCommand.id)return;const i=this.getCommandSheetTarget(t);if(!i)return;const{workbook:o,worksheet:s}=i,l={zoom:t.params.zoomRatio,workbook:o,worksheet:s};if(this.fireEvent(this.Event.BeforeSheetZoomChange,l),l.cancel)throw new h.CanceledError})),this.registerEventHandler(this.Event.SheetZoomChanged,()=>r.onCommandExecuted(t=>{if(t.id!==a.SetZoomRatioCommand.id)return;const i=this.getCommandSheetTarget(t);if(!i)return;const{workbook:o,worksheet:s}=i;this.fireEvent(this.Event.SheetZoomChanged,{zoom:s.getZoom(),workbook:o,worksheet:s})}))}_initObserverListener(e){const r=e.get(u.IRenderManagerService),t=e.get(h.LifecycleService),i=new h.DisposableCollection;this.disposeWithMe(t.lifecycle$.subscribe(g=>{if(g!==h.LifecycleStages.Rendered)return;i.dispose();const v=e.get(a.HoverManagerService),S=e.get(a.DragManagerService);v&&(this.registerEventHandler(this.Event.CellClicked,()=>{var c;return(c=v.currentClickedCell$)==null?void 0:c.pipe(m.filter(n=>!!n)).subscribe(n=>{const d=this.getSheetTarget(n.location.unitId,n.location.subUnitId);d&&this.fireEvent(this.Event.CellClicked,{...d,...n,row:n.location.row,column:n.location.col})})}),this.registerEventHandler(this.Event.CellHover,()=>{var c;return(c=v.currentRichText$)==null?void 0:c.pipe(m.filter(n=>!!n)).subscribe(n=>{const d=this.getSheetTarget(n.unitId,n.subUnitId);d&&this.fireEvent(this.Event.CellHover,{...d,...n,row:n.row,column:n.col})})}),this.registerEventHandler(this.Event.CellPointerDown,()=>{var c;return(c=v.currentPointerDownCell$)==null?void 0:c.pipe(m.filter(n=>!!n)).subscribe(n=>{const d=this.getSheetTarget(n.unitId,n.subUnitId);d&&this.fireEvent(this.Event.CellPointerDown,{...d,...n,row:n.row,column:n.col})})}),this.registerEventHandler(this.Event.CellPointerUp,()=>{var c;return(c=v.currentPointerUpCell$)==null?void 0:c.pipe(m.filter(n=>!!n)).subscribe(n=>{const d=this.getSheetTarget(n.unitId,n.subUnitId);d&&this.fireEvent(this.Event.CellPointerUp,{...d,...n,row:n.row,column:n.col})})}),this.registerEventHandler(this.Event.CellPointerMove,()=>{var c;return(c=v.currentCellPosWithEvent$)==null?void 0:c.pipe(m.filter(n=>!!n)).subscribe(n=>{const d=this.getSheetTarget(n.unitId,n.subUnitId);d&&this.fireEvent(this.Event.CellPointerMove,{...d,...n,row:n.row,column:n.col})})}),this.registerEventHandler(this.Event.DragOver,()=>{var c;return(c=S.currentCell$)==null?void 0:c.pipe(m.filter(n=>!!n)).subscribe(n=>{const d=this.getSheetTarget(n.location.unitId,n.location.subUnitId);d&&this.fireEvent(this.Event.DragOver,{...d,...n,row:n.location.row,column:n.location.col})})}),this.registerEventHandler(this.Event.Drop,()=>{var c;return(c=S.endCell$)==null?void 0:c.pipe(m.filter(n=>!!n)).subscribe(n=>{const d=this.getSheetTarget(n.location.unitId,n.location.subUnitId);d&&this.fireEvent(this.Event.Drop,{...d,...n,row:n.location.row,column:n.location.col})})}),this.registerEventHandler(this.Event.RowHeaderClick,()=>{var c;return(c=v.currentRowHeaderClick$)==null?void 0:c.pipe(m.filter(n=>!!n)).subscribe(n=>{const d=this.getSheetTarget(n.unitId,n.subUnitId);d&&this.fireEvent(this.Event.RowHeaderClick,{...d,row:n.index})})}),this.registerEventHandler(this.Event.RowHeaderPointerDown,()=>{var c;return(c=v.currentRowHeaderPointerDown$)==null?void 0:c.pipe(m.filter(n=>!!n)).subscribe(n=>{const d=this.getSheetTarget(n.unitId,n.subUnitId);d&&this.fireEvent(this.Event.RowHeaderPointerDown,{...d,row:n.index})})}),this.registerEventHandler(this.Event.RowHeaderPointerUp,()=>{var c;return(c=v.currentRowHeaderPointerUp$)==null?void 0:c.pipe(m.filter(n=>!!n)).subscribe(n=>{const d=this.getSheetTarget(n.unitId,n.subUnitId);d&&this.fireEvent(this.Event.RowHeaderPointerUp,{...d,row:n.index})})}),this.registerEventHandler(this.Event.RowHeaderHover,()=>{var c;return(c=v.currentHoveredRowHeader$)==null?void 0:c.pipe(m.filter(n=>!!n)).subscribe(n=>{const d=this.getSheetTarget(n.unitId,n.subUnitId);d&&this.fireEvent(this.Event.RowHeaderHover,{...d,row:n.index})})}),this.registerEventHandler(this.Event.ColumnHeaderClick,()=>{var c;return(c=v.currentColHeaderClick$)==null?void 0:c.pipe(m.filter(n=>!!n)).subscribe(n=>{const d=this.getSheetTarget(n.unitId,n.subUnitId);d&&this.fireEvent(this.Event.ColumnHeaderClick,{...d,column:n.index})})}),this.registerEventHandler(this.Event.ColumnHeaderPointerDown,()=>{var c;return(c=v.currentColHeaderPointerDown$)==null?void 0:c.pipe(m.filter(n=>!!n)).subscribe(n=>{const d=this.getSheetTarget(n.unitId,n.subUnitId);d&&this.fireEvent(this.Event.ColumnHeaderPointerDown,{...d,column:n.index})})}),this.registerEventHandler(this.Event.ColumnHeaderPointerUp,()=>{var c;return(c=v.currentColHeaderPointerUp$)==null?void 0:c.pipe(m.filter(n=>!!n)).subscribe(n=>{const d=this.getSheetTarget(n.unitId,n.subUnitId);d&&this.fireEvent(this.Event.ColumnHeaderPointerUp,{...d,column:n.index})})}),this.registerEventHandler(this.Event.ColumnHeaderHover,()=>{var c;return(c=v.currentHoveredColHeader$)==null?void 0:c.pipe(m.filter(n=>!!n)).subscribe(n=>{const d=this.getSheetTarget(n.unitId,n.subUnitId);d&&this.fireEvent(this.Event.ColumnHeaderHover,{...d,column:n.index})})}))})),this.disposeWithMe(i);const o=new Map;let s;const l=m.combineLatest([r.created$,t.lifecycle$]);this.disposeWithMe(l.subscribe(([g,v])=>{var R;if(g.type===h.UniverInstanceType.UNIVER_SHEET&&(s=g),v<=h.LifecycleStages.Rendered||!s)return;const S=new h.DisposableCollection,c=this.getWorkbook(s.unitId);if(!c)return;o.get(s.unitId)&&((R=o.get(s.unitId))==null||R.dispose()),o.set(s.unitId,S);const n=s.with(a.SheetScrollManagerService),d=s.with(I.SheetsSelectionsService);S.add(this.registerEventHandler(this.Event.Scroll,()=>n.validViewportScrollInfo$.subscribe(E=>{E&&this.fireEvent(this.Event.Scroll,{workbook:c,worksheet:c.getActiveSheet(),...E})}))),S.add(this.registerEventHandler(this.Event.SelectionMoveStart,()=>d.selectionMoveStart$.subscribe(E=>{var w;this.fireEvent(this.Event.SelectionMoveStart,{workbook:c,worksheet:c.getActiveSheet(),selections:(w=E==null?void 0:E.map(_=>_.range))!=null?w:[]})}))),S.add(this.registerEventHandler(this.Event.SelectionMoving,()=>d.selectionMoving$.subscribe(E=>{var w;this.fireEvent(this.Event.SelectionMoving,{workbook:c,worksheet:c.getActiveSheet(),selections:(w=E==null?void 0:E.map(_=>_.range))!=null?w:[]})}))),S.add(this.registerEventHandler(this.Event.SelectionMoveEnd,()=>d.selectionMoveEnd$.subscribe(E=>{var w;this.fireEvent(this.Event.SelectionMoveEnd,{workbook:c,worksheet:c.getActiveSheet(),selections:(w=E==null?void 0:E.map(_=>_.range))!=null?w:[]})}))),S.add(this.registerEventHandler(this.Event.SelectionChanged,()=>d.selectionChanged$.subscribe(E=>{var w;this.fireEvent(this.Event.SelectionChanged,{workbook:c,worksheet:c.getActiveSheet(),selections:(w=E==null?void 0:E.map(_=>_.range))!=null?w:[]})}))),s=null,this.disposeWithMe(S)})),this.disposeWithMe(r.disposed$.subscribe(g=>{var v;(v=o.get(g))==null||v.dispose(),o.delete(g)})),this.disposeWithMe(()=>{o.forEach(g=>{g.dispose()})})}_initialize(e){this._initSheetUIEvent(e),this._initObserverListener(e);const r=e.get(h.ICommandService);this.registerEventHandler(this.Event.BeforeClipboardChange,()=>r.beforeCommandExecuted(t=>{switch(t.id){case C.CopyCommand.id:case C.CutCommand.id:this._beforeClipboardChange();break}})),this.registerEventHandler(this.Event.ClipboardChanged,()=>r.onCommandExecuted(t=>{switch(t.id){case C.CopyCommand.id:case C.CutCommand.id:this._clipboardChanged();break}})),this.registerEventHandler(this.Event.BeforeClipboardPaste,()=>r.beforeCommandExecuted(t=>{switch(t.id){case a.SheetPasteShortKeyCommand.id:this._beforeClipboardPaste(t.params);break;case C.PasteCommand.id:this._beforeClipboardPasteAsync();break}})),this.registerEventHandler(this.Event.ClipboardPasted,()=>r.onCommandExecuted(t=>{switch(t.id){case a.SheetPasteShortKeyCommand.id:this._clipboardPaste(t.params);break;case C.PasteCommand.id:this._clipboardPasteAsync();break}})),this.registerEventHandler(this.Event.SheetSkeletonChanged,()=>r.onCommandExecuted(t=>{if(I.COMMAND_LISTENER_SKELETON_CHANGE.indexOf(t.id)>-1){const i=this.getActiveSheet();if(!i)return;const o=I.getSkeletonChangedEffectedRange(t,i.worksheet.getMaxColumns()).map(s=>{var l,g;return(g=(l=this.getWorkbook(s.unitId))==null?void 0:l.getSheetBySheetId(s.subUnitId))==null?void 0:g.getRange(s.range)}).filter(Boolean);if(!o.length)return;this.fireEvent(this.Event.SheetSkeletonChanged,{workbook:i.workbook,worksheet:i.worksheet,payload:t,skeleton:i.worksheet.getSkeleton(),effectedRanges:o})}}))}_generateClipboardCopyParam(){const e=this.getActiveWorkbook(),r=e==null?void 0:e.getActiveSheet(),t=e==null?void 0:e.getActiveRange();if(!e||!r||!t)return;const o=this._injector.get(a.ISheetClipboardService).generateCopyContent(e.getId(),r.getSheetId(),t.getRange());if(!o)return;const{html:s,plain:l}=o;return{workbook:e,worksheet:r,text:l,html:s,fromSheet:r,fromRange:t}}_beforeClipboardChange(){const e=this._generateClipboardCopyParam();if(e&&(this.fireEvent(this.Event.BeforeClipboardChange,e),e.cancel))throw new h.CanceledError}_clipboardChanged(){const e=this._generateClipboardCopyParam();e&&this.fireEvent(this.Event.ClipboardChanged,e)}_generateClipboardPasteParam(e){if(!e)return;const{htmlContent:r,textContent:t}=e,i=this.getActiveWorkbook(),o=i==null?void 0:i.getActiveSheet();return!i||!o?void 0:{workbook:i,worksheet:o,text:t,html:r}}async _generateClipboardPasteParamAsync(){const e=this.getActiveWorkbook(),r=e==null?void 0:e.getActiveSheet();if(!e||!r)return;const o=(await this._injector.get(C.IClipboardInterfaceService).read())[0];let s;if(o){const l=o.types,g=l.indexOf(C.PLAIN_TEXT_CLIPBOARD_MIME_TYPE)!==-1?await o.getType(C.PLAIN_TEXT_CLIPBOARD_MIME_TYPE).then(S=>S&&S.text()):"",v=l.indexOf(C.HTML_CLIPBOARD_MIME_TYPE)!==-1?await o.getType(C.HTML_CLIPBOARD_MIME_TYPE).then(S=>S&&S.text()):"";s={workbook:e,worksheet:r,text:g,html:v}}return s}_beforeClipboardPaste(e){const r=this._generateClipboardPasteParam(e);if(r&&(this.fireEvent(this.Event.BeforeClipboardPaste,r),r.cancel))throw new h.CanceledError}_clipboardPaste(e){const r=this._generateClipboardPasteParam(e);if(r&&(this.fireEvent(this.Event.ClipboardPasted,r),r.cancel))throw new h.CanceledError}async _beforeClipboardPasteAsync(){if(!C.supportClipboardAPI()){this._injector.get(h.ILogService).warn("[Facade]: The navigator object only supports the browser environment");return}const e=await this._generateClipboardPasteParamAsync();if(e&&(this.fireEvent(this.Event.BeforeClipboardPaste,e),e.cancel))throw new h.CanceledError}async _clipboardPasteAsync(){if(!C.supportClipboardAPI()){this._injector.get(h.ILogService).warn("[Facade]: The navigator object only supports the browser environment");return}const e=await this._generateClipboardPasteParamAsync();if(e&&(this.fireEvent(this.Event.ClipboardPasted,e),e.cancel))throw new h.CanceledError}customizeColumnHeader(e){var v,S;const r=this.getActiveWorkbook();if(!r){console.error("WorkBook not exist");return}const t=r==null?void 0:r.getId(),i=this._injector.get(u.IRenderManagerService),o=r.getActiveSheet(),s=o.getSheetId(),l=i.getRenderById(t);l&&((v=e.headerStyle)!=null&&v.size)&&(l.with(a.SheetSkeletonManagerService).setColumnHeaderSize(l,s,(S=e.headerStyle)==null?void 0:S.size),o==null||o.refreshCanvas()),this._getSheetRenderComponent(t,a.SHEET_VIEW_KEY.COLUMN).setCustomHeader(e),o==null||o.refreshCanvas()}customizeRowHeader(e){const r=this.getActiveWorkbook();if(!r){console.error("WorkBook not exist");return}const t=r==null?void 0:r.getId();this._getSheetRenderComponent(t,a.SHEET_VIEW_KEY.ROW).setCustomHeader(e)}registerSheetRowHeaderExtension(e,...r){const t=this._getSheetRenderComponent(e,a.SHEET_VIEW_KEY.ROW),i=t.register(...r);return h.toDisposable(()=>{i.dispose(),t.makeDirty(!0)})}registerSheetColumnHeaderExtension(e,...r){const t=this._getSheetRenderComponent(e,a.SHEET_VIEW_KEY.COLUMN),i=t.register(...r);return h.toDisposable(()=>{i.dispose(),t.makeDirty(!0)})}registerSheetMainExtension(e,...r){const t=this._getSheetRenderComponent(e,a.SHEET_VIEW_KEY.MAIN),i=t.register(...r);return h.toDisposable(()=>{i.dispose(),t.makeDirty(!0)})}_getSheetRenderComponent(e,r){const i=this._injector.get(u.IRenderManagerService).getRenderById(e);if(!i)throw new Error(`Render Unit with unitId ${e} not found`);const{components:o}=i,s=o.get(r);if(!s)throw new Error("Render component not found");return s}getSheetHooks(){return this._injector.createInstance(b.FSheetHooks)}pasteIntoSheet(e,r,t){return this._commandService.executeCommand(a.SheetPasteShortKeyCommand.id,{htmlContent:e,textContent:r,files:t})}setProtectedRangeShadowStrategy(e){this._injector.get(a.SheetPermissionRenderManagerService).setProtectedRangeShadowStrategy(e)}getProtectedRangeShadowStrategy(){return this._injector.get(a.SheetPermissionRenderManagerService).getProtectedRangeShadowStrategy()}getProtectedRangeShadowStrategy$(){return this._injector.get(a.SheetPermissionRenderManagerService).getProtectedRangeShadowStrategy$()}setPermissionDialogVisible(e){this._injector.get(h.IPermissionService).setShowComponents(e)}}P.FUniver.extend(y);class D extends b.FWorkbook{openSiderbar(e){return this._logDeprecation("openSiderbar"),this._injector.get(C.ISidebarService).open(e)}openDialog(e){this._logDeprecation("openDialog");const t=this._injector.get(C.IDialogService).open({...e,onClose:()=>{t.dispose()}});return t}customizeColumnHeader(e){const r=this._workbook.getUnitId();this._getSheetRenderComponent(r,a.SHEET_VIEW_KEY.COLUMN).setCustomHeader(e)}customizeRowHeader(e){const r=this._workbook.getUnitId();this._getSheetRenderComponent(r,a.SHEET_VIEW_KEY.ROW).setCustomHeader(e)}_getSheetRenderComponent(e,r){const i=this._injector.get(u.IRenderManagerService).getRenderById(e);if(!i)throw new Error(`Render Unit with unitId ${e} not found`);const{components:o}=i,s=o.get(r);if(!s)throw new Error("Render component not found");return s}_logDeprecation(e){this._injector.get(h.ILogService).warn("[FWorkbook]",`${e} is deprecated. Please use the function of the same name on "FUniver".`)}generateCellParams(e){const r=this.getActiveSheet();return{row:e.row,column:e.col,workbook:this,worksheet:r}}onCellClick(e){const r=this._injector.get(a.HoverManagerService);return h.toDisposable(r.currentClickedCell$.pipe(m.filter(t=>!!t)).subscribe(t=>{e(t)}))}onCellHover(e){const r=this._injector.get(a.HoverManagerService);return h.toDisposable(r.currentRichText$.pipe(m.filter(t=>!!t)).subscribe(e))}onCellPointerDown(e){const r=this._injector.get(a.HoverManagerService);return h.toDisposable(r.currentPointerDownCell$.subscribe(e))}onCellPointerUp(e){const r=this._injector.get(a.HoverManagerService);return h.toDisposable(r.currentPointerUpCell$.subscribe(e))}onCellPointerMove(e){const r=this._injector.get(a.HoverManagerService);return h.toDisposable(r.currentCellPosWithEvent$.pipe(m.filter(t=>!!t)).subscribe(t=>{e(t,t.event)}))}onDragOver(e){const r=this._injector.get(a.DragManagerService);return h.toDisposable(r.currentCell$.pipe(m.filter(t=>!!t)).subscribe(t=>{e(t)}))}onDrop(e){const r=this._injector.get(a.DragManagerService);return h.toDisposable(r.endCell$.pipe(m.filter(t=>!!t)).subscribe(t=>{e(t)}))}startEditing(){const e=this._injector.get(h.ICommandService);return this._injector.get(a.IEditorBridgeService).isVisible().visible?!0:e.syncExecuteCommand(a.SetCellEditVisibleOperation.id,{eventType:u.DeviceInputEventType.Dblclick,unitId:this._workbook.getUnitId(),visible:!0})}async endEditing(e){const r=this._injector.get(h.ICommandService);return this._injector.get(a.IEditorBridgeService).isVisible().visible&&r.syncExecuteCommand(a.SetCellEditVisibleOperation.id,{eventType:u.DeviceInputEventType.Keyboard,keycode:e?C.KeyCode.ENTER:C.KeyCode.ESC,visible:!1,unitId:this._workbook.getUnitId()}),await h.awaitTime(0),!0}endEditingAsync(e=!0){return this.endEditing(e)}abortEditingAsync(){return this.endEditingAsync(!1)}isCellEditing(){return this._injector.get(a.IEditorBridgeService).isVisible().visible}getScrollStateBySheetId(e){const r=this._workbook.getUnitId(),i=this._injector.get(u.IRenderManagerService).getRenderById(r);return i?i.with(a.SheetScrollManagerService).getScrollStateByParam({unitId:r,sheetId:e}):null}disableSelection(){const e=this._workbook.getUnitId(),t=this._injector.get(u.IRenderManagerService).getRenderById(e);return t&&t.with(a.ISheetSelectionRenderService).disableSelection(),this}enableSelection(){const e=this._workbook.getUnitId(),t=this._injector.get(u.IRenderManagerService).getRenderById(e);return t&&t.with(a.ISheetSelectionRenderService).enableSelection(),this}transparentSelection(){const e=this._workbook.getUnitId(),t=this._injector.get(u.IRenderManagerService).getRenderById(e);return t&&t.with(a.ISheetSelectionRenderService).transparentSelection(),this}showSelection(){const e=this._workbook.getUnitId(),t=this._injector.get(u.IRenderManagerService).getRenderById(e);return t&&t.with(a.ISheetSelectionRenderService).showSelection(),this}}b.FWorkbook.extend(D);class T extends b.FWorksheet{refreshCanvas(){const e=this._injector.get(u.IRenderManagerService),r=this._fWorkbook.id,t=e.getRenderById(r);if(!t)throw new Error(`Render Unit with unitId ${r} not found`);t.with(a.SheetSkeletonManagerService).reCalculate();const i=t.mainComponent;if(!i)throw new Error("Main component not found");return i.makeDirty(),this}highlightRanges(e,r,t){const i=this._injector.get(a.IMarkSelectionService),o=[];for(const s of e){const l=s.getRange(),g=i.addShapeWithNoFresh({range:l,style:r,primary:t});g&&o.push(g)}if(i.refreshShapes(),o.length===0)throw new Error("Failed to highlight current range");return h.toDisposable(()=>{o.forEach(s=>{i.removeShape(s)})})}zoom(e){const r=this._injector.get(h.ICommandService),t=Math.min(Math.max(e,.1),4);return r.executeCommand(a.SetZoomRatioCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),zoomRatio:t}),this}getZoom(){return this._worksheet.getZoomRatio()}getVisibleRange(){const e=this._workbook.getUnitId(),t=this._injector.get(u.IRenderManagerService).getRenderById(e);let i={startColumn:0,startRow:0,endColumn:0,endRow:0};if(!t)return i;const s=t.with(a.SheetSkeletonManagerService).getCurrentSkeleton();if(!s)return i;const l=s==null?void 0:s.getVisibleRanges();if(!l)return i;i=s.getVisibleRangeByViewport(u.SHEET_VIEWPORT_KEY.VIEW_MAIN);for(const[g,v]of l)u.sheetContentViewportKeys.indexOf(g)!==-1&&(i.startColumn=Math.min(i.startColumn,v.startColumn),i.startRow=Math.min(i.startRow,v.startRow),i.endColumn=Math.max(i.endColumn,v.endColumn),i.endRow=Math.max(i.endRow,v.endRow));return i}scrollToCell(e,r,t){const i=this._workbook.getUnitId(),s=this._injector.get(u.IRenderManagerService).getRenderById(i);return s&&(s==null?void 0:s.with(a.SheetsScrollRenderController)).scrollToCell(e,r,t),this}getScrollState(){const e={offsetX:0,offsetY:0,sheetViewStartColumn:0,sheetViewStartRow:0},r=this._workbook.getUnitId(),t=this._worksheet.getSheetId(),o=this._injector.get(u.IRenderManagerService).getRenderById(r);return o&&o.with(a.SheetScrollManagerService).getScrollStateByParam({unitId:r,sheetId:t})||e}onScroll(e){var o;const r=this._workbook.getUnitId(),i=(o=this._injector.get(u.IRenderManagerService).getRenderById(r))==null?void 0:o.with(a.SheetScrollManagerService);if(i){const s=i.validViewportScrollInfo$.subscribe(l=>{e(l)});return h.toDisposable(s)}return h.toDisposable(()=>{})}getSkeleton(){var r,t;const e=(r=this._injector.get(u.IRenderManagerService).getRenderById(this._workbook.getUnitId()))==null?void 0:r.with(a.SheetSkeletonManagerService);return(t=e==null?void 0:e.getWorksheetSkeleton(this._worksheet.getSheetId()))==null?void 0:t.skeleton}autoResizeColumn(e){return this.autoResizeColumns(e,1)}autoResizeColumns(e,r){const t=this._workbook.getUnitId(),i=this._worksheet.getSheetId(),o=[{startColumn:e,endColumn:e+r-1,startRow:0,endRow:this._worksheet.getRowCount()-1}];return this._commandService.syncExecuteCommand(a.SetWorksheetColAutoWidthCommand.id,{unitId:t,subUnitId:i,ranges:o}),this}setColumnAutoWidth(e,r){return this.autoResizeColumns(e,r)}autoResizeRows(e,r){const t=this._workbook.getUnitId(),i=this._worksheet.getSheetId(),o=[{startRow:e,endRow:e+r-1,startColumn:0,endColumn:this._worksheet.getColumnCount()-1}];return this._commandService.syncExecuteCommand(I.SetWorksheetRowIsAutoHeightCommand.id,{unitId:t,subUnitId:i,ranges:o}),this}customizeColumnHeader(e){var l,g;const r=this._workbook.getUnitId(),t=this._worksheet.getSheetId(),o=this._injector.get(u.IRenderManagerService).getRenderById(r);o&&((l=e.headerStyle)!=null&&l.size)&&o.with(a.SheetSkeletonManagerService).setColumnHeaderSize(o,t,(g=e.headerStyle)==null?void 0:g.size),this._getSheetRenderComponent(r,a.SHEET_VIEW_KEY.COLUMN).setCustomHeader(e,t)}customizeRowHeader(e){var l,g;const r=this._workbook.getUnitId(),t=this._worksheet.getSheetId(),o=this._injector.get(u.IRenderManagerService).getRenderById(r);o&&((l=e.headerStyle)!=null&&l.size)&&o.with(a.SheetSkeletonManagerService).setRowHeaderSize(o,t,(g=e.headerStyle)==null?void 0:g.size),this._getSheetRenderComponent(r,a.SHEET_VIEW_KEY.ROW).setCustomHeader(e,t)}setColumnHeaderHeight(e){const r=this._workbook.getUnitId(),t=this._worksheet.getSheetId();return this._commandService.executeCommand(a.SetColumnHeaderHeightCommand.id,{unitId:r,subUnitId:t,size:e}),this}setRowHeaderWidth(e){const r=this._workbook.getUnitId(),t=this._worksheet.getSheetId();return this._commandService.executeCommand(a.SetRowHeaderWidthCommand.id,{unitId:r,subUnitId:t,size:e}),this}_getSheetRenderComponent(e,r){const i=this._injector.get(u.IRenderManagerService).getRenderById(e);if(!i)throw new Error(`Render Unit with unitId ${e} not found`);const{components:o}=i,s=o.get(r);if(!s)throw new Error("Render component not found");return s}}b.FWorksheet.extend(T);class B extends b.FPermission{setPermissionDialogVisible(e){this._permissionService.setShowComponents(e)}}b.FPermission.extend(B);class x extends b.FSheetHooks{onCellPointerMove(e){return h.toDisposable(this._injector.get(a.HoverManagerService).currentPosition$.subscribe(e))}onCellPointerOver(e){return h.toDisposable(this._injector.get(a.HoverManagerService).currentCell$.subscribe(e))}onCellDragOver(e){return h.toDisposable(this._injector.get(a.DragManagerService).currentCell$.subscribe(e))}onCellDrop(e){return h.toDisposable(this._injector.get(a.DragManagerService).endCell$.subscribe(e))}onCellRender(e,r=h.InterceptorEffectEnum.Style,t=I.InterceptCellContentPriority.DATA_VALIDATION){return this._injector.get(I.SheetInterceptorService).intercept(I.INTERCEPTOR_POINT.CELL_CONTENT,{effect:r,handler:(i,o,s)=>(i&&!i.customRender&&e&&(i.customRender=[...e]),s(i)),priority:t})}onBeforeCellEdit(e){return this._injector.get(h.ICommandService).beforeCommandExecuted(r=>{const t=r.params;r.id===a.SetCellEditVisibleOperation.id&&t.visible&&e(t)})}onAfterCellEdit(e){return this._injector.get(h.ICommandService).onCommandExecuted(r=>{const t=r.params;r.id===a.SetCellEditVisibleOperation.id&&!t.visible&&e(t)})}}b.FSheetHooks.extend(x);const k={CellClicked:"CellClicked",CellPointerDown:"CellPointerDown",CellPointerUp:"CellPointerUp",CellPointerMove:"CellPointerMove",CellHover:"CellHover"};class A{get BeforeClipboardChange(){return"BeforeClipboardChange"}get ClipboardChanged(){return"ClipboardChanged"}get BeforeClipboardPaste(){return"BeforeClipboardPaste"}get ClipboardPasted(){return"ClipboardPasted"}get BeforeSheetEditStart(){return"BeforeSheetEditStart"}get SheetEditStarted(){return"SheetEditStarted"}get SheetEditChanging(){return"SheetEditChanging"}get BeforeSheetEditEnd(){return"BeforeSheetEditEnd"}get SheetEditEnded(){return"SheetEditEnded"}get CellClicked(){return k.CellClicked}get CellHover(){return k.CellHover}get CellPointerDown(){return k.CellPointerDown}get CellPointerUp(){return k.CellPointerUp}get CellPointerMove(){return k.CellPointerMove}get DragOver(){return"DragOver"}get Drop(){return"Drop"}get Scroll(){return"Scroll"}get SelectionMoveStart(){return"SelectionMoveStart"}get SelectionChanged(){return"SelectionChanged"}get SelectionMoving(){return"SelectionMoving"}get SelectionMoveEnd(){return"SelectionMoveEnd"}get RowHeaderClick(){return"RowHeaderClick"}get RowHeaderPointerDown(){return"RowHeaderPointerDown"}get RowHeaderPointerUp(){return"RowHeaderPointerUp"}get RowHeaderHover(){return"RowHeaderHover"}get ColumnHeaderClick(){return"ColumnHeaderClick"}get ColumnHeaderPointerDown(){return"ColumnHeaderPointerDown"}get ColumnHeaderPointerUp(){return"ColumnHeaderPointerUp"}get ColumnHeaderHover(){return"ColumnHeaderHover"}get SheetSkeletonChanged(){return"SheetSkeletonChanged"}get BeforeSheetZoomChange(){return"BeforeSheetZoomChange"}get SheetZoomChanged(){return"SheetZoomChanged"}}P.FEventName.extend(A);class O extends b.FRange{getCell(){var l;const e=this._injector.get(u.IRenderManagerService),r=this._injector.get(h.ILogService),t=this._workbook.getUnitId(),i=this._worksheet.getSheetId(),o=e.getRenderById(t),s=(l=o==null?void 0:o.with(a.SheetSkeletonManagerService).getSkeletonParam(i))==null?void 0:l.skeleton;if(!s)throw r.error("[Facade]: `FRange.getCell` can only be called in current worksheet"),new Error("`FRange.getCell` can only be called in current worksheet");return s.getCellWithCoordByIndex(this._range.startRow,this._range.startColumn)}getCellRect(){const{startX:e,startY:r,endX:t,endY:i}=this.getCell(),o={x:e,y:r,width:t-e,height:i-r,top:r,left:e,bottom:i,right:t};return{...o,toJSON:()=>JSON.stringify(o)}}generateHTML(){var t;const r=this._injector.get(a.ISheetClipboardService).generateCopyContent(this._workbook.getUnitId(),this._worksheet.getSheetId(),this._range);return(t=r==null?void 0:r.html)!=null?t:""}attachPopup(e){var s,l,g;e.direction=(s=e.direction)!=null?s:"horizontal",e.extraProps=(l=e.extraProps)!=null?l:{},e.offset=(g=e.offset)!=null?g:[0,0];const{key:r,disposableCollection:t}=M(e,this._injector.get(C.ComponentManager)),o=this._injector.get(a.SheetCanvasPopManagerService).attachPopupToCell(this._range.startRow,this._range.startColumn,{...e,componentKey:r},this.getUnitId(),this._worksheet.getSheetId());return o?(t.add(o),t):(t.dispose(),null)}attachAlertPopup(e){const r=this._injector.get(a.CellAlertManagerService),t={workbook:this._workbook,worksheet:this._worksheet,row:this._range.startRow,col:this._range.startColumn,unitId:this.getUnitId(),subUnitId:this._worksheet.getSheetId()};return r.showAlert({...e,location:t}),{dispose:()=>{r.removeAlert(e.key)}}}attachRangePopup(e){var s,l,g;e.direction=(s=e.direction)!=null?s:"top-center",e.extraProps=(l=e.extraProps)!=null?l:{},e.offset=(g=e.offset)!=null?g:[0,0];const{key:r,disposableCollection:t}=M(e,this._injector.get(C.ComponentManager)),o=this._injector.get(a.SheetCanvasPopManagerService).attachRangePopup(this._range,{...e,componentKey:r},this.getUnitId(),this._worksheet.getSheetId());return o?(t.add(o),t):(t.dispose(),null)}highlight(e,r){const t=this._injector.get(a.IMarkSelectionService),i=t.addShape({range:this._range,style:e,primary:r});if(!i)throw new Error("Failed to highlight current range");return h.toDisposable(()=>{t.removeShape(i)})}showDropdown(e){return this._injector.get(a.ISheetCellDropdownManagerService).showDropdown(e)}async autoFill(e,r){const t=this.getRange(),i=e.getRange();if(!h.Rectangle.contains(i,t))throw new Error("AutoFill target range must contain source range");const{startRow:o,startColumn:s,endRow:l,endColumn:g}=t,{startRow:v,startColumn:S,endRow:c,endColumn:n}=i;if(l-o!==c-v&&g-s!==n-S)throw new Error("AutoFill can only fill in one direction");if(l-o===c-v&&s!==S&&g!==n)throw new Error("AutoFill can only fill in one direction");if(g-s===n-S&&o!==v&&l!==c)throw new Error("AutoFill can only fill in one direction");return this._commandService.executeCommand(a.AutoFillCommand.id,{sourceRange:t,targetRange:i,unitId:this.getUnitId(),subUnitId:this.getSheetId(),applyType:r})}}b.FRange.extend(O);function M(f,e){const{componentKey:r,isVue3:t}=f;let i;const o=new h.DisposableCollection;return typeof r=="string"?i=r:(i=`External_${h.generateRandomId(6)}`,o.add(e.register(i,r,{framework:t?"vue3":"react"}))),{key:i,disposableCollection:o}}p.transformComponentKey=M,Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})}));


// @univerjs/sheets-formula/index
(function(P,c){typeof exports=="object"&&typeof module<"u"?c(exports,require("@univerjs/core"),require("@univerjs/sheets"),require("@univerjs/engine-formula"),require("rxjs"),require("@univerjs/rpc")):typeof define=="function"&&define.amd?define(["exports","@univerjs/core","@univerjs/sheets","@univerjs/engine-formula","rxjs","@univerjs/rpc"],c):(P=typeof globalThis<"u"?globalThis:P||self,c(P.UniverSheetsFormula={},P.UniverCore,P.UniverSheets,P.UniverEngineFormula,P.rxjs,P.UniverRpc))})(this,(function(P,c,s,t,Y,ut){"use strict";var Ua=Object.defineProperty;var qa=(P,c,s)=>c in P?Ua(P,c,{enumerable:!0,configurable:!0,writable:!0,value:s}):P[c]=s;var h=(P,c,s)=>qa(P,typeof c!="symbol"?c+"":c,s);const qt={id:"formula.command.insert-function",type:c.CommandType.COMMAND,handler:async(r,e)=>{const{list:a,listOfRangeHasNumber:n}=e,i=r.get(c.ICommandService),o=new c.ObjectMatrix;a.forEach(f=>{const{range:m,primary:l,formula:p}=f,{row:L,column:N}=l,T=c.generateRandomId(6);o.setValue(L,N,{f:p,si:T});const{startRow:A,startColumn:C,endRow:R,endColumn:d}=m;for(let S=A;S<=R;S++)for(let E=C;E<=d;E++)(S!==L||E!==N)&&o.setValue(S,E,{si:T})}),n&&n.length>0&&n.forEach(f=>{const{primary:m,formula:l}=f;o.setValue(m.row,m.column,{f:l})});const u={value:o.getData()};return i.executeCommand(s.SetRangeValuesCommand.id,u)}},ht={id:"sheets-formula.command.quick-sum",type:c.CommandType.COMMAND,handler:async r=>{const a=r.get(s.SheetsSelectionsService).getCurrentLastSelection();if(!a)return!1;const n=r.get(c.IUniverInstanceService),i=s.getSheetCommandTarget(n);if(!i)return!1;const o=a.range,{worksheet:u}=i;let f=s.findFirstNonEmptyCell(o,u);if(!f)return!1;f=s.alignToMergedCellsBorders(f,u);const m=s.expandToContinuousRange({startRow:f.startRow,startColumn:f.startColumn,endRow:o.endRow,endColumn:o.endColumn},{left:!0,right:!0,up:!0,down:!0},u),l=new c.ObjectMatrix,p=s.alignToMergedCellsBorders({startRow:m.endRow,endRow:m.endRow,startColumn:m.startColumn,endColumn:m.endColumn},u);if(!c.Rectangle.equals(p,m))for(const T of u.iterateByColumn(p))(!T.value||!u.cellHasValue(T.value))&&l.setValue(T.row,T.col,{f:`=SUM(${t.serializeRange({startColumn:T.col,endColumn:T.col,startRow:m.startRow,endRow:T.row-1})})`});const L=s.alignToMergedCellsBorders({startRow:m.startRow,startColumn:m.endColumn,endRow:m.endRow,endColumn:m.endColumn},u);if(!c.Rectangle.equals(L,m))for(const T of u.iterateByRow(L))(!T.value||!u.cellHasValue(T.value))&&l.setValue(T.row,T.col,{f:`=SUM(${t.serializeRange({startColumn:m.startColumn,endColumn:T.col-1,startRow:T.row,endRow:T.row})})`});const N=r.get(c.ICommandService);return(await c.sequenceExecuteAsync([{id:s.SetRangeValuesCommand.id,params:{range:m,value:l.getMatrix()}},{id:s.SetSelectionsOperation.id,params:{unitId:i.unitId,subUnitId:i.subUnitId,selections:[{range:m,primary:c.Rectangle.contains(m,a.primary)?a.primary:{...f,actualRow:f.startRow,actualColumn:f.startColumn},style:null}]}}],N)).result}},z={type:c.CommandType.MUTATION,id:"sheet.mutation.data-validation-formula-mark-dirty",handler(){return!0}},Z="sheets-formula.base.config";var X=(r=>(r[r.FORCED=0]="FORCED",r[r.WHEN_EMPTY=1]="WHEN_EMPTY",r[r.NO_CALCULATION=2]="NO_CALCULATION",r))(X||{});const Ft={},Kt="sheets-formula.remote.config",Bt={};var kt=Object.getOwnPropertyDescriptor,Qt=(r,e,a,n)=>{for(var i=n>1?void 0:n?kt(e,a):e,o=r.length-1,u;o>=0;o--)(u=r[o])&&(i=u(i)||i);return i},St=(r,e)=>(a,n)=>e(a,n,r);P.ImageFormulaCellInterceptorController=class extends c.Disposable{constructor(a,n,i){super();h(this,"_errorValueCell",{v:t.ErrorType.VALUE,t:c.CellValueType.STRING});h(this,"_refreshRender");this._commandService=a,this._sheetInterceptorService=n,this._formulaDataModel=i,this._initialize()}_initialize(){this._commandExecutedListener(),this._initInterceptorCellContent()}_commandExecutedListener(){this.disposeWithMe(this._commandService.onCommandExecuted(async a=>{if(a.id===t.SetImageFormulaDataMutation.id){const n=a.params;if(!n)return;const{imageFormulaData:i}=n;if(!i||i.length===0)return;const o=await Promise.all(i.map(f=>this._getImageNatureSize(f))),u={};o.forEach(f=>{const{unitId:m,sheetId:l,row:p,column:L,...N}=f;u[m]||(u[m]={}),u[m][l]||(u[m][l]=new c.ObjectMatrix),u[m][l].setValue(p,L,N)}),this._formulaDataModel.mergeUnitImageFormulaData(u),this._refreshRender()}}))}_initInterceptorCellContent(){this.disposeWithMe(this._sheetInterceptorService.intercept(s.INTERCEPTOR_POINT.CELL_CONTENT,{priority:s.InterceptCellContentPriority.CELL_IMAGE,effect:c.InterceptorEffectEnum.Value|c.InterceptorEffectEnum.Style,handler:(a,n,i)=>{var D,U;const{unitId:o,subUnitId:u,row:f,col:m}=n,l=this._formulaDataModel.getUnitImageFormulaData(),p=(U=(D=l==null?void 0:l[o])==null?void 0:D[u])==null?void 0:U.getValue(f,m);if(!p)return i(a);const{source:L,height:N,width:T,isErrorImage:A,imageNaturalWidth:C,imageNaturalHeight:R}=p;if(A)return i(this._errorValueCell);const d=T||C,S=N||R,E=c.createDocumentModelWithStyle("",{}),I={unitId:o,subUnitId:u,drawingId:c.generateRandomId(),drawingType:c.DrawingTypeEnum.DRAWING_IMAGE,imageSourceType:c.ImageSourceType.URL,source:L,transform:{left:0,top:0,width:d,height:S},docTransform:{size:{width:d,height:S},positionH:{relativeFrom:c.ObjectRelativeFromH.PAGE,posOffset:0},positionV:{relativeFrom:c.ObjectRelativeFromV.PARAGRAPH,posOffset:0},angle:0},behindDoc:c.BooleanNumber.FALSE,title:"",description:"",layoutType:c.PositionedObjectLayoutType.INLINE,wrapText:c.WrapTextType.BOTH_SIDES,distB:0,distL:0,distR:0,distT:0},O=c.BuildTextUtils.drawing.add({documentDataModel:E,drawings:[I],selection:{collapsed:!0,startOffset:0,endOffset:0}});return O?(E.apply(O),i({...a,p:E.getSnapshot()})):i(this._errorValueCell)}}))}async _getImageNatureSize(a){const n=await this._getImageSize(a.source);return n.image?{...a,isErrorImage:!1,imageNaturalHeight:n.height,imageNaturalWidth:n.width}:{...a,isErrorImage:!0}}async _getImageSize(a){return new Promise(n=>{const i=new Image;i.src=a,i.onload=()=>{n({width:i.width,height:i.height,image:i})},i.onerror=()=>{n({width:0,height:0,image:null})}})}registerRefreshRenderFunction(a){this._refreshRender=a}},P.ImageFormulaCellInterceptorController=Qt([St(0,c.ICommandService),St(1,c.Inject(s.SheetInterceptorService)),St(2,c.Inject(t.FormulaDataModel))],P.ImageFormulaCellInterceptorController);var J=(r=>(r[r.NOT_REGISTER=1]="NOT_REGISTER",r[r.SUCCESS=2]="SUCCESS",r[r.WAIT=3]="WAIT",r[r.ERROR=4]="ERROR",r))(J||{}),jt=Object.getOwnPropertyDescriptor,$t=(r,e,a,n)=>{for(var i=n>1?void 0:n?jt(e,a):e,o=r.length-1,u;o>=0;o--)(u=r[o])&&(i=u(i)||i);return i},Ct=(r,e)=>(a,n)=>e(a,n,r);P.RegisterOtherFormulaService=class extends c.Disposable{constructor(a,n,i){super();h(this,"_formulaCacheMap",new Map);h(this,"_formulaChangeWithRange$",new Y.Subject);h(this,"formulaChangeWithRange$",this._formulaChangeWithRange$.asObservable());h(this,"_formulaResult$",new Y.Subject);h(this,"formulaResult$",this._formulaResult$.asObservable());h(this,"calculateStarted$",new Y.BehaviorSubject(!1));this._commandService=a,this._activeDirtyManagerService=n,this._lifecycleService=i,this._initFormulaRegister(),this._initFormulaCalculationResultChange()}dispose(){super.dispose(),this._formulaChangeWithRange$.complete(),this._formulaResult$.complete(),this.calculateStarted$.complete()}_ensureCacheMap(a,n){let i=this._formulaCacheMap.get(a);i||(i=new Map,this._formulaCacheMap.set(a,i));let o=i.get(n);return o||(o=new Map,i.set(n,o)),o}_createFormulaId(a,n){return`formula.${a}_${n}_${c.generateRandomId(8)}`}_initFormulaRegister(){this._activeDirtyManagerService.register(z.id,{commandId:z.id,getDirtyData(n){return{dirtyUnitOtherFormulaMap:n.params}}});const a=n=>{const{unitId:i,subUnitId:o,formulaText:u,formulaId:f,ranges:m}=n;if(!this._ensureCacheMap(i,o).has(f))return;const p={unitId:i,subUnitId:o,formulaMap:{[f]:{f:u,ranges:m}}};this._commandService.executeCommand(t.SetOtherFormulaMutation.id,p).then(()=>{this._commandService.executeCommand(z.id,{[i]:{[o]:{[f]:!0}}})})};this.disposeWithMe(this._formulaChangeWithRange$.pipe(Y.bufferWhen(()=>this.calculateStarted$.pipe(Y.filter(n=>n)))).subscribe(n=>n.forEach(a))),this.disposeWithMe(this._formulaChangeWithRange$.pipe(Y.filter(()=>this.calculateStarted$.getValue())).subscribe(a))}_initFormulaCalculationResultChange(){this.disposeWithMe(this._commandService.onCommandExecuted(a=>{if(a.id===t.SetFormulaCalculationResultMutation.id){const n=a.params,{unitOtherData:i}=n,o={};for(const u in i){const f=i[u],m={};o[u]=m;for(const l in f){const p=this._ensureCacheMap(u,l),L=f[l],N=[];m[l]=N;for(const T in L){const A=L[T];if(p.has(T)){const C=p.get(T);if(!C)continue;C.result||(C.result={});const R=new c.ObjectMatrix(A),d=new c.ObjectMatrix(C.result);R.forValue((S,E,I)=>{d.setValue(S,E,I)}),C.status=J.SUCCESS,C.callbacks.forEach(S=>{S(A)}),C.callbacks.clear(),N.push(C)}}}}this._formulaResult$.next(o)}}))}registerFormulaWithRange(a,n,i,o=[{startRow:0,endRow:0,startColumn:0,endColumn:0}],u){const f=this._createFormulaId(a,n);return this._ensureCacheMap(a,n).set(f,{result:void 0,status:J.WAIT,formulaId:f,callbacks:new Set,extra:u}),this._formulaChangeWithRange$.next({unitId:a,subUnitId:n,formulaText:i,formulaId:f,ranges:o}),f}deleteFormula(a,n,i){const o={unitId:a,subUnitId:n,formulaIdList:i};this._commandService.executeCommand(t.RemoveOtherFormulaMutation.id,o);const u=this._ensureCacheMap(a,n);i.forEach(f=>u.delete(f))}getFormulaValue(a,n,i){const o=this._ensureCacheMap(a,n),u=o.get(i);return u?u.status===J.SUCCESS||u.status===J.ERROR?Promise.resolve(u):new Promise(f=>{u.callbacks.add(()=>{f(o.get(i))})}):Promise.resolve(null)}getFormulaValueSync(a,n,i){return this._ensureCacheMap(a,n).get(i)}markFormulaDirty(a,n,i){const o=this.getFormulaValueSync(a,n,i);o&&(o.status=J.WAIT,this._commandService.executeCommand(z.id,{[a]:{[n]:{[i]:!0}}}))}},P.RegisterOtherFormulaService=$t([Ct(0,c.ICommandService),Ct(1,t.IActiveDirtyManagerService),Ct(2,c.Inject(c.LifecycleService))],P.RegisterOtherFormulaService);var zt=Object.getOwnPropertyDescriptor,Zt=(r,e,a,n)=>{for(var i=n>1?void 0:n?zt(e,a):e,o=r.length-1,u;o>=0;o--)(u=r[o])&&(i=u(i)||i);return i},W=(r,e)=>(a,n)=>e(a,n,r);const vt={done:0,count:0},Rt={onlyLocal:!0};P.TriggerCalculationController=class extends c.Disposable{constructor(a,n,i,o,u,f,m){super();h(this,"_waitingCommandQueue",[]);h(this,"_executingDirtyData",{forceCalculation:!1,dirtyRanges:[],dirtyNameMap:{},dirtyDefinedNameMap:{},dirtyUnitFeatureMap:{},dirtyUnitOtherFormulaMap:{},clearDependencyTreeCache:{}});h(this,"_setTimeoutKey",-1);h(this,"_startExecutionTime",0);h(this,"_totalCalculationTaskCount",0);h(this,"_doneCalculationTaskCount",0);h(this,"_executionInProgressParams",null);h(this,"_restartCalculation",!1);h(this,"_forceCalculating",!1);h(this,"_progress$",new Y.BehaviorSubject(vt));h(this,"progress$",this._progress$.asObservable());this._commandService=a,this._activeDirtyManagerService=n,this._logService=i,this._configService=o,this._formulaDataModel=u,this._localeService=f,this._registerOtherFormulaService=m,this._commandExecutedListener(),this._initialExecuteFormulaProcessListener(),this._initialExecuteFormula()}_emitProgress(a){this._progress$.next({done:this._doneCalculationTaskCount,count:this._totalCalculationTaskCount,label:a})}_startProgress(){this._doneCalculationTaskCount=0,this._totalCalculationTaskCount=1;const a=this._localeService.t("formula.progress.analyzing");this._emitProgress(a)}_calculateProgress(a){if(this._executionInProgressParams){const{totalFormulasToCalculate:n,completedFormulasCount:i,totalArrayFormulasToCalculate:o,completedArrayFormulasCount:u}=this._executionInProgressParams;if(this._doneCalculationTaskCount=i+u,this._totalCalculationTaskCount=n+o,this._totalCalculationTaskCount===0)return;this._emitProgress(a)}}_completeProgress(){this._doneCalculationTaskCount=this._totalCalculationTaskCount=1;const a=this._localeService.t("formula.progress.done");this._emitProgress(a)}clearProgress(){this._doneCalculationTaskCount=0,this._totalCalculationTaskCount=0,this._emitProgress()}dispose(){super.dispose(),this._progress$.next(vt),this._progress$.complete(),clearTimeout(this._setTimeoutKey)}_getCalculationMode(){var n;const a=this._configService.getConfig(Z);return(n=a==null?void 0:a.initialFormulaComputing)!=null?n:X.WHEN_EMPTY}_commandExecutedListener(){this.disposeWithMe(this._commandService.beforeCommandExecuted(a=>{if(a.id===t.SetFormulaCalculationStartMutation.id){const n=a.params;n.rowData=this._formulaDataModel.getHiddenRowsFiltered()}})),this.disposeWithMe(this._commandService.onCommandExecuted((a,n)=>{if(this._activeDirtyManagerService.get(a.id)){if(a.id===s.SetRangeValuesMutation.id){const i=a.params;if(n&&n.onlyLocal===!0||i.trigger===s.SetStyleCommand.id||i.trigger===s.SetBorderCommand.id||i.trigger===s.ClearSelectionFormatCommand.id)return}this._waitingCommandQueue.push(a),clearTimeout(this._setTimeoutKey),this._setTimeoutKey=setTimeout(()=>{const i=this._generateDirty(this._waitingCommandQueue);this._executingDirtyData=this._mergeDirty(this._executingDirtyData,i),this._executionInProgressParams==null?this._commandService.executeCommand(t.SetFormulaCalculationStartMutation.id,{...this._executingDirtyData},Rt):(this._restartCalculation=!0,this._commandService.executeCommand(t.SetFormulaCalculationStopMutation.id,{})),this._waitingCommandQueue=[]},100)}}))}_generateDirty(a){const n=[],i={},o={},u={},f={},m={};for(const l of a){const p=this._activeDirtyManagerService.get(l.id);if(p==null)continue;const L=p.getDirtyData(l),{dirtyRanges:N,dirtyNameMap:T,dirtyDefinedNameMap:A,dirtyUnitFeatureMap:C,dirtyUnitOtherFormulaMap:R,clearDependencyTreeCache:d}=L;N!=null&&this._mergeDirtyRanges(n,N),T!=null&&this._mergeDirtyNameMap(i,T),A!=null&&this._mergeDirtyNameMap(o,A),C!=null&&this._mergeDirtyUnitFeatureOrOtherFormulaMap(u,C),R!=null&&this._mergeDirtyUnitFeatureOrOtherFormulaMap(f,R),d!=null&&this._mergeDirtyNameMap(m,d)}return{dirtyRanges:n,dirtyNameMap:i,dirtyDefinedNameMap:o,dirtyUnitFeatureMap:u,dirtyUnitOtherFormulaMap:f,forceCalculation:!1,clearDependencyTreeCache:m,maxIteration:this._configService.getConfig(t.ENGINE_FORMULA_CYCLE_REFERENCE_COUNT)}}_mergeDirty(a,n){const i=[...a.dirtyRanges,...n.dirtyRanges],o={...a.dirtyNameMap},u={...a.dirtyDefinedNameMap},f={...a.dirtyUnitFeatureMap},m={...a.dirtyUnitOtherFormulaMap},l={...a.clearDependencyTreeCache};this._mergeDirtyNameMap(o,n.dirtyNameMap),this._mergeDirtyNameMap(u,n.dirtyDefinedNameMap),this._mergeDirtyUnitFeatureOrOtherFormulaMap(f,n.dirtyUnitFeatureMap),this._mergeDirtyUnitFeatureOrOtherFormulaMap(m,n.dirtyUnitOtherFormulaMap),this._mergeDirtyNameMap(l,n.clearDependencyTreeCache);const p=a.maxIteration||n.maxIteration;return{dirtyRanges:i,dirtyNameMap:o,dirtyDefinedNameMap:u,dirtyUnitFeatureMap:f,dirtyUnitOtherFormulaMap:m,forceCalculation:!!this._forceCalculating,clearDependencyTreeCache:l,maxIteration:p}}_mergeDirtyRanges(a,n){for(const i of n){let o=!1;for(const u of a)if(i.unitId===u.unitId&&i.sheetId===u.sheetId){const{startRow:f,startColumn:m,endRow:l,endColumn:p}=i.range,{startRow:L,startColumn:N,endRow:T,endColumn:A}=u.range;if(f===L&&m===N&&l===T&&p===A){o=!0;break}}o||a.push(i)}}_mergeDirtyNameMap(a,n){Object.keys(n).forEach(i=>{a[i]==null&&(a[i]={}),Object.keys(n[i]).forEach(o=>{var u;(u=n[i])!=null&&u[o]&&(a[i][o]=n[i][o])})})}_mergeDirtyUnitFeatureOrOtherFormulaMap(a,n){Object.keys(n).forEach(i=>{a[i]==null&&(a[i]={}),Object.keys(n[i]).forEach(o=>{a[i][o]==null&&(a[i][o]={}),Object.keys(n[i][o]).forEach(u=>{a[i][o][u]=n[i][o][u]||!1})})})}_initialExecuteFormulaProcessListener(){let a=null,n=0;this.disposeWithMe(this._commandService.onCommandExecuted(i=>{if(i.id===t.SetFormulaCalculationStartMutation.id){const{forceCalculation:u=!1}=i.params;u&&(this._forceCalculating=!0)}else i.id===t.SetFormulaCalculationStopMutation.id&&this.clearProgress();if(i.id!==t.SetFormulaCalculationNotificationMutation.id)return;const o=i.params;if(o.stageInfo!=null){const{stage:u}=o.stageInfo;if(u===t.FormulaExecuteStageType.START)n===0&&(this._startExecutionTime=performance.now()),n++,a!==null&&(clearTimeout(a),a=null),a=setTimeout(()=>{a=null,this._startProgress()},1e3);else if(u===t.FormulaExecuteStageType.CURRENTLY_CALCULATING){if(this._executionInProgressParams=o.stageInfo,a===null){const f=this._localeService.t("formula.progress.calculating");this._calculateProgress(f)}}else if(u===t.FormulaExecuteStageType.START_DEPENDENCY_ARRAY_FORMULA){if(this._executionInProgressParams=o.stageInfo,a===null){const f=this._localeService.t("formula.progress.array-analysis");this._calculateProgress(f)}}else if(u===t.FormulaExecuteStageType.CURRENTLY_CALCULATING_ARRAY_FORMULA&&(this._executionInProgressParams=o.stageInfo,a===null)){const f=this._localeService.t("formula.progress.array-calculation");this._calculateProgress(f)}}else{const u=o.functionsExecutedState;let f="";switch(n--,u){case t.FormulaExecutedStateType.NOT_EXECUTED:f="No tasks are being executed anymore",this._resetExecutingDirtyData();break;case t.FormulaExecutedStateType.STOP_EXECUTION:f="The execution of the formula has been stopped",n=0;break;case t.FormulaExecutedStateType.SUCCESS:f="Formula calculation succeeded",(n===0||n===-1)&&(f+=`. Total time consumed: ${performance.now()-this._startExecutionTime} ms`),this._resetExecutingDirtyData();break;case t.FormulaExecutedStateType.INITIAL:f="Waiting for calculation",this._resetExecutingDirtyData();break}(n===0||n===-1)&&(a?(clearTimeout(a),a=null,this.clearProgress()):this._completeProgress(),n=0,this._doneCalculationTaskCount=0,this._totalCalculationTaskCount=0,this._forceCalculating=!1),u===t.FormulaExecutedStateType.STOP_EXECUTION&&this._restartCalculation?(this._restartCalculation=!1,this._commandService.executeCommand(t.SetFormulaCalculationStartMutation.id,{...this._executingDirtyData},Rt)):this._executionInProgressParams=null,this._logService.debug("[TriggerCalculationController]",f)}}))}_resetExecutingDirtyData(){this._executingDirtyData={dirtyRanges:[],dirtyNameMap:{},dirtyDefinedNameMap:{},dirtyUnitFeatureMap:{},dirtyUnitOtherFormulaMap:{},forceCalculation:!1,clearDependencyTreeCache:{}}}_initialExecuteFormula(){const a=this._getCalculationMode(),n=this._getDirtyDataByCalculationMode(a);this._commandService.executeCommand(t.SetFormulaCalculationStartMutation.id,n,Rt),this._registerOtherFormulaService.calculateStarted$.next(!0)}_getDirtyDataByCalculationMode(a){const n=a===X.FORCED,i=a===X.WHEN_EMPTY?this._formulaDataModel.getFormulaDirtyRanges():[];return{forceCalculation:n,dirtyRanges:i,dirtyNameMap:{},dirtyDefinedNameMap:{},dirtyUnitFeatureMap:{},dirtyUnitOtherFormulaMap:{},clearDependencyTreeCache:{},maxIteration:this._configService.getConfig(t.ENGINE_FORMULA_CYCLE_REFERENCE_COUNT)}}},P.TriggerCalculationController=Zt([W(0,c.ICommandService),W(1,t.IActiveDirtyManagerService),W(2,c.ILogService),W(3,c.IConfigService),W(4,c.Inject(t.FormulaDataModel)),W(5,c.Inject(c.LocaleService)),W(6,c.Inject(P.RegisterOtherFormulaService))],P.TriggerCalculationController);function Jt(r,e,a){var n;return r==null||r[e]==null||((n=r[e])==null?void 0:n[a])==null}function Ot(r,e,a){var n;if(a){if(r&&r[e]&&((n=r[e])!=null&&n[a]))return delete r[e][a],{[e]:{[a]:null}}}else if(r&&r[e])return delete r[e],{[e]:null}}var b=(r=>(r[r.MoveRange=0]="MoveRange",r[r.MoveRows=1]="MoveRows",r[r.MoveCols=2]="MoveCols",r[r.InsertRow=3]="InsertRow",r[r.InsertColumn=4]="InsertColumn",r[r.RemoveRow=5]="RemoveRow",r[r.RemoveColumn=6]="RemoveColumn",r[r.DeleteMoveLeft=7]="DeleteMoveLeft",r[r.DeleteMoveUp=8]="DeleteMoveUp",r[r.InsertMoveDown=9]="InsertMoveDown",r[r.InsertMoveRight=10]="InsertMoveRight",r[r.SetName=11]="SetName",r[r.RemoveSheet=12]="RemoveSheet",r[r.SetDefinedName=13]="SetDefinedName",r[r.RemoveDefinedName=14]="RemoveDefinedName",r))(b||{});const te=[11,12,13,14];function ee(r,e,a){const{type:n}=a;return te.includes(n)?ae(r,e):ne(r,e,a)}function ae(r,e){const a=[],n=[];return Object.keys(e).forEach(i=>{const o=e[i],u=r[i];if(o==null||u==null)return!0;Object.keys(o).forEach(f=>{const m=new c.ObjectMatrix(o[f]||{}),l=new c.ObjectMatrix(u[f]||{}),p=new c.ObjectMatrix,L=new c.ObjectMatrix;if(m.forValue((R,d,S)=>{if(S==null)return!0;const E=nt(S);E!==null&&(p.setValue(R,d,E),L.setValue(R,d,l.getValue(R,d)))}),p.getSizeOf()===0)return;const N={subUnitId:f,unitId:i,cellValue:p.getMatrix()},T={id:s.SetRangeValuesMutation.id,params:N};n.push(T);const A={subUnitId:f,unitId:i,cellValue:L.getMatrix()},C={id:s.SetRangeValuesMutation.id,params:A};a.push(C)})}),{undos:a,redos:n}}function ne(r,e,a){const{redoFormulaData:n,undoFormulaData:i}=ie(r,e,a),o=[],u=[];return Object.keys(n).forEach(f=>{Object.keys(n[f]).forEach(m=>{if(Object.keys(n[f][m]).length!==0){const l={subUnitId:m,unitId:f,cellValue:n[f][m]},p={id:s.SetRangeValuesMutation.id,params:l};o.push(p)}})}),Object.keys(i).forEach(f=>{Object.keys(i[f]).forEach(m=>{if(Object.keys(i[f][m]).length!==0){const l={subUnitId:m,unitId:f,cellValue:i[f][m]},p={id:s.SetRangeValuesMutation.id,params:l};u.push(p)}})}),{undos:u,redos:o}}function ie(r,e,a){const n={},i={},{unitId:o,sheetId:u}=a;return new Set([...Object.keys(r),...Object.keys(e)]).forEach(m=>{if(Jt(r,m,u))return;new Set([...Object.keys(r[m]||{}),...Object.keys(e[m]||{})]).forEach(p=>{var S,E;const L=(S=r[m])==null?void 0:S[p],N=(E=e[m])==null?void 0:E[p],T=new c.ObjectMatrix(L||{}),A=new c.ObjectMatrix(N||{});let C=[];m!==o||p!==u?C=oe(A):C=re(T,A,a);const R=Ie(C,T,A),d=Ae(C,T);n[m]||(n[m]={}),i[m]||(i[m]={}),n[m][p]={...n[m][p],...R},i[m][p]={...i[m][p],...d}})}),{redoFormulaData:n,undoFormulaData:i}}function re(r,e,a){const{type:n,from:i,to:o,range:u}=a,f=[];return r.forValue((m,l,p)=>{if(p==null||!Vt(p))return!0;const L=c.cellToRange(m,l);let N=null,T=!1;if([0,1,2].includes(n))N=ue(n,i,o,L);else if(u!=null){const A=ce(L,a);N=A.newCell,T=A.isReverse}if(c.Tools.diffValue(L,N)&&!e.getValue(m,l))return!0;T?f.unshift({oldCell:L,newCell:N}):f.push({oldCell:L,newCell:N})}),f}function oe(r){const e=[];return r.forValue((a,n,i)=>{if(i==null||!Vt(i))return!0;const o=c.cellToRange(a,n);e.push({oldCell:o,newCell:o})}),e}function ue(r,e,a,n){if(e==null||a==null)return null;switch(r){case 0:return fe(e,a,n);case 1:return me(e,a,n);case 2:return se(e,a,n);default:return null}}function ce(r,e){const{type:a,rangeFilteredRows:n}=e,i=e.range;let o=null,u=!1;switch(a){case 3:o=le(i,r),u=!0;break;case 4:o=pe(i,r),u=!0;break;case 5:o=de(i,r,n);break;case 6:o=Le(i,r);break;case 7:o=Te(i,r);break;case 8:o=Ne(i,r);break;case 9:o=Pe(i,r),u=!0;break;case 10:o=Ee(i,r),u=!0;break}return{newCell:o,isReverse:u}}function fe(r,e,a){const n=s.handleMoveRange({id:s.EffectRefRangId.MoveRangeCommandId,params:{toRange:e,fromRange:r}},a);return s.runRefRangeMutations(n,a)}function me(r,e,a){const n=s.handleMoveRows({id:s.EffectRefRangId.MoveRowsCommandId,params:{toRange:e,fromRange:r}},a);return s.runRefRangeMutations(n,a)}function se(r,e,a){const n=s.handleMoveCols({id:s.EffectRefRangId.MoveColsCommandId,params:{toRange:e,fromRange:r}},a);return s.runRefRangeMutations(n,a)}function le(r,e){const a=s.handleInsertRow({id:s.EffectRefRangId.InsertRowCommandId,params:{range:r,unitId:"",subUnitId:"",direction:c.Direction.DOWN}},e);return s.runRefRangeMutations(a,e)}function pe(r,e){const a=s.handleInsertCol({id:s.EffectRefRangId.InsertColCommandId,params:{range:r,unitId:"",subUnitId:"",direction:c.Direction.RIGHT}},e);return s.runRefRangeMutations(a,e)}function de(r,e,a){const n=s.handleIRemoveRow({id:s.EffectRefRangId.RemoveRowCommandId,params:{range:r}},e,a);return s.runRefRangeMutations(n,e)}function Le(r,e){const a=s.handleIRemoveCol({id:s.EffectRefRangId.RemoveColCommandId,params:{range:r}},e);return s.runRefRangeMutations(a,e)}function Te(r,e){const a=s.handleDeleteRangeMoveLeft({id:s.EffectRefRangId.DeleteRangeMoveLeftCommandId,params:{range:r}},e);return s.runRefRangeMutations(a,e)}function Ne(r,e){const a=s.handleDeleteRangeMoveUp({id:s.EffectRefRangId.DeleteRangeMoveUpCommandId,params:{range:r}},e);return s.runRefRangeMutations(a,e)}function Pe(r,e){const a=s.handleInsertRangeMoveDown({id:s.EffectRefRangId.InsertRangeMoveDownCommandId,params:{range:r}},e);return s.runRefRangeMutations(a,e)}function Ee(r,e){const a=s.handleInsertRangeMoveRight({id:s.EffectRefRangId.InsertRangeMoveRightCommandId,params:{range:r}},e);return s.runRefRangeMutations(a,e)}function Ie(r,e,a){var i,o,u;const n=new c.ObjectMatrix({});for(let f=0;f<r.length;f++){const{oldCell:m,newCell:l}=r[f];if((i=n.getValue(m.startRow,m.startColumn))!=null&&i.f||(o=n.getValue(m.startRow,m.startColumn))!=null&&o.si||n.setValue(m.startRow,m.startColumn,{f:null,si:null}),l){const p=(u=a.getValue(m.startRow,m.startColumn))!=null?u:e.getValue(m.startRow,m.startColumn),L=nt(p);n.setValue(l.startRow,l.startColumn,L)}}return n.getMatrix()}function Ae(r,e){const a=new c.ObjectMatrix({});for(let n=r.length-1;n>=0;n--){const{oldCell:i,newCell:o}=r[n],u=e.getValue(i.startRow,i.startColumn),f=nt(u);if(a.setValue(i.startRow,i.startColumn,f),o){const m=e.getValue(o.startRow,o.startColumn),l=nt(m);a.setValue(o.startRow,o.startColumn,l!=null?l:{f:null,si:null})}}return a.getMatrix()}function nt(r){if(r==null)return null;const{f:e,si:a,x:n=0,y:i=0}=r,o=c.isFormulaString(e),u=c.isFormulaId(a);if(!o&&!u)return{f:null,si:null};const f={};return u&&(f.si=a),o&&n===0&&i===0&&(f.f=e),f.f===void 0&&(f.f=null),f.si===void 0&&(f.si=null),f}function Se(r){const e=new c.ObjectMatrix({});return new c.ObjectMatrix(r).forValue((n,i,o)=>{const u=nt(o);u!==void 0&&e.setValue(n,i,u)}),e.getMatrix()}function Vt(r){const e=(r==null?void 0:r.f)||"",a=(r==null?void 0:r.si)||"",n=c.isFormulaString(e),i=c.isFormulaId(a);return!!(n||i)}function Gt(r,e,a,n,i,o){if((i==null||i.length===0)&&(o==null||o.length===0)){if(r===a&&e===n)return!0}else if((r===i||i==null||i.length===0)&&e===o)return!0;return!1}function Ht(r,e,a=0,n=0){const i=[];for(let o=0,u=r.length;o<u;o++){const f=r[o];if(typeof f=="string"||f.nodeType!==t.sequenceNodeType.REFERENCE||e.includes(o)){i.push(f);continue}const{token:m}=f,l=t.deserializeRangeWithSheetWithCache(m),{range:p,sheetName:L,unitId:N}=l,T=c.Rectangle.moveOffset(p,a,n);i.push({...f,token:t.serializeRangeToRefString({range:T,unitId:N,sheetName:L})})}return i}function wt(r,e,a,n){const{type:i,unitId:o,sheetId:u,range:f,from:m,to:l,rangeFilteredRows:p}=e,{range:L,sheetId:N,unitId:T,sheetName:A,refOffsetX:C,refOffsetY:R}=r;if(!Gt(o,u,a,n,T,N))return;const d=c.Rectangle.moveOffset(L,C,R);let S=null;if(i===b.MoveRange){if(m==null||l==null)return;const E=Mt(d,m),I=c.getIntersectRange(d,m);if(I==null||E!==4)return;const O=s.handleMoveRange({id:s.EffectRefRangId.MoveRangeCommandId,params:{toRange:l,fromRange:m}},I),D=s.runRefRangeMutations(O,I);if(D==null)return t.ErrorType.REF;S=_t(E,D,m,l,d,I)}else if(i===b.MoveRows){if(m==null||l==null)return;const E=Mt(d,m);let I=c.getIntersectRange(d,m);if(I==null&&(m.endRow<d.startRow&&l.endRow<=d.startRow||m.startRow>d.endRow&&l.startRow>d.endRow))return;I==null&&(I={startRow:d.startRow,endRow:d.endRow,startColumn:d.startColumn,endColumn:d.endColumn,rangeType:c.RANGE_TYPE.NORMAL});const O=s.handleMoveRows({id:s.EffectRefRangId.MoveRowsCommandId,params:{toRange:l,fromRange:m}},I),D=s.runRefRangeMutations(O,I);if(D==null)return t.ErrorType.REF;S=_t(E,D,m,l,d,I)}else if(i===b.MoveCols){if(m==null||l==null)return;const E=Mt(d,m);let I=c.getIntersectRange(d,m);if(I==null&&(m.endColumn<d.startColumn&&l.endColumn<=d.startColumn||m.startColumn>d.endColumn&&l.startColumn>d.endColumn))return;I==null&&(I={startRow:d.startRow,endRow:d.endRow,startColumn:d.startColumn,endColumn:d.endColumn,rangeType:c.RANGE_TYPE.NORMAL});const O=s.handleMoveCols({id:s.EffectRefRangId.MoveColsCommandId,params:{toRange:l,fromRange:m}},I),D=s.runRefRangeMutations(O,I);if(D==null)return t.ErrorType.REF;S=_t(E,D,m,l,d,I)}if(f!=null){if(i===b.InsertRow){const E=s.handleInsertRow({id:s.EffectRefRangId.InsertRowCommandId,params:{range:f,unitId:"",subUnitId:"",direction:c.Direction.DOWN}},d),I=s.runRefRangeMutations(E,d);if(I==null)return;S={...d,...I}}else if(i===b.InsertColumn){const E=s.handleInsertCol({id:s.EffectRefRangId.InsertColCommandId,params:{range:f,unitId:"",subUnitId:"",direction:c.Direction.RIGHT}},d),I=s.runRefRangeMutations(E,d);if(I==null)return;S={...d,...I}}else if(i===b.RemoveRow){const E=s.handleIRemoveRow({id:s.EffectRefRangId.RemoveRowCommandId,params:{range:f}},d,p),I=s.runRefRangeMutations(E,d);if(I==null)return t.ErrorType.REF;S={...d,...I}}else if(i===b.RemoveColumn){const E=s.handleIRemoveCol({id:s.EffectRefRangId.RemoveColCommandId,params:{range:f}},d),I=s.runRefRangeMutations(E,d);if(I==null)return t.ErrorType.REF;S={...d,...I}}else if(i===b.DeleteMoveLeft){const E=s.handleDeleteRangeMoveLeft({id:s.EffectRefRangId.DeleteRangeMoveLeftCommandId,params:{range:f}},d),I=s.runRefRangeMutations(E,d);if(I==null)return t.ErrorType.REF;S={...d,...I}}else if(i===b.DeleteMoveUp){const E=s.handleDeleteRangeMoveUp({id:s.EffectRefRangId.DeleteRangeMoveUpCommandId,params:{range:f}},d),I=s.runRefRangeMutations(E,d);if(I==null)return t.ErrorType.REF;S={...d,...I}}else if(i===b.InsertMoveDown){const E=s.handleInsertRangeMoveDown({id:s.EffectRefRangId.InsertRangeMoveDownCommandId,params:{range:f}},d),I=s.runRefRangeMutations(E,d);if(I==null)return;S={...d,...I}}else if(i===b.InsertMoveRight){const E=s.handleInsertRangeMoveRight({id:s.EffectRefRangId.InsertRangeMoveRightCommandId,params:{range:f}},d),I=s.runRefRangeMutations(E,d);if(I==null)return;S={...d,...I}}}if(S!=null)return t.serializeRangeToRefString({range:S,sheetName:A,unitId:T})}function _t(r,e,a,n,i,o){const{startRow:u,endRow:f,startColumn:m,endColumn:l,rangeType:p}=it(e),{startRow:L,startColumn:N,endRow:T,endColumn:A,rangeType:C=c.RANGE_TYPE.NORMAL}=it(a),{startRow:R,startColumn:d,endRow:S,endColumn:E}=it(n),{startRow:I,endRow:O,startColumn:D,endColumn:U}=it(o),{startRow:M,endRow:x,startColumn:y,endColumn:q,rangeType:F=c.RANGE_TYPE.NORMAL}=it(i),_={...i};function B(){return p===c.RANGE_TYPE.COLUMN&&F===c.RANGE_TYPE.COLUMN?!0:m>=y&&l<=q}function k(){return p===c.RANGE_TYPE.ROW&&F===c.RANGE_TYPE.ROW?!0:u>=M&&f<=x}if(r===0)if(B())if(u<M)_.startRow=u;else if(u>=x)_.endRow-=T+1-M;else return;else return;else if(r===1)if(B())if(f>x)_.endRow=f;else if(f<=M)_.startRow+=x-L+1;else return;else return;else if(r===2)if(k())if(m<y)_.startColumn=m;else if(m>=q)_.endColumn-=A+1-y;else return;else return;else if(r===3)if(k())if(l>q)_.endColumn=l;else if(l<=y)_.startColumn+=q-N+1;else return;else return;else r===4?(_.startRow=u,_.startColumn=m,_.endRow=f,_.endColumn=l):N<=y&&A>=q||C===c.RANGE_TYPE.ROW&&F===c.RANGE_TYPE.ROW?a.endRow<M?(R>=M&&(_.startRow-=T-L+1),R>=x&&(_.endRow-=T-L+1)):a.startRow>x?(S<=x&&(_.endRow+=T-L+1),S<=M&&(_.startRow+=T-L+1)):a.startRow>=M&&a.endRow<=x&&(R<=M?_.startRow+=T-L+1:R>=x&&(_.endRow-=T-L+1)):L<=M&&T>=x||C===c.RANGE_TYPE.COLUMN&&F===c.RANGE_TYPE.COLUMN?a.endColumn<y?(d>=y&&(_.startColumn-=A-N+1),d>=q&&(_.endColumn-=A-N+1)):a.startColumn>q?(E<=q&&(_.endColumn+=A-N+1),E<=y&&(_.startColumn+=A-N+1)):a.startColumn>=y&&a.endColumn<=q&&(d<=y?_.startColumn+=A-N+1:d>=q&&(_.endColumn-=A-N+1)):((d<=U+1&&E>=q||d<=y&&E>=D-1)&&R<=M&&S>=x||(R<=O+1&&S>=x||R<=M&&S>=I-1)&&d<=y&&E>=q,_.startRow=u,_.startColumn=m,_.endRow=f,_.endColumn=l);return _}function Mt(r,e){const a=tt(r.startRow),n=et(r.endRow),i=tt(r.startColumn),o=et(r.endColumn),u=tt(e.startRow),f=et(e.endRow),m=tt(e.startColumn),l=et(e.endColumn);function p(){return r.rangeType===c.RANGE_TYPE.COLUMN&&e.rangeType===c.RANGE_TYPE.COLUMN?!0:a>=u&&n<=f}function L(){return r.rangeType===c.RANGE_TYPE.ROW&&e.rangeType===c.RANGE_TYPE.ROW?!0:i>=m&&o<=l}function N(){return r.rangeType===c.RANGE_TYPE.ALL&&e.rangeType===c.RANGE_TYPE.ALL}return p()&&L()||N()?4:L()&&a>=u&&a<=f&&n>f?0:L()&&n>=u&&n<=f&&a<u?1:p()&&i>=m&&i<=l&&o>l?2:p()&&o>=m&&o<=l&&i<m?3:null}function tt(r){return isNaN(r)?-1/0:r}function et(r){return isNaN(r)?1/0:r}function it(r){const{startRow:e,endRow:a,startColumn:n,endColumn:i}=r;return{...r,startRow:tt(e),endRow:et(a),startColumn:tt(n),endColumn:et(i)}}function Yt(r,e){const{id:a}=e;let n=null;switch(a){case s.MoveRangeCommand.id:n=Ce(e,r);break;case s.MoveRowsCommand.id:n=Re(e,r);break;case s.MoveColsCommand.id:n=Oe(e,r);break;case s.InsertRowCommand.id:n=_e(e);break;case s.InsertColCommand.id:n=Me(e);break;case s.InsertRangeMoveRightCommand.id:n=De(e,r);break;case s.InsertRangeMoveDownCommand.id:n=be(e,r);break;case s.RemoveRowCommand.id:n=ye(e,r);break;case s.RemoveColCommand.id:n=xe(e,r);break;case s.DeleteRangeMoveUpCommand.id:n=Ue(e,r);break;case s.DeleteRangeMoveLeftCommand.id:n=qe(e,r);break;case s.SetWorksheetNameCommand.id:n=he(e,r);break;case s.RemoveSheetCommand.id:n=Fe(e,r);break;case s.SetDefinedNameCommand.id:n=Be(e,r);break;case s.RemoveDefinedNameCommand.id:n=ve(e,r);break}return n}function v(r){var n;const e=r.getUnitId(),a=((n=r.getActiveSheet())==null?void 0:n.getSheetId())||"";return{unitId:e,sheetId:a}}function Ce(r,e){const{params:a}=r;if(!a)return null;const{fromRange:n,toRange:i}=a;if(!n||!i)return null;const{unitId:o,sheetId:u}=v(e);return{type:b.MoveRange,from:n,to:i,unitId:o,sheetId:u}}function Re(r,e){const{params:a}=r;if(!a)return null;const{fromRange:{startRow:n,endRow:i},toRange:{startRow:o,endRow:u}}=a,f=e.getUnitId(),m=e.getActiveSheet();if(!m)return null;const l=m.getSheetId(),p={startRow:n,startColumn:0,endRow:i,endColumn:m.getColumnCount()-1,rangeType:c.RANGE_TYPE.ROW},L={startRow:o,startColumn:0,endRow:u,endColumn:m.getColumnCount()-1,rangeType:c.RANGE_TYPE.ROW};return{type:b.MoveRows,from:p,to:L,unitId:f,sheetId:l}}function Oe(r,e){const{params:a}=r;if(!a)return null;const{fromRange:{startColumn:n,endColumn:i},toRange:{startColumn:o,endColumn:u}}=a,f=e.getUnitId(),m=e.getActiveSheet();if(!m)return null;const l=m.getSheetId(),p={startRow:0,startColumn:n,endRow:m.getRowCount()-1,endColumn:i,rangeType:c.RANGE_TYPE.COLUMN},L={startRow:0,startColumn:o,endRow:m.getRowCount()-1,endColumn:u,rangeType:c.RANGE_TYPE.COLUMN};return{type:b.MoveCols,from:p,to:L,unitId:f,sheetId:l}}function _e(r){const{params:e}=r;if(!e)return null;const{range:a,unitId:n,subUnitId:i}=e;return{type:b.InsertRow,range:a,unitId:n,sheetId:i}}function Me(r){const{params:e}=r;if(!e)return null;const{range:a,unitId:n,subUnitId:i}=e;return{type:b.InsertColumn,range:a,unitId:n,sheetId:i}}function De(r,e){const{params:a}=r;if(!a)return null;const{range:n}=a,{unitId:i,sheetId:o}=v(e);return{type:b.InsertMoveRight,range:n,unitId:i,sheetId:o}}function be(r,e){const{params:a}=r;if(!a)return null;const{range:n}=a,{unitId:i,sheetId:o}=v(e);return{type:b.InsertMoveDown,range:n,unitId:i,sheetId:o}}function ye(r,e){var u,f;const{params:a}=r;if(!a)return null;const{range:n}=a,{unitId:i,sheetId:o}=v(e);return{type:b.RemoveRow,range:n,unitId:i,sheetId:o,rangeFilteredRows:(f=(u=e.getSheetBySheetId(o))==null?void 0:u.getRangeFilterRows(n))!=null?f:[]}}function xe(r,e){const{params:a}=r;if(!a)return null;const{range:n}=a,{unitId:i,sheetId:o}=v(e);return{type:b.RemoveColumn,range:n,unitId:i,sheetId:o}}function Ue(r,e){const{params:a}=r;if(!a)return null;const{range:n}=a,{unitId:i,sheetId:o}=v(e);return{type:b.DeleteMoveUp,range:n,unitId:i,sheetId:o}}function qe(r,e){const{params:a}=r;if(!a)return null;const{range:n}=a,{unitId:i,sheetId:o}=v(e);return{type:b.DeleteMoveLeft,range:n,unitId:i,sheetId:o}}function he(r,e){const{params:a}=r;if(!a)return null;const{unitId:n,subUnitId:i,name:o}=a,{unitId:u,sheetId:f}=v(e);return{type:b.SetName,unitId:n||u,sheetId:i||f,sheetName:o}}function Fe(r,e){const{params:a}=r;if(!a)return null;const{unitId:n,subUnitId:i}=a,{unitId:o,sheetId:u}=v(e);return{type:b.RemoveSheet,unitId:n||o,sheetId:i||u}}function Be(r,e){const{params:a}=r;if(!a)return null;const{unitId:n,name:i,id:o}=a,{sheetId:u}=v(e);return{type:b.SetDefinedName,unitId:n,sheetId:u,definedName:i,definedNameId:o}}function ve(r,e){const{params:a}=r;if(!a)return null;const{unitId:n,name:i,id:o}=a,{sheetId:u}=v(e);return{type:b.RemoveDefinedName,unitId:n,sheetId:u,definedName:i,definedNameId:o}}var Ve=Object.getOwnPropertyDescriptor,Ge=(r,e,a,n)=>{for(var i=n>1?void 0:n?Ve(e,a):e,o=r.length-1,u;o>=0;o--)(u=r[o])&&(i=u(i)||i);return i},ct=(r,e)=>(a,n)=>e(a,n,r);P.UpdateDefinedNameController=class extends c.Disposable{constructor(e,a,n,i){super(),this._definedNamesService=e,this._univerInstanceService=a,this._sheetInterceptorService=n,this._lexerTreeBuilder=i,this._initialize()}_initialize(){this._commandExecutedListener()}_commandExecutedListener(){this.disposeWithMe(this._sheetInterceptorService.interceptCommand({getMutations:e=>{if(e.id===s.SetDefinedNameCommand.id||e.id===s.RemoveDefinedNameCommand.id)return{redos:[],undos:[]};const a=this._univerInstanceService.getCurrentUnitForType(c.UniverInstanceType.UNIVER_SHEET);if(a==null)return{redos:[],undos:[]};const n=Yt(a,e);return n?this._getUpdateDefinedNameMutations(a,n):{redos:[],undos:[]}}}))}_getUpdateDefinedNameMutations(e,a){const{type:n,unitId:i,sheetId:o}=a,u=this._definedNamesService.getDefinedNameMap(i);if(!u)return{redos:[],undos:[]};const f=[],m=[];return Object.values(u).forEach(l=>{var d;const{formulaOrRefString:p}=l,L=this._lexerTreeBuilder.sequenceNodesBuilder(p);if(L==null)return!0;let N=!1;const T=[];for(let S=0,E=L.length;S<E;S++){const I=L[S];if(typeof I=="string"||I.nodeType!==t.sequenceNodeType.REFERENCE)continue;const{token:O}=I,D=t.deserializeRangeWithSheetWithCache(O),{range:U,sheetName:M,unitId:x}=D,y=((d=e.getSheetBySheetName(M))==null?void 0:d.getSheetId())||"",q={range:U,sheetId:y,unitId:x,sheetName:M,refOffsetX:0,refOffsetY:0};let F=null;if(n===b.RemoveSheet)F=this._removeSheet(l,i,o);else if(n===b.SetName){const{sheetId:_,sheetName:B}=a;if(B==null||y==null||y.length===0||_!==y)continue;F=t.serializeRangeToRefString({range:U,sheetName:B,unitId:x})}else F=wt(q,a,i,o);F!=null&&(L[S]={...I,token:F},N=!0,T.push(S))}if(!N)return!0;const A=t.generateStringWithSequence(Ht(L,T)),C={id:t.SetDefinedNameMutation.id,params:{unitId:i,...l,formulaOrRefString:A}};f.push(C);const R={id:t.SetDefinedNameMutation.id,params:{unitId:i,...l}};m.push(R)}),{redos:f,undos:m}}_removeSheet(e,a,n){var u;const{formulaOrRefString:i}=e;return((u=this._definedNamesService.getWorksheetByRef(a,i))==null?void 0:u.getSheetId())===n?t.ErrorType.REF:null}},P.UpdateDefinedNameController=Ge([ct(0,t.IDefinedNamesService),ct(1,c.IUniverInstanceService),ct(2,c.Inject(s.SheetInterceptorService)),ct(3,c.Inject(t.LexerTreeBuilder))],P.UpdateDefinedNameController);var He=Object.getOwnPropertyDescriptor,we=(r,e,a,n)=>{for(var i=n>1?void 0:n?He(e,a):e,o=r.length-1,u;o>=0;o--)(u=r[o])&&(i=u(i)||i);return i},g=(r,e)=>(a,n)=>e(a,n,r);P.UpdateFormulaController=class extends c.Disposable{constructor(e,a,n,i,o,u,f,m){super(),this._univerInstanceService=e,this._commandService=a,this._lexerTreeBuilder=n,this._formulaDataModel=i,this._sheetInterceptorService=o,this._definedNamesService=u,this._configService=f,this._injector=m,this._commandExecutedListener()}_commandExecutedListener(){this.disposeWithMe(this._sheetInterceptorService.interceptCommand({getMutations:e=>this._getUpdateFormula(e)})),this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(e.params)if(e.id===s.RemoveSheetMutation.id){const{subUnitId:a,unitId:n}=e.params;this._handleWorkbookDisposed(n,a)}else e.id===s.InsertSheetMutation.id&&this._handleInsertSheetMutation(e.params)})),this.disposeWithMe(this._commandService.beforeCommandExecuted((e,a)=>{if(e.id===s.SetRangeValuesMutation.id){const n=e.params;if(a&&a.onlyLocal===!0||a&&a.syncOnly===!0||n.trigger===s.SetStyleCommand.id||n.trigger===s.SetBorderCommand.id||n.trigger===s.ClearSelectionFormatCommand.id)return;this._handleSetRangeValuesMutation(n)}})),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitAdded$(c.UniverInstanceType.UNIVER_SHEET).subscribe(e=>this._handleWorkbookAdded(e))),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitDisposed$(c.UniverInstanceType.UNIVER_SHEET).pipe(Y.map(e=>e.getUnitId())).subscribe(e=>this._handleWorkbookDisposed(e)))}_handleSetRangeValuesMutation(e){const{subUnitId:a,unitId:n,cellValue:i}=e;if(i==null)return;const o=this._formulaDataModel.updateFormulaData(n,a,i);if(Object.keys(o).length===0)return;const u={[n]:{[a]:o}};this._commandService.executeCommand(s.SetRangeValuesMutation.id,{unitId:n,subUnitId:a,cellValue:Se(o)},{onlyLocal:!0,fromFormula:!0}),this._formulaDataModel.updateArrayFormulaCellData(n,a,i),this._formulaDataModel.updateArrayFormulaRange(n,a,i),this._formulaDataModel.updateImageFormulaData(n,a,i),this._commandService.executeCommand(t.SetFormulaDataMutation.id,{formulaData:u},{onlyLocal:!0}),this._commandService.executeCommand(t.SetArrayFormulaDataMutation.id,{arrayFormulaRange:this._formulaDataModel.getArrayFormulaRange(),arrayFormulaCellData:this._formulaDataModel.getArrayFormulaCellData()},{onlyLocal:!0,remove:!0})}_handleWorkbookDisposed(e,a){const n=this._formulaDataModel.getFormulaData(),i=Ot(n,e,a),o=this._formulaDataModel.getArrayFormulaRange(),u=Ot(o,e,a),f=this._formulaDataModel.getArrayFormulaCellData(),m=Ot(f,e,a);i&&this._commandService.executeCommand(t.SetFormulaDataMutation.id,{formulaData:i},{onlyLocal:!0}),u&&m&&this._commandService.executeCommand(t.SetArrayFormulaDataMutation.id,{arrayFormulaRange:o,arrayFormulaCellData:f},{onlyLocal:!0})}_handleInsertSheetMutation(e){const{sheet:a,unitId:n}=e,i=this._formulaDataModel.getFormulaData(),{id:o,cellData:u}=a,f=new c.ObjectMatrix(u),m=t.initSheetFormulaData(i,n,o,f);this._commandService.executeCommand(t.SetFormulaDataMutation.id,{formulaData:m},{onlyLocal:!0})}_handleWorkbookAdded(e){var l;const a={},n=e.getUnitId(),i={[n]:{}};e.getSheets().forEach(p=>{var A;const L=p.getCellMatrix(),N=p.getSheetId(),T=t.initSheetFormulaData(a,n,N,L);i[n][N]=(A=T[n])==null?void 0:A[N]}),this._commandService.executeCommand(t.SetFormulaDataMutation.id,{formulaData:i},{onlyLocal:!0});const u=this._configService.getConfig(Z),f=(l=u==null?void 0:u.initialFormulaComputing)!=null?l:X.WHEN_EMPTY,m=this._getDirtyDataByCalculationMode(f);this._commandService.executeCommand(t.SetFormulaCalculationStartMutation.id,m,{onlyLocal:!0})}_getDirtyDataByCalculationMode(e){const a=e===X.FORCED,n=e===X.WHEN_EMPTY?this._formulaDataModel.getFormulaDirtyRanges():[];return{forceCalculation:a,dirtyRanges:n,dirtyNameMap:{},dirtyDefinedNameMap:{},dirtyUnitFeatureMap:{},dirtyUnitOtherFormulaMap:{},clearDependencyTreeCache:{}}}_getUpdateFormula(e){const a=this._univerInstanceService.getCurrentUnitForType(c.UniverInstanceType.UNIVER_SHEET);if(!a)return{undos:[],redos:[]};const n=Yt(a,e);if(n){const{unitSheetNameMap:i}=this._formulaDataModel.getCalculateData(),o=this._formulaDataModel.getFormulaData(),{newFormulaData:u}=this._getFormulaReferenceMoveInfo(o,i,n),{undos:f,redos:m}=ee(o,u,n);return{undos:f,redos:m}}return{undos:[],redos:[]}}_getFormulaReferenceMoveInfo(e,a,n){if(!c.Tools.isDefine(e))return{newFormulaData:{},oldFormulaData:{}};const i=Object.keys(e);if(i.length===0)return{newFormulaData:{},oldFormulaData:{}};const o={},u={};for(const f of i){const m=e[f];if(m==null)continue;const l=Object.keys(m);c.Tools.isDefine(o[f])||(o[f]={}),c.Tools.isDefine(u[f])||(u[f]={});for(const p of l){const L=new c.ObjectMatrix(m[p]||{}),N=new c.ObjectMatrix,T=[];L.forValue((A,C,R)=>{var q;if(!R)return!0;const{f:d,x:S,y:E,si:I}=R,O=this._lexerTreeBuilder.sequenceNodesBuilder(d);if(O==null)return!0;let D=!1;const U=[],{type:M,from:x}=n;for(let F=0,_=O.length;F<_;F++){const B=O[F];if(typeof B=="string")continue;const{token:k,nodeType:Q}=B;if((M===b.SetDefinedName||M===b.RemoveDefinedName)&&(Q===t.sequenceNodeType.DEFINED_NAME||Q===t.sequenceNodeType.FUNCTION)){const{definedNameId:At,definedName:at}=n;if(At===void 0||at===void 0)continue;const $=this._definedNamesService.getValueById(f,At);if($==null||$.name!==k)continue;O[F]={...B,token:M===b.SetDefinedName?at:t.ErrorType.REF},D=!0,U.push(F);continue}else if(Q!==t.sequenceNodeType.REFERENCE)continue;const j=t.deserializeRangeWithSheetWithCache(k),{range:V,sheetName:H,unitId:w}=j,It=w==null||w.length===0?f:w,G=((q=a==null?void 0:a[It])==null?void 0:q[H])||"";if(!Gt(n.unitId,n.sheetId,f,p,w,G))continue;const Ut={range:V,sheetId:G,unitId:w,sheetName:H,refOffsetX:S||0,refOffsetY:E||0};let ot=null;if(M===b.SetName){const{unitId:At,sheetId:at,sheetName:$}=n;if($==null||G==null||G.length===0||at!==G)continue;ot=t.serializeRangeToRefString({range:V,sheetName:$,unitId:w})}else if(M===b.RemoveSheet){const{unitId:At,sheetId:at,sheetName:$}=n;if(G==null||G.length===0||at!==G)continue;ot=t.ErrorType.REF}else M!==b.SetDefinedName&&(ot=wt(Ut,n,f,p));ot!=null&&(O[F]={...B,token:ot},D=!0,U.push(F),I&&(S!=null?S:0)===0&&(E!=null?E:0)===0&&T.push(I))}if(!D)if(I&&[b.MoveRows,b.MoveCols,b.MoveRange].includes(M)){if(x&&x.startRow<=A&&A<=x.endRow&&x.startColumn<=C&&C<=x.endColumn)(S!=null?S:0)===0&&(E!=null?E:0)===0&&T.push(I);else if(!T.includes(I))return!0}else return!0;const y=Ht(O,U,S,E);N.setValue(A,C,{f:`=${t.generateStringWithSequence(y)}`})}),u[f]&&(u[f][p]=N.getData())}}return{newFormulaData:u}}},P.UpdateFormulaController=we([g(0,c.IUniverInstanceService),g(1,c.ICommandService),g(2,c.Inject(t.LexerTreeBuilder)),g(3,c.Inject(t.FormulaDataModel)),g(4,c.Inject(s.SheetInterceptorService)),g(5,t.IDefinedNamesService),g(6,c.IConfigService),g(7,c.Inject(c.Injector))],P.UpdateFormulaController);const Ye="SHEETS_FORMULA_PLUGIN";var Xe=Object.getOwnPropertyDescriptor,ge=(r,e,a,n)=>{for(var i=n>1?void 0:n?Xe(e,a):e,o=r.length-1,u;o>=0;o--)(u=r[o])&&(i=u(i)||i);return i},Dt=(r,e)=>(a,n)=>e(a,n,r);let ft=class extends c.Disposable{constructor(r,e,a){super(),this._activeDirtyManagerService=r,this._univerInstanceService=e,this._formulaDataModel=a,this._initialize()}_initialize(){this._initialConversion()}_initialConversion(){this._activeDirtyManagerService.register(s.SetRangeValuesMutation.id,{commandId:s.SetRangeValuesMutation.id,getDirtyData:r=>{const e=r.params;return e.trigger===s.SetStyleCommand.id?{}:{dirtyRanges:this._getSetRangeValuesMutationDirtyRange(e)}}}),this._initialMove(),this._initialRowAndColumn(),this._initialHideRow(),this._initialSheet(),this._initialDefinedName()}_initialMove(){this._activeDirtyManagerService.register(s.MoveRangeMutation.id,{commandId:s.MoveRangeMutation.id,getDirtyData:r=>{const e=r.params;return{dirtyRanges:this._getMoveRangeMutationDirtyRange(e),clearDependencyTreeCache:{[e.unitId]:{[e.to.subUnitId]:"1",[e.from.subUnitId]:"1"}}}}}),this._activeDirtyManagerService.register(s.MoveRowsMutation.id,{commandId:s.MoveRowsMutation.id,getDirtyData:r=>{const e=r.params;return{dirtyRanges:this._getMoveRowsMutationDirtyRange(e),clearDependencyTreeCache:{[e.unitId]:{[e.subUnitId]:"1"}}}}}),this._activeDirtyManagerService.register(s.MoveColsMutation.id,{commandId:s.MoveColsMutation.id,getDirtyData:r=>{const e=r.params;return{dirtyRanges:this._getMoveRowsMutationDirtyRange(e),clearDependencyTreeCache:{[e.unitId]:{[e.subUnitId]:"1"}}}}}),this._activeDirtyManagerService.register(s.ReorderRangeMutation.id,{commandId:s.ReorderRangeMutation.id,getDirtyData:r=>{const e=r.params;return{dirtyRanges:this._getReorderRangeMutationDirtyRange(e),clearDependencyTreeCache:{[e.unitId]:{[e.subUnitId]:"1"}}}}})}_initialRowAndColumn(){this._activeDirtyManagerService.register(s.RemoveRowMutation.id,{commandId:s.RemoveRowMutation.id,getDirtyData:r=>{const e=r.params;return{dirtyRanges:this._getRemoveRowOrColumnMutation(e,!0),clearDependencyTreeCache:{[e.unitId]:{[e.subUnitId]:"1"}}}}}),this._activeDirtyManagerService.register(s.RemoveColMutation.id,{commandId:s.RemoveColMutation.id,getDirtyData:r=>{const e=r.params;return{dirtyRanges:this._getRemoveRowOrColumnMutation(e,!1),clearDependencyTreeCache:{[e.unitId]:{[e.subUnitId]:"1"}}}}}),this._activeDirtyManagerService.register(s.InsertColMutation.id,{commandId:s.InsertColMutation.id,getDirtyData:r=>{const e=r.params;return{clearDependencyTreeCache:{[e.unitId]:{[e.subUnitId]:"1"}}}}}),this._activeDirtyManagerService.register(s.InsertRowMutation.id,{commandId:s.InsertRowMutation.id,getDirtyData:r=>{const e=r.params;return{clearDependencyTreeCache:{[e.unitId]:{[e.subUnitId]:"1"}}}}})}_initialHideRow(){this._activeDirtyManagerService.register(s.SetRowHiddenMutation.id,{commandId:s.SetRowHiddenMutation.id,getDirtyData:r=>{const e=r.params;return{dirtyRanges:this._getHideRowMutation(e),clearDependencyTreeCache:{[e.unitId]:{[e.subUnitId]:"1"}}}}}),this._activeDirtyManagerService.register(s.SetRowVisibleMutation.id,{commandId:s.SetRowVisibleMutation.id,getDirtyData:r=>{const e=r.params;return{dirtyRanges:this._getHideRowMutation(e),clearDependencyTreeCache:{[e.unitId]:{[e.subUnitId]:"1"}}}}})}_initialSheet(){this._activeDirtyManagerService.register(s.RemoveSheetMutation.id,{commandId:s.RemoveSheetMutation.id,getDirtyData:r=>{const e=r.params;return{dirtyNameMap:this._getRemoveSheetMutation(e),clearDependencyTreeCache:{[e.unitId]:{[e.subUnitId]:"1"}}}}}),this._activeDirtyManagerService.register(s.InsertSheetMutation.id,{commandId:s.InsertSheetMutation.id,getDirtyData:r=>{const e=r.params;return{dirtyNameMap:this._getInsertSheetMutation(e)}}})}_initialDefinedName(){this._activeDirtyManagerService.register(t.SetDefinedNameMutation.id,{commandId:t.SetDefinedNameMutation.id,getDirtyData:r=>{const e=r.params;return{dirtyDefinedNameMap:this._getDefinedNameMutation(e)}}}),this._activeDirtyManagerService.register(t.RemoveDefinedNameMutation.id,{commandId:t.RemoveDefinedNameMutation.id,getDirtyData:r=>{const e=r.params;return{dirtyDefinedNameMap:this._getDefinedNameMutation(e)}}})}_getDefinedNameMutation(r){const{unitId:e,name:a,formulaOrRefString:n}=r,i={};return r==null?{}:(i[e]={},i[e][a]=n,i)}_getSetRangeValuesMutationDirtyRange(r){const{subUnitId:e,unitId:a,cellValue:n}=r,i=[];return n==null||(i.push(...this._getDirtyRangesByCellValue(a,e,n)),i.push(...this._getDirtyRangesForArrayFormula(a,e,n))),i}_getMoveRangeMutationDirtyRange(r){const{unitId:e,from:a,to:n}=r,i=[];return i.push(...this._getDirtyRangesByCellValue(e,a.subUnitId,a.value)),i.push(...this._getDirtyRangesByCellValue(e,n.subUnitId,n.value)),i.push(...this._getDirtyRangesForArrayFormula(e,n.subUnitId,n.value)),i}_getMoveRowsMutationDirtyRange(r){const{subUnitId:e,unitId:a,sourceRange:n,targetRange:i}=r,o=[],u=this._rangeToMatrix(n).getData(),f=this._rangeToMatrix(i).getData();return o.push(...this._getDirtyRangesByCellValue(a,e,u)),o.push(...this._getDirtyRangesByCellValue(a,e,f)),o.push(...this._getDirtyRangesForArrayFormula(a,e,f)),o}_getReorderRangeMutationDirtyRange(r){const{unitId:e,subUnitId:a,range:n}=r,i=this._rangeToMatrix(n).getData(),o=[];return o.push(...this._getDirtyRangesByCellValue(e,a,i)),o.push(...this._getDirtyRangesForArrayFormula(e,a,i)),o}_getRemoveRowOrColumnMutation(r,e=!0){const{subUnitId:a,unitId:n,range:i}=r,o=[],u=this._univerInstanceService.getUniverSheetInstance(n),f=u==null?void 0:u.getSheetBySheetId(a),m=(f==null?void 0:f.getRowCount())||0,l=(f==null?void 0:f.getColumnCount())||0;let p=null;const{startRow:L,endRow:N,startColumn:T,endColumn:A}=i;e===!0?p=this._rangeToMatrix({startRow:L,startColumn:0,endRow:N,endColumn:l-1}):p=this._rangeToMatrix({startRow:0,startColumn:T,endRow:m,endColumn:A});const C=p.getData();return o.push(...this._getDirtyRangesByCellValue(n,a,C)),o.push(...this._getDirtyRangesForArrayFormula(n,a,C)),o}_getHideRowMutation(r){const{subUnitId:e,unitId:a,ranges:n}=r,i=[];return n.forEach(o=>{const u=this._rangeToMatrix(o).getMatrix();i.push(...this._getDirtyRangesByCellValue(a,e,u))}),i}_getRemoveSheetMutation(r){const e={},{subUnitId:a,unitId:n,subUnitName:i}=r;return e[n]==null&&(e[n]={}),e[n][a]=i,e}_getInsertSheetMutation(r){const e={},{sheet:a,unitId:n}=r;return e[n]==null&&(e[n]={}),e[n][a.id]=a.name,e}_rangeToMatrix(r){const e=new c.ObjectMatrix,{startRow:a,startColumn:n,endRow:i,endColumn:o}=r;for(let u=a;u<=i;u++)for(let f=n;f<=o;f++)e.setValue(u,f,{});return e}_getDirtyRangesByCellValue(r,e,a){const n=[];return a==null||new c.ObjectMatrix(a).getDiscreteRanges().forEach(u=>{n.push({unitId:r,sheetId:e,range:u})}),n}_getDirtyRangesForArrayFormula(r,e,a){var u,f;const n=[];if(a==null)return n;const i=new c.ObjectMatrix(a),o=this._formulaDataModel.getArrayFormulaRange();if((u=o==null?void 0:o[r])!=null&&u[e]){const m=new c.ObjectMatrix((f=o==null?void 0:o[r])==null?void 0:f[e]);i.forValue((l,p)=>{m.forValue((L,N,T)=>{if(T==null)return!0;const{startRow:A,startColumn:C,endRow:R,endColumn:d}=T;l>=A&&l<=R&&p>=C&&p<=d&&n.push({unitId:r,sheetId:e,range:{startRow:A,startColumn:C,endRow:A,endColumn:C}})})})}return n}};ft=ge([Dt(0,t.IActiveDirtyManagerService),Dt(1,c.IUniverInstanceService),Dt(2,c.Inject(t.FormulaDataModel))],ft);var We=Object.getOwnPropertyDescriptor,Ke=(r,e,a,n)=>{for(var i=n>1?void 0:n?We(e,a):e,o=r.length-1,u;o>=0;o--)(u=r[o])&&(i=u(i)||i);return i},K=(r,e)=>(a,n)=>e(a,n,r);let mt=class extends c.Disposable{constructor(r,e,a,n,i,o,u){super(),this._commandService=r,this._configService=e,this._sheetInterceptorService=a,this._formulaDataModel=n,this._lexerTreeBuilder=i,this._functionService=o,this._definedNamesService=u,this._initialize()}_initialize(){this._commandExecutedListener(),this._initInterceptorCellContent()}_commandExecutedListener(){this.disposeWithMe(this._commandService.onCommandExecuted(r=>{var a;const e=(a=this._configService.getConfig(Z))==null?void 0:a.writeArrayFormulaToSnapshot;if(r.id===t.SetArrayFormulaDataMutation.id){const n=r.params;if(n==null)return;const{arrayFormulaRange:i,arrayFormulaCellData:o,arrayFormulaEmbedded:u}=n;this._formulaDataModel.setArrayFormulaRange(i),this._formulaDataModel.setArrayFormulaCellData(o),e&&this._writeArrayFormulaToSnapshot(i,o,u)}else r.id===t.SetFormulaCalculationResultMutation.id&&e&&(this._addPrefixToFunctionSnapshot(),this._addPrefixToDefinedNamesFunctionSnapshot())}))}_addPrefixToDefinedNamesFunctionSnapshot(){const r=this._definedNamesService.getAllDefinedNames();Object.entries(r).forEach(([e,a])=>{a&&Array.from(Object.entries(a)).forEach(([n,i])=>{const{formulaOrRefString:o}=i;if(o.substring(0,1)==="="){const u=this._lexerTreeBuilder.getNewFormulaWithPrefix(o,this._functionService.hasExecutor.bind(this._functionService));u&&this._commandService.executeCommand(t.SetDefinedNameMutation.id,{...i,unitId:e,formulaOrRefStringWithPrefix:u},{onlyLocal:!0,fromFormula:!0})}})})}_addPrefixToFunctionSnapshot(){const r=this._formulaDataModel.getFormulaData(),e=new Map;Object.entries(r).forEach(([a,n])=>{n&&Array.from(Object.entries(n)).forEach(([i,o])=>{if(!o)return;const u=new c.ObjectMatrix;new c.ObjectMatrix(o).forValue((m,l,p)=>{const L=p==null?void 0:p.f;if((p==null?void 0:p.x)!=null||!L||L.length===0)return;if(e.has(L)){const T=e.get(L);u.setValue(m,l,{xf:T});return}const N=this._lexerTreeBuilder.getNewFormulaWithPrefix(L,this._functionService.hasExecutor.bind(this._functionService));N&&(u.setValue(m,l,{xf:N}),e.set(L,N))}),this._commandService.executeCommand(s.SetRangeValuesMutation.id,{unitId:a,subUnitId:i,cellValue:u.getMatrix()},{onlyLocal:!0,fromFormula:!0})})}),e.clear()}_writeArrayFormulaToSnapshot(r,e,a){r&&Object.entries(r).forEach(([n,i])=>{i&&Array.from(Object.entries(i)).forEach(([o,u])=>{const f=new c.ObjectMatrix;new c.ObjectMatrix(u).forValue((l,p,L)=>{f.setValue(l,p,{ref:t.serializeRange(L)})}),this._commandService.executeCommand(s.SetRangeValuesMutation.id,{unitId:n,subUnitId:o,cellValue:f.getMatrix()},{onlyLocal:!0,fromFormula:!0})})}),a&&Object.entries(a).forEach(([n,i])=>{i&&Array.from(Object.entries(i)).forEach(([o,u])=>{const f=new c.ObjectMatrix;new c.ObjectMatrix(u).forValue((l,p)=>{var N,T,A;(A=(T=(N=r==null?void 0:r[n])==null?void 0:N[o])==null?void 0:T[l])!=null&&A[p]||f.setValue(l,p,{ref:t.serializeRange({startRow:l,endRow:l,startColumn:p,endColumn:p})})}),this._commandService.executeCommand(s.SetRangeValuesMutation.id,{unitId:n,subUnitId:o,cellValue:f.getMatrix()},{onlyLocal:!0,fromFormula:!0})})}),e&&Object.entries(e).forEach(([n,i])=>{i&&Array.from(Object.entries(i)).forEach(([o,u])=>{this._commandService.executeCommand(s.SetRangeValuesMutation.id,{unitId:n,subUnitId:o,cellValue:u},{onlyLocal:!0,fromFormula:!0})})})}_initInterceptorCellContent(){this.disposeWithMe(this._sheetInterceptorService.intercept(s.INTERCEPTOR_POINT.CELL_CONTENT,{priority:100,effect:c.InterceptorEffectEnum.Value,handler:(r,e,a)=>{var p,L,N;let n=r;const{unitId:i,subUnitId:o,row:u,col:f}=e,m=this._formulaDataModel.getArrayFormulaCellData(),l=(N=(L=(p=m==null?void 0:m[i])==null?void 0:p[o])==null?void 0:L[u])==null?void 0:N[f];return l==null?a(n):((!n||n===e.rawData)&&(n={...e.rawData}),l.v==null&&l.t==null?(n.v=0,n.t=c.CellValueType.NUMBER,a(n)):(n==null?void 0:n.t)===c.CellValueType.NUMBER&&n.v!==void 0&&n.v!==null&&c.isRealNum(n.v)?(n.v=t.stripErrorMargin(Number(n.v)),a(n)):(n.v=l.v,n.t=l.t,a(n)))}}))}};mt=Ke([K(0,c.ICommandService),K(1,c.IConfigService),K(2,c.Inject(s.SheetInterceptorService)),K(3,c.Inject(t.FormulaDataModel)),K(4,c.Inject(t.LexerTreeBuilder)),K(5,t.IFunctionService),K(6,t.IDefinedNamesService)],mt);const ke=[{functionName:t.FUNCTION_NAMES_ARRAY.ARRAY_CONSTRAIN,functionType:t.FunctionType.Array,description:"formula.functionList.ARRAY_CONSTRAIN.description",abstract:"formula.functionList.ARRAY_CONSTRAIN.abstract",functionParameter:[{name:"formula.functionList.ARRAY_CONSTRAIN.functionParameter.inputRange.name",detail:"formula.functionList.ARRAY_CONSTRAIN.functionParameter.inputRange.detail",example:"A1:C3",require:1,repeat:0},{name:"formula.functionList.ARRAY_CONSTRAIN.functionParameter.numRows.name",detail:"formula.functionList.ARRAY_CONSTRAIN.functionParameter.numRows.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.ARRAY_CONSTRAIN.functionParameter.numCols.name",detail:"formula.functionList.ARRAY_CONSTRAIN.functionParameter.numCols.detail",example:"2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ARRAY.FLATTEN,functionType:t.FunctionType.Array,description:"formula.functionList.FLATTEN.description",abstract:"formula.functionList.FLATTEN.abstract",functionParameter:[{name:"formula.functionList.FLATTEN.functionParameter.range1.name",detail:"formula.functionList.FLATTEN.functionParameter.range1.detail",example:"A1:C3",require:1,repeat:0},{name:"formula.functionList.FLATTEN.functionParameter.range2.name",detail:"formula.functionList.FLATTEN.functionParameter.range2.detail",example:"D1:F3",require:0,repeat:1}]}],Qe=[{functionName:t.FUNCTION_NAMES_COMPATIBILITY.BETADIST,functionType:t.FunctionType.Compatibility,description:"formula.functionList.BETADIST.description",abstract:"formula.functionList.BETADIST.abstract",functionParameter:[{name:"formula.functionList.BETADIST.functionParameter.x.name",detail:"formula.functionList.BETADIST.functionParameter.x.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.BETADIST.functionParameter.alpha.name",detail:"formula.functionList.BETADIST.functionParameter.alpha.detail",example:"8",require:1,repeat:0},{name:"formula.functionList.BETADIST.functionParameter.beta.name",detail:"formula.functionList.BETADIST.functionParameter.beta.detail",example:"10",require:1,repeat:0},{name:"formula.functionList.BETADIST.functionParameter.A.name",detail:"formula.functionList.BETADIST.functionParameter.A.detail",example:"1",require:0,repeat:0},{name:"formula.functionList.BETADIST.functionParameter.B.name",detail:"formula.functionList.BETADIST.functionParameter.B.detail",example:"3",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.BETAINV,functionType:t.FunctionType.Compatibility,description:"formula.functionList.BETAINV.description",abstract:"formula.functionList.BETAINV.abstract",functionParameter:[{name:"formula.functionList.BETAINV.functionParameter.probability.name",detail:"formula.functionList.BETAINV.functionParameter.probability.detail",example:"0.685470581",require:1,repeat:0},{name:"formula.functionList.BETAINV.functionParameter.alpha.name",detail:"formula.functionList.BETAINV.functionParameter.alpha.detail",example:"8",require:1,repeat:0},{name:"formula.functionList.BETAINV.functionParameter.beta.name",detail:"formula.functionList.BETAINV.functionParameter.beta.detail",example:"10",require:1,repeat:0},{name:"formula.functionList.BETAINV.functionParameter.A.name",detail:"formula.functionList.BETAINV.functionParameter.A.detail",example:"1",require:0,repeat:0},{name:"formula.functionList.BETAINV.functionParameter.B.name",detail:"formula.functionList.BETAINV.functionParameter.B.detail",example:"3",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.BINOMDIST,functionType:t.FunctionType.Compatibility,description:"formula.functionList.BINOMDIST.description",abstract:"formula.functionList.BINOMDIST.abstract",functionParameter:[{name:"formula.functionList.BINOMDIST.functionParameter.numberS.name",detail:"formula.functionList.BINOMDIST.functionParameter.numberS.detail",example:"6",require:1,repeat:0},{name:"formula.functionList.BINOMDIST.functionParameter.trials.name",detail:"formula.functionList.BINOMDIST.functionParameter.trials.detail",example:"10",require:1,repeat:0},{name:"formula.functionList.BINOMDIST.functionParameter.probabilityS.name",detail:"formula.functionList.BINOMDIST.functionParameter.probabilityS.detail",example:"0.5",require:1,repeat:0},{name:"formula.functionList.BINOMDIST.functionParameter.cumulative.name",detail:"formula.functionList.BINOMDIST.functionParameter.cumulative.detail",example:"false",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.CHIDIST,functionType:t.FunctionType.Compatibility,description:"formula.functionList.CHIDIST.description",abstract:"formula.functionList.CHIDIST.abstract",functionParameter:[{name:"formula.functionList.CHIDIST.functionParameter.x.name",detail:"formula.functionList.CHIDIST.functionParameter.x.detail",example:"0.5",require:1,repeat:0},{name:"formula.functionList.CHIDIST.functionParameter.degFreedom.name",detail:"formula.functionList.CHIDIST.functionParameter.degFreedom.detail",example:"1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.CHIINV,functionType:t.FunctionType.Compatibility,description:"formula.functionList.CHIINV.description",abstract:"formula.functionList.CHIINV.abstract",functionParameter:[{name:"formula.functionList.CHIINV.functionParameter.probability.name",detail:"formula.functionList.CHIINV.functionParameter.probability.detail",example:"0.93",require:1,repeat:0},{name:"formula.functionList.CHIINV.functionParameter.degFreedom.name",detail:"formula.functionList.CHIINV.functionParameter.degFreedom.detail",example:"1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.CHITEST,functionType:t.FunctionType.Compatibility,description:"formula.functionList.CHITEST.description",abstract:"formula.functionList.CHITEST.abstract",functionParameter:[{name:"formula.functionList.CHITEST.functionParameter.actualRange.name",detail:"formula.functionList.CHITEST.functionParameter.actualRange.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.CHITEST.functionParameter.expectedRange.name",detail:"formula.functionList.CHITEST.functionParameter.expectedRange.detail",example:"B1:B4",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.CONFIDENCE,functionType:t.FunctionType.Compatibility,description:"formula.functionList.CONFIDENCE.description",abstract:"formula.functionList.CONFIDENCE.abstract",functionParameter:[{name:"formula.functionList.CONFIDENCE.functionParameter.alpha.name",detail:"formula.functionList.CONFIDENCE.functionParameter.alpha.detail",example:"0.05",require:1,repeat:0},{name:"formula.functionList.CONFIDENCE.functionParameter.standardDev.name",detail:"formula.functionList.CONFIDENCE.functionParameter.standardDev.detail",example:"2.5",require:1,repeat:0},{name:"formula.functionList.CONFIDENCE.functionParameter.size.name",detail:"formula.functionList.CONFIDENCE.functionParameter.size.detail",example:"50",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.COVAR,functionType:t.FunctionType.Compatibility,description:"formula.functionList.COVAR.description",abstract:"formula.functionList.COVAR.abstract",functionParameter:[{name:"formula.functionList.COVAR.functionParameter.array1.name",detail:"formula.functionList.COVAR.functionParameter.array1.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.COVAR.functionParameter.array2.name",detail:"formula.functionList.COVAR.functionParameter.array2.detail",example:"B1:B4",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.CRITBINOM,functionType:t.FunctionType.Compatibility,description:"formula.functionList.CRITBINOM.description",abstract:"formula.functionList.CRITBINOM.abstract",functionParameter:[{name:"formula.functionList.CRITBINOM.functionParameter.trials.name",detail:"formula.functionList.CRITBINOM.functionParameter.trials.detail",example:"6",require:1,repeat:0},{name:"formula.functionList.CRITBINOM.functionParameter.probabilityS.name",detail:"formula.functionList.CRITBINOM.functionParameter.probabilityS.detail",example:"0.5",require:1,repeat:0},{name:"formula.functionList.CRITBINOM.functionParameter.alpha.name",detail:"formula.functionList.CRITBINOM.functionParameter.alpha.detail",example:"0.75",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.EXPONDIST,functionType:t.FunctionType.Compatibility,description:"formula.functionList.EXPONDIST.description",abstract:"formula.functionList.EXPONDIST.abstract",functionParameter:[{name:"formula.functionList.EXPONDIST.functionParameter.x.name",detail:"formula.functionList.EXPONDIST.functionParameter.x.detail",example:"0.2",require:1,repeat:0},{name:"formula.functionList.EXPONDIST.functionParameter.lambda.name",detail:"formula.functionList.EXPONDIST.functionParameter.lambda.detail",example:"10",require:1,repeat:0},{name:"formula.functionList.EXPONDIST.functionParameter.cumulative.name",detail:"formula.functionList.EXPONDIST.functionParameter.cumulative.detail",example:"true",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.FDIST,functionType:t.FunctionType.Compatibility,description:"formula.functionList.FDIST.description",abstract:"formula.functionList.FDIST.abstract",functionParameter:[{name:"formula.functionList.FDIST.functionParameter.x.name",detail:"formula.functionList.FDIST.functionParameter.x.detail",example:"15.2069",require:1,repeat:0},{name:"formula.functionList.FDIST.functionParameter.degFreedom1.name",detail:"formula.functionList.FDIST.functionParameter.degFreedom1.detail",example:"6",require:1,repeat:0},{name:"formula.functionList.FDIST.functionParameter.degFreedom2.name",detail:"formula.functionList.FDIST.functionParameter.degFreedom2.detail",example:"4",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.FINV,functionType:t.FunctionType.Compatibility,description:"formula.functionList.FINV.description",abstract:"formula.functionList.FINV.abstract",functionParameter:[{name:"formula.functionList.FINV.functionParameter.probability.name",detail:"formula.functionList.FINV.functionParameter.probability.detail",example:"0.01",require:1,repeat:0},{name:"formula.functionList.FINV.functionParameter.degFreedom1.name",detail:"formula.functionList.FINV.functionParameter.degFreedom1.detail",example:"6",require:1,repeat:0},{name:"formula.functionList.FINV.functionParameter.degFreedom2.name",detail:"formula.functionList.FINV.functionParameter.degFreedom2.detail",example:"4",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.FTEST,functionType:t.FunctionType.Compatibility,description:"formula.functionList.FTEST.description",abstract:"formula.functionList.FTEST.abstract",functionParameter:[{name:"formula.functionList.FTEST.functionParameter.array1.name",detail:"formula.functionList.FTEST.functionParameter.array1.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.FTEST.functionParameter.array2.name",detail:"formula.functionList.FTEST.functionParameter.array2.detail",example:"B1:B4",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.GAMMADIST,functionType:t.FunctionType.Compatibility,description:"formula.functionList.GAMMADIST.description",abstract:"formula.functionList.GAMMADIST.abstract",functionParameter:[{name:"formula.functionList.GAMMADIST.functionParameter.x.name",detail:"formula.functionList.GAMMADIST.functionParameter.x.detail",example:"10",require:1,repeat:0},{name:"formula.functionList.GAMMADIST.functionParameter.alpha.name",detail:"formula.functionList.GAMMADIST.functionParameter.alpha.detail",example:"8",require:1,repeat:0},{name:"formula.functionList.GAMMADIST.functionParameter.beta.name",detail:"formula.functionList.GAMMADIST.functionParameter.beta.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.GAMMADIST.functionParameter.cumulative.name",detail:"formula.functionList.GAMMADIST.functionParameter.cumulative.detail",example:"true",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.GAMMAINV,functionType:t.FunctionType.Compatibility,description:"formula.functionList.GAMMAINV.description",abstract:"formula.functionList.GAMMAINV.abstract",functionParameter:[{name:"formula.functionList.GAMMAINV.functionParameter.probability.name",detail:"formula.functionList.GAMMAINV.functionParameter.probability.detail",example:"0.068094",require:1,repeat:0},{name:"formula.functionList.GAMMAINV.functionParameter.alpha.name",detail:"formula.functionList.GAMMAINV.functionParameter.alpha.detail",example:"9",require:1,repeat:0},{name:"formula.functionList.GAMMAINV.functionParameter.beta.name",detail:"formula.functionList.GAMMAINV.functionParameter.beta.detail",example:"2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.HYPGEOMDIST,functionType:t.FunctionType.Compatibility,description:"formula.functionList.HYPGEOMDIST.description",abstract:"formula.functionList.HYPGEOMDIST.abstract",functionParameter:[{name:"formula.functionList.HYPGEOMDIST.functionParameter.sampleS.name",detail:"formula.functionList.HYPGEOMDIST.functionParameter.sampleS.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.HYPGEOMDIST.functionParameter.numberSample.name",detail:"formula.functionList.HYPGEOMDIST.functionParameter.numberSample.detail",example:"4",require:1,repeat:0},{name:"formula.functionList.HYPGEOMDIST.functionParameter.populationS.name",detail:"formula.functionList.HYPGEOMDIST.functionParameter.populationS.detail",example:"8",require:1,repeat:0},{name:"formula.functionList.HYPGEOMDIST.functionParameter.numberPop.name",detail:"formula.functionList.HYPGEOMDIST.functionParameter.numberPop.detail",example:"20",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.LOGINV,functionType:t.FunctionType.Compatibility,description:"formula.functionList.LOGINV.description",abstract:"formula.functionList.LOGINV.abstract",functionParameter:[{name:"formula.functionList.LOGINV.functionParameter.probability.name",detail:"formula.functionList.LOGINV.functionParameter.probability.detail",example:"0.908789",require:1,repeat:0},{name:"formula.functionList.LOGINV.functionParameter.mean.name",detail:"formula.functionList.LOGINV.functionParameter.mean.detail",example:"40",require:1,repeat:0},{name:"formula.functionList.LOGINV.functionParameter.standardDev.name",detail:"formula.functionList.LOGINV.functionParameter.standardDev.detail",example:"1.5",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.LOGNORMDIST,functionType:t.FunctionType.Compatibility,description:"formula.functionList.LOGNORMDIST.description",abstract:"formula.functionList.LOGNORMDIST.abstract",functionParameter:[{name:"formula.functionList.LOGNORMDIST.functionParameter.x.name",detail:"formula.functionList.LOGNORMDIST.functionParameter.x.detail",example:"42",require:1,repeat:0},{name:"formula.functionList.LOGNORMDIST.functionParameter.mean.name",detail:"formula.functionList.LOGNORMDIST.functionParameter.mean.detail",example:"40",require:1,repeat:0},{name:"formula.functionList.LOGNORMDIST.functionParameter.standardDev.name",detail:"formula.functionList.LOGNORMDIST.functionParameter.standardDev.detail",example:"1.5",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.MODE,functionType:t.FunctionType.Compatibility,description:"formula.functionList.MODE.description",abstract:"formula.functionList.MODE.abstract",functionParameter:[{name:"formula.functionList.MODE.functionParameter.number1.name",detail:"formula.functionList.MODE.functionParameter.number1.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.MODE.functionParameter.number2.name",detail:"formula.functionList.MODE.functionParameter.number2.detail",example:"2",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.NEGBINOMDIST,functionType:t.FunctionType.Compatibility,description:"formula.functionList.NEGBINOMDIST.description",abstract:"formula.functionList.NEGBINOMDIST.abstract",functionParameter:[{name:"formula.functionList.NEGBINOMDIST.functionParameter.numberF.name",detail:"formula.functionList.NEGBINOMDIST.functionParameter.numberF.detail",example:"10",require:1,repeat:0},{name:"formula.functionList.NEGBINOMDIST.functionParameter.numberS.name",detail:"formula.functionList.NEGBINOMDIST.functionParameter.numberS.detail",example:"5",require:1,repeat:0},{name:"formula.functionList.NEGBINOMDIST.functionParameter.probabilityS.name",detail:"formula.functionList.NEGBINOMDIST.functionParameter.probabilityS.detail",example:"0.25",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.NORMDIST,functionType:t.FunctionType.Compatibility,description:"formula.functionList.NORMDIST.description",abstract:"formula.functionList.NORMDIST.abstract",functionParameter:[{name:"formula.functionList.NORMDIST.functionParameter.x.name",detail:"formula.functionList.NORMDIST.functionParameter.x.detail",example:"42",require:1,repeat:0},{name:"formula.functionList.NORMDIST.functionParameter.mean.name",detail:"formula.functionList.NORMDIST.functionParameter.mean.detail",example:"40",require:1,repeat:0},{name:"formula.functionList.NORMDIST.functionParameter.standardDev.name",detail:"formula.functionList.NORMDIST.functionParameter.standardDev.detail",example:"1.5",require:1,repeat:0},{name:"formula.functionList.NORMDIST.functionParameter.cumulative.name",detail:"formula.functionList.NORMDIST.functionParameter.cumulative.detail",example:"true",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.NORMINV,functionType:t.FunctionType.Compatibility,description:"formula.functionList.NORMINV.description",abstract:"formula.functionList.NORMINV.abstract",functionParameter:[{name:"formula.functionList.NORMINV.functionParameter.probability.name",detail:"formula.functionList.NORMINV.functionParameter.probability.detail",example:"0.908789",require:1,repeat:0},{name:"formula.functionList.NORMINV.functionParameter.mean.name",detail:"formula.functionList.NORMINV.functionParameter.mean.detail",example:"40",require:1,repeat:0},{name:"formula.functionList.NORMINV.functionParameter.standardDev.name",detail:"formula.functionList.NORMINV.functionParameter.standardDev.detail",example:"1.5",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.NORMSDIST,functionType:t.FunctionType.Compatibility,description:"formula.functionList.NORMSDIST.description",abstract:"formula.functionList.NORMSDIST.abstract",functionParameter:[{name:"formula.functionList.NORMSDIST.functionParameter.z.name",detail:"formula.functionList.NORMSDIST.functionParameter.z.detail",example:"1.333333",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.NORMSINV,functionType:t.FunctionType.Compatibility,description:"formula.functionList.NORMSINV.description",abstract:"formula.functionList.NORMSINV.abstract",functionParameter:[{name:"formula.functionList.NORMSINV.functionParameter.probability.name",detail:"formula.functionList.NORMSINV.functionParameter.probability.detail",example:"0.908789",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.PERCENTILE,functionType:t.FunctionType.Compatibility,description:"formula.functionList.PERCENTILE.description",abstract:"formula.functionList.PERCENTILE.abstract",functionParameter:[{name:"formula.functionList.PERCENTILE.functionParameter.array.name",detail:"formula.functionList.PERCENTILE.functionParameter.array.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.PERCENTILE.functionParameter.k.name",detail:"formula.functionList.PERCENTILE.functionParameter.k.detail",example:"0.3",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.PERCENTRANK,functionType:t.FunctionType.Compatibility,description:"formula.functionList.PERCENTRANK.description",abstract:"formula.functionList.PERCENTRANK.abstract",functionParameter:[{name:"formula.functionList.PERCENTRANK.functionParameter.array.name",detail:"formula.functionList.PERCENTRANK.functionParameter.array.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.PERCENTRANK.functionParameter.x.name",detail:"formula.functionList.PERCENTRANK.functionParameter.x.detail",example:"1.5",require:1,repeat:0},{name:"formula.functionList.PERCENTRANK.functionParameter.significance.name",detail:"formula.functionList.PERCENTRANK.functionParameter.significance.detail",example:"3",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.POISSON,functionType:t.FunctionType.Compatibility,description:"formula.functionList.POISSON.description",abstract:"formula.functionList.POISSON.abstract",functionParameter:[{name:"formula.functionList.POISSON.functionParameter.x.name",detail:"formula.functionList.POISSON.functionParameter.x.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.POISSON.functionParameter.mean.name",detail:"formula.functionList.POISSON.functionParameter.mean.detail",example:"5",require:1,repeat:0},{name:"formula.functionList.POISSON.functionParameter.cumulative.name",detail:"formula.functionList.POISSON.functionParameter.cumulative.detail",example:"true",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.QUARTILE,functionType:t.FunctionType.Compatibility,description:"formula.functionList.QUARTILE.description",abstract:"formula.functionList.QUARTILE.abstract",functionParameter:[{name:"formula.functionList.QUARTILE.functionParameter.array.name",detail:"formula.functionList.QUARTILE.functionParameter.array.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.QUARTILE.functionParameter.quart.name",detail:"formula.functionList.QUARTILE.functionParameter.quart.detail",example:"1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.RANK,functionType:t.FunctionType.Compatibility,description:"formula.functionList.RANK.description",abstract:"formula.functionList.RANK.abstract",functionParameter:[{name:"formula.functionList.RANK.functionParameter.number.name",detail:"formula.functionList.RANK.functionParameter.number.detail",example:"A3",require:1,repeat:0},{name:"formula.functionList.RANK.functionParameter.ref.name",detail:"formula.functionList.RANK.functionParameter.ref.detail",example:"A2:A6",require:1,repeat:0},{name:"formula.functionList.RANK.functionParameter.order.name",detail:"formula.functionList.RANK.functionParameter.order.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.STDEV,functionType:t.FunctionType.Compatibility,description:"formula.functionList.STDEV.description",abstract:"formula.functionList.STDEV.abstract",functionParameter:[{name:"formula.functionList.STDEV.functionParameter.number1.name",detail:"formula.functionList.STDEV.functionParameter.number1.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.STDEV.functionParameter.number2.name",detail:"formula.functionList.STDEV.functionParameter.number2.detail",example:"2",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.STDEVP,functionType:t.FunctionType.Compatibility,description:"formula.functionList.STDEVP.description",abstract:"formula.functionList.STDEVP.abstract",functionParameter:[{name:"formula.functionList.STDEVP.functionParameter.number1.name",detail:"formula.functionList.STDEVP.functionParameter.number1.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.STDEVP.functionParameter.number2.name",detail:"formula.functionList.STDEVP.functionParameter.number2.detail",example:"2",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.TDIST,functionType:t.FunctionType.Compatibility,description:"formula.functionList.TDIST.description",abstract:"formula.functionList.TDIST.abstract",functionParameter:[{name:"formula.functionList.TDIST.functionParameter.x.name",detail:"formula.functionList.TDIST.functionParameter.x.detail",example:"8",require:1,repeat:0},{name:"formula.functionList.TDIST.functionParameter.degFreedom.name",detail:"formula.functionList.TDIST.functionParameter.degFreedom.detail",example:"3",require:1,repeat:0},{name:"formula.functionList.TDIST.functionParameter.tails.name",detail:"formula.functionList.TDIST.functionParameter.tails.detail",example:"1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.TINV,functionType:t.FunctionType.Compatibility,description:"formula.functionList.TINV.description",abstract:"formula.functionList.TINV.abstract",functionParameter:[{name:"formula.functionList.TINV.functionParameter.probability.name",detail:"formula.functionList.TINV.functionParameter.probability.detail",example:"0.75",require:1,repeat:0},{name:"formula.functionList.TINV.functionParameter.degFreedom.name",detail:"formula.functionList.TINV.functionParameter.degFreedom.detail",example:"2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.TTEST,functionType:t.FunctionType.Compatibility,description:"formula.functionList.TTEST.description",abstract:"formula.functionList.TTEST.abstract",functionParameter:[{name:"formula.functionList.TTEST.functionParameter.array1.name",detail:"formula.functionList.TTEST.functionParameter.array1.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.TTEST.functionParameter.array2.name",detail:"formula.functionList.TTEST.functionParameter.array2.detail",example:"B1:B4",require:1,repeat:0},{name:"formula.functionList.TTEST.functionParameter.tails.name",detail:"formula.functionList.TTEST.functionParameter.tails.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.TTEST.functionParameter.type.name",detail:"formula.functionList.TTEST.functionParameter.type.detail",example:"1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.VAR,functionType:t.FunctionType.Compatibility,description:"formula.functionList.VAR.description",abstract:"formula.functionList.VAR.abstract",functionParameter:[{name:"formula.functionList.VAR.functionParameter.number1.name",detail:"formula.functionList.VAR.functionParameter.number1.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.VAR.functionParameter.number2.name",detail:"formula.functionList.VAR.functionParameter.number2.detail",example:"2",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.VARP,functionType:t.FunctionType.Compatibility,description:"formula.functionList.VARP.description",abstract:"formula.functionList.VARP.abstract",functionParameter:[{name:"formula.functionList.VARP.functionParameter.number1.name",detail:"formula.functionList.VARP.functionParameter.number1.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.VARP.functionParameter.number2.name",detail:"formula.functionList.VARP.functionParameter.number2.detail",example:"2",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.WEIBULL,functionType:t.FunctionType.Compatibility,description:"formula.functionList.WEIBULL.description",abstract:"formula.functionList.WEIBULL.abstract",functionParameter:[{name:"formula.functionList.WEIBULL.functionParameter.x.name",detail:"formula.functionList.WEIBULL.functionParameter.x.detail",example:"105",require:1,repeat:0},{name:"formula.functionList.WEIBULL.functionParameter.alpha.name",detail:"formula.functionList.WEIBULL.functionParameter.alpha.detail",example:"20",require:1,repeat:0},{name:"formula.functionList.WEIBULL.functionParameter.beta.name",detail:"formula.functionList.WEIBULL.functionParameter.beta.detail",example:"100",require:1,repeat:0},{name:"formula.functionList.WEIBULL.functionParameter.cumulative.name",detail:"formula.functionList.WEIBULL.functionParameter.cumulative.detail",example:"true",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_COMPATIBILITY.ZTEST,functionType:t.FunctionType.Compatibility,description:"formula.functionList.ZTEST.description",abstract:"formula.functionList.ZTEST.abstract",functionParameter:[{name:"formula.functionList.ZTEST.functionParameter.array.name",detail:"formula.functionList.ZTEST.functionParameter.array.detail",example:"A2:A11",require:1,repeat:0},{name:"formula.functionList.ZTEST.functionParameter.x.name",detail:"formula.functionList.ZTEST.functionParameter.x.detail",example:"4",require:1,repeat:0},{name:"formula.functionList.ZTEST.functionParameter.sigma.name",detail:"formula.functionList.ZTEST.functionParameter.sigma.detail",example:"10",require:0,repeat:0}]}],je=[{functionName:t.FUNCTION_NAMES_CUBE.CUBEKPIMEMBER,functionType:t.FunctionType.Cube,description:"formula.functionList.CUBEKPIMEMBER.description",abstract:"formula.functionList.CUBEKPIMEMBER.abstract",functionParameter:[{name:"formula.functionList.CUBEKPIMEMBER.functionParameter.number1.name",detail:"formula.functionList.CUBEKPIMEMBER.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CUBEKPIMEMBER.functionParameter.number2.name",detail:"formula.functionList.CUBEKPIMEMBER.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_CUBE.CUBEMEMBER,functionType:t.FunctionType.Cube,description:"formula.functionList.CUBEMEMBER.description",abstract:"formula.functionList.CUBEMEMBER.abstract",functionParameter:[{name:"formula.functionList.CUBEMEMBER.functionParameter.number1.name",detail:"formula.functionList.CUBEMEMBER.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CUBEMEMBER.functionParameter.number2.name",detail:"formula.functionList.CUBEMEMBER.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_CUBE.CUBEMEMBERPROPERTY,functionType:t.FunctionType.Cube,description:"formula.functionList.CUBEMEMBERPROPERTY.description",abstract:"formula.functionList.CUBEMEMBERPROPERTY.abstract",functionParameter:[{name:"formula.functionList.CUBEMEMBERPROPERTY.functionParameter.number1.name",detail:"formula.functionList.CUBEMEMBERPROPERTY.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CUBEMEMBERPROPERTY.functionParameter.number2.name",detail:"formula.functionList.CUBEMEMBERPROPERTY.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_CUBE.CUBERANKEDMEMBER,functionType:t.FunctionType.Cube,description:"formula.functionList.CUBERANKEDMEMBER.description",abstract:"formula.functionList.CUBERANKEDMEMBER.abstract",functionParameter:[{name:"formula.functionList.CUBERANKEDMEMBER.functionParameter.number1.name",detail:"formula.functionList.CUBERANKEDMEMBER.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CUBERANKEDMEMBER.functionParameter.number2.name",detail:"formula.functionList.CUBERANKEDMEMBER.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_CUBE.CUBESET,functionType:t.FunctionType.Cube,description:"formula.functionList.CUBESET.description",abstract:"formula.functionList.CUBESET.abstract",functionParameter:[{name:"formula.functionList.CUBESET.functionParameter.number1.name",detail:"formula.functionList.CUBESET.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CUBESET.functionParameter.number2.name",detail:"formula.functionList.CUBESET.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_CUBE.CUBESETCOUNT,functionType:t.FunctionType.Cube,description:"formula.functionList.CUBESETCOUNT.description",abstract:"formula.functionList.CUBESETCOUNT.abstract",functionParameter:[{name:"formula.functionList.CUBESETCOUNT.functionParameter.number1.name",detail:"formula.functionList.CUBESETCOUNT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CUBESETCOUNT.functionParameter.number2.name",detail:"formula.functionList.CUBESETCOUNT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_CUBE.CUBEVALUE,functionType:t.FunctionType.Cube,description:"formula.functionList.CUBEVALUE.description",abstract:"formula.functionList.CUBEVALUE.abstract",functionParameter:[{name:"formula.functionList.CUBEVALUE.functionParameter.number1.name",detail:"formula.functionList.CUBEVALUE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CUBEVALUE.functionParameter.number2.name",detail:"formula.functionList.CUBEVALUE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]}],$e=[{functionName:t.FUNCTION_NAMES_DATABASE.DAVERAGE,functionType:t.FunctionType.Database,description:"formula.functionList.DAVERAGE.description",abstract:"formula.functionList.DAVERAGE.abstract",functionParameter:[{name:"formula.functionList.DAVERAGE.functionParameter.database.name",detail:"formula.functionList.DAVERAGE.functionParameter.database.detail",example:"A4:E10",require:1,repeat:0},{name:"formula.functionList.DAVERAGE.functionParameter.field.name",detail:"formula.functionList.DAVERAGE.functionParameter.field.detail",example:"D4",require:1,repeat:0},{name:"formula.functionList.DAVERAGE.functionParameter.criteria.name",detail:"formula.functionList.DAVERAGE.functionParameter.criteria.detail",example:"A1:B2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATABASE.DCOUNT,functionType:t.FunctionType.Database,description:"formula.functionList.DCOUNT.description",abstract:"formula.functionList.DCOUNT.abstract",functionParameter:[{name:"formula.functionList.DCOUNT.functionParameter.database.name",detail:"formula.functionList.DCOUNT.functionParameter.database.detail",example:"A4:E10",require:1,repeat:0},{name:"formula.functionList.DCOUNT.functionParameter.field.name",detail:"formula.functionList.DCOUNT.functionParameter.field.detail",example:"D4",require:1,repeat:0},{name:"formula.functionList.DCOUNT.functionParameter.criteria.name",detail:"formula.functionList.DCOUNT.functionParameter.criteria.detail",example:"A1:B2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATABASE.DCOUNTA,functionType:t.FunctionType.Database,description:"formula.functionList.DCOUNTA.description",abstract:"formula.functionList.DCOUNTA.abstract",functionParameter:[{name:"formula.functionList.DCOUNTA.functionParameter.database.name",detail:"formula.functionList.DCOUNTA.functionParameter.database.detail",example:"A4:E10",require:1,repeat:0},{name:"formula.functionList.DCOUNTA.functionParameter.field.name",detail:"formula.functionList.DCOUNTA.functionParameter.field.detail",example:"D4",require:1,repeat:0},{name:"formula.functionList.DCOUNTA.functionParameter.criteria.name",detail:"formula.functionList.DCOUNTA.functionParameter.criteria.detail",example:"A1:B2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATABASE.DGET,functionType:t.FunctionType.Database,description:"formula.functionList.DGET.description",abstract:"formula.functionList.DGET.abstract",functionParameter:[{name:"formula.functionList.DGET.functionParameter.database.name",detail:"formula.functionList.DGET.functionParameter.database.detail",example:"A4:E10",require:1,repeat:0},{name:"formula.functionList.DGET.functionParameter.field.name",detail:"formula.functionList.DGET.functionParameter.field.detail",example:"D4",require:1,repeat:0},{name:"formula.functionList.DGET.functionParameter.criteria.name",detail:"formula.functionList.DGET.functionParameter.criteria.detail",example:"A1:B2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATABASE.DMAX,functionType:t.FunctionType.Database,description:"formula.functionList.DMAX.description",abstract:"formula.functionList.DMAX.abstract",functionParameter:[{name:"formula.functionList.DMAX.functionParameter.database.name",detail:"formula.functionList.DMAX.functionParameter.database.detail",example:"A4:E10",require:1,repeat:0},{name:"formula.functionList.DMAX.functionParameter.field.name",detail:"formula.functionList.DMAX.functionParameter.field.detail",example:"D4",require:1,repeat:0},{name:"formula.functionList.DMAX.functionParameter.criteria.name",detail:"formula.functionList.DMAX.functionParameter.criteria.detail",example:"A1:B2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATABASE.DMIN,functionType:t.FunctionType.Database,description:"formula.functionList.DMIN.description",abstract:"formula.functionList.DMIN.abstract",functionParameter:[{name:"formula.functionList.DMIN.functionParameter.database.name",detail:"formula.functionList.DMIN.functionParameter.database.detail",example:"A4:E10",require:1,repeat:0},{name:"formula.functionList.DMIN.functionParameter.field.name",detail:"formula.functionList.DMIN.functionParameter.field.detail",example:"D4",require:1,repeat:0},{name:"formula.functionList.DMIN.functionParameter.criteria.name",detail:"formula.functionList.DMIN.functionParameter.criteria.detail",example:"A1:B2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATABASE.DPRODUCT,functionType:t.FunctionType.Database,description:"formula.functionList.DPRODUCT.description",abstract:"formula.functionList.DPRODUCT.abstract",functionParameter:[{name:"formula.functionList.DPRODUCT.functionParameter.database.name",detail:"formula.functionList.DPRODUCT.functionParameter.database.detail",example:"A4:E10",require:1,repeat:0},{name:"formula.functionList.DPRODUCT.functionParameter.field.name",detail:"formula.functionList.DPRODUCT.functionParameter.field.detail",example:"D4",require:1,repeat:0},{name:"formula.functionList.DPRODUCT.functionParameter.criteria.name",detail:"formula.functionList.DPRODUCT.functionParameter.criteria.detail",example:"A1:B2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATABASE.DSTDEV,functionType:t.FunctionType.Database,description:"formula.functionList.DSTDEV.description",abstract:"formula.functionList.DSTDEV.abstract",functionParameter:[{name:"formula.functionList.DSTDEV.functionParameter.database.name",detail:"formula.functionList.DSTDEV.functionParameter.database.detail",example:"A4:E10",require:1,repeat:0},{name:"formula.functionList.DSTDEV.functionParameter.field.name",detail:"formula.functionList.DSTDEV.functionParameter.field.detail",example:"D4",require:1,repeat:0},{name:"formula.functionList.DSTDEV.functionParameter.criteria.name",detail:"formula.functionList.DSTDEV.functionParameter.criteria.detail",example:"A1:B2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATABASE.DSTDEVP,functionType:t.FunctionType.Database,description:"formula.functionList.DSTDEVP.description",abstract:"formula.functionList.DSTDEVP.abstract",functionParameter:[{name:"formula.functionList.DSTDEVP.functionParameter.database.name",detail:"formula.functionList.DSTDEVP.functionParameter.database.detail",example:"A4:E10",require:1,repeat:0},{name:"formula.functionList.DSTDEVP.functionParameter.field.name",detail:"formula.functionList.DSTDEVP.functionParameter.field.detail",example:"D4",require:1,repeat:0},{name:"formula.functionList.DSTDEVP.functionParameter.criteria.name",detail:"formula.functionList.DSTDEVP.functionParameter.criteria.detail",example:"A1:B2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATABASE.DSUM,functionType:t.FunctionType.Database,description:"formula.functionList.DSUM.description",abstract:"formula.functionList.DSUM.abstract",functionParameter:[{name:"formula.functionList.DSUM.functionParameter.database.name",detail:"formula.functionList.DSUM.functionParameter.database.detail",example:"A4:E10",require:1,repeat:0},{name:"formula.functionList.DSUM.functionParameter.field.name",detail:"formula.functionList.DSUM.functionParameter.field.detail",example:"D4",require:1,repeat:0},{name:"formula.functionList.DSUM.functionParameter.criteria.name",detail:"formula.functionList.DSUM.functionParameter.criteria.detail",example:"A1:B2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATABASE.DVAR,functionType:t.FunctionType.Database,description:"formula.functionList.DVAR.description",abstract:"formula.functionList.DVAR.abstract",functionParameter:[{name:"formula.functionList.DVAR.functionParameter.database.name",detail:"formula.functionList.DVAR.functionParameter.database.detail",example:"A4:E10",require:1,repeat:0},{name:"formula.functionList.DVAR.functionParameter.field.name",detail:"formula.functionList.DVAR.functionParameter.field.detail",example:"D4",require:1,repeat:0},{name:"formula.functionList.DVAR.functionParameter.criteria.name",detail:"formula.functionList.DVAR.functionParameter.criteria.detail",example:"A1:B2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATABASE.DVARP,functionType:t.FunctionType.Database,description:"formula.functionList.DVARP.description",abstract:"formula.functionList.DVARP.abstract",functionParameter:[{name:"formula.functionList.DVARP.functionParameter.database.name",detail:"formula.functionList.DVARP.functionParameter.database.detail",example:"A4:E10",require:1,repeat:0},{name:"formula.functionList.DVARP.functionParameter.field.name",detail:"formula.functionList.DVARP.functionParameter.field.detail",example:"D4",require:1,repeat:0},{name:"formula.functionList.DVARP.functionParameter.criteria.name",detail:"formula.functionList.DVARP.functionParameter.criteria.detail",example:"A1:B2",require:1,repeat:0}]}],ze=[{functionName:t.FUNCTION_NAMES_DATE.DATE,functionType:t.FunctionType.Date,description:"formula.functionList.DATE.description",abstract:"formula.functionList.DATE.abstract",functionParameter:[{name:"formula.functionList.DATE.functionParameter.year.name",detail:"formula.functionList.DATE.functionParameter.year.detail",example:"2024",require:1,repeat:0},{name:"formula.functionList.DATE.functionParameter.month.name",detail:"formula.functionList.DATE.functionParameter.month.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.DATE.functionParameter.day.name",detail:"formula.functionList.DATE.functionParameter.day.detail",example:"1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATE.DATEDIF,functionType:t.FunctionType.Date,description:"formula.functionList.DATEDIF.description",abstract:"formula.functionList.DATEDIF.abstract",functionParameter:[{name:"formula.functionList.DATEDIF.functionParameter.startDate.name",detail:"formula.functionList.DATEDIF.functionParameter.startDate.detail",example:'"2001-6-1"',require:1,repeat:0},{name:"formula.functionList.DATEDIF.functionParameter.endDate.name",detail:"formula.functionList.DATEDIF.functionParameter.endDate.detail",example:'"2002-8-15"',require:1,repeat:0},{name:"formula.functionList.DATEDIF.functionParameter.method.name",detail:"formula.functionList.DATEDIF.functionParameter.method.detail",example:'"D"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATE.DATEVALUE,functionType:t.FunctionType.Date,description:"formula.functionList.DATEVALUE.description",abstract:"formula.functionList.DATEVALUE.abstract",functionParameter:[{name:"formula.functionList.DATEVALUE.functionParameter.dateText.name",detail:"formula.functionList.DATEVALUE.functionParameter.dateText.detail",example:'"2024-8-8"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATE.DAY,functionType:t.FunctionType.Date,description:"formula.functionList.DAY.description",abstract:"formula.functionList.DAY.abstract",functionParameter:[{name:"formula.functionList.DAY.functionParameter.serialNumber.name",detail:"formula.functionList.DAY.functionParameter.serialNumber.detail",example:'"1969-7-20"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATE.DAYS,functionType:t.FunctionType.Date,description:"formula.functionList.DAYS.description",abstract:"formula.functionList.DAYS.abstract",functionParameter:[{name:"formula.functionList.DAYS.functionParameter.endDate.name",detail:"formula.functionList.DAYS.functionParameter.endDate.detail",example:'"2021-12-31"',require:1,repeat:0},{name:"formula.functionList.DAYS.functionParameter.startDate.name",detail:"formula.functionList.DAYS.functionParameter.startDate.detail",example:'"2021-1-1"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATE.DAYS360,functionType:t.FunctionType.Date,description:"formula.functionList.DAYS360.description",abstract:"formula.functionList.DAYS360.abstract",functionParameter:[{name:"formula.functionList.DAYS360.functionParameter.startDate.name",detail:"formula.functionList.DAYS360.functionParameter.startDate.detail",example:'"2021-1-29"',require:1,repeat:0},{name:"formula.functionList.DAYS360.functionParameter.endDate.name",detail:"formula.functionList.DAYS360.functionParameter.endDate.detail",example:'"2021-3-31"',require:1,repeat:0},{name:"formula.functionList.DAYS360.functionParameter.method.name",detail:"formula.functionList.DAYS360.functionParameter.method.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATE.EDATE,functionType:t.FunctionType.Date,description:"formula.functionList.EDATE.description",abstract:"formula.functionList.EDATE.abstract",functionParameter:[{name:"formula.functionList.EDATE.functionParameter.startDate.name",detail:"formula.functionList.EDATE.functionParameter.startDate.detail",example:"A1",require:1,repeat:0},{name:"formula.functionList.EDATE.functionParameter.months.name",detail:"formula.functionList.EDATE.functionParameter.months.detail",example:"1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATE.EOMONTH,functionType:t.FunctionType.Date,description:"formula.functionList.EOMONTH.description",abstract:"formula.functionList.EOMONTH.abstract",functionParameter:[{name:"formula.functionList.EOMONTH.functionParameter.startDate.name",detail:"formula.functionList.EOMONTH.functionParameter.startDate.detail",example:'"2011-1-1"',require:1,repeat:0},{name:"formula.functionList.EOMONTH.functionParameter.months.name",detail:"formula.functionList.EOMONTH.functionParameter.months.detail",example:"1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATE.EPOCHTODATE,functionType:t.FunctionType.Date,description:"formula.functionList.EPOCHTODATE.description",abstract:"formula.functionList.EPOCHTODATE.abstract",functionParameter:[{name:"formula.functionList.EPOCHTODATE.functionParameter.timestamp.name",detail:"formula.functionList.EPOCHTODATE.functionParameter.timestamp.detail",example:"1655906710",require:1,repeat:0},{name:"formula.functionList.EPOCHTODATE.functionParameter.unit.name",detail:"formula.functionList.EPOCHTODATE.functionParameter.unit.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATE.HOUR,functionType:t.FunctionType.Date,description:"formula.functionList.HOUR.description",abstract:"formula.functionList.HOUR.abstract",functionParameter:[{name:"formula.functionList.HOUR.functionParameter.serialNumber.name",detail:"formula.functionList.HOUR.functionParameter.serialNumber.detail",example:'"2011-7-18 7:45"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATE.ISOWEEKNUM,functionType:t.FunctionType.Date,description:"formula.functionList.ISOWEEKNUM.description",abstract:"formula.functionList.ISOWEEKNUM.abstract",functionParameter:[{name:"formula.functionList.ISOWEEKNUM.functionParameter.date.name",detail:"formula.functionList.ISOWEEKNUM.functionParameter.date.detail",example:'"2012-3-9"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATE.MINUTE,functionType:t.FunctionType.Date,description:"formula.functionList.MINUTE.description",abstract:"formula.functionList.MINUTE.abstract",functionParameter:[{name:"formula.functionList.MINUTE.functionParameter.serialNumber.name",detail:"formula.functionList.MINUTE.functionParameter.serialNumber.detail",example:'"12:45"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATE.MONTH,functionType:t.FunctionType.Date,description:"formula.functionList.MONTH.description",abstract:"formula.functionList.MONTH.abstract",functionParameter:[{name:"formula.functionList.MONTH.functionParameter.serialNumber.name",detail:"formula.functionList.MONTH.functionParameter.serialNumber.detail",example:'"1969-7-20"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATE.NETWORKDAYS,functionType:t.FunctionType.Date,description:"formula.functionList.NETWORKDAYS.description",abstract:"formula.functionList.NETWORKDAYS.abstract",functionParameter:[{name:"formula.functionList.NETWORKDAYS.functionParameter.startDate.name",detail:"formula.functionList.NETWORKDAYS.functionParameter.startDate.detail",example:'"2012-10-1"',require:1,repeat:0},{name:"formula.functionList.NETWORKDAYS.functionParameter.endDate.name",detail:"formula.functionList.NETWORKDAYS.functionParameter.endDate.detail",example:'"2013-3-1"',require:1,repeat:0},{name:"formula.functionList.NETWORKDAYS.functionParameter.holidays.name",detail:"formula.functionList.NETWORKDAYS.functionParameter.holidays.detail",example:'"2012-11-22"',require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATE.NETWORKDAYS_INTL,functionType:t.FunctionType.Date,description:"formula.functionList.NETWORKDAYS_INTL.description",abstract:"formula.functionList.NETWORKDAYS_INTL.abstract",functionParameter:[{name:"formula.functionList.NETWORKDAYS_INTL.functionParameter.startDate.name",detail:"formula.functionList.NETWORKDAYS_INTL.functionParameter.startDate.detail",example:'"2012-10-1"',require:1,repeat:0},{name:"formula.functionList.NETWORKDAYS_INTL.functionParameter.endDate.name",detail:"formula.functionList.NETWORKDAYS_INTL.functionParameter.endDate.detail",example:'"2013-3-1"',require:1,repeat:0},{name:"formula.functionList.NETWORKDAYS_INTL.functionParameter.weekend.name",detail:"formula.functionList.NETWORKDAYS_INTL.functionParameter.weekend.detail",example:"6",require:0,repeat:0},{name:"formula.functionList.NETWORKDAYS_INTL.functionParameter.holidays.name",detail:"formula.functionList.NETWORKDAYS_INTL.functionParameter.holidays.detail",example:'"2012-11-22"',require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATE.NOW,functionType:t.FunctionType.Date,description:"formula.functionList.NOW.description",abstract:"formula.functionList.NOW.abstract",functionParameter:[]},{functionName:t.FUNCTION_NAMES_DATE.SECOND,functionType:t.FunctionType.Date,description:"formula.functionList.SECOND.description",abstract:"formula.functionList.SECOND.abstract",functionParameter:[{name:"formula.functionList.SECOND.functionParameter.serialNumber.name",detail:"formula.functionList.SECOND.functionParameter.serialNumber.detail",example:'"4:48:18"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATE.TIME,functionType:t.FunctionType.Date,description:"formula.functionList.TIME.description",abstract:"formula.functionList.TIME.abstract",functionParameter:[{name:"formula.functionList.TIME.functionParameter.hour.name",detail:"formula.functionList.TIME.functionParameter.hour.detail",example:"15",require:1,repeat:0},{name:"formula.functionList.TIME.functionParameter.minute.name",detail:"formula.functionList.TIME.functionParameter.minute.detail",example:"20",require:1,repeat:0},{name:"formula.functionList.TIME.functionParameter.second.name",detail:"formula.functionList.TIME.functionParameter.second.detail",example:"59",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATE.TIMEVALUE,functionType:t.FunctionType.Date,description:"formula.functionList.TIMEVALUE.description",abstract:"formula.functionList.TIMEVALUE.abstract",functionParameter:[{name:"formula.functionList.TIMEVALUE.functionParameter.timeText.name",detail:"formula.functionList.TIMEVALUE.functionParameter.timeText.detail",example:'"15:20:59"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATE.TO_DATE,functionType:t.FunctionType.Date,description:"formula.functionList.TO_DATE.description",abstract:"formula.functionList.TO_DATE.abstract",functionParameter:[{name:"formula.functionList.TO_DATE.functionParameter.value.name",detail:"formula.functionList.TO_DATE.functionParameter.value.detail",example:"40826.4375",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATE.TODAY,functionType:t.FunctionType.Date,description:"formula.functionList.TODAY.description",abstract:"formula.functionList.TODAY.abstract",functionParameter:[]},{functionName:t.FUNCTION_NAMES_DATE.WEEKDAY,functionType:t.FunctionType.Date,description:"formula.functionList.WEEKDAY.description",abstract:"formula.functionList.WEEKDAY.abstract",functionParameter:[{name:"formula.functionList.WEEKDAY.functionParameter.serialNumber.name",detail:"formula.functionList.WEEKDAY.functionParameter.serialNumber.detail",example:'"2008-2-14"',require:1,repeat:0},{name:"formula.functionList.WEEKDAY.functionParameter.returnType.name",detail:"formula.functionList.WEEKDAY.functionParameter.returnType.detail",example:"2",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATE.WEEKNUM,functionType:t.FunctionType.Date,description:"formula.functionList.WEEKNUM.description",abstract:"formula.functionList.WEEKNUM.abstract",functionParameter:[{name:"formula.functionList.WEEKNUM.functionParameter.serialNumber.name",detail:"formula.functionList.WEEKNUM.functionParameter.serialNumber.detail",example:'"2012-3-9"',require:1,repeat:0},{name:"formula.functionList.WEEKNUM.functionParameter.returnType.name",detail:"formula.functionList.WEEKNUM.functionParameter.returnType.detail",example:"2",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATE.WORKDAY,functionType:t.FunctionType.Date,description:"formula.functionList.WORKDAY.description",abstract:"formula.functionList.WORKDAY.abstract",functionParameter:[{name:"formula.functionList.WORKDAY.functionParameter.startDate.name",detail:"formula.functionList.WORKDAY.functionParameter.startDate.detail",example:'"2008-10-1"',require:1,repeat:0},{name:"formula.functionList.WORKDAY.functionParameter.days.name",detail:"formula.functionList.WORKDAY.functionParameter.days.detail",example:"151",require:1,repeat:0},{name:"formula.functionList.WORKDAY.functionParameter.holidays.name",detail:"formula.functionList.WORKDAY.functionParameter.holidays.detail",example:'"2008-11-26"',require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATE.WORKDAY_INTL,functionType:t.FunctionType.Date,description:"formula.functionList.WORKDAY_INTL.description",abstract:"formula.functionList.WORKDAY_INTL.abstract",functionParameter:[{name:"formula.functionList.WORKDAY_INTL.functionParameter.startDate.name",detail:"formula.functionList.WORKDAY_INTL.functionParameter.startDate.detail",example:'"2008-10-1"',require:1,repeat:0},{name:"formula.functionList.WORKDAY_INTL.functionParameter.days.name",detail:"formula.functionList.WORKDAY_INTL.functionParameter.days.detail",example:"151",require:1,repeat:0},{name:"formula.functionList.WORKDAY_INTL.functionParameter.weekend.name",detail:"formula.functionList.WORKDAY_INTL.functionParameter.weekend.detail",example:"6",require:0,repeat:0},{name:"formula.functionList.WORKDAY_INTL.functionParameter.holidays.name",detail:"formula.functionList.WORKDAY_INTL.functionParameter.holidays.detail",example:'"2008-11-26"',require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATE.YEAR,functionType:t.FunctionType.Date,description:"formula.functionList.YEAR.description",abstract:"formula.functionList.YEAR.abstract",functionParameter:[{name:"formula.functionList.YEAR.functionParameter.serialNumber.name",detail:"formula.functionList.YEAR.functionParameter.serialNumber.detail",example:'"1969-7-20"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_DATE.YEARFRAC,functionType:t.FunctionType.Date,description:"formula.functionList.YEARFRAC.description",abstract:"formula.functionList.YEARFRAC.abstract",functionParameter:[{name:"formula.functionList.YEARFRAC.functionParameter.startDate.name",detail:"formula.functionList.YEARFRAC.functionParameter.startDate.detail",example:'"2012-1-1"',require:1,repeat:0},{name:"formula.functionList.YEARFRAC.functionParameter.endDate.name",detail:"formula.functionList.YEARFRAC.functionParameter.endDate.detail",example:'"2012-7-30"',require:1,repeat:0},{name:"formula.functionList.YEARFRAC.functionParameter.basis.name",detail:"formula.functionList.YEARFRAC.functionParameter.basis.detail",example:"1",require:0,repeat:0}]}],Ze=[{functionName:t.FUNCTION_NAMES_ENGINEERING.BESSELI,functionType:t.FunctionType.Engineering,description:"formula.functionList.BESSELI.description",abstract:"formula.functionList.BESSELI.abstract",functionParameter:[{name:"formula.functionList.BESSELI.functionParameter.x.name",detail:"formula.functionList.BESSELI.functionParameter.x.detail",example:"1.5",require:1,repeat:0},{name:"formula.functionList.BESSELI.functionParameter.n.name",detail:"formula.functionList.BESSELI.functionParameter.n.detail",example:"1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.BESSELJ,functionType:t.FunctionType.Engineering,description:"formula.functionList.BESSELJ.description",abstract:"formula.functionList.BESSELJ.abstract",functionParameter:[{name:"formula.functionList.BESSELJ.functionParameter.x.name",detail:"formula.functionList.BESSELJ.functionParameter.x.detail",example:"1.5",require:1,repeat:0},{name:"formula.functionList.BESSELJ.functionParameter.n.name",detail:"formula.functionList.BESSELJ.functionParameter.n.detail",example:"1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.BESSELK,functionType:t.FunctionType.Engineering,description:"formula.functionList.BESSELK.description",abstract:"formula.functionList.BESSELK.abstract",functionParameter:[{name:"formula.functionList.BESSELK.functionParameter.x.name",detail:"formula.functionList.BESSELK.functionParameter.x.detail",example:"1.5",require:1,repeat:0},{name:"formula.functionList.BESSELK.functionParameter.n.name",detail:"formula.functionList.BESSELK.functionParameter.n.detail",example:"1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.BESSELY,functionType:t.FunctionType.Engineering,description:"formula.functionList.BESSELY.description",abstract:"formula.functionList.BESSELY.abstract",functionParameter:[{name:"formula.functionList.BESSELY.functionParameter.x.name",detail:"formula.functionList.BESSELY.functionParameter.x.detail",example:"1.5",require:1,repeat:0},{name:"formula.functionList.BESSELY.functionParameter.n.name",detail:"formula.functionList.BESSELY.functionParameter.n.detail",example:"1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.BIN2DEC,functionType:t.FunctionType.Engineering,description:"formula.functionList.BIN2DEC.description",abstract:"formula.functionList.BIN2DEC.abstract",functionParameter:[{name:"formula.functionList.BIN2DEC.functionParameter.number.name",detail:"formula.functionList.BIN2DEC.functionParameter.number.detail",example:"1100100",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.BIN2HEX,functionType:t.FunctionType.Engineering,description:"formula.functionList.BIN2HEX.description",abstract:"formula.functionList.BIN2HEX.abstract",functionParameter:[{name:"formula.functionList.BIN2HEX.functionParameter.number.name",detail:"formula.functionList.BIN2HEX.functionParameter.number.detail",example:"11111011",require:1,repeat:0},{name:"formula.functionList.BIN2HEX.functionParameter.places.name",detail:"formula.functionList.BIN2HEX.functionParameter.places.detail",example:"4",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.BIN2OCT,functionType:t.FunctionType.Engineering,description:"formula.functionList.BIN2OCT.description",abstract:"formula.functionList.BIN2OCT.abstract",functionParameter:[{name:"formula.functionList.BIN2OCT.functionParameter.number.name",detail:"formula.functionList.BIN2OCT.functionParameter.number.detail",example:"1001",require:1,repeat:0},{name:"formula.functionList.BIN2OCT.functionParameter.places.name",detail:"formula.functionList.BIN2OCT.functionParameter.places.detail",example:"3",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.BITAND,functionType:t.FunctionType.Engineering,description:"formula.functionList.BITAND.description",abstract:"formula.functionList.BITAND.abstract",functionParameter:[{name:"formula.functionList.BITAND.functionParameter.number1.name",detail:"formula.functionList.BITAND.functionParameter.number1.detail",example:"13",require:1,repeat:0},{name:"formula.functionList.BITAND.functionParameter.number2.name",detail:"formula.functionList.BITAND.functionParameter.number2.detail",example:"25",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.BITLSHIFT,functionType:t.FunctionType.Engineering,description:"formula.functionList.BITLSHIFT.description",abstract:"formula.functionList.BITLSHIFT.abstract",functionParameter:[{name:"formula.functionList.BITLSHIFT.functionParameter.number.name",detail:"formula.functionList.BITLSHIFT.functionParameter.number.detail",example:"4",require:1,repeat:0},{name:"formula.functionList.BITLSHIFT.functionParameter.shiftAmount.name",detail:"formula.functionList.BITLSHIFT.functionParameter.shiftAmount.detail",example:"2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.BITOR,functionType:t.FunctionType.Engineering,description:"formula.functionList.BITOR.description",abstract:"formula.functionList.BITOR.abstract",functionParameter:[{name:"formula.functionList.BITOR.functionParameter.number1.name",detail:"formula.functionList.BITOR.functionParameter.number1.detail",example:"23",require:1,repeat:0},{name:"formula.functionList.BITOR.functionParameter.number2.name",detail:"formula.functionList.BITOR.functionParameter.number2.detail",example:"10",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.BITRSHIFT,functionType:t.FunctionType.Engineering,description:"formula.functionList.BITRSHIFT.description",abstract:"formula.functionList.BITRSHIFT.abstract",functionParameter:[{name:"formula.functionList.BITRSHIFT.functionParameter.number.name",detail:"formula.functionList.BITRSHIFT.functionParameter.number.detail",example:"13",require:1,repeat:0},{name:"formula.functionList.BITRSHIFT.functionParameter.shiftAmount.name",detail:"formula.functionList.BITRSHIFT.functionParameter.shiftAmount.detail",example:"2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.BITXOR,functionType:t.FunctionType.Engineering,description:"formula.functionList.BITXOR.description",abstract:"formula.functionList.BITXOR.abstract",functionParameter:[{name:"formula.functionList.BITXOR.functionParameter.number1.name",detail:"formula.functionList.BITXOR.functionParameter.number1.detail",example:"5",require:1,repeat:0},{name:"formula.functionList.BITXOR.functionParameter.number2.name",detail:"formula.functionList.BITXOR.functionParameter.number2.detail",example:"3",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.COMPLEX,functionType:t.FunctionType.Engineering,description:"formula.functionList.COMPLEX.description",abstract:"formula.functionList.COMPLEX.abstract",functionParameter:[{name:"formula.functionList.COMPLEX.functionParameter.realNum.name",detail:"formula.functionList.COMPLEX.functionParameter.realNum.detail",example:"3",require:1,repeat:0},{name:"formula.functionList.COMPLEX.functionParameter.iNum.name",detail:"formula.functionList.COMPLEX.functionParameter.iNum.detail",example:"4",require:1,repeat:0},{name:"formula.functionList.COMPLEX.functionParameter.suffix.name",detail:"formula.functionList.COMPLEX.functionParameter.suffix.detail",example:'"i"',require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.CONVERT,functionType:t.FunctionType.Engineering,description:"formula.functionList.CONVERT.description",abstract:"formula.functionList.CONVERT.abstract",functionParameter:[{name:"formula.functionList.CONVERT.functionParameter.number.name",detail:"formula.functionList.CONVERT.functionParameter.number.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.CONVERT.functionParameter.fromUnit.name",detail:"formula.functionList.CONVERT.functionParameter.fromUnit.detail",example:'"lbm"',require:1,repeat:0},{name:"formula.functionList.CONVERT.functionParameter.toUnit.name",detail:"formula.functionList.CONVERT.functionParameter.toUnit.detail",example:'"kg"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.DEC2BIN,functionType:t.FunctionType.Engineering,description:"formula.functionList.DEC2BIN.description",abstract:"formula.functionList.DEC2BIN.abstract",functionParameter:[{name:"formula.functionList.DEC2BIN.functionParameter.number.name",detail:"formula.functionList.DEC2BIN.functionParameter.number.detail",example:"9",require:1,repeat:0},{name:"formula.functionList.DEC2BIN.functionParameter.places.name",detail:"formula.functionList.DEC2BIN.functionParameter.places.detail",example:"4",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.DEC2HEX,functionType:t.FunctionType.Engineering,description:"formula.functionList.DEC2HEX.description",abstract:"formula.functionList.DEC2HEX.abstract",functionParameter:[{name:"formula.functionList.DEC2HEX.functionParameter.number.name",detail:"formula.functionList.DEC2HEX.functionParameter.number.detail",example:"100",require:1,repeat:0},{name:"formula.functionList.DEC2HEX.functionParameter.places.name",detail:"formula.functionList.DEC2HEX.functionParameter.places.detail",example:"4",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.DEC2OCT,functionType:t.FunctionType.Engineering,description:"formula.functionList.DEC2OCT.description",abstract:"formula.functionList.DEC2OCT.abstract",functionParameter:[{name:"formula.functionList.DEC2OCT.functionParameter.number.name",detail:"formula.functionList.DEC2OCT.functionParameter.number.detail",example:"58",require:1,repeat:0},{name:"formula.functionList.DEC2OCT.functionParameter.places.name",detail:"formula.functionList.DEC2OCT.functionParameter.places.detail",example:"3",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.DELTA,functionType:t.FunctionType.Engineering,description:"formula.functionList.DELTA.description",abstract:"formula.functionList.DELTA.abstract",functionParameter:[{name:"formula.functionList.DELTA.functionParameter.number1.name",detail:"formula.functionList.DELTA.functionParameter.number1.detail",example:"5",require:1,repeat:0},{name:"formula.functionList.DELTA.functionParameter.number2.name",detail:"formula.functionList.DELTA.functionParameter.number2.detail",example:"4",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.ERF,functionType:t.FunctionType.Engineering,description:"formula.functionList.ERF.description",abstract:"formula.functionList.ERF.abstract",functionParameter:[{name:"formula.functionList.ERF.functionParameter.lowerLimit.name",detail:"formula.functionList.ERF.functionParameter.lowerLimit.detail",example:"0.745",require:1,repeat:0},{name:"formula.functionList.ERF.functionParameter.upperLimit.name",detail:"formula.functionList.ERF.functionParameter.upperLimit.detail",example:"2",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.ERF_PRECISE,functionType:t.FunctionType.Engineering,description:"formula.functionList.ERF_PRECISE.description",abstract:"formula.functionList.ERF_PRECISE.abstract",functionParameter:[{name:"formula.functionList.ERF_PRECISE.functionParameter.x.name",detail:"formula.functionList.ERF_PRECISE.functionParameter.x.detail",example:"1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.ERFC,functionType:t.FunctionType.Engineering,description:"formula.functionList.ERFC.description",abstract:"formula.functionList.ERFC.abstract",functionParameter:[{name:"formula.functionList.ERFC.functionParameter.x.name",detail:"formula.functionList.ERFC.functionParameter.x.detail",example:"1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.ERFC_PRECISE,functionType:t.FunctionType.Engineering,description:"formula.functionList.ERFC_PRECISE.description",abstract:"formula.functionList.ERFC_PRECISE.abstract",functionParameter:[{name:"formula.functionList.ERFC_PRECISE.functionParameter.x.name",detail:"formula.functionList.ERFC_PRECISE.functionParameter.x.detail",example:"1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.GESTEP,functionType:t.FunctionType.Engineering,description:"formula.functionList.GESTEP.description",abstract:"formula.functionList.GESTEP.abstract",functionParameter:[{name:"formula.functionList.GESTEP.functionParameter.number.name",detail:"formula.functionList.GESTEP.functionParameter.number.detail",example:"5",require:1,repeat:0},{name:"formula.functionList.GESTEP.functionParameter.step.name",detail:"formula.functionList.GESTEP.functionParameter.step.detail",example:"4",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.HEX2BIN,functionType:t.FunctionType.Engineering,description:"formula.functionList.HEX2BIN.description",abstract:"formula.functionList.HEX2BIN.abstract",functionParameter:[{name:"formula.functionList.HEX2BIN.functionParameter.number.name",detail:"formula.functionList.HEX2BIN.functionParameter.number.detail",example:'"F"',require:1,repeat:0},{name:"formula.functionList.HEX2BIN.functionParameter.places.name",detail:"formula.functionList.HEX2BIN.functionParameter.places.detail",example:"8",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.HEX2DEC,functionType:t.FunctionType.Engineering,description:"formula.functionList.HEX2DEC.description",abstract:"formula.functionList.HEX2DEC.abstract",functionParameter:[{name:"formula.functionList.HEX2DEC.functionParameter.number.name",detail:"formula.functionList.HEX2DEC.functionParameter.number.detail",example:'"A5"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.HEX2OCT,functionType:t.FunctionType.Engineering,description:"formula.functionList.HEX2OCT.description",abstract:"formula.functionList.HEX2OCT.abstract",functionParameter:[{name:"formula.functionList.HEX2OCT.functionParameter.number.name",detail:"formula.functionList.HEX2OCT.functionParameter.number.detail",example:'"F"',require:1,repeat:0},{name:"formula.functionList.HEX2OCT.functionParameter.places.name",detail:"formula.functionList.HEX2OCT.functionParameter.places.detail",example:"3",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.IMABS,functionType:t.FunctionType.Engineering,description:"formula.functionList.IMABS.description",abstract:"formula.functionList.IMABS.abstract",functionParameter:[{name:"formula.functionList.IMABS.functionParameter.inumber.name",detail:"formula.functionList.IMABS.functionParameter.inumber.detail",example:'"5+12i"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.IMAGINARY,functionType:t.FunctionType.Engineering,description:"formula.functionList.IMAGINARY.description",abstract:"formula.functionList.IMAGINARY.abstract",functionParameter:[{name:"formula.functionList.IMAGINARY.functionParameter.inumber.name",detail:"formula.functionList.IMAGINARY.functionParameter.inumber.detail",example:'"3+4i"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.IMARGUMENT,functionType:t.FunctionType.Engineering,description:"formula.functionList.IMARGUMENT.description",abstract:"formula.functionList.IMARGUMENT.abstract",functionParameter:[{name:"formula.functionList.IMARGUMENT.functionParameter.inumber.name",detail:"formula.functionList.IMARGUMENT.functionParameter.inumber.detail",example:'"3+4i"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.IMCONJUGATE,functionType:t.FunctionType.Engineering,description:"formula.functionList.IMCONJUGATE.description",abstract:"formula.functionList.IMCONJUGATE.abstract",functionParameter:[{name:"formula.functionList.IMCONJUGATE.functionParameter.inumber.name",detail:"formula.functionList.IMCONJUGATE.functionParameter.inumber.detail",example:'"3+4i"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.IMCOS,functionType:t.FunctionType.Engineering,description:"formula.functionList.IMCOS.description",abstract:"formula.functionList.IMCOS.abstract",functionParameter:[{name:"formula.functionList.IMCOS.functionParameter.inumber.name",detail:"formula.functionList.IMCOS.functionParameter.inumber.detail",example:'"1+i"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.IMCOSH,functionType:t.FunctionType.Engineering,description:"formula.functionList.IMCOSH.description",abstract:"formula.functionList.IMCOSH.abstract",functionParameter:[{name:"formula.functionList.IMCOSH.functionParameter.inumber.name",detail:"formula.functionList.IMCOSH.functionParameter.inumber.detail",example:'"4+3i"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.IMCOT,functionType:t.FunctionType.Engineering,description:"formula.functionList.IMCOT.description",abstract:"formula.functionList.IMCOT.abstract",functionParameter:[{name:"formula.functionList.IMCOT.functionParameter.inumber.name",detail:"formula.functionList.IMCOT.functionParameter.inumber.detail",example:'"4+3i"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.IMCOTH,functionType:t.FunctionType.Engineering,description:"formula.functionList.IMCOTH.description",abstract:"formula.functionList.IMCOTH.abstract",functionParameter:[{name:"formula.functionList.IMCOTH.functionParameter.inumber.name",detail:"formula.functionList.IMCOTH.functionParameter.inumber.detail",example:'"4+3i"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.IMCSC,functionType:t.FunctionType.Engineering,description:"formula.functionList.IMCSC.description",abstract:"formula.functionList.IMCSC.abstract",functionParameter:[{name:"formula.functionList.IMCSC.functionParameter.inumber.name",detail:"formula.functionList.IMCSC.functionParameter.inumber.detail",example:'"4+3i"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.IMCSCH,functionType:t.FunctionType.Engineering,description:"formula.functionList.IMCSCH.description",abstract:"formula.functionList.IMCSCH.abstract",functionParameter:[{name:"formula.functionList.IMCSCH.functionParameter.inumber.name",detail:"formula.functionList.IMCSCH.functionParameter.inumber.detail",example:'"4+3i"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.IMDIV,functionType:t.FunctionType.Engineering,description:"formula.functionList.IMDIV.description",abstract:"formula.functionList.IMDIV.abstract",functionParameter:[{name:"formula.functionList.IMDIV.functionParameter.inumber1.name",detail:"formula.functionList.IMDIV.functionParameter.inumber1.detail",example:'"-238+240i"',require:1,repeat:0},{name:"formula.functionList.IMDIV.functionParameter.inumber2.name",detail:"formula.functionList.IMDIV.functionParameter.inumber2.detail",example:'"10+24i"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.IMEXP,functionType:t.FunctionType.Engineering,description:"formula.functionList.IMEXP.description",abstract:"formula.functionList.IMEXP.abstract",functionParameter:[{name:"formula.functionList.IMEXP.functionParameter.inumber.name",detail:"formula.functionList.IMEXP.functionParameter.inumber.detail",example:'"1+i"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.IMLN,functionType:t.FunctionType.Engineering,description:"formula.functionList.IMLN.description",abstract:"formula.functionList.IMLN.abstract",functionParameter:[{name:"formula.functionList.IMLN.functionParameter.inumber.name",detail:"formula.functionList.IMLN.functionParameter.inumber.detail",example:'"3+4i"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.IMLOG,functionType:t.FunctionType.Engineering,description:"formula.functionList.IMLOG.description",abstract:"formula.functionList.IMLOG.abstract",functionParameter:[{name:"formula.functionList.IMLOG.functionParameter.inumber.name",detail:"formula.functionList.IMLOG.functionParameter.inumber.detail",example:'"3+4i"',require:1,repeat:0},{name:"formula.functionList.IMLOG.functionParameter.base.name",detail:"formula.functionList.IMLOG.functionParameter.base.detail",example:"10",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.IMLOG10,functionType:t.FunctionType.Engineering,description:"formula.functionList.IMLOG10.description",abstract:"formula.functionList.IMLOG10.abstract",functionParameter:[{name:"formula.functionList.IMLOG10.functionParameter.inumber.name",detail:"formula.functionList.IMLOG10.functionParameter.inumber.detail",example:'"3+4i"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.IMLOG2,functionType:t.FunctionType.Engineering,description:"formula.functionList.IMLOG2.description",abstract:"formula.functionList.IMLOG2.abstract",functionParameter:[{name:"formula.functionList.IMLOG2.functionParameter.inumber.name",detail:"formula.functionList.IMLOG2.functionParameter.inumber.detail",example:'"3+4i"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.IMPOWER,functionType:t.FunctionType.Engineering,description:"formula.functionList.IMPOWER.description",abstract:"formula.functionList.IMPOWER.abstract",functionParameter:[{name:"formula.functionList.IMPOWER.functionParameter.inumber.name",detail:"formula.functionList.IMPOWER.functionParameter.inumber.detail",example:'"2+3i"',require:1,repeat:0},{name:"formula.functionList.IMPOWER.functionParameter.number.name",detail:"formula.functionList.IMPOWER.functionParameter.number.detail",example:"3",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.IMPRODUCT,functionType:t.FunctionType.Engineering,description:"formula.functionList.IMPRODUCT.description",abstract:"formula.functionList.IMPRODUCT.abstract",functionParameter:[{name:"formula.functionList.IMPRODUCT.functionParameter.inumber1.name",detail:"formula.functionList.IMPRODUCT.functionParameter.inumber1.detail",example:'"3+4i"',require:1,repeat:0},{name:"formula.functionList.IMPRODUCT.functionParameter.inumber2.name",detail:"formula.functionList.IMPRODUCT.functionParameter.inumber2.detail",example:'"5-3i"',require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.IMREAL,functionType:t.FunctionType.Engineering,description:"formula.functionList.IMREAL.description",abstract:"formula.functionList.IMREAL.abstract",functionParameter:[{name:"formula.functionList.IMREAL.functionParameter.inumber.name",detail:"formula.functionList.IMREAL.functionParameter.inumber.detail",example:'"6-9i"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.IMSEC,functionType:t.FunctionType.Engineering,description:"formula.functionList.IMSEC.description",abstract:"formula.functionList.IMSEC.abstract",functionParameter:[{name:"formula.functionList.IMSEC.functionParameter.inumber.name",detail:"formula.functionList.IMSEC.functionParameter.inumber.detail",example:'"4+3i"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.IMSECH,functionType:t.FunctionType.Engineering,description:"formula.functionList.IMSECH.description",abstract:"formula.functionList.IMSECH.abstract",functionParameter:[{name:"formula.functionList.IMSECH.functionParameter.inumber.name",detail:"formula.functionList.IMSECH.functionParameter.inumber.detail",example:'"4+3i"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.IMSIN,functionType:t.FunctionType.Engineering,description:"formula.functionList.IMSIN.description",abstract:"formula.functionList.IMSIN.abstract",functionParameter:[{name:"formula.functionList.IMSIN.functionParameter.inumber.name",detail:"formula.functionList.IMSIN.functionParameter.inumber.detail",example:'"4+3i"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.IMSINH,functionType:t.FunctionType.Engineering,description:"formula.functionList.IMSINH.description",abstract:"formula.functionList.IMSINH.abstract",functionParameter:[{name:"formula.functionList.IMSINH.functionParameter.inumber.name",detail:"formula.functionList.IMSINH.functionParameter.inumber.detail",example:'"4+3i"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.IMSQRT,functionType:t.FunctionType.Engineering,description:"formula.functionList.IMSQRT.description",abstract:"formula.functionList.IMSQRT.abstract",functionParameter:[{name:"formula.functionList.IMSQRT.functionParameter.inumber.name",detail:"formula.functionList.IMSQRT.functionParameter.inumber.detail",example:'"1+i"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.IMSUB,functionType:t.FunctionType.Engineering,description:"formula.functionList.IMSUB.description",abstract:"formula.functionList.IMSUB.abstract",functionParameter:[{name:"formula.functionList.IMSUB.functionParameter.inumber1.name",detail:"formula.functionList.IMSUB.functionParameter.inumber1.detail",example:'"13+4i"',require:1,repeat:0},{name:"formula.functionList.IMSUB.functionParameter.inumber2.name",detail:"formula.functionList.IMSUB.functionParameter.inumber2.detail",example:'"5+3i"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.IMSUM,functionType:t.FunctionType.Engineering,description:"formula.functionList.IMSUM.description",abstract:"formula.functionList.IMSUM.abstract",functionParameter:[{name:"formula.functionList.IMSUM.functionParameter.inumber1.name",detail:"formula.functionList.IMSUM.functionParameter.inumber1.detail",example:'"3+4i"',require:1,repeat:0},{name:"formula.functionList.IMSUM.functionParameter.inumber2.name",detail:"formula.functionList.IMSUM.functionParameter.inumber2.detail",example:'"5-3i"',require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.IMTAN,functionType:t.FunctionType.Engineering,description:"formula.functionList.IMTAN.description",abstract:"formula.functionList.IMTAN.abstract",functionParameter:[{name:"formula.functionList.IMTAN.functionParameter.inumber.name",detail:"formula.functionList.IMTAN.functionParameter.inumber.detail",example:'"4+3i"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.IMTANH,functionType:t.FunctionType.Engineering,description:"formula.functionList.IMTANH.description",abstract:"formula.functionList.IMTANH.abstract",functionParameter:[{name:"formula.functionList.IMTANH.functionParameter.inumber.name",detail:"formula.functionList.IMTANH.functionParameter.inumber.detail",example:'"4+3i"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.OCT2BIN,functionType:t.FunctionType.Engineering,description:"formula.functionList.OCT2BIN.description",abstract:"formula.functionList.OCT2BIN.abstract",functionParameter:[{name:"formula.functionList.OCT2BIN.functionParameter.number.name",detail:"formula.functionList.OCT2BIN.functionParameter.number.detail",example:"3",require:1,repeat:0},{name:"formula.functionList.OCT2BIN.functionParameter.places.name",detail:"formula.functionList.OCT2BIN.functionParameter.places.detail",example:"3",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.OCT2DEC,functionType:t.FunctionType.Engineering,description:"formula.functionList.OCT2DEC.description",abstract:"formula.functionList.OCT2DEC.abstract",functionParameter:[{name:"formula.functionList.OCT2DEC.functionParameter.number.name",detail:"formula.functionList.OCT2DEC.functionParameter.number.detail",example:"54",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_ENGINEERING.OCT2HEX,functionType:t.FunctionType.Engineering,description:"formula.functionList.OCT2HEX.description",abstract:"formula.functionList.OCT2HEX.abstract",functionParameter:[{name:"formula.functionList.OCT2HEX.functionParameter.number.name",detail:"formula.functionList.OCT2HEX.functionParameter.number.detail",example:"100",require:1,repeat:0},{name:"formula.functionList.OCT2HEX.functionParameter.places.name",detail:"formula.functionList.OCT2HEX.functionParameter.places.detail",example:"4",require:0,repeat:0}]}],Je=[{functionName:t.FUNCTION_NAMES_FINANCIAL.ACCRINT,functionType:t.FunctionType.Financial,description:"formula.functionList.ACCRINT.description",abstract:"formula.functionList.ACCRINT.abstract",functionParameter:[{name:"formula.functionList.ACCRINT.functionParameter.issue.name",detail:"formula.functionList.ACCRINT.functionParameter.issue.detail",example:'"2008-3-1"',require:1,repeat:0},{name:"formula.functionList.ACCRINT.functionParameter.firstInterest.name",detail:"formula.functionList.ACCRINT.functionParameter.firstInterest.detail",example:'"2008-8-31"',require:1,repeat:0},{name:"formula.functionList.ACCRINT.functionParameter.settlement.name",detail:"formula.functionList.ACCRINT.functionParameter.settlement.detail",example:'"2008-5-1"',require:1,repeat:0},{name:"formula.functionList.ACCRINT.functionParameter.rate.name",detail:"formula.functionList.ACCRINT.functionParameter.rate.detail",example:"10%",require:1,repeat:0},{name:"formula.functionList.ACCRINT.functionParameter.par.name",detail:"formula.functionList.ACCRINT.functionParameter.par.detail",example:"1000",require:1,repeat:0},{name:"formula.functionList.ACCRINT.functionParameter.frequency.name",detail:"formula.functionList.ACCRINT.functionParameter.frequency.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.ACCRINT.functionParameter.basis.name",detail:"formula.functionList.ACCRINT.functionParameter.basis.detail",example:"0",require:0,repeat:0},{name:"formula.functionList.ACCRINT.functionParameter.calcMethod.name",detail:"formula.functionList.ACCRINT.functionParameter.calcMethod.detail",example:"true",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.ACCRINTM,functionType:t.FunctionType.Financial,description:"formula.functionList.ACCRINTM.description",abstract:"formula.functionList.ACCRINTM.abstract",functionParameter:[{name:"formula.functionList.ACCRINTM.functionParameter.issue.name",detail:"formula.functionList.ACCRINTM.functionParameter.issue.detail",example:'"2008-4-1"',require:1,repeat:0},{name:"formula.functionList.ACCRINTM.functionParameter.settlement.name",detail:"formula.functionList.ACCRINTM.functionParameter.settlement.detail",example:'"2008-6-15"',require:1,repeat:0},{name:"formula.functionList.ACCRINTM.functionParameter.rate.name",detail:"formula.functionList.ACCRINTM.functionParameter.rate.detail",example:"10%",require:1,repeat:0},{name:"formula.functionList.ACCRINTM.functionParameter.par.name",detail:"formula.functionList.ACCRINTM.functionParameter.par.detail",example:"1000",require:1,repeat:0},{name:"formula.functionList.ACCRINTM.functionParameter.basis.name",detail:"formula.functionList.ACCRINTM.functionParameter.basis.detail",example:"3",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.AMORDEGRC,functionType:t.FunctionType.Financial,description:"formula.functionList.AMORDEGRC.description",abstract:"formula.functionList.AMORDEGRC.abstract",functionParameter:[{name:"formula.functionList.AMORDEGRC.functionParameter.number1.name",detail:"formula.functionList.AMORDEGRC.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.AMORDEGRC.functionParameter.number2.name",detail:"formula.functionList.AMORDEGRC.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.AMORLINC,functionType:t.FunctionType.Financial,description:"formula.functionList.AMORLINC.description",abstract:"formula.functionList.AMORLINC.abstract",functionParameter:[{name:"formula.functionList.AMORLINC.functionParameter.cost.name",detail:"formula.functionList.AMORLINC.functionParameter.cost.detail",example:"2400",require:1,repeat:0},{name:"formula.functionList.AMORLINC.functionParameter.datePurchased.name",detail:"formula.functionList.AMORLINC.functionParameter.datePurchased.detail",example:'"2008-8-19"',require:1,repeat:0},{name:"formula.functionList.AMORLINC.functionParameter.firstPeriod.name",detail:"formula.functionList.AMORLINC.functionParameter.firstPeriod.detail",example:'"2008-12-31"',require:1,repeat:0},{name:"formula.functionList.AMORLINC.functionParameter.salvage.name",detail:"formula.functionList.AMORLINC.functionParameter.salvage.detail",example:"300",require:1,repeat:0},{name:"formula.functionList.AMORLINC.functionParameter.period.name",detail:"formula.functionList.AMORLINC.functionParameter.period.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.AMORLINC.functionParameter.rate.name",detail:"formula.functionList.AMORLINC.functionParameter.rate.detail",example:"15%",require:1,repeat:0},{name:"formula.functionList.AMORLINC.functionParameter.basis.name",detail:"formula.functionList.AMORLINC.functionParameter.basis.detail",example:"0",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.COUPDAYBS,functionType:t.FunctionType.Financial,description:"formula.functionList.COUPDAYBS.description",abstract:"formula.functionList.COUPDAYBS.abstract",functionParameter:[{name:"formula.functionList.COUPDAYBS.functionParameter.settlement.name",detail:"formula.functionList.COUPDAYBS.functionParameter.settlement.detail",example:'"2011-1-25"',require:1,repeat:0},{name:"formula.functionList.COUPDAYBS.functionParameter.maturity.name",detail:"formula.functionList.COUPDAYBS.functionParameter.maturity.detail",example:'"2011-11-15"',require:1,repeat:0},{name:"formula.functionList.COUPDAYBS.functionParameter.frequency.name",detail:"formula.functionList.COUPDAYBS.functionParameter.frequency.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.COUPDAYBS.functionParameter.basis.name",detail:"formula.functionList.COUPDAYBS.functionParameter.basis.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.COUPDAYS,functionType:t.FunctionType.Financial,description:"formula.functionList.COUPDAYS.description",abstract:"formula.functionList.COUPDAYS.abstract",functionParameter:[{name:"formula.functionList.COUPDAYS.functionParameter.settlement.name",detail:"formula.functionList.COUPDAYS.functionParameter.settlement.detail",example:'"2011-1-25"',require:1,repeat:0},{name:"formula.functionList.COUPDAYS.functionParameter.maturity.name",detail:"formula.functionList.COUPDAYS.functionParameter.maturity.detail",example:'"2011-11-15"',require:1,repeat:0},{name:"formula.functionList.COUPDAYS.functionParameter.frequency.name",detail:"formula.functionList.COUPDAYS.functionParameter.frequency.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.COUPDAYS.functionParameter.basis.name",detail:"formula.functionList.COUPDAYS.functionParameter.basis.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.COUPDAYSNC,functionType:t.FunctionType.Financial,description:"formula.functionList.COUPDAYSNC.description",abstract:"formula.functionList.COUPDAYSNC.abstract",functionParameter:[{name:"formula.functionList.COUPDAYSNC.functionParameter.settlement.name",detail:"formula.functionList.COUPDAYSNC.functionParameter.settlement.detail",example:'"2011-1-25"',require:1,repeat:0},{name:"formula.functionList.COUPDAYSNC.functionParameter.maturity.name",detail:"formula.functionList.COUPDAYSNC.functionParameter.maturity.detail",example:'"2011-11-15"',require:1,repeat:0},{name:"formula.functionList.COUPDAYSNC.functionParameter.frequency.name",detail:"formula.functionList.COUPDAYSNC.functionParameter.frequency.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.COUPDAYSNC.functionParameter.basis.name",detail:"formula.functionList.COUPDAYSNC.functionParameter.basis.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.COUPNCD,functionType:t.FunctionType.Financial,description:"formula.functionList.COUPNCD.description",abstract:"formula.functionList.COUPNCD.abstract",functionParameter:[{name:"formula.functionList.COUPNCD.functionParameter.settlement.name",detail:"formula.functionList.COUPNCD.functionParameter.settlement.detail",example:'"2011-1-25"',require:1,repeat:0},{name:"formula.functionList.COUPNCD.functionParameter.maturity.name",detail:"formula.functionList.COUPNCD.functionParameter.maturity.detail",example:'"2011-11-15"',require:1,repeat:0},{name:"formula.functionList.COUPNCD.functionParameter.frequency.name",detail:"formula.functionList.COUPNCD.functionParameter.frequency.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.COUPNCD.functionParameter.basis.name",detail:"formula.functionList.COUPNCD.functionParameter.basis.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.COUPNUM,functionType:t.FunctionType.Financial,description:"formula.functionList.COUPNUM.description",abstract:"formula.functionList.COUPNUM.abstract",functionParameter:[{name:"formula.functionList.COUPNUM.functionParameter.settlement.name",detail:"formula.functionList.COUPNUM.functionParameter.settlement.detail",example:'"2011-1-25"',require:1,repeat:0},{name:"formula.functionList.COUPNUM.functionParameter.maturity.name",detail:"formula.functionList.COUPNUM.functionParameter.maturity.detail",example:'"2011-11-15"',require:1,repeat:0},{name:"formula.functionList.COUPNUM.functionParameter.frequency.name",detail:"formula.functionList.COUPNUM.functionParameter.frequency.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.COUPNUM.functionParameter.basis.name",detail:"formula.functionList.COUPNUM.functionParameter.basis.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.COUPPCD,functionType:t.FunctionType.Financial,description:"formula.functionList.COUPPCD.description",abstract:"formula.functionList.COUPPCD.abstract",functionParameter:[{name:"formula.functionList.COUPPCD.functionParameter.settlement.name",detail:"formula.functionList.COUPPCD.functionParameter.settlement.detail",example:'"2011-1-25"',require:1,repeat:0},{name:"formula.functionList.COUPPCD.functionParameter.maturity.name",detail:"formula.functionList.COUPPCD.functionParameter.maturity.detail",example:'"2011-11-15"',require:1,repeat:0},{name:"formula.functionList.COUPPCD.functionParameter.frequency.name",detail:"formula.functionList.COUPPCD.functionParameter.frequency.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.COUPPCD.functionParameter.basis.name",detail:"formula.functionList.COUPPCD.functionParameter.basis.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.CUMIPMT,functionType:t.FunctionType.Financial,description:"formula.functionList.CUMIPMT.description",abstract:"formula.functionList.CUMIPMT.abstract",functionParameter:[{name:"formula.functionList.CUMIPMT.functionParameter.rate.name",detail:"formula.functionList.CUMIPMT.functionParameter.rate.detail",example:"9%/12",require:1,repeat:0},{name:"formula.functionList.CUMIPMT.functionParameter.nper.name",detail:"formula.functionList.CUMIPMT.functionParameter.nper.detail",example:"30*12",require:1,repeat:0},{name:"formula.functionList.CUMIPMT.functionParameter.pv.name",detail:"formula.functionList.CUMIPMT.functionParameter.pv.detail",example:"125000",require:1,repeat:0},{name:"formula.functionList.CUMIPMT.functionParameter.startPeriod.name",detail:"formula.functionList.CUMIPMT.functionParameter.startPeriod.detail",example:"13",require:1,repeat:0},{name:"formula.functionList.CUMIPMT.functionParameter.endPeriod.name",detail:"formula.functionList.CUMIPMT.functionParameter.endPeriod.detail",example:"24",require:1,repeat:0},{name:"formula.functionList.CUMIPMT.functionParameter.type.name",detail:"formula.functionList.CUMIPMT.functionParameter.type.detail",example:"0",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.CUMPRINC,functionType:t.FunctionType.Financial,description:"formula.functionList.CUMPRINC.description",abstract:"formula.functionList.CUMPRINC.abstract",functionParameter:[{name:"formula.functionList.CUMPRINC.functionParameter.rate.name",detail:"formula.functionList.CUMPRINC.functionParameter.rate.detail",example:"9%/12",require:1,repeat:0},{name:"formula.functionList.CUMPRINC.functionParameter.nper.name",detail:"formula.functionList.CUMPRINC.functionParameter.nper.detail",example:"30*12",require:1,repeat:0},{name:"formula.functionList.CUMPRINC.functionParameter.pv.name",detail:"formula.functionList.CUMPRINC.functionParameter.pv.detail",example:"125000",require:1,repeat:0},{name:"formula.functionList.CUMPRINC.functionParameter.startPeriod.name",detail:"formula.functionList.CUMPRINC.functionParameter.startPeriod.detail",example:"13",require:1,repeat:0},{name:"formula.functionList.CUMPRINC.functionParameter.endPeriod.name",detail:"formula.functionList.CUMPRINC.functionParameter.endPeriod.detail",example:"24",require:1,repeat:0},{name:"formula.functionList.CUMPRINC.functionParameter.type.name",detail:"formula.functionList.CUMPRINC.functionParameter.type.detail",example:"0",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.DB,functionType:t.FunctionType.Financial,description:"formula.functionList.DB.description",abstract:"formula.functionList.DB.abstract",functionParameter:[{name:"formula.functionList.DB.functionParameter.cost.name",detail:"formula.functionList.DB.functionParameter.cost.detail",example:"10000000",require:1,repeat:0},{name:"formula.functionList.DB.functionParameter.salvage.name",detail:"formula.functionList.DB.functionParameter.salvage.detail",example:"1000000",require:1,repeat:0},{name:"formula.functionList.DB.functionParameter.life.name",detail:"formula.functionList.DB.functionParameter.life.detail",example:"6",require:1,repeat:0},{name:"formula.functionList.DB.functionParameter.period.name",detail:"formula.functionList.DB.functionParameter.period.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.DB.functionParameter.month.name",detail:"formula.functionList.DB.functionParameter.month.detail",example:"7",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.DDB,functionType:t.FunctionType.Financial,description:"formula.functionList.DDB.description",abstract:"formula.functionList.DDB.abstract",functionParameter:[{name:"formula.functionList.DDB.functionParameter.cost.name",detail:"formula.functionList.DDB.functionParameter.cost.detail",example:"24000",require:1,repeat:0},{name:"formula.functionList.DDB.functionParameter.salvage.name",detail:"formula.functionList.DDB.functionParameter.salvage.detail",example:"3000",require:1,repeat:0},{name:"formula.functionList.DDB.functionParameter.life.name",detail:"formula.functionList.DDB.functionParameter.life.detail",example:"10",require:1,repeat:0},{name:"formula.functionList.DDB.functionParameter.period.name",detail:"formula.functionList.DDB.functionParameter.period.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.DDB.functionParameter.factor.name",detail:"formula.functionList.DDB.functionParameter.factor.detail",example:"2",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.DISC,functionType:t.FunctionType.Financial,description:"formula.functionList.DISC.description",abstract:"formula.functionList.DISC.abstract",functionParameter:[{name:"formula.functionList.DISC.functionParameter.settlement.name",detail:"formula.functionList.DISC.functionParameter.settlement.detail",example:'"2018-7-1"',require:1,repeat:0},{name:"formula.functionList.DISC.functionParameter.maturity.name",detail:"formula.functionList.DISC.functionParameter.maturity.detail",example:'"2048-1-1"',require:1,repeat:0},{name:"formula.functionList.DISC.functionParameter.pr.name",detail:"formula.functionList.DISC.functionParameter.pr.detail",example:"97.975",require:1,repeat:0},{name:"formula.functionList.DISC.functionParameter.redemption.name",detail:"formula.functionList.DISC.functionParameter.redemption.detail",example:"100",require:1,repeat:0},{name:"formula.functionList.DISC.functionParameter.basis.name",detail:"formula.functionList.DISC.functionParameter.basis.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.DOLLARDE,functionType:t.FunctionType.Financial,description:"formula.functionList.DOLLARDE.description",abstract:"formula.functionList.DOLLARDE.abstract",functionParameter:[{name:"formula.functionList.DOLLARDE.functionParameter.fractionalDollar.name",detail:"formula.functionList.DOLLARDE.functionParameter.fractionalDollar.detail",example:"1.02",require:1,repeat:0},{name:"formula.functionList.DOLLARDE.functionParameter.fraction.name",detail:"formula.functionList.DOLLARDE.functionParameter.fraction.detail",example:"16",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.DOLLARFR,functionType:t.FunctionType.Financial,description:"formula.functionList.DOLLARFR.description",abstract:"formula.functionList.DOLLARFR.abstract",functionParameter:[{name:"formula.functionList.DOLLARFR.functionParameter.decimalDollar.name",detail:"formula.functionList.DOLLARFR.functionParameter.decimalDollar.detail",example:"1.125",require:1,repeat:0},{name:"formula.functionList.DOLLARFR.functionParameter.fraction.name",detail:"formula.functionList.DOLLARFR.functionParameter.fraction.detail",example:"16",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.DURATION,functionType:t.FunctionType.Financial,description:"formula.functionList.DURATION.description",abstract:"formula.functionList.DURATION.abstract",functionParameter:[{name:"formula.functionList.DURATION.functionParameter.settlement.name",detail:"formula.functionList.DURATION.functionParameter.settlement.detail",example:'"2018-7-1"',require:1,repeat:0},{name:"formula.functionList.DURATION.functionParameter.maturity.name",detail:"formula.functionList.DURATION.functionParameter.maturity.detail",example:'"2048-1-1"',require:1,repeat:0},{name:"formula.functionList.DURATION.functionParameter.coupon.name",detail:"formula.functionList.DURATION.functionParameter.coupon.detail",example:"8%",require:1,repeat:0},{name:"formula.functionList.DURATION.functionParameter.yld.name",detail:"formula.functionList.DURATION.functionParameter.yld.detail",example:"9%",require:1,repeat:0},{name:"formula.functionList.DURATION.functionParameter.frequency.name",detail:"formula.functionList.DURATION.functionParameter.frequency.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.DURATION.functionParameter.basis.name",detail:"formula.functionList.DURATION.functionParameter.basis.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.EFFECT,functionType:t.FunctionType.Financial,description:"formula.functionList.EFFECT.description",abstract:"formula.functionList.EFFECT.abstract",functionParameter:[{name:"formula.functionList.EFFECT.functionParameter.nominalRate.name",detail:"formula.functionList.EFFECT.functionParameter.nominalRate.detail",example:"5.25%",require:1,repeat:0},{name:"formula.functionList.EFFECT.functionParameter.npery.name",detail:"formula.functionList.EFFECT.functionParameter.npery.detail",example:"4",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.FV,functionType:t.FunctionType.Financial,description:"formula.functionList.FV.description",abstract:"formula.functionList.FV.abstract",functionParameter:[{name:"formula.functionList.FV.functionParameter.rate.name",detail:"formula.functionList.FV.functionParameter.rate.detail",example:"6%/12",require:1,repeat:0},{name:"formula.functionList.FV.functionParameter.nper.name",detail:"formula.functionList.FV.functionParameter.nper.detail",example:"10",require:1,repeat:0},{name:"formula.functionList.FV.functionParameter.pmt.name",detail:"formula.functionList.FV.functionParameter.pmt.detail",example:"-200",require:1,repeat:0},{name:"formula.functionList.FV.functionParameter.pv.name",detail:"formula.functionList.FV.functionParameter.pv.detail",example:"-500",require:0,repeat:0},{name:"formula.functionList.FV.functionParameter.type.name",detail:"formula.functionList.FV.functionParameter.type.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.FVSCHEDULE,functionType:t.FunctionType.Financial,description:"formula.functionList.FVSCHEDULE.description",abstract:"formula.functionList.FVSCHEDULE.abstract",functionParameter:[{name:"formula.functionList.FVSCHEDULE.functionParameter.principal.name",detail:"formula.functionList.FVSCHEDULE.functionParameter.principal.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.FVSCHEDULE.functionParameter.schedule.name",detail:"formula.functionList.FVSCHEDULE.functionParameter.schedule.detail",example:"A1:A4",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.INTRATE,functionType:t.FunctionType.Financial,description:"formula.functionList.INTRATE.description",abstract:"formula.functionList.INTRATE.abstract",functionParameter:[{name:"formula.functionList.INTRATE.functionParameter.settlement.name",detail:"formula.functionList.INTRATE.functionParameter.settlement.detail",example:'"2008-2-15"',require:1,repeat:0},{name:"formula.functionList.INTRATE.functionParameter.maturity.name",detail:"formula.functionList.INTRATE.functionParameter.maturity.detail",example:'"2008-5-15"',require:1,repeat:0},{name:"formula.functionList.INTRATE.functionParameter.investment.name",detail:"formula.functionList.INTRATE.functionParameter.investment.detail",example:"10000000",require:1,repeat:0},{name:"formula.functionList.INTRATE.functionParameter.redemption.name",detail:"formula.functionList.INTRATE.functionParameter.redemption.detail",example:"10144200",require:1,repeat:0},{name:"formula.functionList.INTRATE.functionParameter.basis.name",detail:"formula.functionList.INTRATE.functionParameter.basis.detail",example:"2",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.IPMT,functionType:t.FunctionType.Financial,description:"formula.functionList.IPMT.description",abstract:"formula.functionList.IPMT.abstract",functionParameter:[{name:"formula.functionList.IPMT.functionParameter.rate.name",detail:"formula.functionList.IPMT.functionParameter.rate.detail",example:"10%/12",require:1,repeat:0},{name:"formula.functionList.IPMT.functionParameter.per.name",detail:"formula.functionList.IPMT.functionParameter.per.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.IPMT.functionParameter.nper.name",detail:"formula.functionList.IPMT.functionParameter.nper.detail",example:"3*12",require:1,repeat:0},{name:"formula.functionList.IPMT.functionParameter.pv.name",detail:"formula.functionList.IPMT.functionParameter.pv.detail",example:"80000",require:1,repeat:0},{name:"formula.functionList.IPMT.functionParameter.fv.name",detail:"formula.functionList.IPMT.functionParameter.fv.detail",example:"0",require:0,repeat:0},{name:"formula.functionList.IPMT.functionParameter.type.name",detail:"formula.functionList.IPMT.functionParameter.type.detail",example:"0",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.IRR,functionType:t.FunctionType.Financial,description:"formula.functionList.IRR.description",abstract:"formula.functionList.IRR.abstract",functionParameter:[{name:"formula.functionList.IRR.functionParameter.values.name",detail:"formula.functionList.IRR.functionParameter.values.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.IRR.functionParameter.guess.name",detail:"formula.functionList.IRR.functionParameter.guess.detail",example:"0.1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.ISPMT,functionType:t.FunctionType.Financial,description:"formula.functionList.ISPMT.description",abstract:"formula.functionList.ISPMT.abstract",functionParameter:[{name:"formula.functionList.ISPMT.functionParameter.rate.name",detail:"formula.functionList.ISPMT.functionParameter.rate.detail",example:"10%",require:1,repeat:0},{name:"formula.functionList.ISPMT.functionParameter.per.name",detail:"formula.functionList.ISPMT.functionParameter.per.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.ISPMT.functionParameter.nper.name",detail:"formula.functionList.ISPMT.functionParameter.nper.detail",example:"5",require:1,repeat:0},{name:"formula.functionList.ISPMT.functionParameter.pv.name",detail:"formula.functionList.ISPMT.functionParameter.pv.detail",example:"1000",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.MDURATION,functionType:t.FunctionType.Financial,description:"formula.functionList.MDURATION.description",abstract:"formula.functionList.MDURATION.abstract",functionParameter:[{name:"formula.functionList.MDURATION.functionParameter.settlement.name",detail:"formula.functionList.MDURATION.functionParameter.settlement.detail",example:'"2018-7-1"',require:1,repeat:0},{name:"formula.functionList.MDURATION.functionParameter.maturity.name",detail:"formula.functionList.MDURATION.functionParameter.maturity.detail",example:'"2048-1-1"',require:1,repeat:0},{name:"formula.functionList.MDURATION.functionParameter.coupon.name",detail:"formula.functionList.MDURATION.functionParameter.coupon.detail",example:"8%",require:1,repeat:0},{name:"formula.functionList.MDURATION.functionParameter.yld.name",detail:"formula.functionList.MDURATION.functionParameter.yld.detail",example:"9%",require:1,repeat:0},{name:"formula.functionList.MDURATION.functionParameter.frequency.name",detail:"formula.functionList.MDURATION.functionParameter.frequency.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.MDURATION.functionParameter.basis.name",detail:"formula.functionList.MDURATION.functionParameter.basis.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.MIRR,functionType:t.FunctionType.Financial,description:"formula.functionList.MIRR.description",abstract:"formula.functionList.MIRR.abstract",functionParameter:[{name:"formula.functionList.MIRR.functionParameter.values.name",detail:"formula.functionList.MIRR.functionParameter.values.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.MIRR.functionParameter.financeRate.name",detail:"formula.functionList.MIRR.functionParameter.financeRate.detail",example:"10%",require:1,repeat:0},{name:"formula.functionList.MIRR.functionParameter.reinvestRate.name",detail:"formula.functionList.MIRR.functionParameter.reinvestRate.detail",example:"12%",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.NOMINAL,functionType:t.FunctionType.Financial,description:"formula.functionList.NOMINAL.description",abstract:"formula.functionList.NOMINAL.abstract",functionParameter:[{name:"formula.functionList.NOMINAL.functionParameter.effectRate.name",detail:"formula.functionList.NOMINAL.functionParameter.effectRate.detail",example:"5.3543%",require:1,repeat:0},{name:"formula.functionList.NOMINAL.functionParameter.npery.name",detail:"formula.functionList.NOMINAL.functionParameter.npery.detail",example:"4",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.NPER,functionType:t.FunctionType.Financial,description:"formula.functionList.NPER.description",abstract:"formula.functionList.NPER.abstract",functionParameter:[{name:"formula.functionList.NPER.functionParameter.rate.name",detail:"formula.functionList.NPER.functionParameter.rate.detail",example:"12%/12",require:1,repeat:0},{name:"formula.functionList.NPER.functionParameter.pmt.name",detail:"formula.functionList.NPER.functionParameter.pmt.detail",example:"-100",require:1,repeat:0},{name:"formula.functionList.NPER.functionParameter.pv.name",detail:"formula.functionList.NPER.functionParameter.pv.detail",example:"-1000",require:1,repeat:0},{name:"formula.functionList.NPER.functionParameter.fv.name",detail:"formula.functionList.NPER.functionParameter.fv.detail",example:"10000",require:0,repeat:0},{name:"formula.functionList.NPER.functionParameter.type.name",detail:"formula.functionList.NPER.functionParameter.type.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.NPV,functionType:t.FunctionType.Financial,description:"formula.functionList.NPV.description",abstract:"formula.functionList.NPV.abstract",functionParameter:[{name:"formula.functionList.NPV.functionParameter.rate.name",detail:"formula.functionList.NPV.functionParameter.rate.detail",example:"10%",require:1,repeat:0},{name:"formula.functionList.NPV.functionParameter.value1.name",detail:"formula.functionList.NPV.functionParameter.value1.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.NPV.functionParameter.value2.name",detail:"formula.functionList.NPV.functionParameter.value2.detail",example:"-9000",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.ODDFPRICE,functionType:t.FunctionType.Financial,description:"formula.functionList.ODDFPRICE.description",abstract:"formula.functionList.ODDFPRICE.abstract",functionParameter:[{name:"formula.functionList.ODDFPRICE.functionParameter.settlement.name",detail:"formula.functionList.ODDFPRICE.functionParameter.settlement.detail",example:'"2008-11-11"',require:1,repeat:0},{name:"formula.functionList.ODDFPRICE.functionParameter.maturity.name",detail:"formula.functionList.ODDFPRICE.functionParameter.maturity.detail",example:'"2021-3-1"',require:1,repeat:0},{name:"formula.functionList.ODDFPRICE.functionParameter.issue.name",detail:"formula.functionList.ODDFPRICE.functionParameter.issue.detail",example:'"2008-10-15"',require:1,repeat:0},{name:"formula.functionList.ODDFPRICE.functionParameter.firstCoupon.name",detail:"formula.functionList.ODDFPRICE.functionParameter.firstCoupon.detail",example:'"2009-3-1"',require:1,repeat:0},{name:"formula.functionList.ODDFPRICE.functionParameter.rate.name",detail:"formula.functionList.ODDFPRICE.functionParameter.rate.detail",example:"7.85%",require:1,repeat:0},{name:"formula.functionList.ODDFPRICE.functionParameter.yld.name",detail:"formula.functionList.ODDFPRICE.functionParameter.yld.detail",example:"6.25%",require:1,repeat:0},{name:"formula.functionList.ODDFPRICE.functionParameter.redemption.name",detail:"formula.functionList.ODDFPRICE.functionParameter.redemption.detail",example:"100",require:1,repeat:0},{name:"formula.functionList.ODDFPRICE.functionParameter.frequency.name",detail:"formula.functionList.ODDFPRICE.functionParameter.frequency.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.ODDFPRICE.functionParameter.basis.name",detail:"formula.functionList.ODDFPRICE.functionParameter.basis.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.ODDFYIELD,functionType:t.FunctionType.Financial,description:"formula.functionList.ODDFYIELD.description",abstract:"formula.functionList.ODDFYIELD.abstract",functionParameter:[{name:"formula.functionList.ODDFYIELD.functionParameter.settlement.name",detail:"formula.functionList.ODDFYIELD.functionParameter.settlement.detail",example:'"2008-11-11"',require:1,repeat:0},{name:"formula.functionList.ODDFYIELD.functionParameter.maturity.name",detail:"formula.functionList.ODDFYIELD.functionParameter.maturity.detail",example:'"2021-3-1"',require:1,repeat:0},{name:"formula.functionList.ODDFYIELD.functionParameter.issue.name",detail:"formula.functionList.ODDFYIELD.functionParameter.issue.detail",example:'"2008-10-15"',require:1,repeat:0},{name:"formula.functionList.ODDFYIELD.functionParameter.firstCoupon.name",detail:"formula.functionList.ODDFYIELD.functionParameter.firstCoupon.detail",example:'"2009-3-1"',require:1,repeat:0},{name:"formula.functionList.ODDFYIELD.functionParameter.rate.name",detail:"formula.functionList.ODDFYIELD.functionParameter.rate.detail",example:"5.75%",require:1,repeat:0},{name:"formula.functionList.ODDFYIELD.functionParameter.pr.name",detail:"formula.functionList.ODDFYIELD.functionParameter.pr.detail",example:"84.5",require:1,repeat:0},{name:"formula.functionList.ODDFYIELD.functionParameter.redemption.name",detail:"formula.functionList.ODDFYIELD.functionParameter.redemption.detail",example:"100",require:1,repeat:0},{name:"formula.functionList.ODDFYIELD.functionParameter.frequency.name",detail:"formula.functionList.ODDFYIELD.functionParameter.frequency.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.ODDFYIELD.functionParameter.basis.name",detail:"formula.functionList.ODDFYIELD.functionParameter.basis.detail",example:"0",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.ODDLPRICE,functionType:t.FunctionType.Financial,description:"formula.functionList.ODDLPRICE.description",abstract:"formula.functionList.ODDLPRICE.abstract",functionParameter:[{name:"formula.functionList.ODDLPRICE.functionParameter.settlement.name",detail:"formula.functionList.ODDLPRICE.functionParameter.settlement.detail",example:'"2008-2-7"',require:1,repeat:0},{name:"formula.functionList.ODDLPRICE.functionParameter.maturity.name",detail:"formula.functionList.ODDLPRICE.functionParameter.maturity.detail",example:'"2008-6-15"',require:1,repeat:0},{name:"formula.functionList.ODDLPRICE.functionParameter.lastInterest.name",detail:"formula.functionList.ODDLPRICE.functionParameter.lastInterest.detail",example:'"2007-10-15"',require:1,repeat:0},{name:"formula.functionList.ODDLPRICE.functionParameter.rate.name",detail:"formula.functionList.ODDLPRICE.functionParameter.rate.detail",example:"3.75%",require:1,repeat:0},{name:"formula.functionList.ODDLPRICE.functionParameter.yld.name",detail:"formula.functionList.ODDLPRICE.functionParameter.yld.detail",example:"4.05%",require:1,repeat:0},{name:"formula.functionList.ODDLPRICE.functionParameter.redemption.name",detail:"formula.functionList.ODDLPRICE.functionParameter.redemption.detail",example:"100",require:1,repeat:0},{name:"formula.functionList.ODDLPRICE.functionParameter.frequency.name",detail:"formula.functionList.ODDLPRICE.functionParameter.frequency.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.ODDLPRICE.functionParameter.basis.name",detail:"formula.functionList.ODDLPRICE.functionParameter.basis.detail",example:"0",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.ODDLYIELD,functionType:t.FunctionType.Financial,description:"formula.functionList.ODDLYIELD.description",abstract:"formula.functionList.ODDLYIELD.abstract",functionParameter:[{name:"formula.functionList.ODDLYIELD.functionParameter.settlement.name",detail:"formula.functionList.ODDLYIELD.functionParameter.settlement.detail",example:'"2008-4-20"',require:1,repeat:0},{name:"formula.functionList.ODDLYIELD.functionParameter.maturity.name",detail:"formula.functionList.ODDLYIELD.functionParameter.maturity.detail",example:'"2008-6-15"',require:1,repeat:0},{name:"formula.functionList.ODDLYIELD.functionParameter.lastInterest.name",detail:"formula.functionList.ODDLYIELD.functionParameter.lastInterest.detail",example:'"2007-12-24"',require:1,repeat:0},{name:"formula.functionList.ODDLYIELD.functionParameter.rate.name",detail:"formula.functionList.ODDLYIELD.functionParameter.rate.detail",example:"3.75%",require:1,repeat:0},{name:"formula.functionList.ODDLYIELD.functionParameter.pr.name",detail:"formula.functionList.ODDLYIELD.functionParameter.pr.detail",example:"99.875",require:1,repeat:0},{name:"formula.functionList.ODDLYIELD.functionParameter.redemption.name",detail:"formula.functionList.ODDLYIELD.functionParameter.redemption.detail",example:"100",require:1,repeat:0},{name:"formula.functionList.ODDLYIELD.functionParameter.frequency.name",detail:"formula.functionList.ODDLYIELD.functionParameter.frequency.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.ODDLYIELD.functionParameter.basis.name",detail:"formula.functionList.ODDLYIELD.functionParameter.basis.detail",example:"0",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.PDURATION,functionType:t.FunctionType.Financial,description:"formula.functionList.PDURATION.description",abstract:"formula.functionList.PDURATION.abstract",functionParameter:[{name:"formula.functionList.PDURATION.functionParameter.rate.name",detail:"formula.functionList.PDURATION.functionParameter.rate.detail",example:"2.5%",require:1,repeat:0},{name:"formula.functionList.PDURATION.functionParameter.pv.name",detail:"formula.functionList.PDURATION.functionParameter.pv.detail",example:"2000",require:1,repeat:0},{name:"formula.functionList.PDURATION.functionParameter.fv.name",detail:"formula.functionList.PDURATION.functionParameter.fv.detail",example:"2200",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.PMT,functionType:t.FunctionType.Financial,description:"formula.functionList.PMT.description",abstract:"formula.functionList.PMT.abstract",functionParameter:[{name:"formula.functionList.PMT.functionParameter.rate.name",detail:"formula.functionList.PMT.functionParameter.rate.detail",example:"8%/12",require:1,repeat:0},{name:"formula.functionList.PMT.functionParameter.nper.name",detail:"formula.functionList.PMT.functionParameter.nper.detail",example:"10",require:1,repeat:0},{name:"formula.functionList.PMT.functionParameter.pv.name",detail:"formula.functionList.PMT.functionParameter.pv.detail",example:"10000",require:1,repeat:0},{name:"formula.functionList.PMT.functionParameter.fv.name",detail:"formula.functionList.PMT.functionParameter.fv.detail",example:"0",require:0,repeat:0},{name:"formula.functionList.PMT.functionParameter.type.name",detail:"formula.functionList.PMT.functionParameter.type.detail",example:"0",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.PPMT,functionType:t.FunctionType.Financial,description:"formula.functionList.PPMT.description",abstract:"formula.functionList.PPMT.abstract",functionParameter:[{name:"formula.functionList.PPMT.functionParameter.rate.name",detail:"formula.functionList.PPMT.functionParameter.rate.detail",example:"10%/12",require:1,repeat:0},{name:"formula.functionList.PPMT.functionParameter.per.name",detail:"formula.functionList.PPMT.functionParameter.per.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.PPMT.functionParameter.nper.name",detail:"formula.functionList.PPMT.functionParameter.nper.detail",example:"3*12",require:1,repeat:0},{name:"formula.functionList.PPMT.functionParameter.pv.name",detail:"formula.functionList.PPMT.functionParameter.pv.detail",example:"80000",require:1,repeat:0},{name:"formula.functionList.PPMT.functionParameter.fv.name",detail:"formula.functionList.PPMT.functionParameter.fv.detail",example:"0",require:0,repeat:0},{name:"formula.functionList.PPMT.functionParameter.type.name",detail:"formula.functionList.PPMT.functionParameter.type.detail",example:"0",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.PRICE,functionType:t.FunctionType.Financial,description:"formula.functionList.PRICE.description",abstract:"formula.functionList.PRICE.abstract",functionParameter:[{name:"formula.functionList.PRICE.functionParameter.settlement.name",detail:"formula.functionList.PRICE.functionParameter.settlement.detail",example:'"2008-11-11"',require:1,repeat:0},{name:"formula.functionList.PRICE.functionParameter.maturity.name",detail:"formula.functionList.PRICE.functionParameter.maturity.detail",example:'"2021-3-1"',require:1,repeat:0},{name:"formula.functionList.PRICE.functionParameter.rate.name",detail:"formula.functionList.PRICE.functionParameter.rate.detail",example:"7.85%",require:1,repeat:0},{name:"formula.functionList.PRICE.functionParameter.yld.name",detail:"formula.functionList.PRICE.functionParameter.yld.detail",example:"6.25%",require:1,repeat:0},{name:"formula.functionList.PRICE.functionParameter.redemption.name",detail:"formula.functionList.PRICE.functionParameter.redemption.detail",example:"100",require:1,repeat:0},{name:"formula.functionList.PRICE.functionParameter.frequency.name",detail:"formula.functionList.PRICE.functionParameter.frequency.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.PRICE.functionParameter.basis.name",detail:"formula.functionList.PRICE.functionParameter.basis.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.PRICEDISC,functionType:t.FunctionType.Financial,description:"formula.functionList.PRICEDISC.description",abstract:"formula.functionList.PRICEDISC.abstract",functionParameter:[{name:"formula.functionList.PRICEDISC.functionParameter.settlement.name",detail:"formula.functionList.PRICEDISC.functionParameter.settlement.detail",example:'"2008-11-11"',require:1,repeat:0},{name:"formula.functionList.PRICEDISC.functionParameter.maturity.name",detail:"formula.functionList.PRICEDISC.functionParameter.maturity.detail",example:'"2021-3-1"',require:1,repeat:0},{name:"formula.functionList.PRICEDISC.functionParameter.discount.name",detail:"formula.functionList.PRICEDISC.functionParameter.discount.detail",example:"6.25%",require:1,repeat:0},{name:"formula.functionList.PRICEDISC.functionParameter.redemption.name",detail:"formula.functionList.PRICEDISC.functionParameter.redemption.detail",example:"100",require:1,repeat:0},{name:"formula.functionList.PRICEDISC.functionParameter.basis.name",detail:"formula.functionList.PRICEDISC.functionParameter.basis.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.PRICEMAT,functionType:t.FunctionType.Financial,description:"formula.functionList.PRICEMAT.description",abstract:"formula.functionList.PRICEMAT.abstract",functionParameter:[{name:"formula.functionList.PRICEMAT.functionParameter.settlement.name",detail:"formula.functionList.PRICEMAT.functionParameter.settlement.detail",example:'"2008-11-11"',require:1,repeat:0},{name:"formula.functionList.PRICEMAT.functionParameter.maturity.name",detail:"formula.functionList.PRICEMAT.functionParameter.maturity.detail",example:'"2021-3-1"',require:1,repeat:0},{name:"formula.functionList.PRICEMAT.functionParameter.issue.name",detail:"formula.functionList.PRICEMAT.functionParameter.issue.detail",example:'"2008-10-15"',require:1,repeat:0},{name:"formula.functionList.PRICEMAT.functionParameter.rate.name",detail:"formula.functionList.PRICEMAT.functionParameter.rate.detail",example:"7.85%",require:1,repeat:0},{name:"formula.functionList.PRICEMAT.functionParameter.yld.name",detail:"formula.functionList.PRICEMAT.functionParameter.yld.detail",example:"6.25%",require:1,repeat:0},{name:"formula.functionList.PRICEMAT.functionParameter.basis.name",detail:"formula.functionList.PRICEMAT.functionParameter.basis.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.PV,functionType:t.FunctionType.Financial,description:"formula.functionList.PV.description",abstract:"formula.functionList.PV.abstract",functionParameter:[{name:"formula.functionList.PV.functionParameter.rate.name",detail:"formula.functionList.PV.functionParameter.rate.detail",example:"2%",require:1,repeat:0},{name:"formula.functionList.PV.functionParameter.nper.name",detail:"formula.functionList.PV.functionParameter.nper.detail",example:"12",require:1,repeat:0},{name:"formula.functionList.PV.functionParameter.pmt.name",detail:"formula.functionList.PV.functionParameter.pmt.detail",example:"100",require:1,repeat:0},{name:"formula.functionList.PV.functionParameter.fv.name",detail:"formula.functionList.PV.functionParameter.fv.detail",example:"0",require:0,repeat:0},{name:"formula.functionList.PV.functionParameter.type.name",detail:"formula.functionList.PV.functionParameter.type.detail",example:"0",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.RATE,functionType:t.FunctionType.Financial,description:"formula.functionList.RATE.description",abstract:"formula.functionList.RATE.abstract",functionParameter:[{name:"formula.functionList.RATE.functionParameter.nper.name",detail:"formula.functionList.RATE.functionParameter.nper.detail",example:"4*12",require:1,repeat:0},{name:"formula.functionList.RATE.functionParameter.pmt.name",detail:"formula.functionList.RATE.functionParameter.pmt.detail",example:"-200",require:1,repeat:0},{name:"formula.functionList.RATE.functionParameter.pv.name",detail:"formula.functionList.RATE.functionParameter.pv.detail",example:"8000",require:1,repeat:0},{name:"formula.functionList.RATE.functionParameter.fv.name",detail:"formula.functionList.RATE.functionParameter.fv.detail",example:"0",require:0,repeat:0},{name:"formula.functionList.RATE.functionParameter.type.name",detail:"formula.functionList.RATE.functionParameter.type.detail",example:"0",require:0,repeat:0},{name:"formula.functionList.RATE.functionParameter.guess.name",detail:"formula.functionList.RATE.functionParameter.guess.detail",example:"0.1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.RECEIVED,functionType:t.FunctionType.Financial,description:"formula.functionList.RECEIVED.description",abstract:"formula.functionList.RECEIVED.abstract",functionParameter:[{name:"formula.functionList.RECEIVED.functionParameter.settlement.name",detail:"formula.functionList.RECEIVED.functionParameter.settlement.detail",example:'"2008-2-15"',require:1,repeat:0},{name:"formula.functionList.RECEIVED.functionParameter.maturity.name",detail:"formula.functionList.RECEIVED.functionParameter.maturity.detail",example:'"2008-3-15"',require:1,repeat:0},{name:"formula.functionList.RECEIVED.functionParameter.investment.name",detail:"formula.functionList.RECEIVED.functionParameter.investment.detail",example:"10000000",require:1,repeat:0},{name:"formula.functionList.RECEIVED.functionParameter.discount.name",detail:"formula.functionList.RECEIVED.functionParameter.discount.detail",example:"5.75%",require:1,repeat:0},{name:"formula.functionList.RECEIVED.functionParameter.basis.name",detail:"formula.functionList.RECEIVED.functionParameter.basis.detail",example:"2",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.RRI,functionType:t.FunctionType.Financial,description:"formula.functionList.RRI.description",abstract:"formula.functionList.RRI.abstract",functionParameter:[{name:"formula.functionList.RRI.functionParameter.nper.name",detail:"formula.functionList.RRI.functionParameter.nper.detail",example:"96",require:1,repeat:0},{name:"formula.functionList.RRI.functionParameter.pv.name",detail:"formula.functionList.RRI.functionParameter.pv.detail",example:"10000",require:1,repeat:0},{name:"formula.functionList.RRI.functionParameter.fv.name",detail:"formula.functionList.RRI.functionParameter.fv.detail",example:"11000",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.SLN,functionType:t.FunctionType.Financial,description:"formula.functionList.SLN.description",abstract:"formula.functionList.SLN.abstract",functionParameter:[{name:"formula.functionList.SLN.functionParameter.cost.name",detail:"formula.functionList.SLN.functionParameter.cost.detail",example:"300000",require:1,repeat:0},{name:"formula.functionList.SLN.functionParameter.salvage.name",detail:"formula.functionList.SLN.functionParameter.salvage.detail",example:"75000",require:1,repeat:0},{name:"formula.functionList.SLN.functionParameter.life.name",detail:"formula.functionList.SLN.functionParameter.life.detail",example:"10",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.SYD,functionType:t.FunctionType.Financial,description:"formula.functionList.SYD.description",abstract:"formula.functionList.SYD.abstract",functionParameter:[{name:"formula.functionList.SYD.functionParameter.cost.name",detail:"formula.functionList.SYD.functionParameter.cost.detail",example:"300000",require:1,repeat:0},{name:"formula.functionList.SYD.functionParameter.salvage.name",detail:"formula.functionList.SYD.functionParameter.salvage.detail",example:"75000",require:1,repeat:0},{name:"formula.functionList.SYD.functionParameter.life.name",detail:"formula.functionList.SYD.functionParameter.life.detail",example:"10",require:1,repeat:0},{name:"formula.functionList.SYD.functionParameter.per.name",detail:"formula.functionList.SYD.functionParameter.per.detail",example:"10",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.TBILLEQ,functionType:t.FunctionType.Financial,description:"formula.functionList.TBILLEQ.description",abstract:"formula.functionList.TBILLEQ.abstract",functionParameter:[{name:"formula.functionList.TBILLEQ.functionParameter.settlement.name",detail:"formula.functionList.TBILLEQ.functionParameter.settlement.detail",example:'"2008-3-31"',require:1,repeat:0},{name:"formula.functionList.TBILLEQ.functionParameter.maturity.name",detail:"formula.functionList.TBILLEQ.functionParameter.maturity.detail",example:'"2008-6-1"',require:1,repeat:0},{name:"formula.functionList.TBILLEQ.functionParameter.discount.name",detail:"formula.functionList.TBILLEQ.functionParameter.discount.detail",example:"9.14%",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.TBILLPRICE,functionType:t.FunctionType.Financial,description:"formula.functionList.TBILLPRICE.description",abstract:"formula.functionList.TBILLPRICE.abstract",functionParameter:[{name:"formula.functionList.TBILLPRICE.functionParameter.settlement.name",detail:"formula.functionList.TBILLPRICE.functionParameter.settlement.detail",example:'"2008-3-31"',require:1,repeat:0},{name:"formula.functionList.TBILLPRICE.functionParameter.maturity.name",detail:"formula.functionList.TBILLPRICE.functionParameter.maturity.detail",example:'"2008-6-1"',require:1,repeat:0},{name:"formula.functionList.TBILLPRICE.functionParameter.discount.name",detail:"formula.functionList.TBILLPRICE.functionParameter.discount.detail",example:"9.14%",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.TBILLYIELD,functionType:t.FunctionType.Financial,description:"formula.functionList.TBILLYIELD.description",abstract:"formula.functionList.TBILLYIELD.abstract",functionParameter:[{name:"formula.functionList.TBILLYIELD.functionParameter.settlement.name",detail:"formula.functionList.TBILLYIELD.functionParameter.settlement.detail",example:'"2008-3-31"',require:1,repeat:0},{name:"formula.functionList.TBILLYIELD.functionParameter.maturity.name",detail:"formula.functionList.TBILLYIELD.functionParameter.maturity.detail",example:'"2008-6-1"',require:1,repeat:0},{name:"formula.functionList.TBILLYIELD.functionParameter.pr.name",detail:"formula.functionList.TBILLYIELD.functionParameter.pr.detail",example:"98.45",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.VDB,functionType:t.FunctionType.Financial,description:"formula.functionList.VDB.description",abstract:"formula.functionList.VDB.abstract",functionParameter:[{name:"formula.functionList.VDB.functionParameter.cost.name",detail:"formula.functionList.VDB.functionParameter.cost.detail",example:"2400",require:1,repeat:0},{name:"formula.functionList.VDB.functionParameter.salvage.name",detail:"formula.functionList.VDB.functionParameter.salvage.detail",example:"300",require:1,repeat:0},{name:"formula.functionList.VDB.functionParameter.life.name",detail:"formula.functionList.VDB.functionParameter.life.detail",example:"10",require:1,repeat:0},{name:"formula.functionList.VDB.functionParameter.startPeriod.name",detail:"formula.functionList.VDB.functionParameter.startPeriod.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.VDB.functionParameter.endPeriod.name",detail:"formula.functionList.VDB.functionParameter.endPeriod.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.VDB.functionParameter.factor.name",detail:"formula.functionList.VDB.functionParameter.factor.detail",example:"2",require:0,repeat:0},{name:"formula.functionList.VDB.functionParameter.noSwitch.name",detail:"formula.functionList.VDB.functionParameter.noSwitch.detail",example:"false",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.XIRR,functionType:t.FunctionType.Financial,description:"formula.functionList.XIRR.description",abstract:"formula.functionList.XIRR.abstract",functionParameter:[{name:"formula.functionList.XIRR.functionParameter.values.name",detail:"formula.functionList.XIRR.functionParameter.values.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.XIRR.functionParameter.dates.name",detail:"formula.functionList.XIRR.functionParameter.dates.detail",example:"B1:B4",require:1,repeat:0},{name:"formula.functionList.XIRR.functionParameter.guess.name",detail:"formula.functionList.XIRR.functionParameter.guess.detail",example:"0.1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.XNPV,functionType:t.FunctionType.Financial,description:"formula.functionList.XNPV.description",abstract:"formula.functionList.XNPV.abstract",functionParameter:[{name:"formula.functionList.XNPV.functionParameter.rate.name",detail:"formula.functionList.XNPV.functionParameter.rate.detail",example:"10%",require:1,repeat:0},{name:"formula.functionList.XNPV.functionParameter.values.name",detail:"formula.functionList.XNPV.functionParameter.values.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.XNPV.functionParameter.dates.name",detail:"formula.functionList.XNPV.functionParameter.dates.detail",example:"B1:B4",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.YIELD,functionType:t.FunctionType.Financial,description:"formula.functionList.YIELD.description",abstract:"formula.functionList.YIELD.abstract",functionParameter:[{name:"formula.functionList.YIELD.functionParameter.settlement.name",detail:"formula.functionList.YIELD.functionParameter.settlement.detail",example:'"2008-11-11"',require:1,repeat:0},{name:"formula.functionList.YIELD.functionParameter.maturity.name",detail:"formula.functionList.YIELD.functionParameter.maturity.detail",example:'"2021-3-1"',require:1,repeat:0},{name:"formula.functionList.YIELD.functionParameter.rate.name",detail:"formula.functionList.YIELD.functionParameter.rate.detail",example:"7.85%",require:1,repeat:0},{name:"formula.functionList.YIELD.functionParameter.pr.name",detail:"formula.functionList.YIELD.functionParameter.pr.detail",example:"98.45",require:1,repeat:0},{name:"formula.functionList.YIELD.functionParameter.redemption.name",detail:"formula.functionList.YIELD.functionParameter.redemption.detail",example:"100",require:1,repeat:0},{name:"formula.functionList.YIELD.functionParameter.frequency.name",detail:"formula.functionList.YIELD.functionParameter.frequency.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.YIELD.functionParameter.basis.name",detail:"formula.functionList.YIELD.functionParameter.basis.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.YIELDDISC,functionType:t.FunctionType.Financial,description:"formula.functionList.YIELDDISC.description",abstract:"formula.functionList.YIELDDISC.abstract",functionParameter:[{name:"formula.functionList.YIELDDISC.functionParameter.settlement.name",detail:"formula.functionList.YIELDDISC.functionParameter.settlement.detail",example:'"2008-11-11"',require:1,repeat:0},{name:"formula.functionList.YIELDDISC.functionParameter.maturity.name",detail:"formula.functionList.YIELDDISC.functionParameter.maturity.detail",example:'"2021-3-1"',require:1,repeat:0},{name:"formula.functionList.YIELDDISC.functionParameter.pr.name",detail:"formula.functionList.YIELDDISC.functionParameter.pr.detail",example:"98.45",require:1,repeat:0},{name:"formula.functionList.YIELDDISC.functionParameter.redemption.name",detail:"formula.functionList.YIELDDISC.functionParameter.redemption.detail",example:"100",require:1,repeat:0},{name:"formula.functionList.YIELDDISC.functionParameter.basis.name",detail:"formula.functionList.YIELDDISC.functionParameter.basis.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_FINANCIAL.YIELDMAT,functionType:t.FunctionType.Financial,description:"formula.functionList.YIELDMAT.description",abstract:"formula.functionList.YIELDMAT.abstract",functionParameter:[{name:"formula.functionList.YIELDMAT.functionParameter.settlement.name",detail:"formula.functionList.YIELDMAT.functionParameter.settlement.detail",example:'"2008-11-11"',require:1,repeat:0},{name:"formula.functionList.YIELDMAT.functionParameter.maturity.name",detail:"formula.functionList.YIELDMAT.functionParameter.maturity.detail",example:'"2021-3-1"',require:1,repeat:0},{name:"formula.functionList.YIELDMAT.functionParameter.issue.name",detail:"formula.functionList.YIELDMAT.functionParameter.issue.detail",example:'"2008-10-15"',require:1,repeat:0},{name:"formula.functionList.YIELDMAT.functionParameter.rate.name",detail:"formula.functionList.YIELDMAT.functionParameter.rate.detail",example:"7.85%",require:1,repeat:0},{name:"formula.functionList.YIELDMAT.functionParameter.pr.name",detail:"formula.functionList.YIELDMAT.functionParameter.pr.detail",example:"98.45",require:1,repeat:0},{name:"formula.functionList.YIELDMAT.functionParameter.basis.name",detail:"formula.functionList.YIELDMAT.functionParameter.basis.detail",example:"1",require:0,repeat:0}]}],ta=[{functionName:t.FUNCTION_NAMES_INFORMATION.CELL,functionType:t.FunctionType.Information,description:"formula.functionList.CELL.description",abstract:"formula.functionList.CELL.abstract",functionParameter:[{name:"formula.functionList.CELL.functionParameter.infoType.name",detail:"formula.functionList.CELL.functionParameter.infoType.detail",example:'"type"',require:1,repeat:0},{name:"formula.functionList.CELL.functionParameter.reference.name",detail:"formula.functionList.CELL.functionParameter.reference.detail",example:"A1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_INFORMATION.ERROR_TYPE,functionType:t.FunctionType.Information,description:"formula.functionList.ERROR_TYPE.description",abstract:"formula.functionList.ERROR_TYPE.abstract",functionParameter:[{name:"formula.functionList.ERROR_TYPE.functionParameter.errorVal.name",detail:"formula.functionList.ERROR_TYPE.functionParameter.errorVal.detail",example:'"#NULL!"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_INFORMATION.INFO,functionType:t.FunctionType.Information,description:"formula.functionList.INFO.description",abstract:"formula.functionList.INFO.abstract",functionParameter:[{name:"formula.functionList.INFO.functionParameter.number1.name",detail:"formula.functionList.INFO.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.INFO.functionParameter.number2.name",detail:"formula.functionList.INFO.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_INFORMATION.ISBETWEEN,functionType:t.FunctionType.Information,description:"formula.functionList.ISBETWEEN.description",abstract:"formula.functionList.ISBETWEEN.abstract",functionParameter:[{name:"formula.functionList.ISBETWEEN.functionParameter.valueToCompare.name",detail:"formula.functionList.ISBETWEEN.functionParameter.valueToCompare.detail",example:"7.9",require:1,repeat:0},{name:"formula.functionList.ISBETWEEN.functionParameter.lowerValue.name",detail:"formula.functionList.ISBETWEEN.functionParameter.lowerValue.detail",example:"1.2",require:1,repeat:0},{name:"formula.functionList.ISBETWEEN.functionParameter.upperValue.name",detail:"formula.functionList.ISBETWEEN.functionParameter.upperValue.detail",example:"12.45",require:1,repeat:0},{name:"formula.functionList.ISBETWEEN.functionParameter.lowerValueIsInclusive.name",detail:"formula.functionList.ISBETWEEN.functionParameter.lowerValueIsInclusive.detail",example:"true",require:0,repeat:0},{name:"formula.functionList.ISBETWEEN.functionParameter.upperValueIsInclusive.name",detail:"formula.functionList.ISBETWEEN.functionParameter.upperValueIsInclusive.detail",example:"true",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_INFORMATION.ISBLANK,functionType:t.FunctionType.Information,description:"formula.functionList.ISBLANK.description",abstract:"formula.functionList.ISBLANK.abstract",functionParameter:[{name:"formula.functionList.ISBLANK.functionParameter.value.name",detail:"formula.functionList.ISBLANK.functionParameter.value.detail",example:"A1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_INFORMATION.ISDATE,functionType:t.FunctionType.Information,description:"formula.functionList.ISDATE.description",abstract:"formula.functionList.ISDATE.abstract",functionParameter:[{name:"formula.functionList.ISDATE.functionParameter.value.name",detail:"formula.functionList.ISDATE.functionParameter.value.detail",example:"A1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_INFORMATION.ISEMAIL,functionType:t.FunctionType.Information,description:"formula.functionList.ISEMAIL.description",abstract:"formula.functionList.ISEMAIL.abstract",functionParameter:[{name:"formula.functionList.ISEMAIL.functionParameter.value.name",detail:"formula.functionList.ISEMAIL.functionParameter.value.detail",example:'"developer@univer.ai"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_INFORMATION.ISERR,functionType:t.FunctionType.Information,description:"formula.functionList.ISERR.description",abstract:"formula.functionList.ISERR.abstract",functionParameter:[{name:"formula.functionList.ISERR.functionParameter.value.name",detail:"formula.functionList.ISERR.functionParameter.value.detail",example:"A1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_INFORMATION.ISERROR,functionType:t.FunctionType.Information,description:"formula.functionList.ISERROR.description",abstract:"formula.functionList.ISERROR.abstract",functionParameter:[{name:"formula.functionList.ISERROR.functionParameter.value.name",detail:"formula.functionList.ISERROR.functionParameter.value.detail",example:"A1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_INFORMATION.ISEVEN,functionType:t.FunctionType.Information,description:"formula.functionList.ISEVEN.description",abstract:"formula.functionList.ISEVEN.abstract",functionParameter:[{name:"formula.functionList.ISEVEN.functionParameter.value.name",detail:"formula.functionList.ISEVEN.functionParameter.value.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_INFORMATION.ISFORMULA,functionType:t.FunctionType.Information,description:"formula.functionList.ISFORMULA.description",abstract:"formula.functionList.ISFORMULA.abstract",functionParameter:[{name:"formula.functionList.ISFORMULA.functionParameter.reference.name",detail:"formula.functionList.ISFORMULA.functionParameter.reference.detail",example:"A1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_INFORMATION.ISLOGICAL,functionType:t.FunctionType.Information,description:"formula.functionList.ISLOGICAL.description",abstract:"formula.functionList.ISLOGICAL.abstract",functionParameter:[{name:"formula.functionList.ISLOGICAL.functionParameter.value.name",detail:"formula.functionList.ISLOGICAL.functionParameter.value.detail",example:"A1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_INFORMATION.ISNA,functionType:t.FunctionType.Information,description:"formula.functionList.ISNA.description",abstract:"formula.functionList.ISNA.abstract",functionParameter:[{name:"formula.functionList.ISNA.functionParameter.value.name",detail:"formula.functionList.ISNA.functionParameter.value.detail",example:"A1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_INFORMATION.ISNONTEXT,functionType:t.FunctionType.Information,description:"formula.functionList.ISNONTEXT.description",abstract:"formula.functionList.ISNONTEXT.abstract",functionParameter:[{name:"formula.functionList.ISNONTEXT.functionParameter.value.name",detail:"formula.functionList.ISNONTEXT.functionParameter.value.detail",example:"A1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_INFORMATION.ISNUMBER,functionType:t.FunctionType.Information,description:"formula.functionList.ISNUMBER.description",abstract:"formula.functionList.ISNUMBER.abstract",functionParameter:[{name:"formula.functionList.ISNUMBER.functionParameter.value.name",detail:"formula.functionList.ISNUMBER.functionParameter.value.detail",example:"A1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_INFORMATION.ISODD,functionType:t.FunctionType.Information,description:"formula.functionList.ISODD.description",abstract:"formula.functionList.ISODD.abstract",functionParameter:[{name:"formula.functionList.ISODD.functionParameter.value.name",detail:"formula.functionList.ISODD.functionParameter.value.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_INFORMATION.ISOMITTED,functionType:t.FunctionType.Information,description:"formula.functionList.ISOMITTED.description",abstract:"formula.functionList.ISOMITTED.abstract",functionParameter:[{name:"formula.functionList.ISOMITTED.functionParameter.number1.name",detail:"formula.functionList.ISOMITTED.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ISOMITTED.functionParameter.number2.name",detail:"formula.functionList.ISOMITTED.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_INFORMATION.ISREF,functionType:t.FunctionType.Information,description:"formula.functionList.ISREF.description",abstract:"formula.functionList.ISREF.abstract",functionParameter:[{name:"formula.functionList.ISREF.functionParameter.value.name",detail:"formula.functionList.ISREF.functionParameter.value.detail",example:"A1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_INFORMATION.ISTEXT,functionType:t.FunctionType.Information,description:"formula.functionList.ISTEXT.description",abstract:"formula.functionList.ISTEXT.abstract",functionParameter:[{name:"formula.functionList.ISTEXT.functionParameter.value.name",detail:"formula.functionList.ISTEXT.functionParameter.value.detail",example:"A1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_INFORMATION.ISURL,functionType:t.FunctionType.Information,description:"formula.functionList.ISURL.description",abstract:"formula.functionList.ISURL.abstract",functionParameter:[{name:"formula.functionList.ISURL.functionParameter.value.name",detail:"formula.functionList.ISURL.functionParameter.value.detail",example:'"univer.ai"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_INFORMATION.N,functionType:t.FunctionType.Information,description:"formula.functionList.N.description",abstract:"formula.functionList.N.abstract",functionParameter:[{name:"formula.functionList.N.functionParameter.value.name",detail:"formula.functionList.N.functionParameter.value.detail",example:"7",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_INFORMATION.NA,functionType:t.FunctionType.Information,description:"formula.functionList.NA.description",abstract:"formula.functionList.NA.abstract",functionParameter:[]},{functionName:t.FUNCTION_NAMES_INFORMATION.SHEET,functionType:t.FunctionType.Information,description:"formula.functionList.SHEET.description",abstract:"formula.functionList.SHEET.abstract",functionParameter:[{name:"formula.functionList.SHEET.functionParameter.value.name",detail:"formula.functionList.SHEET.functionParameter.value.detail",example:"A1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_INFORMATION.SHEETS,functionType:t.FunctionType.Information,description:"formula.functionList.SHEETS.description",abstract:"formula.functionList.SHEETS.abstract",functionParameter:[]},{functionName:t.FUNCTION_NAMES_INFORMATION.TYPE,functionType:t.FunctionType.Information,description:"formula.functionList.TYPE.description",abstract:"formula.functionList.TYPE.abstract",functionParameter:[{name:"formula.functionList.TYPE.functionParameter.value.name",detail:"formula.functionList.TYPE.functionParameter.value.detail",example:"A2",require:1,repeat:0}]}],ea=[{functionName:t.FUNCTION_NAMES_LOGICAL.AND,functionType:t.FunctionType.Logical,description:"formula.functionList.AND.description",abstract:"formula.functionList.AND.abstract",functionParameter:[{name:"formula.functionList.AND.functionParameter.logical1.name",detail:"formula.functionList.AND.functionParameter.logical1.detail",example:"A1=1",require:1,repeat:0},{name:"formula.functionList.AND.functionParameter.logical2.name",detail:"formula.functionList.AND.functionParameter.logical2.detail",example:"A2=2",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_LOGICAL.BYCOL,functionType:t.FunctionType.Logical,description:"formula.functionList.BYCOL.description",abstract:"formula.functionList.BYCOL.abstract",functionParameter:[{name:"formula.functionList.BYCOL.functionParameter.array.name",detail:"formula.functionList.BYCOL.functionParameter.array.detail",example:"A1:C2",require:1,repeat:0},{name:"formula.functionList.BYCOL.functionParameter.lambda.name",detail:"formula.functionList.BYCOL.functionParameter.lambda.detail",example:"LAMBDA(array, MAX(array))",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOGICAL.BYROW,functionType:t.FunctionType.Logical,description:"formula.functionList.BYROW.description",abstract:"formula.functionList.BYROW.abstract",functionParameter:[{name:"formula.functionList.BYROW.functionParameter.array.name",detail:"formula.functionList.BYROW.functionParameter.array.detail",example:"A1:C2",require:1,repeat:0},{name:"formula.functionList.BYROW.functionParameter.lambda.name",detail:"formula.functionList.BYROW.functionParameter.lambda.detail",example:"LAMBDA(array, MAX(array))",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOGICAL.FALSE,functionType:t.FunctionType.Logical,description:"formula.functionList.FALSE.description",abstract:"formula.functionList.FALSE.abstract",functionParameter:[]},{functionName:t.FUNCTION_NAMES_LOGICAL.IF,functionType:t.FunctionType.Logical,description:"formula.functionList.IF.description",abstract:"formula.functionList.IF.abstract",functionParameter:[{name:"formula.functionList.IF.functionParameter.logicalTest.name",detail:"formula.functionList.IF.functionParameter.logicalTest.detail",example:'A2 = "foo"',require:1,repeat:0},{name:"formula.functionList.IF.functionParameter.valueIfTrue.name",detail:"formula.functionList.IF.functionParameter.valueIfTrue.detail",example:'"A2 is foo"',require:1,repeat:0},{name:"formula.functionList.IF.functionParameter.valueIfFalse.name",detail:"formula.functionList.IF.functionParameter.valueIfFalse.detail",example:'"A2 is not foo"',require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOGICAL.IFERROR,functionType:t.FunctionType.Logical,description:"formula.functionList.IFERROR.description",abstract:"formula.functionList.IFERROR.abstract",functionParameter:[{name:"formula.functionList.IFERROR.functionParameter.value.name",detail:"formula.functionList.IFERROR.functionParameter.value.detail",example:"A2/B2",require:1,repeat:0},{name:"formula.functionList.IFERROR.functionParameter.valueIfError.name",detail:"formula.functionList.IFERROR.functionParameter.valueIfError.detail",example:'"Error in calculation"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOGICAL.IFNA,functionType:t.FunctionType.Logical,description:"formula.functionList.IFNA.description",abstract:"formula.functionList.IFNA.abstract",functionParameter:[{name:"formula.functionList.IFNA.functionParameter.value.name",detail:"formula.functionList.IFNA.functionParameter.value.detail",example:"VLOOKUP(C3,C6:D11,2,FALSE)",require:1,repeat:0},{name:"formula.functionList.IFNA.functionParameter.valueIfNa.name",detail:"formula.functionList.IFNA.functionParameter.valueIfNa.detail",example:'"Not Found"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOGICAL.IFS,functionType:t.FunctionType.Logical,description:"formula.functionList.IFS.description",abstract:"formula.functionList.IFS.abstract",functionParameter:[{name:"formula.functionList.IFS.functionParameter.logicalTest1.name",detail:"formula.functionList.IFS.functionParameter.logicalTest1.detail",example:'A2 = "foo"',require:1,repeat:0},{name:"formula.functionList.IFS.functionParameter.valueIfTrue1.name",detail:"formula.functionList.IFS.functionParameter.valueIfTrue1.detail",example:'"A2 is foo"',require:1,repeat:0},{name:"formula.functionList.IFS.functionParameter.logicalTest2.name",detail:"formula.functionList.IFS.functionParameter.logicalTest2.detail",example:"F2=1",require:0,repeat:1},{name:"formula.functionList.IFS.functionParameter.valueIfTrue2.name",detail:"formula.functionList.IFS.functionParameter.valueIfTrue2.detail",example:"D2",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_LOGICAL.LAMBDA,functionType:t.FunctionType.Logical,description:"formula.functionList.LAMBDA.description",abstract:"formula.functionList.LAMBDA.abstract",functionParameter:[{name:"formula.functionList.LAMBDA.functionParameter.parameter.name",detail:"formula.functionList.LAMBDA.functionParameter.parameter.detail",example:"[x, y, ,]",require:0,repeat:1},{name:"formula.functionList.LAMBDA.functionParameter.calculation.name",detail:"formula.functionList.LAMBDA.functionParameter.calculation.detail",example:"x+y",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOGICAL.LET,functionType:t.FunctionType.Logical,description:"formula.functionList.LET.description",abstract:"formula.functionList.LET.abstract",functionParameter:[{name:"formula.functionList.LET.functionParameter.name1.name",detail:"formula.functionList.LET.functionParameter.name1.detail",example:"x",require:1,repeat:0},{name:"formula.functionList.LET.functionParameter.nameValue1.name",detail:"formula.functionList.LET.functionParameter.nameValue1.detail",example:"5",require:1,repeat:0},{name:"formula.functionList.LET.functionParameter.calculationOrName2.name",detail:"formula.functionList.LET.functionParameter.calculationOrName2.detail",example:"y",require:1,repeat:0},{name:"formula.functionList.LET.functionParameter.nameValue2.name",detail:"formula.functionList.LET.functionParameter.nameValue2.detail",example:"6",require:0,repeat:1},{name:"formula.functionList.LET.functionParameter.calculationOrName3.name",detail:"formula.functionList.LET.functionParameter.calculationOrName3.detail",example:"SUM(x,y)",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_LOGICAL.MAKEARRAY,aliasFunctionName:"formula.functionList.MAKEARRAY.aliasFunctionName",functionType:t.FunctionType.Logical,description:"formula.functionList.MAKEARRAY.description",abstract:"formula.functionList.MAKEARRAY.abstract",functionParameter:[{name:"formula.functionList.MAKEARRAY.functionParameter.number1.name",detail:"formula.functionList.MAKEARRAY.functionParameter.number1.detail",example:"8",require:1,repeat:0},{name:"formula.functionList.MAKEARRAY.functionParameter.number2.name",detail:"formula.functionList.MAKEARRAY.functionParameter.number2.detail",example:"7",require:1,repeat:0},{name:"formula.functionList.MAKEARRAY.functionParameter.value3.name",detail:"formula.functionList.MAKEARRAY.functionParameter.value3.detail",example:"LAMBDA(r,c, r*c)",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOGICAL.MAP,functionType:t.FunctionType.Logical,description:"formula.functionList.MAP.description",abstract:"formula.functionList.MAP.abstract",functionParameter:[{name:"formula.functionList.MAP.functionParameter.array1.name",detail:"formula.functionList.MAP.functionParameter.array1.detail",example:"D2:D11",require:1,repeat:0},{name:"formula.functionList.MAP.functionParameter.array2.name",detail:"formula.functionList.MAP.functionParameter.array2.detail",example:"E2:E11",require:0,repeat:1},{name:"formula.functionList.MAP.functionParameter.lambda.name",detail:"formula.functionList.MAP.functionParameter.lambda.detail",example:'LAMBDA(s,c,AND(s="Large",c="Red"))',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOGICAL.NOT,functionType:t.FunctionType.Logical,description:"formula.functionList.NOT.description",abstract:"formula.functionList.NOT.abstract",functionParameter:[{name:"formula.functionList.NOT.functionParameter.logical.name",detail:"formula.functionList.NOT.functionParameter.logical.detail",example:"A2>100",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOGICAL.OR,functionType:t.FunctionType.Logical,description:"formula.functionList.OR.description",abstract:"formula.functionList.OR.abstract",functionParameter:[{name:"formula.functionList.OR.functionParameter.logical1.name",detail:"formula.functionList.OR.functionParameter.logical1.detail",example:"A1=1",require:1,repeat:0},{name:"formula.functionList.OR.functionParameter.logical2.name",detail:"formula.functionList.OR.functionParameter.logical2.detail",example:"A2=2",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_LOGICAL.REDUCE,functionType:t.FunctionType.Logical,description:"formula.functionList.REDUCE.description",abstract:"formula.functionList.REDUCE.abstract",functionParameter:[{name:"formula.functionList.REDUCE.functionParameter.initialValue.name",detail:"formula.functionList.REDUCE.functionParameter.initialValue.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.REDUCE.functionParameter.array.name",detail:"formula.functionList.REDUCE.functionParameter.array.detail",example:"A1:C2",require:1,repeat:0},{name:"formula.functionList.REDUCE.functionParameter.lambda.name",detail:"formula.functionList.REDUCE.functionParameter.lambda.detail",example:"LAMBDA(a,b,a+b^2)",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOGICAL.SCAN,functionType:t.FunctionType.Logical,description:"formula.functionList.SCAN.description",abstract:"formula.functionList.SCAN.abstract",functionParameter:[{name:"formula.functionList.SCAN.functionParameter.initialValue.name",detail:"formula.functionList.SCAN.functionParameter.initialValue.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.SCAN.functionParameter.array.name",detail:"formula.functionList.SCAN.functionParameter.array.detail",example:"A1:C2",require:1,repeat:0},{name:"formula.functionList.SCAN.functionParameter.lambda.name",detail:"formula.functionList.SCAN.functionParameter.lambda.detail",example:"LAMBDA(a,b,a+b^2)",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOGICAL.SWITCH,functionType:t.FunctionType.Logical,description:"formula.functionList.SWITCH.description",abstract:"formula.functionList.SWITCH.abstract",functionParameter:[{name:"formula.functionList.SWITCH.functionParameter.expression.name",detail:"formula.functionList.SWITCH.functionParameter.expression.detail",example:"WEEKDAY(A2)",require:1,repeat:0},{name:"formula.functionList.SWITCH.functionParameter.value1.name",detail:"formula.functionList.SWITCH.functionParameter.value1.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.SWITCH.functionParameter.result1.name",detail:"formula.functionList.SWITCH.functionParameter.result1.detail",example:'"Sunday"',require:1,repeat:0},{name:"formula.functionList.SWITCH.functionParameter.defaultOrValue2.name",detail:"formula.functionList.SWITCH.functionParameter.defaultOrValue2.detail",example:"2",require:0,repeat:1},{name:"formula.functionList.SWITCH.functionParameter.result2.name",detail:"formula.functionList.SWITCH.functionParameter.result2.detail",example:'"Monday"',require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_LOGICAL.TRUE,functionType:t.FunctionType.Logical,description:"formula.functionList.TRUE.description",abstract:"formula.functionList.TRUE.abstract",functionParameter:[]},{functionName:t.FUNCTION_NAMES_LOGICAL.XOR,functionType:t.FunctionType.Logical,description:"formula.functionList.XOR.description",abstract:"formula.functionList.XOR.abstract",functionParameter:[{name:"formula.functionList.XOR.functionParameter.logical1.name",detail:"formula.functionList.XOR.functionParameter.logical1.detail",example:"3>0",require:1,repeat:0},{name:"formula.functionList.XOR.functionParameter.logical2.name",detail:"formula.functionList.XOR.functionParameter.logical2.detail",example:"2<9",require:0,repeat:1}]}],aa=[{functionName:t.FUNCTION_NAMES_LOOKUP.ADDRESS,functionType:t.FunctionType.Lookup,description:"formula.functionList.ADDRESS.description",abstract:"formula.functionList.ADDRESS.abstract",functionParameter:[{name:"formula.functionList.ADDRESS.functionParameter.row_num.name",detail:"formula.functionList.ADDRESS.functionParameter.row_num.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.ADDRESS.functionParameter.column_num.name",detail:"formula.functionList.ADDRESS.functionParameter.column_num.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.ADDRESS.functionParameter.abs_num.name",detail:"formula.functionList.ADDRESS.functionParameter.abs_num.detail",example:"1",require:0,repeat:0},{name:"formula.functionList.ADDRESS.functionParameter.a1.name",detail:"formula.functionList.ADDRESS.functionParameter.a1.detail",example:"TRUE",require:0,repeat:0},{name:"formula.functionList.ADDRESS.functionParameter.sheet_text.name",detail:"formula.functionList.ADDRESS.functionParameter.sheet_text.detail",example:'"Sheet2"',require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOOKUP.AREAS,functionType:t.FunctionType.Lookup,description:"formula.functionList.AREAS.description",abstract:"formula.functionList.AREAS.abstract",functionParameter:[{name:"formula.functionList.AREAS.functionParameter.reference.name",detail:"formula.functionList.AREAS.functionParameter.reference.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOOKUP.CHOOSE,functionType:t.FunctionType.Lookup,description:"formula.functionList.CHOOSE.description",abstract:"formula.functionList.CHOOSE.abstract",functionParameter:[{name:"formula.functionList.CHOOSE.functionParameter.indexNum.name",detail:"formula.functionList.CHOOSE.functionParameter.indexNum.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.CHOOSE.functionParameter.value1.name",detail:"formula.functionList.CHOOSE.functionParameter.value1.detail",example:'"Hello"',require:1,repeat:0},{name:"formula.functionList.CHOOSE.functionParameter.value2.name",detail:"formula.functionList.CHOOSE.functionParameter.value2.detail",example:'"Univer"',require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_LOOKUP.CHOOSECOLS,functionType:t.FunctionType.Lookup,description:"formula.functionList.CHOOSECOLS.description",abstract:"formula.functionList.CHOOSECOLS.abstract",functionParameter:[{name:"formula.functionList.CHOOSECOLS.functionParameter.array.name",detail:"formula.functionList.CHOOSECOLS.functionParameter.array.detail",example:"A1:C2",require:1,repeat:0},{name:"formula.functionList.CHOOSECOLS.functionParameter.colNum1.name",detail:"formula.functionList.CHOOSECOLS.functionParameter.colNum1.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.CHOOSECOLS.functionParameter.colNum2.name",detail:"formula.functionList.CHOOSECOLS.functionParameter.colNum2.detail",example:"2",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_LOOKUP.CHOOSEROWS,functionType:t.FunctionType.Lookup,description:"formula.functionList.CHOOSEROWS.description",abstract:"formula.functionList.CHOOSEROWS.abstract",functionParameter:[{name:"formula.functionList.CHOOSEROWS.functionParameter.array.name",detail:"formula.functionList.CHOOSEROWS.functionParameter.array.detail",example:"A1:C2",require:1,repeat:0},{name:"formula.functionList.CHOOSEROWS.functionParameter.rowNum1.name",detail:"formula.functionList.CHOOSEROWS.functionParameter.rowNum1.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.CHOOSEROWS.functionParameter.rowNum2.name",detail:"formula.functionList.CHOOSEROWS.functionParameter.rowNum2.detail",example:"2",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_LOOKUP.COLUMN,functionType:t.FunctionType.Lookup,description:"formula.functionList.COLUMN.description",abstract:"formula.functionList.COLUMN.abstract",functionParameter:[{name:"formula.functionList.COLUMN.functionParameter.reference.name",detail:"formula.functionList.COLUMN.functionParameter.reference.detail",example:"A1:A20",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOOKUP.COLUMNS,functionType:t.FunctionType.Lookup,description:"formula.functionList.COLUMNS.description",abstract:"formula.functionList.COLUMNS.abstract",functionParameter:[{name:"formula.functionList.COLUMNS.functionParameter.array.name",detail:"formula.functionList.COLUMNS.functionParameter.array.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOOKUP.DROP,functionType:t.FunctionType.Lookup,description:"formula.functionList.DROP.description",abstract:"formula.functionList.DROP.abstract",functionParameter:[{name:"formula.functionList.DROP.functionParameter.array.name",detail:"formula.functionList.DROP.functionParameter.array.detail",example:"A2:C4",require:1,repeat:0},{name:"formula.functionList.DROP.functionParameter.rows.name",detail:"formula.functionList.DROP.functionParameter.rows.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.DROP.functionParameter.columns.name",detail:"formula.functionList.DROP.functionParameter.columns.detail",example:"2",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOOKUP.EXPAND,functionType:t.FunctionType.Lookup,description:"formula.functionList.EXPAND.description",abstract:"formula.functionList.EXPAND.abstract",functionParameter:[{name:"formula.functionList.EXPAND.functionParameter.array.name",detail:"formula.functionList.EXPAND.functionParameter.array.detail",example:"A2",require:1,repeat:0},{name:"formula.functionList.EXPAND.functionParameter.rows.name",detail:"formula.functionList.EXPAND.functionParameter.rows.detail",example:"3",require:1,repeat:0},{name:"formula.functionList.EXPAND.functionParameter.columns.name",detail:"formula.functionList.EXPAND.functionParameter.columns.detail",example:"3",require:0,repeat:0},{name:"formula.functionList.EXPAND.functionParameter.padWith.name",detail:"formula.functionList.EXPAND.functionParameter.padWith.detail",example:'"-"',require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOOKUP.FILTER,functionType:t.FunctionType.Lookup,description:"formula.functionList.FILTER.description",abstract:"formula.functionList.FILTER.abstract",functionParameter:[{name:"formula.functionList.FILTER.functionParameter.array.name",detail:"formula.functionList.FILTER.functionParameter.array.detail",example:"A5:D20",require:1,repeat:0},{name:"formula.functionList.FILTER.functionParameter.include.name",detail:"formula.functionList.FILTER.functionParameter.include.detail",example:'(C5:C20="Apple")*(A5:A20="East")',require:1,repeat:0},{name:"formula.functionList.FILTER.functionParameter.ifEmpty.name",detail:"formula.functionList.FILTER.functionParameter.ifEmpty.detail",example:'""',require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOOKUP.FORMULATEXT,functionType:t.FunctionType.Lookup,description:"formula.functionList.FORMULATEXT.description",abstract:"formula.functionList.FORMULATEXT.abstract",functionParameter:[{name:"formula.functionList.FORMULATEXT.functionParameter.reference.name",detail:"formula.functionList.FORMULATEXT.functionParameter.reference.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOOKUP.GETPIVOTDATA,functionType:t.FunctionType.Lookup,description:"formula.functionList.GETPIVOTDATA.description",abstract:"formula.functionList.GETPIVOTDATA.abstract",functionParameter:[{name:"formula.functionList.GETPIVOTDATA.functionParameter.number1.name",detail:"formula.functionList.GETPIVOTDATA.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.GETPIVOTDATA.functionParameter.number2.name",detail:"formula.functionList.GETPIVOTDATA.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOOKUP.HLOOKUP,functionType:t.FunctionType.Lookup,description:"formula.functionList.HLOOKUP.description",abstract:"formula.functionList.HLOOKUP.abstract",functionParameter:[{name:"formula.functionList.HLOOKUP.functionParameter.lookupValue.name",detail:"formula.functionList.HLOOKUP.functionParameter.lookupValue.detail",example:"A1",require:1,repeat:0},{name:"formula.functionList.HLOOKUP.functionParameter.tableArray.name",detail:"formula.functionList.HLOOKUP.functionParameter.tableArray.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.HLOOKUP.functionParameter.rowIndexNum.name",detail:"formula.functionList.HLOOKUP.functionParameter.rowIndexNum.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.HLOOKUP.functionParameter.rangeLookup.name",detail:"formula.functionList.HLOOKUP.functionParameter.rangeLookup.detail",example:"false",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOOKUP.HSTACK,functionType:t.FunctionType.Lookup,description:"formula.functionList.HSTACK.description",abstract:"formula.functionList.HSTACK.abstract",functionParameter:[{name:"formula.functionList.HSTACK.functionParameter.array1.name",detail:"formula.functionList.HSTACK.functionParameter.array1.detail",example:"A2:C3",require:1,repeat:0},{name:"formula.functionList.HSTACK.functionParameter.array2.name",detail:"formula.functionList.HSTACK.functionParameter.array2.detail",example:"E2:G3",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_LOOKUP.HYPERLINK,functionType:t.FunctionType.Lookup,description:"formula.functionList.HYPERLINK.description",abstract:"formula.functionList.HYPERLINK.abstract",functionParameter:[{name:"formula.functionList.HYPERLINK.functionParameter.url.name",detail:"formula.functionList.HYPERLINK.functionParameter.url.detail",example:'"https://univer.ai/"',require:1,repeat:0},{name:"formula.functionList.HYPERLINK.functionParameter.linkLabel.name",detail:"formula.functionList.HYPERLINK.functionParameter.linkLabel.detail",example:'"Univer"',require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOOKUP.IMAGE,functionType:t.FunctionType.Lookup,description:"formula.functionList.IMAGE.description",abstract:"formula.functionList.IMAGE.abstract",functionParameter:[{name:"formula.functionList.IMAGE.functionParameter.source.name",detail:"formula.functionList.IMAGE.functionParameter.source.detail",example:'"https://github.com/dream-num.png"',require:1,repeat:0},{name:"formula.functionList.IMAGE.functionParameter.altText.name",detail:"formula.functionList.IMAGE.functionParameter.altText.detail",example:'"Univer Logo"',require:0,repeat:0},{name:"formula.functionList.IMAGE.functionParameter.sizing.name",detail:"formula.functionList.IMAGE.functionParameter.sizing.detail",example:"3",require:0,repeat:0},{name:"formula.functionList.IMAGE.functionParameter.height.name",detail:"formula.functionList.IMAGE.functionParameter.height.detail",example:"100",require:0,repeat:0},{name:"formula.functionList.IMAGE.functionParameter.width.name",detail:"formula.functionList.IMAGE.functionParameter.width.detail",example:"100",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOOKUP.INDEX,functionType:t.FunctionType.Lookup,description:"formula.functionList.INDEX.description",abstract:"formula.functionList.INDEX.abstract",functionParameter:[{name:"formula.functionList.INDEX.functionParameter.reference.name",detail:"formula.functionList.INDEX.functionParameter.reference.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.INDEX.functionParameter.rowNum.name",detail:"formula.functionList.INDEX.functionParameter.rowNum.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.INDEX.functionParameter.columnNum.name",detail:"formula.functionList.INDEX.functionParameter.columnNum.detail",example:"1",require:0,repeat:0},{name:"formula.functionList.INDEX.functionParameter.areaNum.name",detail:"formula.functionList.INDEX.functionParameter.areaNum.detail",example:"2",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOOKUP.INDIRECT,functionType:t.FunctionType.Lookup,description:"formula.functionList.INDIRECT.description",abstract:"formula.functionList.INDIRECT.abstract",functionParameter:[{name:"formula.functionList.INDIRECT.functionParameter.refText.name",detail:"formula.functionList.INDIRECT.functionParameter.refText.detail",example:'"A1"',require:1,repeat:0},{name:"formula.functionList.INDIRECT.functionParameter.a1.name",detail:"formula.functionList.INDIRECT.functionParameter.a1.detail",example:"TRUE",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOOKUP.LOOKUP,functionType:t.FunctionType.Lookup,description:"formula.functionList.LOOKUP.description",abstract:"formula.functionList.LOOKUP.abstract",functionParameter:[{name:"formula.functionList.LOOKUP.functionParameter.lookupValue.name",detail:"formula.functionList.LOOKUP.functionParameter.lookupValue.detail",example:"A1",require:1,repeat:0},{name:"formula.functionList.LOOKUP.functionParameter.lookupVectorOrArray.name",detail:"formula.functionList.LOOKUP.functionParameter.lookupVectorOrArray.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.LOOKUP.functionParameter.resultVector.name",detail:"formula.functionList.LOOKUP.functionParameter.resultVector.detail",example:"A1:A20",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOOKUP.MATCH,functionType:t.FunctionType.Lookup,description:"formula.functionList.MATCH.description",abstract:"formula.functionList.MATCH.abstract",functionParameter:[{name:"formula.functionList.MATCH.functionParameter.lookupValue.name",detail:"formula.functionList.MATCH.functionParameter.lookupValue.detail",example:"10",require:1,repeat:0},{name:"formula.functionList.MATCH.functionParameter.lookupArray.name",detail:"formula.functionList.MATCH.functionParameter.lookupArray.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MATCH.functionParameter.matchType.name",detail:"formula.functionList.MATCH.functionParameter.matchType.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOOKUP.OFFSET,functionType:t.FunctionType.Lookup,description:"formula.functionList.OFFSET.description",abstract:"formula.functionList.OFFSET.abstract",functionParameter:[{name:"formula.functionList.OFFSET.functionParameter.reference.name",detail:"formula.functionList.OFFSET.functionParameter.reference.detail",example:"A1",require:1,repeat:0},{name:"formula.functionList.OFFSET.functionParameter.rows.name",detail:"formula.functionList.OFFSET.functionParameter.rows.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.OFFSET.functionParameter.cols.name",detail:"formula.functionList.OFFSET.functionParameter.cols.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.OFFSET.functionParameter.height.name",detail:"formula.functionList.OFFSET.functionParameter.height.detail",example:"1",require:0,repeat:0},{name:"formula.functionList.OFFSET.functionParameter.width.name",detail:"formula.functionList.OFFSET.functionParameter.width.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOOKUP.ROW,functionType:t.FunctionType.Lookup,description:"formula.functionList.ROW.description",abstract:"formula.functionList.ROW.abstract",functionParameter:[{name:"formula.functionList.ROW.functionParameter.reference.name",detail:"formula.functionList.ROW.functionParameter.reference.detail",example:"A1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOOKUP.ROWS,functionType:t.FunctionType.Lookup,description:"formula.functionList.ROWS.description",abstract:"formula.functionList.ROWS.abstract",functionParameter:[{name:"formula.functionList.ROWS.functionParameter.array.name",detail:"formula.functionList.ROWS.functionParameter.array.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOOKUP.RTD,functionType:t.FunctionType.Lookup,description:"formula.functionList.RTD.description",abstract:"formula.functionList.RTD.abstract",functionParameter:[{name:"formula.functionList.RTD.functionParameter.number1.name",detail:"formula.functionList.RTD.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.RTD.functionParameter.number2.name",detail:"formula.functionList.RTD.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOOKUP.SORT,functionType:t.FunctionType.Lookup,description:"formula.functionList.SORT.description",abstract:"formula.functionList.SORT.abstract",functionParameter:[{name:"formula.functionList.SORT.functionParameter.array.name",detail:"formula.functionList.SORT.functionParameter.array.detail",example:"A2:A17",require:1,repeat:0},{name:"formula.functionList.SORT.functionParameter.sortIndex.name",detail:"formula.functionList.SORT.functionParameter.sortIndex.detail",example:"1",require:0,repeat:0},{name:"formula.functionList.SORT.functionParameter.sortOrder.name",detail:"formula.functionList.SORT.functionParameter.sortOrder.detail",example:"1",require:0,repeat:0},{name:"formula.functionList.SORT.functionParameter.byCol.name",detail:"formula.functionList.SORT.functionParameter.byCol.detail",example:"false",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOOKUP.SORTBY,functionType:t.FunctionType.Lookup,description:"formula.functionList.SORTBY.description",abstract:"formula.functionList.SORTBY.abstract",functionParameter:[{name:"formula.functionList.SORTBY.functionParameter.array.name",detail:"formula.functionList.SORTBY.functionParameter.array.detail",example:"D2:D9",require:1,repeat:0},{name:"formula.functionList.SORTBY.functionParameter.byArray1.name",detail:"formula.functionList.SORTBY.functionParameter.byArray1.detail",example:"E2:E9",require:1,repeat:0},{name:"formula.functionList.SORTBY.functionParameter.sortOrder1.name",detail:"formula.functionList.SORTBY.functionParameter.sortOrder1.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.SORTBY.functionParameter.byArray2.name",detail:"formula.functionList.SORTBY.functionParameter.byArray2.detail",example:"E2:E9",require:0,repeat:1},{name:"formula.functionList.SORTBY.functionParameter.sortOrder2.name",detail:"formula.functionList.SORTBY.functionParameter.sortOrder2.detail",example:"1",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_LOOKUP.TAKE,functionType:t.FunctionType.Lookup,description:"formula.functionList.TAKE.description",abstract:"formula.functionList.TAKE.abstract",functionParameter:[{name:"formula.functionList.TAKE.functionParameter.array.name",detail:"formula.functionList.TAKE.functionParameter.array.detail",example:"A2:C4",require:1,repeat:0},{name:"formula.functionList.TAKE.functionParameter.rows.name",detail:"formula.functionList.TAKE.functionParameter.rows.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.TAKE.functionParameter.columns.name",detail:"formula.functionList.TAKE.functionParameter.columns.detail",example:"2",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOOKUP.TOCOL,functionType:t.FunctionType.Lookup,description:"formula.functionList.TOCOL.description",abstract:"formula.functionList.TOCOL.abstract",functionParameter:[{name:"formula.functionList.TOCOL.functionParameter.array.name",detail:"formula.functionList.TOCOL.functionParameter.array.detail",example:"A2:D4",require:1,repeat:0},{name:"formula.functionList.TOCOL.functionParameter.ignore.name",detail:"formula.functionList.TOCOL.functionParameter.ignore.detail",example:"1",require:0,repeat:0},{name:"formula.functionList.TOCOL.functionParameter.scanByColumn.name",detail:"formula.functionList.TOCOL.functionParameter.scanByColumn.detail",example:"TRUE",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOOKUP.TOROW,functionType:t.FunctionType.Lookup,description:"formula.functionList.TOROW.description",abstract:"formula.functionList.TOROW.abstract",functionParameter:[{name:"formula.functionList.TOROW.functionParameter.array.name",detail:"formula.functionList.TOROW.functionParameter.array.detail",example:"A2:D4",require:1,repeat:0},{name:"formula.functionList.TOROW.functionParameter.ignore.name",detail:"formula.functionList.TOROW.functionParameter.ignore.detail",example:"1",require:0,repeat:0},{name:"formula.functionList.TOROW.functionParameter.scanByColumn.name",detail:"formula.functionList.TOROW.functionParameter.scanByColumn.detail",example:"TRUE",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOOKUP.TRANSPOSE,functionType:t.FunctionType.Lookup,description:"formula.functionList.TRANSPOSE.description",abstract:"formula.functionList.TRANSPOSE.abstract",functionParameter:[{name:"formula.functionList.TRANSPOSE.functionParameter.array.name",detail:"formula.functionList.TRANSPOSE.functionParameter.array.detail",example:"A2:F9",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOOKUP.UNIQUE,functionType:t.FunctionType.Lookup,description:"formula.functionList.UNIQUE.description",abstract:"formula.functionList.UNIQUE.abstract",functionParameter:[{name:"formula.functionList.UNIQUE.functionParameter.array.name",detail:"formula.functionList.UNIQUE.functionParameter.array.detail",example:"A2:A12",require:1,repeat:0},{name:"formula.functionList.UNIQUE.functionParameter.byCol.name",detail:"formula.functionList.UNIQUE.functionParameter.byCol.detail",example:"false",require:0,repeat:0},{name:"formula.functionList.UNIQUE.functionParameter.exactlyOnce.name",detail:"formula.functionList.UNIQUE.functionParameter.exactlyOnce.detail",example:"false",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOOKUP.VLOOKUP,functionType:t.FunctionType.Lookup,description:"formula.functionList.VLOOKUP.description",abstract:"formula.functionList.VLOOKUP.abstract",functionParameter:[{name:"formula.functionList.VLOOKUP.functionParameter.lookupValue.name",detail:"formula.functionList.VLOOKUP.functionParameter.lookupValue.detail",example:"B2",require:1,repeat:0},{name:"formula.functionList.VLOOKUP.functionParameter.tableArray.name",detail:"formula.functionList.VLOOKUP.functionParameter.tableArray.detail",example:"C2:E7",require:1,repeat:0},{name:"formula.functionList.VLOOKUP.functionParameter.colIndexNum.name",detail:"formula.functionList.VLOOKUP.functionParameter.colIndexNum.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.VLOOKUP.functionParameter.rangeLookup.name",detail:"formula.functionList.VLOOKUP.functionParameter.rangeLookup.detail",example:"TRUE",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOOKUP.VSTACK,functionType:t.FunctionType.Lookup,description:"formula.functionList.VSTACK.description",abstract:"formula.functionList.VSTACK.abstract",functionParameter:[{name:"formula.functionList.VSTACK.functionParameter.array1.name",detail:"formula.functionList.VSTACK.functionParameter.array1.detail",example:"A2:C3",require:1,repeat:0},{name:"formula.functionList.VSTACK.functionParameter.array2.name",detail:"formula.functionList.VSTACK.functionParameter.array2.detail",example:"E2:G3",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_LOOKUP.WRAPCOLS,functionType:t.FunctionType.Lookup,description:"formula.functionList.WRAPCOLS.description",abstract:"formula.functionList.WRAPCOLS.abstract",functionParameter:[{name:"formula.functionList.WRAPCOLS.functionParameter.vector.name",detail:"formula.functionList.WRAPCOLS.functionParameter.vector.detail",example:"A2:G2",require:1,repeat:0},{name:"formula.functionList.WRAPCOLS.functionParameter.wrapCount.name",detail:"formula.functionList.WRAPCOLS.functionParameter.wrapCount.detail",example:"3",require:1,repeat:0},{name:"formula.functionList.WRAPCOLS.functionParameter.padWith.name",detail:"formula.functionList.WRAPCOLS.functionParameter.padWith.detail",example:'"x"',require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOOKUP.WRAPROWS,functionType:t.FunctionType.Lookup,description:"formula.functionList.WRAPROWS.description",abstract:"formula.functionList.WRAPROWS.abstract",functionParameter:[{name:"formula.functionList.WRAPROWS.functionParameter.vector.name",detail:"formula.functionList.WRAPROWS.functionParameter.vector.detail",example:"A2:G2",require:1,repeat:0},{name:"formula.functionList.WRAPROWS.functionParameter.wrapCount.name",detail:"formula.functionList.WRAPROWS.functionParameter.wrapCount.detail",example:"3",require:1,repeat:0},{name:"formula.functionList.WRAPROWS.functionParameter.padWith.name",detail:"formula.functionList.WRAPROWS.functionParameter.padWith.detail",example:'"x"',require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOOKUP.XLOOKUP,functionType:t.FunctionType.Lookup,description:"formula.functionList.XLOOKUP.description",abstract:"formula.functionList.XLOOKUP.abstract",functionParameter:[{name:"formula.functionList.XLOOKUP.functionParameter.lookupValue.name",detail:"formula.functionList.XLOOKUP.functionParameter.lookupValue.detail",example:"A1",require:1,repeat:0},{name:"formula.functionList.XLOOKUP.functionParameter.lookupArray.name",detail:"formula.functionList.XLOOKUP.functionParameter.lookupArray.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.XLOOKUP.functionParameter.returnArray.name",detail:"formula.functionList.XLOOKUP.functionParameter.returnArray.detail",example:"B1:B20",require:1,repeat:0},{name:"formula.functionList.XLOOKUP.functionParameter.ifNotFound.name",detail:"formula.functionList.XLOOKUP.functionParameter.ifNotFound.detail",example:"default",require:0,repeat:0},{name:"formula.functionList.XLOOKUP.functionParameter.matchMode.name",detail:"formula.functionList.XLOOKUP.functionParameter.matchMode.detail",example:"0",require:0,repeat:0},{name:"formula.functionList.XLOOKUP.functionParameter.searchMode.name",detail:"formula.functionList.XLOOKUP.functionParameter.searchMode.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_LOOKUP.XMATCH,functionType:t.FunctionType.Lookup,description:"formula.functionList.XMATCH.description",abstract:"formula.functionList.XMATCH.abstract",functionParameter:[{name:"formula.functionList.XMATCH.functionParameter.lookupValue.name",detail:"formula.functionList.XMATCH.functionParameter.lookupValue.detail",example:"B1",require:1,repeat:0},{name:"formula.functionList.XMATCH.functionParameter.lookupArray.name",detail:"formula.functionList.XMATCH.functionParameter.lookupArray.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.XMATCH.functionParameter.matchMode.name",detail:"formula.functionList.XMATCH.functionParameter.matchMode.detail",example:"0",require:0,repeat:0},{name:"formula.functionList.XMATCH.functionParameter.searchMode.name",detail:"formula.functionList.XMATCH.functionParameter.searchMode.detail",example:"1",require:0,repeat:0}]}],na=[{functionName:t.FUNCTION_NAMES_MATH.ABS,functionType:t.FunctionType.Math,description:"formula.functionList.ABS.description",abstract:"formula.functionList.ABS.abstract",functionParameter:[{name:"formula.functionList.ABS.functionParameter.number.name",detail:"formula.functionList.ABS.functionParameter.number.detail",example:"-2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.ACOS,functionType:t.FunctionType.Math,description:"formula.functionList.ACOS.description",abstract:"formula.functionList.ACOS.abstract",functionParameter:[{name:"formula.functionList.ACOS.functionParameter.number.name",detail:"formula.functionList.ACOS.functionParameter.number.detail",example:"0",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.ACOSH,functionType:t.FunctionType.Math,description:"formula.functionList.ACOSH.description",abstract:"formula.functionList.ACOSH.abstract",functionParameter:[{name:"formula.functionList.ACOSH.functionParameter.number.name",detail:"formula.functionList.ACOSH.functionParameter.number.detail",example:"2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.ACOT,functionType:t.FunctionType.Math,description:"formula.functionList.ACOT.description",abstract:"formula.functionList.ACOT.abstract",functionParameter:[{name:"formula.functionList.ACOT.functionParameter.number.name",detail:"formula.functionList.ACOT.functionParameter.number.detail",example:"0",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.ACOTH,functionType:t.FunctionType.Math,description:"formula.functionList.ACOTH.description",abstract:"formula.functionList.ACOTH.abstract",functionParameter:[{name:"formula.functionList.ACOTH.functionParameter.number.name",detail:"formula.functionList.ACOTH.functionParameter.number.detail",example:"6",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.AGGREGATE,functionType:t.FunctionType.Math,description:"formula.functionList.AGGREGATE.description",abstract:"formula.functionList.AGGREGATE.abstract",functionParameter:[{name:"formula.functionList.AGGREGATE.functionParameter.functionNum.name",detail:"formula.functionList.AGGREGATE.functionParameter.functionNum.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.AGGREGATE.functionParameter.options.name",detail:"formula.functionList.AGGREGATE.functionParameter.options.detail",example:"6",require:1,repeat:0},{name:"formula.functionList.AGGREGATE.functionParameter.ref1.name",detail:"formula.functionList.AGGREGATE.functionParameter.ref1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.AGGREGATE.functionParameter.ref2.name",detail:"formula.functionList.AGGREGATE.functionParameter.ref2.detail",example:"B1:B20",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_MATH.ARABIC,functionType:t.FunctionType.Math,description:"formula.functionList.ARABIC.description",abstract:"formula.functionList.ARABIC.abstract",functionParameter:[{name:"formula.functionList.ARABIC.functionParameter.text.name",detail:"formula.functionList.ARABIC.functionParameter.text.detail",example:'"LVII"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.ASIN,functionType:t.FunctionType.Math,description:"formula.functionList.ASIN.description",abstract:"formula.functionList.ASIN.abstract",functionParameter:[{name:"formula.functionList.ASIN.functionParameter.number.name",detail:"formula.functionList.ASIN.functionParameter.number.detail",example:"0",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.ASINH,functionType:t.FunctionType.Math,description:"formula.functionList.ASINH.description",abstract:"formula.functionList.ASINH.abstract",functionParameter:[{name:"formula.functionList.ASINH.functionParameter.number.name",detail:"formula.functionList.ASINH.functionParameter.number.detail",example:"10",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.ATAN,functionType:t.FunctionType.Math,description:"formula.functionList.ATAN.description",abstract:"formula.functionList.ATAN.abstract",functionParameter:[{name:"formula.functionList.ATAN.functionParameter.number.name",detail:"formula.functionList.ATAN.functionParameter.number.detail",example:"1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.ATAN2,functionType:t.FunctionType.Math,description:"formula.functionList.ATAN2.description",abstract:"formula.functionList.ATAN2.abstract",functionParameter:[{name:"formula.functionList.ATAN2.functionParameter.xNum.name",detail:"formula.functionList.ATAN2.functionParameter.xNum.detail",example:"4",require:1,repeat:0},{name:"formula.functionList.ATAN2.functionParameter.yNum.name",detail:"formula.functionList.ATAN2.functionParameter.yNum.detail",example:"3",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.ATANH,functionType:t.FunctionType.Math,description:"formula.functionList.ATANH.description",abstract:"formula.functionList.ATANH.abstract",functionParameter:[{name:"formula.functionList.ATANH.functionParameter.number.name",detail:"formula.functionList.ATANH.functionParameter.number.detail",example:"0.1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.BASE,functionType:t.FunctionType.Math,description:"formula.functionList.BASE.description",abstract:"formula.functionList.BASE.abstract",functionParameter:[{name:"formula.functionList.BASE.functionParameter.number.name",detail:"formula.functionList.BASE.functionParameter.number.detail",example:"15",require:1,repeat:0},{name:"formula.functionList.BASE.functionParameter.radix.name",detail:"formula.functionList.BASE.functionParameter.radix.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.BASE.functionParameter.minLength.name",detail:"formula.functionList.BASE.functionParameter.minLength.detail",example:"10",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.CEILING,functionType:t.FunctionType.Math,description:"formula.functionList.CEILING.description",abstract:"formula.functionList.CEILING.abstract",functionParameter:[{name:"formula.functionList.CEILING.functionParameter.number.name",detail:"formula.functionList.CEILING.functionParameter.number.detail",example:"2.5",require:1,repeat:0},{name:"formula.functionList.CEILING.functionParameter.significance.name",detail:"formula.functionList.CEILING.functionParameter.significance.detail",example:"1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.CEILING_MATH,functionType:t.FunctionType.Math,description:"formula.functionList.CEILING_MATH.description",abstract:"formula.functionList.CEILING_MATH.abstract",functionParameter:[{name:"formula.functionList.CEILING_MATH.functionParameter.number.name",detail:"formula.functionList.CEILING_MATH.functionParameter.number.detail",example:"-5.5",require:1,repeat:0},{name:"formula.functionList.CEILING_MATH.functionParameter.significance.name",detail:"formula.functionList.CEILING_MATH.functionParameter.significance.detail",example:"2",require:0,repeat:0},{name:"formula.functionList.CEILING_MATH.functionParameter.mode.name",detail:"formula.functionList.CEILING_MATH.functionParameter.mode.detail",example:"-1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.CEILING_PRECISE,functionType:t.FunctionType.Math,description:"formula.functionList.CEILING_PRECISE.description",abstract:"formula.functionList.CEILING_PRECISE.abstract",functionParameter:[{name:"formula.functionList.CEILING_PRECISE.functionParameter.number.name",detail:"formula.functionList.CEILING_PRECISE.functionParameter.number.detail",example:"4.3",require:1,repeat:0},{name:"formula.functionList.CEILING_PRECISE.functionParameter.significance.name",detail:"formula.functionList.CEILING_PRECISE.functionParameter.significance.detail",example:"2",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.COMBIN,functionType:t.FunctionType.Math,description:"formula.functionList.COMBIN.description",abstract:"formula.functionList.COMBIN.abstract",functionParameter:[{name:"formula.functionList.COMBIN.functionParameter.number.name",detail:"formula.functionList.COMBIN.functionParameter.number.detail",example:"8",require:1,repeat:0},{name:"formula.functionList.COMBIN.functionParameter.numberChosen.name",detail:"formula.functionList.COMBIN.functionParameter.numberChosen.detail",example:"2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.COMBINA,functionType:t.FunctionType.Math,description:"formula.functionList.COMBINA.description",abstract:"formula.functionList.COMBINA.abstract",functionParameter:[{name:"formula.functionList.COMBINA.functionParameter.number.name",detail:"formula.functionList.COMBINA.functionParameter.number.detail",example:"8",require:1,repeat:0},{name:"formula.functionList.COMBINA.functionParameter.numberChosen.name",detail:"formula.functionList.COMBINA.functionParameter.numberChosen.detail",example:"2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.COS,functionType:t.FunctionType.Math,description:"formula.functionList.COS.description",abstract:"formula.functionList.COS.abstract",functionParameter:[{name:"formula.functionList.COS.functionParameter.number.name",detail:"formula.functionList.COS.functionParameter.number.detail",example:"1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.COSH,functionType:t.FunctionType.Math,description:"formula.functionList.COSH.description",abstract:"formula.functionList.COSH.abstract",functionParameter:[{name:"formula.functionList.COSH.functionParameter.number.name",detail:"formula.functionList.COSH.functionParameter.number.detail",example:"4",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.COT,functionType:t.FunctionType.Math,description:"formula.functionList.COT.description",abstract:"formula.functionList.COT.abstract",functionParameter:[{name:"formula.functionList.COT.functionParameter.number.name",detail:"formula.functionList.COT.functionParameter.number.detail",example:"30",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.COTH,functionType:t.FunctionType.Math,description:"formula.functionList.COTH.description",abstract:"formula.functionList.COTH.abstract",functionParameter:[{name:"formula.functionList.COTH.functionParameter.number.name",detail:"formula.functionList.COTH.functionParameter.number.detail",example:"2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.CSC,functionType:t.FunctionType.Math,description:"formula.functionList.CSC.description",abstract:"formula.functionList.CSC.abstract",functionParameter:[{name:"formula.functionList.CSC.functionParameter.number.name",detail:"formula.functionList.CSC.functionParameter.number.detail",example:"15",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.CSCH,functionType:t.FunctionType.Math,description:"formula.functionList.CSCH.description",abstract:"formula.functionList.CSCH.abstract",functionParameter:[{name:"formula.functionList.CSCH.functionParameter.number.name",detail:"formula.functionList.CSCH.functionParameter.number.detail",example:"1.5",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.DECIMAL,functionType:t.FunctionType.Math,description:"formula.functionList.DECIMAL.description",abstract:"formula.functionList.DECIMAL.abstract",functionParameter:[{name:"formula.functionList.DECIMAL.functionParameter.text.name",detail:"formula.functionList.DECIMAL.functionParameter.text.detail",example:'"FF"',require:1,repeat:0},{name:"formula.functionList.DECIMAL.functionParameter.radix.name",detail:"formula.functionList.DECIMAL.functionParameter.radix.detail",example:"16",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.DEGREES,functionType:t.FunctionType.Math,description:"formula.functionList.DEGREES.description",abstract:"formula.functionList.DEGREES.abstract",functionParameter:[{name:"formula.functionList.DEGREES.functionParameter.angle.name",detail:"formula.functionList.DEGREES.functionParameter.angle.detail",example:"PI()",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.EVEN,functionType:t.FunctionType.Math,description:"formula.functionList.EVEN.description",abstract:"formula.functionList.EVEN.abstract",functionParameter:[{name:"formula.functionList.EVEN.functionParameter.number.name",detail:"formula.functionList.EVEN.functionParameter.number.detail",example:"1.5",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.EXP,functionType:t.FunctionType.Math,description:"formula.functionList.EXP.description",abstract:"formula.functionList.EXP.abstract",functionParameter:[{name:"formula.functionList.EXP.functionParameter.number.name",detail:"formula.functionList.EXP.functionParameter.number.detail",example:"2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.FACT,functionType:t.FunctionType.Math,description:"formula.functionList.FACT.description",abstract:"formula.functionList.FACT.abstract",functionParameter:[{name:"formula.functionList.FACT.functionParameter.number.name",detail:"formula.functionList.FACT.functionParameter.number.detail",example:"5",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.FACTDOUBLE,functionType:t.FunctionType.Math,description:"formula.functionList.FACTDOUBLE.description",abstract:"formula.functionList.FACTDOUBLE.abstract",functionParameter:[{name:"formula.functionList.FACTDOUBLE.functionParameter.number.name",detail:"formula.functionList.FACTDOUBLE.functionParameter.number.detail",example:"6",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.FLOOR,functionType:t.FunctionType.Math,description:"formula.functionList.FLOOR.description",abstract:"formula.functionList.FLOOR.abstract",functionParameter:[{name:"formula.functionList.FLOOR.functionParameter.number.name",detail:"formula.functionList.FLOOR.functionParameter.number.detail",example:"3.7",require:1,repeat:0},{name:"formula.functionList.FLOOR.functionParameter.significance.name",detail:"formula.functionList.FLOOR.functionParameter.significance.detail",example:"2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.FLOOR_MATH,functionType:t.FunctionType.Math,description:"formula.functionList.FLOOR_MATH.description",abstract:"formula.functionList.FLOOR_MATH.abstract",functionParameter:[{name:"formula.functionList.FLOOR_MATH.functionParameter.number.name",detail:"formula.functionList.FLOOR_MATH.functionParameter.number.detail",example:"-5.5",require:1,repeat:0},{name:"formula.functionList.FLOOR_MATH.functionParameter.significance.name",detail:"formula.functionList.FLOOR_MATH.functionParameter.significance.detail",example:"2",require:0,repeat:0},{name:"formula.functionList.FLOOR_MATH.functionParameter.mode.name",detail:"formula.functionList.FLOOR_MATH.functionParameter.mode.detail",example:"-1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.FLOOR_PRECISE,functionType:t.FunctionType.Math,description:"formula.functionList.FLOOR_PRECISE.description",abstract:"formula.functionList.FLOOR_PRECISE.abstract",functionParameter:[{name:"formula.functionList.FLOOR_PRECISE.functionParameter.number.name",detail:"formula.functionList.FLOOR_PRECISE.functionParameter.number.detail",example:"-3.2",require:1,repeat:0},{name:"formula.functionList.FLOOR_PRECISE.functionParameter.significance.name",detail:"formula.functionList.FLOOR_PRECISE.functionParameter.significance.detail",example:"-1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.GCD,functionType:t.FunctionType.Math,description:"formula.functionList.GCD.description",abstract:"formula.functionList.GCD.abstract",functionParameter:[{name:"formula.functionList.GCD.functionParameter.number1.name",detail:"formula.functionList.GCD.functionParameter.number1.detail",example:"5",require:1,repeat:0},{name:"formula.functionList.GCD.functionParameter.number2.name",detail:"formula.functionList.GCD.functionParameter.number2.detail",example:"2",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_MATH.INT,functionType:t.FunctionType.Math,description:"formula.functionList.INT.description",abstract:"formula.functionList.INT.abstract",functionParameter:[{name:"formula.functionList.INT.functionParameter.number.name",detail:"formula.functionList.INT.functionParameter.number.detail",example:"8.9",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.ISO_CEILING,functionType:t.FunctionType.Math,description:"formula.functionList.ISO_CEILING.description",abstract:"formula.functionList.ISO_CEILING.abstract",functionParameter:[{name:"formula.functionList.ISO_CEILING.functionParameter.number1.name",detail:"formula.functionList.ISO_CEILING.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ISO_CEILING.functionParameter.number2.name",detail:"formula.functionList.ISO_CEILING.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.LCM,functionType:t.FunctionType.Math,description:"formula.functionList.LCM.description",abstract:"formula.functionList.LCM.abstract",functionParameter:[{name:"formula.functionList.LCM.functionParameter.number1.name",detail:"formula.functionList.LCM.functionParameter.number1.detail",example:"5",require:1,repeat:0},{name:"formula.functionList.LCM.functionParameter.number2.name",detail:"formula.functionList.LCM.functionParameter.number2.detail",example:"2",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_MATH.LET,functionType:t.FunctionType.Math,description:"formula.functionList.LET.description",abstract:"formula.functionList.LET.abstract",functionParameter:[{name:"formula.functionList.LET.functionParameter.number1.name",detail:"formula.functionList.LET.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.LET.functionParameter.number2.name",detail:"formula.functionList.LET.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.LN,functionType:t.FunctionType.Math,description:"formula.functionList.LN.description",abstract:"formula.functionList.LN.abstract",functionParameter:[{name:"formula.functionList.LN.functionParameter.number.name",detail:"formula.functionList.LN.functionParameter.number.detail",example:"EXP(3)",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.LOG,functionType:t.FunctionType.Math,description:"formula.functionList.LOG.description",abstract:"formula.functionList.LOG.abstract",functionParameter:[{name:"formula.functionList.LOG.functionParameter.number.name",detail:"formula.functionList.LOG.functionParameter.number.detail",example:"8",require:1,repeat:0},{name:"formula.functionList.LOG.functionParameter.base.name",detail:"formula.functionList.LOG.functionParameter.base.detail",example:"2",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.LOG10,functionType:t.FunctionType.Math,description:"formula.functionList.LOG10.description",abstract:"formula.functionList.LOG10.abstract",functionParameter:[{name:"formula.functionList.LOG10.functionParameter.number.name",detail:"formula.functionList.LOG10.functionParameter.number.detail",example:"100000",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.MDETERM,functionType:t.FunctionType.Math,description:"formula.functionList.MDETERM.description",abstract:"formula.functionList.MDETERM.abstract",functionParameter:[{name:"formula.functionList.MDETERM.functionParameter.array.name",detail:"formula.functionList.MDETERM.functionParameter.array.detail",example:"A1:C3",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.MINVERSE,functionType:t.FunctionType.Math,description:"formula.functionList.MINVERSE.description",abstract:"formula.functionList.MINVERSE.abstract",functionParameter:[{name:"formula.functionList.MINVERSE.functionParameter.array.name",detail:"formula.functionList.MINVERSE.functionParameter.array.detail",example:"A1:C3",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.MMULT,functionType:t.FunctionType.Math,description:"formula.functionList.MMULT.description",abstract:"formula.functionList.MMULT.abstract",functionParameter:[{name:"formula.functionList.MMULT.functionParameter.array1.name",detail:"formula.functionList.MMULT.functionParameter.array1.detail",example:"A2:B3",require:1,repeat:0},{name:"formula.functionList.MMULT.functionParameter.array2.name",detail:"formula.functionList.MMULT.functionParameter.array2.detail",example:"A5:B6",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.MOD,functionType:t.FunctionType.Math,description:"formula.functionList.MOD.description",abstract:"formula.functionList.MOD.abstract",functionParameter:[{name:"formula.functionList.MOD.functionParameter.number.name",detail:"formula.functionList.MOD.functionParameter.number.detail",example:"3",require:1,repeat:0},{name:"formula.functionList.MOD.functionParameter.divisor.name",detail:"formula.functionList.MOD.functionParameter.divisor.detail",example:"2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.MROUND,functionType:t.FunctionType.Math,description:"formula.functionList.MROUND.description",abstract:"formula.functionList.MROUND.abstract",functionParameter:[{name:"formula.functionList.MROUND.functionParameter.number.name",detail:"formula.functionList.MROUND.functionParameter.number.detail",example:"10",require:1,repeat:0},{name:"formula.functionList.MROUND.functionParameter.multiple.name",detail:"formula.functionList.MROUND.functionParameter.multiple.detail",example:"3",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.MULTINOMIAL,functionType:t.FunctionType.Math,description:"formula.functionList.MULTINOMIAL.description",abstract:"formula.functionList.MULTINOMIAL.abstract",functionParameter:[{name:"formula.functionList.MULTINOMIAL.functionParameter.number1.name",detail:"formula.functionList.MULTINOMIAL.functionParameter.number1.detail",example:"5",require:1,repeat:0},{name:"formula.functionList.MULTINOMIAL.functionParameter.number2.name",detail:"formula.functionList.MULTINOMIAL.functionParameter.number2.detail",example:"2",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_MATH.MUNIT,functionType:t.FunctionType.Math,description:"formula.functionList.MUNIT.description",abstract:"formula.functionList.MUNIT.abstract",functionParameter:[{name:"formula.functionList.MUNIT.functionParameter.dimension.name",detail:"formula.functionList.MUNIT.functionParameter.dimension.detail",example:"3",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.ODD,functionType:t.FunctionType.Math,description:"formula.functionList.ODD.description",abstract:"formula.functionList.ODD.abstract",functionParameter:[{name:"formula.functionList.ODD.functionParameter.number.name",detail:"formula.functionList.ODD.functionParameter.number.detail",example:"1.5",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.PI,functionType:t.FunctionType.Math,description:"formula.functionList.PI.description",abstract:"formula.functionList.PI.abstract",functionParameter:[]},{functionName:t.FUNCTION_NAMES_MATH.POWER,functionType:t.FunctionType.Math,description:"formula.functionList.POWER.description",abstract:"formula.functionList.POWER.abstract",functionParameter:[{name:"formula.functionList.POWER.functionParameter.number.name",detail:"formula.functionList.POWER.functionParameter.number.detail",example:"5",require:1,repeat:0},{name:"formula.functionList.POWER.functionParameter.power.name",detail:"formula.functionList.POWER.functionParameter.power.detail",example:"2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.PRODUCT,functionType:t.FunctionType.Math,description:"formula.functionList.PRODUCT.description",abstract:"formula.functionList.PRODUCT.abstract",functionParameter:[{name:"formula.functionList.PRODUCT.functionParameter.number1.name",detail:"formula.functionList.PRODUCT.functionParameter.number1.detail",example:"A1",require:1,repeat:0},{name:"formula.functionList.PRODUCT.functionParameter.number2.name",detail:"formula.functionList.PRODUCT.functionParameter.number2.detail",example:"A2",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_MATH.QUOTIENT,functionType:t.FunctionType.Math,description:"formula.functionList.QUOTIENT.description",abstract:"formula.functionList.QUOTIENT.abstract",functionParameter:[{name:"formula.functionList.QUOTIENT.functionParameter.numerator.name",detail:"formula.functionList.QUOTIENT.functionParameter.numerator.detail",example:"5",require:1,repeat:0},{name:"formula.functionList.QUOTIENT.functionParameter.denominator.name",detail:"formula.functionList.QUOTIENT.functionParameter.denominator.detail",example:"2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.RADIANS,functionType:t.FunctionType.Math,description:"formula.functionList.RADIANS.description",abstract:"formula.functionList.RADIANS.abstract",functionParameter:[{name:"formula.functionList.RADIANS.functionParameter.angle.name",detail:"formula.functionList.RADIANS.functionParameter.angle.detail",example:"270",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.RAND,functionType:t.FunctionType.Math,description:"formula.functionList.RAND.description",abstract:"formula.functionList.RAND.abstract",functionParameter:[]},{functionName:t.FUNCTION_NAMES_MATH.RANDARRAY,functionType:t.FunctionType.Math,description:"formula.functionList.RANDARRAY.description",abstract:"formula.functionList.RANDARRAY.abstract",functionParameter:[{name:"formula.functionList.RANDARRAY.functionParameter.rows.name",detail:"formula.functionList.RANDARRAY.functionParameter.rows.detail",example:"5",require:0,repeat:0},{name:"formula.functionList.RANDARRAY.functionParameter.columns.name",detail:"formula.functionList.RANDARRAY.functionParameter.columns.detail",example:"3",require:0,repeat:0},{name:"formula.functionList.RANDARRAY.functionParameter.min.name",detail:"formula.functionList.RANDARRAY.functionParameter.min.detail",example:"1",require:0,repeat:0},{name:"formula.functionList.RANDARRAY.functionParameter.max.name",detail:"formula.functionList.RANDARRAY.functionParameter.max.detail",example:"100",require:0,repeat:0},{name:"formula.functionList.RANDARRAY.functionParameter.wholeNumber.name",detail:"formula.functionList.RANDARRAY.functionParameter.wholeNumber.detail",example:"TRUE",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.RANDBETWEEN,functionType:t.FunctionType.Math,description:"formula.functionList.RANDBETWEEN.description",abstract:"formula.functionList.RANDBETWEEN.abstract",functionParameter:[{name:"formula.functionList.RANDBETWEEN.functionParameter.bottom.name",detail:"formula.functionList.RANDBETWEEN.functionParameter.bottom.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.RANDBETWEEN.functionParameter.top.name",detail:"formula.functionList.RANDBETWEEN.functionParameter.top.detail",example:"100",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.ROMAN,functionType:t.FunctionType.Math,description:"formula.functionList.ROMAN.description",abstract:"formula.functionList.ROMAN.abstract",functionParameter:[{name:"formula.functionList.ROMAN.functionParameter.number.name",detail:"formula.functionList.ROMAN.functionParameter.number.detail",example:"499",require:1,repeat:0},{name:"formula.functionList.ROMAN.functionParameter.form.name",detail:"formula.functionList.ROMAN.functionParameter.form.detail",example:"0",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.ROUND,functionType:t.FunctionType.Math,description:"formula.functionList.ROUND.description",abstract:"formula.functionList.ROUND.abstract",functionParameter:[{name:"formula.functionList.ROUND.functionParameter.number.name",detail:"formula.functionList.ROUND.functionParameter.number.detail",example:"2.15",require:1,repeat:0},{name:"formula.functionList.ROUND.functionParameter.numDigits.name",detail:"formula.functionList.ROUND.functionParameter.numDigits.detail",example:"1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.ROUNDBANK,functionType:t.FunctionType.Math,description:"formula.functionList.ROUNDBANK.description",abstract:"formula.functionList.ROUNDBANK.abstract",functionParameter:[{name:"formula.functionList.ROUNDBANK.functionParameter.number.name",detail:"formula.functionList.ROUNDBANK.functionParameter.number.detail",example:"2.345",require:1,repeat:0},{name:"formula.functionList.ROUNDBANK.functionParameter.numDigits.name",detail:"formula.functionList.ROUNDBANK.functionParameter.numDigits.detail",example:"2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.ROUNDDOWN,functionType:t.FunctionType.Math,description:"formula.functionList.ROUNDDOWN.description",abstract:"formula.functionList.ROUNDDOWN.abstract",functionParameter:[{name:"formula.functionList.ROUNDDOWN.functionParameter.number.name",detail:"formula.functionList.ROUNDDOWN.functionParameter.number.detail",example:"3.2",require:1,repeat:0},{name:"formula.functionList.ROUNDDOWN.functionParameter.numDigits.name",detail:"formula.functionList.ROUNDDOWN.functionParameter.numDigits.detail",example:"0",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.ROUNDUP,functionType:t.FunctionType.Math,description:"formula.functionList.ROUNDUP.description",abstract:"formula.functionList.ROUNDUP.abstract",functionParameter:[{name:"formula.functionList.ROUNDUP.functionParameter.number.name",detail:"formula.functionList.ROUNDUP.functionParameter.number.detail",example:"3.2",require:1,repeat:0},{name:"formula.functionList.ROUNDUP.functionParameter.numDigits.name",detail:"formula.functionList.ROUNDUP.functionParameter.numDigits.detail",example:"0",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.SEC,functionType:t.FunctionType.Math,description:"formula.functionList.SEC.description",abstract:"formula.functionList.SEC.abstract",functionParameter:[{name:"formula.functionList.SEC.functionParameter.number.name",detail:"formula.functionList.SEC.functionParameter.number.detail",example:"30",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.SECH,functionType:t.FunctionType.Math,description:"formula.functionList.SECH.description",abstract:"formula.functionList.SECH.abstract",functionParameter:[{name:"formula.functionList.SECH.functionParameter.number.name",detail:"formula.functionList.SECH.functionParameter.number.detail",example:"30",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.SERIESSUM,functionType:t.FunctionType.Math,description:"formula.functionList.SERIESSUM.description",abstract:"formula.functionList.SERIESSUM.abstract",functionParameter:[{name:"formula.functionList.SERIESSUM.functionParameter.x.name",detail:"formula.functionList.SERIESSUM.functionParameter.x.detail",example:"0.785398163",require:1,repeat:0},{name:"formula.functionList.SERIESSUM.functionParameter.n.name",detail:"formula.functionList.SERIESSUM.functionParameter.n.detail",example:"0",require:1,repeat:0},{name:"formula.functionList.SERIESSUM.functionParameter.m.name",detail:"formula.functionList.SERIESSUM.functionParameter.m.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.SERIESSUM.functionParameter.coefficients.name",detail:"formula.functionList.SERIESSUM.functionParameter.coefficients.detail",example:"A1:A4",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.SEQUENCE,functionType:t.FunctionType.Math,description:"formula.functionList.SEQUENCE.description",abstract:"formula.functionList.SEQUENCE.abstract",functionParameter:[{name:"formula.functionList.SEQUENCE.functionParameter.rows.name",detail:"formula.functionList.SEQUENCE.functionParameter.rows.detail",example:"4",require:1,repeat:0},{name:"formula.functionList.SEQUENCE.functionParameter.columns.name",detail:"formula.functionList.SEQUENCE.functionParameter.columns.detail",example:"5",require:0,repeat:0},{name:"formula.functionList.SEQUENCE.functionParameter.start.name",detail:"formula.functionList.SEQUENCE.functionParameter.start.detail",example:"1",require:0,repeat:0},{name:"formula.functionList.SEQUENCE.functionParameter.step.name",detail:"formula.functionList.SEQUENCE.functionParameter.step.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.SIGN,functionType:t.FunctionType.Math,description:"formula.functionList.SIGN.description",abstract:"formula.functionList.SIGN.abstract",functionParameter:[{name:"formula.functionList.SIGN.functionParameter.number.name",detail:"formula.functionList.SIGN.functionParameter.number.detail",example:"10",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.SIN,functionType:t.FunctionType.Math,description:"formula.functionList.SIN.description",abstract:"formula.functionList.SIN.abstract",functionParameter:[{name:"formula.functionList.SIN.functionParameter.number.name",detail:"formula.functionList.SIN.functionParameter.number.detail",example:"30*PI()/180",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.SINH,functionType:t.FunctionType.Math,description:"formula.functionList.SINH.description",abstract:"formula.functionList.SINH.abstract",functionParameter:[{name:"formula.functionList.SINH.functionParameter.number.name",detail:"formula.functionList.SINH.functionParameter.number.detail",example:"0.0342*1.03",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.SQRT,functionType:t.FunctionType.Math,description:"formula.functionList.SQRT.description",abstract:"formula.functionList.SQRT.abstract",functionParameter:[{name:"formula.functionList.SQRT.functionParameter.number.name",detail:"formula.functionList.SQRT.functionParameter.number.detail",example:"16",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.SQRTPI,functionType:t.FunctionType.Math,description:"formula.functionList.SQRTPI.description",abstract:"formula.functionList.SQRTPI.abstract",functionParameter:[{name:"formula.functionList.SQRTPI.functionParameter.number.name",detail:"formula.functionList.SQRTPI.functionParameter.number.detail",example:"1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.SUBTOTAL,functionType:t.FunctionType.Math,description:"formula.functionList.SUBTOTAL.description",abstract:"formula.functionList.SUBTOTAL.abstract",functionParameter:[{name:"formula.functionList.SUBTOTAL.functionParameter.functionNum.name",detail:"formula.functionList.SUBTOTAL.functionParameter.functionNum.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.SUBTOTAL.functionParameter.ref1.name",detail:"formula.functionList.SUBTOTAL.functionParameter.ref1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SUBTOTAL.functionParameter.ref2.name",detail:"formula.functionList.SUBTOTAL.functionParameter.ref2.detail",example:"B1:B20",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_MATH.SUM,aliasFunctionName:"formula.functionList.SUM.aliasFunctionName",functionType:t.FunctionType.Math,description:"formula.functionList.SUM.description",abstract:"formula.functionList.SUM.abstract",functionParameter:[{name:"formula.functionList.SUM.functionParameter.number1.name",detail:"formula.functionList.SUM.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SUM.functionParameter.number2.name",detail:"formula.functionList.SUM.functionParameter.number2.detail",example:"B2:B10",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_MATH.SUMIF,aliasFunctionName:"formula.functionList.SUMIF.aliasFunctionName",functionType:t.FunctionType.Math,description:"formula.functionList.SUMIF.description",abstract:"formula.functionList.SUMIF.abstract",functionParameter:[{name:"formula.functionList.SUMIF.functionParameter.range.name",detail:"formula.functionList.SUMIF.functionParameter.range.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SUMIF.functionParameter.criteria.name",detail:"formula.functionList.SUMIF.functionParameter.criteria.detail",example:'">5"',require:1,repeat:0},{name:"formula.functionList.SUMIF.functionParameter.sumRange.name",detail:"formula.functionList.SUMIF.functionParameter.sumRange.detail",example:"B1:B20",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.SUMIFS,functionType:t.FunctionType.Math,description:"formula.functionList.SUMIFS.description",abstract:"formula.functionList.SUMIFS.abstract",functionParameter:[{name:"formula.functionList.SUMIFS.functionParameter.sumRange.name",detail:"formula.functionList.SUMIFS.functionParameter.sumRange.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SUMIFS.functionParameter.criteriaRange1.name",detail:"formula.functionList.SUMIFS.functionParameter.criteriaRange1.detail",example:"B1:B20",require:1,repeat:0},{name:"formula.functionList.SUMIFS.functionParameter.criteria1.name",detail:"formula.functionList.SUMIFS.functionParameter.criteria1.detail",example:'">10"',require:1,repeat:0},{name:"formula.functionList.SUMIFS.functionParameter.criteriaRange2.name",detail:"formula.functionList.SUMIFS.functionParameter.criteriaRange2.detail",example:"C1:C20",require:0,repeat:1},{name:"formula.functionList.SUMIFS.functionParameter.criteria2.name",detail:"formula.functionList.SUMIFS.functionParameter.criteria2.detail",example:'"<20"',require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_MATH.SUMPRODUCT,functionType:t.FunctionType.Math,description:"formula.functionList.SUMPRODUCT.description",abstract:"formula.functionList.SUMPRODUCT.abstract",functionParameter:[{name:"formula.functionList.SUMPRODUCT.functionParameter.array1.name",detail:"formula.functionList.SUMPRODUCT.functionParameter.array1.detail",example:"C2:C5",require:1,repeat:0},{name:"formula.functionList.SUMPRODUCT.functionParameter.array2.name",detail:"formula.functionList.SUMPRODUCT.functionParameter.array2.detail",example:"D2:D5",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_MATH.SUMSQ,functionType:t.FunctionType.Math,description:"formula.functionList.SUMSQ.description",abstract:"formula.functionList.SUMSQ.abstract",functionParameter:[{name:"formula.functionList.SUMSQ.functionParameter.number1.name",detail:"formula.functionList.SUMSQ.functionParameter.number1.detail",example:"3",require:1,repeat:0},{name:"formula.functionList.SUMSQ.functionParameter.number2.name",detail:"formula.functionList.SUMSQ.functionParameter.number2.detail",example:"4",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_MATH.SUMX2MY2,functionType:t.FunctionType.Math,description:"formula.functionList.SUMX2MY2.description",abstract:"formula.functionList.SUMX2MY2.abstract",functionParameter:[{name:"formula.functionList.SUMX2MY2.functionParameter.arrayX.name",detail:"formula.functionList.SUMX2MY2.functionParameter.arrayX.detail",example:"A2:A8",require:1,repeat:0},{name:"formula.functionList.SUMX2MY2.functionParameter.arrayY.name",detail:"formula.functionList.SUMX2MY2.functionParameter.arrayY.detail",example:"B2:B8",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.SUMX2PY2,functionType:t.FunctionType.Math,description:"formula.functionList.SUMX2PY2.description",abstract:"formula.functionList.SUMX2PY2.abstract",functionParameter:[{name:"formula.functionList.SUMX2PY2.functionParameter.arrayX.name",detail:"formula.functionList.SUMX2PY2.functionParameter.arrayX.detail",example:"A2:A8",require:1,repeat:0},{name:"formula.functionList.SUMX2PY2.functionParameter.arrayY.name",detail:"formula.functionList.SUMX2PY2.functionParameter.arrayY.detail",example:"B2:B8",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.SUMXMY2,functionType:t.FunctionType.Math,description:"formula.functionList.SUMXMY2.description",abstract:"formula.functionList.SUMXMY2.abstract",functionParameter:[{name:"formula.functionList.SUMXMY2.functionParameter.arrayX.name",detail:"formula.functionList.SUMXMY2.functionParameter.arrayX.detail",example:"A2:A8",require:1,repeat:0},{name:"formula.functionList.SUMXMY2.functionParameter.arrayY.name",detail:"formula.functionList.SUMXMY2.functionParameter.arrayY.detail",example:"B2:B8",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.TAN,functionType:t.FunctionType.Math,description:"formula.functionList.TAN.description",abstract:"formula.functionList.TAN.abstract",functionParameter:[{name:"formula.functionList.TAN.functionParameter.number.name",detail:"formula.functionList.TAN.functionParameter.number.detail",example:"1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.TANH,functionType:t.FunctionType.Math,description:"formula.functionList.TANH.description",abstract:"formula.functionList.TANH.abstract",functionParameter:[{name:"formula.functionList.TANH.functionParameter.number.name",detail:"formula.functionList.TANH.functionParameter.number.detail",example:"1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_MATH.TRUNC,functionType:t.FunctionType.Math,description:"formula.functionList.TRUNC.description",abstract:"formula.functionList.TRUNC.abstract",functionParameter:[{name:"formula.functionList.TRUNC.functionParameter.number.name",detail:"formula.functionList.TRUNC.functionParameter.number.detail",example:"0.45",require:1,repeat:0},{name:"formula.functionList.TRUNC.functionParameter.numDigits.name",detail:"formula.functionList.TRUNC.functionParameter.numDigits.detail",example:"1",require:0,repeat:0}]}],ia=[{functionName:t.FUNCTION_NAMES_STATISTICAL.AVEDEV,functionType:t.FunctionType.Statistical,description:"formula.functionList.AVEDEV.description",abstract:"formula.functionList.AVEDEV.abstract",functionParameter:[{name:"formula.functionList.AVEDEV.functionParameter.number1.name",detail:"formula.functionList.AVEDEV.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.AVEDEV.functionParameter.number2.name",detail:"formula.functionList.AVEDEV.functionParameter.number2.detail",example:"B1:B20",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.AVERAGE,aliasFunctionName:"formula.functionList.AVERAGE.aliasFunctionName",functionType:t.FunctionType.Statistical,description:"formula.functionList.AVERAGE.description",abstract:"formula.functionList.AVERAGE.abstract",functionParameter:[{name:"formula.functionList.AVERAGE.functionParameter.number1.name",detail:"formula.functionList.AVERAGE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.AVERAGE.functionParameter.number2.name",detail:"formula.functionList.AVERAGE.functionParameter.number2.detail",example:"B1:B20",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.AVERAGE_WEIGHTED,aliasFunctionName:"formula.functionList.AVERAGE_WEIGHTED.aliasFunctionName",functionType:t.FunctionType.Statistical,description:"formula.functionList.AVERAGE_WEIGHTED.description",abstract:"formula.functionList.AVERAGE_WEIGHTED.abstract",functionParameter:[{name:"formula.functionList.AVERAGE_WEIGHTED.functionParameter.values.name",detail:"formula.functionList.AVERAGE_WEIGHTED.functionParameter.values.detail",example:"10",require:1,repeat:0},{name:"formula.functionList.AVERAGE_WEIGHTED.functionParameter.weights.name",detail:"formula.functionList.AVERAGE_WEIGHTED.functionParameter.weights.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.AVERAGE_WEIGHTED.functionParameter.additionalValues.name",detail:"formula.functionList.AVERAGE_WEIGHTED.functionParameter.additionalValues.detail",example:"20",require:0,repeat:1},{name:"formula.functionList.AVERAGE_WEIGHTED.functionParameter.additionalWeights.name",detail:"formula.functionList.AVERAGE_WEIGHTED.functionParameter.additionalWeights.detail",example:"3",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.AVERAGEA,functionType:t.FunctionType.Statistical,description:"formula.functionList.AVERAGEA.description",abstract:"formula.functionList.AVERAGEA.abstract",functionParameter:[{name:"formula.functionList.AVERAGEA.functionParameter.value1.name",detail:"formula.functionList.AVERAGEA.functionParameter.value1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.AVERAGEA.functionParameter.value2.name",detail:"formula.functionList.AVERAGEA.functionParameter.value2.detail",example:"B1:B20",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.AVERAGEIF,functionType:t.FunctionType.Statistical,description:"formula.functionList.AVERAGEIF.description",abstract:"formula.functionList.AVERAGEIF.abstract",functionParameter:[{name:"formula.functionList.AVERAGEIF.functionParameter.range.name",detail:"formula.functionList.AVERAGEIF.functionParameter.range.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.AVERAGEIF.functionParameter.criteria.name",detail:"formula.functionList.AVERAGEIF.functionParameter.criteria.detail",example:'">5"',require:1,repeat:0},{name:"formula.functionList.AVERAGEIF.functionParameter.averageRange.name",detail:"formula.functionList.AVERAGEIF.functionParameter.averageRange.detail",example:"B1:B20",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.AVERAGEIFS,functionType:t.FunctionType.Statistical,description:"formula.functionList.AVERAGEIFS.description",abstract:"formula.functionList.AVERAGEIFS.abstract",functionParameter:[{name:"formula.functionList.AVERAGEIFS.functionParameter.averageRange.name",detail:"formula.functionList.AVERAGEIFS.functionParameter.averageRange.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.AVERAGEIFS.functionParameter.criteriaRange1.name",detail:"formula.functionList.AVERAGEIFS.functionParameter.criteriaRange1.detail",example:"B1:B20",require:1,repeat:0},{name:"formula.functionList.AVERAGEIFS.functionParameter.criteria1.name",detail:"formula.functionList.AVERAGEIFS.functionParameter.criteria1.detail",example:'">10"',require:1,repeat:0},{name:"formula.functionList.AVERAGEIFS.functionParameter.criteriaRange2.name",detail:"formula.functionList.AVERAGEIFS.functionParameter.criteriaRange2.detail",example:"C1:C20",require:0,repeat:1},{name:"formula.functionList.AVERAGEIFS.functionParameter.criteria2.name",detail:"formula.functionList.AVERAGEIFS.functionParameter.criteria2.detail",example:'"<20"',require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.BETA_DIST,functionType:t.FunctionType.Statistical,description:"formula.functionList.BETA_DIST.description",abstract:"formula.functionList.BETA_DIST.abstract",functionParameter:[{name:"formula.functionList.BETA_DIST.functionParameter.x.name",detail:"formula.functionList.BETA_DIST.functionParameter.x.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.BETA_DIST.functionParameter.alpha.name",detail:"formula.functionList.BETA_DIST.functionParameter.alpha.detail",example:"8",require:1,repeat:0},{name:"formula.functionList.BETA_DIST.functionParameter.beta.name",detail:"formula.functionList.BETA_DIST.functionParameter.beta.detail",example:"10",require:1,repeat:0},{name:"formula.functionList.BETA_DIST.functionParameter.cumulative.name",detail:"formula.functionList.BETA_DIST.functionParameter.cumulative.detail",example:"true",require:1,repeat:0},{name:"formula.functionList.BETA_DIST.functionParameter.A.name",detail:"formula.functionList.BETA_DIST.functionParameter.A.detail",example:"1",require:0,repeat:0},{name:"formula.functionList.BETA_DIST.functionParameter.B.name",detail:"formula.functionList.BETA_DIST.functionParameter.B.detail",example:"3",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.BETA_INV,functionType:t.FunctionType.Statistical,description:"formula.functionList.BETA_INV.description",abstract:"formula.functionList.BETA_INV.abstract",functionParameter:[{name:"formula.functionList.BETA_INV.functionParameter.probability.name",detail:"formula.functionList.BETA_INV.functionParameter.probability.detail",example:"0.685470581",require:1,repeat:0},{name:"formula.functionList.BETA_INV.functionParameter.alpha.name",detail:"formula.functionList.BETA_INV.functionParameter.alpha.detail",example:"8",require:1,repeat:0},{name:"formula.functionList.BETA_INV.functionParameter.beta.name",detail:"formula.functionList.BETA_INV.functionParameter.beta.detail",example:"10",require:1,repeat:0},{name:"formula.functionList.BETA_INV.functionParameter.A.name",detail:"formula.functionList.BETA_INV.functionParameter.A.detail",example:"1",require:0,repeat:0},{name:"formula.functionList.BETA_INV.functionParameter.B.name",detail:"formula.functionList.BETA_INV.functionParameter.B.detail",example:"3",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.BINOM_DIST,functionType:t.FunctionType.Statistical,description:"formula.functionList.BINOM_DIST.description",abstract:"formula.functionList.BINOM_DIST.abstract",functionParameter:[{name:"formula.functionList.BINOM_DIST.functionParameter.numberS.name",detail:"formula.functionList.BINOM_DIST.functionParameter.numberS.detail",example:"6",require:1,repeat:0},{name:"formula.functionList.BINOM_DIST.functionParameter.trials.name",detail:"formula.functionList.BINOM_DIST.functionParameter.trials.detail",example:"10",require:1,repeat:0},{name:"formula.functionList.BINOM_DIST.functionParameter.probabilityS.name",detail:"formula.functionList.BINOM_DIST.functionParameter.probabilityS.detail",example:"0.5",require:1,repeat:0},{name:"formula.functionList.BINOM_DIST.functionParameter.cumulative.name",detail:"formula.functionList.BINOM_DIST.functionParameter.cumulative.detail",example:"false",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.BINOM_DIST_RANGE,functionType:t.FunctionType.Statistical,description:"formula.functionList.BINOM_DIST_RANGE.description",abstract:"formula.functionList.BINOM_DIST_RANGE.abstract",functionParameter:[{name:"formula.functionList.BINOM_DIST_RANGE.functionParameter.trials.name",detail:"formula.functionList.BINOM_DIST_RANGE.functionParameter.trials.detail",example:"60",require:1,repeat:0},{name:"formula.functionList.BINOM_DIST_RANGE.functionParameter.probabilityS.name",detail:"formula.functionList.BINOM_DIST_RANGE.functionParameter.probabilityS.detail",example:"0.75",require:1,repeat:0},{name:"formula.functionList.BINOM_DIST_RANGE.functionParameter.numberS.name",detail:"formula.functionList.BINOM_DIST_RANGE.functionParameter.numberS.detail",example:"45",require:1,repeat:0},{name:"formula.functionList.BINOM_DIST_RANGE.functionParameter.numberS2.name",detail:"formula.functionList.BINOM_DIST_RANGE.functionParameter.numberS2.detail",example:"50",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.BINOM_INV,functionType:t.FunctionType.Statistical,description:"formula.functionList.BINOM_INV.description",abstract:"formula.functionList.BINOM_INV.abstract",functionParameter:[{name:"formula.functionList.BINOM_INV.functionParameter.trials.name",detail:"formula.functionList.BINOM_INV.functionParameter.trials.detail",example:"6",require:1,repeat:0},{name:"formula.functionList.BINOM_INV.functionParameter.probabilityS.name",detail:"formula.functionList.BINOM_INV.functionParameter.probabilityS.detail",example:"0.5",require:1,repeat:0},{name:"formula.functionList.BINOM_INV.functionParameter.alpha.name",detail:"formula.functionList.BINOM_INV.functionParameter.alpha.detail",example:"0.75",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.CHISQ_DIST,functionType:t.FunctionType.Statistical,description:"formula.functionList.CHISQ_DIST.description",abstract:"formula.functionList.CHISQ_DIST.abstract",functionParameter:[{name:"formula.functionList.CHISQ_DIST.functionParameter.x.name",detail:"formula.functionList.CHISQ_DIST.functionParameter.x.detail",example:"0.5",require:1,repeat:0},{name:"formula.functionList.CHISQ_DIST.functionParameter.degFreedom.name",detail:"formula.functionList.CHISQ_DIST.functionParameter.degFreedom.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.CHISQ_DIST.functionParameter.cumulative.name",detail:"formula.functionList.CHISQ_DIST.functionParameter.cumulative.detail",example:"true",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.CHISQ_DIST_RT,functionType:t.FunctionType.Statistical,description:"formula.functionList.CHISQ_DIST_RT.description",abstract:"formula.functionList.CHISQ_DIST_RT.abstract",functionParameter:[{name:"formula.functionList.CHISQ_DIST_RT.functionParameter.x.name",detail:"formula.functionList.CHISQ_DIST_RT.functionParameter.x.detail",example:"0.5",require:1,repeat:0},{name:"formula.functionList.CHISQ_DIST_RT.functionParameter.degFreedom.name",detail:"formula.functionList.CHISQ_DIST_RT.functionParameter.degFreedom.detail",example:"1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.CHISQ_INV,functionType:t.FunctionType.Statistical,description:"formula.functionList.CHISQ_INV.description",abstract:"formula.functionList.CHISQ_INV.abstract",functionParameter:[{name:"formula.functionList.CHISQ_INV.functionParameter.probability.name",detail:"formula.functionList.CHISQ_INV.functionParameter.probability.detail",example:"0.93",require:1,repeat:0},{name:"formula.functionList.CHISQ_INV.functionParameter.degFreedom.name",detail:"formula.functionList.CHISQ_INV.functionParameter.degFreedom.detail",example:"1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.CHISQ_INV_RT,functionType:t.FunctionType.Statistical,description:"formula.functionList.CHISQ_INV_RT.description",abstract:"formula.functionList.CHISQ_INV_RT.abstract",functionParameter:[{name:"formula.functionList.CHISQ_INV_RT.functionParameter.probability.name",detail:"formula.functionList.CHISQ_INV_RT.functionParameter.probability.detail",example:"0.93",require:1,repeat:0},{name:"formula.functionList.CHISQ_INV_RT.functionParameter.degFreedom.name",detail:"formula.functionList.CHISQ_INV_RT.functionParameter.degFreedom.detail",example:"1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.CHISQ_TEST,functionType:t.FunctionType.Statistical,description:"formula.functionList.CHISQ_TEST.description",abstract:"formula.functionList.CHISQ_TEST.abstract",functionParameter:[{name:"formula.functionList.CHISQ_TEST.functionParameter.actualRange.name",detail:"formula.functionList.CHISQ_TEST.functionParameter.actualRange.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.CHISQ_TEST.functionParameter.expectedRange.name",detail:"formula.functionList.CHISQ_TEST.functionParameter.expectedRange.detail",example:"B1:B4",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.CONFIDENCE_NORM,functionType:t.FunctionType.Statistical,description:"formula.functionList.CONFIDENCE_NORM.description",abstract:"formula.functionList.CONFIDENCE_NORM.abstract",functionParameter:[{name:"formula.functionList.CONFIDENCE_NORM.functionParameter.alpha.name",detail:"formula.functionList.CONFIDENCE_NORM.functionParameter.alpha.detail",example:"0.05",require:1,repeat:0},{name:"formula.functionList.CONFIDENCE_NORM.functionParameter.standardDev.name",detail:"formula.functionList.CONFIDENCE_NORM.functionParameter.standardDev.detail",example:"2.5",require:1,repeat:0},{name:"formula.functionList.CONFIDENCE_NORM.functionParameter.size.name",detail:"formula.functionList.CONFIDENCE_NORM.functionParameter.size.detail",example:"50",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.CONFIDENCE_T,functionType:t.FunctionType.Statistical,description:"formula.functionList.CONFIDENCE_T.description",abstract:"formula.functionList.CONFIDENCE_T.abstract",functionParameter:[{name:"formula.functionList.CONFIDENCE_T.functionParameter.alpha.name",detail:"formula.functionList.CONFIDENCE_T.functionParameter.alpha.detail",example:"0.05",require:1,repeat:0},{name:"formula.functionList.CONFIDENCE_T.functionParameter.standardDev.name",detail:"formula.functionList.CONFIDENCE_T.functionParameter.standardDev.detail",example:"2.5",require:1,repeat:0},{name:"formula.functionList.CONFIDENCE_T.functionParameter.size.name",detail:"formula.functionList.CONFIDENCE_T.functionParameter.size.detail",example:"50",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.CORREL,functionType:t.FunctionType.Statistical,description:"formula.functionList.CORREL.description",abstract:"formula.functionList.CORREL.abstract",functionParameter:[{name:"formula.functionList.CORREL.functionParameter.array1.name",detail:"formula.functionList.CORREL.functionParameter.array1.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.CORREL.functionParameter.array2.name",detail:"formula.functionList.CORREL.functionParameter.array2.detail",example:"B1:B4",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.COUNT,aliasFunctionName:"formula.functionList.COUNT.aliasFunctionName",functionType:t.FunctionType.Statistical,description:"formula.functionList.COUNT.description",abstract:"formula.functionList.COUNT.abstract",functionParameter:[{name:"formula.functionList.COUNT.functionParameter.value1.name",detail:"formula.functionList.COUNT.functionParameter.value1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.COUNT.functionParameter.value2.name",detail:"formula.functionList.COUNT.functionParameter.value2.detail",example:"B2:B10",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.COUNTA,aliasFunctionName:"formula.functionList.COUNTA.aliasFunctionName",functionType:t.FunctionType.Statistical,description:"formula.functionList.COUNTA.description",abstract:"formula.functionList.COUNTA.abstract",functionParameter:[{name:"formula.functionList.COUNTA.functionParameter.number1.name",detail:"formula.functionList.COUNTA.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.COUNTA.functionParameter.number2.name",detail:"formula.functionList.COUNTA.functionParameter.number2.detail",example:"B2:B10",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.COUNTBLANK,functionType:t.FunctionType.Statistical,description:"formula.functionList.COUNTBLANK.description",abstract:"formula.functionList.COUNTBLANK.abstract",functionParameter:[{name:"formula.functionList.COUNTBLANK.functionParameter.range.name",detail:"formula.functionList.COUNTBLANK.functionParameter.range.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.COUNTIF,functionType:t.FunctionType.Statistical,description:"formula.functionList.COUNTIF.description",abstract:"formula.functionList.COUNTIF.abstract",functionParameter:[{name:"formula.functionList.COUNTIF.functionParameter.range.name",detail:"formula.functionList.COUNTIF.functionParameter.range.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.COUNTIF.functionParameter.criteria.name",detail:"formula.functionList.COUNTIF.functionParameter.criteria.detail",example:'">5"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.COUNTIFS,functionType:t.FunctionType.Statistical,description:"formula.functionList.COUNTIFS.description",abstract:"formula.functionList.COUNTIFS.abstract",functionParameter:[{name:"formula.functionList.COUNTIFS.functionParameter.criteriaRange1.name",detail:"formula.functionList.COUNTIFS.functionParameter.criteriaRange1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.COUNTIFS.functionParameter.criteria1.name",detail:"formula.functionList.COUNTIFS.functionParameter.criteria1.detail",example:'">10"',require:1,repeat:0},{name:"formula.functionList.COUNTIFS.functionParameter.criteriaRange2.name",detail:"formula.functionList.COUNTIFS.functionParameter.criteriaRange2.detail",example:"B1:B20",require:0,repeat:1},{name:"formula.functionList.COUNTIFS.functionParameter.criteria2.name",detail:"formula.functionList.COUNTIFS.functionParameter.criteria2.detail",example:'"<20"',require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.COVARIANCE_P,functionType:t.FunctionType.Statistical,description:"formula.functionList.COVARIANCE_P.description",abstract:"formula.functionList.COVARIANCE_P.abstract",functionParameter:[{name:"formula.functionList.COVARIANCE_P.functionParameter.array1.name",detail:"formula.functionList.COVARIANCE_P.functionParameter.array1.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.COVARIANCE_P.functionParameter.array2.name",detail:"formula.functionList.COVARIANCE_P.functionParameter.array2.detail",example:"B1:B4",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.COVARIANCE_S,functionType:t.FunctionType.Statistical,description:"formula.functionList.COVARIANCE_S.description",abstract:"formula.functionList.COVARIANCE_S.abstract",functionParameter:[{name:"formula.functionList.COVARIANCE_S.functionParameter.array1.name",detail:"formula.functionList.COVARIANCE_S.functionParameter.array1.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.COVARIANCE_S.functionParameter.array2.name",detail:"formula.functionList.COVARIANCE_S.functionParameter.array2.detail",example:"B1:B4",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.DEVSQ,functionType:t.FunctionType.Statistical,description:"formula.functionList.DEVSQ.description",abstract:"formula.functionList.DEVSQ.abstract",functionParameter:[{name:"formula.functionList.DEVSQ.functionParameter.number1.name",detail:"formula.functionList.DEVSQ.functionParameter.number1.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.DEVSQ.functionParameter.number2.name",detail:"formula.functionList.DEVSQ.functionParameter.number2.detail",example:"2",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.EXPON_DIST,functionType:t.FunctionType.Statistical,description:"formula.functionList.EXPON_DIST.description",abstract:"formula.functionList.EXPON_DIST.abstract",functionParameter:[{name:"formula.functionList.EXPON_DIST.functionParameter.x.name",detail:"formula.functionList.EXPON_DIST.functionParameter.x.detail",example:"0.2",require:1,repeat:0},{name:"formula.functionList.EXPON_DIST.functionParameter.lambda.name",detail:"formula.functionList.EXPON_DIST.functionParameter.lambda.detail",example:"10",require:1,repeat:0},{name:"formula.functionList.EXPON_DIST.functionParameter.cumulative.name",detail:"formula.functionList.EXPON_DIST.functionParameter.cumulative.detail",example:"true",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.F_DIST,functionType:t.FunctionType.Statistical,description:"formula.functionList.F_DIST.description",abstract:"formula.functionList.F_DIST.abstract",functionParameter:[{name:"formula.functionList.F_DIST.functionParameter.x.name",detail:"formula.functionList.F_DIST.functionParameter.x.detail",example:"15.2069",require:1,repeat:0},{name:"formula.functionList.F_DIST.functionParameter.degFreedom1.name",detail:"formula.functionList.F_DIST.functionParameter.degFreedom1.detail",example:"6",require:1,repeat:0},{name:"formula.functionList.F_DIST.functionParameter.degFreedom2.name",detail:"formula.functionList.F_DIST.functionParameter.degFreedom2.detail",example:"4",require:1,repeat:0},{name:"formula.functionList.F_DIST.functionParameter.cumulative.name",detail:"formula.functionList.F_DIST.functionParameter.cumulative.detail",example:"true",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.F_DIST_RT,functionType:t.FunctionType.Statistical,description:"formula.functionList.F_DIST_RT.description",abstract:"formula.functionList.F_DIST_RT.abstract",functionParameter:[{name:"formula.functionList.F_DIST_RT.functionParameter.x.name",detail:"formula.functionList.F_DIST_RT.functionParameter.x.detail",example:"15.2069",require:1,repeat:0},{name:"formula.functionList.F_DIST_RT.functionParameter.degFreedom1.name",detail:"formula.functionList.F_DIST_RT.functionParameter.degFreedom1.detail",example:"6",require:1,repeat:0},{name:"formula.functionList.F_DIST_RT.functionParameter.degFreedom2.name",detail:"formula.functionList.F_DIST_RT.functionParameter.degFreedom2.detail",example:"4",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.F_INV,functionType:t.FunctionType.Statistical,description:"formula.functionList.F_INV.description",abstract:"formula.functionList.F_INV.abstract",functionParameter:[{name:"formula.functionList.F_INV.functionParameter.probability.name",detail:"formula.functionList.F_INV.functionParameter.probability.detail",example:"0.01",require:1,repeat:0},{name:"formula.functionList.F_INV.functionParameter.degFreedom1.name",detail:"formula.functionList.F_INV.functionParameter.degFreedom1.detail",example:"6",require:1,repeat:0},{name:"formula.functionList.F_INV.functionParameter.degFreedom2.name",detail:"formula.functionList.F_INV.functionParameter.degFreedom2.detail",example:"4",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.F_INV_RT,functionType:t.FunctionType.Statistical,description:"formula.functionList.F_INV_RT.description",abstract:"formula.functionList.F_INV_RT.abstract",functionParameter:[{name:"formula.functionList.F_INV_RT.functionParameter.probability.name",detail:"formula.functionList.F_INV_RT.functionParameter.probability.detail",example:"0.01",require:1,repeat:0},{name:"formula.functionList.F_INV_RT.functionParameter.degFreedom1.name",detail:"formula.functionList.F_INV_RT.functionParameter.degFreedom1.detail",example:"6",require:1,repeat:0},{name:"formula.functionList.F_INV_RT.functionParameter.degFreedom2.name",detail:"formula.functionList.F_INV_RT.functionParameter.degFreedom2.detail",example:"4",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.F_TEST,functionType:t.FunctionType.Statistical,description:"formula.functionList.F_TEST.description",abstract:"formula.functionList.F_TEST.abstract",functionParameter:[{name:"formula.functionList.F_TEST.functionParameter.array1.name",detail:"formula.functionList.F_TEST.functionParameter.array1.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.F_TEST.functionParameter.array2.name",detail:"formula.functionList.F_TEST.functionParameter.array2.detail",example:"B1:B4",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.FISHER,functionType:t.FunctionType.Statistical,description:"formula.functionList.FISHER.description",abstract:"formula.functionList.FISHER.abstract",functionParameter:[{name:"formula.functionList.FISHER.functionParameter.x.name",detail:"formula.functionList.FISHER.functionParameter.x.detail",example:"0.75",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.FISHERINV,functionType:t.FunctionType.Statistical,description:"formula.functionList.FISHERINV.description",abstract:"formula.functionList.FISHERINV.abstract",functionParameter:[{name:"formula.functionList.FISHERINV.functionParameter.y.name",detail:"formula.functionList.FISHERINV.functionParameter.y.detail",example:"0.75",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.FORECAST,functionType:t.FunctionType.Statistical,description:"formula.functionList.FORECAST.description",abstract:"formula.functionList.FORECAST.abstract",functionParameter:[{name:"formula.functionList.FORECAST.functionParameter.x.name",detail:"formula.functionList.FORECAST.functionParameter.x.detail",example:"30",require:1,repeat:0},{name:"formula.functionList.FORECAST.functionParameter.knownYs.name",detail:"formula.functionList.FORECAST.functionParameter.knownYs.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.FORECAST.functionParameter.knownXs.name",detail:"formula.functionList.FORECAST.functionParameter.knownXs.detail",example:"B1:B4",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.FORECAST_ETS,functionType:t.FunctionType.Statistical,description:"formula.functionList.FORECAST_ETS.description",abstract:"formula.functionList.FORECAST_ETS.abstract",functionParameter:[{name:"formula.functionList.FORECAST_ETS.functionParameter.number1.name",detail:"formula.functionList.FORECAST_ETS.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FORECAST_ETS.functionParameter.number2.name",detail:"formula.functionList.FORECAST_ETS.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.FORECAST_ETS_CONFINT,functionType:t.FunctionType.Statistical,description:"formula.functionList.FORECAST_ETS_CONFINT.description",abstract:"formula.functionList.FORECAST_ETS_CONFINT.abstract",functionParameter:[{name:"formula.functionList.FORECAST_ETS_CONFINT.functionParameter.number1.name",detail:"formula.functionList.FORECAST_ETS_CONFINT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FORECAST_ETS_CONFINT.functionParameter.number2.name",detail:"formula.functionList.FORECAST_ETS_CONFINT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.FORECAST_ETS_SEASONALITY,functionType:t.FunctionType.Statistical,description:"formula.functionList.FORECAST_ETS_SEASONALITY.description",abstract:"formula.functionList.FORECAST_ETS_SEASONALITY.abstract",functionParameter:[{name:"formula.functionList.FORECAST_ETS_SEASONALITY.functionParameter.number1.name",detail:"formula.functionList.FORECAST_ETS_SEASONALITY.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FORECAST_ETS_SEASONALITY.functionParameter.number2.name",detail:"formula.functionList.FORECAST_ETS_SEASONALITY.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.FORECAST_ETS_STAT,functionType:t.FunctionType.Statistical,description:"formula.functionList.FORECAST_ETS_STAT.description",abstract:"formula.functionList.FORECAST_ETS_STAT.abstract",functionParameter:[{name:"formula.functionList.FORECAST_ETS_STAT.functionParameter.number1.name",detail:"formula.functionList.FORECAST_ETS_STAT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FORECAST_ETS_STAT.functionParameter.number2.name",detail:"formula.functionList.FORECAST_ETS_STAT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.FORECAST_LINEAR,functionType:t.FunctionType.Statistical,description:"formula.functionList.FORECAST_LINEAR.description",abstract:"formula.functionList.FORECAST_LINEAR.abstract",functionParameter:[{name:"formula.functionList.FORECAST_LINEAR.functionParameter.x.name",detail:"formula.functionList.FORECAST_LINEAR.functionParameter.x.detail",example:"30",require:1,repeat:0},{name:"formula.functionList.FORECAST_LINEAR.functionParameter.knownYs.name",detail:"formula.functionList.FORECAST_LINEAR.functionParameter.knownYs.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.FORECAST_LINEAR.functionParameter.knownXs.name",detail:"formula.functionList.FORECAST_LINEAR.functionParameter.knownXs.detail",example:"B1:B4",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.FREQUENCY,functionType:t.FunctionType.Statistical,description:"formula.functionList.FREQUENCY.description",abstract:"formula.functionList.FREQUENCY.abstract",functionParameter:[{name:"formula.functionList.FREQUENCY.functionParameter.dataArray.name",detail:"formula.functionList.FREQUENCY.functionParameter.dataArray.detail",example:"A2:A10",require:1,repeat:0},{name:"formula.functionList.FREQUENCY.functionParameter.binsArray.name",detail:"formula.functionList.FREQUENCY.functionParameter.binsArray.detail",example:"B2:B4",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.GAMMA,functionType:t.FunctionType.Statistical,description:"formula.functionList.GAMMA.description",abstract:"formula.functionList.GAMMA.abstract",functionParameter:[{name:"formula.functionList.GAMMA.functionParameter.number.name",detail:"formula.functionList.GAMMA.functionParameter.number.detail",example:"2.5",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.GAMMA_DIST,functionType:t.FunctionType.Statistical,description:"formula.functionList.GAMMA_DIST.description",abstract:"formula.functionList.GAMMA_DIST.abstract",functionParameter:[{name:"formula.functionList.GAMMA_DIST.functionParameter.x.name",detail:"formula.functionList.GAMMA_DIST.functionParameter.x.detail",example:"10",require:1,repeat:0},{name:"formula.functionList.GAMMA_DIST.functionParameter.alpha.name",detail:"formula.functionList.GAMMA_DIST.functionParameter.alpha.detail",example:"8",require:1,repeat:0},{name:"formula.functionList.GAMMA_DIST.functionParameter.beta.name",detail:"formula.functionList.GAMMA_DIST.functionParameter.beta.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.GAMMA_DIST.functionParameter.cumulative.name",detail:"formula.functionList.GAMMA_DIST.functionParameter.cumulative.detail",example:"true",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.GAMMA_INV,functionType:t.FunctionType.Statistical,description:"formula.functionList.GAMMA_INV.description",abstract:"formula.functionList.GAMMA_INV.abstract",functionParameter:[{name:"formula.functionList.GAMMA_INV.functionParameter.probability.name",detail:"formula.functionList.GAMMA_INV.functionParameter.probability.detail",example:"0.068094",require:1,repeat:0},{name:"formula.functionList.GAMMA_INV.functionParameter.alpha.name",detail:"formula.functionList.GAMMA_INV.functionParameter.alpha.detail",example:"9",require:1,repeat:0},{name:"formula.functionList.GAMMA_INV.functionParameter.beta.name",detail:"formula.functionList.GAMMA_INV.functionParameter.beta.detail",example:"2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.GAMMALN,functionType:t.FunctionType.Statistical,description:"formula.functionList.GAMMALN.description",abstract:"formula.functionList.GAMMALN.abstract",functionParameter:[{name:"formula.functionList.GAMMALN.functionParameter.x.name",detail:"formula.functionList.GAMMALN.functionParameter.x.detail",example:"4",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.GAMMALN_PRECISE,functionType:t.FunctionType.Statistical,description:"formula.functionList.GAMMALN_PRECISE.description",abstract:"formula.functionList.GAMMALN_PRECISE.abstract",functionParameter:[{name:"formula.functionList.GAMMALN_PRECISE.functionParameter.x.name",detail:"formula.functionList.GAMMALN_PRECISE.functionParameter.x.detail",example:"4",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.GAUSS,functionType:t.FunctionType.Statistical,description:"formula.functionList.GAUSS.description",abstract:"formula.functionList.GAUSS.abstract",functionParameter:[{name:"formula.functionList.GAUSS.functionParameter.z.name",detail:"formula.functionList.GAUSS.functionParameter.z.detail",example:"2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.GEOMEAN,functionType:t.FunctionType.Statistical,description:"formula.functionList.GEOMEAN.description",abstract:"formula.functionList.GEOMEAN.abstract",functionParameter:[{name:"formula.functionList.GEOMEAN.functionParameter.number1.name",detail:"formula.functionList.GEOMEAN.functionParameter.number1.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.GEOMEAN.functionParameter.number2.name",detail:"formula.functionList.GEOMEAN.functionParameter.number2.detail",example:"2",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.GROWTH,functionType:t.FunctionType.Statistical,description:"formula.functionList.GROWTH.description",abstract:"formula.functionList.GROWTH.abstract",functionParameter:[{name:"formula.functionList.GROWTH.functionParameter.knownYs.name",detail:"formula.functionList.GROWTH.functionParameter.knownYs.detail",example:"B2:B7",require:1,repeat:0},{name:"formula.functionList.GROWTH.functionParameter.knownXs.name",detail:"formula.functionList.GROWTH.functionParameter.knownXs.detail",example:"A2:A7",require:0,repeat:0},{name:"formula.functionList.GROWTH.functionParameter.newXs.name",detail:"formula.functionList.GROWTH.functionParameter.newXs.detail",example:"A9:A10",require:0,repeat:0},{name:"formula.functionList.GROWTH.functionParameter.constb.name",detail:"formula.functionList.GROWTH.functionParameter.constb.detail",example:"true",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.HARMEAN,functionType:t.FunctionType.Statistical,description:"formula.functionList.HARMEAN.description",abstract:"formula.functionList.HARMEAN.abstract",functionParameter:[{name:"formula.functionList.HARMEAN.functionParameter.number1.name",detail:"formula.functionList.HARMEAN.functionParameter.number1.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.HARMEAN.functionParameter.number2.name",detail:"formula.functionList.HARMEAN.functionParameter.number2.detail",example:"2",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.HYPGEOM_DIST,functionType:t.FunctionType.Statistical,description:"formula.functionList.HYPGEOM_DIST.description",abstract:"formula.functionList.HYPGEOM_DIST.abstract",functionParameter:[{name:"formula.functionList.HYPGEOM_DIST.functionParameter.sampleS.name",detail:"formula.functionList.HYPGEOM_DIST.functionParameter.sampleS.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.HYPGEOM_DIST.functionParameter.numberSample.name",detail:"formula.functionList.HYPGEOM_DIST.functionParameter.numberSample.detail",example:"4",require:1,repeat:0},{name:"formula.functionList.HYPGEOM_DIST.functionParameter.populationS.name",detail:"formula.functionList.HYPGEOM_DIST.functionParameter.populationS.detail",example:"8",require:1,repeat:0},{name:"formula.functionList.HYPGEOM_DIST.functionParameter.numberPop.name",detail:"formula.functionList.HYPGEOM_DIST.functionParameter.numberPop.detail",example:"20",require:1,repeat:0},{name:"formula.functionList.HYPGEOM_DIST.functionParameter.cumulative.name",detail:"formula.functionList.HYPGEOM_DIST.functionParameter.cumulative.detail",example:"true",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.INTERCEPT,functionType:t.FunctionType.Statistical,description:"formula.functionList.INTERCEPT.description",abstract:"formula.functionList.INTERCEPT.abstract",functionParameter:[{name:"formula.functionList.INTERCEPT.functionParameter.knownYs.name",detail:"formula.functionList.INTERCEPT.functionParameter.knownYs.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.INTERCEPT.functionParameter.knownXs.name",detail:"formula.functionList.INTERCEPT.functionParameter.knownXs.detail",example:"B1:B4",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.KURT,functionType:t.FunctionType.Statistical,description:"formula.functionList.KURT.description",abstract:"formula.functionList.KURT.abstract",functionParameter:[{name:"formula.functionList.KURT.functionParameter.number1.name",detail:"formula.functionList.KURT.functionParameter.number1.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.KURT.functionParameter.number2.name",detail:"formula.functionList.KURT.functionParameter.number2.detail",example:"4",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.LARGE,functionType:t.FunctionType.Statistical,description:"formula.functionList.LARGE.description",abstract:"formula.functionList.LARGE.abstract",functionParameter:[{name:"formula.functionList.LARGE.functionParameter.array.name",detail:"formula.functionList.LARGE.functionParameter.array.detail",example:"A2:B6",require:1,repeat:0},{name:"formula.functionList.LARGE.functionParameter.k.name",detail:"formula.functionList.LARGE.functionParameter.k.detail",example:"3",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.LINEST,functionType:t.FunctionType.Statistical,description:"formula.functionList.LINEST.description",abstract:"formula.functionList.LINEST.abstract",functionParameter:[{name:"formula.functionList.LINEST.functionParameter.knownYs.name",detail:"formula.functionList.LINEST.functionParameter.knownYs.detail",example:"B2:B7",require:1,repeat:0},{name:"formula.functionList.LINEST.functionParameter.knownXs.name",detail:"formula.functionList.LINEST.functionParameter.knownXs.detail",example:"A2:A7",require:0,repeat:0},{name:"formula.functionList.LINEST.functionParameter.constb.name",detail:"formula.functionList.LINEST.functionParameter.constb.detail",example:"true",require:0,repeat:0},{name:"formula.functionList.LINEST.functionParameter.stats.name",detail:"formula.functionList.LINEST.functionParameter.stats.detail",example:"true",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.LOGEST,functionType:t.FunctionType.Statistical,description:"formula.functionList.LOGEST.description",abstract:"formula.functionList.LOGEST.abstract",functionParameter:[{name:"formula.functionList.LOGEST.functionParameter.knownYs.name",detail:"formula.functionList.LOGEST.functionParameter.knownYs.detail",example:"B2:B7",require:1,repeat:0},{name:"formula.functionList.LOGEST.functionParameter.knownXs.name",detail:"formula.functionList.LOGEST.functionParameter.knownXs.detail",example:"A2:A7",require:0,repeat:0},{name:"formula.functionList.LOGEST.functionParameter.constb.name",detail:"formula.functionList.LOGEST.functionParameter.constb.detail",example:"true",require:0,repeat:0},{name:"formula.functionList.LOGEST.functionParameter.stats.name",detail:"formula.functionList.LOGEST.functionParameter.stats.detail",example:"true",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.LOGNORM_DIST,functionType:t.FunctionType.Statistical,description:"formula.functionList.LOGNORM_DIST.description",abstract:"formula.functionList.LOGNORM_DIST.abstract",functionParameter:[{name:"formula.functionList.LOGNORM_DIST.functionParameter.x.name",detail:"formula.functionList.LOGNORM_DIST.functionParameter.x.detail",example:"42",require:1,repeat:0},{name:"formula.functionList.LOGNORM_DIST.functionParameter.mean.name",detail:"formula.functionList.LOGNORM_DIST.functionParameter.mean.detail",example:"40",require:1,repeat:0},{name:"formula.functionList.LOGNORM_DIST.functionParameter.standardDev.name",detail:"formula.functionList.LOGNORM_DIST.functionParameter.standardDev.detail",example:"1.5",require:1,repeat:0},{name:"formula.functionList.LOGNORM_DIST.functionParameter.cumulative.name",detail:"formula.functionList.LOGNORM_DIST.functionParameter.cumulative.detail",example:"true",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.LOGNORM_INV,functionType:t.FunctionType.Statistical,description:"formula.functionList.LOGNORM_INV.description",abstract:"formula.functionList.LOGNORM_INV.abstract",functionParameter:[{name:"formula.functionList.LOGNORM_INV.functionParameter.probability.name",detail:"formula.functionList.LOGNORM_INV.functionParameter.probability.detail",example:"0.908789",require:1,repeat:0},{name:"formula.functionList.LOGNORM_INV.functionParameter.mean.name",detail:"formula.functionList.LOGNORM_INV.functionParameter.mean.detail",example:"40",require:1,repeat:0},{name:"formula.functionList.LOGNORM_INV.functionParameter.standardDev.name",detail:"formula.functionList.LOGNORM_INV.functionParameter.standardDev.detail",example:"1.5",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.MARGINOFERROR,aliasFunctionName:"formula.functionList.MARGINOFERROR.aliasFunctionName",functionType:t.FunctionType.Statistical,description:"formula.functionList.MARGINOFERROR.description",abstract:"formula.functionList.MARGINOFERROR.abstract",functionParameter:[{name:"formula.functionList.MARGINOFERROR.functionParameter.range.name",detail:"formula.functionList.MARGINOFERROR.functionParameter.range.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.MARGINOFERROR.functionParameter.confidence.name",detail:"formula.functionList.MARGINOFERROR.functionParameter.confidence.detail",example:"0.95",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.MAX,aliasFunctionName:"formula.functionList.MAX.aliasFunctionName",functionType:t.FunctionType.Statistical,description:"formula.functionList.MAX.description",abstract:"formula.functionList.MAX.abstract",functionParameter:[{name:"formula.functionList.MAX.functionParameter.number1.name",detail:"formula.functionList.MAX.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MAX.functionParameter.number2.name",detail:"formula.functionList.MAX.functionParameter.number2.detail",example:"B2:B10",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.MAXA,functionType:t.FunctionType.Statistical,description:"formula.functionList.MAXA.description",abstract:"formula.functionList.MAXA.abstract",functionParameter:[{name:"formula.functionList.MAXA.functionParameter.value1.name",detail:"formula.functionList.MAXA.functionParameter.value1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MAXA.functionParameter.value2.name",detail:"formula.functionList.MAXA.functionParameter.value2.detail",example:"B1:B20",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.MAXIFS,functionType:t.FunctionType.Statistical,description:"formula.functionList.MAXIFS.description",abstract:"formula.functionList.MAXIFS.abstract",functionParameter:[{name:"formula.functionList.MAXIFS.functionParameter.maxRange.name",detail:"formula.functionList.MAXIFS.functionParameter.maxRange.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MAXIFS.functionParameter.criteriaRange1.name",detail:"formula.functionList.MAXIFS.functionParameter.criteriaRange1.detail",example:"B1:B20",require:1,repeat:0},{name:"formula.functionList.MAXIFS.functionParameter.criteria1.name",detail:"formula.functionList.MAXIFS.functionParameter.criteria1.detail",example:'">10"',require:1,repeat:0},{name:"formula.functionList.MAXIFS.functionParameter.criteriaRange2.name",detail:"formula.functionList.MAXIFS.functionParameter.criteriaRange2.detail",example:"C1:C20",require:0,repeat:1},{name:"formula.functionList.MAXIFS.functionParameter.criteria2.name",detail:"formula.functionList.MAXIFS.functionParameter.criteria2.detail",example:'"<20"',require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.MEDIAN,functionType:t.FunctionType.Statistical,description:"formula.functionList.MEDIAN.description",abstract:"formula.functionList.MEDIAN.abstract",functionParameter:[{name:"formula.functionList.MEDIAN.functionParameter.number1.name",detail:"formula.functionList.MEDIAN.functionParameter.number1.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.MEDIAN.functionParameter.number2.name",detail:"formula.functionList.MEDIAN.functionParameter.number2.detail",example:"2",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.MIN,aliasFunctionName:"formula.functionList.MIN.aliasFunctionName",functionType:t.FunctionType.Statistical,description:"formula.functionList.MIN.description",abstract:"formula.functionList.MIN.abstract",functionParameter:[{name:"formula.functionList.MIN.functionParameter.number1.name",detail:"formula.functionList.MIN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MIN.functionParameter.number2.name",detail:"formula.functionList.MIN.functionParameter.number2.detail",example:"B2:B10",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.MINA,functionType:t.FunctionType.Statistical,description:"formula.functionList.MINA.description",abstract:"formula.functionList.MINA.abstract",functionParameter:[{name:"formula.functionList.MINA.functionParameter.value1.name",detail:"formula.functionList.MINA.functionParameter.value1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MINA.functionParameter.value2.name",detail:"formula.functionList.MINA.functionParameter.value2.detail",example:"B1:B20",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.MINIFS,functionType:t.FunctionType.Statistical,description:"formula.functionList.MINIFS.description",abstract:"formula.functionList.MINIFS.abstract",functionParameter:[{name:"formula.functionList.MINIFS.functionParameter.minRange.name",detail:"formula.functionList.MINIFS.functionParameter.minRange.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MINIFS.functionParameter.criteriaRange1.name",detail:"formula.functionList.MINIFS.functionParameter.criteriaRange1.detail",example:"B1:B20",require:1,repeat:0},{name:"formula.functionList.MINIFS.functionParameter.criteria1.name",detail:"formula.functionList.MINIFS.functionParameter.criteria1.detail",example:'">10"',require:1,repeat:0},{name:"formula.functionList.MINIFS.functionParameter.criteriaRange2.name",detail:"formula.functionList.MINIFS.functionParameter.criteriaRange2.detail",example:"C1:C20",require:0,repeat:1},{name:"formula.functionList.MINIFS.functionParameter.criteria2.name",detail:"formula.functionList.MINIFS.functionParameter.criteria2.detail",example:'"<20"',require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.MODE_MULT,functionType:t.FunctionType.Statistical,description:"formula.functionList.MODE_MULT.description",abstract:"formula.functionList.MODE_MULT.abstract",functionParameter:[{name:"formula.functionList.MODE_MULT.functionParameter.number1.name",detail:"formula.functionList.MODE_MULT.functionParameter.number1.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.MODE_MULT.functionParameter.number2.name",detail:"formula.functionList.MODE_MULT.functionParameter.number2.detail",example:"2",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.MODE_SNGL,functionType:t.FunctionType.Statistical,description:"formula.functionList.MODE_SNGL.description",abstract:"formula.functionList.MODE_SNGL.abstract",functionParameter:[{name:"formula.functionList.MODE_SNGL.functionParameter.number1.name",detail:"formula.functionList.MODE_SNGL.functionParameter.number1.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.MODE_SNGL.functionParameter.number2.name",detail:"formula.functionList.MODE_SNGL.functionParameter.number2.detail",example:"2",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.NEGBINOM_DIST,functionType:t.FunctionType.Statistical,description:"formula.functionList.NEGBINOM_DIST.description",abstract:"formula.functionList.NEGBINOM_DIST.abstract",functionParameter:[{name:"formula.functionList.NEGBINOM_DIST.functionParameter.numberF.name",detail:"formula.functionList.NEGBINOM_DIST.functionParameter.numberF.detail",example:"10",require:1,repeat:0},{name:"formula.functionList.NEGBINOM_DIST.functionParameter.numberS.name",detail:"formula.functionList.NEGBINOM_DIST.functionParameter.numberS.detail",example:"5",require:1,repeat:0},{name:"formula.functionList.NEGBINOM_DIST.functionParameter.probabilityS.name",detail:"formula.functionList.NEGBINOM_DIST.functionParameter.probabilityS.detail",example:"0.25",require:1,repeat:0},{name:"formula.functionList.NEGBINOM_DIST.functionParameter.cumulative.name",detail:"formula.functionList.NEGBINOM_DIST.functionParameter.cumulative.detail",example:"true",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.NORM_DIST,functionType:t.FunctionType.Statistical,description:"formula.functionList.NORM_DIST.description",abstract:"formula.functionList.NORM_DIST.abstract",functionParameter:[{name:"formula.functionList.NORM_DIST.functionParameter.x.name",detail:"formula.functionList.NORM_DIST.functionParameter.x.detail",example:"42",require:1,repeat:0},{name:"formula.functionList.NORM_DIST.functionParameter.mean.name",detail:"formula.functionList.NORM_DIST.functionParameter.mean.detail",example:"40",require:1,repeat:0},{name:"formula.functionList.NORM_DIST.functionParameter.standardDev.name",detail:"formula.functionList.NORM_DIST.functionParameter.standardDev.detail",example:"1.5",require:1,repeat:0},{name:"formula.functionList.NORM_DIST.functionParameter.cumulative.name",detail:"formula.functionList.NORM_DIST.functionParameter.cumulative.detail",example:"true",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.NORM_INV,functionType:t.FunctionType.Statistical,description:"formula.functionList.NORM_INV.description",abstract:"formula.functionList.NORM_INV.abstract",functionParameter:[{name:"formula.functionList.NORM_INV.functionParameter.probability.name",detail:"formula.functionList.NORM_INV.functionParameter.probability.detail",example:"0.908789",require:1,repeat:0},{name:"formula.functionList.NORM_INV.functionParameter.mean.name",detail:"formula.functionList.NORM_INV.functionParameter.mean.detail",example:"40",require:1,repeat:0},{name:"formula.functionList.NORM_INV.functionParameter.standardDev.name",detail:"formula.functionList.NORM_INV.functionParameter.standardDev.detail",example:"1.5",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.NORM_S_DIST,functionType:t.FunctionType.Statistical,description:"formula.functionList.NORM_S_DIST.description",abstract:"formula.functionList.NORM_S_DIST.abstract",functionParameter:[{name:"formula.functionList.NORM_S_DIST.functionParameter.z.name",detail:"formula.functionList.NORM_S_DIST.functionParameter.z.detail",example:"1.333333",require:1,repeat:0},{name:"formula.functionList.NORM_S_DIST.functionParameter.cumulative.name",detail:"formula.functionList.NORM_S_DIST.functionParameter.cumulative.detail",example:"true",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.NORM_S_INV,functionType:t.FunctionType.Statistical,description:"formula.functionList.NORM_S_INV.description",abstract:"formula.functionList.NORM_S_INV.abstract",functionParameter:[{name:"formula.functionList.NORM_S_INV.functionParameter.probability.name",detail:"formula.functionList.NORM_S_INV.functionParameter.probability.detail",example:"0.908789",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.PEARSON,functionType:t.FunctionType.Statistical,description:"formula.functionList.PEARSON.description",abstract:"formula.functionList.PEARSON.abstract",functionParameter:[{name:"formula.functionList.PEARSON.functionParameter.array1.name",detail:"formula.functionList.PEARSON.functionParameter.array1.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.PEARSON.functionParameter.array2.name",detail:"formula.functionList.PEARSON.functionParameter.array2.detail",example:"B1:B4",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.PERCENTILE_EXC,functionType:t.FunctionType.Statistical,description:"formula.functionList.PERCENTILE_EXC.description",abstract:"formula.functionList.PERCENTILE_EXC.abstract",functionParameter:[{name:"formula.functionList.PERCENTILE_EXC.functionParameter.array.name",detail:"formula.functionList.PERCENTILE_EXC.functionParameter.array.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.PERCENTILE_EXC.functionParameter.k.name",detail:"formula.functionList.PERCENTILE_EXC.functionParameter.k.detail",example:"0.3",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.PERCENTILE_INC,functionType:t.FunctionType.Statistical,description:"formula.functionList.PERCENTILE_INC.description",abstract:"formula.functionList.PERCENTILE_INC.abstract",functionParameter:[{name:"formula.functionList.PERCENTILE_INC.functionParameter.array.name",detail:"formula.functionList.PERCENTILE_INC.functionParameter.array.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.PERCENTILE_INC.functionParameter.k.name",detail:"formula.functionList.PERCENTILE_INC.functionParameter.k.detail",example:"0.3",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.PERCENTRANK_EXC,functionType:t.FunctionType.Statistical,description:"formula.functionList.PERCENTRANK_EXC.description",abstract:"formula.functionList.PERCENTRANK_EXC.abstract",functionParameter:[{name:"formula.functionList.PERCENTRANK_EXC.functionParameter.array.name",detail:"formula.functionList.PERCENTRANK_EXC.functionParameter.array.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.PERCENTRANK_EXC.functionParameter.x.name",detail:"formula.functionList.PERCENTRANK_EXC.functionParameter.x.detail",example:"1.5",require:1,repeat:0},{name:"formula.functionList.PERCENTRANK_EXC.functionParameter.significance.name",detail:"formula.functionList.PERCENTRANK_EXC.functionParameter.significance.detail",example:"3",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.PERCENTRANK_INC,functionType:t.FunctionType.Statistical,description:"formula.functionList.PERCENTRANK_INC.description",abstract:"formula.functionList.PERCENTRANK_INC.abstract",functionParameter:[{name:"formula.functionList.PERCENTRANK_INC.functionParameter.array.name",detail:"formula.functionList.PERCENTRANK_INC.functionParameter.array.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.PERCENTRANK_INC.functionParameter.x.name",detail:"formula.functionList.PERCENTRANK_INC.functionParameter.x.detail",example:"1.5",require:1,repeat:0},{name:"formula.functionList.PERCENTRANK_INC.functionParameter.significance.name",detail:"formula.functionList.PERCENTRANK_INC.functionParameter.significance.detail",example:"3",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.PERMUT,functionType:t.FunctionType.Statistical,description:"formula.functionList.PERMUT.description",abstract:"formula.functionList.PERMUT.abstract",functionParameter:[{name:"formula.functionList.PERMUT.functionParameter.number.name",detail:"formula.functionList.PERMUT.functionParameter.number.detail",example:"8",require:1,repeat:0},{name:"formula.functionList.PERMUT.functionParameter.numberChosen.name",detail:"formula.functionList.PERMUT.functionParameter.numberChosen.detail",example:"2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.PERMUTATIONA,functionType:t.FunctionType.Statistical,description:"formula.functionList.PERMUTATIONA.description",abstract:"formula.functionList.PERMUTATIONA.abstract",functionParameter:[{name:"formula.functionList.PERMUT.functionParameter.number.name",detail:"formula.functionList.PERMUT.functionParameter.number.detail",example:"8",require:1,repeat:0},{name:"formula.functionList.PERMUT.functionParameter.numberChosen.name",detail:"formula.functionList.PERMUT.functionParameter.numberChosen.detail",example:"2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.PHI,functionType:t.FunctionType.Statistical,description:"formula.functionList.PHI.description",abstract:"formula.functionList.PHI.abstract",functionParameter:[{name:"formula.functionList.PHI.functionParameter.x.name",detail:"formula.functionList.PHI.functionParameter.x.detail",example:"0.75",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.POISSON_DIST,functionType:t.FunctionType.Statistical,description:"formula.functionList.POISSON_DIST.description",abstract:"formula.functionList.POISSON_DIST.abstract",functionParameter:[{name:"formula.functionList.POISSON_DIST.functionParameter.x.name",detail:"formula.functionList.POISSON_DIST.functionParameter.x.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.POISSON_DIST.functionParameter.mean.name",detail:"formula.functionList.POISSON_DIST.functionParameter.mean.detail",example:"5",require:1,repeat:0},{name:"formula.functionList.POISSON_DIST.functionParameter.cumulative.name",detail:"formula.functionList.POISSON_DIST.functionParameter.cumulative.detail",example:"true",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.PROB,functionType:t.FunctionType.Statistical,description:"formula.functionList.PROB.description",abstract:"formula.functionList.PROB.abstract",functionParameter:[{name:"formula.functionList.PROB.functionParameter.xRange.name",detail:"formula.functionList.PROB.functionParameter.xRange.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.PROB.functionParameter.probRange.name",detail:"formula.functionList.PROB.functionParameter.probRange.detail",example:"B1:B4",require:1,repeat:0},{name:"formula.functionList.PROB.functionParameter.lowerLimit.name",detail:"formula.functionList.PROB.functionParameter.lowerLimit.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.PROB.functionParameter.upperLimit.name",detail:"formula.functionList.PROB.functionParameter.upperLimit.detail",example:"3",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.QUARTILE_EXC,functionType:t.FunctionType.Statistical,description:"formula.functionList.QUARTILE_EXC.description",abstract:"formula.functionList.QUARTILE_EXC.abstract",functionParameter:[{name:"formula.functionList.QUARTILE_EXC.functionParameter.array.name",detail:"formula.functionList.QUARTILE_EXC.functionParameter.array.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.QUARTILE_EXC.functionParameter.quart.name",detail:"formula.functionList.QUARTILE_EXC.functionParameter.quart.detail",example:"1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.QUARTILE_INC,functionType:t.FunctionType.Statistical,description:"formula.functionList.QUARTILE_INC.description",abstract:"formula.functionList.QUARTILE_INC.abstract",functionParameter:[{name:"formula.functionList.QUARTILE_INC.functionParameter.array.name",detail:"formula.functionList.QUARTILE_INC.functionParameter.array.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.QUARTILE_INC.functionParameter.quart.name",detail:"formula.functionList.QUARTILE_INC.functionParameter.quart.detail",example:"1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.RANK_AVG,functionType:t.FunctionType.Statistical,description:"formula.functionList.RANK_AVG.description",abstract:"formula.functionList.RANK_AVG.abstract",functionParameter:[{name:"formula.functionList.RANK_AVG.functionParameter.number.name",detail:"formula.functionList.RANK_AVG.functionParameter.number.detail",example:"A3",require:1,repeat:0},{name:"formula.functionList.RANK_AVG.functionParameter.ref.name",detail:"formula.functionList.RANK_AVG.functionParameter.ref.detail",example:"A2:A6",require:1,repeat:0},{name:"formula.functionList.RANK_AVG.functionParameter.order.name",detail:"formula.functionList.RANK_AVG.functionParameter.order.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.RANK_EQ,functionType:t.FunctionType.Statistical,description:"formula.functionList.RANK_EQ.description",abstract:"formula.functionList.RANK_EQ.abstract",functionParameter:[{name:"formula.functionList.RANK_EQ.functionParameter.number.name",detail:"formula.functionList.RANK_EQ.functionParameter.number.detail",example:"A3",require:1,repeat:0},{name:"formula.functionList.RANK_EQ.functionParameter.ref.name",detail:"formula.functionList.RANK_EQ.functionParameter.ref.detail",example:"A2:A6",require:1,repeat:0},{name:"formula.functionList.RANK_EQ.functionParameter.order.name",detail:"formula.functionList.RANK_EQ.functionParameter.order.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.RSQ,functionType:t.FunctionType.Statistical,description:"formula.functionList.RSQ.description",abstract:"formula.functionList.RSQ.abstract",functionParameter:[{name:"formula.functionList.RSQ.functionParameter.array1.name",detail:"formula.functionList.RSQ.functionParameter.array1.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.RSQ.functionParameter.array2.name",detail:"formula.functionList.RSQ.functionParameter.array2.detail",example:"B1:B4",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.SKEW,functionType:t.FunctionType.Statistical,description:"formula.functionList.SKEW.description",abstract:"formula.functionList.SKEW.abstract",functionParameter:[{name:"formula.functionList.SKEW.functionParameter.number1.name",detail:"formula.functionList.SKEW.functionParameter.number1.detail",example:"A1:C3",require:1,repeat:0},{name:"formula.functionList.SKEW.functionParameter.number2.name",detail:"formula.functionList.SKEW.functionParameter.number2.detail",example:"4",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.SKEW_P,functionType:t.FunctionType.Statistical,description:"formula.functionList.SKEW_P.description",abstract:"formula.functionList.SKEW_P.abstract",functionParameter:[{name:"formula.functionList.SKEW_P.functionParameter.number1.name",detail:"formula.functionList.SKEW_P.functionParameter.number1.detail",example:"A1:C3",require:1,repeat:0},{name:"formula.functionList.SKEW_P.functionParameter.number2.name",detail:"formula.functionList.SKEW_P.functionParameter.number2.detail",example:"4",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.SLOPE,functionType:t.FunctionType.Statistical,description:"formula.functionList.SLOPE.description",abstract:"formula.functionList.SLOPE.abstract",functionParameter:[{name:"formula.functionList.SLOPE.functionParameter.knownYs.name",detail:"formula.functionList.SLOPE.functionParameter.knownYs.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.SLOPE.functionParameter.knownXs.name",detail:"formula.functionList.SLOPE.functionParameter.knownXs.detail",example:"B1:B4",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.SMALL,functionType:t.FunctionType.Statistical,description:"formula.functionList.SMALL.description",abstract:"formula.functionList.SMALL.abstract",functionParameter:[{name:"formula.functionList.SMALL.functionParameter.array.name",detail:"formula.functionList.SMALL.functionParameter.array.detail",example:"A2:B6",require:1,repeat:0},{name:"formula.functionList.SMALL.functionParameter.k.name",detail:"formula.functionList.SMALL.functionParameter.k.detail",example:"3",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.STANDARDIZE,functionType:t.FunctionType.Statistical,description:"formula.functionList.STANDARDIZE.description",abstract:"formula.functionList.STANDARDIZE.abstract",functionParameter:[{name:"formula.functionList.STANDARDIZE.functionParameter.x.name",detail:"formula.functionList.STANDARDIZE.functionParameter.x.detail",example:"42",require:1,repeat:0},{name:"formula.functionList.STANDARDIZE.functionParameter.mean.name",detail:"formula.functionList.STANDARDIZE.functionParameter.mean.detail",example:"40",require:1,repeat:0},{name:"formula.functionList.STANDARDIZE.functionParameter.standardDev.name",detail:"formula.functionList.STANDARDIZE.functionParameter.standardDev.detail",example:"1.5",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.STDEV_P,functionType:t.FunctionType.Statistical,description:"formula.functionList.STDEV_P.description",abstract:"formula.functionList.STDEV_P.abstract",functionParameter:[{name:"formula.functionList.STDEV_P.functionParameter.number1.name",detail:"formula.functionList.STDEV_P.functionParameter.number1.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.STDEV_P.functionParameter.number2.name",detail:"formula.functionList.STDEV_P.functionParameter.number2.detail",example:"2",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.STDEV_S,functionType:t.FunctionType.Statistical,description:"formula.functionList.STDEV_S.description",abstract:"formula.functionList.STDEV_S.abstract",functionParameter:[{name:"formula.functionList.STDEV_S.functionParameter.number1.name",detail:"formula.functionList.STDEV_S.functionParameter.number1.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.STDEV_S.functionParameter.number2.name",detail:"formula.functionList.STDEV_S.functionParameter.number2.detail",example:"2",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.STDEVA,functionType:t.FunctionType.Statistical,description:"formula.functionList.STDEVA.description",abstract:"formula.functionList.STDEVA.abstract",functionParameter:[{name:"formula.functionList.STDEVA.functionParameter.value1.name",detail:"formula.functionList.STDEVA.functionParameter.value1.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.STDEVA.functionParameter.value2.name",detail:"formula.functionList.STDEVA.functionParameter.value2.detail",example:"2",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.STDEVPA,functionType:t.FunctionType.Statistical,description:"formula.functionList.STDEVPA.description",abstract:"formula.functionList.STDEVPA.abstract",functionParameter:[{name:"formula.functionList.STDEVPA.functionParameter.value1.name",detail:"formula.functionList.STDEVPA.functionParameter.value1.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.STDEVPA.functionParameter.value2.name",detail:"formula.functionList.STDEVPA.functionParameter.value2.detail",example:"2",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.STEYX,functionType:t.FunctionType.Statistical,description:"formula.functionList.STEYX.description",abstract:"formula.functionList.STEYX.abstract",functionParameter:[{name:"formula.functionList.STEYX.functionParameter.knownYs.name",detail:"formula.functionList.STEYX.functionParameter.knownYs.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.STEYX.functionParameter.knownXs.name",detail:"formula.functionList.STEYX.functionParameter.knownXs.detail",example:"B1:B4",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.T_DIST,functionType:t.FunctionType.Statistical,description:"formula.functionList.T_DIST.description",abstract:"formula.functionList.T_DIST.abstract",functionParameter:[{name:"formula.functionList.T_DIST.functionParameter.x.name",detail:"formula.functionList.T_DIST.functionParameter.x.detail",example:"8",require:1,repeat:0},{name:"formula.functionList.T_DIST.functionParameter.degFreedom.name",detail:"formula.functionList.T_DIST.functionParameter.degFreedom.detail",example:"3",require:1,repeat:0},{name:"formula.functionList.T_DIST.functionParameter.cumulative.name",detail:"formula.functionList.T_DIST.functionParameter.cumulative.detail",example:"true",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.T_DIST_2T,functionType:t.FunctionType.Statistical,description:"formula.functionList.T_DIST_2T.description",abstract:"formula.functionList.T_DIST_2T.abstract",functionParameter:[{name:"formula.functionList.T_DIST_2T.functionParameter.x.name",detail:"formula.functionList.T_DIST_2T.functionParameter.x.detail",example:"8",require:1,repeat:0},{name:"formula.functionList.T_DIST_2T.functionParameter.degFreedom.name",detail:"formula.functionList.T_DIST_2T.functionParameter.degFreedom.detail",example:"3",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.T_DIST_RT,functionType:t.FunctionType.Statistical,description:"formula.functionList.T_DIST_RT.description",abstract:"formula.functionList.T_DIST_RT.abstract",functionParameter:[{name:"formula.functionList.T_DIST_RT.functionParameter.x.name",detail:"formula.functionList.T_DIST_RT.functionParameter.x.detail",example:"8",require:1,repeat:0},{name:"formula.functionList.T_DIST_RT.functionParameter.degFreedom.name",detail:"formula.functionList.T_DIST_RT.functionParameter.degFreedom.detail",example:"3",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.T_INV,functionType:t.FunctionType.Statistical,description:"formula.functionList.T_INV.description",abstract:"formula.functionList.T_INV.abstract",functionParameter:[{name:"formula.functionList.T_INV.functionParameter.probability.name",detail:"formula.functionList.T_INV.functionParameter.probability.detail",example:"0.75",require:1,repeat:0},{name:"formula.functionList.T_INV.functionParameter.degFreedom.name",detail:"formula.functionList.T_INV.functionParameter.degFreedom.detail",example:"2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.T_INV_2T,functionType:t.FunctionType.Statistical,description:"formula.functionList.T_INV_2T.description",abstract:"formula.functionList.T_INV_2T.abstract",functionParameter:[{name:"formula.functionList.T_INV_2T.functionParameter.probability.name",detail:"formula.functionList.T_INV_2T.functionParameter.probability.detail",example:"0.75",require:1,repeat:0},{name:"formula.functionList.T_INV_2T.functionParameter.degFreedom.name",detail:"formula.functionList.T_INV_2T.functionParameter.degFreedom.detail",example:"2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.T_TEST,functionType:t.FunctionType.Statistical,description:"formula.functionList.T_TEST.description",abstract:"formula.functionList.T_TEST.abstract",functionParameter:[{name:"formula.functionList.T_TEST.functionParameter.array1.name",detail:"formula.functionList.T_TEST.functionParameter.array1.detail",example:"A1:A4",require:1,repeat:0},{name:"formula.functionList.T_TEST.functionParameter.array2.name",detail:"formula.functionList.T_TEST.functionParameter.array2.detail",example:"B1:B4",require:1,repeat:0},{name:"formula.functionList.T_TEST.functionParameter.tails.name",detail:"formula.functionList.T_TEST.functionParameter.tails.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.T_TEST.functionParameter.type.name",detail:"formula.functionList.T_TEST.functionParameter.type.detail",example:"1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.TREND,functionType:t.FunctionType.Statistical,description:"formula.functionList.TREND.description",abstract:"formula.functionList.TREND.abstract",functionParameter:[{name:"formula.functionList.TREND.functionParameter.knownYs.name",detail:"formula.functionList.TREND.functionParameter.knownYs.detail",example:"B2:B7",require:1,repeat:0},{name:"formula.functionList.TREND.functionParameter.knownXs.name",detail:"formula.functionList.TREND.functionParameter.knownXs.detail",example:"A2:A7",require:0,repeat:0},{name:"formula.functionList.TREND.functionParameter.newXs.name",detail:"formula.functionList.TREND.functionParameter.newXs.detail",example:"A9:A10",require:0,repeat:0},{name:"formula.functionList.TREND.functionParameter.constb.name",detail:"formula.functionList.TREND.functionParameter.constb.detail",example:"true",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.TRIMMEAN,functionType:t.FunctionType.Statistical,description:"formula.functionList.TRIMMEAN.description",abstract:"formula.functionList.TRIMMEAN.abstract",functionParameter:[{name:"formula.functionList.TRIMMEAN.functionParameter.array.name",detail:"formula.functionList.TRIMMEAN.functionParameter.array.detail",example:"A2:A12",require:1,repeat:0},{name:"formula.functionList.TRIMMEAN.functionParameter.percent.name",detail:"formula.functionList.TRIMMEAN.functionParameter.percent.detail",example:"0.2",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.VAR_P,functionType:t.FunctionType.Statistical,description:"formula.functionList.VAR_P.description",abstract:"formula.functionList.VAR_P.abstract",functionParameter:[{name:"formula.functionList.VAR_P.functionParameter.number1.name",detail:"formula.functionList.VAR_P.functionParameter.number1.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.VAR_P.functionParameter.number2.name",detail:"formula.functionList.VAR_P.functionParameter.number2.detail",example:"2",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.VAR_S,functionType:t.FunctionType.Statistical,description:"formula.functionList.VAR_S.description",abstract:"formula.functionList.VAR_S.abstract",functionParameter:[{name:"formula.functionList.VAR_S.functionParameter.number1.name",detail:"formula.functionList.VAR_S.functionParameter.number1.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.VAR_S.functionParameter.number2.name",detail:"formula.functionList.VAR_S.functionParameter.number2.detail",example:"2",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.VARA,functionType:t.FunctionType.Statistical,description:"formula.functionList.VARA.description",abstract:"formula.functionList.VARA.abstract",functionParameter:[{name:"formula.functionList.VARA.functionParameter.value1.name",detail:"formula.functionList.VARA.functionParameter.value1.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.VARA.functionParameter.value2.name",detail:"formula.functionList.VARA.functionParameter.value2.detail",example:"2",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.VARPA,functionType:t.FunctionType.Statistical,description:"formula.functionList.VARPA.description",abstract:"formula.functionList.VARPA.abstract",functionParameter:[{name:"formula.functionList.VARPA.functionParameter.value1.name",detail:"formula.functionList.VARPA.functionParameter.value1.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.VARPA.functionParameter.value2.name",detail:"formula.functionList.VARPA.functionParameter.value2.detail",example:"2",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.WEIBULL_DIST,functionType:t.FunctionType.Statistical,description:"formula.functionList.WEIBULL_DIST.description",abstract:"formula.functionList.WEIBULL_DIST.abstract",functionParameter:[{name:"formula.functionList.WEIBULL_DIST.functionParameter.x.name",detail:"formula.functionList.WEIBULL_DIST.functionParameter.x.detail",example:"105",require:1,repeat:0},{name:"formula.functionList.WEIBULL_DIST.functionParameter.alpha.name",detail:"formula.functionList.WEIBULL_DIST.functionParameter.alpha.detail",example:"20",require:1,repeat:0},{name:"formula.functionList.WEIBULL_DIST.functionParameter.beta.name",detail:"formula.functionList.WEIBULL_DIST.functionParameter.beta.detail",example:"100",require:1,repeat:0},{name:"formula.functionList.WEIBULL_DIST.functionParameter.cumulative.name",detail:"formula.functionList.WEIBULL_DIST.functionParameter.cumulative.detail",example:"true",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_STATISTICAL.Z_TEST,functionType:t.FunctionType.Statistical,description:"formula.functionList.Z_TEST.description",abstract:"formula.functionList.Z_TEST.abstract",functionParameter:[{name:"formula.functionList.Z_TEST.functionParameter.array.name",detail:"formula.functionList.Z_TEST.functionParameter.array.detail",example:"A2:A11",require:1,repeat:0},{name:"formula.functionList.Z_TEST.functionParameter.x.name",detail:"formula.functionList.Z_TEST.functionParameter.x.detail",example:"4",require:1,repeat:0},{name:"formula.functionList.Z_TEST.functionParameter.sigma.name",detail:"formula.functionList.Z_TEST.functionParameter.sigma.detail",example:"10",require:0,repeat:0}]}],ra=[{functionName:t.FUNCTION_NAMES_TEXT.ASC,functionType:t.FunctionType.Text,description:"formula.functionList.ASC.description",abstract:"formula.functionList.ASC.abstract",functionParameter:[{name:"formula.functionList.ASC.functionParameter.text.name",detail:"formula.functionList.ASC.functionParameter.text.detail",example:'""',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.ARRAYTOTEXT,functionType:t.FunctionType.Text,description:"formula.functionList.ARRAYTOTEXT.description",abstract:"formula.functionList.ARRAYTOTEXT.abstract",functionParameter:[{name:"formula.functionList.ARRAYTOTEXT.functionParameter.array.name",detail:"formula.functionList.ARRAYTOTEXT.functionParameter.array.detail",example:"A2:B4",require:1,repeat:0},{name:"formula.functionList.ARRAYTOTEXT.functionParameter.format.name",detail:"formula.functionList.ARRAYTOTEXT.functionParameter.format.detail",example:"0",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.BAHTTEXT,functionType:t.FunctionType.Text,description:"formula.functionList.BAHTTEXT.description",abstract:"formula.functionList.BAHTTEXT.abstract",functionParameter:[{name:"formula.functionList.BAHTTEXT.functionParameter.number.name",detail:"formula.functionList.BAHTTEXT.functionParameter.number.detail",example:"1234",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.CHAR,functionType:t.FunctionType.Text,description:"formula.functionList.CHAR.description",abstract:"formula.functionList.CHAR.abstract",functionParameter:[{name:"formula.functionList.CHAR.functionParameter.number.name",detail:"formula.functionList.CHAR.functionParameter.number.detail",example:"65",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.CLEAN,functionType:t.FunctionType.Text,description:"formula.functionList.CLEAN.description",abstract:"formula.functionList.CLEAN.abstract",functionParameter:[{name:"formula.functionList.CLEAN.functionParameter.text.name",detail:"formula.functionList.CLEAN.functionParameter.text.detail",example:'CHAR(1)&"Univer"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.CODE,functionType:t.FunctionType.Text,description:"formula.functionList.CODE.description",abstract:"formula.functionList.CODE.abstract",functionParameter:[{name:"formula.functionList.CODE.functionParameter.text.name",detail:"formula.functionList.CODE.functionParameter.text.detail",example:'"Univer"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.CONCAT,functionType:t.FunctionType.Text,description:"formula.functionList.CONCAT.description",abstract:"formula.functionList.CONCAT.abstract",functionParameter:[{name:"formula.functionList.CONCAT.functionParameter.text1.name",detail:"formula.functionList.CONCAT.functionParameter.text1.detail",example:'"Hello"',require:1,repeat:0},{name:"formula.functionList.CONCAT.functionParameter.text2.name",detail:"formula.functionList.CONCAT.functionParameter.text2.detail",example:'"Univer"',require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_TEXT.CONCATENATE,functionType:t.FunctionType.Text,description:"formula.functionList.CONCATENATE.description",abstract:"formula.functionList.CONCATENATE.abstract",functionParameter:[{name:"formula.functionList.CONCATENATE.functionParameter.text1.name",detail:"formula.functionList.CONCATENATE.functionParameter.text1.detail",example:"A1",require:1,repeat:0},{name:"formula.functionList.CONCATENATE.functionParameter.text2.name",detail:"formula.functionList.CONCATENATE.functionParameter.text2.detail",example:"A2",require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_TEXT.DBCS,functionType:t.FunctionType.Text,description:"formula.functionList.DBCS.description",abstract:"formula.functionList.DBCS.abstract",functionParameter:[{name:"formula.functionList.DBCS.functionParameter.text.name",detail:"formula.functionList.DBCS.functionParameter.text.detail",example:'"Univer"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.DOLLAR,functionType:t.FunctionType.Text,description:"formula.functionList.DOLLAR.description",abstract:"formula.functionList.DOLLAR.abstract",functionParameter:[{name:"formula.functionList.DOLLAR.functionParameter.number.name",detail:"formula.functionList.DOLLAR.functionParameter.number.detail",example:"1234.567",require:1,repeat:0},{name:"formula.functionList.DOLLAR.functionParameter.decimals.name",detail:"formula.functionList.DOLLAR.functionParameter.decimals.detail",example:"2",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.EXACT,functionType:t.FunctionType.Text,description:"formula.functionList.EXACT.description",abstract:"formula.functionList.EXACT.abstract",functionParameter:[{name:"formula.functionList.EXACT.functionParameter.text1.name",detail:"formula.functionList.EXACT.functionParameter.text1.detail",example:'"Univer"',require:1,repeat:0},{name:"formula.functionList.EXACT.functionParameter.text2.name",detail:"formula.functionList.EXACT.functionParameter.text2.detail",example:'"univer"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.FIND,functionType:t.FunctionType.Text,description:"formula.functionList.FIND.description",abstract:"formula.functionList.FIND.abstract",functionParameter:[{name:"formula.functionList.FIND.functionParameter.findText.name",detail:"formula.functionList.FIND.functionParameter.findText.detail",example:'"Univer"',require:1,repeat:0},{name:"formula.functionList.FIND.functionParameter.withinText.name",detail:"formula.functionList.FIND.functionParameter.withinText.detail",example:'"Hello Univer"',require:1,repeat:0},{name:"formula.functionList.FIND.functionParameter.startNum.name",detail:"formula.functionList.FIND.functionParameter.startNum.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.FINDB,functionType:t.FunctionType.Text,description:"formula.functionList.FINDB.description",abstract:"formula.functionList.FINDB.abstract",functionParameter:[{name:"formula.functionList.FINDB.functionParameter.findText.name",detail:"formula.functionList.FINDB.functionParameter.findText.detail",example:'"Univer"',require:1,repeat:0},{name:"formula.functionList.FINDB.functionParameter.withinText.name",detail:"formula.functionList.FINDB.functionParameter.withinText.detail",example:'"Hello Univer"',require:1,repeat:0},{name:"formula.functionList.FINDB.functionParameter.startNum.name",detail:"formula.functionList.FINDB.functionParameter.startNum.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.FIXED,functionType:t.FunctionType.Text,description:"formula.functionList.FIXED.description",abstract:"formula.functionList.FIXED.abstract",functionParameter:[{name:"formula.functionList.FIXED.functionParameter.number.name",detail:"formula.functionList.FIXED.functionParameter.number.detail",example:"1234.567",require:1,repeat:0},{name:"formula.functionList.FIXED.functionParameter.decimals.name",detail:"formula.functionList.FIXED.functionParameter.decimals.detail",example:"2",require:0,repeat:0},{name:"formula.functionList.FIXED.functionParameter.noCommas.name",detail:"formula.functionList.FIXED.functionParameter.noCommas.detail",example:"0",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.LEFT,functionType:t.FunctionType.Text,description:"formula.functionList.LEFT.description",abstract:"formula.functionList.LEFT.abstract",functionParameter:[{name:"formula.functionList.LEFT.functionParameter.text.name",detail:"formula.functionList.LEFT.functionParameter.text.detail",example:'"Univer"',require:1,repeat:0},{name:"formula.functionList.LEFT.functionParameter.numChars.name",detail:"formula.functionList.LEFT.functionParameter.numChars.detail",example:"3",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.LEFTB,functionType:t.FunctionType.Text,description:"formula.functionList.LEFTB.description",abstract:"formula.functionList.LEFTB.abstract",functionParameter:[{name:"formula.functionList.LEFTB.functionParameter.text.name",detail:"formula.functionList.LEFTB.functionParameter.text.detail",example:'"Univer"',require:1,repeat:0},{name:"formula.functionList.LEFTB.functionParameter.numBytes.name",detail:"formula.functionList.LEFTB.functionParameter.numBytes.detail",example:"3",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.LEN,functionType:t.FunctionType.Text,description:"formula.functionList.LEN.description",abstract:"formula.functionList.LEN.abstract",functionParameter:[{name:"formula.functionList.LEN.functionParameter.text.name",detail:"formula.functionList.LEN.functionParameter.text.detail",example:'"Univer"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.LENB,functionType:t.FunctionType.Text,description:"formula.functionList.LENB.description",abstract:"formula.functionList.LENB.abstract",functionParameter:[{name:"formula.functionList.LENB.functionParameter.text.name",detail:"formula.functionList.LENB.functionParameter.text.detail",example:'"Univer"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.LOWER,functionType:t.FunctionType.Text,description:"formula.functionList.LOWER.description",abstract:"formula.functionList.LOWER.abstract",functionParameter:[{name:"formula.functionList.LOWER.functionParameter.text.name",detail:"formula.functionList.LOWER.functionParameter.text.detail",example:'"Univer"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.MID,functionType:t.FunctionType.Text,description:"formula.functionList.MID.description",abstract:"formula.functionList.MID.abstract",functionParameter:[{name:"formula.functionList.MID.functionParameter.text.name",detail:"formula.functionList.MID.functionParameter.text.detail",example:'"Univer"',require:1,repeat:0},{name:"formula.functionList.MID.functionParameter.startNum.name",detail:"formula.functionList.MID.functionParameter.startNum.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.MID.functionParameter.numChars.name",detail:"formula.functionList.MID.functionParameter.numChars.detail",example:"3",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.MIDB,functionType:t.FunctionType.Text,description:"formula.functionList.MIDB.description",abstract:"formula.functionList.MIDB.abstract",functionParameter:[{name:"formula.functionList.MIDB.functionParameter.text.name",detail:"formula.functionList.MIDB.functionParameter.text.detail",example:'"Univer"',require:1,repeat:0},{name:"formula.functionList.MIDB.functionParameter.startNum.name",detail:"formula.functionList.MIDB.functionParameter.startNum.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.MIDB.functionParameter.numBytes.name",detail:"formula.functionList.MIDB.functionParameter.numBytes.detail",example:"3",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.NUMBERSTRING,functionType:t.FunctionType.Text,description:"formula.functionList.NUMBERSTRING.description",abstract:"formula.functionList.NUMBERSTRING.abstract",functionParameter:[{name:"formula.functionList.NUMBERSTRING.functionParameter.number.name",detail:"formula.functionList.NUMBERSTRING.functionParameter.number.detail",example:"123",require:1,repeat:0},{name:"formula.functionList.NUMBERSTRING.functionParameter.type.name",detail:"formula.functionList.NUMBERSTRING.functionParameter.type.detail",example:"1",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.NUMBERVALUE,functionType:t.FunctionType.Text,description:"formula.functionList.NUMBERVALUE.description",abstract:"formula.functionList.NUMBERVALUE.abstract",functionParameter:[{name:"formula.functionList.NUMBERVALUE.functionParameter.text.name",detail:"formula.functionList.NUMBERVALUE.functionParameter.text.detail",example:'"2.500,27"',require:1,repeat:0},{name:"formula.functionList.NUMBERVALUE.functionParameter.decimalSeparator.name",detail:"formula.functionList.NUMBERVALUE.functionParameter.decimalSeparator.detail",example:'","',require:0,repeat:0},{name:"formula.functionList.NUMBERVALUE.functionParameter.groupSeparator.name",detail:"formula.functionList.NUMBERVALUE.functionParameter.groupSeparator.detail",example:'"."',require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.PHONETIC,functionType:t.FunctionType.Text,description:"formula.functionList.PHONETIC.description",abstract:"formula.functionList.PHONETIC.abstract",functionParameter:[{name:"formula.functionList.PHONETIC.functionParameter.number1.name",detail:"formula.functionList.PHONETIC.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.PHONETIC.functionParameter.number2.name",detail:"formula.functionList.PHONETIC.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.PROPER,functionType:t.FunctionType.Text,description:"formula.functionList.PROPER.description",abstract:"formula.functionList.PROPER.abstract",functionParameter:[{name:"formula.functionList.PROPER.functionParameter.text.name",detail:"formula.functionList.PROPER.functionParameter.text.detail",example:'"hello univer"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.REGEXEXTRACT,functionType:t.FunctionType.Text,description:"formula.functionList.REGEXEXTRACT.description",abstract:"formula.functionList.REGEXEXTRACT.abstract",functionParameter:[{name:"formula.functionList.REGEXEXTRACT.functionParameter.text.name",detail:"formula.functionList.REGEXEXTRACT.functionParameter.text.detail",example:'"abcdefg"',require:1,repeat:0},{name:"formula.functionList.REGEXEXTRACT.functionParameter.regularExpression.name",detail:"formula.functionList.REGEXEXTRACT.functionParameter.regularExpression.detail",example:'"c.*f"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.REGEXMATCH,functionType:t.FunctionType.Text,description:"formula.functionList.REGEXMATCH.description",abstract:"formula.functionList.REGEXMATCH.abstract",functionParameter:[{name:"formula.functionList.REGEXMATCH.functionParameter.text.name",detail:"formula.functionList.REGEXMATCH.functionParameter.text.detail",example:'"Spreadsheets"',require:1,repeat:0},{name:"formula.functionList.REGEXMATCH.functionParameter.regularExpression.name",detail:"formula.functionList.REGEXMATCH.functionParameter.regularExpression.detail",example:'"S.r"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.REGEXREPLACE,functionType:t.FunctionType.Text,description:"formula.functionList.REGEXREPLACE.description",abstract:"formula.functionList.REGEXREPLACE.abstract",functionParameter:[{name:"formula.functionList.REGEXREPLACE.functionParameter.text.name",detail:"formula.functionList.REGEXREPLACE.functionParameter.text.detail",example:'"abcedfg"',require:1,repeat:0},{name:"formula.functionList.REGEXREPLACE.functionParameter.regularExpression.name",detail:"formula.functionList.REGEXREPLACE.functionParameter.regularExpression.detail",example:'"a.*d"',require:1,repeat:0},{name:"formula.functionList.REGEXREPLACE.functionParameter.replacement.name",detail:"formula.functionList.REGEXREPLACE.functionParameter.replacement.detail",example:'"xyz"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.REPLACE,functionType:t.FunctionType.Text,description:"formula.functionList.REPLACE.description",abstract:"formula.functionList.REPLACE.abstract",functionParameter:[{name:"formula.functionList.REPLACE.functionParameter.oldText.name",detail:"formula.functionList.REPLACE.functionParameter.oldText.detail",example:'"Univer"',require:1,repeat:0},{name:"formula.functionList.REPLACE.functionParameter.startNum.name",detail:"formula.functionList.REPLACE.functionParameter.startNum.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.REPLACE.functionParameter.numChars.name",detail:"formula.functionList.REPLACE.functionParameter.numChars.detail",example:"0",require:1,repeat:0},{name:"formula.functionList.REPLACE.functionParameter.newText.name",detail:"formula.functionList.REPLACE.functionParameter.newText.detail",example:'"Hello "',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.REPLACEB,functionType:t.FunctionType.Text,description:"formula.functionList.REPLACEB.description",abstract:"formula.functionList.REPLACEB.abstract",functionParameter:[{name:"formula.functionList.REPLACEB.functionParameter.oldText.name",detail:"formula.functionList.REPLACEB.functionParameter.oldText.detail",example:'"Univer"',require:1,repeat:0},{name:"formula.functionList.REPLACEB.functionParameter.startNum.name",detail:"formula.functionList.REPLACEB.functionParameter.startNum.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.REPLACEB.functionParameter.numBytes.name",detail:"formula.functionList.REPLACEB.functionParameter.numBytes.detail",example:"0",require:1,repeat:0},{name:"formula.functionList.REPLACEB.functionParameter.newText.name",detail:"formula.functionList.REPLACEB.functionParameter.newText.detail",example:'"Hello "',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.REPT,functionType:t.FunctionType.Text,description:"formula.functionList.REPT.description",abstract:"formula.functionList.REPT.abstract",functionParameter:[{name:"formula.functionList.REPT.functionParameter.text.name",detail:"formula.functionList.REPT.functionParameter.text.detail",example:'"*-"',require:1,repeat:0},{name:"formula.functionList.REPT.functionParameter.numberTimes.name",detail:"formula.functionList.REPT.functionParameter.numberTimes.detail",example:"3",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.RIGHT,functionType:t.FunctionType.Text,description:"formula.functionList.RIGHT.description",abstract:"formula.functionList.RIGHT.abstract",functionParameter:[{name:"formula.functionList.RIGHT.functionParameter.text.name",detail:"formula.functionList.RIGHT.functionParameter.text.detail",example:'"Univer"',require:1,repeat:0},{name:"formula.functionList.RIGHT.functionParameter.numChars.name",detail:"formula.functionList.RIGHT.functionParameter.numChars.detail",example:"3",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.RIGHTB,functionType:t.FunctionType.Text,description:"formula.functionList.RIGHTB.description",abstract:"formula.functionList.RIGHTB.abstract",functionParameter:[{name:"formula.functionList.RIGHTB.functionParameter.text.name",detail:"formula.functionList.RIGHTB.functionParameter.text.detail",example:'"Univer"',require:1,repeat:0},{name:"formula.functionList.RIGHTB.functionParameter.numBytes.name",detail:"formula.functionList.RIGHTB.functionParameter.numBytes.detail",example:"3",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.SEARCH,functionType:t.FunctionType.Text,description:"formula.functionList.SEARCH.description",abstract:"formula.functionList.SEARCH.abstract",functionParameter:[{name:"formula.functionList.SEARCH.functionParameter.findText.name",detail:"formula.functionList.SEARCH.functionParameter.findText.detail",example:'"univer"',require:1,repeat:0},{name:"formula.functionList.SEARCH.functionParameter.withinText.name",detail:"formula.functionList.SEARCH.functionParameter.withinText.detail",example:'"Hello Univer"',require:1,repeat:0},{name:"formula.functionList.SEARCH.functionParameter.startNum.name",detail:"formula.functionList.SEARCH.functionParameter.startNum.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.SEARCHB,functionType:t.FunctionType.Text,description:"formula.functionList.SEARCHB.description",abstract:"formula.functionList.SEARCHB.abstract",functionParameter:[{name:"formula.functionList.SEARCHB.functionParameter.findText.name",detail:"formula.functionList.SEARCHB.functionParameter.findText.detail",example:'"univer"',require:1,repeat:0},{name:"formula.functionList.SEARCHB.functionParameter.withinText.name",detail:"formula.functionList.SEARCHB.functionParameter.withinText.detail",example:'"Hello Univer"',require:1,repeat:0},{name:"formula.functionList.SEARCHB.functionParameter.startNum.name",detail:"formula.functionList.SEARCHB.functionParameter.startNum.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.SUBSTITUTE,functionType:t.FunctionType.Text,description:"formula.functionList.SUBSTITUTE.description",abstract:"formula.functionList.SUBSTITUTE.abstract",functionParameter:[{name:"formula.functionList.SUBSTITUTE.functionParameter.text.name",detail:"formula.functionList.SUBSTITUTE.functionParameter.text.detail",example:'"Hello Univer"',require:1,repeat:0},{name:"formula.functionList.SUBSTITUTE.functionParameter.oldText.name",detail:"formula.functionList.SUBSTITUTE.functionParameter.oldText.detail",example:'"Hello"',require:1,repeat:0},{name:"formula.functionList.SUBSTITUTE.functionParameter.newText.name",detail:"formula.functionList.SUBSTITUTE.functionParameter.newText.detail",example:'"Hi"',require:1,repeat:0},{name:"formula.functionList.SUBSTITUTE.functionParameter.instanceNum.name",detail:"formula.functionList.SUBSTITUTE.functionParameter.instanceNum.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.T,functionType:t.FunctionType.Text,description:"formula.functionList.T.description",abstract:"formula.functionList.T.abstract",functionParameter:[{name:"formula.functionList.T.functionParameter.value.name",detail:"formula.functionList.T.functionParameter.value.detail",example:'"Univer"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.TEXT,functionType:t.FunctionType.Text,description:"formula.functionList.TEXT.description",abstract:"formula.functionList.TEXT.abstract",functionParameter:[{name:"formula.functionList.TEXT.functionParameter.value.name",detail:"formula.functionList.TEXT.functionParameter.value.detail",example:"1.23",require:1,repeat:0},{name:"formula.functionList.TEXT.functionParameter.formatText.name",detail:"formula.functionList.TEXT.functionParameter.formatText.detail",example:'"$0.00"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.TEXTAFTER,functionType:t.FunctionType.Text,description:"formula.functionList.TEXTAFTER.description",abstract:"formula.functionList.TEXTAFTER.abstract",functionParameter:[{name:"formula.functionList.TEXTAFTER.functionParameter.text.name",detail:"formula.functionList.TEXTAFTER.functionParameter.text.detail",example:'"Red riding hoods, red hood"',require:1,repeat:0},{name:"formula.functionList.TEXTAFTER.functionParameter.delimiter.name",detail:"formula.functionList.TEXTAFTER.functionParameter.delimiter.detail",example:'"hood"',require:1,repeat:0},{name:"formula.functionList.TEXTAFTER.functionParameter.instanceNum.name",detail:"formula.functionList.TEXTAFTER.functionParameter.instanceNum.detail",example:"1",require:0,repeat:0},{name:"formula.functionList.TEXTAFTER.functionParameter.matchMode.name",detail:"formula.functionList.TEXTAFTER.functionParameter.matchMode.detail",example:"1",require:0,repeat:0},{name:"formula.functionList.TEXTAFTER.functionParameter.matchEnd.name",detail:"formula.functionList.TEXTAFTER.functionParameter.matchEnd.detail",example:"0",require:0,repeat:0},{name:"formula.functionList.TEXTAFTER.functionParameter.ifNotFound.name",detail:"formula.functionList.TEXTAFTER.functionParameter.ifNotFound.detail",example:'"not found"',require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.TEXTBEFORE,functionType:t.FunctionType.Text,description:"formula.functionList.TEXTBEFORE.description",abstract:"formula.functionList.TEXTBEFORE.abstract",functionParameter:[{name:"formula.functionList.TEXTBEFORE.functionParameter.text.name",detail:"formula.functionList.TEXTBEFORE.functionParameter.text.detail",example:'"Red riding hoods, red hood"',require:1,repeat:0},{name:"formula.functionList.TEXTBEFORE.functionParameter.delimiter.name",detail:"formula.functionList.TEXTBEFORE.functionParameter.delimiter.detail",example:'"hood"',require:1,repeat:0},{name:"formula.functionList.TEXTBEFORE.functionParameter.instanceNum.name",detail:"formula.functionList.TEXTBEFORE.functionParameter.instanceNum.detail",example:"1",require:0,repeat:0},{name:"formula.functionList.TEXTBEFORE.functionParameter.matchMode.name",detail:"formula.functionList.TEXTBEFORE.functionParameter.matchMode.detail",example:"1",require:0,repeat:0},{name:"formula.functionList.TEXTBEFORE.functionParameter.matchEnd.name",detail:"formula.functionList.TEXTBEFORE.functionParameter.matchEnd.detail",example:"0",require:0,repeat:0},{name:"formula.functionList.TEXTBEFORE.functionParameter.ifNotFound.name",detail:"formula.functionList.TEXTBEFORE.functionParameter.ifNotFound.detail",example:'"not found"',require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.TEXTJOIN,functionType:t.FunctionType.Text,description:"formula.functionList.TEXTJOIN.description",abstract:"formula.functionList.TEXTJOIN.abstract",functionParameter:[{name:"formula.functionList.TEXTJOIN.functionParameter.delimiter.name",detail:"formula.functionList.TEXTJOIN.functionParameter.delimiter.detail",example:'", "',require:1,repeat:0},{name:"formula.functionList.TEXTJOIN.functionParameter.ignoreEmpty.name",detail:"formula.functionList.TEXTJOIN.functionParameter.ignoreEmpty.detail",example:"true",require:1,repeat:0},{name:"formula.functionList.TEXTJOIN.functionParameter.text1.name",detail:"formula.functionList.TEXTJOIN.functionParameter.text1.detail",example:'"Hi"',require:1,repeat:0},{name:"formula.functionList.TEXTJOIN.functionParameter.text2.name",detail:"formula.functionList.TEXTJOIN.functionParameter.text2.detail",example:'"Univer"',require:0,repeat:1}]},{functionName:t.FUNCTION_NAMES_TEXT.TEXTSPLIT,functionType:t.FunctionType.Text,description:"formula.functionList.TEXTSPLIT.description",abstract:"formula.functionList.TEXTSPLIT.abstract",functionParameter:[{name:"formula.functionList.TEXTSPLIT.functionParameter.text.name",detail:"formula.functionList.TEXTSPLIT.functionParameter.text.detail",example:"A1:C2",require:1,repeat:0},{name:"formula.functionList.TEXTSPLIT.functionParameter.colDelimiter.name",detail:"formula.functionList.TEXTSPLIT.functionParameter.colDelimiter.detail",example:'","',require:1,repeat:0},{name:"formula.functionList.TEXTSPLIT.functionParameter.rowDelimiter.name",detail:"formula.functionList.TEXTSPLIT.functionParameter.rowDelimiter.detail",example:'";"',require:0,repeat:0},{name:"formula.functionList.TEXTSPLIT.functionParameter.ignoreEmpty.name",detail:"formula.functionList.TEXTSPLIT.functionParameter.ignoreEmpty.detail",example:"",require:0,repeat:0},{name:"formula.functionList.TEXTSPLIT.functionParameter.matchMode.name",detail:"formula.functionList.TEXTSPLIT.functionParameter.matchMode.detail",example:"",require:0,repeat:0},{name:"formula.functionList.TEXTSPLIT.functionParameter.padWith.name",detail:"formula.functionList.TEXTSPLIT.functionParameter.padWith.detail",example:"",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.TRIM,functionType:t.FunctionType.Text,description:"formula.functionList.TRIM.description",abstract:"formula.functionList.TRIM.abstract",functionParameter:[{name:"formula.functionList.TRIM.functionParameter.text.name",detail:"formula.functionList.TRIM.functionParameter.text.detail",example:'" Hello  Univer "',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.UNICHAR,functionType:t.FunctionType.Text,description:"formula.functionList.UNICHAR.description",abstract:"formula.functionList.UNICHAR.abstract",functionParameter:[{name:"formula.functionList.UNICHAR.functionParameter.number.name",detail:"formula.functionList.UNICHAR.functionParameter.number.detail",example:"65",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.UNICODE,functionType:t.FunctionType.Text,description:"formula.functionList.UNICODE.description",abstract:"formula.functionList.UNICODE.abstract",functionParameter:[{name:"formula.functionList.UNICODE.functionParameter.text.name",detail:"formula.functionList.UNICODE.functionParameter.text.detail",example:'"Univer"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.UPPER,functionType:t.FunctionType.Text,description:"formula.functionList.UPPER.description",abstract:"formula.functionList.UPPER.abstract",functionParameter:[{name:"formula.functionList.UPPER.functionParameter.text.name",detail:"formula.functionList.UPPER.functionParameter.text.detail",example:'"Univer"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.VALUE,functionType:t.FunctionType.Text,description:"formula.functionList.VALUE.description",abstract:"formula.functionList.VALUE.abstract",functionParameter:[{name:"formula.functionList.VALUE.functionParameter.text.name",detail:"formula.functionList.VALUE.functionParameter.text.detail",example:'"123"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.VALUETOTEXT,functionType:t.FunctionType.Text,description:"formula.functionList.VALUETOTEXT.description",abstract:"formula.functionList.VALUETOTEXT.abstract",functionParameter:[{name:"formula.functionList.VALUETOTEXT.functionParameter.value.name",detail:"formula.functionList.VALUETOTEXT.functionParameter.value.detail",example:'"Univer"',require:1,repeat:0},{name:"formula.functionList.VALUETOTEXT.functionParameter.format.name",detail:"formula.functionList.VALUETOTEXT.functionParameter.format.detail",example:"1",require:0,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.CALL,functionType:t.FunctionType.Text,description:"formula.functionList.CALL.description",abstract:"formula.functionList.CALL.abstract",functionParameter:[{name:"formula.functionList.CALL.functionParameter.number1.name",detail:"formula.functionList.CALL.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CALL.functionParameter.number2.name",detail:"formula.functionList.CALL.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.EUROCONVERT,functionType:t.FunctionType.Text,description:"formula.functionList.EUROCONVERT.description",abstract:"formula.functionList.EUROCONVERT.abstract",functionParameter:[{name:"formula.functionList.EUROCONVERT.functionParameter.number1.name",detail:"formula.functionList.EUROCONVERT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.EUROCONVERT.functionParameter.number2.name",detail:"formula.functionList.EUROCONVERT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_TEXT.REGISTER_ID,functionType:t.FunctionType.Text,description:"formula.functionList.REGISTER_ID.description",abstract:"formula.functionList.REGISTER_ID.abstract",functionParameter:[{name:"formula.functionList.REGISTER_ID.functionParameter.number1.name",detail:"formula.functionList.REGISTER_ID.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.REGISTER_ID.functionParameter.number2.name",detail:"formula.functionList.REGISTER_ID.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]}],oa=[],ua=[{functionName:t.FUNCTION_NAMES_WEB.ENCODEURL,functionType:t.FunctionType.Web,description:"formula.functionList.ENCODEURL.description",abstract:"formula.functionList.ENCODEURL.abstract",functionParameter:[{name:"formula.functionList.ENCODEURL.functionParameter.text.name",detail:"formula.functionList.ENCODEURL.functionParameter.text.detail",example:'"https://univer.ai/"',require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_WEB.FILTERXML,functionType:t.FunctionType.Web,description:"formula.functionList.FILTERXML.description",abstract:"formula.functionList.FILTERXML.abstract",functionParameter:[{name:"formula.functionList.FILTERXML.functionParameter.number1.name",detail:"formula.functionList.FILTERXML.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FILTERXML.functionParameter.number2.name",detail:"formula.functionList.FILTERXML.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:t.FUNCTION_NAMES_WEB.WEBSERVICE,functionType:t.FunctionType.Web,description:"formula.functionList.WEBSERVICE.description",abstract:"formula.functionList.WEBSERVICE.abstract",functionParameter:[{name:"formula.functionList.WEBSERVICE.functionParameter.number1.name",detail:"formula.functionList.WEBSERVICE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.WEBSERVICE.functionParameter.number2.name",detail:"formula.functionList.WEBSERVICE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]}],ca=[...Je,...ze,...na,...ia,...aa,...$e,...ra,...ea,...ta,...Ze,...je,...Qe,...ua,...ke,...oa];function fa(r,e){let a="";return r.aliasFunctionName?(a=e.t(r.aliasFunctionName),a===r.aliasFunctionName&&(a=r.functionName)):a=r.functionName,a}var ma=Object.getOwnPropertyDescriptor,sa=(r,e,a,n)=>{for(var i=n>1?void 0:n?ma(e,a):e,o=r.length-1,u;o>=0;o--)(u=r[o])&&(i=u(i)||i);return i},bt=(r,e)=>(a,n)=>e(a,n,r);const rt=c.createIdentifier("formula.description-service");P.DescriptionService=class{constructor(e,a,n){h(this,"_descriptions",[]);this._functionService=e,this._localeService=a,this._configService=n,this._initialize()}dispose(){this._localeService.localeChanged$.complete()}getDescriptions(){return this._functionService.getDescriptions()}hasFunction(e){return this._functionService.getDescriptions().get(e.toLocaleUpperCase())!==void 0}getFunctionInfo(e){return this._functionService.getDescriptions().get(e.toLocaleUpperCase())}getSearchListByName(e){const a=[],n=this._functionService.getDescriptions(),i=e.toLocaleUpperCase().trim();return n.forEach(o=>{const{functionName:u,abstract:f,functionType:m}=o;u.toLocaleUpperCase().indexOf(i)>-1&&m!==t.FunctionType.DefinedName&&a.push({name:u,desc:f})}),a}getSearchListByNameFirstLetter(e){const a=[],n=this._functionService.getDescriptions(),i=e.toLocaleUpperCase().trim();return n.forEach(o=>{const{functionName:u,abstract:f,functionType:m}=o;u.toLocaleUpperCase().indexOf(i)===0&&a.push({name:u,desc:f,functionType:m})}),a}getSearchListByType(e){const a=[];return this._functionService.getDescriptions().forEach(i=>{const{functionName:o,functionType:u,abstract:f}=i;(u===e||e===-1)&&u!==t.FunctionType.DefinedName&&a.push({name:o,desc:f})}),a}registerDescriptions(e){return this._descriptions=this._descriptions.concat(e),this._registerDescriptions(),c.toDisposable(()=>{const a=e.map(n=>n.functionName);this.unregisterDescriptions(a)})}unregisterDescriptions(e){this._descriptions=this._descriptions.filter(a=>!e.includes(a.functionName)),this._functionService.unregisterDescriptions(...e)}hasDescription(e){return this._descriptions.some(a=>a.functionName===e)}hasDefinedNameDescription(e){return this._descriptions.some(a=>a.functionName===e&&a.functionType===t.FunctionType.DefinedName)}isFormulaDefinedName(e){const a=this._descriptions.filter(i=>i.functionName===e&&i.functionType===t.FunctionType.DefinedName);if(a.length===0)return!1;const n=a[0].description;return!t.isReferenceStrings(n)}_initialize(){this._localeService.localeChanged$.subscribe(()=>{this._registerDescriptions()}),this._initDescription(),this._registerDescriptions()}_initDescription(){var i;const e=[...t.functionArray,...t.functionCompatibility,...t.functionCube,...t.functionDatabase,...t.functionDate,...t.functionEngineering,...t.functionFinancial,...t.functionInformation,...t.functionLogical,...t.functionLookup,...t.functionMath,...t.functionMeta,...t.functionStatistical,...t.functionText,...t.functionUniver,...t.functionWeb].map(o=>o[1]),a=ca.filter(o=>e.includes(o.functionName)),n=this._configService.getConfig(Z);this._descriptions=a.concat((i=n==null?void 0:n.description)!=null?i:[])}_registerDescriptions(){const e=this._localeService,a=this._descriptions.map(n=>({functionName:fa(n,e),functionType:n.functionType,description:e.t(n.description),abstract:e.t(n.abstract),functionParameter:n.functionParameter.map(i=>({name:e.t(i.name),detail:e.t(i.detail),example:i.example,require:i.require,repeat:i.repeat}))}));this._functionService.registerDescriptions(...a)}},P.DescriptionService=sa([bt(0,t.IFunctionService),bt(1,c.Inject(c.LocaleService)),bt(2,c.IConfigService)],P.DescriptionService);var la=Object.getOwnPropertyDescriptor,pa=(r,e,a,n)=>{for(var i=n>1?void 0:n?la(e,a):e,o=r.length-1,u;o>=0;o--)(u=r[o])&&(i=u(i)||i);return i},st=(r,e)=>(a,n)=>e(a,n,r);let lt=class extends c.Disposable{constructor(e,a,n,i){super();h(this,"_preUnitId",null);this._descriptionService=e,this._definedNamesService=a,this._univerInstanceService=n,this._commandService=i,this._initialize()}_initialize(){this._descriptionListener(),this._changeUnitListener(),this._changeSheetListener()}_descriptionListener(){c.toDisposable(this._definedNamesService.update$.subscribe(()=>{this._registerDescriptions()}))}_changeUnitListener(){c.toDisposable(this._univerInstanceService.getCurrentTypeOfUnit$(c.UniverInstanceType.UNIVER_SHEET).subscribe(()=>{this._unRegisterDescriptions(),this._registerDescriptions()}))}_changeSheetListener(){this.disposeWithMe(this._commandService.onCommandExecuted((e,a)=>{if(!(a!=null&&a.fromCollab)){if(e.id===s.SetWorksheetActiveOperation.id)this._unregisterDescriptionsForNotInSheetId(),this._registerDescriptions();else if(e.id===t.SetDefinedNameMutation.id){const n=e.params;this._registerDescription(n)}else if(e.id===t.RemoveDefinedNameMutation.id){const n=e.params;this._unregisterDescription(n)}}}))}_registerDescription(e){const{unitId:a,sheetId:n}=this._getUnitIdAndSheetId();if(a==null||n==null)return;const{name:i,comment:o,formulaOrRefString:u,localSheetId:f}=e;!this._descriptionService.hasDescription(i)&&(f==null||f===s.SCOPE_WORKBOOK_VALUE_DEFINED_NAME||f===n)&&this._descriptionService.registerDescriptions([{functionName:i,description:u+(o||""),abstract:u,functionType:t.FunctionType.DefinedName,functionParameter:[]}])}_unregisterDescription(e){const{name:a}=e;this._descriptionService.unregisterDescriptions([a])}_unRegisterDescriptions(){if(this._preUnitId==null)return;const e=this._definedNamesService.getDefinedNameMap(this._preUnitId);if(e==null)return;const a=[];Array.from(Object.values(e)).forEach(n=>{const{name:i}=n;a.push(i)}),this._descriptionService.unregisterDescriptions(a),this._preUnitId=null}_getUnitIdAndSheetId(){const e=this._univerInstanceService.getCurrentUnitForType(c.UniverInstanceType.UNIVER_SHEET);if(e==null)return{};const a=e.getActiveSheet();return a==null?{}:{unitId:e.getUnitId(),sheetId:a.getSheetId()}}_registerDescriptions(){const{unitId:e,sheetId:a}=this._getUnitIdAndSheetId();if(e==null||a==null)return;const n=this._definedNamesService.getDefinedNameMap(e);if(!n)return;const i=[];this._preUnitId=e,Array.from(Object.values(n)).forEach(o=>{const{name:u,comment:f,formulaOrRefString:m,localSheetId:l}=o;!this._descriptionService.hasDescription(u)&&(l==null||l===s.SCOPE_WORKBOOK_VALUE_DEFINED_NAME||l===a)&&i.push({functionName:u,description:m+(f||""),abstract:m,functionType:t.FunctionType.DefinedName,functionParameter:[]})}),this._descriptionService.registerDescriptions(i)}_unregisterDescriptionsForNotInSheetId(){const{unitId:e,sheetId:a}=this._getUnitIdAndSheetId();if(e==null||a==null)return;const n=this._definedNamesService.getDefinedNameMap(e);if(!n)return;const i=[];Array.from(Object.values(n)).forEach(o=>{const{name:u,localSheetId:f}=o;f!==s.SCOPE_WORKBOOK_VALUE_DEFINED_NAME&&f!==a&&i.push(u)}),this._descriptionService.unregisterDescriptions(i)}};lt=pa([st(0,rt),st(1,t.IDefinedNamesService),st(2,c.IUniverInstanceService),st(3,c.ICommandService)],lt);var da=Object.getOwnPropertyDescriptor,La=(r,e,a,n)=>{for(var i=n>1?void 0:n?da(e,a):e,o=r.length-1,u;o>=0;o--)(u=r[o])&&(i=u(i)||i);return i},Ta=(r,e)=>(a,n)=>e(a,n,r);let pt=class extends c.Disposable{constructor(r){super(),this._commandService=r,[qt,ht,z].forEach(e=>this._commandService.registerCommand(e))}};pt=La([Ta(0,c.ICommandService)],pt);var Na=Object.getOwnPropertyDescriptor,Pa=(r,e,a,n)=>{for(var i=n>1?void 0:n?Na(e,a):e,o=r.length-1,u;o>=0;o--)(u=r[o])&&(i=u(i)||i);return i},dt=(r,e)=>(a,n)=>e(a,n,r);let Lt=class extends c.Disposable{constructor(e,a,n,i){super();h(this,"_preUnitId",null);this._descriptionService=e,this._univerInstanceService=a,this._commandService=n,this._superTableService=i,this._initialize()}_initialize(){this._descriptionListener(),this._changeUnitListener(),this._changeSheetListener()}_descriptionListener(){c.toDisposable(this._superTableService.update$.subscribe(()=>{this._registerDescriptions()}))}_changeUnitListener(){c.toDisposable(this._univerInstanceService.getCurrentTypeOfUnit$(c.UniverInstanceType.UNIVER_SHEET).subscribe(()=>{this._unRegisterDescriptions(),this._registerDescriptions()}))}_changeSheetListener(){this.disposeWithMe(this._commandService.onCommandExecuted((e,a)=>{if(!(a!=null&&a.fromCollab)){if(e.id===s.SetWorksheetActiveOperation.id)this._unregisterDescriptionsForNotInSheetId(),this._registerDescriptions();else if(e.id===t.SetSuperTableMutation.id){const n=e.params;this._registerDescription(n)}else if(e.id===t.RemoveSuperTableMutation.id){const n=e.params;this._unregisterDescription(n)}}}))}_registerDescription(e){var u,f;const{unitId:a,sheetId:n}=this._getUnitIdAndSheetId();if(a==null||n==null)return;const{tableName:i,reference:o}=e;if(!this._descriptionService.hasDescription(i)){const m=((f=(u=this._univerInstanceService.getUnit(a))==null?void 0:u.getSheetBySheetId(o.sheetId))==null?void 0:f.getName())||"",l=t.serializeRangeWithSheet(m,o.range);this._descriptionService.registerDescriptions([{functionName:i,description:l,abstract:l,functionType:t.FunctionType.Table,functionParameter:[]}])}}_unregisterDescription(e){const{tableName:a}=e;this._descriptionService.unregisterDescriptions([a])}_unRegisterDescriptions(){if(this._preUnitId==null)return;const e=this._superTableService.getTableMap(this._preUnitId);if(e==null)return;const a=[];e.forEach((n,i)=>{a.push(i)}),this._descriptionService.unregisterDescriptions(a),this._preUnitId=null}_getUnitIdAndSheetId(){const e=this._univerInstanceService.getCurrentUnitForType(c.UniverInstanceType.UNIVER_SHEET);if(e==null)return{};const a=e.getActiveSheet();return a==null?{}:{unitId:e.getUnitId(),sheetId:a.getSheetId()}}_registerDescriptions(){const{unitId:e,sheetId:a}=this._getUnitIdAndSheetId();if(e==null||a==null)return;const n=this._superTableService.getTableMap(e);if(!n)return;const i=[];this._preUnitId=e,n.forEach((o,u)=>{var l,p;const f=((p=(l=this._univerInstanceService.getUnit(e))==null?void 0:l.getSheetBySheetId(o.sheetId))==null?void 0:p.getName())||"",m=t.serializeRangeWithSheet(f,o.range);this._descriptionService.hasDescription(u)||i.push({functionName:u,description:m,abstract:m,functionType:t.FunctionType.Table,functionParameter:[]})}),this._descriptionService.registerDescriptions(i)}_unregisterDescriptionsForNotInSheetId(){const{unitId:e,sheetId:a}=this._getUnitIdAndSheetId();if(e==null||a==null)return;const n=this._superTableService.getTableMap(e);if(!n)return;const i=[];n.forEach((o,u)=>{i.push(u)}),this._descriptionService.unregisterDescriptions(i)}};Lt=Pa([dt(0,rt),dt(1,c.IUniverInstanceService),dt(2,c.ICommandService),dt(3,t.ISuperTableService)],Lt);var Ea=Object.getOwnPropertyDescriptor,Ia=(r,e,a,n)=>{for(var i=n>1?void 0:n?Ea(e,a):e,o=r.length-1,u;o>=0;o--)(u=r[o])&&(i=u(i)||i);return i},Tt=(r,e)=>(a,n)=>e(a,n,r);function Xt(r,e,a,n){const i=r.sequenceNodesBuilder(e);if(i==null)return e;const o=[];for(let u=0,f=i.length;u<f;u++){const m=i[u];if(typeof m=="string"||m.nodeType!==t.sequenceNodeType.REFERENCE)continue;const{token:l}=m,p=t.deserializeRangeWithSheetWithCache(l),{sheetName:L,unitId:N}=p;let T=p.range;T.startAbsoluteRefType===c.AbsoluteRefType.ALL&&T.endAbsoluteRefType===c.AbsoluteRefType.ALL||(T=c.moveRangeByOffset(T,a,n),o.push({unitId:N,sheetName:L,range:T}))}return o.map(u=>`${u.unitId}!${u.sheetName}!${u.range.startRow}!${u.range.endRow}!${u.range.startColumn}!${u.range.endColumn}`).join("|")}P.FormulaRefRangeService=class extends c.Disposable{constructor(e,a,n,i){super(),this._refRangeService=e,this._lexerTreeBuilder=a,this._univerInstanceService=n,this._injector=i}transformFormulaByEffectCommand(e,a,n,i){const o=this._lexerTreeBuilder.sequenceNodesBuilder(n),u=this._univerInstanceService.getCurrentUnitForType(c.UniverInstanceType.UNIVER_SHEET),f=u.getActiveSheet(),m=u.getUnitId(),l=f.getSheetId(),p=o==null?void 0:o.map(L=>{if(typeof L=="object"&&L.nodeType===t.sequenceNodeType.REFERENCE){const N=t.deserializeRangeWithSheetWithCache(L.token),{range:T,unitId:A,sheetName:C}=N,R=this._univerInstanceService.getUnit(A||e),d=C?R==null?void 0:R.getSheetBySheetName(C):R==null?void 0:R.getSheetBySheetId(a);if(!d)throw new Error("Sheet not found");const S=R.getUnitId(),E=d.getSheetId();if(S!==m||E!==l)return L;const I=s.handleDefaultRangeChangeWithEffectRefCommands(T,i);let O="";if(I){const D=I.startColumn-T.startColumn,U=I.startRow-T.startRow,M=c.moveRangeByOffset(T,D,U);A&&C?O=t.serializeRangeWithSpreadsheet(A,C,M):C?O=t.serializeRangeWithSheet(C,M):O=t.serializeRange(M)}else O=t.ErrorType.REF;return{...L,token:O}}else return L});return p?`=${t.generateStringWithSequence(p)}`:""}registerFormula(e,a,n,i){const o=new Map,u=this._lexerTreeBuilder.sequenceNodesBuilder(n),f=new c.DisposableCollection,m=l=>{const p=this._univerInstanceService.getCurrentUnitForType(c.UniverInstanceType.UNIVER_SHEET),L=p.getActiveSheet(),N=p.getUnitId(),T=L.getSheetId(),A=u==null?void 0:u.map(R=>{if(typeof R=="object"&&R.nodeType===t.sequenceNodeType.REFERENCE){const d=o.get(R.token);if(d.unitId!==N||d.subUnitId!==T)return R;const S=s.handleDefaultRangeChangeWithEffectRefCommands(d.range,l);let E="";if(S){const I=S.startColumn-d.range.startColumn,O=S.startRow-d.range.startRow,D=c.moveRangeByOffset(d.range,I,O);d.unitId&&d.sheetName?E=t.serializeRangeWithSpreadsheet(d.unitId,d.sheetName,D):d.sheetName?E=t.serializeRangeWithSheet(d.sheetName,D):E=t.serializeRange(D)}else E=t.ErrorType.REF;return{...R,token:E}}else return R}),C=A&&t.generateStringWithSequence(A);return i(`=${C}`)};return u==null||u.forEach(l=>{if(typeof l=="object"&&l.nodeType===t.sequenceNodeType.REFERENCE){const p=t.deserializeRangeWithSheetWithCache(l.token),{range:L,unitId:N,sheetName:T}=p,A=this._univerInstanceService.getUnit(N||e),C=T?A==null?void 0:A.getSheetBySheetName(T):A==null?void 0:A.getSheetBySheetId(a);if(!C)return;const R=A.getUnitId(),d=C.getSheetId(),S={unitId:R,subUnitId:d,range:L,sheetName:T};o.set(l.token,S),f.add(this._refRangeService.registerRefRange(L,m,R,d))}}),f}_getFormulaDependcy(e,a,n,i){const o=c.isFormulaString(n)?this._lexerTreeBuilder.sequenceNodesBuilder(n):null,u=[];return o==null||o.forEach(f=>{if(typeof f=="object"&&f.nodeType===t.sequenceNodeType.REFERENCE){const m=t.deserializeRangeWithSheetWithCache(f.token),{range:l,unitId:p,sheetName:L}=m;if(l.startAbsoluteRefType===c.AbsoluteRefType.ALL&&l.endAbsoluteRefType===c.AbsoluteRefType.ALL)return;const N=this._univerInstanceService.getUnit(p||e),T=L?N==null?void 0:N.getSheetBySheetName(L):N==null?void 0:N.getSheetBySheetId(a);if(!T)return;const A=N.getUnitId(),C=T.getSheetId(),R=i[0].startRow,d=i[0].startColumn,S=l.startRow,E=l.startColumn,I=i.map(O=>({startRow:O.startRow-R+S,endRow:O.endRow-R+S,startColumn:O.startColumn-d+E,endColumn:O.endColumn-d+E}));u.push({unitId:A,subUnitId:C,ranges:I})}}),u}registerRangeFormula(e,a,n,i,o){const u=new c.DisposableCollection,f=i.map(l=>this._getFormulaDependcy(e,a,l,n)),m=l=>{const p=n[0].startRow,L=n[0].startColumn,N=[{unitId:e,subUnitId:a,ranges:n},...f.flat()],T=[],A=s.getSeparateEffectedRangesOnCommand(this._injector,l);for(const{unitId:C,subUnitId:R,ranges:d}of N)if(C===A.unitId&&R===A.subUnitId){const S=[],E=d[0].startRow,I=d[0].startColumn,O=E-p,D=I-L;for(const U of A.ranges){const M=d.map(x=>c.getIntersectRange(U,x)).filter(Boolean);M.length>0&&S.push(...M)}S.length>0&&T.push(S.map(U=>({startRow:U.startRow-O,endRow:U.endRow-O,startColumn:U.startColumn-D,endColumn:U.endColumn-D})))}if(T.length>0){const C=c.Rectangle.splitIntoGrid([...T.flat()]),R=c.Rectangle.subtractMulti(n,C);R.sort((O,D)=>O.startRow-D.startRow||O.startColumn-D.startColumn);const d=new Map;for(let O=0;O<C.length;O++){const D=C[O],U=D.startRow,M=D.startColumn,x=U-p,y=M-L,q=s.handleCommonDefaultRangeChangeWithEffectRefCommands(D,l).sort((V,H)=>V.startRow-H.startRow||V.startColumn-H.startColumn);if(!q.length)continue;const F=q[0].startRow,_=q[0].startColumn,B=F-p,k=_-L,Q=[];for(let V=0;V<i.length;V++){const H=i[V],w=c.isFormulaString(H),It=w?this._lexerTreeBuilder.moveFormulaRefOffset(H,y,x):H,G=w?this.transformFormulaByEffectCommand(e,a,It,l):It,Ut=Xt(this._lexerTreeBuilder,G,-k,-B);Q.push({newFormula:G,orginFormula:Ut})}const j={formulas:Q,ranges:q,key:Q.map(V=>V.orginFormula).join("_")};d.has(j.key)?d.get(j.key).push(j):d.set(j.key,[j])}const S=i.map(O=>Xt(this._lexerTreeBuilder,O,0,0)).join("_");if(R.length>0){const O=R[0].startRow,D=R[0].startColumn,U=[];for(let x=0;x<i.length;x++){const y=i[x];U.push({newFormula:c.isFormulaString(y)?this._lexerTreeBuilder.moveFormulaRefOffset(y,D-L,O-p):y,orginFormula:y})}const M={formulas:U,ranges:R,key:S};d.has(M.key)?d.get(M.key).push(M):d.set(M.key,[M])}const E=[],I=Array.from(d.keys());for(let O=I.length-1;O>=0;O--){const D=I[O],U=d.get(D).sort((y,q)=>y.ranges[0].startRow-q.ranges[0].startRow||y.ranges[0].startColumn-q.ranges[0].startColumn),M=[];for(let y=0;y<U[0].formulas.length;y++)M.push(U[0].formulas[y].newFormula);const x=c.Rectangle.mergeRanges(U.map(y=>y.ranges).flat());x.sort((y,q)=>y.startRow-q.startRow||y.startColumn-q.startColumn),E.push({formulas:M,ranges:x})}return o(E)}return{undos:[],redos:[]}};return n.forEach(l=>{const p=this._refRangeService.registerRefRange(l,m,e,a);u.add(p)}),[...f.flat()].forEach(({unitId:l,subUnitId:p,ranges:L})=>{L.forEach(N=>{const T=this._refRangeService.registerRefRange(N,m,l,p);u.add(T)})}),u}},P.FormulaRefRangeService=Ia([Tt(0,c.Inject(s.RefRangeService)),Tt(1,c.Inject(t.LexerTreeBuilder)),Tt(2,c.IUniverInstanceService),Tt(3,c.Inject(c.Injector))],P.FormulaRefRangeService);var Aa=Object.getOwnPropertyDescriptor,Sa=(r,e,a,n)=>{for(var i=n>1?void 0:n?Aa(e,a):e,o=r.length-1,u;o>=0;o--)(u=r[o])&&(i=u(i)||i);return i},Ca=(r,e)=>(a,n)=>e(a,n,r);const yt="sheets-formula.remote-register-function.service",xt=c.createIdentifier(yt);P.RemoteRegisterFunctionService=class{constructor(e){this._functionService=e}async registerFunctions(e){const a=e.map(([n,i])=>Ra(n,i));this._functionService.registerExecutors(...a)}async registerAsyncFunctions(e){const a=e.map(([n,i])=>Oa(n,i));this._functionService.registerExecutors(...a)}async unregisterFunctions(e){this._functionService.unregisterExecutors(...e),this._functionService.unregisterDescriptions(...e),this._functionService.deleteFormulaAstCacheKey(...e)}},P.RemoteRegisterFunctionService=Sa([Ca(0,t.IFunctionService)],P.RemoteRegisterFunctionService);function Ra(r,e){const a=new t.CustomFunction(e),n=new Function(`return ${r}`)();return a.calculateCustom=n,a}function Oa(r,e){const a=new t.AsyncCustomFunction(e),n=new Function(`return ${r}`)();return a.calculateCustom=n,a}var _a=Object.getOwnPropertyDescriptor,Ma=(r,e,a,n)=>{for(var i=n>1?void 0:n?_a(e,a):e,o=r.length-1,u;o>=0;o--)(u=r[o])&&(i=u(i)||i);return i},Nt=(r,e)=>(a,n)=>e(a,n,r);const gt=c.createIdentifier("sheets-formula.register-function-service");P.RegisterFunctionService=class extends c.Disposable{constructor(e,a,n,i){super(),this._localeService=e,this._descriptionService=a,this._functionService=n,this._remoteRegisterFunctionService=i}registerFunction(e){return this._registerSingleFunction(e)}registerAsyncFunction(e){return this._registerSingleFunction({...e,async:!0})}registerFunctions(e){const{locales:a,description:n,calculate:i}=e;a&&this._localeService.load(a);const o=new c.DisposableCollection;if(n)o.add(this._descriptionService.registerDescriptions(n));else{const u=i.map(([f,m,l])=>({functionName:m,functionType:t.FunctionType.User,description:"",abstract:l||"",functionParameter:[]}));o.add(this._functionService.registerDescriptions(...u))}return o.add(this._registerLocalExecutors(i)),this._remoteRegisterFunctionService&&o.add(this._registerRemoteExecutors(i)),o}_registerSingleFunction(e){const{name:a,func:n,description:i,locales:o,async:u=!1}=e,f=new c.DisposableCollection;if(o&&this._localeService.load(o),typeof i=="string"){const l={functionName:a,functionType:t.FunctionType.User,description:i,abstract:i||"",functionParameter:[]};f.add(this._descriptionService.registerDescriptions([l]))}else f.add(this._descriptionService.registerDescriptions([i]));const m=u?new t.AsyncCustomFunction(a):new t.CustomFunction(a);return m.calculateCustom=n,this._functionService.registerExecutors(m),f.add(c.toDisposable(()=>this._functionService.unregisterExecutors(a))),f.add(c.toDisposable(()=>this._functionService.unregisterDescriptions(a))),f.add(c.toDisposable(()=>this._functionService.deleteFormulaAstCacheKey(a))),this._remoteRegisterFunctionService&&(this._remoteRegisterFunctionService.registerAsyncFunctions([[n.toString(),a]]),f.add(c.toDisposable(()=>this._remoteRegisterFunctionService.unregisterFunctions([a])))),f}_registerLocalExecutors(e){const a=e.map(([i,o])=>o),n=e.map(([i,o])=>{const u=new t.CustomFunction(o);return u.calculateCustom=i,u});return this._functionService.registerExecutors(...n),c.toDisposable(()=>this._functionService.unregisterExecutors(...a))}_registerRemoteExecutors(e){const a=[],n=e.map(([i,o])=>(a.push(o),[i.toString(),o]));return this._remoteRegisterFunctionService.registerFunctions(n),c.toDisposable(()=>this._remoteRegisterFunctionService.unregisterFunctions(a))}},P.RegisterFunctionService=Ma([Nt(0,c.Inject(c.LocaleService)),Nt(1,c.Inject(rt)),Nt(2,t.IFunctionService),Nt(3,c.Optional(xt))],P.RegisterFunctionService);var Da=Object.defineProperty,ba=Object.getOwnPropertyDescriptor,ya=(r,e,a)=>e in r?Da(r,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[e]=a,Wt=(r,e,a,n)=>{for(var i=n>1?void 0:n?ba(e,a):e,o=r.length-1,u;o>=0;o--)(u=r[o])&&(i=u(i)||i);return i},Pt=(r,e)=>(a,n)=>e(a,n,r),Et=(r,e,a)=>ya(r,typeof e!="symbol"?e+"":e,a);P.UniverRemoteSheetsFormulaPlugin=class extends c.Plugin{constructor(e=Bt,a,n){super(),this._config=e,this._injector=a,this._configService=n;const{...i}=c.merge({},Bt,this._config);this._configService.setConfig(Kt,i)}onStarting(){this._injector.add([P.RemoteRegisterFunctionService]),this._injector.get(ut.IRPCChannelService).registerChannel(yt,ut.fromModule(this._injector.get(P.RemoteRegisterFunctionService)))}},Et(P.UniverRemoteSheetsFormulaPlugin,"pluginName","SHEET_FORMULA_REMOTE_PLUGIN"),Et(P.UniverRemoteSheetsFormulaPlugin,"type",c.UniverInstanceType.UNIVER_SHEET),P.UniverRemoteSheetsFormulaPlugin=Wt([c.DependentOn(t.UniverFormulaEnginePlugin),Pt(1,c.Inject(c.Injector)),Pt(2,c.IConfigService)],P.UniverRemoteSheetsFormulaPlugin),P.UniverSheetsFormulaPlugin=class extends c.Plugin{constructor(e=Ft,a,n){super(),this._config=e,this._injector=a,this._configService=n;const{...i}=c.merge({},Ft,this._config);this._configService.setConfig(Z,i,{merge:!0})}onStarting(){const e=this._injector,a=[[gt,{useClass:P.RegisterFunctionService}],[rt,{useClass:P.DescriptionService}],[pt],[P.FormulaRefRangeService],[P.RegisterOtherFormulaService],[mt],[P.ImageFormulaCellInterceptorController],[P.TriggerCalculationController],[P.UpdateFormulaController],[ft],[lt],[P.UpdateDefinedNameController],[Lt]];if(this._config.notExecuteFormula){const n=e.get(ut.IRPCChannelService);a.push([xt,{useFactory:()=>ut.toModule(n.requestChannel(yt))}])}a.forEach(n=>e.add(n))}onReady(){c.touchDependencies(this._injector,[[pt],[ft],[mt],[P.ImageFormulaCellInterceptorController],[P.UpdateFormulaController],[P.UpdateDefinedNameController]]),c.isNodeEnv()&&c.touchDependencies(this._injector,[[P.TriggerCalculationController]])}onRendered(){c.touchDependencies(this._injector,[[lt],[Lt]]),c.isNodeEnv()||c.touchDependencies(this._injector,[[P.TriggerCalculationController]])}},Et(P.UniverSheetsFormulaPlugin,"pluginName",Ye),Et(P.UniverSheetsFormulaPlugin,"type",c.UniverInstanceType.UNIVER_SHEET),P.UniverSheetsFormulaPlugin=Wt([c.DependentOn(t.UniverFormulaEnginePlugin,s.UniverSheetsPlugin),Pt(1,c.Inject(c.Injector)),Pt(2,c.IConfigService)],P.UniverSheetsFormulaPlugin);function xa(r,e,a,n){const i=r.get(t.IFormulaCurrentConfigService),o=r.get(t.Lexer),u=r.get(t.AstTreeBuilder),f=r.get(t.Interpreter);i.load({formulaData:{},arrayFormulaCellData:{},arrayFormulaRange:{},forceCalculate:!1,dirtyRanges:[],dirtyNameMap:{},dirtyDefinedNameMap:{},dirtyUnitFeatureMap:{},excludedCell:{},allUnitData:{[a]:n},dirtyUnitOtherFormulaMap:{}});const m=o.treeBuilder(e),l=u.parse(m),p=f.execute(t.generateExecuteAstNodeData(l));return t.getObjectValue(p)}P.CalculationMode=X,P.IDescriptionService=rt,P.IRegisterFunctionService=gt,P.IRemoteRegisterFunctionService=xt,P.InsertFunctionCommand=qt,P.OtherFormulaMarkDirty=z,P.PLUGIN_CONFIG_KEY_BASE=Z,P.QuickSumCommand=ht,P.calculateFormula=xa,Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})}));


// @univerjs/sheets-formula/facade
(function(t,l){typeof exports=="object"&&typeof module<"u"?l(require("@univerjs/core"),require("@univerjs/core/facade"),require("@univerjs/engine-formula"),require("@univerjs/sheets-formula"),require("@univerjs/engine-formula/facade"),require("@univerjs/sheets/facade")):typeof define=="function"&&define.amd?define(["@univerjs/core","@univerjs/core/facade","@univerjs/engine-formula","@univerjs/sheets-formula","@univerjs/engine-formula/facade","@univerjs/sheets/facade"],l):(t=typeof globalThis<"u"?globalThis:t||self,l(t.UniverCore,t.UniverCoreFacade,t.UniverEngineFormula,t.UniverSheetsFormula,t.UniverEngineFormulaFacade,t.UniverSheetsFacade))})(this,(function(t,l,g,i,x,m){"use strict";class k extends l.FUniver{_initialize(){this._debouncedFormulaCalculation=t.debounce(()=>{this._commandService.executeCommand(g.SetFormulaCalculationStartMutation.id,{commands:[],forceCalculation:!0},{onlyLocal:!0})},10)}registerFunction(n){let c=this._injector.get(i.IRegisterFunctionService);c||(this._injector.add([i.IRegisterFunctionService,{useClass:i.RegisterFunctionService}]),c=this._injector.get(i.IRegisterFunctionService));const e=c.registerFunctions(n);return this._debouncedFormulaCalculation(),e}}l.FUniver.extend(k);class R extends x.FFormula{_initialize(){this._debouncedFormulaCalculation=t.debounce(()=>{this._commandService.executeCommand(g.SetFormulaCalculationStartMutation.id,{commands:[],forceCalculation:!0},{onlyLocal:!0})},10)}setInitialFormulaComputing(n){const e=this._injector.get(t.LifecycleService).stage,o=this._injector.get(t.ILogService),s=this._injector.get(t.IConfigService);e>t.LifecycleStages.Starting&&o.warn("[FFormula]","CalculationMode is called after the Starting lifecycle and will take effect the next time the Univer Sheet is constructed. If you want it to take effect when the Univer Sheet is initialized this time, consider calling it before the Ready lifecycle or using configuration.");const r=s.getConfig(i.PLUGIN_CONFIG_KEY_BASE);if(!r){s.setConfig(i.PLUGIN_CONFIG_KEY_BASE,{initialFormulaComputing:n});return}r.initialFormulaComputing=n}registerFunction(n,c,e){var a;let o=this._injector.get(i.IRegisterFunctionService);o||(this._injector.add([i.IRegisterFunctionService,{useClass:i.RegisterFunctionService}]),o=this._injector.get(i.IRegisterFunctionService));const s={name:n,func:c,description:typeof e=="string"?e:(a=e==null?void 0:e.description)!=null?a:"",locales:typeof e=="object"?e.locales:void 0},r=o.registerFunction(s);return this._debouncedFormulaCalculation(),r}registerAsyncFunction(n,c,e){var a;let o=this._injector.get(i.IRegisterFunctionService);o||(this._injector.add([i.IRegisterFunctionService,{useClass:i.RegisterFunctionService}]),o=this._injector.get(i.IRegisterFunctionService));const s={name:n,func:c,description:typeof e=="string"?e:(a=e==null?void 0:e.description)!=null?a:"",locales:typeof e=="object"?e.locales:void 0},r=o.registerAsyncFunction(s);return this._debouncedFormulaCalculation(),r}}x.FFormula.extend(R);class b{get CalculationMode(){return i.CalculationMode}}l.FEnum.extend(b);class E extends m.FWorkbook{getAllFormulaError(){const n=[],c=this._workbook,e=c.getUnitId(),o=c.getSheets(),s=this._injector.get(g.FormulaDataModel).getArrayFormulaCellData();return o.forEach(r=>{var C;const a=r.getName(),j=r.getSheetId(),I=r.getCellMatrix(),F=((C=s==null?void 0:s[e])==null?void 0:C[j])||{};I.forValue((_,h,f)=>{var v;if(!f)return;const d=(v=F==null?void 0:F[_])==null?void 0:v[h],u=g.extractFormulaError(f,!!d);u&&n.push({sheetName:a,row:_,column:h,formula:f.f||"",errorType:u})})}),n}}m.FWorkbook.extend(E);class U extends m.FRange{getFormulaError(){var h,f;const n=[],c=this._workbook.getUnitId(),e=this._worksheet.getSheetId(),o=this._worksheet.getName(),s=this._workbook.getSheetBySheetId(e);if(!s)return n;const r=this._injector.get(g.FormulaDataModel).getArrayFormulaCellData(),a=((h=r==null?void 0:r[c])==null?void 0:h[e])||{},j=s.getCellMatrix(),{startRow:I,endRow:F,startColumn:C,endColumn:_}=this._range;for(let d=I;d<=F;d++)for(let u=C;u<=_;u++){const v=j.getValue(d,u);if(!v)continue;const M=(f=a==null?void 0:a[d])==null?void 0:f[u],y=g.extractFormulaError(v,!!M);y&&n.push({sheetName:o,row:d,column:u,formula:v.f||"",errorType:y})}return n}}m.FRange.extend(U)}));


// @univerjs/sheets-formula-ui/index
(function($,a){typeof exports=="object"&&typeof module<"u"?a(exports,require("@univerjs/core"),require("@univerjs/sheets-ui"),require("@univerjs/engine-formula"),require("rxjs"),require("@univerjs/docs-ui"),require("@univerjs/engine-render"),require("@univerjs/sheets"),require("@univerjs/sheets-formula"),require("@univerjs/ui"),require("react/jsx-runtime"),require("react"),require("@univerjs/design"),require("@univerjs/docs"),require("rxjs/operators")):typeof define=="function"&&define.amd?define(["exports","@univerjs/core","@univerjs/sheets-ui","@univerjs/engine-formula","rxjs","@univerjs/docs-ui","@univerjs/engine-render","@univerjs/sheets","@univerjs/sheets-formula","@univerjs/ui","react/jsx-runtime","react","@univerjs/design","@univerjs/docs","rxjs/operators"],a):($=typeof globalThis<"u"?globalThis:$||self,a($.UniverSheetsFormulaUi={},$.UniverCore,$.UniverSheetsUi,$.UniverEngineFormula,$.rxjs,$.UniverDocsUi,$.UniverEngineRender,$.UniverSheets,$.UniverSheetsFormula,$.UniverUi,$.React,$.React,$.UniverDesign,$.UniverDocs,$.rxjs.operators))})(this,(function($,a,N,R,q,Q,j,x,ge,l,y,E,B,pt,tn){"use strict";var lo=Object.defineProperty;var uo=($,a,N)=>a in $?lo($,a,{enumerable:!0,configurable:!0,writable:!0,value:N}):$[a]=N;var Y=($,a,N)=>uo($,typeof a!="symbol"?a+"":a,N);const We={id:"sheet.command.copy-formula-only",type:a.CommandType.COMMAND,handler:async e=>e.get(N.ISheetClipboardService).copy({copyHookType:N.PREDEFINED_HOOK_NAME_COPY.SPECIAL_COPY_FORMULA_ONLY})},Ue={id:"sheet.command.paste-formula",type:a.CommandType.COMMAND,handler:async e=>e.get(a.ICommandService).executeCommand(N.SheetPasteCommand.id,{value:N.PREDEFINED_HOOK_NAME_PASTE.SPECIAL_PASTE_FORMULA})},Ee={id:"formula-ui.operation.select-editor-formula",type:a.CommandType.OPERATION,handler:(e,t)=>!0};var nn=Object.getOwnPropertyDescriptor,rn=(e,t,n,o)=>{for(var r=o>1?void 0:o?nn(t,n):t,s=e.length-1,i;s>=0;s--)(i=e[s])&&(r=i(r)||r);return r},on=(e,t)=>(n,o)=>t(n,o,e);const vt="FORMULA_PROMPT_ACTIVATED",Ve=a.createIdentifier("formula-ui.prompt-service");let st=class{constructor(e){Y(this,"_search$",new q.Subject);Y(this,"_help$",new q.Subject);Y(this,"_navigate$",new q.Subject);Y(this,"_accept$",new q.Subject);Y(this,"_acceptFormulaName$",new q.Subject);Y(this,"search$",this._search$.asObservable());Y(this,"help$",this._help$.asObservable());Y(this,"navigate$",this._navigate$.asObservable());Y(this,"accept$",this._accept$.asObservable());Y(this,"acceptFormulaName$",this._acceptFormulaName$.asObservable());Y(this,"_searching",!1);Y(this,"_helping",!1);Y(this,"_sequenceNodes",[]);Y(this,"_isLockedOnSelectionChangeRefString",!1);Y(this,"_isLockedOnSelectionInsertRefString",!1);this._contextService=e}dispose(){this._search$.complete(),this._help$.complete(),this._navigate$.complete(),this._accept$.complete(),this._acceptFormulaName$.complete(),this._sequenceNodes=[]}search(e){this._contextService.setContextValue(vt,e.visible),this._searching=e.visible,this._search$.next(e)}isSearching(){return this._searching}help(e){this._helping=e.visible,this._help$.next(e)}isHelping(){return this._helping}navigate(e){this._navigate$.next(e)}accept(e){this._accept$.next(e)}acceptFormulaName(e){this._acceptFormulaName$.next(e)}getSequenceNodes(){return[...this._sequenceNodes]}setSequenceNodes(e){this._sequenceNodes=e}clearSequenceNodes(){this._sequenceNodes=[]}getCurrentSequenceNode(e){return this._sequenceNodes[this.getCurrentSequenceNodeIndex(e)]}getCurrentSequenceNodeByIndex(e){return this._sequenceNodes[e]}getCurrentSequenceNodeIndex(e){let t=0;const n=this._sequenceNodes[0];for(let o=0,r=this._sequenceNodes.length;o<r;o++){const s=this._sequenceNodes[o];if(typeof s=="string")t++;else{const{endIndex:i}=s;t=i}if(e<=t)return typeof n=="string"&&e!==0?o+1:o}return this._sequenceNodes.length}updateSequenceRef(e,t){const n=this._sequenceNodes[e];if(typeof n=="string"||n.nodeType!==R.sequenceNodeType.REFERENCE)return;const o=t.length-n.token.length,r={...n};r.token=t,r.endIndex+=o,this._sequenceNodes[e]=r;for(let s=e+1,i=this._sequenceNodes.length;s<i;s++){const c=this._sequenceNodes[s];if(typeof c=="string")continue;const d={...c};d.startIndex+=o,d.endIndex+=o,this._sequenceNodes[s]=d}}insertSequenceRef(e,t){const n=t.length,o=this.getCurrentSequenceNodeIndex(e);this._sequenceNodes.splice(o,0,{token:t,startIndex:e,endIndex:e+n-1,nodeType:R.sequenceNodeType.REFERENCE});for(let r=o+1,s=this._sequenceNodes.length;r<s;r++){const i=this._sequenceNodes[r];if(typeof i=="string")continue;const c={...i};c.startIndex+=n,c.endIndex+=n,this._sequenceNodes[r]=c}}insertSequenceString(e,t){const n=this.getCurrentSequenceNodeIndex(e),o=t.split("");this._sequenceNodes.splice(n,0,...o);const r=o.length;for(let s=n+r,i=this._sequenceNodes.length;s<i;s++){const c=this._sequenceNodes[s];if(typeof c=="string")continue;const d={...c};d.startIndex+=r,d.endIndex+=r,this._sequenceNodes[s]=d}}enableLockedSelectionChange(){this._isLockedOnSelectionChangeRefString=!0}disableLockedSelectionChange(){this._isLockedOnSelectionChangeRefString=!1}isLockedSelectionChange(){return this._isLockedOnSelectionChangeRefString}enableLockedSelectionInsert(){this._isLockedOnSelectionInsertRefString=!0}disableLockedSelectionInsert(){this._isLockedOnSelectionInsertRefString=!1}isLockedSelectionInsert(){return this._isLockedOnSelectionInsertRefString}};st=rn([on(0,a.IContextService)],st);const mt={id:"formula-ui.operation.help-function",type:a.CommandType.OPERATION,handler:async(e,t)=>(e.get(Ve).help(t),!0)},ce={id:"formula-ui.operation.insert-function",type:a.CommandType.OPERATION,handler:async(e,t)=>{var I,T;const n=e.get(x.SheetsSelectionsService),o=e.get(Q.IEditorService),r=n.getCurrentSelections();if(!r||!r.length)return!1;const s=x.getSheetCommandTarget(e.get(a.IUniverInstanceService));if(!s)return!1;const{worksheet:i,unitId:c,subUnitId:d}=s,f=i.getCellMatrix(),{value:S}=t,p=e.get(a.ICommandService);e.get(N.IEditorBridgeService);const h=[],g=[];let u=null,m=0,C=0,_="";if(r.length===1&&(an(r[0].range)||ln(r[0].range)&&_t(f,r[0].range))){const{range:D,primary:v}=r[0],M=(I=v==null?void 0:v.actualRow)!=null?I:D.startRow,w=(T=v==null?void 0:v.actualColumn)!=null?T:D.startColumn;u=D,m=M,C=w;const W=Ct(f,M,w);W&&(_=R.serializeRange(W))}else r.some(D=>{var w,W;const{range:v,primary:M}=D;if(_t(f,v)){const U=(w=M==null?void 0:M.actualRow)!=null?w:v.startRow,P=(W=M==null?void 0:M.actualColumn)!=null?W:v.startColumn,F=Ct(f,U,P);if(!F)return u=v,m=U,C=P,!0;const A=R.serializeRange(F),O=`=${S}(${A})`;h.push({range:v,primary:{row:U,column:P},formula:O})}else{const{startRow:U,startColumn:P,endRow:F,endColumn:A}=v;if(U===F){const O=un(f,U,A,i.getColumnCount()-1),L=O===A?A-1:A,b=R.serializeRange({startRow:U,endRow:F,startColumn:P,endColumn:L}),k=`=${S}(${b})`;g.push({range:v,primary:{row:U,column:O},formula:k})}else{let O=-1;for(let b=P;b<=A;b++){const k=dn(f,b,F,i.getRowCount()-1);O=Math.max(O,k)}const L=O===F?F-1:F;for(let b=P;b<=A;b++){const k=R.serializeRange({startRow:U,endRow:L,startColumn:b,endColumn:b}),V=`=${S}(${k})`;g.push({range:v,primary:{row:O,column:b},formula:V})}}}return!1});if(u){const D=x.getCellAtRowCol(m,C,i),v={range:a.Rectangle.clone(u),primary:{startRow:D.startRow,startColumn:D.startColumn,endRow:D.endRow,endColumn:D.endColumn,actualRow:m,actualColumn:C,isMerged:D.isMerged,isMergedMainCell:D.startRow===m&&D.startColumn===C}},M={unitId:c,subUnitId:d,selections:[v]};await p.executeCommand(x.SetSelectionsOperation.id,M);const w=o.getEditor(a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY),W=o.getEditor(a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY);p.syncExecuteCommand(N.SetCellEditVisibleOperation.id,{visible:!0,unitId:c,eventType:j.DeviceInputEventType.Dblclick});const U=`=${S}(${_}`;w==null||w.replaceText(U),W==null||W.replaceText(U,!1)}return h.length===0&&g.length===0?!1:p.executeCommand(ge.InsertFunctionCommand.id,{list:h,listOfRangeHasNumber:g})}};function Ct(e,t,n){const o=sn(e,t,n);if(o!==t)return{startRow:o,endRow:t-1,startColumn:n,endColumn:n};const r=cn(e,t,n);return r!==n?{startRow:t,endRow:t,startColumn:r,endColumn:n-1}:null}function sn(e,t,n){let o=!1;if(t===0)return t;for(let r=t-1;r>=0;r--){const s=e.getValue(r,n);if(xe(s)&&!o){if(r===0)return 0;o=!0}else{if(o&&!xe(s))return r+1;if(o&&r===0)return 0}}return t}function cn(e,t,n){let o=!1;if(n===0)return n;for(let r=n-1;r>=0;r--){const s=e.getValue(t,r);if(xe(s)&&!o){if(r===0)return 0;o=!0}else{if(o&&!xe(s))return r+1;if(o&&r===0)return 0}}return n}function xe(e){if(e!=null&&e.p){const t=e==null?void 0:e.p.body;if(t==null)return!1;const n=t.dataStream,r=n.substring(n.length-2,n.length)===a.DEFAULT_EMPTY_DOCUMENT_VALUE?n.substring(0,n.length-2):n;return a.isRealNum(r)}return e&&(e.t===a.CellValueType.NUMBER||a.getCellValueType(e)===a.CellValueType.NUMBER)}function an(e){return e.startRow===e.endRow&&e.startColumn===e.endColumn}function ln(e){return e.startRow!==e.endRow&&e.startColumn!==e.endColumn}function _t(e,t){for(let n=t.startRow;n<=t.endRow;n++)for(let o=t.startColumn;o<=t.endColumn;o++)if(xe(e.getValue(n,o)))return!1;return!0}function un(e,t,n,o){for(let r=n;r<=o;r++)if(!e.getValue(t,r))return r;return o}function dn(e,t,n,o){for(let r=n;r<=o;r++)if(!e.getValue(r,t))return r;return o}const Et="SHEET_FORMULA_UI_PLUGIN",It=`${Et}_MORE_FUNCTIONS_COMPONENT`,He={id:"formula-ui.operation.more-functions",type:a.CommandType.OPERATION,handler:async e=>(e.get(l.ISidebarService).open({header:{title:"formula.insert.tooltip"},children:{label:It}}),!0)},it={id:"formula-ui.operation.change-ref-to-absolute",type:a.CommandType.OPERATION,handler:async e=>!0},yt={id:"formula-ui.operation.search-function",type:a.CommandType.OPERATION,handler:async(e,t)=>(e.get(Ve).search(t),!0)};var fn=Object.getOwnPropertyDescriptor,hn=(e,t,n,o)=>{for(var r=o>1?void 0:o?fn(t,n):t,s=e.length-1,i;s>=0;s--)(i=e[s])&&(r=i(r)||r);return r},Be=(e,t)=>(n,o)=>t(n,o,e);$.FormulaReorderController=class extends a.Disposable{constructor(t,n,o,r){super(),this._sheetInterceptorService=t,this._univerInstanceService=n,this._formulaDataModel=o,this._lexerTreeBuilder=r,this._initialize()}_initialize(){this.disposeWithMe(this._sheetInterceptorService.interceptCommand({getMutations:t=>t.id===x.ReorderRangeCommand.id?this._reorderFormula(t.params):{redos:[],undos:[]}}))}_reorderFormula(t){const n=[],o=[],{unitId:r,subUnitId:s,range:i,order:c}=t,d=this._univerInstanceService.getUniverSheetInstance(r),f=d==null?void 0:d.getSheetBySheetId(s);if(!f)return{redos:n,undos:o};const S=f.getCellMatrix(),p=new a.ObjectMatrix,h=new a.ObjectMatrix;let g=!1;return a.Range.foreach(i,(u,m)=>{let C=u;c.hasOwnProperty(u)&&(C=c[u]);const _=S.getValue(C,m);if(_!=null&&_.f||_!=null&&_.si){g=!0;const I=this._formulaDataModel.getFormulaStringByCell(C,m,s,r),T=this._lexerTreeBuilder.moveFormulaRefOffset(I,0,u-C),D=a.Tools.deepClone(_);D.f=T,D.si=null,p.setValue(u,m,D)}else p.setValue(u,m,_);h.setValue(u,m,S.getValue(u,m))}),g?(n.push({id:x.SetRangeValuesMutation.id,params:{unitId:r,subUnitId:s,cellValue:p.getMatrix()}}),o.push({id:x.SetRangeValuesMutation.id,params:{unitId:r,subUnitId:s,cellValue:h.getMatrix()}}),{redos:n,undos:o}):{redos:n,undos:o}}},$.FormulaReorderController=hn([Be(0,a.Inject(x.SheetInterceptorService)),Be(1,a.Inject(a.IUniverInstanceService)),Be(2,a.Inject(R.FormulaDataModel)),Be(3,a.Inject(R.LexerTreeBuilder))],$.FormulaReorderController);const Rt="sheets-formula-ui.base.config",Tt={};var gn=Object.getOwnPropertyDescriptor,Sn=(e,t,n,o)=>{for(var r=o>1?void 0:o?gn(t,n):t,s=e.length-1,i;s>=0;s--)(i=e[s])&&(r=i(r)||r);return r},Pe=(e,t)=>(n,o)=>t(n,o,e);const ct="SHEET_FORMULA_ALERT",pn={[R.ErrorType.DIV_BY_ZERO]:"divByZero",[R.ErrorType.NAME]:"name",[R.ErrorType.VALUE]:"value",[R.ErrorType.NUM]:"num",[R.ErrorType.NA]:"na",[R.ErrorType.CYCLE]:"cycle",[R.ErrorType.REF]:"ref",[R.ErrorType.SPILL]:"spill",[R.ErrorType.CALC]:"calc",[R.ErrorType.ERROR]:"error",[R.ErrorType.CONNECT]:"connect",[R.ErrorType.NULL]:"null"};let at=class extends a.Disposable{constructor(e,t,n,o,r,s){super(),this._context=e,this._hoverManagerService=t,this._cellAlertManagerService=n,this._localeService=o,this._formulaDataModel=r,this._zenZoneService=s,this._init()}_init(){this._initCellAlertPopup(),this._initZenService()}_initCellAlertPopup(){this.disposeWithMe(this._hoverManagerService.currentCell$.pipe(q.debounceTime(100)).subscribe(e=>{var t,n,o,r,s;if(e){const c=this._context.unit.getActiveSheet();if(!c)return this._hideAlert();const d=c.getCell(e.location.row,e.location.col),f=(r=(o=(n=(t=this._formulaDataModel.getArrayFormulaCellData())==null?void 0:t[e.location.unitId])==null?void 0:n[e.location.subUnitId])==null?void 0:o[e.location.row])==null?void 0:r[e.location.col];if(a.isICellData(d)){const S=R.extractFormulaError(d,!!f);if(!S){this._hideAlert();return}const p=this._cellAlertManagerService.currentAlert.get(ct),h=(s=p==null?void 0:p.alert)==null?void 0:s.location;if(h&&h.row===e.location.row&&h.col===e.location.col&&h.subUnitId===e.location.subUnitId&&h.unitId===e.location.unitId){this._hideAlert();return}this._cellAlertManagerService.showAlert({type:N.CellAlertType.ERROR,title:this._localeService.t("formula.error.title"),message:this._localeService.t(`formula.error.${pn[S]}`),location:e.location,width:200,height:74,key:ct});return}}this._hideAlert()}))}_initZenService(){this.disposeWithMe(this._zenZoneService.visible$.subscribe(e=>{e&&this._hideAlert()}))}_hideAlert(){this._cellAlertManagerService.removeAlert(ct)}};at=Sn([Pe(1,a.Inject(N.HoverManagerService)),Pe(2,a.Inject(N.CellAlertManagerService)),Pe(3,a.Inject(a.LocaleService)),Pe(4,a.Inject(R.FormulaDataModel)),Pe(5,l.IZenZoneService)],at);var vn=Object.getOwnPropertyDescriptor,mn=(e,t,n,o)=>{for(var r=o>1?void 0:o?vn(t,n):t,s=e.length-1,i;s>=0;s--)(i=e[s])&&(r=i(r)||r);return r},bt=(e,t)=>(n,o)=>t(n,o,e);let Ke=class extends a.Disposable{constructor(e,t){super(),this._autoFillService=e,this._lexerTreeBuilder=t,this._registerAutoFill()}_registerAutoFill(){const e={type:N.DATA_TYPE.FORMULA,priority:1001,match:t=>a.isFormulaString(t==null?void 0:t.f)||a.isFormulaId(t==null?void 0:t.si),isContinue:(t,n)=>t.type===N.DATA_TYPE.FORMULA,applyFunctions:{[N.APPLY_TYPE.COPY]:(t,n,o,r,s)=>{const{data:i,index:c}=t;return this._fillCopyFormula(i,n,o,c,r,s)}}};this._autoFillService.registerRule(e)}_fillCopyFormula(e,t,n,o,r,s){var f,S;const i=_n(r),c=[],d=new Map;for(let p=1;p<=t;p++){const h=(p-1)%e.length,g=o[h],u=a.Tools.deepClone(e[h]);if(u){const m=((f=e[h])==null?void 0:f.f)||"",C=((S=e[h])==null?void 0:S.si)||"",_=a.isFormulaString(m);if(a.isFormulaId(C))u.si=C,u.f=null,u.v=null,u.p=null,u.t=null,c.push(u);else if(_){let T=d.get(h);if(T)u.si=T,u.f=null,u.v=null,u.p=null,u.t=null;else{T=a.generateRandomId(6),d.set(h,T);const{offsetX:D,offsetY:v}=Cn(i,t,n,s,g),M=this._lexerTreeBuilder.moveFormulaRefOffset(m,D,v);u.si=T,u.f=M,u.v=null,u.p=null,u.t=null}c.push(u)}}}return c}};Ke=mn([bt(0,N.IAutoFillService),bt(1,a.Inject(R.LexerTreeBuilder))],Ke);function Cn(e,t,n,o,r){const{source:s,target:i}=o,{rows:c}=i,{rows:d}=s;let f=0,S=0;switch(n){case a.Direction.UP:S=c[r]-d[r];break;case a.Direction.RIGHT:f=e;break;case a.Direction.DOWN:S=c[r]-d[r];break;case a.Direction.LEFT:f=-e*t;break}return{offsetX:f,offsetY:S}}function _n(e){let t=0;for(const n in e)e[n].forEach(o=>{t+=o.data.length});return t}var En=Object.getOwnPropertyDescriptor,In=(e,t,n,o)=>{for(var r=o>1?void 0:o?En(t,n):t,s=e.length-1,i;s>=0;s--)(i=e[s])&&(r=i(r)||r);return r},Le=(e,t)=>(n,o)=>t(n,o,e);const yn="default-paste-formula";let je=class extends a.Disposable{constructor(e,t,n,o,r){super(),this._univerInstanceService=e,this._lexerTreeBuilder=t,this._sheetClipboardService=n,this._injector=o,this._formulaDataModel=r,this._initialize()}_initialize(){this._registerClipboardHook()}_registerClipboardHook(){this.disposeWithMe(this._sheetClipboardService.addClipboardHook(this._copyFormulaOnlyHook())),this.disposeWithMe(this._sheetClipboardService.addClipboardHook(this._pasteFormulaHook())),this.disposeWithMe(this._sheetClipboardService.addClipboardHook(this._pasteWithFormulaHook()))}_copyFormulaOnlyHook(){const e=this;let t=null;return{id:N.PREDEFINED_HOOK_NAME_COPY.SPECIAL_COPY_FORMULA_ONLY,priority:10,onBeforeCopy(n,o){t=e._getWorksheet(n,o)},onCopyCellContent(n,o){if(!t)return"";const r=t.getCellRaw(n,o);return r?a.isFormulaString(r.f)?r.f:a.isFormulaId(r.si)&&e._formulaDataModel.getFormulaStringByCell(n,o,t.getSheetId(),t.getUnitId())||"":""},onAfterCopy(){t=null},getFilteredOutRows(n,o,r){const s=e._getWorksheet(n,o);if(!s)return[];const{startRow:i,endRow:c}=r,d=[];for(let f=i;f<=c;f++)s.getRowFiltered(f)&&d.push(f);return d},handleMatrixOnCell(n,o,r,s,i,c,d){const f=i.getValue(n,o);if(t&&f&&(a.isFormulaString(f.f)||a.isFormulaId(f.si))){const S=a.isFormulaString(f.f)?f.f:e._formulaDataModel.getFormulaStringByCell(n,o,t.getSheetId(),t.getUnitId());c.setValue(r,s,{...a.getEmptyCell(),f:S}),d.setValue(r,s,{...a.getEmptyCell(),f:S,displayV:S})}else i.setValue(n,o,a.getEmptyCell()),c.setValue(r,s,a.getEmptyCell()),d.setValue(r,s,a.getEmptyCell())}}}_pasteFormulaHook(){return{id:N.PREDEFINED_HOOK_NAME_PASTE.SPECIAL_PASTE_FORMULA,priority:10,specialPasteInfo:{label:"specialPaste.formula"},onPasteCells:(e,t,n,o)=>this._onPasteCells(e,t,n,o,!0)}}_pasteWithFormulaHook(){return{id:yn,priority:10,onPasteCells:(e,t,n,o)=>this._onPasteCells(e,t,n,o,!1)}}_getWorkbook(e){return e?this._univerInstanceService.getUnit(e,a.UniverInstanceType.UNIVER_SHEET):this._univerInstanceService.getCurrentUnitOfType(a.UniverInstanceType.UNIVER_SHEET)}_getWorksheet(e,t){const n=this._getWorkbook(e);return t?n==null?void 0:n.getSheetBySheetId(t):n==null?void 0:n.getActiveSheet()}_onPasteCells(e,t,n,o,r){var h;if([N.PREDEFINED_HOOK_NAME_PASTE.SPECIAL_PASTE_FORMAT,N.PREDEFINED_HOOK_NAME_PASTE.SPECIAL_PASTE_COL_WIDTH].includes(o.pasteType))return{undos:[],redos:[]};const i=this._getWorkbook(),c=t.unitId||(i==null?void 0:i.getUnitId()),d=t.subUnitId||((h=i==null?void 0:i.getActiveSheet())==null?void 0:h.getSheetId());if(!c||!d)return{undos:[],redos:[]};const f=t.range,S=n,p={copyType:o.copyType||N.COPY_TYPE.COPY,copyRange:e==null?void 0:e.range,pasteType:o.pasteType};return this._injector.invoke(g=>Rn(c,d,f,S,g,p,this._lexerTreeBuilder,this._formulaDataModel,r,e))}};je=In([Le(0,a.IUniverInstanceService),Le(1,a.Inject(R.LexerTreeBuilder)),Le(2,N.ISheetClipboardService),Le(3,a.Inject(a.Injector)),Le(4,a.Inject(R.FormulaDataModel))],je);function Rn(e,t,n,o,r,s,i,c,d=!1,f){const S=[],p=[],h=Tn(e,t,n,o,s,i,c,f);if(!h.hasValue())return{undos:[],redos:[]};const g={unitId:e,subUnitId:t,cellValue:h.getData()};S.push({id:x.SetRangeValuesMutation.id,params:g});const u=x.SetRangeValuesUndoMutationFactory(r,g);return p.push({id:x.SetRangeValuesMutation.id,params:u}),{undos:p,redos:S}}function Tn(e,t,n,o,r,s,i,c){return c?r.pasteType===N.PREDEFINED_HOOK_NAME_PASTE.SPECIAL_PASTE_VALUE?Mn(e,t,n,o,i,c):r.pasteType===N.PREDEFINED_HOOK_NAME_PASTE.SPECIAL_PASTE_FORMULA?On(e,t,n,o,s,i,c):Nn(e,t,n,o,r.copyType,s,i,c):bn(e,t,n,o,i)}function bn(e,t,n,o,r){const s=new a.ObjectMatrix,i=r.getSheetFormulaData(e,t);return o.forValue((c,d,f)=>{var g;const S=n.rows[c],p=n.cols[d],h={};a.isFormulaString(f.v)?(h.v=null,h.f=`${f.v}`,h.si=null,h.p=null,s.setValue(S,p,h)):(g=i==null?void 0:i[S])!=null&&g[p]&&(h.v=f.v,h.f=null,h.si=null,h.p=null,s.setValue(S,p,h))}),s}function Mn(e,t,n,o,r,s){var f,S;const i=new a.ObjectMatrix,c=(S=(f=r.getArrayFormulaCellData())==null?void 0:f[s.unitId])==null?void 0:S[s.subUnitId],d=r.getSheetFormulaData(e,t);return o.forValue((p,h,g)=>{var T,D;const u=s.range.rows[p%s.range.rows.length],m=s.range.cols[h%s.range.cols.length],C=n.rows[p],_=n.cols[h],I={};if(a.isFormulaString(g.f)||a.isFormulaId(g.si))I.v=g.v,I.f=null,I.si=null,I.p=null,i.setValue(C,_,I);else if((T=c==null?void 0:c[u])!=null&&T[m]){const v=c[u][m];I.v=v.v,I.f=null,I.si=null,I.p=null,i.setValue(C,_,I)}else if((D=d==null?void 0:d[C])!=null&&D[_]){if(I.v=g.v,I.f=null,I.si=null,I.p=null,g.p){const v=Mt(g);v&&(I.v=v)}i.setValue(C,_,I)}}),i}function On(e,t,n,o,r,s,i){const c=new a.ObjectMatrix,d=new Map;return o.forValue((f,S,p)=>{const h=n.rows[f],g=n.cols[S],u={};if(a.isFormulaId(p.si)){if(i.unitId!==e||i.subUnitId!==t){const m=s.getFormulaStringByCell(i.range.rows[f%i.range.rows.length],i.range.cols[S%i.range.cols.length],i.subUnitId,i.unitId),C=n.cols[S]-i.range.cols[S%i.range.cols.length],_=n.rows[f]-i.range.rows[f%i.range.rows.length],I=r.moveFormulaRefOffset(m||"",C,_);u.si=null,u.f=I}else u.si=p.si,u.f=null;u.v=null,u.p=null,c.setValue(h,g,u)}else if(a.isFormulaString(p.f)){const m=`${f%i.range.rows.length}_${S%i.range.cols.length}`;let C=d.get(m);if(C)u.si=C,u.f=null;else{C=a.generateRandomId(6),d.set(m,C);const _=n.cols[S]-i.range.cols[S%i.range.cols.length],I=n.rows[f]-i.range.rows[f%i.range.rows.length],T=r.moveFormulaRefOffset(p.f||"",_,I);u.si=C,u.f=T}u.v=null,u.p=null,c.setValue(h,g,u)}else{if(u.v=p.v,u.f=null,u.si=null,u.p=null,p.p){const m=Mt(p);m&&(u.v=m)}c.setValue(h,g,u)}}),c}function Nn(e,t,n,o,r,s,i,c){const d=new a.ObjectMatrix,f=new Map,S=i.getSheetFormulaData(e,t),p=[];return r===N.COPY_TYPE.CUT?o.forValue((h,g,u)=>{const m=n.rows[h],C=n.cols[g],_={};if(a.isFormulaId(u.si)){if(a.isFormulaString(u.f))p.push(u.si),_.f=u.f,_.si=u.si;else if(p.includes(u.si))_.f=null,_.si=u.si;else{const I=i.getFormulaStringByCell(c.range.rows[h%c.range.rows.length],c.range.cols[g%c.range.cols.length],c.subUnitId,c.unitId);_.f=I,_.si=null}_.v=null,_.p=null,d.setValue(m,C,_)}else a.isFormulaString(u.f)&&(_.f=u.f,_.si=null,_.v=null,_.p=null,d.setValue(m,C,_))}):o.forValue((h,g,u)=>{var I;const m=n.rows[h],C=n.cols[g],_={};if(a.isFormulaId(u.si)){if(c.unitId!==e||c.subUnitId!==t){const T=i.getFormulaStringByCell(c.range.rows[h%c.range.rows.length],c.range.cols[g%c.range.cols.length],c.subUnitId,c.unitId),D=n.cols[g]-c.range.cols[g%c.range.cols.length],v=n.rows[h]-c.range.rows[h%c.range.rows.length],M=s.moveFormulaRefOffset(T||"",D,v);_.si=null,_.f=M}else _.si=u.si,_.f=null;_.v=null,_.p=null,d.setValue(m,C,_)}else if(a.isFormulaString(u.f)){const T=`${h%c.range.rows.length}_${g%c.range.cols.length}`;let D=f.get(T);if(D)_.si=D,_.f=null;else{D=a.generateRandomId(6),f.set(T,D);const v=n.cols[g]-c.range.cols[g%c.range.cols.length],M=n.rows[h]-c.range.rows[h%c.range.rows.length],w=s.moveFormulaRefOffset(u.f||"",v,M);_.si=D,_.f=w}_.v=null,_.p=null,d.setValue(m,C,_)}else(I=S==null?void 0:S[m])!=null&&I[C]&&(_.v=u.v,_.f=null,_.si=null,_.p=u.p,d.setValue(m,C,_))}),p.length>0&&new a.ObjectMatrix(S).forValue((h,g,u)=>{if(!(c.range.rows.includes(h)&&c.range.cols.includes(g))&&!(n.rows.includes(h)&&n.cols.includes(g))&&p.includes(u==null?void 0:u.si)){const m=i.getFormulaStringByCell(h,g,c.subUnitId,c.unitId);d.setValue(h,g,{f:m,si:null,v:null,p:null})}}),d}function Mt(e){if(e!=null&&e.p){const t=e==null?void 0:e.p.body;if(t==null)return;const n=t.dataStream;return n.substring(n.length-2,n.length)===a.DEFAULT_EMPTY_DOCUMENT_VALUE?n.substring(0,n.length-2):n}}var Dn=Object.getOwnPropertyDescriptor,kn=(e,t,n,o)=>{for(var r=o>1?void 0:o?Dn(t,n):t,s=e.length-1,i;s>=0;s--)(i=e[s])&&(r=i(r)||r);return r},Ie=(e,t)=>(n,o)=>t(n,o,e);let qe=class extends a.Disposable{constructor(t,n,o,r,s,i,c,d){super();Y(this,"_previousShape");Y(this,"_skeleton");this._context=t,this._sheetInterceptorService=n,this._formulaDataModel=o,this._themeService=r,this._renderManagerService=s,this._sheetSkeletonManagerService=i,this._commandService=c,this._logService=d,this._initSkeletonChangeListener(),this._initInterceptorEditorStart(),this._commandExecutedListener()}_initSkeletonChangeListener(){this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(t=>{var n,o;if(t==null)this._logService.debug("[FormulaEditorShowController]: should not receive currentSkeleton$ as null!");else{const{skeleton:r}=t,s=(o=(n=this._skeleton)==null?void 0:n.worksheet)==null?void 0:o.getSheetId();if(this._changeRuntime(r),s!==r.worksheet.getSheetId())this._removeArrayFormulaRangeShape();else{const{unitId:i,sheetId:c}=t;this._updateArrayFormulaRangeShape(i,c)}}}))}_changeRuntime(t){this._skeleton=t}_initInterceptorEditorStart(){this.disposeWithMe(a.toDisposable(this._sheetInterceptorService.writeCellInterceptor.intercept(x.BEFORE_CELL_EDIT,{handler:(t,n,o)=>{var u,m,C,_;const{row:r,col:s,unitId:i,subUnitId:c,worksheet:d}=n,f=this._formulaDataModel.getArrayFormulaRange(),S=this._formulaDataModel.getArrayFormulaCellData();if(this._removeArrayFormulaRangeShape(),t==null)return o(t);let p=null;const h=this._formulaDataModel.getFormulaStringByCell(r,s,c,i);if(h!==null&&(p={f:h}),t.v!=null&&t.v!==""&&((C=(m=(u=S[i])==null?void 0:u[c])==null?void 0:m[r])==null?void 0:C[s])==null)return p?{...t,...p}:o(t);const g=(_=f==null?void 0:f[i])==null?void 0:_[c];return g!=null&&(p=this._displayArrayFormulaRangeShape(g,r,s,i,c,d,p)),p?{...t,...p}:o(t)}})))}_commandExecutedListener(){this.disposeWithMe(this._commandService.onCommandExecuted((t,n)=>{(t.id===R.SetFormulaCalculationResultMutation.id||t.id===R.SetArrayFormulaDataMutation.id&&n&&n.remove)&&this._removeArrayFormulaRangeShape()})),this.disposeWithMe(this._commandService.beforeCommandExecuted(t=>{x.SetWorksheetRowAutoHeightMutation.id===t.id&&requestIdleCallback(()=>{const n=t.params,{unitId:o,subUnitId:r,rowsAutoHeightInfo:s}=n;this._refreshArrayFormulaRangeShapeByRow(o,r,s)})}))}_displayArrayFormulaRangeShape(t,n,o,r,s,i,c){return new a.ObjectMatrix(t).forValue((d,f,S)=>{if(S==null)return!0;const{startRow:p,startColumn:h,endRow:g,endColumn:u}=S;if(d===n&&f===o)return this._createArrayFormulaRangeShape(S,r),!1;if(n>=p&&n<=g&&o>=h&&o<=u){const m=i.getCell(p,h);return(m==null?void 0:m.v)===R.ErrorType.SPILL||(m==null?void 0:m.f)==null?void 0:(c==null&&(c={f:m.f,isInArrayFormulaRange:!0}),this._createArrayFormulaRangeShape(S,r),!1)}}),c}_createArrayFormulaRangeShape(t,n){const o=this._renderManagerService.getRenderById(n),r=this._sheetSkeletonManagerService.getCurrentSkeleton();if(!o||!r)return;const{scene:s}=o;if(!s)return;const i={range:t,primary:null,style:{strokeWidth:1,stroke:this._themeService.getColorFromTheme("primary.600"),fill:new a.ColorKit(this._themeService.getColorFromTheme("white")).setAlpha(0).toString(),widgets:{}}},c=N.attachSelectionWithCoord(i,r),{rowHeaderWidth:d,columnHeaderHeight:f}=r,S=new N.SelectionControl(s,N.SELECTION_SHAPE_DEPTH.FORMULA_EDITOR_SHOW,this._themeService,{highlightHeader:!1,rowHeaderWidth:d,columnHeaderHeight:f});S.updateRangeBySelectionWithCoord(c),S.setEvent(!1),this._previousShape=S}_removeArrayFormulaRangeShape(){this._previousShape!=null&&(this._previousShape.dispose(),this._previousShape=null)}_refreshArrayFormulaRangeShape(t,n){if(this._previousShape){const{startRow:o,endRow:r,startColumn:s,endColumn:i}=this._previousShape.getRange(),c={startRow:o,endRow:r,startColumn:s,endColumn:i};this._removeArrayFormulaRangeShape(),this._createArrayFormulaRangeShape(c,t)}}_checkCurrentSheet(t,n){const o=this._sheetSkeletonManagerService.getCurrentSkeleton();if(!o)return!1;const r=o.worksheet;return r?r.unitId===t&&r.getSheetId()===n:!1}_updateArrayFormulaRangeShape(t,n){this._checkCurrentSheet(t,n)&&this._previousShape&&this._refreshArrayFormulaRangeShape(t)}_refreshArrayFormulaRangeShapeByRow(t,n,o){if(!this._checkCurrentSheet(t,n)||!this._previousShape)return;const{startRow:r,endRow:s,startColumn:i,endColumn:c}=this._previousShape.getRange();for(let d=0;d<o.length;d++){const{row:f}=o[d];if(r>=f){const S={startRow:r,endRow:s,startColumn:i,endColumn:c};this._refreshArrayFormulaRangeShape(t,S);break}}}};qe=kn([Ie(1,a.Inject(x.SheetInterceptorService)),Ie(2,a.Inject(R.FormulaDataModel)),Ie(3,a.Inject(a.ThemeService)),Ie(4,j.IRenderManagerService),Ie(5,a.Inject(N.SheetSkeletonManagerService)),Ie(6,a.ICommandService),Ie(7,a.ILogService)],qe);var wn=Object.getOwnPropertyDescriptor,An=(e,t,n,o)=>{for(var r=o>1?void 0:o?wn(t,n):t,s=e.length-1,i;s>=0;s--)(i=e[s])&&(r=i(r)||r);return r},Ot=(e,t)=>(n,o)=>t(n,o,e);const xn={tl:{size:6,color:"#409f11"}};let Ye=class extends a.RxDisposable{constructor(e,t){super(),this._sheetInterceptorService=e,this._formulaDataModel=t,this.disposeWithMe(this._sheetInterceptorService.intercept(x.INTERCEPTOR_POINT.CELL_CONTENT,{effect:a.InterceptorEffectEnum.Style,handler:(n,o,r)=>{var c,d,f,S;const s=(S=(f=(d=(c=this._formulaDataModel.getArrayFormulaCellData())==null?void 0:c[o.unitId])==null?void 0:d[o.subUnitId])==null?void 0:f[o.row])==null?void 0:S[o.col];return!R.extractFormulaError(n,!!s)||!n||(n===o.rawData&&(n={...o.rawData}),n.markers={...n==null?void 0:n.markers,...xn}),r(n)},priority:10}))}};Ye=An([Ot(0,a.Inject(x.SheetInterceptorService)),Ot(1,a.Inject(R.FormulaDataModel))],Ye);function Pn(){const e=l.useDependency(ge.TriggerCalculationController),t=l.useDependency(a.ICommandService),n=l.useObservable(e.progress$),o=E.useCallback(()=>{t.executeCommand(R.SetFormulaCalculationStopMutation.id)},[t]),r=E.useCallback(()=>{e.clearProgress()},[e]);return y.jsx(l.ProgressBar,{progress:n,onTerminate:o,onClearProgress:r})}function Ln(e,t){return Object.keys(e).filter(n=>isNaN(Number(n))&&n!=="DefinedName"&&n!=="Table").map(n=>({label:t.t(`formula.functionType.${n.toLocaleLowerCase()}`),value:`${e[n]}`}))}function Nt(e){if(!e.require&&!e.repeat)return`[${e.name}]`;if(e.require&&!e.repeat)return e.name;if(!e.require&&e.repeat)return`[${e.name},...]`;if(e.require&&e.repeat)return`${e.name},...`}function Dt(e){const{prefix:t,value:n}=e;return y.jsxs("div",{children:[y.jsxs("span",{children:[t,"("]}),n&&n.map((o,r)=>y.jsxs("span",{children:[y.jsx("span",{children:Nt(o)}),r===n.length-1?"":","]},r)),")"]})}function $e(e){const{className:t,value:n,title:o}=e;return y.jsxs("div",{className:"univer-mb-2 univer-text-xs",children:[y.jsx("div",{className:B.clsx("univer-mb-2 univer-font-medium univer-text-gray-500 dark:!univer-text-gray-300",t),children:o}),y.jsx("div",{className:"univer-break-all univer-text-gray-900 dark:!univer-text-white",children:n})]})}function $n(e){const{functionInfo:t,onChange:n}=e;if(!t)return null;const[o,r]=E.useState([]),[s,i]=E.useState(t.functionParameter),[c,d]=E.useState(-1);return y.jsxs("div",{children:[y.jsx("div",{className:B.clsx("univer-h-[364px] univer-overflow-y-auto",B.scrollbarClassName),children:s.map((f,S)=>y.jsxs("div",{children:[y.jsx("div",{className:"univer-text-sm",children:f.name}),y.jsx("div",{className:"univer-mb-2 univer-mt-1"})]},S))}),y.jsx("div",{className:B.clsx("univer-flex-1 univer-p-3",B.borderLeftClassName),children:y.jsx($e,{title:c===-1?y.jsx(Dt,{prefix:t.functionName,value:s}):s[c].name,value:c===-1?t.description:s[c].detail})})]})}function ye({ref:e,...t}){const{icon:n,id:o,className:r,extend:s,...i}=t,c=`univerjs-icon univerjs-icon-${o} ${r||""}`.trim(),d=E.useRef(`_${Un()}`);return kt(n,`${o}`,{defIds:n.defIds,idSuffix:d.current},{ref:e,className:c,...i},s)}function kt(e,t,n,o,r){return E.createElement(e.tag,{key:t,...Fn(e,n,r),...o},(Wn(e,n).children||[]).map((s,i)=>kt(s,`${t}-${e.tag}-${i}`,n,void 0,r)))}function Fn(e,t,n){const o={...e.attrs};n!=null&&n.colorChannel1&&o.fill==="colorChannel1"&&(o.fill=n.colorChannel1),e.tag==="mask"&&o.id&&(o.id=o.id+t.idSuffix),Object.entries(o).forEach(([s,i])=>{s==="mask"&&typeof i=="string"&&(o[s]=i.replace(/url\(#(.*)\)/,`url(#$1${t.idSuffix})`))});const{defIds:r}=t;return!r||r.length===0||(e.tag==="use"&&o["xlink:href"]&&(o["xlink:href"]=o["xlink:href"]+t.idSuffix),Object.entries(o).forEach(([s,i])=>{typeof i=="string"&&(o[s]=i.replace(/url\(#(.*)\)/,`url(#$1${t.idSuffix})`))})),o}function Wn(e,t){var o;const{defIds:n}=t;return!n||n.length===0?e:e.tag==="defs"&&((o=e.children)!=null&&o.length)?{...e,children:e.children.map(r=>typeof r.attrs.id=="string"&&n&&n.includes(r.attrs.id)?{...r,attrs:{...r.attrs,id:r.attrs.id+t.idSuffix}}:r)}:e}function Un(){return Math.random().toString(36).substring(2,8)}ye.displayName="UniverIcon";const Vn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M14.1544 3.75557C14.3887 3.98988 14.3887 4.36978 14.1544 4.6041L6.51409 12.2444C6.40157 12.3569 6.24896 12.4201 6.08983 12.4201C5.9307 12.4201 5.77808 12.3569 5.66556 12.2444L1.84541 8.42425C1.6111 8.18993 1.6111 7.81003 1.84541 7.57572C2.07973 7.34141 2.45963 7.34141 2.69394 7.57572L6.08983 10.9716L13.3059 3.75557C13.5402 3.52126 13.9201 3.52126 14.1544 3.75557Z",fillRule:"evenodd",clipRule:"evenodd"}}]},wt=E.forwardRef(function(t,n){return E.createElement(ye,Object.assign({},t,{id:"check-mark-icon",ref:n,icon:Vn}))});wt.displayName="CheckMarkIcon";const Hn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.71274 2.86421C3.47843 2.6299 3.09853 2.6299 2.86421 2.86421C2.6299 3.09853 2.6299 3.47843 2.86421 3.71274L7.15154 8.00007L2.86421 12.2874C2.6299 12.5217 2.6299 12.9016 2.86421 13.1359C3.09853 13.3702 3.47843 13.3702 3.71274 13.1359L8.00007 8.84859L12.2874 13.1359C12.5217 13.3702 12.9016 13.3702 13.1359 13.1359C13.3702 12.9016 13.3702 12.5217 13.1359 12.2874L8.84859 8.00007L13.1359 3.71274C13.3702 3.47843 13.3702 3.09853 13.1359 2.86421C12.9016 2.6299 12.5217 2.6299 12.2874 2.86421L8.00007 7.15154L3.71274 2.86421Z"}}]},At=E.forwardRef(function(t,n){return E.createElement(ye,Object.assign({},t,{id:"close-icon",ref:n,icon:Hn}))});At.displayName="CloseIcon";const Bn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.3313 1.4667C5.3313 1.13533 5.59993 0.866699 5.9313 0.866699H10.069C10.4004 0.866699 10.669 1.13533 10.669 1.4667C10.669 1.79807 10.4004 2.0667 10.069 2.0667H5.9313C5.59993 2.0667 5.3313 1.79807 5.3313 1.4667Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.09985 3.64443C1.09985 3.31306 1.36848 3.04443 1.69985 3.04443H14.2999C14.6312 3.04443 14.8999 3.31306 14.8999 3.64443C14.8999 3.9758 14.6312 4.24443 14.2999 4.24443H1.69985C1.36848 4.24443 1.09985 3.9758 1.09985 3.64443Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M6.12398 8.30171C6.35829 8.0674 6.73819 8.0674 6.97251 8.30171L8.00007 9.32928L9.02764 8.30171C9.26195 8.0674 9.64185 8.0674 9.87617 8.30171C10.1105 8.53603 10.1105 8.91593 9.87617 9.15024L8.8486 10.1778L9.87617 11.2054C10.1105 11.4397 10.1105 11.8196 9.87617 12.0539C9.64185 12.2882 9.26195 12.2882 9.02764 12.0539L8.00007 11.0263L6.97251 12.0539C6.73819 12.2882 6.35829 12.2882 6.12398 12.0539C5.88966 11.8196 5.88966 11.4397 6.12398 11.2054L7.15154 10.1778L6.12398 9.15024C5.88966 8.91593 5.88966 8.53603 6.12398 8.30171Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.75332 5.22217C3.86966 5.22217 3.15332 5.93851 3.15332 6.82217V12.5331C3.15332 13.9691 4.31738 15.1332 5.75332 15.1332H10.2465C11.6825 15.1332 12.8465 13.9691 12.8465 12.5331V6.82217C12.8465 5.93851 12.1302 5.22217 11.2465 5.22217H4.75332ZM4.35332 6.82217C4.35332 6.60125 4.53241 6.42217 4.75332 6.42217H11.2465C11.4674 6.42217 11.6465 6.60125 11.6465 6.82217V12.5331C11.6465 13.3063 11.0197 13.9332 10.2465 13.9332H5.75332C4.98012 13.9332 4.35332 13.3063 4.35332 12.5331V6.82217Z",fillRule:"evenodd",clipRule:"evenodd"}}]},xt=E.forwardRef(function(t,n){return E.createElement(ye,Object.assign({},t,{id:"delete-icon",ref:n,icon:Bn}))});xt.displayName="DeleteIcon";const Kn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.6 1.99991C8.60001 1.66854 8.33138 1.39991 8.00001 1.3999C7.66864 1.3999 7.40001 1.66853 7.4 1.9999L7.39996 7.3999H1.9999C1.66853 7.3999 1.3999 7.66853 1.3999 7.9999C1.3999 8.33127 1.66853 8.5999 1.9999 8.5999H7.39995L7.3999 13.9999C7.3999 14.3313 7.66853 14.5999 7.9999 14.5999C8.33127 14.5999 8.5999 14.3313 8.5999 13.9999L8.59995 8.5999H13.9999C14.3313 8.5999 14.5999 8.33127 14.5999 7.9999C14.5999 7.66853 14.3313 7.3999 13.9999 7.3999H8.59996L8.6 1.99991Z"}}]},Pt=E.forwardRef(function(t,n){return E.createElement(ye,Object.assign({},t,{id:"increase-icon",ref:n,icon:Kn}))});Pt.displayName="IncreaseIcon";const jn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.90913 3.57564C6.14345 3.34132 6.52335 3.34132 6.75766 3.57564L10.7577 7.57564C10.992 7.80995 10.992 8.18985 10.7577 8.42417L6.75766 12.4242C6.52335 12.6585 6.14345 12.6585 5.90913 12.4242C5.67482 12.1899 5.67482 11.81 5.90913 11.5756L9.48487 7.9999L5.90913 4.42417C5.67482 4.18985 5.67482 3.80995 5.90913 3.57564Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Lt=E.forwardRef(function(t,n){return E.createElement(ye,Object.assign({},t,{id:"more-icon",ref:n,icon:jn}))});Lt.displayName="MoreIcon";const qn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M12.6185 12.4423C12.5907 12.2749 12.7773 12.15 12.9343 12.2308L15.4242 13.5126C15.6102 13.6084 15.5544 13.8745 15.3439 13.8955L14.2456 14.184L13.4521 15.1286C13.3495 15.2939 13.085 15.2463 13.0534 15.0568L12.6185 12.4423Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1 3.6C1 2.16406 2.16406 1 3.6 1H12.3C13.7359 1 14.9 2.16406 14.9 3.6V5.81156C14.9003 5.81881 14.9004 5.82609 14.9004 5.8334C14.9004 5.84071 14.9003 5.84799 14.9 5.85524V10.045C14.9003 10.0522 14.9004 10.0595 14.9004 10.0668C14.9004 10.3982 14.6318 10.6668 14.3004 10.6668H11.1668C10.8907 10.6668 10.6668 10.8907 10.6668 11.1668V14.3C10.6668 14.6314 10.3982 14.9 10.0668 14.9L10.05 14.8998L3.6 14.9C2.16406 14.9 1 13.7359 1 12.3V3.6ZM13.2 5.2334C13.4761 5.2334 13.7 5.00954 13.7 4.7334V3.6C13.7 2.8268 13.0732 2.2 12.3 2.2H11.1668C10.8907 2.2 10.6668 2.42386 10.6668 2.7V4.7334C10.6668 5.00954 10.8907 5.2334 11.1668 5.2334H13.2ZM10.6668 6.9334C10.6668 6.65726 10.8907 6.4334 11.1668 6.4334H13.2C13.4761 6.4334 13.7 6.65726 13.7 6.9334V8.9668C13.7 9.24294 13.4761 9.4668 13.2 9.4668H11.1668C10.8907 9.4668 10.6668 9.24294 10.6668 8.9668V6.9334ZM8.9668 5.2334C9.24294 5.2334 9.4668 5.00954 9.4668 4.7334V2.7C9.4668 2.42386 9.24294 2.2 8.9668 2.2H6.9334C6.65726 2.2 6.4334 2.42386 6.4334 2.7V4.7334C6.4334 5.00954 6.65726 5.2334 6.9334 5.2334L8.9668 5.2334ZM6.4334 6.9334C6.4334 6.65726 6.65726 6.4334 6.9334 6.4334L8.9668 6.4334C9.24294 6.4334 9.4668 6.65726 9.4668 6.9334V8.9668C9.4668 9.24294 9.24294 9.4668 8.9668 9.4668L6.9334 9.4668C6.65726 9.4668 6.4334 9.24294 6.4334 8.9668V6.9334ZM4.7334 5.2334C5.00954 5.2334 5.2334 5.00954 5.2334 4.7334V2.7C5.2334 2.42386 5.00954 2.2 4.7334 2.2H3.6C2.8268 2.2 2.2 2.8268 2.2 3.6V4.7334C2.2 5.00954 2.42386 5.2334 2.7 5.2334H4.7334ZM2.2 6.9334C2.2 6.65726 2.42386 6.4334 2.7 6.4334H4.7334C5.00954 6.4334 5.2334 6.65725 5.2334 6.9334V8.9668C5.2334 9.24294 5.00954 9.4668 4.7334 9.4668H2.7C2.42386 9.4668 2.2 9.24294 2.2 8.9668V6.9334ZM5.2334 11.1668C5.2334 10.8907 5.00954 10.6668 4.7334 10.6668H2.7C2.42386 10.6668 2.2 10.8907 2.2 11.1668V12.3C2.2 13.0732 2.8268 13.7 3.6 13.7H4.7334C5.00954 13.7 5.2334 13.4761 5.2334 13.2V11.1668ZM9.4668 11.1668C9.4668 10.8907 9.24294 10.6668 8.9668 10.6668H6.9334C6.65726 10.6668 6.4334 10.8907 6.4334 11.1668V13.2C6.4334 13.4761 6.65726 13.7 6.9334 13.7H8.9668C9.24294 13.7 9.4668 13.4761 9.4668 13.2V11.1668Z",fillRule:"evenodd",clipRule:"evenodd"}}]},$t=E.forwardRef(function(t,n){return E.createElement(ye,Object.assign({},t,{id:"select-range-icon",ref:n,icon:qn}))});$t.displayName="SelectRangeIcon";function Yn(e){const{onChange:t}=e,n="-1",[o,r]=E.useState(""),[s,i]=E.useState([]),[c,d]=E.useState(0),[f,S]=E.useState(n),[p,h]=E.useState(0),[g,u]=E.useState(null),m=l.useDependency(ge.IDescriptionService),C=l.useDependency(a.LocaleService),_=l.useDependency(l.ISidebarService),I=l.useObservable(_.sidebarOptions$),T=Ln(R.FunctionType,C);T.unshift({label:C.t("formula.moreFunctions.allFunctions"),value:n});const D=C.t("formula.prompt.required"),v=C.t("formula.prompt.optional");E.useEffect(()=>{W(n)},[]),E.useEffect(()=>{w(0)},[s]),E.useEffect(()=>{I!=null&&I.visible&&(r(""),i([]),d(0),S(n),h(0),u(null),W(n))},[I]);const M=O=>{if(o.trim()==="")return O;const L=new RegExp(`(${o.toLocaleUpperCase()})`);return O.split(L).filter(Boolean).map((k,V)=>k.match(L)?y.jsx("span",{className:"univer-text-red-500",children:k},V):k)},w=O=>{if(s.length===0){u(null);return}h(O);const L=m.getFunctionInfo(s[O].name);if(!L){u(null);return}u(L),t(L)};function W(O){S(O);const L=m.getSearchListByType(+O);i(L)}function U(O){r(O);const L=m.getSearchListByName(O);i(L)}function P(O){if(O.stopPropagation(),O.key==="ArrowDown"){const L=c+1;d(L===s.length?0:L)}else if(O.key==="ArrowUp"){const L=c-1;d(L===-1?s.length-1:L)}else O.key==="Enter"&&w(c)}const F=O=>{d(O)},A=()=>{d(-1)};return y.jsxs("div",{children:[y.jsxs("div",{className:"univer-flex univer-items-center univer-justify-between univer-gap-2",children:[y.jsx(B.Select,{value:f,options:T,onChange:W}),y.jsx(B.Input,{placeholder:C.t("formula.moreFunctions.searchFunctionPlaceholder"),onKeyDown:P,value:o,onChange:U,size:"small",allowClear:!0})]}),s.length>0&&y.jsx("ul",{className:B.clsx("univer-mb-0 univer-mt-2 univer-box-border univer-max-h-72 univer-w-full univer-select-none univer-list-none univer-overflow-y-auto univer-rounded univer-p-3 univer-outline-none",B.borderClassName,B.scrollbarClassName),onKeyDown:P,tabIndex:-1,children:s.map(({name:O},L)=>y.jsxs("li",{className:B.clsx("univer-relative univer-box-border univer-cursor-pointer univer-rounded univer-px-7 univer-py-1 univer-text-sm univer-text-gray-900 univer-transition-colors dark:!univer-text-white",{"univer-bg-gray-200 dark:!univer-bg-gray-600":c===L}),onMouseEnter:()=>F(L),onMouseLeave:A,onClick:()=>w(L),children:[p===L&&y.jsx(wt,{className:"univer-absolute univer-left-1.5 univer-top-1/2 univer-inline-flex -univer-translate-y-1/2 univer-text-base univer-text-primary-600"}),y.jsx("span",{className:"univer-block",children:M(O)})]},L))}),g&&y.jsxs("div",{className:B.clsx("univer-mx-0 univer-my-2 univer-overflow-y-auto",B.scrollbarClassName),children:[y.jsx($e,{title:g.functionName,value:g.description}),y.jsx($e,{title:C.t("formula.moreFunctions.syntax"),value:y.jsx(Dt,{prefix:g.functionName,value:g.functionParameter})}),y.jsx($e,{title:C.t("formula.prompt.helpExample"),value:`${g.functionName}(${g.functionParameter.map(O=>O.example).join(",")})`}),g.functionParameter&&g.functionParameter.map(O=>y.jsx($e,{title:O.name,value:`${O.require?D:v} ${O.detail}`},O.name))]})]})}function zn(){const e=N.useActiveWorkbook(),[t,n]=E.useState(!0),[o,r]=E.useState(!1),[s,i]=E.useState(null);l.useDependency(N.IEditorBridgeService);const c=l.useDependency(a.LocaleService),d=l.useDependency(Q.IEditorService),f=l.useDependency(a.IUniverInstanceService),S=l.useDependency(a.ICommandService);function p(){n(!t),r(!o)}function h(){const g=x.getSheetCommandTarget(f);if(!g)return;S.executeCommand(N.SetCellEditVisibleOperation.id,{visible:!0,unitId:g.unitId,eventType:j.DeviceInputEventType.Dblclick});const u=d.getEditor(a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY),m=d.getEditor(a.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY),C=`=${s==null?void 0:s.functionName}(`;u==null||u.replaceText(C),m==null||m.replaceText(C,!1)}return y.jsxs("div",{"data-u-comp":"sheets-formula-functions-panel",className:"univer-box-border univer-flex univer-h-full univer-flex-col univer-justify-between univer-py-2",children:[t&&y.jsx(Yn,{onChange:i}),o&&y.jsx($n,{functionInfo:s,onChange:()=>{}}),y.jsxs("div",{className:"univer-flex univer-justify-end",children:[o&&y.jsx(B.Button,{variant:"primary",onClick:p,className:"univer-mb-5 univer-ml-4 univer-mr-0 univer-mt-0",children:c.t("formula.moreFunctions.next")}),o&&y.jsx(B.Button,{onClick:p,className:"univer-mb-5 univer-ml-4 univer-mr-0 univer-mt-0",children:c.t("formula.moreFunctions.prev")}),t&&!!e&&y.jsx(B.Button,{variant:"primary",onClick:h,className:"univer-mb-5 univer-ml-4 univer-mr-0 univer-mt-0",children:c.t("formula.moreFunctions.confirm")})]})]})}function Gn(e){return{id:ce.id,title:"SUM",icon:"SumIcon",type:l.MenuItemType.BUTTON,params:{value:"SUM"},hidden$:l.getMenuHiddenObservable(e,a.UniverInstanceType.UNIVER_SHEET),disabled$:N.getCurrentRangeDisable$(e,{workbookTypes:[x.WorkbookEditablePermission],worksheetTypes:[x.WorksheetEditPermission,x.WorksheetSetCellValuePermission],rangeTypes:[x.RangeProtectionPermissionEditPoint]})}}function Zn(e){return{id:ce.id,title:"COUNT",icon:"CntIcon",type:l.MenuItemType.BUTTON,params:{value:"COUNT"},hidden$:l.getMenuHiddenObservable(e,a.UniverInstanceType.UNIVER_SHEET),disabled$:N.getCurrentRangeDisable$(e,{workbookTypes:[x.WorkbookEditablePermission],worksheetTypes:[x.WorksheetEditPermission,x.WorksheetSetCellValuePermission],rangeTypes:[x.RangeProtectionPermissionEditPoint]})}}function Xn(e){return{id:ce.id,title:"AVERAGE",icon:"AvgIcon",type:l.MenuItemType.BUTTON,params:{value:"AVERAGE"},hidden$:l.getMenuHiddenObservable(e,a.UniverInstanceType.UNIVER_SHEET),disabled$:N.getCurrentRangeDisable$(e,{workbookTypes:[x.WorkbookEditablePermission],worksheetTypes:[x.WorksheetEditPermission,x.WorksheetSetCellValuePermission],rangeTypes:[x.RangeProtectionPermissionEditPoint]})}}function Qn(e){return{id:ce.id,title:"MAX",icon:"MaxIcon",type:l.MenuItemType.BUTTON,params:{value:"MAX"},hidden$:l.getMenuHiddenObservable(e,a.UniverInstanceType.UNIVER_SHEET),disabled$:N.getCurrentRangeDisable$(e,{workbookTypes:[x.WorkbookEditablePermission],worksheetTypes:[x.WorksheetEditPermission,x.WorksheetSetCellValuePermission],rangeTypes:[x.RangeProtectionPermissionEditPoint]})}}function Jn(e){return{id:ce.id,title:"MIN",icon:"MinIcon",type:l.MenuItemType.BUTTON,params:{value:"MIN"},hidden$:l.getMenuHiddenObservable(e,a.UniverInstanceType.UNIVER_SHEET),disabled$:N.getCurrentRangeDisable$(e,{workbookTypes:[x.WorkbookEditablePermission],worksheetTypes:[x.WorksheetEditPermission,x.WorksheetSetCellValuePermission],rangeTypes:[x.RangeProtectionPermissionEditPoint]})}}function er(e){return{id:He.id,title:"formula.insert.more",tooltip:"formula.insert.tooltip",type:l.MenuItemType.BUTTON,hidden$:l.getMenuHiddenObservable(e,a.UniverInstanceType.UNIVER_SHEET),disabled$:N.getCurrentRangeDisable$(e,{workbookTypes:[x.WorkbookEditablePermission],worksheetTypes:[x.WorksheetEditPermission,x.WorksheetSetCellValuePermission],rangeTypes:[x.RangeProtectionPermissionEditPoint]})}}function tr(e){return e.get(a.IUniverInstanceService).getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET).pipe(q.switchMap(o=>o&&e.get(l.IClipboardInterfaceService)?new q.Observable(s=>s.next(!e.get(l.IClipboardInterfaceService).supportClipboard)):q.of(!0)))}function nr(e){return{id:We.id,type:l.MenuItemType.BUTTON,title:"formula.operation.copyFormulaOnly",disabled$:N.getCurrentRangeDisable$(e,{workbookTypes:[x.WorkbookCopyPermission],worksheetTypes:[x.WorksheetCopyPermission],rangeTypes:[x.RangeProtectionPermissionViewPoint]}),hidden$:l.getMenuHiddenObservable(e,a.UniverInstanceType.UNIVER_SHEET)}}function rr(e){return{id:Ue.id,type:l.MenuItemType.BUTTON,title:"formula.operation.pasteFormula",disabled$:tr(e).pipe(q.combineLatestWith(N.getCurrentRangeDisable$(e,{workbookTypes:[x.WorkbookEditablePermission],rangeTypes:[x.RangeProtectionPermissionEditPoint],worksheetTypes:[x.WorksheetSetCellValuePermission,x.WorksheetEditPermission]})),q.map(([t,n])=>t||n)),hidden$:l.getMenuHiddenObservable(e,a.UniverInstanceType.UNIVER_SHEET)}}const or={[l.RibbonFormulasGroup.BASIC]:{[`${ce.id}.sum`]:{order:0,menuItemFactory:Gn},[`${ce.id}.count`]:{order:1,menuItemFactory:Zn},[`${ce.id}.average`]:{order:2,menuItemFactory:Xn},[`${ce.id}.max`]:{order:3,menuItemFactory:Qn},[`${ce.id}.min`]:{order:4,menuItemFactory:Jn}},[l.RibbonFormulasGroup.OTHERS]:{[He.id]:{order:0,menuItemFactory:er}},[N.COPY_SPECIAL_MENU_ID]:{[We.id]:{order:0,menuItemFactory:nr}},[N.PASTE_SPECIAL_MENU_ID]:{[Ue.id]:{order:4,menuItemFactory:rr}}},sr="meta_key_ctrl_And_Shift";function ir(e){return e.getContextValue(a.FOCUSING_DOC)&&e.getContextValue(a.FOCUSING_UNIVER_EDITOR)}const ze=[l.KeyCode.ARROW_DOWN,l.KeyCode.ARROW_UP,l.KeyCode.ARROW_LEFT,l.KeyCode.ARROW_RIGHT],cr=[...ze,l.KeyCode.ENTER,l.KeyCode.TAB,l.KeyCode.ESC];function ar(){const e=[];for(const t of cr)e.push({id:Ee.id,binding:t,preconditions:n=>N.whenFormulaEditorActivated(n),staticParameters:{eventType:j.DeviceInputEventType.Keyboard,keycode:t}});return e}function lr(){const e=[];for(const t of ze)e.push({id:Ee.id,binding:t|l.MetaKeys.SHIFT,preconditions:n=>N.whenFormulaEditorActivated(n),staticParameters:{eventType:j.DeviceInputEventType.Keyboard,keycode:t,metaKey:l.MetaKeys.SHIFT}});return e}function ur(){const e=[];for(const t of ze)e.push({id:Ee.id,binding:t|l.MetaKeys.CTRL_COMMAND,preconditions:n=>N.whenFormulaEditorActivated(n),staticParameters:{eventType:j.DeviceInputEventType.Keyboard,keycode:t,metaKey:l.MetaKeys.CTRL_COMMAND}});return e}function dr(){const e=[];for(const t of ze)e.push({id:Ee.id,binding:t|l.MetaKeys.SHIFT|l.MetaKeys.CTRL_COMMAND,preconditions:n=>N.whenFormulaEditorActivated(n),staticParameters:{eventType:j.DeviceInputEventType.Keyboard,keycode:t,metaKey:sr}});return e}const fr={id:it.id,binding:l.KeyCode.F4,preconditions:e=>N.whenFormulaEditorActivated(e)};function hr(){const e=[];for(const t of[l.KeyCode.ENTER,l.KeyCode.TAB,l.KeyCode.ARROW_DOWN,l.KeyCode.ARROW_UP])e.push({id:Ee.id,binding:t,preconditions:n=>ir(n),staticParameters:{eventType:j.DeviceInputEventType.Keyboard,keycode:t,isSingleEditor:!0}});return e}const gr={id:ge.QuickSumCommand.id,binding:l.MetaKeys.ALT|l.KeyCode.EQUAL,preconditions:N.whenSheetEditorFocused,mac:l.MetaKeys.CTRL_COMMAND|l.MetaKeys.ALT|l.KeyCode.EQUAL,description:"shortcut.sheets-formula-ui.quick-sum",group:"4_sheet-edit"};var Sr=Object.getOwnPropertyDescriptor,pr=(e,t,n,o)=>{for(var r=o>1?void 0:o?Sr(t,n):t,s=e.length-1,i;s>=0;s--)(i=e[s])&&(r=i(r)||r);return r},Re=(e,t)=>(n,o)=>t(n,o,e);let Ge=class extends a.Disposable{constructor(e,t,n,o,r,s,i){super(),this._injector=e,this._menuManagerService=t,this._commandService=n,this._shortcutService=o,this._uiPartsService=r,this._renderManagerService=s,this._componentManager=i,this._initialize()}_initialize(){this._registerCommands(),this._registerMenus(),this._registerShortcuts(),this._registerComponents(),this._registerRenderModules()}_registerMenus(){this._menuManagerService.mergeMenu(or)}_registerCommands(){[We,Ue,ce,He,yt,mt,Ee,it].forEach(e=>this.disposeWithMe(this._commandService.registerCommand(e)))}_registerShortcuts(){[...ar(),...lr(),...ur(),...dr(),...hr(),gr,fr].forEach(e=>{this.disposeWithMe(this._shortcutService.registerShortcut(e))})}_registerComponents(){this.disposeWithMe(this._uiPartsService.registerComponent(N.SheetsUIPart.FORMULA_AUX,()=>l.connectInjector(Pn,this._injector))),this._componentManager.register(It,zn)}_registerRenderModules(){this.disposeWithMe(this._renderManagerService.registerRenderModule(a.UniverInstanceType.UNIVER_SHEET,[qe]))}};Ge=pr([Re(0,a.Inject(a.Injector)),Re(1,l.IMenuManagerService),Re(2,a.ICommandService),Re(3,l.IShortcutService),Re(4,l.IUIPartsService),Re(5,j.IRenderManagerService),Re(6,a.Inject(l.ComponentManager))],Ge);var vr=Object.getOwnPropertyDescriptor,mr=(e,t,n,o)=>{for(var r=o>1?void 0:o?vr(t,n):t,s=e.length-1,i;s>=0;s--)(i=e[s])&&(r=i(r)||r);return r},lt=(e,t)=>(n,o)=>t(n,o,e);let Ze=class extends a.Disposable{constructor(e,t,n){super(),this._imageFormulaCellInterceptorController=e,this._renderManagerService=t,this._univerInstanceService=n,this._imageFormulaCellInterceptorController.registerRefreshRenderFunction(()=>{const o=this._univerInstanceService.getCurrentUnitOfType(a.UniverInstanceType.UNIVER_SHEET);if(!o)return;const r=this._renderManagerService.getRenderById(o.getUnitId());if(!r)return;r.with(N.SheetSkeletonManagerService).reCalculate();const s=r.mainComponent;s&&s.makeDirty()})}};Ze=mr([lt(0,a.Inject(ge.ImageFormulaCellInterceptorController)),lt(1,j.IRenderManagerService),lt(2,a.IUniverInstanceService)],Ze);class ut{constructor(){Y(this,"_currentSelector$",new q.BehaviorSubject(null));Y(this,"currentSelector$",this._currentSelector$.asObservable())}showRangeSelectorDialog(t){const n=t.callback,o=new Promise(r=>{t.callback=s=>{r(s),n(s)}});return this._currentSelector$.next(t),o}}var Cr=Object.getOwnPropertyDescriptor,_r=(e,t,n,o)=>{for(var r=o>1?void 0:o?Cr(t,n):t,s=e.length-1,i;s>=0;s--)(i=e[s])&&(r=i(r)||r);return r},De=(e,t)=>(n,o)=>t(n,o,e);$.RefSelectionsRenderService=class extends N.BaseSelectionRenderService{constructor(n,o,r,s,i,c,d){super(o,r,s,i,c);Y(this,"_workbookSelections");Y(this,"_eventDisposables");this._context=n,this._contextService=c,this._refSelectionsService=d,this._workbookSelections=this._refSelectionsService.getWorkbookSelections(this._context.unitId),this._initSelectionChangeListener(),this._initSkeletonChangeListener(),this._initUserActionSyncListener(),this._setSelectionStyle(Er(this._themeService)),this._remainLastEnabled=!0,this._highlightHeader=!1}getLocation(){return this._skeleton.getLocation()}setRemainLastEnabled(n){this._remainLastEnabled=n}setSkipLastEnabled(n){this._skipLastEnabled=n}clearLastSelection(){const n=this._selectionControls[this._selectionControls.length-1];n&&(n.dispose(),this._selectionControls.pop())}enableSelectionChanging(){return this._disableSelectionChanging(),this._eventDisposables=this._initCanvasEventListeners(),a.toDisposable(()=>this._disableSelectionChanging())}_disableSelectionChanging(){var n;(n=this._eventDisposables)==null||n.dispose(),this._eventDisposables=null}disableSelectionChanging(){this._disableSelectionChanging()}_initCanvasEventListeners(){const n=this._getSheetObject(),{spreadsheetRowHeader:o,spreadsheetColumnHeader:r,spreadsheet:s,spreadsheetLeftTopPlaceholder:i}=n,{scene:c}=this._context,d=new a.DisposableCollection;return d.add(s==null?void 0:s.onPointerDown$.subscribeEvent((f,S)=>{this.inRefSelectionMode()&&(this._onPointerDown(f,s.zIndex+1,a.RANGE_TYPE.NORMAL,this._getActiveViewport(f)),f.button!==2&&S.stopPropagation())})),d.add(o==null?void 0:o.onPointerDown$.subscribeEvent((f,S)=>{if(!this.inRefSelectionMode())return;const p=this._sheetSkeletonManagerService.getCurrent().skeleton,{row:h}=N.getCoordByOffset(f.offsetX,f.offsetY,c,p);N.checkInHeaderRanges(this._workbookSelections.getCurrentSelections(),h,a.RANGE_TYPE.ROW)||(this._onPointerDown(f,(s.zIndex||1)+1,a.RANGE_TYPE.ROW,this._getActiveViewport(f),j.ScrollTimerType.Y),f.button!==2&&S.stopPropagation())})),d.add(r==null?void 0:r.onPointerDown$.subscribeEvent((f,S)=>{if(!this.inRefSelectionMode())return;const p=this._sheetSkeletonManagerService.getCurrent().skeleton,{column:h}=N.getCoordByOffset(f.offsetX,f.offsetY,c,p);N.checkInHeaderRanges(this._workbookSelections.getCurrentSelections(),h,a.RANGE_TYPE.COLUMN)||(this._onPointerDown(f,(s.zIndex||1)+1,a.RANGE_TYPE.COLUMN,this._getActiveViewport(f),j.ScrollTimerType.X),f.button!==2&&S.stopPropagation())})),d.add(i==null?void 0:i.onPointerDown$.subscribeEvent((f,S)=>{if(this._reset(),!this.inRefSelectionMode())return;const p=this._sheetSkeletonManagerService.getCurrent().skeleton,h=N.getAllSelection(p);this._addSelectionControlByModelData(h),this._selectionMoveStart$.next(this.getSelectionDataWithStyle());const g=c.onPointerUp$.subscribeEvent(()=>{g.unsubscribe(),this._selectionMoveEnd$.next(this.getSelectionDataWithStyle())});f.button!==2&&S.stopPropagation()})),d}_addSelectionControlByModelData(n){var c;const o=this._skeleton,r=(c=n.style)!=null?c:N.genNormalSelectionStyle(this._themeService),s=this._scene;return n.style=r,this.newSelectionControl(s,o,n)}_initSelectionChangeListener(){this.disposeWithMe(this._refSelectionsService.selectionSet$.subscribe(n=>{this._reset(),this._skeleton&&this.resetSelectionsByModelData(n||[])}))}_initUserActionSyncListener(){this.disposeWithMe(this.selectionMoveStart$.subscribe(n=>{this._updateSelections(n,x.SelectionMoveType.MOVE_START)})),this.disposeWithMe(this.selectionMoving$.subscribe(n=>{this._updateSelections(n,x.SelectionMoveType.MOVING)})),this.disposeWithMe(this.selectionMoveEnd$.subscribe(n=>{this._updateSelections(n,x.SelectionMoveType.MOVE_END)}))}_updateSelections(n,o){const s=this._context.unit.getActiveSheet().getSheetId();n.length!==0&&this._workbookSelections.setSelections(s,n.map(i=>x.convertSelectionDataToRange(i)),o)}_initSkeletonChangeListener(){this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(n=>{var c;if(!n)return;const{skeleton:o}=n,{scene:r}=this._context,s=r.getViewport(j.SHEET_VIEWPORT_KEY.VIEW_MAIN);this._skeleton&&((c=this._skeleton.worksheet)==null?void 0:c.getSheetId())!==o.worksheet.getSheetId()&&this._reset(),this._changeRuntime(o,r,s);const i=this._workbookSelections.getCurrentSelections();this.resetSelectionsByModelData(i)}))}_getActiveViewport(n){const o=this._getSheetObject();return o==null?void 0:o.scene.getActiveViewportByCoord(j.Vector2.FromArray([n.offsetX,n.offsetY]))}_getSheetObject(){return N.getSheetObject(this._context.unit,this._context)}_onPointerDown(n,o=0,r=a.RANGE_TYPE.NORMAL,s,i=j.ScrollTimerType.ALL){var F;this._rangeType=r;const c=this._skeleton,d=this._scene;if(!d||!c)return;s&&(this._activeViewport=s);const{offsetX:f,offsetY:S}=n,p=d.getViewport(j.SHEET_VIEWPORT_KEY.VIEW_MAIN);if(!p)return;const h=d.getCoordRelativeToViewport(j.Vector2.FromArray([f,S])),{x:g,y:u}=h;this._startViewportPosX=g,this._startViewportPosY=u;const m=d.getScrollXYInfoByViewport(h),{scaleX:C,scaleY:_}=d.getAncestorScale(),I=this._skeleton.getCellByOffset(g,u,C,_,m);if(!I)return;switch(r){case a.RANGE_TYPE.NORMAL:break;case a.RANGE_TYPE.ROW:I.startColumn=0,I.endColumn=this._skeleton.getColumnCount()-1;break;case a.RANGE_TYPE.COLUMN:I.startRow=0,I.endRow=this._skeleton.getRowCount()-1;break;case a.RANGE_TYPE.ALL:I.startRow=0,I.startColumn=0,I.endRow=this._skeleton.getRowCount()-1,I.endColumn=this._skeleton.getColumnCount()-1}let T={range:I,primary:I,style:null};(I.isMerged||I.isMergedMainCell)&&(T={range:{...I,startRow:I.startRow,endRow:I.startRow,startColumn:I.startColumn,endColumn:I.startColumn},primary:{...I,actualRow:I.startRow,actualColumn:I.startColumn,startRow:I.startRow,endRow:I.startRow,startColumn:I.startColumn,endColumn:I.startColumn},style:null}),T.range.rangeType=r;const D=N.attachSelectionWithCoord(T,this._skeleton);this._startRangeWhenPointerDown={...D.rangeWithCoord};const v={...D.rangeWithCoord,rangeType:r};let M=this.getActiveSelectionControl();const w=this.getSelectionControls();for(const A of w){if(n.button===2&&a.Rectangle.contains(A.model,v)){M=A;return}if(A.model.isEqual(v)){M=A;break}}this._checkClearPreviousControls(n);const W=M==null?void 0:M.model.currentCell,U=n.shiftKey&&W,P=this._remainLastEnabled&&!n.ctrlKey&&!n.shiftKey&&!this._skipLastEnabled&&!this._singleSelectionEnabled;U&&W?this._makeSelectionByTwoCells(W,v,c,r,M):P&&M?M.updateRangeBySelectionWithCoord(D):M=this.newSelectionControl(d,c,T);for(let A=0;A<this.getSelectionControls().length-1;A++)this.getSelectionControls()[A].clearHighlight();this._selectionMoveStart$.next(this.getSelectionDataWithStyle()),d.disableObjectsEvent(),this._clearUpdatingListeners(),this._addEndingListeners(),(F=d.getTransformer())==null||F.clearSelectedObjects(),this._setupPointerMoveListener(p,M,r,i,g,u),this._escapeShortcutDisposable=this._shortcutService.forceEscape(),this._scenePointerUpSub=d.onPointerUp$.subscribeEvent(()=>{var A;this._clearUpdatingListeners(),this._selectionMoveEnd$.next(this.getSelectionDataWithStyle()),(A=this._escapeShortcutDisposable)==null||A.dispose(),this._escapeShortcutDisposable=null})}newSelectionControl(n,o,r){const s=this.getSelectionControls().length,{rowHeaderWidth:i,columnHeaderHeight:c}=o,d=new N.SelectionControl(n,s,this._themeService,{highlightHeader:this._highlightHeader,enableAutoFill:!1,rowHeaderWidth:i,columnHeaderHeight:c}),f=N.attachSelectionWithCoord(r,o);return d.updateRangeBySelectionWithCoord(f),this._selectionControls.push(d),d.setControlExtension({skeleton:o,scene:n,themeService:this._themeService,injector:this._injector,selectionHooks:{selectionMoveEnd:()=>{this._selectionMoveEnd$.next(this.getSelectionDataWithStyle())}}}),d}},$.RefSelectionsRenderService=_r([De(1,a.Inject(a.Injector)),De(2,a.Inject(a.ThemeService)),De(3,l.IShortcutService),De(4,a.Inject(N.SheetSkeletonManagerService)),De(5,a.IContextService),De(6,x.IRefSelectionsService)],$.RefSelectionsRenderService);function Er(e){const t=N.genNormalSelectionStyle(e);return t.widgets={tl:!0,tc:!0,tr:!0,ml:!0,mr:!0,bl:!0,bc:!0,br:!0},t}const dt=(e,t,n=!0)=>{let o=-1;return e.reduce((r,s,i)=>{if(r.isFinish)return r;const c=r.currentIndex;if(typeof s!="string")r.currentIndex+=s.token.length;else{const d=s.length;r.currentIndex+=d}return(n?r.currentIndex===t:t>c&&t<=r.currentIndex)&&(o=i,r.isFinish=!0),r},{currentIndex:0,isFinish:!1}),o},Ft=(e,t)=>{const n=e[t];let o=-1;if(!n||typeof n=="string"||n.nodeType!==R.sequenceNodeType.REFERENCE)return-1;for(let r=0;r<=t;r++){const s=e[r];typeof s!="string"&&s.nodeType===R.sequenceNodeType.REFERENCE&&o++}return o},Ir=(e,t=100)=>{E.useEffect(()=>{let n=null;const o=()=>{n===null&&(n=window.setTimeout(()=>{e(),n=null},t))};return window.addEventListener("scroll",o),window.addEventListener("resize",o),()=>{n!==null&&clearTimeout(n),window.removeEventListener("scroll",o),window.removeEventListener("resize",o)}},[e,t])};function Wt(e,t,n){const o=l.useDependency(Q.IEditorService),r=E.useMemo(()=>new q.BehaviorSubject({left:-999,top:-999,right:-999,bottom:-999}),[]),s=l.useDependency(l.ISidebarService),i=l.useDependency(a.IUniverInstanceService),c=l.useEvent(()=>{var T;const d=o.getEditor(e);if(!d)return;const f=d.getBoundingClientRect(),{marginTop:S=0,marginBottom:p=0}=d.getDocumentData().documentStyle,h=d.getSkeleton();if(!h)return;const g=(T=h.getSkeletonData())==null?void 0:T.pages[0].height;let{left:u,top:m,right:C,bottom:_}=f;m=m+S,_=g?m+g:_-p;const I=r.getValue();if(!(I.left===u&&I.top===m&&I.right===C&&I.bottom===_))return r.next({left:u-1,right:C+1,top:m-1,bottom:_+1}),f});return E.useEffect(()=>{t&&c()},[e,o,i.unitAdded$,c,t,...n!=null?n:[]]),Ir(c),E.useEffect(()=>{const d=s.scrollEvent$.pipe(q.throttleTime(100)).subscribe(c);return()=>{d.unsubscribe()}},[]),[r,c]}const Te=e=>{const t=E.useRef(e);return t.current=e,t},yr=(e,t,n)=>{const o=l.useDependency(Ve),r=l.useDependency(ge.IDescriptionService),s=l.useDependency(R.LexerTreeBuilder),[i,c]=E.useState(),[d,f]=E.useState(-1),[S,p]=E.useState(!0),h=Te(S),g=E.useRef(t);g.current=t;const u=()=>{c(void 0),f(-1),p(!1)};return E.useEffect(()=>{const m=s.sequenceNodesBuilder(t.slice(1));o.setSequenceNodes(m!=null?m:[])},[t]),E.useEffect(()=>{if(n&&e){const m=n.selectionChange$.pipe(q.debounceTime(50)).subscribe(_=>{if(_.textRanges.length===1){const[I]=_.textRanges;if(I.collapsed&&h.current){const{startOffset:T}=I,D=o.getCurrentSequenceNodeIndex(T-2),v=o.getCurrentSequenceNodeByIndex(D),M=o.getCurrentSequenceNodeByIndex(D+1);if(v)if(typeof v!="string"&&v.nodeType===3&&!r.hasDefinedNameDescription(v.token.trim())&&M===R.matchToken.OPEN_BRACKET){const w=r.getFunctionInfo(v.token);c(w),f(-1);return}else{const w=s.getFunctionAndParameter(`${g.current}A`,T-1);if(w){const{functionName:W,paramIndex:U}=w,P=r.getFunctionInfo(W);c(P),f(U);return}}}}c(void 0),f(-1)}),C=n.selectionChange$.pipe(q.filter(_=>_.textRanges.length===1),q.map(_=>_.textRanges[0].startOffset),q.distinctUntilChanged()).subscribe(()=>{p(!0)});return()=>{m.unsubscribe(),C.unsubscribe()}}},[n,e]),E.useEffect(()=>{e||u()},[e]),{functionInfo:i,paramIndex:d,reset:u}},Rr=({onClick:e})=>y.jsx("div",{className:"univer-z-[15] univer-box-border univer-h-[18px] univer-cursor-pointer univer-overflow-visible univer-whitespace-nowrap univer-rounded-l univer-border univer-border-r-0 univer-border-gray-600 univer-bg-primary-600 univer-p-0.5 univer-text-xs univer-font-bold univer-leading-[13px] univer-text-white",onClick:e,children:"?"}),ft=({className:e,title:t,value:n})=>y.jsxs("div",{className:"univer-my-2",children:[y.jsx("div",{className:B.clsx("univer-mb-2 univer-text-sm univer-font-medium univer-text-gray-900 dark:!univer-text-white",e),children:t}),y.jsx("div",{className:"univer-whitespace-pre-wrap univer-break-words univer-text-xs univer-text-gray-500",children:n})]}),Tr=e=>{const{prefix:t,value:n,active:o,onClick:r}=e;return y.jsxs("div",{children:[y.jsxs("span",{children:[t,"("]}),n&&n.map((s,i)=>y.jsxs("span",{children:[y.jsx("span",{className:o===i?"univer-text-primary-500":"",onClick:()=>r(i),children:Nt(s)}),i===n.length-1?"":","]},s.name)),")"]})},Ut=()=>{};function br(e){const{onParamsSwitch:t=Ut,onClose:n=Ut,isFocus:o,editor:r,formulaText:s}=e,{functionInfo:i,paramIndex:c,reset:d}=yr(o,s,r),f=l.useDependency(N.IEditorBridgeService),S=!l.useObservable(f.helpFunctionVisible$),[p,h]=E.useState(!0),g=l.useDependency(a.LocaleService),u=g.t("formula.prompt.required"),m=g.t("formula.prompt.optional"),C=r.getEditorId(),[_]=Wt(C,!!i,[i,c]);function I(v){t&&t(v)}const T=l.useEvent(v=>{f.helpFunctionVisible$.next(!v)}),D=()=>{T(!0),n()};return i?S?y.jsx(l.RectPopup,{portal:!0,anchorRect$:_,direction:"left-center",children:y.jsx(Rr,{onClick:()=>T(!1)})},"hidden"):y.jsx(l.RectPopup,{portal:!0,onClickOutside:()=>d(),anchorRect$:_,direction:"vertical",children:y.jsxs("div",{className:B.clsx("univer-m-0 univer-box-border univer-w-[250px] univer-select-none univer-list-none univer-rounded-lg univer-bg-white univer-leading-5 univer-shadow-md univer-outline-none dark:!univer-bg-gray-900",B.borderClassName),children:[y.jsxs("div",{className:B.clsx("univer-wrap-anywhere univer-box-border univer-flex univer-items-center univer-justify-between univer-px-4 univer-py-3 univer-text-xs univer-font-medium univer-text-gray-900 dark:!univer-text-white",B.borderTopClassName),children:[y.jsx(Tr,{prefix:i.functionName,value:i.functionParameter,active:c,onClick:I}),y.jsxs("div",{className:"univer-flex",children:[y.jsx("div",{className:"univer-ml-2 univer-flex univer-h-6 univer-w-6 univer-cursor-pointer univer-items-center univer-justify-center univer-rounded univer-bg-transparent univer-p-0 univer-text-xs univer-text-gray-500 univer-outline-none univer-transition-colors hover:univer-bg-gray-200 dark:hover:!univer-bg-gray-600",style:{transform:p?"rotateZ(-90deg)":"rotateZ(90deg)"},onClick:()=>h(!p),children:y.jsx(Lt,{})}),y.jsx("div",{className:"univer-ml-2 univer-flex univer-h-6 univer-w-6 univer-cursor-pointer univer-items-center univer-justify-center univer-rounded univer-bg-transparent univer-p-0 univer-text-xs univer-text-gray-600 univer-outline-none univer-transition-colors hover:univer-bg-gray-300 dark:!univer-text-gray-200 dark:hover:!univer-bg-gray-600",onClick:D,children:y.jsx(At,{})})]})]}),y.jsx("div",{className:B.clsx("univer-box-border univer-max-h-[350px] univer-overflow-y-auto univer-px-4 univer-pb-3 univer-pt-0",B.scrollbarClassName),style:{height:p?"unset":0,padding:p?"revert-layer":0},children:y.jsxs("div",{className:"univer-mt-3",children:[y.jsx(ft,{title:g.t("formula.prompt.helpExample"),value:`${i.functionName}(${i.functionParameter.map(v=>v.example).join(",")})`}),y.jsx(ft,{title:g.t("formula.prompt.helpAbstract"),value:i.description}),i&&i.functionParameter&&i.functionParameter.map((v,M)=>y.jsx(ft,{className:c===M?"univer-text-primary-500":"",title:v.name,value:`${v.require?u:m} ${v.detail}`},M))]})})]})},"show"):null}const Mr=e=>{const t=l.useDependency(Q.IEditorService);return l.useEvent(o=>{var r,s;if(e){t.focus(e.getEditorId());const i=[...e.getSelectionRanges()];if(a.Tools.isDefine(o))e.setSelectionRanges([{startOffset:o,endOffset:o}]);else if(!i.length&&!e.docSelectionRenderService.isOnPointerEvent){const c=(s=(r=e.getDocumentData().body)==null?void 0:r.dataStream)!=null?s:`\r
`,d=Math.max(c.length-2,0);e.setSelectionRanges([{startOffset:d,endOffset:d}])}else e.setSelectionRanges(i)}})};function Or(e){var r,s;const n=e.get(a.IUniverInstanceService).getCurrentUniverDocInstance();return n!=null&&n.getBody()?{dataStream:(s=(r=n.getBody())==null?void 0:r.dataStream)!=null?s:"",offset:0}:void 0}var Se=(e=>(e[e.NOT_SELECT=0]="NOT_SELECT",e[e.NEED_ADD=1]="NEED_ADD",e[e.CAN_EDIT=2]="CAN_EDIT",e[e.EDIT_OTHER_SHEET_REFERENCE=3]="EDIT_OTHER_SHEET_REFERENCE",e[e.EDIT_OTHER_WORKBOOK_REFERENCE=4]="EDIT_OTHER_WORKBOOK_REFERENCE",e))(Se||{});function Nr(e){var w;const{editorId:t,isFocus:n,disableOnClick:o,unitId:r,subUnitId:s}=e,i=l.useDependency(j.IRenderManagerService),c=l.useDependency(a.IUniverInstanceService),d=i.getRenderById(r),f=i.getRenderById(t),S=f==null?void 0:f.with(Q.DocSelectionRenderService),p=l.useDependency(pt.DocSelectionManagerService),h=l.useDependency(a.Injector),[g,u]=E.useState(0),m=l.useDependency(R.LexerTreeBuilder),C=E.useRef(!0),_=d==null?void 0:d.with($.RefSelectionsRenderService),I=Te(g),T=c.getUnit(r,a.UniverInstanceType.UNIVER_SHEET),D=T==null?void 0:T.getSheetBySheetId(s),v=l.useEvent(W=>{_&&_.setSkipLastEnabled(W===1||W===3||W===4),I.current=W,u(W)}),M=l.useEvent(()=>{var oe,se,ae;const W=c.getCurrentUnitOfType(a.UniverInstanceType.UNIVER_SHEET);if(!W)return;const U=W.getActiveSheet(),P=S==null?void 0:S.getActiveTextRange(),F=P!=null&&P.collapsed?P.startOffset:-1,A=Or(h);if(!A)return;const O=(oe=A==null?void 0:A.dataStream)==null?void 0:oe.slice(0,-2),L=((se=m.sequenceNodesBuilder(O))!=null?se:[]).map(G=>typeof G=="object"?G.nodeType===R.sequenceNodeType.REFERENCE?{...G,range:R.deserializeRangeWithSheetWithCache(G.token)}:{...G,range:void 0}:G),b=O[F-1],k=O[F],V=L.find(G=>typeof G=="object"&&G.nodeType===R.sequenceNodeType.REFERENCE&&F===G.endIndex+2),H=b&&R.matchRefDrawToken(b)&&(!k||R.isFormulaLexerToken(k)&&k!==R.matchToken.OPEN_BRACKET),K=!!V;if((O==null?void 0:O.substring(0,1))==="="&&(H||K))if(K){if(C.current)return;const{sheetName:G,unitId:J}=V.range,ke=(ae=c.getCurrentUnitOfType(a.UniverInstanceType.UNIVER_SHEET))==null?void 0:ae.getUnitId();J&&J!==ke?v(4):!G&&U.getSheetId()===(D==null?void 0:D.getSheetId())||G===U.getName()?v(2):v(3)}else C.current=!1,v(1);else v(0)});return E.useEffect(()=>{const W=p.textSelection$.pipe(q.filter(U=>U.unitId===t)).subscribe(()=>{M()});return()=>W.unsubscribe()},[M,p.textSelection$,t]),E.useEffect(()=>{n||(v(0),C.current=!0)},[n,v]),E.useEffect(()=>{var U;if(!o)return;const W=(U=f==null?void 0:f.mainComponent)==null?void 0:U.onPointerDown$.subscribeEvent(()=>{v(0),C.current=!0});return()=>W==null?void 0:W.unsubscribe()},[o,(w=f==null?void 0:f.mainComponent)==null?void 0:w.onPointerDown$,v]),E.useEffect(()=>{if(!n)return;const W=T==null?void 0:T.activeSheet$.subscribe(()=>{M()}),U=c.getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET).subscribe(()=>{M()});return()=>{W==null||W.unsubscribe(),U==null||U.unsubscribe()}},[M,n,T==null?void 0:T.activeSheet$,c.getCurrentTypeOfUnit$]),{isSelecting:g,isSelectingRef:I}}const Dr=()=>{const e=l.useDependency(R.LexerTreeBuilder);return E.useCallback(n=>e.sequenceNodesBuilder(n)||[],[e])};function kr(e,t,n){const o=new a.ColorKit(t).setAlpha(.05).toRgbString();return{id:n,strokeWidth:1,stroke:t,fill:o,widgets:{tl:!0,tc:!0,tr:!0,ml:!0,mr:!0,bl:!0,bc:!0,br:!0},widgetSize:6,widgetStrokeWidth:1,widgetStroke:e.getColorFromTheme("white")}}function Vt(e){var T,D,v;const{unitId:t,subUnitId:n,currentWorkbook:o,refSelections:r,editor:s,refSelectionsService:i,refSelectionsRenderService:c,sheetSkeletonManagerService:d,themeService:f,univerInstanceService:S}=e,p=o.getUnitId(),h=S.getUnit(t,a.UniverInstanceType.UNIVER_SHEET),g=h==null?void 0:h.getActiveSheet(),u=[];if(!h||!g){i.setSelections(u);return}const m=g.getSheetId(),C=M=>{var w;return(w=h==null?void 0:h.getSheetBySheetName(M))==null?void 0:w.getSheetId()};if(!((T=d==null?void 0:d.getWorksheetSkeleton(m))==null?void 0:T.skeleton))return;const I=[];for(let M=0,w=r.length;M<w;M++){const W=r[M],{themeColor:U,token:P,refIndex:F,endIndex:A}=W,O=R.deserializeRangeWithSheet(P),{unitId:L,sheetName:b,range:k}=O,V=C(b);if(!V&&b||p!==t&&L!==p||L&&L!==p||V&&V!==m||!V&&m!==n)continue;const H=x.setEndForRange(k,g.getRowCount(),g.getColumnCount());H.unitId=t,H.sheetId=m,u.push({range:H,primary:null,style:kr(f,U,F.toString())}),I.push(A)}if(s){const M=(v=(D=s.getSelectionRanges())==null?void 0:D[0])==null?void 0:v.startOffset,w=I.findIndex(W=>W+2===M);w!==-1?c==null||c.setActiveSelectionIndex(w):c==null||c.resetActiveSelectionIndex()}return u}function wr(e,t){const n=l.useDependency(a.IUniverInstanceService),o=l.useDependency(a.ThemeService),r=l.useDependency(x.IRefSelectionsService),s=l.useDependency(j.IRenderManagerService),i=l.useObservable(E.useMemo(()=>n.getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET),[n])),c=i?s.getRenderById(i.getUnitId()):null,d=c==null?void 0:c.with($.RefSelectionsRenderService),f=c==null?void 0:c.with(N.SheetSkeletonManagerService),S=l.useEvent((p,h)=>{const g=n.getCurrentUnitOfType(a.UniverInstanceType.UNIVER_SHEET);if(!g||d!=null&&d.selectionMoving)return;const u=Vt({unitId:e,subUnitId:t,currentWorkbook:g,refSelections:p,editor:h,refSelectionsService:r,refSelectionsRenderService:d,sheetSkeletonManagerService:f,themeService:o,univerInstanceService:n});if(!u)return;((d==null?void 0:d.getSelectionControls())||[]).length===u.length?d==null||d.resetSelectionsByModelData(u):r.setSelections(u)});return E.useEffect(()=>()=>{d==null||d.resetActiveSelectionIndex()},[d]),S}function Ht(e=""){const t=l.useDependency(ge.IDescriptionService),n=Ar(),o=l.useDependency(a.ICommandService),r=E.useMemo(()=>e.length,[e]);return l.useEvent((i,c,d=!0,f)=>{const S=i.getDocumentData(),p=i.getEditorId();if(!S)return[];const h=S.body;if(!h)return[];const g=h.dataStream.slice(0,h.dataStream.length-2),u={dataStream:"",...S.body};if(!g.startsWith(e))return[];if(c==null||c.length===0)return u.textRuns=[],o.syncExecuteCommand(Q.ReplaceTextRunsCommand.id,{unitId:p,body:a.getBodySlice(u,0,u.dataStream.length-2)}),[];{const{textRuns:m,refSelections:C}=xr(t,n,c);r&&m.forEach(T=>{T.ed=T.ed+r,T.st=T.st+r}),u.textRuns=[{st:0,ed:1,ts:{fs:11}},...m];const _=c.reduce((T,D)=>typeof D=="string"?`${T}${D}`:`${T}${D.token}`,"");u.dataStream=`${e}${_}\r
`;let I;if(d){I=i.getSelectionRanges();const T=u.dataStream.length-2+r;I.forEach(D=>{D.startOffset=Math.max(0,Math.min(D.startOffset,T)),D.endOffset=Math.max(0,Math.min(D.endOffset,T))})}return o.syncExecuteCommand(Q.ReplaceTextRunsCommand.id,{unitId:p,body:a.getBodySlice(u,0,u.dataStream.length-2),textRanges:f!=null?f:I}),C}})}function Ar(){const e=l.useDependency(a.ThemeService),t=e.getCurrentTheme();return E.useMemo(()=>{const o=[e.getColorFromTheme("loop-color.1"),e.getColorFromTheme("loop-color.2"),e.getColorFromTheme("loop-color.3"),e.getColorFromTheme("loop-color.4"),e.getColorFromTheme("loop-color.5"),e.getColorFromTheme("loop-color.6"),e.getColorFromTheme("loop-color.7"),e.getColorFromTheme("loop-color.8"),e.getColorFromTheme("loop-color.9"),e.getColorFromTheme("loop-color.10"),e.getColorFromTheme("loop-color.11"),e.getColorFromTheme("loop-color.12")].map(c=>e.isValidThemeColor(c)?e.getColorFromTheme(c):c),r=e.getColorFromTheme("blue.700"),s=e.getColorFromTheme("jiqing.800"),i=e.getColorFromTheme("black");return{formulaRefColors:o,numberColor:r,stringColor:s,plainTextColor:i}},[t])}function xr(e,t,n){const{formulaRefColors:o,numberColor:r,stringColor:s,plainTextColor:i}=t,c=[],d=[],f=new Map;let S=0;for(let p=0,h=n.length;p<h;p++){const g=n[p];if(typeof g=="string"){const T=c[c.length-1],D=T?T.ed:0,v=D+g.length;c.push({st:D,ed:v,ts:{cl:{rgb:i},fs:11}});continue}if(e.hasDefinedNameDescription(g.token.trim())){c.push({st:g.startIndex,ed:g.endIndex+1,ts:{cl:{rgb:i},fs:11}});continue}const{startIndex:u,endIndex:m,nodeType:C,token:_}=g;let I="";if(C===R.sequenceNodeType.REFERENCE){if(f.has(_))I=f.get(_);else{const T=S%o.length;I=o[T],f.set(_,I),S++}d.push({refIndex:p,themeColor:I,token:_,startIndex:g.startIndex,endIndex:g.endIndex,index:d.length})}else C===R.sequenceNodeType.NUMBER?I=r:(C===R.sequenceNodeType.STRING||C===R.sequenceNodeType.ARRAY)&&(I=s);I&&I.length>0?c.push({st:u,ed:m+1,ts:{cl:{rgb:I},fs:11}}):c.push({st:u,ed:m+1,ts:{cl:{rgb:i},fs:11}})}return{textRuns:c,refSelections:d}}const Pr=(e,t,n,o)=>{const r=l.useDependency(a.ICommandService),s=l.useDependency(l.IShortcutService),i=E.useRef(t);i.current=t;const c=E.useRef(o);c.current=o,E.useEffect(()=>{if(!n||!e)return;const f=`sheet.formula-embedding-editor.${n.getEditorId()}`,S=new a.DisposableCollection,p=(u,m)=>{if(c.current){c.current(u,m);return}let C=a.Direction.LEFT;u===l.KeyCode.ARROW_DOWN?C=a.Direction.DOWN:u===l.KeyCode.ARROW_UP?C=a.Direction.UP:u===l.KeyCode.ARROW_RIGHT&&(C=a.Direction.RIGHT),m===l.MetaKeys.SHIFT?r.executeCommand(Q.MoveSelectionOperation.id,{direction:C}):r.executeCommand(Q.MoveCursorOperation.id,{direction:C})},h=(u,m)=>{let C=a.Direction.DOWN;u===l.KeyCode.ARROW_DOWN?C=a.Direction.DOWN:u===l.KeyCode.ARROW_UP?C=a.Direction.UP:u===l.KeyCode.ARROW_LEFT?C=a.Direction.LEFT:u===l.KeyCode.ARROW_RIGHT&&(C=a.Direction.RIGHT),i.current?m===l.MetaKeys.CTRL_COMMAND?r.executeCommand(N.MoveSelectionCommand.id,{direction:C,jumpOver:N.JumpOver.moveGap,extra:"formula-editor",fromCurrentSelection:i.current===Se.NEED_ADD||i.current===Se.EDIT_OTHER_SHEET_REFERENCE}):m===l.MetaKeys.SHIFT?r.executeCommand(N.ExpandSelectionCommand.id,{direction:C,extra:"formula-editor"}):m===(l.MetaKeys.CTRL_COMMAND|l.MetaKeys.SHIFT)?r.executeCommand(N.ExpandSelectionCommand.id,{direction:C,jumpOver:N.JumpOver.moveGap,extra:"formula-editor"}):r.executeCommand(N.MoveSelectionCommand.id,{direction:C,extra:"formula-editor",fromCurrentSelection:i.current===Se.NEED_ADD||i.current===Se.EDIT_OTHER_SHEET_REFERENCE}):p(u,m)};return S.add(r.registerCommand({id:f,type:a.CommandType.OPERATION,handler(u,m){const{keyCode:C,metaKey:_}=m;h(C,_)}})),[{keyCode:l.KeyCode.ARROW_DOWN},{keyCode:l.KeyCode.ARROW_LEFT},{keyCode:l.KeyCode.ARROW_RIGHT},{keyCode:l.KeyCode.ARROW_UP},{keyCode:l.KeyCode.ARROW_DOWN,metaKey:l.MetaKeys.SHIFT},{keyCode:l.KeyCode.ARROW_LEFT,metaKey:l.MetaKeys.SHIFT},{keyCode:l.KeyCode.ARROW_RIGHT,metaKey:l.MetaKeys.SHIFT},{keyCode:l.KeyCode.ARROW_UP,metaKey:l.MetaKeys.SHIFT},{keyCode:l.KeyCode.ARROW_DOWN,metaKey:l.MetaKeys.CTRL_COMMAND},{keyCode:l.KeyCode.ARROW_LEFT,metaKey:l.MetaKeys.CTRL_COMMAND},{keyCode:l.KeyCode.ARROW_RIGHT,metaKey:l.MetaKeys.CTRL_COMMAND},{keyCode:l.KeyCode.ARROW_UP,metaKey:l.MetaKeys.CTRL_COMMAND},{keyCode:l.KeyCode.ARROW_DOWN,metaKey:l.MetaKeys.CTRL_COMMAND|l.MetaKeys.SHIFT},{keyCode:l.KeyCode.ARROW_LEFT,metaKey:l.MetaKeys.CTRL_COMMAND|l.MetaKeys.SHIFT},{keyCode:l.KeyCode.ARROW_RIGHT,metaKey:l.MetaKeys.CTRL_COMMAND|l.MetaKeys.SHIFT},{keyCode:l.KeyCode.ARROW_UP,metaKey:l.MetaKeys.CTRL_COMMAND|l.MetaKeys.SHIFT}].map(({keyCode:u,metaKey:m})=>({id:f,binding:m?u|m:u,preconditions:()=>!0,priority:900,staticParameters:{eventType:j.DeviceInputEventType.Keyboard,keyCode:u,metaKey:m}})).forEach(u=>{S.add(s.registerShortcut(u))}),()=>{S.dispose()}},[r,n,e,s])},Lr=(e,t,n,o,r=!0)=>{var g;const s=l.useDependency(j.IRenderManagerService),i=l.useDependency(a.IContextService),c=l.useDependency(l.IContextMenuService),d=l.useDependency(x.IRefSelectionsService),f=l.useDependency(a.IUniverInstanceService),S=l.useObservable(E.useMemo(()=>f.getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET),[f])),p=s.getRenderById((g=S==null?void 0:S.getUnitId())!=null?g:""),h=p==null?void 0:p.with($.RefSelectionsRenderService);E.useLayoutEffect(()=>{if(e)return i.setContextValue(a.EDITOR_ACTIVATED,!0),r&&c.disable(),()=>{const u=f.getCurrentUnitOfType(a.UniverInstanceType.UNIVER_DOC);(u==null?void 0:u.getUnitId())===o&&i.setContextValue(a.EDITOR_ACTIVATED,!1),r&&c.enable(),d.clear()}},[i,e,d,r,o]),E.useLayoutEffect(()=>{if(e&&t){const u=h==null?void 0:h.enableSelectionChanging();return i.setContextValue(x.REF_SELECTIONS_ENABLED,!0),()=>{i.setContextValue(x.REF_SELECTIONS_ENABLED,!1),u==null||u.dispose()}}},[i,e,h,t]),E.useEffect(()=>{e&&(h==null||h.setSkipLastEnabled(!1))},[e,h])},$r=(e,t,n)=>{const o=l.useDependency(a.IUniverInstanceService),r=l.useDependency(x.SheetsSelectionsService);return E.useCallback(()=>{if(e){const i=[...r.getWorkbookSelections(t).getSelectionsOfWorksheet(n)],c=o.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),d=c==null?void 0:c.getActiveSheet();(c==null?void 0:c.getUnitId())!==t&&o.setCurrentUnitForType(t),d&&d.getSheetId()===n&&r.setSelections(i)}},[e,r,n,t,o])},Fr=e=>e.reduce((t,n)=>typeof n=="string"?t+n.length:t+n.token.length,0),ht=e=>e.map(t=>typeof t=="string"?t:t.token).join(""),Xe=(e,t=!1,n="",o=!1)=>!t&&!o?e.map(r=>R.serializeRange(r.range)):e.map(r=>o?R.serializeRangeToRefString(r):r.sheetName!==""&&r.sheetName!==n?R.serializeRangeWithSheet(r.sheetName,r.range):R.serializeRange(r.range)),Wr=e=>{var S,p,h;const{editor:t,lexerTreeBuilder:n}=e,o=t==null?void 0:t.getSelectionRanges();if((o==null?void 0:o.length)!==1)return;const s=o[0].startOffset-1,i=((p=(S=t==null?void 0:t.getDocumentData().body)==null?void 0:S.dataStream)!=null?p:`\r
`).slice(0,-2),c=(h=n.sequenceNodesBuilder(i.slice(1)))!=null?h:[],d=dt(c,s,!1),f=Ft(c,d);return{nodeIndex:d,updatingRefIndex:f,sequenceNodes:c,offset:s}},Ur=(()=>{}),Vr=(e,t,n,o,r,s,i,c,d,f=Ur)=>{var F;const S=l.useDependency(j.IRenderManagerService),p=l.useDependency(a.IUniverInstanceService),h=l.useDependency(a.ICommandService),g=l.useDependency(pt.DocSelectionManagerService),u=l.useDependency(a.ThemeService),m=l.useDependency(R.LexerTreeBuilder),C=p.getUnit(o),_=l.useEvent((A,O)=>{var L,b,k;return(k=(b=(L=p.getUnit(A))==null?void 0:L.getSheetBySheetId(O))==null?void 0:b.getName())!=null?k:""}),I=E.useMemo(()=>_(o,r),[_,r,o]),T=l.useObservable(C==null?void 0:C.activeSheet$),D=Te({activeSheet:T,sheetName:I}),v=l.useObservable(E.useMemo(()=>p.getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET),[p])),M=S.getRenderById((F=v==null?void 0:v.getUnitId())!=null?F:""),w=M==null?void 0:M.with($.RefSelectionsRenderService),W=M==null?void 0:M.with(N.SheetSkeletonManagerService),U=l.useDependency(x.IRefSelectionsService),P=l.useEvent((A,O,L)=>{var oe,se,ae,G,J,ke,we,Je,pe,et;const b=Wr({editor:d,lexerTreeBuilder:m});if(!b)return;const{nodeIndex:k,updatingRefIndex:V,sequenceNodes:H,offset:K}=b;if(n.current===Se.NEED_ADD)if(K!==0){if(k===-1&&H.length)return;const z=A[A.length-1],ee=H.splice(k+1),le=(oe=z.sheetId)!=null?oe:r,te={range:z,unitId:(se=z.unitId)!=null?se:v.getUnitId(),sheetName:_((ae=z.unitId)!=null?ae:v.getUnitId(),le)},ie=le!==r,ue=(v==null?void 0:v.getUnitId())!==o,fe=Xe([te],i&&(ie||ue),I,ue);H.push({token:fe[0],nodeType:R.sequenceNodeType.REFERENCE});const be=[...H,...ee],Me=ht(be);f(Me,Fr(H),O)}else{const z=A[A.length-1],ee=(G=z.sheetId)!=null?G:r,le={range:z,unitId:(J=z.unitId)!=null?J:v.getUnitId(),sheetName:_((ke=z.unitId)!=null?ke:v.getUnitId(),ee)},te=ee!==r,ie=(v==null?void 0:v.getUnitId())!==o,ue=Xe([le],i&&(te||ie),I,ie);H.unshift({token:ue[0],nodeType:R.sequenceNodeType.REFERENCE});const fe=ht(H);f(fe,ue[0].length,O)}else if(n.current===Se.EDIT_OTHER_SHEET_REFERENCE||n.current===Se.EDIT_OTHER_WORKBOOK_REFERENCE){const z=A.pop();if(!z)return;const ee=H[k];if(typeof ee=="object"&&ee.nodeType===R.sequenceNodeType.REFERENCE){const le=ee.token;(v==null?void 0:v.getUnitId())!==o?ee.token=R.serializeRangeWithSpreadsheet((we=v==null?void 0:v.getUnitId())!=null?we:"",I,z):ee.token=I===(T==null?void 0:T.getName())?R.serializeRange(z):R.serializeRangeWithSheet(T.getName(),z);const ie=K+(ee.token.length-le.length);f(R.generateStringWithSequence(H),ie,O)}}else{const z=[...A];if(!L&&V!==-1){const Z=z.pop();Z&&z.splice(V,0,Z)}let ee=0;const le=H.map(Z=>{var he,me,Ae,Oe;if(typeof Z=="string")return Z;if(Z.nodeType===R.sequenceNodeType.REFERENCE){const de=R.deserializeRangeWithSheet(Z.token);if(de.sheetName||(de.sheetName=I),(de.unitId||o)!==(v==null?void 0:v.getUnitId())||i&&((he=D.current.activeSheet)==null?void 0:he.getName())!==de.sheetName)return Z.token;const ne=z[ee];if(ee++,!ne)return"";const Fe=(me=ne.sheetId)!=null?me:r,St={range:ne,unitId:(Ae=ne.unitId)!=null?Ae:v.getUnitId(),sheetName:_((Oe=ne.unitId)!=null?Oe:v.getUnitId(),Fe)},tt=(v==null?void 0:v.getUnitId())!==o;return Xe([St],i&&(Fe!==r||tt),I,tt)[0]}return Z.token});let te="",ie;le.forEach((Z,he)=>{te+=Z,he===k&&(ie=te.length)});const ue=[];for(let Z=ee;Z<=A.length-1;Z++){const he=A[Z],me=(Je=he.sheetId)!=null?Je:r,Ae={range:he,unitId:(pe=he.unitId)!=null?pe:v.getUnitId(),sheetName:_((et=he.unitId)!=null?et:v.getUnitId(),me)},Oe=(v==null?void 0:v.getUnitId())!==o,ne=Xe([Ae],i&&(me!==r||Oe),I,Oe);ue.push(ne[0])}const fe=H[H.length-1],be=fe&&(typeof fe=="string"?!1:fe.nodeType===R.sequenceNodeType.REFERENCE),Me=`${te}${ue.length&&be?",":""}${ue.join(",")}`;f(Me,!ue.length&&ie?ie:Me.length,O)}});E.useEffect(()=>{if(w&&e){let A=!0,O=0;const L=(k,V)=>{if(A){A=!1,O=k.length;return}const H=k.length>O;V&&(O=k.length),P(k.map(K=>K.rangeWithCoord),V,H)},b=new a.DisposableCollection;return b.add(w.selectionMoving$.subscribe(k=>{L(k,!1)})),b.add(w.selectionMoveEnd$.subscribe(k=>{L(k,!0)})),()=>{b.dispose()}}},[e,P,w]),E.useEffect(()=>{if(t&&w&&d){const A=new a.DisposableCollection,O=()=>{A.dispose(),w.getSelectionControls().forEach((k,V)=>{A.add(k.selectionScaling$.subscribe(H=>{const K=w.getSelectionDataWithStyle().map(se=>se.rangeWithCoord),oe=K[V];H.sheetId=oe.sheetId,H.unitId=oe.unitId,K[V]=H,P(K,!1)})),A.add(k.selectionMoving$.subscribe(H=>{const K=w.getSelectionDataWithStyle().map(se=>se.rangeWithCoord),oe=K[V];H.sheetId=oe.sheetId,H.unitId=oe.unitId,K[V]=H,P(K,!0)}))})},L=q.merge(d.input$,U.selectionSet$,w.selectionMoveEnd$).pipe(tn.debounceTime(50)).subscribe(()=>{O()});return()=>{L.unsubscribe(),A.dispose()}}},[d,t,P,w,U.selectionSet$]),w==null||w.getSelectionDataWithStyle(),E.useEffect(()=>{if(c){const A=h.onCommandExecuted(O=>{var b;if(O.id!==x.SetSelectionsOperation.id)return;const L=O.params;if(L.extra==="formula-editor"&&L.selections.length){const k=L.selections[L.selections.length-1];if(k){const V=n.current===Se.NEED_ADD,H=((b=w==null?void 0:w.getSelectionDataWithStyle())!=null?b:[]).map(K=>K.rangeWithCoord);V?H.push(k.range):H[H.length-1]=k.range,P(H,!0)}}});return()=>{A.dispose()}}},[h,d,n,m,c,P,w]),E.useEffect(()=>{if(!d)return;const A=g.textSelection$.subscribe(O=>{O.unitId===d.getEditorId()&&Vt({unitId:o,subUnitId:r,refSelections:s.current,editor:d,refSelectionsService:U,refSelectionsRenderService:w,sheetSkeletonManagerService:W,themeService:u,univerInstanceService:p,currentWorkbook:v})});return()=>A.unsubscribe()},[g.textSelection$,d,s,w,U,W,r,u,o,p])},Hr=(e,t,n,o,r,s)=>{const i=l.useDependency(a.ICommandService),c=l.useDependency(Q.IEditorService),f=l.useDependency(j.IRenderManagerService).getRenderById(t),S=l.useDependency(a.IUniverInstanceService),p=f==null?void 0:f.with($.RefSelectionsRenderService);E.useEffect(()=>{if(e&&p)if(n){const h=()=>{const m=p.getSelectionControls().length;for(let C=1;C<=m;C++)p.clearLastSelection();return setTimeout(()=>{s()},30)},g=i.onCommandExecuted(m=>{m.id===x.SetWorksheetActiveOperation.id&&h()}),u=S.getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_SHEET).subscribe(m=>{h()});return()=>{g.dispose(),u.unsubscribe()}}else{const h=i.beforeCommandExecuted(g=>{if(g.id===x.SetWorksheetActiveOperation.id){o(!1),r(),s();const u=c.getEditor(a.DOCS_NORMAL_EDITOR_UNIT_ID_KEY);u==null||u.focus()}});return()=>{h.dispose()}}},[e,p])},Br=(e,t,n)=>{const o=l.useDependency(R.LexerTreeBuilder),r=E.useRef(!0);E.useEffect(()=>{if(e){const s=setTimeout(()=>{r.current=!1},500);return()=>{clearTimeout(s)}}},[e]),E.useEffect(()=>{if(!r.current&&t){const s=o.checkIfAddBracket(n);t(s===0&&n.startsWith(R.operatorToken.EQUALS),`${n}`)}},[n,t])},Kr=(e,t=[],n)=>{const o=l.useDependency(ge.IDescriptionService),[r,s]=E.useState([]),[i,c]=E.useState(""),d=E.useRef(-1),f=Te({nodes:t}),S=()=>{s([]),c(""),d.current=-1};return E.useEffect(()=>{if(n&&e){const h=n.input$.pipe(q.debounceTime(300)).subscribe(()=>{const g=n.getSelectionRanges();if(g.length===1){const u=f.current.nodes,m=g[0];if(m.collapsed){const C=dt(u,m.startOffset-1,!1);d.current=C;const _=u[C];if(_&&typeof _!="string"&&_.nodeType===R.sequenceNodeType.FUNCTION){d.current=C;const I=_.token,T=o.getSearchListByNameFirstLetter(I);s(T),c(I);return}}}d.current=-1,c(""),s(u=>u!=null&&u.length?[]:u)});return()=>{h.unsubscribe()}}},[n,e]),E.useEffect(()=>{e||S()},[e]),{searchList:r,searchText:i,handlerFormulaReplace:(h,g)=>{const u=[...f.current.nodes];if(d.current!==-1){const m=u.splice(d.current+1),C=u.pop()||"";let _=(typeof C=="string"?C.length:C.token.length)-h.length;return u.push(h),m[0]!==R.matchToken.OPEN_BRACKET&&g!==R.FunctionType.DefinedName&&(u.push(R.matchToken.OPEN_BRACKET),_--),{text:ht([...u,...m]),offset:_}}},reset:S}},jr=()=>{},qr=E.forwardRef(Yr);function Yr(e,t){const{isFocus:n,sequenceNodes:o,onSelect:r,editor:s,onClose:i=jr}=e,c=s.getEditorId(),d=l.useDependency(l.IShortcutService),f=l.useDependency(a.ICommandService),{searchList:S,searchText:p,handlerFormulaReplace:h,reset:g}=Kr(n,o,s),u=E.useMemo(()=>!!S.length,[S]),m=E.useRef(void 0),[C,_]=E.useState(0),I=E.useRef(!1),[T]=Wt(c,u,[p,S]),D=Te({searchList:S,active:C}),v=(P,F)=>{const A=h(P,F);A&&(g(),r(A))};function M(P){I.current&&_(P)}function w(){I.current&&_(-1)}E.useEffect(()=>{if(!S.length)return;const P=`sheet.formula-embedding-editor.search_function.${c}`,F=new a.DisposableCollection,A=O=>{const{searchList:L,active:b}=D.current;switch(O){case l.KeyCode.ARROW_UP:{_(k=>{const V=Math.max(0,k-1);return W(V),V});break}case l.KeyCode.ARROW_DOWN:{_(k=>{const V=Math.min(L.length-1,k+1);return W(V),V});break}case l.KeyCode.TAB:case l.KeyCode.ENTER:{const k=L[b];v(k.name,k.functionType);break}case l.KeyCode.ESC:{g(),i();break}}};return F.add(f.registerCommand({id:P,type:a.CommandType.OPERATION,handler(O,L){const{keyCode:b}=L;A(b)}})),[l.KeyCode.ARROW_UP,l.KeyCode.ARROW_DOWN,l.KeyCode.ENTER,l.KeyCode.ESC,l.KeyCode.TAB].map(O=>({id:P,binding:O,preconditions:()=>!0,priority:1e3,staticParameters:{eventType:j.DeviceInputEventType.Keyboard,keyCode:O}})).forEach(O=>{F.add(d.registerShortcut(O))}),()=>{F.dispose()}},[S]);function W(P){const F=m.current;if(!F)return;const A=F.children[P];if(!A)return;const L=F.getBoundingClientRect().top,b=F.offsetHeight,k=A.getBoundingClientRect(),V=k.top,H=k.height;if(V>=0&&V>L&&V-L+H<=b)return;const K=A.offsetTop-(b-H)/2;F.scrollTo({top:K,behavior:"smooth"})}const U=E.useMemo(()=>{let P="";return()=>{clearTimeout(P),I.current=!0,P=setTimeout(()=>{I.current=!1},300)}},[]);return S.length>0&&u&&y.jsx(l.RectPopup,{portal:!0,anchorRect$:T,direction:"vertical",children:y.jsx("ul",{ref:P=>{m.current=P,t&&(t.current=P)},"data-u-comp":"sheets-formula-editor",className:B.clsx("univer-m-0 univer-box-border univer-max-h-[400px] univer-w-[250px] univer-list-none univer-overflow-y-auto univer-rounded-lg univer-bg-white univer-p-2 univer-leading-5 univer-shadow-md univer-outline-none dark:!univer-bg-gray-900",B.borderClassName,B.scrollbarClassName),children:S.map((P,F)=>y.jsxs("li",{className:B.clsx("univer-box-border univer-cursor-pointer univer-rounded univer-px-2 univer-py-1 univer-text-gray-900 univer-transition-colors dark:!univer-text-white",{"univer-bg-gray-200 dark:!univer-bg-gray-600":C===F}),onMouseEnter:()=>M(F),onMouseLeave:w,onMouseMove:U,onClick:()=>{v(P.name,P.functionType),s&&s.focus()},children:[y.jsxs("span",{className:"univer-block univer-truncate univer-text-xs",children:[y.jsx("span",{className:"univer-text-red-500",children:P.name.substring(0,p.length)}),y.jsx("span",{children:P.name.slice(p.length)})]}),y.jsx("span",{className:"univer-block univer-text-xs univer-text-gray-400",children:P.desc})]},P.name))})})}const zr=e=>e.startsWith(R.operatorToken.EQUALS)?e.slice(1):"",Bt=()=>{},Kt=E.forwardRef((e,t)=>{var Gt,Zt,Xt,Qt;const{errorText:n,initValue:o,unitId:r,subUnitId:s,isFocus:i=!0,isSupportAcrossSheet:c=!1,onFocus:d=Bt,onBlur:f=Bt,onChange:S,onVerify:p,className:h,editorId:g,moveCursor:u=!0,onFormulaSelectingChange:m,keyboardEventConfig:C,onMoveInEditor:_,resetSelectionOnBlur:I=!0,autoScrollbar:T=!0,isSingle:D=!0,disableSelectionOnClick:v=!1,autofocus:M=!0,disableContextMenu:w,style:W}=e,U=l.useDependency(Q.IEditorService),P=E.useRef(null),F=l.useEvent(S);E.useImperativeHandle(t,()=>({isClickOutSide:X=>P.current?!P.current.contains(X.target):!1}));const A=l.useEvent(m),O=E.useRef(null),L=E.useRef(void 0),b=L.current,[k,V]=E.useState(i),H=E.useRef(null),K=E.useMemo(()=>g!=null?g:a.createInternalEditorID(`${N.EMBEDDING_FORMULA_EDITOR}-${a.generateRandomId(4)}`),[]),oe=E.useMemo(()=>n!==void 0,[n]),se=l.useDependency(a.IUniverInstanceService),ae=se.getUnit(K);l.useObservable(ae==null?void 0:ae.change$);const G=Dr(),J=a.BuildTextUtils.transform.getPlainText((Zt=(Gt=ae==null?void 0:ae.getBody())==null?void 0:Gt.dataStream)!=null?Zt:""),ke=Te(J),we=E.useMemo(()=>zr(J),[J]),Je=E.useMemo(()=>G(we),[we,G]),{isSelecting:pe,isSelectingRef:et}=Nr({unitId:r,subUnitId:s,editorId:K,isFocus:k,disableOnClick:v}),z=E.useRef(""),le=l.useDependency(j.IRenderManagerService).getRenderById(K),te=le==null?void 0:le.with(Q.DocSelectionRenderService),ie=te==null?void 0:te.isFocusing,ue=E.useMemo(()=>se.getCurrentTypeOfUnit$(a.UniverInstanceType.UNIVER_DOC),[se]),fe=l.useObservable(ue),be=(fe==null?void 0:fe.getUnitId())===K,Me=E.useRef([]),Z=pe,me=(Qt=(Xt=l.useDependency(a.IConfigService).getConfig(Rt))==null?void 0:Xt.functionScreenTips)!=null?Qt:!0;l.useUpdateEffect(()=>{F(J)},[J,F]);const Ae=Ht("="),Oe=wr(r,s),de=l.useEvent((X,re=!0,Ce,ve)=>{if(!L.current)return;z.current=X;const nt=X[0]==="="?X.slice(1):"",_e=G(nt),io=_e.reduce((Ne,ot)=>typeof ot=="object"?`${Ne}${ot.token}`:`${Ne}${ot}`,""),rt=Ae(L.current,io===nt?_e:[],re,ve);if(Me.current=rt,Ce){const Ne=ve!=null?ve:b==null?void 0:b.getSelectionRanges();if((Ne==null?void 0:Ne.length)!==1)return;const co=Ne[0].startOffset-1,ao=dt(_e,co,!1),Jt=Ft(_e,ao);if(Jt>=0){const en=rt.splice(Jt,1)[0];en&&rt.push(en)}Oe(k?rt:[],L.current)}});E.useEffect(()=>{k&&de(J,!1,!0)},[k]),E.useEffect(()=>{if(k){if(z.current===J)return;de(J,!1,!0)}},[J]),Br(k,p,J);const ne=Mr(b),Fe=$r(k,r,s);E.useEffect(()=>{var X;A(pe,(X=te==null?void 0:te.isFocusing)!=null?X:!0)},[A,pe]),Q.useKeyboardEvent(k,C,b),E.useLayoutEffect(()=>{let X;if(H.current){X=U.register({autofocus:M,editorUnitId:K,initialSnapshot:{id:K,body:{dataStream:`${o}\r
`,textRuns:[],customBlocks:[],customDecorations:[],customRanges:[]},documentStyle:{}}},H.current);const re=U.getEditor(K);L.current=re,de(o,!1,!0)}return()=>{X==null||X.dispose()}},[]),E.useLayoutEffect(()=>{i?(V(i),ne()):(I&&(b==null||b.blur(),Fe()),V(i))},[i,b,ne,Fe,I]);const{checkScrollBar:St}=Q.useResize(b,D,T);Lr(k,!!(pe&&be),r,K,w),Pr(!!(k&&ie&&u),Z,b,_);const tt=l.useEvent((X,re,Ce)=>{if(!ie)return;const ve=re!==-1?[{startOffset:re+1,endOffset:re+1,collapsed:!0}]:void 0;de(`=${X}`,!0,Ce,ve),Ce&&(ne(),re!==-1&&setTimeout(()=>{const nt={startOffset:re+1,endOffset:re+1},_e=b==null?void 0:b.render.with(Q.DocBackScrollRenderController);_e==null||_e.scrollToRange({...nt,collapsed:!0})},50),St())});Vr(k&&!!(pe&&be),k,et,r,s,Me,c,!!Z,b,tt),Hr(k&&!!(pe&&be),r,c,V,f,()=>{de(ke.current,!1,!0)});const Yt=X=>{if(X){const re=b==null?void 0:b.getSelectionRanges();if(re&&re.length===1){const Ce=re[0];if(Ce.collapsed){const ve=X.offset;setTimeout(()=>{b==null||b.setSelectionRanges([{startOffset:Ce.startOffset-ve,endOffset:Ce.endOffset-ve}])},30)}}ne(),de(`=${X.text}`)}},zt=()=>{V(!0),d(),ne()};return y.jsxs("div",{className:h,children:[y.jsx("div",{ref:P,className:B.clsx("univer-relative univer-box-border univer-flex univer-h-full univer-w-full univer-items-center univer-justify-around univer-gap-2 univer-rounded-none univer-p-0 univer-ring-1",{"univer-ring-primary-500":k,"univer-ring-red-500":oe}),children:y.jsx("div",{ref:H,className:"univer-relative univer-h-full univer-w-full",onMouseUp:zt})}),n!==void 0&&y.jsx("div",{className:"univer-my-1 univer-text-xs univer-text-red-500",children:n}),me&&b&&we!==""&&y.jsx(br,{editor:b,isFocus:k,formulaText:J,onClose:()=>ne()}),me&&!!b&&y.jsx(qr,{isFocus:k,sequenceNodes:Je,onSelect:Yt,ref:O,editor:b})]})});function Gr(e,t,n,o){const r=l.useDependency(R.LexerTreeBuilder),s=Ht(""),i=l.useObservable(e==null?void 0:e.getDocumentDataModel().change$),[c,d]=E.useState([]),f=l.useDependency(N.IMarkSelectionService),S=E.useRef(""),p=l.useDependency(a.IUniverInstanceService);return E.useEffect(()=>{if(!e)return;const h=e.getDocumentDataModel().getPlainText();if(S.current===h)return;S.current=h;const g=r.sequenceNodesBuilder(h);d(g!=null?g:[])},[i,e,r]),E.useEffect(()=>{var u,m;if(!e)return;if(!t){const C=e.getDocumentData();e.setDocumentData({...C,body:{...C.body,dataStream:(m=(u=C.body)==null?void 0:u.dataStream)!=null?m:"",textRuns:[]}});return}const h=s(e,c,!1),g=new a.DisposableCollection;return h.forEach(C=>{const _=R.deserializeRangeWithSheet(C.token),I=p.getCurrentUnitForType(a.UniverInstanceType.UNIVER_SHEET),T=I==null?void 0:I.getActiveSheet();if(!_.sheetName&&o!==(T==null?void 0:T.getSheetId())||_.sheetName&&(T==null?void 0:T.getName())!==_.sheetName)return;const D=new a.ColorKit(C.themeColor).toRgb(),v=f.addShape({range:_.range,style:{stroke:C.themeColor,fill:`rgba(${D.r}, ${D.g}, ${D.b}, 0.1)`,strokeDash:12},primary:null});v&&g.add(()=>f.removeShape(v))}),()=>{g.dispose()}},[e,t,s,f,c]),{sequenceNodes:c}}function Zr(e){const t=l.useDependency(x.SheetsSelectionsService),{supportAcrossSheet:n=!1,keepSheetReference:o=!1,unitId:r,subUnitId:s,onChange:i}=e,d=l.useDependency(a.IUniverInstanceService).getUnit(r,a.UniverInstanceType.UNIVER_SHEET),f=l.useEvent(i),S=l.useEvent((p,h)=>{const g=d==null?void 0:d.getActiveSheet();if(!g||!n&&g.getSheetId()!==s||!(p!=null&&p.length))return;const u=o?g.getName():g.getSheetId()===s?"":g.getName(),m=p.map(C=>({range:C.range,unitId:r,sheetName:u}));f(m,h)});E.useEffect(()=>{const p=new a.DisposableCollection;return p.add(t.selectionMoveStart$.subscribe(h=>{S(h,!0)})),p.add(t.selectionMoving$.subscribe(h=>{S(h,!1)})),p.add(t.selectionMoveEnd$.subscribe(h=>{S(h,!1)})),()=>{p.dispose()}},[S,t.selectionMoveEnd$,t.selectionMoveStart$,t.selectionMoving$])}const jt=e=>!e.some(n=>{if(typeof n=="string"){if(n!==R.matchToken.COMMA)return!0}else if(n.nodeType!==R.sequenceNodeType.REFERENCE)return!0;return!1}),Xr=e=>{if(e.endColumn<e.startColumn){const t=e.endColumn;e.endColumn=e.startColumn,e.startColumn=t}if(e.endRow<e.startRow){const t=e.endRow;e.endRow=e.startRow,e.startRow=t}return e};function Qr(e){const{visible:t,initialValue:n,unitId:o,subUnitId:r,maxRangeCount:s=1/0,supportAcrossSheet:i,keepSheetReference:c,onConfirm:d,onClose:f,onShowBySelection:S}=e,p=l.useDependency(a.LocaleService),h=l.useDependency(R.LexerTreeBuilder),[g,u]=E.useState([]),[m,C]=E.useState(0),_=E.useRef(null);E.useEffect(()=>{if(t&&n.length){const v=n.map(M=>M.sheetName?R.serializeRangeWithSheet(M.sheetName,M.range):R.serializeRange(M.range));u(v),C(v.length-1)}else u([""]),C(0)},[t]);const I=(v,M)=>{const w=[...g];w[v]=M,u(w)},T=()=>{u([...g,""]),C(g.length)},D=v=>{g.splice(v,1),u([...g])};return Zr({unitId:o,subUnitId:r,supportAcrossSheet:i,keepSheetReference:c,onChange:(v,M)=>{if(!t&&S!=null&&S(v))return;const w=new Set(g),W=v.map(F=>F.sheetName?R.serializeRangeWithSheet(F.sheetName,F.range):R.serializeRange(F.range)),U=W.filter(F=>!w.has(F));if(!U.length)return;const P=[...g];if(W.length>1){M||P.splice(m,1),P.push(...U);const F=P.slice(0,s);u(F),C(F.length-1),requestAnimationFrame(()=>{var A;(A=_.current)==null||A.scrollTo({top:_.current.scrollHeight})})}else{P.splice(m,1,...U);const F=P.slice(0,s);u(F),C(m+U.length-1)}}}),y.jsx(B.Dialog,{width:"328px",open:t,title:p.t("rangeSelector.title"),draggable:!0,mask:!1,maskClosable:!1,footer:y.jsxs("footer",{className:"univer-flex univer-gap-2",children:[y.jsx(B.Button,{onClick:f,children:p.t("rangeSelector.cancel")}),y.jsx(B.Button,{variant:"primary",onClick:()=>{d(g.filter(v=>{const M=h.sequenceNodesBuilder(v);return M&&M.length===1&&typeof M[0]!="string"&&M[0].nodeType===R.sequenceNodeType.REFERENCE}).map(v=>R.deserializeRangeWithSheet(v)).map(v=>({...v,range:Xr(v.range)})))},children:p.t("rangeSelector.confirm")})]}),onClose:f,children:y.jsxs("div",{ref:_,className:B.clsx("-univer-mx-6 univer-max-h-60 univer-overflow-y-auto univer-px-6",B.scrollbarClassName),children:[g.map((v,M)=>y.jsxs("div",{className:"univer-mb-2 univer-flex univer-items-center univer-gap-4",children:[y.jsx(B.Input,{className:B.clsx("univer-w-full",{"univer-border-primary-600":m===M}),placeholder:p.t("rangeSelector.placeHolder"),onFocus:()=>C(M),value:v,onChange:w=>I(M,w)}),g.length>1&&y.jsx(xt,{className:"univer-cursor-pointer",onClick:()=>D(M)})]},M)),g.length<s&&y.jsx("div",{children:y.jsxs(B.Button,{variant:"link",onClick:T,children:[y.jsx(Pt,{}),y.jsx("span",{children:p.t("rangeSelector.addAnotherRange")})]})})]})})}function Jr(e){return e.split(R.matchToken.COMMA).filter(t=>!!t).map(t=>R.deserializeRangeWithSheet(t))}function eo(e){return e.map(t=>t.sheetName?R.serializeRangeWithSheet(t.sheetName,t.range):R.serializeRange(t.range)).join(R.matchToken.COMMA)}function gt(e){const[t,n]=E.useState(null),{onVerify:o,selectorRef:r,unitId:s,subUnitId:i,maxRangeCount:c,supportAcrossSheet:d,keepSheetReference:f,autoFocus:S,onChange:p,onRangeSelectorDialogVisibleChange:h,onClickOutside:g,onFocusChange:u,forceShowDialogWhenSelectionChanged:m,hideEditor:C,resetRange:_}=e,[I,T]=E.useState(S!=null?S:!1),[D,v]=E.useState(!1),[M,w]=E.useState([]),W=l.useDependency(a.LocaleService),U=l.useDependency(Q.IEditorService),{sequenceNodes:P}=Gr(t,I,s,i),F=Te(P),A=l.useDependency(a.ICommandService),O=l.useEvent(()=>{t==null||t.setSelectionRanges([]),t==null||t.blur(),U.blur()}),L=l.useEvent(()=>{var b;O(),w(Jr((b=t==null?void 0:t.getDocumentDataModel().getPlainText())!=null?b:"")),v(!0)});return E.useEffect(()=>{r&&(r.current={get editor(){return t},focus(){U.focus(t.getEditorId())},blur:O,verify:()=>jt(F.current),showDialog:b=>{O(),w(b),v(!0)},hideDialog:()=>{w([]),v(!1)},getValue:()=>{var b;return(b=t==null?void 0:t.getDocumentDataModel().getPlainText())!=null?b:""}})},[O,t,U,r,F]),E.useEffect(()=>{var b;o==null||o(jt(P),(b=t==null?void 0:t.getDocumentDataModel().getPlainText())!=null?b:"")},[P]),E.useEffect(()=>{h==null||h(D)},[D]),E.useEffect(()=>{if(D&&_)return()=>{const b={unitId:s,subUnitId:i,selections:_};A.executeCommand(x.SetSelectionsOperation.id,b)}},[D]),y.jsxs(y.Fragment,{children:[C?null:y.jsx(Q.RichTextEditor,{isSingle:!0,...e,onFocusChange:(b,k)=>{T(b),u==null||u(b,k)},editorRef:n,onClickOutside:()=>{T(!1),O(),g==null||g()},icon:y.jsx(B.Tooltip,{title:W.t("rangeSelector.buttonTooltip"),placement:"bottom",children:y.jsx($t,{className:"univer-cursor-pointer dark:!univer-text-gray-300",onClick:L})})}),y.jsx(Qr,{initialValue:M,unitId:s,subUnitId:i,visible:D,maxRangeCount:c,onConfirm:b=>{const k=eo(b),V=a.RichTextBuilder.newEmptyData();V.body.dataStream=k,t==null||t.replaceText(k,!1),p==null||p(V,k),v(!1),w([]),requestAnimationFrame(()=>{O()})},onClose:()=>{v(!1),w([])},supportAcrossSheet:d,keepSheetReference:f,onShowBySelection:b=>I||m?(w(b),v(!0),!1):!0})]})}const to=()=>{var o,r;const e=l.useDependency(ut),t=l.useObservable(e.currentSelector$),n=E.useRef(null);return E.useEffect(()=>{var s,i;if(t)return(i=n.current)==null||i.showDialog((s=t.initialValue)!=null?s:[]),()=>{var c;(c=n.current)==null||c.hideDialog()}},[t]),y.jsx(gt,{unitId:(o=t==null?void 0:t.unitId)!=null?o:"",subUnitId:(r=t==null?void 0:t.subUnitId)!=null?r:"",hideEditor:!0,selectorRef:n,onChange:(s,i)=>{var c;t==null||t.callback((c=i==null?void 0:i.split(",").map(d=>R.deserializeRangeWithSheet(d)))!=null?c:[])}})};var no=Object.defineProperty,ro=Object.getOwnPropertyDescriptor,oo=(e,t,n)=>t in e?no(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,so=(e,t,n,o)=>{for(var r=o>1?void 0:o?ro(t,n):t,s=e.length-1,i;s>=0;s--)(i=e[s])&&(r=i(r)||r);return r},Qe=(e,t)=>(n,o)=>t(n,o,e),qt=(e,t,n)=>oo(e,typeof t!="symbol"?t+"":t,n);$.UniverSheetsFormulaUIPlugin=class extends a.Plugin{constructor(t=Tt,n,o,r,s){super(),this._config=t,this._injector=n,this._renderManagerService=o,this._configService=r,this._uiPartsService=s;const{menu:i,...c}=a.merge(Tt,this._config);i&&this._configService.setConfig("menu",i,{merge:!0}),this._configService.setConfig(Rt,c,{merge:!0})}onStarting(){a.registerDependencies(this._injector,[[Ve,{useClass:st}],[ut],[Ge],[Ke],[je],[qe],[Ye],[$.FormulaReorderController],[Ze]]),this._initUIPart()}onReady(){[[$.RefSelectionsRenderService]].forEach(t=>{this.disposeWithMe(this._renderManagerService.registerRenderModule(a.UniverInstanceType.UNIVER_SHEET,t))})}onRendered(){[[at]].forEach(t=>{this.disposeWithMe(this._renderManagerService.registerRenderModule(a.UniverInstanceType.UNIVER_SHEET,t))}),a.touchDependencies(this._injector,[[Ge],[je],[Ye],[Ze]])}onSteady(){this._injector.get(Ke),this._injector.get($.FormulaReorderController)}_initUIPart(){const t=this._injector.get(l.ComponentManager);this.disposeWithMe(t.register(N.RANGE_SELECTOR_COMPONENT_KEY,gt)),this.disposeWithMe(t.register(N.EMBEDDING_FORMULA_EDITOR_COMPONENT_KEY,Kt)),this.disposeWithMe(this._uiPartsService.registerComponent(l.BuiltInUIPart.GLOBAL,()=>l.connectInjector(to,this._injector)))}},qt($.UniverSheetsFormulaUIPlugin,"pluginName",Et),qt($.UniverSheetsFormulaUIPlugin,"type",a.UniverInstanceType.UNIVER_SHEET),$.UniverSheetsFormulaUIPlugin=so([a.DependentOn(R.UniverFormulaEnginePlugin,ge.UniverSheetsFormulaPlugin),Qe(1,a.Inject(a.Injector)),Qe(2,j.IRenderManagerService),Qe(3,a.IConfigService),Qe(4,l.IUIPartsService)],$.UniverSheetsFormulaUIPlugin),$.FORMULA_PROMPT_ACTIVATED=vt,$.FormulaEditor=Kt,$.GlobalRangeSelectorService=ut,$.HelpFunctionOperation=mt,$.InsertFunctionOperation=ce,$.MoreFunctionsOperation=He,$.RangeSelector=gt,$.ReferenceAbsoluteOperation=it,$.SearchFunctionOperation=yt,$.SelectEditorFormulaOperation=Ee,$.SheetCopyFormulaOnlyCommand=We,$.SheetOnlyPasteFormulaCommand=Ue,Object.defineProperty($,Symbol.toStringTag,{value:"Module"})}));


// @univerjs/sheets-formula-ui/facade
(function(e,r){typeof exports=="object"&&typeof module<"u"?r(exports,require("@univerjs/core/facade"),require("@univerjs/sheets-formula-ui")):typeof define=="function"&&define.amd?define(["exports","@univerjs/core/facade","@univerjs/sheets-formula-ui"],r):(e=typeof globalThis<"u"?globalThis:e||self,r(e.UniverSheetsFormulaUiFacade={},e.UniverCoreFacade,e.UniverSheetsFormulaUi))})(this,(function(e,r,n){"use strict";class i extends r.FUniver{showRangeSelectorDialog(o){return this._injector.get(n.GlobalRangeSelectorService).showRangeSelectorDialog(o)}}r.FUniver.extend(i),e.FSheetsFormulaUIUniver=i,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));


// @univerjs/sheets-numfmt/index
(function(r,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("@univerjs/core"),require("@univerjs/sheets"),require("rxjs"),require("@univerjs/engine-formula")):typeof define=="function"&&define.amd?define(["exports","@univerjs/core","@univerjs/sheets","rxjs","@univerjs/engine-formula"],t):(r=typeof globalThis<"u"?globalThis:r||self,t(r.UniverSheetsNumfmt={},r.UniverCore,r.UniverSheets,r.rxjs,r.UniverEngineFormula))})(this,(function(r,t,u,N,X){"use strict";var de=Object.defineProperty;var ge=(r,t,u)=>t in r?de(r,t,{enumerable:!0,configurable:!0,writable:!0,value:u}):r[t]=u;var V=(r,t,u)=>ge(r,typeof t!="symbol"?t+"":t,u);const P=["$","","","","","","","","","","","","","","","","","","","","","","","","","","",""],E=new Map([[t.LocaleType.EN_US,"$"],[t.LocaleType.RU_RU,""],[t.LocaleType.VI_VN,""],[t.LocaleType.ZH_CN,""],[t.LocaleType.ZH_TW,"NT$"],[t.LocaleType.FR_FR,""],[t.LocaleType.FA_IR,""],[t.LocaleType.KO_KR,""],[t.LocaleType.ES_ES,""],[t.LocaleType.CA_ES,""]]);function j(e){switch(e){case t.LocaleType.CA_ES:case t.LocaleType.ES_ES:case t.LocaleType.FR_FR:return{icon:"EuroIcon",symbol:E.get(e)||"",locale:e};case t.LocaleType.RU_RU:return{icon:"RoubleIcon",symbol:E.get(e)||"",locale:e};case t.LocaleType.ZH_CN:return{icon:"RmbIcon",symbol:E.get(e)||"",locale:e};case t.LocaleType.EN_US:default:return{icon:"DollarIcon",symbol:"$",locale:t.LocaleType.EN_US}}}function F(e){return E.get(e)||"$"}function A(e,a=2){let i=a;a>127&&(i=127);let n="";return i>0&&(n=`.${"0".repeat(i)}`),`"${F(e)}"#,##0${n}_);[Red]("${F(e)}"#,##0${n})`}const B=[{label:"1930-08-05",suffix:"yyyy-MM-dd"},{label:"1930/08/05",suffix:"yyyy/MM/dd"},{label:"19300805",suffix:'yyyy""MM""dd""'},{label:"08-05",suffix:"MM-dd"},{label:"85",suffix:'M""d""'},{label:"13:30:30",suffix:"h:mm:ss"},{label:"13:30",suffix:"h:mm"},{label:"01:30",suffix:"A/P hh:mm"},{label:"1:30",suffix:"A/P h:mm"},{label:"1:30:30",suffix:"A/P h:mm:ss"},{label:"08-05  01:30",suffix:"MM-dd A/P hh:mm"}],G=[{label:"(1,235)",suffix:"#,##0_);(#,##0)"},{label:"(1,235) ",suffix:"#,##0_);[Red](#,##0)",color:"red"},{label:"1,234.56",suffix:"#,##0.00_);#,##0.00"},{label:"1,234.56",suffix:"#,##0.00_);[Red]#,##0.00",color:"red"},{label:"-1,234.56",suffix:"#,##0.00_);-#,##0.00"},{label:"-1,234.56",suffix:"#,##0.00_);[Red]-#,##0.00",color:"red"}],H=[{label:e=>`${e}1,235`,suffix:e=>`"${e}"#,##0.00_);"${e}"#,##0.00`},{label:e=>`${e}1,235`,suffix:e=>`"${e}"#,##0.00_);[Red]"${e}"#,##0.00`,color:"red"},{label:e=>`(${e}1,235)`,suffix:e=>`"${e}"#,##0.00_);("${e}"#,##0.00)`},{label:e=>`(${e}1,235)`,suffix:e=>`"${e}"#,##0.00_);[Red]("${e}"#,##0.00)`,color:"red"},{label:e=>`-${e}1,235`,suffix:e=>`"${e}"#,##0.00_);-"${e}"#,##0.00`},{label:e=>`-${e}1,235`,suffix:e=>`"${e}"#,##0.00_);[Red]-"${e}"#,##0.00`,color:"red"}],U=(e,a=0)=>{var n;return e&&(n=t.numfmt.getFormatInfo(e).maxDecimals)!=null?n:a},L=e=>new Array(Math.min(Math.max(0,Number(e)),30)).fill(0).join(""),$=(e,a)=>e.split(";").map(n=>/\.0?/.test(n)?n.replace(/\.0*/g,`${a>0?".":""}${L(Number(a||0))}`):/0([^0]?)|0$/.test(n)?n.replace(/0([^0]+)|0$/,`0${a>0?".":""}${L(Number(a||0))}$1`):n).join(";"),J=e=>/\.0?/.test(e)||/0([^0]?)|0$/.test(e),I={id:"sheet.command.numfmt.set.numfmt",type:t.CommandType.COMMAND,handler:(e,a)=>{if(!a)return!1;const i=e.get(t.ICommandService),n=e.get(t.IUniverInstanceService),s=e.get(t.IUndoRedoService),l=u.getSheetCommandTarget(n,a);if(!l)return!1;const{unitId:m,subUnitId:S,worksheet:o}=l,f=a.values.filter(c=>!!c.pattern),T=a.values.filter(c=>!c.pattern),M=u.transformCellsToRange(m,S,f),y={unitId:m,subUnitId:S,ranges:T.map(c=>({startColumn:c.col,startRow:c.row,endColumn:c.col,endRow:c.row}))},b=[],p=[];if(f.length){const c=f.reduce((g,d)=>{t.isTextFormat(d.pattern)&&g.setValue(d.row,d.col,{t:t.CellValueType.STRING});const _=o.getCellRaw(d.row,d.col);if(_){const O=u.checkCellValueType(_.v);O!==_.t&&g.setValue(d.row,d.col,{t:O})}return g},new t.ObjectMatrix).getMatrix(),v=new t.ObjectMatrix;new t.ObjectMatrix(c).forValue((g,d)=>{const _=o.getCellRaw(g,d);_?v.setValue(g,d,{t:_.t}):v.setValue(g,d,{t:void 0})}),Object.keys(M.values).forEach(g=>{const d=M.values[g];d.ranges=u.rangeMerge(d.ranges)}),b.push({id:u.SetNumfmtMutation.id,params:M});const h=u.factorySetNumfmtUndoMutation(e,M);p.push(...h)}if(T.length){y.ranges=u.rangeMerge(y.ranges);const c=T.reduce((g,d)=>{const _=o.getCellRaw(d.row,d.col);if(_){const O=u.checkCellValueType(_.v);O!==_.t&&g.setValue(d.row,d.col,{t:O})}return g},new t.ObjectMatrix).getMatrix(),v=new t.ObjectMatrix;new t.ObjectMatrix(c).forValue((g,d)=>{const _=o.getCellRaw(g,d);_?v.setValue(g,d,{t:_.t}):v.setValue(g,d,{t:void 0})}),b.push({id:u.RemoveNumfmtMutation.id,params:y},{id:u.SetRangeValuesMutation.id,params:{unitId:m,subUnitId:S,cellValue:c}});const h=u.factoryRemoveNumfmtUndoMutation(e,y);p.push({id:u.SetRangeValuesMutation.id,params:{unitId:m,subUnitId:S,cellValue:v.getMatrix()}},...h)}const C=t.sequenceExecute(b,i).result;return C&&s.pushUndoRedo({unitID:m,undoMutations:p,redoMutations:b}),C}},x={id:"sheet.command.numfmt.add.decimal.command",type:t.CommandType.COMMAND,handler:async e=>{const a=e.get(t.ICommandService),i=e.get(u.SheetsSelectionsService),n=e.get(u.INumfmtService),s=e.get(t.IUniverInstanceService),l=i.getCurrentSelections();if(!l||!l.length)return!1;const m=u.getSheetCommandTarget(s);if(!m)return!1;const{unitId:S,subUnitId:o}=m;let f=0;l.forEach(b=>{t.Range.foreach(b.range,(p,C)=>{const c=n.getValue(S,o,p,C);if(!c){const h=m.worksheet.getCellRaw(p,C);if(!f&&h&&h.t===t.CellValueType.NUMBER&&h.v){const g=/\.(\d*)$/.exec(String(h.v));if(g){const d=g[1].length;if(!d)return;f=Math.max(f,d)}}return}const v=U(c.pattern);f=v>f?v:f})});const T=f+1,M=$(`0${T>0?".0":""}`,T),y=[];return l.forEach(b=>{t.Range.foreach(b.range,(p,C)=>{const c=n.getValue(S,o,p,C);if(t.isDefaultFormat(c==null?void 0:c.pattern))y.push({row:p,col:C,pattern:M});else{const v=U(c.pattern),h=$(c.pattern,v+1);h!==c.pattern&&y.push({row:p,col:C,pattern:h})}})}),y.length?await a.executeCommand(I.id,{values:y}):!1}},W={id:"sheet.command.numfmt.set.currency",type:t.CommandType.COMMAND,handler:async e=>{const a=e.get(t.ICommandService),i=e.get(u.SheetsSelectionsService),n=e.get(t.LocaleService),s=i.getCurrentSelections();if(!s||!s.length)return!1;const l=[],m=j(n.getCurrentLocale()),S=A(m.locale);return s.forEach(f=>{t.Range.foreach(f.range,(T,M)=>{l.push({row:T,col:M,pattern:S,type:"currency"})})}),await a.executeCommand(I.id,{values:l})}},K={id:"sheet.command.numfmt.set.percent",type:t.CommandType.COMMAND,handler:async e=>{const a=e.get(t.ICommandService),n=e.get(u.SheetsSelectionsService).getCurrentSelections();if(!n||!n.length)return!1;const s=[],l="0%";return n.forEach(S=>{t.Range.foreach(S.range,(o,f)=>{s.push({row:o,col:f,pattern:l,type:"percent"})})}),await a.executeCommand(I.id,{values:s})}},q={id:"sheet.command.numfmt.subtract.decimal.command",type:t.CommandType.COMMAND,handler:async e=>{const a=e.get(t.ICommandService),i=e.get(u.SheetsSelectionsService),n=e.get(u.INumfmtService),s=e.get(t.IUniverInstanceService),l=i.getCurrentSelections();if(!l||!l.length)return!1;const m=u.getSheetCommandTarget(s);if(!m)return!1;const{unitId:S,subUnitId:o}=m;let f=0;l.forEach(p=>{t.Range.foreach(p.range,(C,c)=>{const v=n.getValue(S,o,C,c);if(!v){const g=m.worksheet.getCellRaw(C,c);if(!f&&g&&g.t===t.CellValueType.NUMBER&&g.v){const d=/\.(\d*)$/.exec(String(g.v));if(d){const _=d[1].length;if(!_)return;f=Math.max(f,_)}}return}const h=U(v.pattern);f=h>f?h:f})});const T=f-1,M=$(`0${T>0?".0":"."}`,T),y=[];return l.forEach(p=>{t.Range.foreach(p.range,(C,c)=>{const v=n.getValue(S,o,C,c);if(t.isDefaultFormat(v==null?void 0:v.pattern))y.push({row:C,col:c,pattern:M});else{const h=U(v.pattern);y.push({row:C,col:c,pattern:$(v.pattern,h-1)})}})}),await a.executeCommand(I.id,{values:y})}},D="sheets-numfmt.config",Z={},Q=e=>t.numfmt.getFormatInfo(e).type||"unknown",k=(e,a,i="en")=>{try{const n=t.numfmt.formatColor(e,a),s=n?String(n):void 0,l=t.numfmt.format(e,a,{locale:i,throws:!1});return a<0?{result:l,color:s}:{result:l}}catch(n){console.warn("getPatternPreview error:",e,n)}return{result:String(a)}},Y=(e,a,i)=>e===t.DEFAULT_NUMBER_FORMAT?{result:String(X.stripErrorMargin(a))}:k(e,a,i);var ee=Object.getOwnPropertyDescriptor,te=(e,a,i,n)=>{for(var s=n>1?void 0:n?ee(a,i):a,l=e.length-1,m;l>=0;l--)(m=e[l])&&(s=m(s)||s);return s},R=(e,a)=>(i,n)=>a(i,n,e);const ne={tl:{size:6,color:"#409f11"}};r.SheetsNumfmtCellContentController=class extends t.Disposable{constructor(i,n,s,l,m,S,o){super();V(this,"_locale$",new N.BehaviorSubject("en"));V(this,"locale$",this._locale$.asObservable());this._instanceService=i,this._sheetInterceptorService=n,this._themeService=s,this._commandService=l,this._numfmtService=m,this._localeService=S,this._configService=o,this._initInterceptorCellContent()}get locale(){const i=this._locale$.getValue();if(i)return i;switch(this._localeService.getCurrentLocale()){case t.LocaleType.FR_FR:return"fr";case t.LocaleType.RU_RU:return"ru";case t.LocaleType.VI_VN:return"vi";case t.LocaleType.ZH_CN:return"zh-CN";case t.LocaleType.KO_KR:return"ko";case t.LocaleType.ZH_TW:return"zh-TW";case t.LocaleType.ES_ES:case t.LocaleType.CA_ES:return"es";case t.LocaleType.EN_US:case t.LocaleType.FA_IR:default:return"en"}}_initInterceptorCellContent(){const i=new t.ObjectMatrix;this.disposeWithMe(N.merge(this._locale$,this._localeService.currentLocale$).subscribe(()=>{i.reset()})),this.disposeWithMe(this._sheetInterceptorService.intercept(u.INTERCEPTOR_POINT.CELL_CONTENT,{effect:t.InterceptorEffectEnum.Value|t.InterceptorEffectEnum.Style,handler:(n,s,l)=>{var p,C;if(!n||n.v===void 0||n.v===null||n.t===t.CellValueType.BOOLEAN||n.t===t.CellValueType.FORCE_STRING)return l(n);const m=s.unitId,S=s.subUnitId;let o;if(n!=null&&n.s){const c=s.workbook.getStyles().get(n.s);c!=null&&c.n&&(o=c.n)}if(o||(o=this._numfmtService.getValue(m,S,s.row,s.col)),t.isDefaultFormat(o==null?void 0:o.pattern)||n.t!==t.CellValueType.NUMBER&&u.checkCellValueType(n.v,n.t)!==t.CellValueType.NUMBER)return l(n);const f=n;if((!n||n===s.rawData)&&(n={...s.rawData}),t.isTextFormat(o==null?void 0:o.pattern))return(p=this._configService.getConfig(D))!=null&&p.disableTextFormatMark?(n.t=t.CellValueType.STRING,l(n)):(n.t=t.CellValueType.STRING,n.markers={...n==null?void 0:n.markers,...ne},l(n));let T="";const M=i.getValue(s.row,s.col);if(M&&M.parameters===`${f.v}_${o==null?void 0:o.pattern}`)return l({...n,...M.result});const y=Y(o==null?void 0:o.pattern,Number(f.v),this.locale);if(T=y.result,!T)return l(n);const b={v:T,t:t.CellValueType.NUMBER};if(y.color){const c=(C=this._themeService.getColorFromTheme(`${y.color}.500`))!=null?C:y.color;c&&(b.interceptorStyle={cl:{rgb:c}})}return i.setValue(s.row,s.col,{result:b,parameters:`${f.v}_${o==null?void 0:o.pattern}`}),Object.assign(n,b),l(n)},priority:u.InterceptCellContentPriority.NUMFMT})),this.disposeWithMe(this._commandService.onCommandExecuted(n=>{if(n.id===u.SetNumfmtMutation.id){const s=n.params;Object.keys(s.values).forEach(l=>{s.values[l].ranges.forEach(S=>{t.Range.foreach(S,(o,f)=>{i.realDeleteValue(o,f)})})})}else if(n.id===u.SetRangeValuesMutation.id){const s=n.params;new t.ObjectMatrix(s.cellValue).forValue((l,m)=>{i.realDeleteValue(l,m)})}})),this.disposeWithMe(this._instanceService.getCurrentTypeOfUnit$(t.UniverInstanceType.UNIVER_SHEET).pipe(N.switchMap(n=>{var s;return(s=n==null?void 0:n.activeSheet$)!=null?s:N.of(null)}),N.skip(1)).subscribe(()=>i.reset()))}setNumfmtLocal(i){this._locale$.next(i)}},r.SheetsNumfmtCellContentController=te([R(0,t.IUniverInstanceService),R(1,t.Inject(u.SheetInterceptorService)),R(2,t.Inject(t.ThemeService)),R(3,t.Inject(t.ICommandService)),R(4,t.Inject(u.INumfmtService)),R(5,t.Inject(t.LocaleService)),R(6,t.IConfigService)],r.SheetsNumfmtCellContentController);const ae="SHEET_NUMFMT_PLUGIN";var re=Object.defineProperty,ie=Object.getOwnPropertyDescriptor,se=(e,a,i)=>a in e?re(e,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[a]=i,le=(e,a,i,n)=>{for(var s=n>1?void 0:n?ie(a,i):a,l=e.length-1,m;l>=0;l--)(m=e[l])&&(s=m(s)||s);return s},w=(e,a)=>(i,n)=>a(i,n,e),z=(e,a,i)=>se(e,typeof a!="symbol"?a+"":a,i);r.UniverSheetsNumfmtPlugin=class extends t.Plugin{constructor(a=Z,i,n,s){super(),this._config=a,this._injector=i,this._configService=n,this._commandService=s;const{...l}=t.merge({},Z,this._config);this._configService.setConfig(D,l)}onStarting(){t.registerDependencies(this._injector,[[r.SheetsNumfmtCellContentController]]),t.touchDependencies(this._injector,[[r.SheetsNumfmtCellContentController]])}onRendered(){[x,q,W,K,I].forEach(a=>{this.disposeWithMe(this._commandService.registerCommand(a))})}},z(r.UniverSheetsNumfmtPlugin,"pluginName",ae),z(r.UniverSheetsNumfmtPlugin,"type",t.UniverInstanceType.UNIVER_SHEET),r.UniverSheetsNumfmtPlugin=le([t.DependentOn(u.UniverSheetsPlugin),w(1,t.Inject(t.Injector)),w(2,t.IConfigService),w(3,t.ICommandService)],r.UniverSheetsNumfmtPlugin);const ce=e=>P.find(i=>e.includes(i)),oe=()=>P.map(e=>({label:e,value:e})),ue=e=>H.map(a=>({label:a.label(e),value:a.suffix(e),color:a.color})),me=()=>B.map(e=>({label:e.label,value:e.suffix})),fe=()=>G.map(e=>({label:e.label,value:e.suffix,color:e.color}));r.AddDecimalCommand=x,r.CURRENCYFORMAT=H,r.DATEFMTLISG=B,r.NUMBERFORMAT=G,r.SHEETS_NUMFMT_PLUGIN_CONFIG_KEY=D,r.SetCurrencyCommand=W,r.SetNumfmtCommand=I,r.SetPercentCommand=K,r.SubtractDecimalCommand=q,r.currencySymbols=P,r.getCurrencyFormat=A,r.getCurrencyFormatOptions=ue,r.getCurrencyOptions=oe,r.getCurrencySymbolByLocale=F,r.getCurrencySymbolIconByLocale=j,r.getCurrencyType=ce,r.getDateFormatOptions=me,r.getDecimalFromPattern=U,r.getDecimalString=L,r.getNumberFormatOptions=fe,r.getPatternPreview=k,r.getPatternPreviewIgnoreGeneral=Y,r.getPatternType=Q,r.isPatternHasDecimal=J,r.localeCurrencySymbolMap=E,r.setPatternDecimal=$,Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})}));


// @univerjs/sheets-numfmt/facade
(function(s,o){typeof exports=="object"&&typeof module<"u"?o(require("@univerjs/sheets-numfmt"),require("@univerjs/sheets/facade")):typeof define=="function"&&define.amd?define(["@univerjs/sheets-numfmt","@univerjs/sheets/facade"],o):(s=typeof globalThis<"u"?globalThis:s||self,o(s.UniverSheetsNumfmt,s.UniverSheetsFacade))})(this,(function(s,o){"use strict";class h extends o.FRange{setNumberFormat(n){const e=[],{startColumn:t,startRow:m,endColumn:u,endRow:a}=this._range;for(let i=m;i<=a;i++)for(let r=t;r<=u;r++)e.push({row:i,col:r,pattern:n});return this._commandService.syncExecuteCommand(s.SetNumfmtCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),values:e}),this}setNumberFormats(n){var i;const e=[],{startColumn:t,startRow:m,endColumn:u,endRow:a}=this._range;for(let r=m;r<=a;r++)for(let d=t;d<=u;d++){const f=(i=n[r-m])==null?void 0:i[d-t];e.push({row:r,col:d,pattern:f})}return this._commandService.syncExecuteCommand(s.SetNumfmtCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),values:e}),this}getNumberFormat(){var e,t;const n=this.getCellStyle();return(t=(e=n==null?void 0:n.numberFormat)==null?void 0:e.pattern)!=null?t:""}getNumberFormats(){return this.getCellStyles().map(e=>e.map(t=>{var m,u;return(u=(m=t==null?void 0:t.numberFormat)==null?void 0:m.pattern)!=null?u:""}))}}o.FRange.extend(h);class c extends o.FWorkbook{setNumfmtLocal(n){return this._injector.get(s.SheetsNumfmtCellContentController).setNumfmtLocal(n),this}}o.FWorkbook.extend(c)}));


// @univerjs/sheets-numfmt-ui/index
(function(C,s){typeof exports=="object"&&typeof module<"u"?s(exports,require("@univerjs/core"),require("@univerjs/engine-render"),require("@univerjs/sheets-numfmt"),require("@univerjs/sheets-ui"),require("@univerjs/sheets"),require("@univerjs/ui"),require("rxjs"),require("rxjs/operators"),require("react/jsx-runtime"),require("react"),require("@univerjs/design"),require("@univerjs/engine-formula")):typeof define=="function"&&define.amd?define(["exports","@univerjs/core","@univerjs/engine-render","@univerjs/sheets-numfmt","@univerjs/sheets-ui","@univerjs/sheets","@univerjs/ui","rxjs","rxjs/operators","react/jsx-runtime","react","@univerjs/design","@univerjs/engine-formula"],s):(C=typeof globalThis<"u"?globalThis:C||self,s(C.UniverSheetsNumfmtUi={},C.UniverCore,C.UniverEngineRender,C.UniverSheetsNumfmt,C.UniverSheetsUi,C.UniverSheets,C.UniverUi,C.rxjs,C.rxjs.operators,C.React,C.React,C.UniverDesign,C.UniverEngineFormula))})(this,(function(C,s,k,d,N,g,_,w,W,l,y,E,me){"use strict";var it=Object.defineProperty;var st=(C,s,k)=>s in C?it(C,s,{enumerable:!0,configurable:!0,writable:!0,value:k}):C[s]=k;var q=(C,s,k)=>st(C,typeof s!="symbol"?s+"":s,k);const ee={};var de=Object.getOwnPropertyDescriptor,ve=(e,t,r,n)=>{for(var i=n>1?void 0:n?de(t,r):t,a=e.length-1,o;a>=0;a--)(o=e[a])&&(i=o(i)||i);return i},$=(e,t)=>(r,n)=>t(r,n,e);const G="SHEET_NUMFMT_ALERT";let K=class extends s.Disposable{constructor(e,t,r,n,i,a,o){super(),this._context=e,this._hoverManagerService=t,this._cellAlertManagerService=r,this._localeService=n,this._zenZoneService=i,this._numfmtService=a,this._configService=o,this._init()}_init(){this._initCellAlertPopup(),this._initZenService()}_initCellAlertPopup(){this.disposeWithMe(this._hoverManagerService.currentCell$.pipe(w.debounceTime(100)).subscribe(e=>{var t,r;if(e){const n=e.location,i=this._context.unit,a=i.getActiveSheet();if(!a)return this._hideAlert();const o=n.unitId,p=n.subUnitId;let c;const u=a.getCell(n.row,n.col);if(u!=null&&u.s){const v=i.getStyles().get(u.s);v!=null&&v.n&&(c=v.n)}if(c||(c=this._numfmtService.getValue(o,p,n.row,n.col)),!c){this._hideAlert();return}if(s.isTextFormat(c.pattern)&&s.Tools.isDefine(u==null?void 0:u.v)&&s.isRealNum(u.v)){if((t=this._configService.getConfig(d.SHEETS_NUMFMT_PLUGIN_CONFIG_KEY))!=null&&t.disableTextFormatAlert)return;const v=this._cellAlertManagerService.currentAlert.get(G),m=(r=v==null?void 0:v.alert)==null?void 0:r.location;if(m&&m.row===n.row&&m.col===n.col&&m.subUnitId===n.subUnitId&&m.unitId===n.unitId){this._hideAlert();return}this._cellAlertManagerService.showAlert({type:N.CellAlertType.ERROR,title:this._localeService.t("info.error"),message:this._localeService.t("info.forceStringInfo"),location:n,width:200,height:74,key:G});return}}this._hideAlert()}))}_initZenService(){this.disposeWithMe(this._zenZoneService.visible$.subscribe(e=>{e&&this._hideAlert()}))}_hideAlert(){this._cellAlertManagerService.removeAlert(G)}};K=ve([$(1,s.Inject(N.HoverManagerService)),$(2,s.Inject(N.CellAlertManagerService)),$(3,s.Inject(s.LocaleService)),$(4,_.IZenZoneService),$(5,s.Inject(g.INumfmtService)),$(6,s.IConfigService)],K);const Y={id:"sheet.operation.close.numfmt.panel",type:s.CommandType.OPERATION,handler:()=>!0},j={id:"sheet.operation.open.numfmt.panel",type:s.CommandType.OPERATION,handler:e=>(e.get(A).openPanel(),!0)};var pe=Object.getOwnPropertyDescriptor,he=(e,t,r,n)=>{for(var i=n>1?void 0:n?pe(t,r):t,a=e.length-1,o;a>=0;a--)(o=e[a])&&(i=o(i)||i);return i},fe=(e,t)=>(r,n)=>t(r,n,e);const Z=y.createContext([]);let F=class{constructor(e){this._localStorageService=e}_getKey(e){return`userHabitController_${e}`}async addHabit(e,t){const r=this._getKey(e);return this._localStorageService.getItem(r).then(n=>{n||this._localStorageService.setItem(r,t)})}markHabit(e,t){const r=this._getKey(e);this._localStorageService.getItem(r).then(n=>{if(n){const i=n.findIndex(a=>a===t);i>-1&&n.splice(i,1),n.unshift(t),this._localStorageService.setItem(r,n)}})}async getHabit(e,t){const r=this._getKey(e),n=await this._localStorageService.getItem(r);if(t&&n){const i=n.map((a,o,p)=>{const c=p.length;return{value:a,priority:c-o}});return t.sort((a,o)=>{var u,v;const p=((u=i.find(m=>m.value===a))==null?void 0:u.priority)||-1;return(((v=i.find(m=>m.value===o))==null?void 0:v.priority)||-1)-p})}return n||[]}deleteHabit(e){this._localStorageService.removeItem(e)}};F=he([fe(0,s.Inject(s.ILocalStorageService))],F);const te="numfmtCurrency",ge=e=>{const t=_.useDependency(F),[r,n]=y.useState(d.currencySymbols);return y.useEffect(()=>{t.addHabit("numfmtCurrency",[]).then(()=>{t.getHabit(te,[...d.currencySymbols]).then(a=>{n(a),e&&e(a)})})},[]),{userHabitCurrency:r,mark:a=>{t.markHabit(te,a)}}},Se=()=>{const e=y.useRef([]),[t,r]=y.useState({});return y.useEffect(()=>{e.current.forEach(i=>{i()}),e.current=[]},[t]),i=>{e.current.push(i),r({})}},ye=e=>!!d.getCurrencyType(e)&&e.startsWith("_("),_e=e=>{const{defaultPattern:t,action:r,onChange:n}=e,[i,a]=y.useState(()=>d.getDecimalFromPattern(t||"",2)),o=y.useContext(Z),[p,c]=y.useState(()=>d.getCurrencyType(t)||o[0]),u=y.useMemo(()=>o.map(b=>({label:b,value:b})),[]),m=_.useDependency(s.LocaleService).t;r.current=()=>d.setPatternDecimal(`_("${p}"* #,##0${i>0?".0":""}_)`,i);const f=b=>{c(b),n(d.setPatternDecimal(`_("${b}"* #,##0${i>0?".0":""}_)`,i))},S=b=>{const h=b||0;a(h),n(d.setPatternDecimal(`_("${p}"* #,##0${h>0?".0":""}_)`,h))};return l.jsxs("div",{children:[l.jsxs("div",{className:"univer-mt-4 univer-flex univer-justify-between",children:[l.jsxs("div",{className:"option",children:[l.jsx("div",{className:"univer-text-sm univer-text-gray-400",children:m("sheet.numfmt.decimalLength")}),l.jsx("div",{className:"univer-mt-2 univer-w-32",children:l.jsx(E.InputNumber,{value:i,step:1,precision:0,max:20,min:0,onChange:S})})]}),l.jsxs("div",{className:"option",children:[l.jsx("div",{className:"univer-text-sm univer-text-gray-400",children:m("sheet.numfmt.currencyType")}),l.jsx("div",{className:"univer-mt-2 univer-w-36",children:l.jsx(E.Select,{options:u,value:p,onChange:f})})]})]}),l.jsx("div",{className:"univer-mt-4 univer-text-sm univer-text-gray-400",children:m("sheet.numfmt.accountingDes")})]})},Ce=e=>!!d.getCurrencyType(e)&&!e.startsWith("_("),be=e=>{const r=_.useDependency(s.LocaleService).t,n=y.useContext(Z),[i,a]=y.useState(()=>d.getCurrencyType(e.defaultPattern)||n[0]),[o,p]=y.useState(()=>d.getDecimalFromPattern(e.defaultPattern||"",2)),[c,u]=y.useState(()=>{var I;const h=d.getCurrencyFormatOptions(i);return((I=h.find(M=>s.isPatternEqualWithoutDecimal(M.value,e.defaultPattern)))==null?void 0:I.value)||h[0].value}),v=y.useMemo(()=>d.getCurrencyFormatOptions(i),[i]),m=y.useMemo(()=>n.map(h=>({label:h,value:h})),[n]);e.action.current=()=>d.setPatternDecimal(c,o);const f=h=>{if(h===void 0)return;a(h);const P=d.getCurrencyFormatOptions(h)[0].value;u(P),e.onChange(d.setPatternDecimal(P,o))},S=h=>{h!==void 0&&(u(h),e.onChange(d.setPatternDecimal(h,o)))},b=h=>{p(h||0),e.onChange(d.setPatternDecimal(c,h||0))};return l.jsxs("div",{children:[l.jsxs("div",{className:"univer-mt-4 univer-flex univer-justify-between",children:[l.jsxs("div",{className:"option",children:[l.jsx("div",{className:"univer-text-sm univer-text-gray-400",children:r("sheet.numfmt.decimalLength")}),l.jsx("div",{className:"univer-mt-2 univer-w-32",children:l.jsx(E.InputNumber,{value:o,max:20,min:0,onChange:b})})]}),l.jsxs("div",{className:"option",children:[l.jsx("div",{className:"univer-text-sm univer-text-gray-400",children:r("sheet.numfmt.currencyType")}),l.jsx("div",{className:"univer-mt-2 univer-w-36",children:l.jsx(E.Select,{value:i,options:m,onChange:f})})]})]}),l.jsx("div",{className:"label univer-mt-4",children:r("sheet.numfmt.negType")}),l.jsx("div",{className:"univer-mt-2",children:l.jsx(E.SelectList,{value:c,options:v,onChange:S})}),l.jsx("div",{className:"univer-mt-4 univer-text-sm univer-text-gray-400",children:r("sheet.numfmt.currencyDes")})]})};function ne({ref:e,...t}){const{icon:r,id:n,className:i,extend:a,...o}=t,p=`univerjs-icon univerjs-icon-${n} ${i||""}`.trim(),c=y.useRef(`_${Ee()}`);return re(r,`${n}`,{defIds:r.defIds,idSuffix:c.current},{ref:e,className:p,...o},a)}function re(e,t,r,n,i){return y.createElement(e.tag,{key:t,...Ie(e,r,i),...n},(Te(e,r).children||[]).map((a,o)=>re(a,`${t}-${e.tag}-${o}`,r,void 0,i)))}function Ie(e,t,r){const n={...e.attrs};r!=null&&r.colorChannel1&&n.fill==="colorChannel1"&&(n.fill=r.colorChannel1),e.tag==="mask"&&n.id&&(n.id=n.id+t.idSuffix),Object.entries(n).forEach(([a,o])=>{a==="mask"&&typeof o=="string"&&(n[a]=o.replace(/url\(#(.*)\)/,`url(#$1${t.idSuffix})`))});const{defIds:i}=t;return!i||i.length===0||(e.tag==="use"&&n["xlink:href"]&&(n["xlink:href"]=n["xlink:href"]+t.idSuffix),Object.entries(n).forEach(([a,o])=>{typeof o=="string"&&(n[a]=o.replace(/url\(#(.*)\)/,`url(#$1${t.idSuffix})`))})),n}function Te(e,t){var n;const{defIds:r}=t;return!r||r.length===0?e:e.tag==="defs"&&((n=e.children)!=null&&n.length)?{...e,children:e.children.map(i=>typeof i.attrs.id=="string"&&r&&r.includes(i.attrs.id)?{...i,attrs:{...i.attrs,id:i.attrs.id+t.idSuffix}}:i)}:e}function Ee(){return Math.random().toString(36).substring(2,8)}ne.displayName="UniverIcon";const Pe={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M14.1544 3.75557C14.3887 3.98988 14.3887 4.36978 14.1544 4.6041L6.51409 12.2444C6.40157 12.3569 6.24896 12.4201 6.08983 12.4201C5.9307 12.4201 5.77808 12.3569 5.66556 12.2444L1.84541 8.42425C1.6111 8.18993 1.6111 7.81003 1.84541 7.57572C2.07973 7.34141 2.45963 7.34141 2.69394 7.57572L6.08983 10.9716L13.3059 3.75557C13.5402 3.52126 13.9201 3.52126 14.1544 3.75557Z",fillRule:"evenodd",clipRule:"evenodd"}}]},ie=y.forwardRef(function(t,r){return y.createElement(ne,Object.assign({},t,{id:"check-mark-icon",ref:r,icon:Pe}))});ie.displayName="CheckMarkIcon";const z="customFormat",X="numfmt_custom_pattern";function Me(e){const{defaultPattern:t,action:r,onChange:n}=e,i=_.useDependency(F),a=_.useDependency(s.ILocalStorageService),o=_.useDependency(s.LocaleService),[p,c]=y.useState(t);r.current=()=>(i.markHabit(z,p),a.getItem(X).then((S=[])=>{const b=[...new Set([p,...S||[]])].splice(0,10).filter(h=>!!h);a.setItem(X,b)}),p);const[u,v]=y.useState([]);y.useEffect(()=>{a.getItem(X).then(S=>{const b=[...d.CURRENCYFORMAT.map(h=>h.suffix("$")),...d.DATEFMTLISG.map(h=>h.suffix),...d.NUMBERFORMAT.map(h=>h.suffix)];b.push(...S||[]),i.addHabit(z,[]).finally(()=>{i.getHabit(z,b).then(h=>{v([...new Set(h)])})})})},[]);const m=S=>{c(S),n(S)},f=()=>{n(p)};return l.jsxs("div",{children:[l.jsx("div",{className:"univer-mt-4 univer-text-sm univer-text-gray-400",children:o.t("sheet.numfmt.customFormat")}),l.jsx(E.Input,{placeholder:o.t("sheet.numfmt.customFormat"),onBlur:f,value:p,onChange:c,className:"univer-mt-2 univer-w-full"}),l.jsx("div",{className:E.clsx("univer-mt-2 univer-max-h-[400px] univer-overflow-auto univer-rounded-lg univer-p-2",E.borderClassName),children:u.map(S=>l.jsxs("div",{onClick:()=>m(S),className:"univer-flex univer-cursor-pointer univer-items-center univer-gap-1.5 univer-py-1.5 univer-text-sm",children:[l.jsx("div",{className:"univer-flex univer-w-4 univer-items-center univer-text-primary-600",children:p===S&&l.jsx(ie,{})}),l.jsx("div",{children:S})]},S))}),l.jsx("div",{className:"univer-mt-3 univer-text-sm univer-text-gray-600 dark:!univer-text-gray-200",children:o.t("sheet.numfmt.customFormatDes")})]})}const Ne=e=>{const t=s.numfmt.getFormatInfo(e);return d.getDateFormatOptions().map(r=>r.value).includes(e)||["date","datetime","time"].includes(t.type)};function De(e){const{onChange:t,defaultPattern:r}=e,n=y.useMemo(d.getDateFormatOptions,[]),i=_.useDependency(s.LocaleService),[a,o]=y.useState(()=>{if(r){const c=n.find(u=>u.value===r);if(c)return c.value}return n[0].value});e.action.current=()=>a;const p=c=>{c!==void 0&&(o(c),t(c))};return l.jsxs("div",{children:[l.jsx("div",{className:"univer-mt-4 univer-text-sm univer-text-gray-400",children:i.t("sheet.numfmt.dateType")}),l.jsx("div",{className:"univer-mt-2",children:l.jsx(E.SelectList,{value:a,options:n,onChange:p})}),l.jsx("div",{className:"univer-mt-3.5 univer-text-sm/5 univer-text-gray-600 dark:!univer-text-gray-200",children:i.t("sheet.numfmt.dateDes")})]})}const we=e=>!e,Ue=e=>{const r=_.useDependency(s.LocaleService).t;return e.action.current=()=>"",l.jsx("div",{children:l.jsx("div",{className:"univer-mt-3.5 univer-text-sm/5 univer-text-gray-600 dark:!univer-text-gray-200",children:r("sheet.numfmt.generalDes")})})},xe=e=>d.getNumberFormatOptions().some(t=>s.isPatternEqualWithoutDecimal(t.value,e));function Oe(e){const t=_.useDependency(s.LocaleService),r=y.useMemo(d.getNumberFormatOptions,[]),[n,i]=y.useState(()=>d.getDecimalFromPattern(e.defaultPattern||"",0)),[a,o]=y.useState(()=>{const m=r.find(f=>s.isPatternEqualWithoutDecimal(f.value,e.defaultPattern||""));return(m==null?void 0:m.value)||r[0].value}),p=y.useMemo(()=>d.setPatternDecimal(a,Number(n||0)),[a,n]),c=y.useMemo(()=>!d.isPatternHasDecimal(a),[a]),u=m=>{i(m||0),e.onChange(d.setPatternDecimal(a,Number(m||0)))},v=m=>{m!==void 0&&(i(d.getDecimalFromPattern(m,0)),o(m),e.onChange(m))};return e.action.current=()=>p,l.jsxs("div",{children:[l.jsx("div",{className:"univer-mt-4 univer-text-sm univer-text-gray-400",children:t.t("sheet.numfmt.decimalLength")}),l.jsx("div",{className:"univer-mt-2",children:l.jsx(E.InputNumber,{disabled:c,value:n,max:20,min:0,onChange:u})}),l.jsxs("div",{className:"univer-mt-4 univer-text-sm univer-text-gray-400",children:[" ",t.t("sheet.numfmt.negType")]}),l.jsx("div",{className:"univer-mt-2",children:l.jsx(E.SelectList,{onChange:v,options:r,value:a})}),l.jsx("div",{className:"univer-mt-3.5 univer-text-sm/5 univer-text-gray-600 dark:!univer-text-gray-200",children:t.t("sheet.numfmt.thousandthPercentileDes")})]})}const ke=e=>{const{defaultValue:t,defaultPattern:r,row:n,col:i}=e.value,a=_.useDependency(s.LocaleService),o=y.useRef(()=>""),p=a.t,c=Se(),u=y.useMemo(()=>[{label:"sheet.numfmt.general",component:Ue},{label:"sheet.numfmt.accounting",component:_e},{label:"sheet.numfmt.currency",component:be},{label:"sheet.numfmt.date",component:De},{label:"sheet.numfmt.thousandthPercentile",component:Oe},{label:"sheet.numfmt.customFormat",component:Me}].map(T=>({...T,label:p(T.label)})),[]),[v,m]=y.useState(I),[f,S]=y.useState(()=>`${n}_${i}`),{mark:b,userHabitCurrency:h}=ge(()=>S(`${n}_${i}_userCurrency'`)),P=y.useMemo(()=>{var T;return(T=u.find(L=>L.label===v))==null?void 0:T.component},[v]);function I(){return[we,ye,Ce,Ne,xe].reduce((L,nt,rt)=>L||(nt(r)?u[rt].label:""),"")||u[0].label}const M=u.map(T=>({label:T.label,value:T.label})),U=T=>{m(T),c(()=>e.onChange({type:"change",value:o.current()||""}))},x=y.useCallback(T=>{e.onChange({type:"change",value:T})},[]),O=()=>{const T=o.current()||"",L=d.getCurrencyType(T);L&&b(L),e.onChange({type:"confirm",value:T})},R=()=>{e.onChange({type:"cancel",value:""})},Q={onChange:x,defaultValue:t,defaultPattern:r,action:o};return y.useEffect(()=>{m(I()),S(`${n}_${i}`)},[n,i]),l.jsxs("div",{className:E.clsx("univer-flex univer-h-full univer-flex-col univer-justify-between univer-overflow-y-auto univer-pb-5",E.scrollbarClassName),children:[l.jsxs("div",{children:[l.jsx("div",{className:"univer-mt-3.5 univer-text-sm univer-text-gray-400",children:p("sheet.numfmt.numfmtType")}),l.jsx("div",{className:"univer-mt-2",children:l.jsx(E.Select,{className:"univer-w-full",value:v,options:M,onChange:U})}),l.jsx("div",{children:P&&l.jsx(Z.Provider,{value:h,children:y.createElement(P,{...Q,key:f})})})]}),l.jsxs("div",{className:"univer-mb-5 univer-mt-3.5 univer-flex univer-justify-end",children:[l.jsx(E.Button,{onClick:R,className:"univer-mr-3",children:p("sheet.numfmt.cancel")}),l.jsx(E.Button,{variant:"primary",onClick:O,children:p("sheet.numfmt.confirm")})]})]})};var $e=Object.getOwnPropertyDescriptor,Le=(e,t,r,n)=>{for(var i=n>1?void 0:n?$e(t,r):t,a=e.length-1,o;a>=0;a--)(o=e[a])&&(i=o(i)||i);return i},D=(e,t)=>(r,n)=>t(r,n,e);const se="SHEET_NUMFMT_PANEL";let A=class extends s.Disposable{constructor(t,r,n,i,a,o,p,c,u,v,m){super();q(this,"_previewPattern","");q(this,"_sidebarDisposable",null);this._sheetInterceptorService=t,this._themeService=r,this._univerInstanceService=n,this._commandService=i,this._selectionManagerService=a,this._renderManagerService=o,this._numfmtService=p,this._componentManager=c,this._sidebarService=u,this._localeService=v,this._sheetsNumfmtCellContentController=m,this._initRealTimeRenderingInterceptor(),this._initPanel(),this._initCommands(),this._initCloseListener(),this._commandExecutedListener(),this._initNumfmtLocalChange()}_initNumfmtLocalChange(){this.disposeWithMe(w.merge(this._sheetsNumfmtCellContentController.locale$,this._localeService.currentLocale$).subscribe(()=>{this._forceUpdate()}))}openPanel(){var P;const t=this._sidebarService,r=this._selectionManagerService,n=this._commandService,i=this._univerInstanceService,a=this._numfmtService,o=this._localeService,c=(((P=r.getCurrentSelections())==null?void 0:P.map(I=>I.range))||[])[0];if(!c)return!1;const u=i.getCurrentUnitForType(s.UniverInstanceType.UNIVER_SHEET),v=u.getActiveSheet();if(!v)return!1;const m=v.getCellRaw(c.startRow,c.startColumn),f=a.getValue(u.getUnitId(),v.getSheetId(),c.startRow,c.startColumn);let S="";f&&(S=f.pattern);const b=(m==null?void 0:m.t)===s.CellValueType.NUMBER?m.v:12345678,h={onChange:I=>{var M;if(I.type==="change")this._previewPattern=I.value,this._forceUpdate();else if(I.type==="confirm"){const U=((M=r.getCurrentSelections())==null?void 0:M.map(R=>R.range))||[],x={values:[]},O=d.getPatternType(I.value);U.forEach(R=>{s.Range.foreach(R,(Q,T)=>{x.values.push({row:Q,col:T,pattern:I.value,type:O})})}),n.executeCommand(d.SetNumfmtCommand.id,x),t.close()}else I.type==="cancel"&&t.close()},value:{defaultPattern:S,defaultValue:b,row:c.startRow,col:c.startColumn}};return this._sidebarDisposable=t.open({header:{title:o.t("sheet.numfmt.title")},children:{label:se,...h},onClose:()=>{this._forceUpdate(),n.executeCommand(Y.id)}}),!0}_forceUpdate(t){var n;const r=this._renderManagerService.getRenderById(t!=null?t:this._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_SHEET).getUnitId());r==null||r.with(N.SheetSkeletonManagerService).reCalculate(),(n=r==null?void 0:r.mainComponent)==null||n.makeDirty()}_initCommands(){[j,Y].forEach(t=>{this.disposeWithMe(this._commandService.registerCommand(t))})}_initPanel(){this.disposeWithMe(this._componentManager.register(se,ke))}_initRealTimeRenderingInterceptor(){const t=new w.Observable(n=>{this._commandService.onCommandExecuted(i=>{i.id===j.id&&n.next(!0),i.id===Y.id&&n.next(!1)})}),r=w.combineLatest([t,this._selectionManagerService.selectionMoveEnd$.pipe(W.map(n=>n?n.map(i=>i.range):[]))]);this.disposeWithMe(s.toDisposable(r.pipe(W.switchMap(([n,i])=>new w.Observable(a=>{const o=new s.DisposableCollection;return n&&i.length&&a.next({selectionRanges:i,disposableCollection:o}),()=>{o.dispose()}})),W.tap(()=>{this._previewPattern=null})).subscribe(({disposableCollection:n,selectionRanges:i})=>{var o,p;const a=this._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_SHEET);this.openPanel(),n.add(this._sheetInterceptorService.intercept(g.INTERCEPTOR_POINT.CELL_CONTENT,{priority:99,effect:s.InterceptorEffectEnum.Value|s.InterceptorEffectEnum.Style,handler:(c,u,v)=>{var b;const{row:m,col:f}=u,S=v(c)||{};if(i.find(h=>h.startColumn<=f&&h.endColumn>=f&&h.startRow<=m&&h.endRow>=m)){const h=u.worksheet.getCellRaw(m,f),P=h==null?void 0:h.v,I=h==null?void 0:h.t;if(P==null||I!==s.CellValueType.NUMBER||this._previewPattern===null)return S;const M=d.getPatternPreviewIgnoreGeneral(this._previewPattern,P,this._sheetsNumfmtCellContentController.locale);if(M.color){const U=(b=this._themeService.getColorFromTheme(`${M.color}.500`))!=null?b:M.color;return{...S,v:M.result,t:s.CellValueType.STRING,s:{cl:{rgb:U}}}}return{...S,v:M.result,t:s.CellValueType.STRING}}return S}})),(p=(o=this._renderManagerService.getRenderById(a.getUnitId()))==null?void 0:o.mainComponent)==null||p.makeDirty()})))}_commandExecutedListener(){const t=[g.RemoveNumfmtMutation.id,g.SetNumfmtMutation.id];this.disposeWithMe(new w.Observable(r=>{const n=this._commandService.onCommandExecuted(i=>{if(t.includes(i.id)){const a=i.params;r.next(a.unitId)}});return()=>n.dispose()}).pipe(W.debounceTime(16)).subscribe(r=>this._forceUpdate(r)))}_initCloseListener(){this._univerInstanceService.getCurrentTypeOfUnit$(s.UniverInstanceType.UNIVER_SHEET).subscribe(t=>{var r;t||((r=this._sidebarDisposable)==null||r.dispose(),this._sidebarDisposable=null)})}};A=Le([D(0,s.Inject(g.SheetInterceptorService)),D(1,s.Inject(s.ThemeService)),D(2,s.IUniverInstanceService),D(3,s.ICommandService),D(4,s.Inject(g.SheetsSelectionsService)),D(5,k.IRenderManagerService),D(6,g.INumfmtService),D(7,s.Inject(_.ComponentManager)),D(8,_.ISidebarService),D(9,s.Inject(s.LocaleService)),D(10,s.Inject(d.SheetsNumfmtCellContentController))],A);var je=Object.getOwnPropertyDescriptor,Fe=(e,t,r,n)=>{for(var i=n>1?void 0:n?je(t,r):t,a=e.length-1,o;a>=0;a--)(o=e[a])&&(i=o(i)||i);return i},H=(e,t)=>(r,n)=>t(r,n,e);const Ae=()=>{let e=[];return{add:(i,a,o,p,c)=>e.push({unitId:i,subUnitId:a,row:o,col:p,value:c}),getEffects:()=>e,clean:()=>{e=[]}}};let B=class extends s.Disposable{constructor(t,r,n,i,a){super();q(this,"_collectEffectMutation",Ae());this._sheetInterceptorService=t,this._numfmtService=r,this._univerInstanceService=n,this._injector=i,this._editorBridgeService=a,this._initInterceptorEditorStart(),this._initInterceptorEditorEnd(),this._initInterceptorCommands()}_initInterceptorEditorStart(){this._editorBridgeService&&this.disposeWithMe(s.toDisposable(this._sheetInterceptorService.writeCellInterceptor.intercept(g.BEFORE_CELL_EDIT,{handler:(t,r,n)=>{const i=r.row,a=r.col,o=this._numfmtService.getValue(r.unitId,r.subUnitId,i,a);if(o)switch(d.getPatternType(o.pattern)){case"scientific":case"currency":case"grouped":case"number":{const c=r.worksheet.getCellRaw(i,a);return(c==null?void 0:c.t)===s.CellValueType.NUMBER&&(c==null?void 0:c.v)!==void 0&&c.v!==null&&s.isRealNum(c.v)&&(c.v=me.stripErrorMargin(Number(c.v))),n&&n(c)}case"percent":case"date":case"time":case"datetime":default:return n&&n(t)}return n(t)}})))}_initInterceptorEditorEnd(){this.disposeWithMe(s.toDisposable(this._sheetInterceptorService.writeCellInterceptor.intercept(g.AFTER_CELL_EDIT,{handler:(t,r,n)=>{var u,v,m;if(!(t!=null&&t.v)&&!(t!=null&&t.p))return n(t);this._collectEffectMutation.clean();const i=this._numfmtService.getValue(r.unitId,r.subUnitId,r.row,r.col),a=r.worksheet.getCellRaw(r.row,r.col);if(s.isTextFormat(i==null?void 0:i.pattern)||t.t===s.CellValueType.FORCE_STRING)return n(t);const o=(u=t.p)==null?void 0:u.body,p=(m=(v=t==null?void 0:t.p)==null?void 0:v.body)!=null&&m.dataStream?t.p.body.dataStream.replace(/\r\n$/,""):String(t.v),c=s.getNumfmtParseValueFilter(p);if(o)if(He(o)){const{dataStream:f}=o,S=f.replace(/\r\n$/,""),b=Number(S);if(Number.isNaN(b)&&!c)return n(t)}else return n(t);if(c){if(!c.z&&!(i!=null&&i.pattern)&&(a==null?void 0:a.t)!==s.CellValueType.STRING&&(a==null?void 0:a.t)!==s.CellValueType.FORCE_STRING&&s.willLoseNumericPrecision(p))return n({...t,p:void 0,v:p,t:s.CellValueType.FORCE_STRING});c.z&&this._collectEffectMutation.add(r.unitId,r.subUnitId,r.row,r.col,{pattern:c.z});const f=Number(c.v);return n({...t,p:void 0,v:f,t:s.CellValueType.NUMBER})}return n(t)}})))}_initInterceptorCommands(){const t=this;this.disposeWithMe(this._sheetInterceptorService.interceptCommand({getMutations(r){var n;switch(r.id){case g.SetRangeValuesCommand.id:{const i=t._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_SHEET),a=i.getUnitId(),o=(n=i.getActiveSheet())==null?void 0:n.getSheetId();if(!o)return{redos:[],undos:[]};const p=t._collectEffectMutation.getEffects();if(t._collectEffectMutation.clean(),!p.length)return{redos:[],undos:[]};const c=p.filter(f=>{var S;return!!((S=f.value)!=null&&S.pattern)}).map(f=>({row:f.row,col:f.col,pattern:f.value.pattern})),u=p.filter(f=>{var S;return!((S=f.value)!=null&&S.pattern)}).map(f=>({startRow:f.row,endColumn:f.col,startColumn:f.col,endRow:f.row})),v=[],m=[];if(c.length){const f={id:g.SetNumfmtMutation.id,params:g.transformCellsToRange(a,o,c)};v.push(f),m.push(...g.factorySetNumfmtUndoMutation(t._injector,f.params))}if(u.length){const f={id:g.RemoveNumfmtMutation.id,params:{unitId:a,subUnitId:o,ranges:u}};v.push(f),m.push(...g.factoryRemoveNumfmtUndoMutation(t._injector,f.params))}return{redos:v,undos:m.reverse()}}}return{redos:[],undos:[]}}}))}dispose(){super.dispose(),this._collectEffectMutation.clean()}};B=Fe([H(0,s.Inject(g.SheetInterceptorService)),H(1,s.Inject(g.INumfmtService)),H(2,s.Inject(s.IUniverInstanceService)),H(3,s.Inject(s.Injector)),H(4,s.Optional(N.IEditorBridgeService))],B);function He(e){const{textRuns:t=[],paragraphs:r=[],customRanges:n,customBlocks:i=[]}=e,a=["va"];return!(t.some(o=>!!(o.ts&&Object.keys(o.ts).some(c=>a.includes(c))))||r.some(o=>o.bullet)||r.length>=2||n!=null&&n.length||i.length>0)}const ae=e=>[{label:"sheet.numfmt.general",pattern:null},{label:"sheet.numfmt.text",pattern:s.DEFAULT_TEXT_FORMAT_EXCEL},"|",{label:"sheet.numfmt.number",pattern:"0"},{label:"sheet.numfmt.percent",pattern:"0.00%"},{label:"sheet.numfmt.scientific",pattern:"0.00E+00"},"|",{label:"sheet.numfmt.accounting",pattern:`"${e}" #,##0.00_);[Red]("${e}"#,##0.00)`},{label:"sheet.numfmt.financialValue",pattern:"#,##0.00;[Red]#,##0.00"},{label:"sheet.numfmt.currency",pattern:`"${e}"#,##0.00_);[Red]("${e}"#,##0.00)`},{label:"sheet.numfmt.roundingCurrency",pattern:`"${e}"#,##0;[Red]"${e}"#,##0`},"|",{label:"sheet.numfmt.date",pattern:"yyyy-mm-dd;@"},{label:"sheet.numfmt.time",pattern:'am/pm h":"mm":"ss'},{label:"sheet.numfmt.dateTime",pattern:"yyyy-m-d am/pm h:mm"},{label:"sheet.numfmt.timeDuration",pattern:"h:mm:ss"},"|",{label:"sheet.numfmt.moreFmt",pattern:""}],Re=e=>({icon:new w.Observable(t=>{const r=e.get(s.LocaleService);return t.next(d.getCurrencySymbolIconByLocale(r.getCurrentLocale()).icon),r.localeChanged$.subscribe(()=>{t.next(d.getCurrencySymbolIconByLocale(r.getCurrentLocale()).icon)})}),id:d.SetCurrencyCommand.id,title:"sheet.numfmt.currency",tooltip:"sheet.numfmt.currency",type:_.MenuItemType.BUTTON,hidden$:_.getMenuHiddenObservable(e,s.UniverInstanceType.UNIVER_SHEET),disabled$:N.getCurrentRangeDisable$(e,{workbookTypes:[g.WorkbookEditablePermission],worksheetTypes:[g.WorksheetEditPermission,g.WorksheetSetCellStylePermission],rangeTypes:[g.RangeProtectionPermissionEditPoint]})}),We=e=>({icon:"AddDigitsIcon",id:d.AddDecimalCommand.id,title:"sheet.numfmt.addDecimal",tooltip:"sheet.numfmt.addDecimal",type:_.MenuItemType.BUTTON,hidden$:_.getMenuHiddenObservable(e,s.UniverInstanceType.UNIVER_SHEET),disabled$:N.getCurrentRangeDisable$(e,{workbookTypes:[g.WorkbookEditablePermission],worksheetTypes:[g.WorksheetEditPermission,g.WorksheetSetCellStylePermission],rangeTypes:[g.RangeProtectionPermissionEditPoint]})}),Be=e=>({icon:"ReduceDigitsIcon",id:d.SubtractDecimalCommand.id,title:"sheet.numfmt.subtractDecimal",tooltip:"sheet.numfmt.subtractDecimal",type:_.MenuItemType.BUTTON,hidden$:_.getMenuHiddenObservable(e,s.UniverInstanceType.UNIVER_SHEET),disabled$:N.getCurrentRangeDisable$(e,{workbookTypes:[g.WorkbookEditablePermission],worksheetTypes:[g.WorksheetEditPermission,g.WorksheetSetCellStylePermission],rangeTypes:[g.RangeProtectionPermissionEditPoint]})}),Ve=e=>({icon:"PercentIcon",id:d.SetPercentCommand.id,title:"sheet.numfmt.percent",tooltip:"sheet.numfmt.percent",type:_.MenuItemType.BUTTON,hidden$:_.getMenuHiddenObservable(e,s.UniverInstanceType.UNIVER_SHEET),disabled$:N.getCurrentRangeDisable$(e,{workbookTypes:[g.WorkbookEditablePermission],worksheetTypes:[g.WorksheetEditPermission,g.WorksheetSetCellStylePermission],rangeTypes:[g.RangeProtectionPermissionEditPoint]})}),qe=e=>{const t=e.get(s.IUniverInstanceService),r=e.get(s.ICommandService),n=e.get(s.LocaleService),i=e.get(g.SheetsSelectionsService),a=[g.RemoveNumfmtMutation.id,g.SetNumfmtMutation.id],o=N.deriveStateFromActiveSheet$(t,"",({workbook:p,worksheet:c})=>new w.Observable(u=>w.merge(i.selectionMoveEnd$,s.fromCallback(r.onCommandExecuted.bind(r)).pipe(w.filter(([v])=>a.includes(v.id)))).subscribe(()=>{var m,f;const v=i.getCurrentSelections();if(v&&v[0]){const S=v[0].range,b=S.startRow,h=S.startColumn,P=(f=p.getStyles().get((m=c.getCell(b,h))==null?void 0:m.s))==null?void 0:f.n,I=P==null?void 0:P.pattern,M=d.getCurrencySymbolByLocale(n.getCurrentLocale());let U=n.t("sheet.numfmt.general");if(s.isDefaultFormat(I)){u.next(U);return}if(I){const x=ae(M).filter(O=>typeof O=="object"&&O.pattern).find(O=>s.isPatternEqualWithoutDecimal(I,O.pattern));x&&typeof x=="object"&&x.pattern?U=n.t(x.label):U=n.t("sheet.numfmt.moreFmt")}u.next(U)}})));return{label:oe,id:j.id,tooltip:"sheet.numfmt.title",type:_.MenuItemType.SELECTOR,slot:!0,selections:[{label:{name:ce,hoverable:!1,selectable:!1}}],value$:o,hidden$:_.getMenuHiddenObservable(e,s.UniverInstanceType.UNIVER_SHEET),disabled$:N.getCurrentRangeDisable$(e,{workbookTypes:[g.WorkbookEditablePermission],worksheetTypes:[g.WorksheetSetCellStylePermission,g.WorksheetEditPermission],rangeTypes:[g.RangeProtectionPermissionEditPoint]})}},oe="sheet.numfmt.moreNumfmtType",ce="sheet.numfmt.moreNumfmtType.options";function Ge(e){const{value:t}=e,r=_.useDependency(s.LocaleService),n=t!=null?t:r.t("sheet.numfmt.general");return l.jsx("span",{className:"univer-text-sm",children:n})}function Ke(){const e=_.useDependency(s.ICommandService),t=_.useDependency(s.LocaleService),r=_.useDependency(_.ILayoutService),n=_.useDependency(d.SheetsNumfmtCellContentController),i=_.useDependency(g.SheetsSelectionsService),a=u=>{const v=i.getCurrentLastSelection();if(!v)return;const m=v.range,f=[];s.Range.foreach(m,(S,b)=>{u?f.push({row:S,col:b,pattern:u,type:d.getPatternType(u)}):f.push({row:S,col:b})}),e.executeCommand(d.SetNumfmtCommand.id,{values:f}),r.focus()},o=y.useMemo(()=>{const u=d.localeCurrencySymbolMap.get(t.getCurrentLocale());return ae(u)},[t]),p=u=>{if(u===0)a(null);else if(u===o.length-1)e.executeCommand(j.id),r.focus();else{const v=o[u];v.pattern&&a(v.pattern)}},c=1220;return l.jsx("div",{className:"univer-grid univer-gap-1 univer-p-1.5",children:o.map((u,v)=>u==="|"?l.jsx(E.Separator,{},v):l.jsxs("div",{className:"univer-flex univer-h-7 univer-items-center univer-justify-between univer-gap-6 univer-rounded univer-px-2 univer-text-sm hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-700",onClick:()=>p(v),children:[l.jsx("span",{children:t.t(u.label)}),l.jsx("span",{className:"univer-text-xs univer-text-gray-500",children:u.pattern?d.getPatternPreview(u.pattern||"",c,n.locale).result.trim():""})]},v))})}const Ye={[_.RibbonStartGroup.LAYOUT]:{[j.id]:{order:9,menuItemFactory:qe},[d.SetPercentCommand.id]:{order:9.1,menuItemFactory:Ve},[d.SetCurrencyCommand.id]:{order:9.2,menuItemFactory:Re},[d.AddDecimalCommand.id]:{order:9.3,menuItemFactory:We},[d.SubtractDecimalCommand.id]:{order:9.4,menuItemFactory:Be}}};var Ze=Object.getOwnPropertyDescriptor,ze=(e,t,r,n)=>{for(var i=n>1?void 0:n?Ze(t,r):t,a=e.length-1,o;a>=0;a--)(o=e[a])&&(i=o(i)||i);return i},le=(e,t)=>(r,n)=>t(r,n,e);let V=class extends s.Disposable{constructor(e,t){super(),this._componentManager=e,this._menuManagerService=t,this._initMenu()}_initMenu(){this._menuManagerService.mergeMenu(Ye),[[oe,Ge],[ce,Ke]].forEach(([e,t])=>{this.disposeWithMe(this._componentManager.register(e,t))})}};V=ze([le(0,s.Inject(_.ComponentManager)),le(1,_.IMenuManagerService)],V);var Xe=Object.defineProperty,Je=Object.getOwnPropertyDescriptor,Qe=(e,t,r)=>t in e?Xe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,et=(e,t,r,n)=>{for(var i=n>1?void 0:n?Je(t,r):t,a=e.length-1,o;a>=0;a--)(o=e[a])&&(i=o(i)||i);return i},J=(e,t)=>(r,n)=>t(r,n,e),ue=(e,t,r)=>Qe(e,typeof t!="symbol"?t+"":t,r);const tt="SHEET_NUMFMT_UI_PLUGIN";C.UniverSheetsNumfmtUIPlugin=class extends s.Plugin{constructor(t=ee,r,n,i){super(),this._config=t,this._injector=r,this._configService=n,this._renderManagerService=i;const{menu:a,...o}=s.merge({},ee,this._config);a&&this._configService.setConfig("menu",a,{merge:!0}),this._configService.setConfig("sheets-numfmt-ui.config",o)}onStarting(){s.registerDependencies(this._injector,[[A],[B],[F],[V]])}onRendered(){this._registerRenderModules(),s.touchDependencies(this._injector,[[A],[B],[V]])}_registerRenderModules(){[[K]].forEach(r=>{this.disposeWithMe(this._renderManagerService.registerRenderModule(s.UniverInstanceType.UNIVER_SHEET,r))})}},ue(C.UniverSheetsNumfmtUIPlugin,"pluginName",tt),ue(C.UniverSheetsNumfmtUIPlugin,"type",s.UniverInstanceType.UNIVER_SHEET),C.UniverSheetsNumfmtUIPlugin=et([s.DependentOn(N.UniverSheetsUIPlugin,d.UniverSheetsNumfmtPlugin),J(1,s.Inject(s.Injector)),J(2,s.IConfigService),J(3,k.IRenderManagerService)],C.UniverSheetsNumfmtUIPlugin),Object.defineProperty(C,Symbol.toStringTag,{value:"Module"})}));


// index
(function(i,n){typeof exports=="object"&&typeof module<"u"?n(exports,require("@univerjs/docs"),require("@univerjs/docs-ui"),require("@univerjs/engine-formula"),require("@univerjs/engine-render"),require("@univerjs/network"),require("@univerjs/rpc"),require("@univerjs/sheets"),require("@univerjs/sheets-formula"),require("@univerjs/sheets-formula-ui"),require("@univerjs/sheets-numfmt"),require("@univerjs/sheets-numfmt-ui"),require("@univerjs/sheets-ui"),require("@univerjs/ui"),require("@univerjs/network/lib/facade"),require("@univerjs/sheets/lib/facade"),require("@univerjs/ui/lib/facade"),require("@univerjs/docs-ui/lib/facade"),require("@univerjs/sheets-ui/lib/facade"),require("@univerjs/engine-formula/lib/facade"),require("@univerjs/sheets-formula/lib/facade"),require("@univerjs/sheets-numfmt/lib/facade"),require("@univerjs/sheets-formula-ui/lib/facade")):typeof define=="function"&&define.amd?define(["exports","@univerjs/docs","@univerjs/docs-ui","@univerjs/engine-formula","@univerjs/engine-render","@univerjs/network","@univerjs/rpc","@univerjs/sheets","@univerjs/sheets-formula","@univerjs/sheets-formula-ui","@univerjs/sheets-numfmt","@univerjs/sheets-numfmt-ui","@univerjs/sheets-ui","@univerjs/ui","@univerjs/network/lib/facade","@univerjs/sheets/lib/facade","@univerjs/ui/lib/facade","@univerjs/docs-ui/lib/facade","@univerjs/sheets-ui/lib/facade","@univerjs/engine-formula/lib/facade","@univerjs/sheets-formula/lib/facade","@univerjs/sheets-numfmt/lib/facade","@univerjs/sheets-formula-ui/lib/facade"],n):(i=typeof globalThis<"u"?globalThis:i||self,n(i.UniverPresetSheetsCore={},i.UniverDocs,i.UniverDocsUi,i.UniverEngineFormula,i.UniverEngineRender,i.UniverNetwork,i.UniverRpc,i.UniverSheets,i.UniverSheetsFormula,i.UniverSheetsFormulaUi,i.UniverSheetsNumfmt,i.UniverSheetsNumfmtUi,i.UniverSheetsUi,i.UniverUi))})(this,(function(i,n,a,c,v,l,d,f,m,j,U,S,g,h){"use strict";function p(F={}){var o;const{container:q="app",workerURL:s,header:b,footer:P,toolbar:C,ribbonType:R,formulaBar:k,menu:w,contextMenu:y,disableAutoFocus:x,customFontFamily:M,docs:t,sheets:e,formula:r,disableTextFormatAlert:T,disableTextFormatMark:E}=F,u=!!s;return{plugins:[l.UniverNetworkPlugin,[n.UniverDocsPlugin,{hasScroll:t==null?void 0:t.hasScroll}],v.UniverRenderEnginePlugin,[h.UniverUIPlugin,{container:q,header:b,toolbar:C,ribbonType:R,menu:w,contextMenu:y,disableAutoFocus:x,customFontFamily:M}],a.UniverDocsUIPlugin,u?[d.UniverRPCMainThreadPlugin,{workerURL:s}]:null,[c.UniverFormulaEnginePlugin,{notExecuteFormula:u,function:r==null?void 0:r.function}],[f.UniverSheetsPlugin,{notExecuteFormula:u,onlyRegisterFormulaRelatedMutations:!1,isRowStylePrecedeColumnStyle:e==null?void 0:e.isRowStylePrecedeColumnStyle,autoHeightForMergedCells:e==null?void 0:e.autoHeightForMergedCells,freezeSync:e==null?void 0:e.freezeSync}],[g.UniverSheetsUIPlugin,{formulaBar:k,footer:P,maxAutoHeightCount:e==null?void 0:e.maxAutoHeightCount,clipboardConfig:e==null?void 0:e.clipboardConfig,scrollConfig:e==null?void 0:e.scrollConfig,protectedRangeShadow:(o=e==null?void 0:e.protectedRangeShadow)!=null?o:!0,protectedRangeUserSelector:e==null?void 0:e.protectedRangeUserSelector,disableForceStringAlert:e==null?void 0:e.disableForceStringAlert,disableForceStringMark:e==null?void 0:e.disableForceStringMark}],[U.UniverSheetsNumfmtPlugin,{disableTextFormatAlert:T,disableTextFormatMark:E}],S.UniverSheetsNumfmtUIPlugin,[m.UniverSheetsFormulaPlugin,{notExecuteFormula:u,description:r==null?void 0:r.description,initialFormulaComputing:r==null?void 0:r.initialFormulaComputing}],[j.UniverSheetsFormulaUIPlugin,{functionScreenTips:r==null?void 0:r.functionScreenTips}]].filter(A=>!!A)}}i.UniverSheetsCorePreset=p,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})}));
